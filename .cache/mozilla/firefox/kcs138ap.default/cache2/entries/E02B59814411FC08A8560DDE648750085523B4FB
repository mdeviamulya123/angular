var g_fModuleLoaded={},__DEBUG_BUILD=false,Type=Function;!g_fModuleLoaded[".\\core/type.js".toLowerCase()]&&(function(){Type.Const={};Type.Const.Boolean=typeof true;Type.Const.Function=typeof new Function;Type.Const.Number=typeof 0;Type.Const.Object=typeof{};Type.Const.String=typeof"";Type.Const.Undefined=typeof undefined;var a=function $__Namespace$(a){this.__sTypeName=a};a.prototype={__fNamespace:true,getName:function(){return this.__sTypeName}};Type.__sTypeName="Type";Type.prototype.createClass=function Type$createClass(d,c,a){this.prototype.constructor=this;this.__sTypeName=d;this.__fClass=true;this.__oBaseType=c||Object;if(c)this.__fBasePrototypePending=true;if(a){this.__rgInterfaces=[];for(var b=2;b<arguments.length;b++){a=arguments[b];this.__rgInterfaces[this.__rgInterfaces.length]=a}}};Type.prototype.createInterface=function Type$createInterface(a){this.__sTypeName=a;this.__fInterface=true};Type.prototype.constructBase=function Type$constructBase(a,b){this.__fBasePrototypePending&&this._setupBase();if(!b)this.__oBaseType.apply(a);else this.__oBaseType.apply(a,b)};Type.prototype.callBase=function Type$callBase(b,d,c){var a=this.__oBaseType.prototype[d];return!c?a.apply(b):a.apply(b,c)};Type.prototype.get_Name=function Type$get_Name(){var a=this.__sTypeName,b=a.lastIndexOf(".");return b>0?a.substr(b+1):a};Type.prototype.isInstance=function Type$isInstance(a){if(a===null||a===undefined)return false;if(!a.hasOwnProperty)return false;if(this==Object||a instanceof this)return true;var b=Type.getInstanceType(a);return this._isAssignableFrom(b)};Type.prototype._setupBase=function Type$_setupBase(){if(this.__fBasePrototypePending){var a=this.__oBaseType;a.__fBasePrototypePending&&a._setupBase();for(var b in a.prototype){var c=a.prototype[b];if(typeof this.prototype[b]==Type.Const.Undefined)this.prototype[b]=c}delete this.__fBasePrototypePending}};Type.prototype._isAssignableFrom=function Type$_isAssignableFrom(d){if(this==Object||this==d||this.__sTypeName&&this.__sTypeName==d.__sTypeName)return true;if(this.__fClass){var b=d.__oBaseType;while(b){if(this==b||this.__sTypeName&&this.__sTypeName==b.__sTypeName)return true;b=b.__oBaseType}}else if(this.__fInterface){for(var a=d.__rgInterfaces,c=0,c=0;a&&c<a.length;++c)if(this.__sTypeName&&a[c].__sTypeName==this.__sTypeName||a[c]==this)return true;var b=d.__oBaseType;while(b){a=b.__rgInterfaces;for(c=0;a&&c<a.length;++c)if(this.__sTypeName&&a[c].__sTypeName==this.__sTypeName||a[c]==this)return true;b=b.__oBaseType}}return false};Type.createNamespace=function Type$createNamespace(f){if(!window.__namespaces)window.__namespaces={};if(!window.__rootNamespaces)window.__rootNamespaces=[];if(window.__namespaces[f])return;for(var c=window,e=f.split("."),b=0;b<e.length;b++){var g=e[b],d=c[g];if(!d){c[g]=d=new a(e.slice(0,b+1).join("."));if(b==0)window.__rootNamespaces[window.__rootNamespaces.length]=d}c=d}window.__namespaces[f]=c};Type.getInstanceType=function Type$getInstanceType(b){var a=null;try{a=b.constructor}catch(c){}if(!a||!a.__sTypeName)a=Object;return a};Type.getType=function Type$getType(a){if(!a)return null;if(!Type.__typeCache)Type.__typeCache={};var b=Type.__typeCache[a];if(!b){b=eval(a);Type.__typeCache[a]=b}return b};Object.__sTypeName="Object";Object.__oBaseType=null;Array.__sTypeName="Array";Array.__oBaseType=null;Array.__fClass=true;Boolean.__sTypeName="Boolean";Boolean.__oBaseType=null;Boolean.__fClass=true;String.__sTypeName="String";String.__oBaseType=null;String.__fClass=true;Number.__sTypeName="Number";Number.__oBaseType=null;Number.__fClass=true})();g_fModuleLoaded[".\\core/type.js".toLowerCase()]=1;var UniqueIdGenerator,UniqueIdHashSet;!g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()]&&(function(){var c=1e9,b=null,a=null;UniqueIdGenerator=function(){this._sTick=(new Date).getTime();this._sSeed=Math.round(Math.random()*c)};UniqueIdGenerator.get_Instance=function UniqueIdGenerator$get_Instance(){if(!b)b=new UniqueIdGenerator;return b};UniqueIdGenerator.prototype.get_Next=function UniqueIdGenerator$get_Next(){var a="_"+this._sTick+"_"+this._sSeed;this._sSeed+=Math.round(Math.random()*10)+1;return a};UniqueIdGenerator.createClass("UniqueIdGenerator");UniqueIdHashSet=function(){this._oObjectHashSet={}};UniqueIdHashSet.get_Instance=function UniqueIdHashSet$get_Instance(){if(!a)a=new UniqueIdHashSet;return a};UniqueIdHashSet.prototype.put=function UniqueIdHashSet$put(a,b){this._oObjectHashSet[a]=b};UniqueIdHashSet.prototype.get=function UniqueIdHashSet$get(a){return this._oObjectHashSet[a]};UniqueIdHashSet.prototype.remove=function UniqueIdHashSet$remove(a){delete this._oObjectHashSet[a]};UniqueIdHashSet.prototype.clear=function UniqueIdHashSet$clear(){this._oObjectHashSet={}};UniqueIdHashSet.createClass("UniqueIdHashSet")})();g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()]=1;!g_fModuleLoaded[".\\core/StringBuilder.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Text");Owa.Text.StringBuilder=function Owa$Text$StringBuilder(){this.buffer=[]};Owa.Text.StringBuilder.prototype.append=function Owa$Text$StringBuilder$append(a){this.buffer.push(a);return this};Owa.Text.StringBuilder.prototype.toString=function Owa$Text$StringBuilder$toString(){return this.buffer.join("")}})();g_fModuleLoaded[".\\core/StringBuilder.js".toLowerCase()]=1;var urlEnc,urlDec,htmlEnc,htmlDec,jsEnc,toUTF8;(function(){Type.createNamespace("Owa.Encoder");urlEnc=Owa.Encoder.urlEncode=function Owa$Encoder$urlEncode(a){return toUTF8(a)};urlDec=Owa.Encoder.urlDec=function Owa$Encoder$urlDec(a){return decodeURIComponent(a)};htmlEnc=Owa.Encoder.htmlEnc=function Owa$Encoder$htmlEnc(c){var b=document.createElement("DIV");b.innerText=b.textContent=c;var a=b.innerHTML;a=a.replace(new RegExp('"',"g"),"&quot;");return a};htmlDec=Owa.Encoder.htmlDec=function Owa$Encoder$htmlDec(b){var a=Owa.Dom.Document.get_Current().createElement("DIV");a.set_InnerHtml(b);return a.get_TextContent()};jsEnc=Owa.Encoder.jsEnc=function Owa$Encoder$jsEnc(c){if(!isDf(typeof c)||!c)return;for(var a=[],b,d=0;d<c.length;d++){b=c.charAt(d);switch(b){case'"':case"'":case"\\":case"/":a.push("\\");a.push(b);break;case"\r":a.push("\\");a.push("r");break;case"\n":a.push("\\");a.push("n");break;default:a.push(b)}}return a.join("")};toUTF8=Owa.Encoder.toUTF8=function Owa$Encoder$toUTF8(b){if(b==null)return"";if(typeof b=="number")b=""+b;for(var a=new Owa.Text.StringBuilder,d=0,e=0;e<b.length;e++){var c=b.charCodeAt(e);if(isSfAscChr(c))continue;d!=e&&a.append(b.substring(d,e));d=e+1;if(!(c&65408)){a.append("%");a.append(c.toString(16))}else if(!(c&63488)){a.append("%");a.append((c>>6|192).toString(16));a.append("%");a.append((c&63|128).toString(16))}else{a.append("%");a.append((c>>12|224).toString(16));a.append("%");a.append((c>>6&63|128).toString(16));a.append("%");a.append((c&63|128).toString(16))}}d!=0&&d!=b.length&&a.append(b.substring(d,b.length));return d==0?b:a.toString()};function isSfAscChr(a){return a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||a==33||a>=39&&a<=42||a==45||a==46||a==95||a==126}Owa.Encoder.fromBase64String=function Owa$Encoder$fromBase64String(f){var a=new Array(4),c,h,b,e=f.length,d=0;if(e<=0||e%4!=0)return null;if(d<0||d>e)return null;var j=e/4*3;if(f.charAt(d+e-1)=="="){j--;if(f.charAt(d+e-2)=="=")j--}var g=new Array(j);h=0;for(;e>0;e-=4){for(c=0;c<4;c++,d++){b=f.charAt(d);if(b>="A"&&b<="Z"){var i="A";a[c]=0+(f.charCodeAt(d)-i.charCodeAt(0))}else if(b>="a"&&b<="z"){var i="a";a[c]=26+(f.charCodeAt(d)-i.charCodeAt(0))}else if(b>="0"&&b<="9"){var i="0";a[c]=52+(f.charCodeAt(d)-i.charCodeAt(0))}else if(b=="+"||b=="-")a[c]=62;else if(b=="/"||b=="_")a[c]=63;else if(b=="="&&c>=2)a[c]=64;else return null}g[h++]=a[0]<<2|a[1]>>4;if(a[2]!=64){g[h++]=(a[1]&15)<<4|a[2]>>2;if(a[3]!=64)g[h++]=(a[2]&3)<<6|a[3]}}return g};Owa.Encoder.toBase64String=function Owa$Encoder$toBase64String(a,i){var f,d,e,k,l,h,g,c,j="",m=typeof a.charCodeAt=="undefined";if(isDf(typeof i)&&i)c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";else c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(var b=0;b<a.length;){if(m){f=a[b];d=a[b+1];e=a[b+2]}else{f=a.charCodeAt(b);d=a.charCodeAt(b+1);e=a.charCodeAt(b+2)}k=f>>2;l=(f&3)<<4|d>>4;h=(d&15)<<2|e>>6;g=e&63;if(isNaN(d))h=g=64;else if(isNaN(e))g=64;j+=c.charAt(k)+c.charAt(l)+c.charAt(h)+c.charAt(g);b+=3}return j}})();Type.createNamespace("Owa.Collection.Set");!g_fModuleLoaded[".\\core/Set.js".toLowerCase()]&&(function(){Owa.Collection.Set=function Owa$Collection$Set(){this._rgObject=[]};var a=Owa.Collection.Set.prototype;a.add=function Owa$Collection$Set$add(a){if(!this.contains(a)){this._rgObject.push(a);return true}return false};a._indexOf=function Owa$Collection$Set$_indexOf(b){for(var c=this._rgObject.length,a=0;a<c;a++)if(b.equals){if(b.equals(this._rgObject[a]))return a}else if(b===this._rgObject[a])return a;return-1};a.contains=function Owa$Collection$Set$contains(a){return this._indexOf(a)!==-1};a.clear=function Owa$Collection$Set$clear(){this._rgObject=[]};a.toArray=function Owa$Collection$Set$toArray(){return this._rgObject.clone()};a.remove=function Owa$Collection$Set$remove(b){var a=this._indexOf(b);if(a>=0){this._rgObject.removeAt(a);return true}return false}})();g_fModuleLoaded[".\\core/Set.js".toLowerCase()]=1;!g_fModuleLoaded[".\\core/strings.js".toLowerCase()]&&(function(){(function(){Type.createNamespace("Owa.Strings.Ids");var a=Owa.Strings.Ids;a.HelpButtonId="lnkHelp";a.OptionsButtonId="lnkOptions";a.NewMailNotificationButtonId="lnkNwMl";a.NewVoiceMailNotificationButtonId="lnkNwVMl";a.NewFaxNotificationButtonId="lnkNwFx";a.BuddyRequestNotificationButtonId="lnkBr";a.ActiveChatsNotificationButtonId="lnkAc";a.NewChatNotificationButtonId="lnkNwCht";a.ReminderNotificationButtonId="lnkRm";a.ErrorNotificationButtonId="lnkNE";a.ComboDropDownList="divCmbList";a.DatePickerDropDown="divDP";a.ComboTextDisplaySpan="spanCmbSel";a.TimeTextBox="txtTime";a.InputTextBox="txtInput";a.Accept="accept";a.Decline="decline";a.Tentative="tentative";a.ShowCalendar="showcalendar";a.SendResponse="sndrsp";a.NoResponse="norsp";a.EditResponse="edrsp";a.Remove="remove";a.AddThisCalendar="addThisCalendar";a.ShareMyCalendar="shareMyCalendar";a.ViewThisCalendar="viewcal";a.FromSpan="spnFrom";a.RecipientSpan="spnR";a.AttachmentLink="lnkAtmt";a.BranchText="spnBrSn";a.ReplyIcon="imgReplyIcon";a.ReplyAllIcon="imgReplyAllIcon";a.ForwardIcon="imgForwardIcon";a.PostReplyIcon="imgPostReplyIcon";a.NotJunkText="spnNotJunk";a.ItemPartExpansionHeader="divExpHdr";a.ItemPartActionsButton="divActions";a.ItemPartExpansion="divExp";a.ItemPartDraftSpan="spnDraft";a.ItemPartItemNotSentSpan="spnItemNotSent"})();(function(){Type.createNamespace("Owa.Strings.Attributes");var a=Owa.Strings.Attributes;a.Id="id";a.Type="name";a.IsSticky="_stky";a.IsToolbarButton="_tbb";a.IsMenuItem="_mnuItm";a.IsNotificationButton="_ntf";a.IsOptionsSaveButton="_opt";a.HasBigButtonWrapper="_fBig";a.IsDisabled="fDsbl";a.SubMenuId="_sbMnu";a.ButtonPushed="_pushed";a.ButtonAlwaysPushed="_alwaysPushed";a.ToggleSiblingIds="_tgl";a.SwapSiblingIds="_swp";a.ComboMenuId="_twsy";a.Radio="_radio";a.ComboDropDownId="_ovr";a.AllowContextMenu="_fAllwCM";a.Value="oV";a.TimeValue="sTm";a.EndTimeValue="sEndTm";a.ShortTimeFormatString="sStf"})();(function(){Type.createNamespace("Owa.Strings.Controls");var a=Owa.Strings.Controls;a.Button="lnkB";a.Menu="mnu";a.Toolbar="tlb"})();(function(){Type.createNamespace("Owa.Strings.Names");var a=Owa.Strings.Names;a.LinkButton="lnkB";a.LinkNotificationButton="lnkNB"})();(function(){Type.createNamespace("Owa.Strings.CssClass");var a=Owa.Strings.CssClass;a.ButtonDisabled="btnDa";a.ButtonDown="btnDn";a.ButtonDefault="btnDf";a.ToolbarButtonDisabled="tbfD";a.ToolbarButtonDown="tbfP";a.ToolbarButtonHoverable="tbfHvr";a.ToolbarButtonShareHoverable="tbfShareHvr";a.MenuButtonDisabled="miDa";a.MenuButtonDown="miDn";a.MenuButtonDefault="miDf";a.NotificationButtonPushed="alertBtnPushed";a.NotificationButtonDown="alertBtnDn";a.NotificationButtonDefault="alertBtnDf";a.OptionsSaveButtonDisabled="optDa";a.OptionsSaveButtonDown="optDn";a.OptionsSaveButtonHoverable="optHvr";a.ComboDropDownSelectedItem="cmbSel";a.ComboBoxDisable="cmbDsbl";a.RightPipe="rightPipe";a.LeftPipe="leftPipe";a.RightStopSmall="rightStopS";a.LeftStopSmall="leftStopS";a.RightChildStopSmall="rightChildStopS";a.LeftChildStopSmall="leftChildStopS";a.AncestorPipe="ppAnc";a.AncestorStopSmall="psAncS";a.PipeBackground="pipeBkg"})();(function(){Type.createNamespace("Owa.Strings.ObjectClass");var a=Owa.Strings.ObjectClass;a.MeetingRequest="IPM.Schedule.Meeting.Request";a.MeetingCancellation="IPM.Schedule.Meeting.Canceled";a.SharingMessage="IPM.Sharing";a.MeetingResponsePrefix="IPM.Schedule.Meeting.Resp"})();(function(){Type.createNamespace("Owa.Strings.Icons");var a=Owa.Strings.Icons;a.Collapsed="plus.png";a.Expanded="minus.png";a.CollapsedRtl="plusrtl.png";a.ExpandedRtl="minusrtl.png";a.ReplyActive="replyActive.png";a.ReplyGhost="replyGhost.png";a.ReplyDisabled="replyDisabled.png";a.ReplyGhostDisabled="replyGhostDisabled.png";a.ReplyAllActive="replyAllActive.png";a.ReplyAllGhost="replyAllGhost.png";a.ReplyAllDisabled="replyAllDisabled.png";a.ReplyAllGhostDisabled="replyAllGhostDisabled.png";a.ForwardActive="forwardActive.png";a.ForwardGhost="forwardGhost.png";a.ForwardDisabled="forwardDisabled.png";a.ForwardGhostDisabled="forwardGhostDisabled.png";a.PostReplyActive="postRpActive.png";a.PostReplyGhost="postRpGhost.png";a.PostReplyDisabled="postRpDisabled.png";a.PostReplyGhostDisabled="postRpGhostDisabled.png"})()})();g_fModuleLoaded[".\\core/strings.js".toLowerCase()]=1;!g_fModuleLoaded[".\\core/browserDetection.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Utility");var j=null,k=null,l=null,i=null,e=null,f=null,h=null,g=null,c=null,d=null,a=null,b=null;Owa.Utility.isMac=function Owa$Utility$isMac(){if(j==null)j=navigator.appVersion.indexOf("Mac")!=-1;return j};Owa.Utility.isWin=function Owa$Utility$isWin(){if(k==null)k=navigator.appVersion.indexOf("Win")!=-1||navigator.appVersion.indexOf("NT")!=-1;return k};Owa.Utility.isIE=function Owa$Utility$isIE(){if(l==null){e=navigator.userAgent.indexOf("Trident")!=-1&&navigator.userAgent.indexOf("rv:")!=-1;l=e||navigator.userAgent.indexOf("MSIE ")!=-1}return l};Owa.Utility.isIE7=function Owa$Utility$isIE7(){if(i==null)i=navigator.userAgent.indexOf("MSIE 7")!=-1;return i};Owa.Utility.get_IEVersion=function Owa$Utility$get_IEVersion(){if(a==null){if(e){if(/rv:([\d.]+)/.test(navigator.userAgent))a=new Number(RegExp.$1)}else if(/MSIE ([\d.]+)/.test(navigator.userAgent))a=new Number(RegExp.$1);if(!a)a=-1}return a};Owa.Utility.isGreaterThanIE9=function Owa$Utility$isGreaterThanIE9(){return!Owa.Utility.isIE()?false:Owa.Utility.get_IEVersion()>9};Owa.Utility.isGreaterThanIE9UsingTrident=function Owa$Utility$isGreaterThanIE9UsingTrident(){if(!Owa.Utility.isIE())return false;var a=0;if(/Trident\/([\d.]+)/.test(navigator.userAgent))a=new Number(RegExp.$1);return a>5};Owa.Utility.isWindows8orGreater=function Owa$Utility$isWindows8orGreater(){if(b==null)if(/Windows NT ([\d.]+)/.test(navigator.userAgent))b=new Number(RegExp.$1)>=6.2;else b=false;return b};Owa.Utility.isFirefox=function Owa$Utility$isFirefox(){if(f==null)f=navigator.userAgent.indexOf("Firefox/")!=-1&&navigator.userAgent.indexOf("Gecko/")!=-1;return f};Owa.Utility.get_FirefoxVersion=function Owa$Utility$get_FirefoxVersion(){if(c==null)if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))c=new Number(RegExp.$1);else c=-1;return c};Owa.Utility.get_SafariVersion=function Owa$Utility$get_SafariVersion(){if(d==null)if(/Version\/(\d+\.\d+)/.test(navigator.userAgent))d=new Number(RegExp.$1);else d=-1;return d};Owa.Utility.isSafari=function Owa$Utility$isSafari(){if(h==null)h=navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("WebKit")!=-1;return h};Owa.Utility.isChrome=function Owa$Utility$isChrome(){if(g==null)g=navigator.userAgent.indexOf("Chrome")!=-1;return g};Owa.Utility.isActiveXControlSupported=function Owa$Utility$isActiveXControlSupported(){if(Owa.Utility.isIE())try{var b=new ActiveXObject("MSXML2.DomDocument");return true}catch(a){}return false}})();g_fModuleLoaded[".\\core/browserDetection.js".toLowerCase()]=1;(function(){Type.createNamespace("Owa.Utility");Owa.Utility.IntFromSize=function Owa$Utility$IntFromSize(b){var a=parseInt(b.trim(),10);return isNaN(a)?0:a};function _delegateEquals(a){return!!a&&this._oThis==a._oThis&&this._fnFunction&&this._fnFunction==a._fnFunction}Owa.Utility.createDelegate=function Owa$Utility$createDelegate(c,b){var a=function(){return b.apply(c,arguments)};a._oThis=c;a._fnFunction=b;a.equals=_delegateEquals;return a};Owa.Utility.createContextDelegate=function Owa$Utility$createContextDelegate(c,b,d){var a=function(){return b.call(c,d)};a._oThis=c;a._fnFunction=b;a.equals=_delegateEquals;return a};Owa.Utility.createArgumentContextDelegate=function Owa$Utility$createArgumentContextDelegate(d,c,e,b){if(b==null)b=c;var a=function(a){return c.call(d,a,e)};a._oThis=d;a._fnFunction=b;a.equals=_delegateEquals;return a};Owa.Utility.inherit=function Owa$Utility$inherit(a,b){for(var c in b.prototype)a.prototype[c]=b.prototype[c];a.prototype.constructor=a;a.baseClass=b};Owa.Utility.isArray=function Owa$Utility$isArray(a){return a&&typeof a=="object"?typeof a.length!="undefined":0};Owa.Utility.appendPixelUnit=function Owa$Utility$appendPixelUnit(a){return a+"px"};Owa.Utility.isWebPartWindow=function Owa$Utility$isWebPartWindow(){return Owa.Utility.isDefined(typeof a_fWP)&&a_fWP};Owa.Utility.isDefined=function Owa$Utility$isDefined(a){return a!==Type.Const.Undefined};Owa.Utility.isEqual=function Owa$Utility$isEqual(a,b){return a&&a.equals!==undefined?a.equals(b):a==b};Owa.Utility.getIFrameParentOwaWindow=function Owa$Utility$getIFrameParentOwaWindow(){var a=Owa.Dom.Window.get_Current();while(a){var b=a.get_ParentWindow();if(!b||b.equals(a))break;if(Owa.DomUtility.isOwaWindow(b))a=b;else break}return a};Owa.Utility.getRootOwaWindow=function Owa$Utility$getRootOwaWindow(){if(Owa.Utility.isWebPartWindow())return Owa.Dom.Window.get_Current();var a=Owa.Dom.Window.get_Current(),d=a;while(true){var c=a.getGlobalVariable("Owa");try{if(c&&c.Utility&&c.Utility.getIFrameParentOwaWindow)a=c.Utility.getIFrameParentOwaWindow();else return d}catch(e){return d}if(a.getGlobalVariable("a_fStPg"))return a;var b=a.get_Opener();if(!b)b=a.get_ParentWindow();if(b&&b.getGlobalVariable("g_fOwa")&&!a.equals(b)){d=a;a=b}else return a}};Owa.Utility.isCurrentWindowRootOwaWindow=function Owa$Utility$isCurrentWindowRootOwaWindow(){return Owa.Dom.Window.get_Current().equals(Owa.Utility.getRootOwaWindow())};Owa.Utility.getVisiblePositionX=function Owa$Utility$getVisiblePositionX(b,h,g){var d=b.get_ParentElement().get_OffsetWidth(),c=b.get_OffsetWidth(),f=b.get_PositionalParent().get_RelativeLeft(b.get_ParentElement()),a=f+h;if(!g){var e=a+c-d;if(e>0)a-=e;if(a<0)a=0}else{if(a<0)a=0;if(a+c>d)a=d-c}return a-f};Owa.Utility.getVisiblePositionY=function Owa$Utility$getVisiblePositionY(c,g){var b=c.get_ParentElement(),f=c.get_OffsetHeight(),e=c.get_PositionalParent().get_RelativeTop(b),a=e+g,d=a+f-b.get_OffsetHeight()-b.get_ScrollTop();if(d>0)a-=d;if(a<0)a=0;return a-e};Owa.Utility.createWindowResizeHandler=function Owa$Utility$createWindowResizeHandler(f,e){var a=f.get_Document().get_Body(),b=a.get_ClientHeight(),c=a.get_ClientWidth(),d=function(){var d=a.get_ClientHeight(),f=a.get_ClientWidth();if(b!=d||c!=f){b=d;c=f;e()}};return d};Owa.Utility.bytesToString=function Owa$Utility$bytesToString(b){for(var c="",a=0;a<b.length;a++)c+=String.fromCharCode(b[a]);return c};Owa.Utility.stringToBytes=function Owa$Utility$stringToBytes(c){for(var b=[],a=0;a<c.length;a++)b[a]=c.charCodeAt(a);return b};Owa.Utility.OwaPrefixes={PublicStoreFolderPrefix:"PSF",PublicStoreItemPrefix:"PSI",ConversationIdPrefix:"CID",OtherUserMailboxObjectPrefix:"OUM",ArchiveMailboxObjectPrefix:"AMB",ArchiveConversationIdPrefix:"ACI",GSCalendarPrefix:"GS",SeparatorChar:"."};Owa.Utility.isIdType=function Owa$Utility$isIdType(b,a){return b.startsWith(a+Owa.Utility.OwaPrefixes.SeparatorChar)};Owa.Utility.isHttps=function Owa$Utility$isHttps(){return window.location.protocol=="https:"}})();Type.createNamespace("Owa.Collections");Owa.Collections.IEnumerator=function Owa$Collections$IEnumerator(){};Owa.Collections.IEnumerator.prototype.get_Current=null;Owa.Collections.IEnumerator.prototype.moveNext=null;Owa.Collections.IEnumerator.prototype.reset=null;Owa.Collections.IEnumerator.createInterface("Owa.Collections.IEnumerator");Owa.Collections.IEnumerable=function Owa$Collections$IEnumerable(){};Owa.Collections.IEnumerable.prototype.get_Enumerator=null;Owa.Collections.IEnumerable.createInterface("Owa.Collections.IEnumerable");Owa.Collections.IList=function Owa$Collections$IList(){};Owa.Collections.IList.prototype.get_Length=null;Owa.Collections.IList.prototype.get_Item=null;Owa.Collections.IList.createInterface("Owa.Collections.IList");Owa.Collections.ListEnumerator=function Owa$Collections$ListEnumerator(a){this._oList=a;this._index=-1};Owa.Collections.ListEnumerator.prototype.get_Current=function Owa$Collections$ListEnumerator$get_Current(){return this._oList.get_Item(this._index)};Owa.Collections.ListEnumerator.prototype.moveNext=function Owa$Collections$ListEnumerator$moveNext(){this._index++;return this._index<this._oList.get_Length()};Owa.Collections.ListEnumerator.prototype.reset=function Owa$Collections$ListEnumerator$reset(){this._index=-1};Owa.Collections.ListEnumerator.createClass("Owa.Collections.ListEnumerator",null,Owa.Collections.IEnumerator);var isNoE,isRg,isDf,getInt;!g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()]&&(function(){(function(){String.prototype.trimStart=function String$trimStart(){return this.replace(/^\s*/,"")};String.prototype.trimEnd=function String$trimEnd(){return this.replace(/\s*$/,"")};String.prototype.startsWith=function String$startsWith(a){return this.indexOf(a)==0};String.prototype.trim=function String$trim(){return this.trimStart().trimEnd()};String.prototype.endsWith=function String$endsWith(b){var a=this.lastIndexOf(b);return a>=0&&a==this.length-b.length?true:false};String.prototype.contains=function String$contains(a){return this.indexOf(a)>=0};String.prototype.format=function String$format(){for(var b=this,a=0;a<arguments.length;a++)b=b.replace(RegExp("\\{"+a+"\\}","g"),arguments[a]);return b};String.prototype._localeCompare=String.prototype.localeCompare;if(!String.prototype._localeCompare)String.prototype._localeCompare=function(a){return this<a?-1:this>a?1:0};String._equalityOffset="0"._localeCompare("0");String.prototype.localeCompare=function(a){return this._localeCompare(a)-String._equalityOffset};String.NormalizeDomString=function String$NormalizeDomString(a){return Owa.Utility.isIE()?a:a?a.replace(/\xa0/g," "):a};isNoE=String.isNullOrEmpty=function String$isNullOrEmpty(a){return a&&a.trim()!=""?0:1}})();(function(){Array.__rgInterfaces=[Owa.Collections.IList,Owa.Collections.IEnumerable];Array.prototype.get_Length=function Array$get_Length(){return this.length};Array.prototype.get_Item=function Array$get_Item(a){return this[a]};Array.prototype.get_Enumerator=function Array$get_Enumerator(){return new Owa.Collections.ListEnumerator(this)};Array.prototype.indexOf=function Array$indexOf(b){for(var a=0;a<this.length;a++)if(this[a]&&this[a]===b)return a;return-1};Array.prototype.remove=function Array$remove(b){var a=this.indexOf(b);a>-1&&this.splice(a,1);return a>-1};Array.prototype.removeAt=function Array$removeAt(a){if(a<this.length){this.splice(a,1);return true}return false};Array.prototype.add=function Array$add(a){this.push(a)};Array.prototype.clone=function Array$clone(){return this.slice()};isRg=Array.isArray=function Array$isArray(a){return a&&typeof a==Type.Const.Object?isDf(typeof a.length):false}})();(function(){Date.prototype.equals=function Date$equals(a){return Date.isInstance(a)&&this.gyr()==a.gyr()&&this.gmo()==a.gmo()&&this.gdt()==a.gdt()&&this.ghrs()==a.ghrs()&&this.gmins()==a.gmins()};Date.prototype.gsecs=function Date$gsecs(){return this.getUTCSeconds()};Date.prototype.gsecsl=function Date$gsecsl(){return this.getSeconds()};Date.prototype.gmins=function Date$gmins(){return this.getUTCMinutes()};Date.prototype.gminsl=function Date$gminsl(){return this.getMinutes()};Date.prototype.ghrs=function Date$ghrs(){return this.getUTCHours()};Date.prototype.ghrsl=function Date$ghrsl(){return this.getHours()};Date.prototype.gdt=function Date$gdt(){return this.getUTCDate()};Date.prototype.gdtl=function Date$gdtl(){return this.getDate()};Date.prototype.gmo=function Date$gmo(){return this.getUTCMonth()};Date.prototype.gmol=function Date$gmol(){return this.getMonth()};Date.prototype.gyr=function Date$gyr(){return this.getUTCFullYear()};Date.prototype.gyrl=function Date$gyrl(){return this.getFullYear()};Date.prototype.smsecs=function Date$smsecs(a){this.setUTCMilliseconds(a)};Date.prototype.ssecs=function Date$ssecs(b,a){this.setUTCSeconds(b,a?a:null)};Date.prototype.smins=function Date$smins(b,a){this.setUTCMinutes(b,a?a:null)};Date.prototype.shrs=function Date$shrs(c,a,b){this.setUTCHours(c,a?a:null,b?b:null)};Date.prototype.sdt=function Date$sdt(a){this.setUTCDate(a)};Date.prototype.smo=function Date$smo(b,a){this.setUTCMonth(b,a?a:null)};Date.prototype.syr=function Date$syr(c,b,a){this.setUTCFullYear(c,b?b:null,a?a:null)};Date.prototype.eThn=function Date$eThn(a){var b=Date.UTC(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDay(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds(),this.getUTCMilliseconds()),c=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDay(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds());return b<c};Date.timeInMs=function Date$timeInMs(){return(new Date).valueOf()};Date.prototype.toIsoString=function Date$toIsoString(){var f=this.gyr(),b=this.gmo()+1,c=this.gdt(),d=this.ghrs(),a=this.gmins(),e=this.gsecs();return f+"-"+(b<10?"0"+b:b)+"-"+(c<10?"0"+c:c)+"T"+(d<10?"0"+d:d)+":"+(a<10?"0"+a:a)+":"+(e<10?"0"+e:e)};Date.parseISOString=function Date$parseISOString(g){var d=g.split("T"),e=d[0],f=d[1],b=e.split("-"),c=f.split(":"),a=new Date;a.setUTCFullYear(Type.getInt(b[0]));a.setUTCMonth(Type.getInt(b[1])-1);a.setUTCDate(Type.getInt(b[2]));a.setUTCHours(Type.getInt(c[0]));a.setUTCMinutes(Type.getInt(c[1]));a.setUTCSeconds(Type.getInt(c[2].substr(0,2)));return a};Date.fromTicks=function Date$fromTicks(a){var c=6.21355968e13,b=a.substr(0,a.length-4),d=parseInt(b);return new Date(d-c)}})();(function(){Type.createNamespace("Owa.Type.Utility");isDf=Owa.Type.Utility.isDefined=function Owa$Type$Utility$isDefined(a){return a!=Type.Const.Undefined};getInt=Owa.Type.Utility.getInt=function Owa$Type$Utility$getInt(a){return parseInt(a,10)}})()})();g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()]=1;Type.createNamespace("Owa.Utility");!g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()]&&(function(){Owa.Utility.EventHandlerCollection=function Owa$Utility$EventHandlerCollection(){this._handlers=[];this._fLast=false};Owa.Utility.EventHandlerCollection.prototype.add=function Owa$Utility$EventHandlerCollection$add(a,b){if(this._fLast&&b)throw new Error('There can be only one "last" handler.');if(this._indexOf(a)==-1)if(this._fLast){var c=this._handlers.pop();this._handlers.push(a);this._handlers.push(c)}else{this._handlers.add(a);if(b)this._fLast=true}};Owa.Utility.EventHandlerCollection.prototype.clear=function Owa$Utility$EventHandlerCollection$clear(){this._handlers=[]};Owa.Utility.EventHandlerCollection.prototype.remove=function Owa$Utility$EventHandlerCollection$remove(b){var a=this._indexOf(b);if(a>=0){this._handlers.removeAt(a);return true}return false};Owa.Utility.EventHandlerCollection.prototype.get_IsEmpty=function Owa$Utility$EventHandlerCollection$get_IsEmpty(){return this._handlers.length==0};Owa.Utility.EventHandlerCollection.prototype.dispatch=function Owa$Utility$EventHandlerCollection$dispatch(a,b){return this.dispatchWithThisArg(null,a,b)};Owa.Utility.EventHandlerCollection.prototype.dispatchWithThisArg=function Owa$Utility$EventHandlerCollection$dispatchWithThisArg(g,e,f){for(var a=undefined,d=this._handlers.slice(0),c=0;c<d.length;++c){var b=d[c].call(g,e,f);if(b===false||b===0)a=false;else if(a!==false)a=b}return a};Owa.Utility.EventHandlerCollection.prototype._indexOf=function Owa$Utility$EventHandlerCollection$_indexOf(b){for(var a=0;a<this._handlers.length;++a)if(b==this._handlers[a])return a;else if(b._fnFunction&&this._handlers[a]._fnFunction)if(b._fnFunction==this._handlers[a]._fnFunction&&b._oThis==this._handlers[a]._oThis)return a;return-1}})();g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()]=1;var POST="POST",GET="GET";!g_fModuleLoaded[".\\dom/ajaxrequest.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Dom");var g=false,c=true,a=[];Owa.Dom.AjaxRequest=function Owa$Dom$AjaxRequest(e,k,j,f,d,h,i){var b;if(g)b=c?new XMLHttpRequest:new ActiveXObject("MSXML2.xmlhttp");else{try{b=new XMLHttpRequest;c=true}catch(l){b=new ActiveXObject("MSXML2.xmlhttp");c=false}g=true}this.oXmlHttp=b;this.oXmlHttp.open(k,e,!d);this.sUrl=e;this.oCtx=j;this.fSync=d;this.fLock=false;this._fNeverDispose=!!h;this.iIndex=a.length;this.cbCancel=i;this._fProcessXhrStatusZeroAsError=0;a.push(this);if(f)this.cb=f;if(!d)this.oXmlHttp.onreadystatechange=new Function("Owa.Dom.AjaxRequest._cbOnReadyStateChange("+this.iIndex+");");Owa.Dom.AjaxRequest.get_OnRequestCreated().dispatch(this)};Owa.Dom.AjaxRequest.prototype.send=function Owa$Dom$AjaxRequest$send(a){if(isDf(typeof a))this.oXmlHttp.send(a);else this.oXmlHttp.send(null);return this.fSync?this.onComplete():null};Owa.Dom.AjaxRequest.prototype.setRequestHeader=function Owa$Dom$AjaxRequest$setRequestHeader(b,a){this.oXmlHttp.setRequestHeader(b,a)};Owa.Dom.AjaxRequest.prototype.set_ProcessXhrStatusZeroAsError=function Owa$Dom$AjaxRequest$set_ProcessXhrStatusZeroAsError(){this._fProcessXhrStatusZeroAsError=1};Owa.Dom.AjaxRequest.prototype.cancelCallback=function Owa$Dom$AjaxRequest$cancelCallback(){if(this.fLock)return;this.fLock=true;a[this.iIndex].oXmlHttp.abort();delete a[this.iIndex];this.cbCancel&&this.cbCancel(this)};Owa.Dom.AjaxRequest.prototype.onComplete=function Owa$Dom$AjaxRequest$onComplete(){if(!this.fLock){this.fLock=true;Owa.Dom.AjaxRequest.get_OnResponseReceived().dispatch(this);var b=null;if(this.cb!=null)b=this.cb(this);delete a[this.iIndex];Owa.Dom.AjaxRequest.get_OnCallbackCompleted().dispatch(this);return b}};Owa.Dom.AjaxRequest._cbOnReadyStateChange=function Owa$Dom$AjaxRequest$_cbOnReadyStateChange(c){var b=a[c];if(b&&4==b.oXmlHttp.readyState)if(!b._fProcessXhrStatusZeroAsError&&0==b.oXmlHttp.status&&(Owa.Utility.isFirefox()||Owa.Utility.isSafari()||Owa.Utility.isChrome()))b.cancelCallback();else b.onComplete()};Owa.Dom.AjaxRequest.disposeAjaxRequests=function Owa$Dom$AjaxRequest$disposeAjaxRequests(){for(var b=0;b<a.length;b++)if(a[b]){var c=a[b];if(c._fNeverDispose)continue;Owa.Dom.AjaxRequest.abortAnXMLHttpRequest(c.oXmlHttp);a[b]=null}};Owa.Dom.AjaxRequest.AbortCriterion={NameSpaceAndCommand:"0",UnsentAndUrlMatch:"1"};Owa.Dom.AjaxRequest.abortAjaxRequests=function Owa$Dom$AjaxRequest$abortAjaxRequests(e,i,h,g){for(var b=null,d=0,c=0;c<a.length;c++){b=a[c];if(b&&(e==Owa.Dom.AjaxRequest.AbortCriterion.NameSpaceAndCommand&&b.oCtx&&isDf(typeof b.oCtx.sNs)&&b.oCtx.sNs==i&&isDf(typeof b.oCtx.sEv)&&isDf(typeof h[b.oCtx.sEv])||e==Owa.Dom.AjaxRequest.AbortCriterion.UnsentAndUrlMatch&&b.sUrl.indexOf(g)!=-1&&b.oXmlHttp.readyState<2)){if(b.fLock)continue;b.fLock=true;var f=Owa.Dom.AjaxRequest.abortAnXMLHttpRequest(b.oXmlHttp);if(f){a[c]=null;d++}}}return d};Owa.Dom.AjaxRequest.abortAnXMLHttpRequest=function Owa$Dom$AjaxRequest$abortAnXMLHttpRequest(a){if(isDf(typeof a)&&a&&isDf(typeof a.abort))try{a.onreadystatechange=function(){};a.abort();return true}catch(b){}return false};var f="onRequestCreated",e="onResponseReceived",d="onCallbackCompleted",b={};b[f]=new Owa.Utility.EventHandlerCollection;b[e]=new Owa.Utility.EventHandlerCollection;b[d]=new Owa.Utility.EventHandlerCollection;Owa.Dom.AjaxRequest.get_OnRequestCreated=function Owa$Dom$AjaxRequest$get_OnRequestCreated(){return b[f]};Owa.Dom.AjaxRequest.get_OnResponseReceived=function Owa$Dom$AjaxRequest$get_OnResponseReceived(){return b[e]};Owa.Dom.AjaxRequest.get_OnCallbackCompleted=function Owa$Dom$AjaxRequest$get_OnCallbackCompleted(){return b[d]}})();g_fModuleLoaded[".\\dom/ajaxrequest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/event.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Dom");Owa.Dom.Event=function Owa$Dom$Event(b,a){this._oEvent=b;this._oCurrentTarget=a};Owa.Dom.Event.prototype.isLeftButtonDown=function Owa$Dom$Event$isLeftButtonDown(){return typeof this._oEvent.which!="undefined"?Owa.Utility.isMac()&&this._oEvent.ctrlKey?false:this._oEvent.which==1:(this._oEvent.button&1)!=0};Owa.Dom.Event.prototype.isRightButtonDown=function Owa$Dom$Event$isRightButtonDown(){if(typeof this._oEvent.which!="undefined"){if(this._oEvent.which==3||Owa.Utility.isMac()&&this._oEvent.ctrlKey&&this._oEvent.which==1)return true}else return(this._oEvent.button&2)!=0};Owa.Dom.Event.prototype.isAltKeyDown=function Owa$Dom$Event$isAltKeyDown(){return this._oEvent.altKey};Owa.Dom.Event.prototype.isCtrlKeyDown=function Owa$Dom$Event$isCtrlKeyDown(){return Owa.Utility.isMac()?this._oEvent.metaKey:this._oEvent.ctrlKey};Owa.Dom.Event.prototype.isMacCtrlKeyDown=function Owa$Dom$Event$isMacCtrlKeyDown(){return Owa.Utility.isMac()&&this._oEvent.ctrlKey};Owa.Dom.Event.prototype.isShiftKeyDown=function Owa$Dom$Event$isShiftKeyDown(){return this._oEvent.shiftKey};Owa.Dom.Event.prototype.preventDefault=function Owa$Dom$Event$preventDefault(){this._oEvent.preventDefault?this._oEvent.preventDefault():(this._oEvent.returnValue=false)};Owa.Dom.Event.prototype.cancelBubble=function Owa$Dom$Event$cancelBubble(){this._oEvent.cancelBubble=true};Owa.Dom.Event.prototype.get_ClientX=function Owa$Dom$Event$get_ClientX(){return this._oEvent.clientX};Owa.Dom.Event.prototype.get_ClientY=function Owa$Dom$Event$get_ClientY(){return this._oEvent.clientY};Owa.Dom.Event.prototype.get_CurrentTarget=function Owa$Dom$Event$get_CurrentTarget(){if(!this._oWrapCurrentTarget&&this._oCurrentTarget)this._oWrapCurrentTarget=this._oCurrentTarget?Owa.Dom.EventTarget.wrapEventTarget(this._oCurrentTarget):null;return this._oWrapCurrentTarget};Owa.Dom.Event.prototype.get_Target=function Owa$Dom$Event$get_Target(){var a=this._oEvent.srcElement||this._oEvent.target;if(a&&typeof a.nodeType!="undefined"&&a.nodeType!=Owa.NodeType.Element)a=a.parentNode;return a?Owa.Dom.EventTarget.wrapEventTarget(a):null};Owa.Dom.Event.prototype.get_FromElementForMouseOver=function Owa$Dom$Event$get_FromElementForMouseOver(){if(this._oEvent.type!="mouseover")throw"Cannot call getFromElementForMouseOver for a non mouseOver event";var b=this._oEvent.fromElement||this._oEvent.relatedTarget,a=null;try{a=b?Owa.Dom.Node.wrapDomNode(b):null}catch(c){if(Owa.Utility.isFirefox())a=null;else throw c;}return a};Owa.Dom.Event.prototype.get_ToElementForMouseOut=function Owa$Dom$Event$get_ToElementForMouseOut(){if(this._oEvent.type!="mouseout")throw"Cannot call getToElementForMouseOut for a non mouseout event";var b=this._oEvent.toElement||this._oEvent.relatedTarget,a=null;try{a=b?Owa.Dom.Node.wrapDomNode(b):null}catch(c){if(Owa.Utility.isFirefox())a=null;else throw c;}return a};Owa.Dom.Event.prototype.get_KeyCodeForKeyUpDown=function Owa$Dom$Event$get_KeyCodeForKeyUpDown(){if(this._oEvent.type!="keyup"&&this._oEvent.type!="keydown")throw"Cannot get keyCode for events other than keyup or keydown";return this._oEvent.keyCode};Owa.Dom.Event.prototype.get_CharCodeForKeyPress=function Owa$Dom$Event$get_CharCodeForKeyPress(){if(this._oEvent.type!="keypress")throw"Cannot get char code for events other than keypress";return Owa.Utility.isIE()?this._oEvent.keyCode:this._oEvent.charCode};Owa.Dom.Event.prototype.get_Type=function Owa$Dom$Event$get_Type(){if(window.Components)switch(this._oEvent.type){case"draggesture":return"dragstart";case"dragdrop":return"drop";case"dragexit":return"dragleave";case"DOMMouseScroll":return"mousewheel";default:return this._oEvent.type}return this._oEvent.type};Owa.Dom.Event.prototype.get_WheelDirection=function Owa$Dom$Event$get_WheelDirection(){return this._oEvent.wheelDelta?this._oEvent.wheelDelta<0?1:-1:this._oEvent.detail>0?1:-1};Owa.Dom.Event.createClass("Owa.Dom.Event")})();g_fModuleLoaded[".\\dom/event.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Dom");Owa.Dom.EventTarget=function Owa$Dom$EventTarget(a){this._oTarget=a};Owa.Dom.EventTarget.prototype.attachEvent=function Owa$Dom$EventTarget$attachEvent(a,f,e){a=_mapEventName(a);var c=this._get_Target(),b=c.__eventHandlers;if(!b){b={};c.__eventHandlers=b}if(!b[a]){b[a]=new Owa.Utility.EventHandlerCollection;var d=c["on"+a];d&&b[a].add(d);if(typeof c.addEventListener!="undefined")c.addEventListener(a,Owa.Dom.EventTarget._dispatchEvent,false);else c["on"+a]=Owa.Dom.EventTarget._dispatchEvent}b[a].add(f,e);Owa.Dom.DisposeManager.add(this)};function _isCollectionEmpty(b){var a=true;for(var c in b)if(b[c]!=null){a=false;break}return a}Owa.Dom.EventTarget.prototype.detachEvent=function Owa$Dom$EventTarget$detachEvent(b,c){var a=this._get_Target();b=_mapEventName(b);if(a.__eventHandlers&&a.__eventHandlers[b]){a.__eventHandlers[b].remove(c);if(a.__eventHandlers[b].get_IsEmpty()){if(typeof a.removeEventListener=="undefined")a["on"+b]=null;else a.removeEventListener(b,Owa.Dom.EventTarget._dispatchEvent,false);a.__eventHandlers[b]=null}if(_isCollectionEmpty(a.__eventHandlers))a.__eventHandlers=null}};Owa.Dom.EventTarget.prototype.detachAllEvents=function Owa$Dom$EventTarget$detachAllEvents(b){var a=this._get_Target();b=_mapEventName(b);if(b){if(a.__eventHandlers&&a.__eventHandlers[b]){a.__eventHandlers[b]=null;a["on"+b]=null;if(_isCollectionEmpty(a.__eventHandlers))a.__eventHandlers=null}}else{for(var c in a.__eventHandlers){if(typeof a.removeEventListener=="undefined")a["on"+c]=null;else a.removeEventListener(c,Owa.Dom.EventTarget._dispatchEvent,false);a.__eventHandlers[c]=null}a.__eventHandlers=null}};Owa.Dom.EventTarget.prototype.dispose=function Owa$Dom$EventTarget$dispose(){Owa.Dom.DisposeManager.remove(this);this._internalDispose()};Owa.Dom.EventTarget.prototype._internalDispose=function Owa$Dom$EventTarget$_internalDispose(){this.detachAllEvents()};Owa.Dom.EventTarget._dispatchEvent=function Owa$Dom$EventTarget$_dispatchEvent(b){b=b||Owa.Dom.EventTarget._getEvent(this);a&&a();if(this.__eventHandlers){var c=new Owa.Dom.Event(b,this);if(this.__eventHandlers[b.type])return this.__eventHandlers[b.type].dispatchWithThisArg(this,c)}};Owa.Dom.EventTarget.prototype._clearPropertiesForClone=function Owa$Dom$EventTarget$_clearPropertiesForClone(){var a=this._get_Target();if(Owa.Utility.isIE())a.removeAttribute("__eventHandlers");else delete a.__eventHandlers};Owa.Dom.EventTarget._getEvent=function Owa$Dom$EventTarget$_getEvent(a){try{if(a.event)return a.event;if(a.ownerDocument)a=a.ownerDocument;return a.parentWindow.event}catch(b){Owa.BrowserErrorHandler.handleFrameAccessError(b)}};Owa.Dom.EventTarget.wrapEventTarget=function Owa$Dom$EventTarget$wrapEventTarget(a){return typeof a.navigator!="undefined"?new Owa.Dom.Window(a):Owa.Dom.Node.wrapDomNode(a)};Owa.Dom.EventTarget.set_OnBeforeDispatchEvent=function Owa$Dom$EventTarget$set_OnBeforeDispatchEvent(b){a=b};var a=null,b={mousewheel:"DOMMouseScroll"};function _mapEventName(c){var a;if(Owa.Utility.isFirefox())a=b[c];return a?a:c}Owa.Dom.EventTarget.prototype._get_Target=function Owa$Dom$EventTarget$_get_Target(){return this._oTarget};Owa.Dom.EventTarget.createClass("Owa.Dom.EventTarget")})();g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");!g_fModuleLoaded[".\\dom/window.js".toLowerCase()]&&(function(){Owa.Dom.Window=function Owa$Dom$Window(a){this._domWindow=a;Owa.Dom.Window.constructBase(this,[a])};var a;Owa.Dom.Window.get_Current=function Owa$Dom$Window$get_Current(){if(!a)a=new Owa.Dom.Window(window);return a};Owa.Dom.Window.dispose=function Owa$Dom$Window$dispose(){if(a){a.dispose();a=null}};Owa.Dom.Window.prototype.get_Document=function Owa$Dom$Window$get_Document(){return new Owa.Dom.Document(this._domWindow.document)};Owa.Dom.Window.prototype.get_FrameElement=function Owa$Dom$Window$get_FrameElement(){var a=null;try{a=this._domWindow.frameElement;if(a)a.ownerDocument}catch(b){a=null}return a?new Owa.Dom.Frame(a):null};Owa.Dom.Window.prototype.get_Name=function Owa$Dom$Window$get_Name(){return this._domWindow.name};Owa.Dom.Window.prototype.set_Name=function Owa$Dom$Window$set_Name(a){this._domWindow.name=a};Owa.Dom.Window.prototype.get_ParentWindow=function Owa$Dom$Window$get_ParentWindow(){var a;try{a=this._domWindow.parent}catch(b){a=null}if(a)a=new Owa.Dom.Window(a);return a};Owa.Dom.Window.prototype.get_TopWindow=function Owa$Dom$Window$get_TopWindow(){return new Owa.Dom.Window(this._domWindow.top)};Owa.Dom.Window.prototype.get_Location=function Owa$Dom$Window$get_Location(){return this._domWindow.location};Owa.Dom.Window.prototype.get_Opener=function Owa$Dom$Window$get_Opener(){var a;try{a=this._domWindow.dialogArguments&&this._domWindow.dialogArguments.opener?this._domWindow.dialogArguments.opener:this._domWindow.opener?this._domWindow.opener:null;if(a&&a.closed)a=null}catch(b){a=null}return a?new Owa.Dom.Window(a):null};Owa.Dom.Window.prototype.setTimeout=function Owa$Dom$Window$setTimeout(b,a){return this._domWindow.setTimeout(b,a)};Owa.Dom.Window.prototype.clearTimeout=function Owa$Dom$Window$clearTimeout(a){this._domWindow.clearTimeout(a)};Owa.Dom.Window.prototype.setInterval=function Owa$Dom$Window$setInterval(b,a){return this._domWindow.setInterval(b,a)};Owa.Dom.Window.prototype.clearInterval=function Owa$Dom$Window$clearInterval(a){this._domWindow.clearInterval(a)};Owa.Dom.Window.prototype.close=function Owa$Dom$Window$close(){this._domWindow.close()};Owa.Dom.Window.prototype.moveTo=function Owa$Dom$Window$moveTo(a,b){this._domWindow.moveTo(a,b)};Owa.Dom.Window.prototype.resizeTo=function Owa$Dom$Window$resizeTo(b,a){this._domWindow.resizeTo(b,a)};Owa.Dom.Window.prototype.resizeBy=function Owa$Dom$Window$resizeBy(b,a){this._domWindow.resizeBy(b,a)};Owa.Dom.Window.prototype.open=function Owa$Dom$Window$open(c,b,a){if(!c)c="";if(!b)b="";if(!a)a="";return new Owa.Dom.Window(this._domWindow.open(c,b,a))};Owa.Dom.Window.prototype.print=function Owa$Dom$Window$print(){this._domWindow.print()};Owa.Dom.Window.prototype.scrollTo=function Owa$Dom$Window$scrollTo(a,b){this._domWindow.scrollTo(a,b)};Owa.Dom.Window.prototype.scrollBy=function Owa$Dom$Window$scrollBy(a,b){this._domWindow.scrollBy(a,b)};Owa.Dom.Window.prototype.navigate=function Owa$Dom$Window$navigate(a){if(this._domWindow.navigate)this._domWindow.navigate(a);else this._domWindow.location=a};Owa.Dom.Window.prototype.equals=function Owa$Dom$Window$equals(a){return a==null?false:this._domWindow==null?false:this._domWindow==a._domWindow};function checkIfValidVariableName(a){switch(a){case"document":case"href":case"navigate":case"scrollBy":case"scrollTo":case"print":case"frameElement":case"length":case"name":case"parent":case"top":case"location":case"navigator":case"opener":case"screenX":case"screenY":case"setTimeout":case"clearTimeout":case"setInterval":case"clearInterval":case"open":case"close":case"moveTo":case"resizeTo":throw new Error("can't access dom functionlity");}if(a.contains("."))throw new Error("can't access nested variable");}Owa.Dom.Window.prototype.getGlobalVariable=function Owa$Dom$Window$getGlobalVariable(a){checkIfValidVariableName(a);try{return this._domWindow[a]}catch(b){return null}};Owa.Dom.Window.prototype.setGlobalVariable=function Owa$Dom$Window$setGlobalVariable(a,b){checkIfValidVariableName(a);try{this._domWindow[a]=b}catch(c){}};Owa.Dom.Window.prototype.invokeFunction=function Owa$Dom$Window$invokeFunction(f,a,b){var d=this._domWindow.invoke;if(d===invoke){b=b||window;a=a||[];if(!(a instanceof Array)){for(var g=[],c=0;c<a.length;c++)g[c]=a[c];a=g}return b[f].apply(b,a)}else if(d){var e=d(f,a,b);if(e.error)throw e.error;return e.result}};Owa.Dom.Window.createClass("Owa.Dom.Window",Owa.Dom.EventTarget);Owa.Dom.Window.prototype.is_Closed=function Owa$Dom$Window$is_Closed(){try{return this._domWindow.closed}catch(a){return true}}})();g_fModuleLoaded[".\\dom/window.js".toLowerCase()]=1;function invoke(e,d,b){b=b?b:window;var g=[];if(d)for(var c=0;c<d.length;c++)g[c]=d[c];var f=b[e],a={};if(!f){a.error=new Error(e+" is undefined");return a}try{a.result=f.apply(b,g)}catch(h){a.error=h;return a}return a}!g_fModuleLoaded[".\\dom/disposemanager.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Dom.DisposeManager");var a;Owa.Dom.DisposeManager.add=function Owa$Dom$DisposeManager$add(b){if(!isInCurrentWindow(b))return;!a&&initializeDisposeManager();indexOf(b)==-1&&a.push(b)};Owa.Dom.DisposeManager.remove=function Owa$Dom$DisposeManager$remove(c){var b=indexOf(c);b>-1&&a.splice(b,1)};function initializeDisposeManager(){a=[];Owa.Dom.Window.get_Current().attachEvent("unload",onWindowUnload,true)}function onWindowUnload(){for(var b=0;b<a.length;b++){a[b]._internalDispose();a[b]=null}a=null}function indexOf(c){for(var b=a.length-1;b>=0;b--)if(a[b]._oTarget===c._oTarget)return b;return-1}function isInCurrentWindow(a){return Owa.Dom.Window.get_Current().equals(a)||Owa.Dom.Document.get_Current().equals(a)||Owa.Dom.NonSingletonNode.isInstance(a)&&Owa.Dom.Document.get_Current().equals(a.get_OwnerDocument())}})();g_fModuleLoaded[".\\dom/disposemanager.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");Owa.NodeType={Element:1,Text:3,Comment:8,Document:9};function $(a){return Owa.Dom.Document.get_Current().getElementById(a)}!g_fModuleLoaded[".\\dom/node.js".toLowerCase()]&&(function(){Owa.Dom.Node=function Owa$Dom$Node(a){Owa.Dom.Node._setupBase();this._oDomNode=a;this._oTarget=a};Owa.Dom.Node.wrapDomNode=function Owa$Dom$Node$wrapDomNode(a){var b=null;switch(a.nodeType){case Owa.NodeType.Element:var c=a.tagName;if(c=="IFRAME")b=new Owa.Dom.Frame(a);else if(c=="INPUT"||c=="TEXTAREA"||c=="BUTTON"||c=="SELECT")b=new Owa.Dom.Input(a);else b=new Owa.Dom.Element(a);break;case Owa.NodeType.Document:b=new Owa.Dom.Document(a);break;default:b=new Owa.Dom.NonSingletonNode(a)}return b};Owa.Dom.Node.wrapXmlDomNode=function Owa$Dom$Node$wrapXmlDomNode(a){switch(a.nodeType){case Owa.NodeType.Element:return new Owa.Dom.XmlElement(a);case Owa.NodeType.Document:return new Owa.Dom.XmlDocument(a);default:return new Owa.Dom.NonSingletonNode(a)}};Owa.Dom.Node.prototype.get_NodeType=function Owa$Dom$Node$get_NodeType(){return this._get_DomNode().nodeType};Owa.Dom.Node.prototype.contains=function Owa$Dom$Node$contains(b){if(this.get_NodeType()==Owa.NodeType.Element&&b.get_NodeType()==Owa.NodeType.Element&&typeof this._get_DomNode().contains!="undefined")return this._get_DomNode().contains(b._get_DomNode());else{var a=b._get_DomNode();do{if(a==this._get_DomNode())return true;a=a.parentNode}while(a);return false}};Owa.Dom.Node.OwaExpandosName="__OwaExpandos";Owa.Dom.Node.prototype.setExpando=function Owa$Dom$Node$setExpando(c,b){var a=this._get_DomNode();if(typeof a[Owa.Dom.Node.OwaExpandosName]=="undefined"||a[Owa.Dom.Node.OwaExpandosName]==null)a[Owa.Dom.Node.OwaExpandosName]={};a[Owa.Dom.Node.OwaExpandosName][c]=b;Owa.Dom.DisposeManager.add(this)};Owa.Dom.Node.prototype.getExpando=function Owa$Dom$Node$getExpando(b){var a=this._get_DomNode()[Owa.Dom.Node.OwaExpandosName];return!!a?a[b]:null};Owa.Dom.Node.prototype.clearAllExpandos=function Owa$Dom$Node$clearAllExpandos(){this._get_DomNode()[Owa.Dom.Node.OwaExpandosName]=null};Owa.Dom.Node.prototype.equals=function Owa$Dom$Node$equals(a){return a==null?false:this._oDomNode==null?false:this._oDomNode==a._oDomNode};Owa.Dom.Node.prototype._wrapNode=function Owa$Dom$Node$_wrapNode(a){return Owa.Dom.Node.wrapDomNode(a)};Owa.Dom.Node.prototype._get_DomNode=function Owa$Dom$Node$_get_DomNode(){return this._oDomNode};Owa.Dom.Node.prototype._internalDispose=function Owa$Dom$Node$_internalDispose(){var a=this._get_DomNode();if("__OwaExpandos"in a){for(var b in a[Owa.Dom.Node.OwaExpandosName])a[Owa.Dom.Node.OwaExpandosName][b]=null;a[Owa.Dom.Node.OwaExpandosName]=null}Owa.Dom.Node.callBase(this,"_internalDispose")};Owa.Dom.Node.prototype._clearPropertiesForClone=function Owa$Dom$Node$_clearPropertiesForClone(){var a=this._get_DomNode();if(Owa.Utility.isIE())a.removeAttribute(Owa.Dom.Node.OwaExpandosName);else delete a[Owa.Dom.Node.OwaExpandosName];Owa.Dom.Node.callBase(this,"_clearPropertiesForClone")};Owa.Dom.Node.createClass("Owa.Dom.Node",Owa.Dom.EventTarget)})();g_fModuleLoaded[".\\dom/node.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()]&&(function(){Owa.Dom.DocumentBase=function Owa$Dom$DocumentBase(a){Owa.Dom.DocumentBase.constructBase(this,[a])};Owa.Dom.DocumentBase.prototype.get_DocumentElement=function Owa$Dom$DocumentBase$get_DocumentElement(){var a=this._get_DomDocument().documentElement;return a?this._wrapNode(a):null};Owa.Dom.DocumentBase.prototype.appendChild=function Owa$Dom$DocumentBase$appendChild(){throw"Cannot call an abstract method";};Owa.Dom.DocumentBase.prototype.createElement=function Owa$Dom$DocumentBase$createElement(a){return this._wrapNode(this._get_DomDocument().createElement(a))};Owa.Dom.DocumentBase.prototype._get_DomDocument=function Owa$Dom$DocumentBase$_get_DomDocument(){return this._get_DomNode()};Owa.Dom.DocumentBase.createClass("Owa.Dom.DocumentBase",Owa.Dom.Node)})();g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");!g_fModuleLoaded[".\\dom/cssstylerule.js".toLowerCase()]&&(function(){Owa.Dom.cssStyleRule=function Owa$Dom$cssStyleRule(a){this._oDomRule=a};Owa.Dom.cssStyleRule.prototype.get_SelectorText=function Owa$Dom$cssStyleRule$get_SelectorText(){return this._oDomRule.selectorText};Owa.Dom.cssStyleRule.prototype.get_CssText=function Owa$Dom$cssStyleRule$get_CssText(){return this._oDomRule.style.cssText}})();g_fModuleLoaded[".\\dom/cssstylerule.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");!g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()]&&(function(){Owa.Dom.StyleSheet=function Owa$Dom$StyleSheet(a){this._oDomStyleSheet=a};Owa.Dom.StyleSheet.prototype.get_OwnerNode=function Owa$Dom$StyleSheet$get_OwnerNode(){return Owa.Utility.isDefined(typeof this._oDomStyleSheet.ownerNode)?Owa.Dom.Node.wrapDomNode(this._oDomStyleSheet.ownerNode):Owa.Dom.Node.wrapDomNode(this._oDomStyleSheet.owningElement)};Owa.Dom.StyleSheet.prototype.get_Id=function Owa$Dom$StyleSheet$get_Id(){return this.get_OwnerNode().get_Id()};Owa.Dom.StyleSheet.prototype.remove=function Owa$Dom$StyleSheet$remove(){this.get_OwnerNode().remove(1)};Owa.Dom.StyleSheet.prototype.addRule=function Owa$Dom$StyleSheet$addRule(a,b){if(typeof this._oDomStyleSheet.addRule!="undefined")this._oDomStyleSheet.addRule(a,b);else{sStyleRule=a+" {"+b+"}";this._oDomStyleSheet.insertRule(sStyleRule,this._oDomStyleSheet.cssRules.length);this._oDomStyleSheet.ownerNode.innerHTML=this._oDomStyleSheet.ownerNode.innerHTML+sStyleRule}};Owa.Dom.StyleSheet.prototype.removeRule=function Owa$Dom$StyleSheet$removeRule(a){if(typeof this._oDomStyleSheet.removeRule!="undefined")this._oDomStyleSheet.removeRule(a);else this._oDomStyleSheet.deleteRule(a)};Owa.Dom.StyleSheet.prototype.get_RulesCount=function Owa$Dom$StyleSheet$get_RulesCount(){var a=this._oDomStyleSheet;return a.cssRules?a.cssRules.length:a.rules.length};Owa.Dom.StyleSheet.prototype.getRuleAt=function Owa$Dom$StyleSheet$getRuleAt(b){var a=this._oDomStyleSheet,c=a.cssRules?a.cssRules[b]:a.rules[b];return c?new Owa.Dom.cssStyleRule(c):null}})();g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/document.js".toLowerCase()]&&(function(){Owa.Dom.Document=function Owa$Dom$Document(a){this._oContainerWindow=null;Owa.Dom.Document.constructBase(this,[a])};var a;Owa.Dom.Document.get_Current=function Owa$Dom$Document$get_Current(){if(!a)a=new Owa.Dom.Document(document);return a};Owa.Dom.Document.dispose=function Owa$Dom$Document$dispose(){if(a){a.dispose();a=null}};Owa.Dom.Document.prototype.get_Title=function Owa$Dom$Document$get_Title(){var a=this._get_DomDocument().title;if(!a)a="";return a};Owa.Dom.Document.prototype.set_Title=function Owa$Dom$Document$set_Title(a){this._get_DomDocument().title=a};Owa.Dom.Document.prototype.get_ContainerWindow=function Owa$Dom$Document$get_ContainerWindow(){if(!this._oContainerWindow){var a=this._get_DomDocument(),b=typeof a.defaultView!="undefined"?a.defaultView:a.parentWindow;if(b==window)this._oContainerWindow=Owa.Dom.Window.get_Current();else this._oContainerWindow=new Owa.Dom.Window(b)}return this._oContainerWindow};Owa.Dom.Document.prototype.getElementById=function Owa$Dom$Document$getElementById(d){var b=null;if(this._get_DomDocument().all){var a=this._get_DomDocument().all[d];if(a){if(!Owa.Utility.isArray(a))a=[a];for(var c=0;c<a.length;c++)if(a[c].id==d){b=a[c];break}}}else b=this._get_DomDocument().getElementById(d);return b?Owa.Dom.Node.wrapDomNode(b):null};Owa.Dom.Document.prototype.getElementsByName=function Owa$Dom$Document$getElementsByName(d){for(var c=this._get_DomDocument().getElementsByName(d),b=[],a=0;a<c.length;++a)b.add(Owa.Dom.Node.wrapDomNode(c[a]));return b};Owa.Dom.Document.prototype.appendChild=function Owa$Dom$Document$appendChild(a){return Owa.Dom.Node.wrapDomNode(this._get_DomDocument().body.appendChild(a._get_DomNode()))};Owa.Dom.Document.prototype.get_StyleSheetCount=function Owa$Dom$Document$get_StyleSheetCount(){return this._get_DomDocument().styleSheets.length};Owa.Dom.Document.prototype.getStyleSheetAt=function Owa$Dom$Document$getStyleSheetAt(b){var a=this._get_DomDocument().styleSheets[b];return a?new Owa.Dom.StyleSheet(a):null};Owa.Dom.Document.prototype.getStyleSheetByAttribute=function Owa$Dom$Document$getStyleSheetByAttribute(e,d){for(var c=this._get_DomDocument().styleSheets,a=0;a<c.length;a++){var b=new Owa.Dom.StyleSheet(c[a]);if(b.get_OwnerNode().getAttribute(e)==d)return b}return 0};Owa.Dom.Document.prototype.importStyleSheet=function Owa$Dom$Document$importStyleSheet(c){var a=this._get_DomDocument();(!a.getElementsByTagName("head")||a.getElementsByTagName("head").length==0)&&a.body.parentNode.insertBefore(a.createElement("head"),a.body);if(typeof a.createStyleSheet!="undefined")return new Owa.Dom.StyleSheet(a.createStyleSheet(c));else{var b=a.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c;a.getElementsByTagName("head")[0].appendChild(b);return new Owa.Dom.StyleSheet(b)}};Owa.Dom.Document.prototype.insertBlankStyleSheet=function Owa$Dom$Document$insertBlankStyleSheet(d,c){var a=this._get_DomDocument(),b;(!a.getElementsByTagName("head")||a.getElementsByTagName("head").length==0)&&a.body.parentNode.insertBefore(a.createElement("head"),a.body);if(typeof a.createStyleSheet!="undefined"){b=a.createStyleSheet();d!=null&&b.owningElement.setAttribute("id",d);if(c)b.media=c}else{var e=a.createElement("style");e.type="text/css";if(d!=null)e.id=d;if(c)e.media=c;a.getElementsByTagName("head")[0].appendChild(e);b=a.styleSheets[a.styleSheets.length-1]}return new Owa.Dom.StyleSheet(b)};Owa.Dom.Document.prototype.open=function Owa$Dom$Document$open(){this._get_DomDocument().open()};Owa.Dom.Document.prototype.write=function Owa$Dom$Document$write(a){this._get_DomDocument().write(a)};Owa.Dom.Document.prototype.close=function Owa$Dom$Document$close(){this._get_DomDocument().close()};Owa.Dom.Document.prototype.get_IsDesignMode=function Owa$Dom$Document$get_IsDesignMode(){return this._get_DomDocument().designMode.toLowerCase()=="on"};Owa.Dom.Document.prototype.set_DesignMode=function Owa$Dom$Document$set_DesignMode(a){this._get_DomDocument().designMode=a?"on":"off"};Owa.Dom.Document.prototype.set_IsRtl=function Owa$Dom$Document$set_IsRtl(b){var c=this._get_DomDocument(),a=c.getElementsByTagName("html")[0];a.dir=b?"rtl":"ltr"};Owa.Dom.Document.prototype.get_IsRtl=function Owa$Dom$Document$get_IsRtl(){var b=this._get_DomDocument(),a=b.getElementsByTagName("html")[0];return a.dir.toLowerCase()=="rtl"};Owa.Dom.Document.prototype.get_Body=function Owa$Dom$Document$get_Body(){return Owa.Dom.Node.wrapDomNode(this._get_DomDocument().body)};Owa.Dom.Document.createClass("Owa.Dom.Document",Owa.Dom.DocumentBase)})();g_fModuleLoaded[".\\dom/document.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()]&&(function(){Owa.Dom.NonSingletonNode=function Owa$Dom$NonSingletonNode(a){Owa.Dom.NonSingletonNode._setupBase();this._oDomNode=a;this._oTarget=a};Owa.Dom.NonSingletonNode.prototype.get_OwnerDocument=function Owa$Dom$NonSingletonNode$get_OwnerDocument(){var a=this._get_DomNode().ownerDocument;return a==document?Owa.Dom.Document.get_Current():this._wrapNode(a)};Owa.Dom.NonSingletonNode.prototype.clone=function Owa$Dom$NonSingletonNode$clone(a){return this._wrapNode(this._get_DomNode().cloneNode(a))};Owa.Dom.NonSingletonNode.prototype.get_FirstChild=function Owa$Dom$NonSingletonNode$get_FirstChild(){var a=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.firstChild,"nextSibling");return a==null?null:this._wrapNode(a)};Owa.Dom.NonSingletonNode.prototype.get_LastChild=function Owa$Dom$NonSingletonNode$get_LastChild(){var a=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.lastChild,"previousSibling");return a==null?null:this._wrapNode(a)};Owa.Dom.NonSingletonNode.prototype.get_NextSibling=function Owa$Dom$NonSingletonNode$get_NextSibling(){var a=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.nextSibling,"nextSibling");return a==null?null:this._wrapNode(a)};Owa.Dom.NonSingletonNode.prototype.get_PreviousSibling=function Owa$Dom$NonSingletonNode$get_PreviousSibling(){var a=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.previousSibling,"previousSibling");return a==null?null:this._wrapNode(a)};Owa.Dom.Node.prototype.get_ParentElement=function Owa$Dom$Node$get_ParentElement(){var b=this._get_DomNode().parentNode,a=null;if(b&&b.nodeType==Owa.NodeType.Element)a=b;return a?this._wrapNode(a):null};Owa.Dom.NonSingletonNode.prototype.getAncestorByTag=function Owa$Dom$NonSingletonNode$getAncestorByTag(c){var b=c.toUpperCase(),a=this._get_DomNode();do a=a.parentNode.nodeType==Owa.NodeType.Element?a.parentNode:null;while(a&&a.tagName.toUpperCase()!=b);return a?this._wrapNode(a):null};Owa.Dom.NonSingletonNode.prototype.getAncestorById=function Owa$Dom$NonSingletonNode$getAncestorById(c,b){var a=this;while(a&&a.get_Id()!=c){if(b&&a.get_Id()==b)return null;a=a.get_ParentElement()}return a};Owa.Dom.NonSingletonNode.prototype.getAncestorByClass=function Owa$Dom$NonSingletonNode$getAncestorByClass(c,b){var a=this;do{if(b&&a.hasCssClass(b))return null;a=a.get_ParentElement()}while(a&&!a.hasCssClass(c));return a};Owa.Dom.NonSingletonNode.prototype.get_TextContent=function Owa$Dom$NonSingletonNode$get_TextContent(){return String.NormalizeDomString(this._get_DomNode().nodeValue)};Owa.Dom.NonSingletonNode.prototype.set_TextContent=function Owa$Dom$NonSingletonNode$set_TextContent(a){this._get_DomNode().nodeValue=a};Owa.Dom.NonSingletonNode.prototype.remove=function Owa$Dom$NonSingletonNode$remove(a){Owa.Dom.NonSingletonNode._removeDomNode(this._get_DomNode(),a);return this};Owa.Dom.NonSingletonNode.prototype.replace=function Owa$Dom$NonSingletonNode$replace(c){var a=this._get_DomNode(),b=c._get_DomNode();if(typeof a.replaceNode!="undefined")a.replaceNode(b);else return a.parentNode.replaceChild(b,a);return this};Owa.Dom.NonSingletonNode._isIgnorableNode=function Owa$Dom$NonSingletonNode$_isIgnorableNode(a){return a.nodeType==Owa.NodeType.Comment||Owa$Dom$NonSingletonNode$__isWhiteSpaceOnlyTextNode(a)};Owa.Dom.NonSingletonNode._removeDomNode=function Owa$Dom$NonSingletonNode$_removeDomNode(a,b){if(typeof a.removeNode!="undefined")a.removeNode(b);else if(b||!a.hasChildNodes())a.parentNode&&a.parentNode.removeChild(a);else{var c=a.ownerDocument.createRange();c.selectNodeContents(a);a.parentNode&&a.parentNode.replaceChild(c.extractContents(),a)}};function Owa$Dom$NonSingletonNode$__returnFirstValidNode(a,b){while(true)if(a==null)return null;else if(Owa.Dom.NonSingletonNode._isIgnorableNode(a))a=a[b];else return a}function Owa$Dom$NonSingletonNode$__isWhiteSpaceOnlyTextNode(a){return a.nodeType==Owa.NodeType.Text&&!/[^\t\n\r ]/.test(a.data)}Owa.Dom.NonSingletonNode.createClass("Owa.Dom.NonSingletonNode",Owa.Dom.Node)})();g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()]&&(function(){Owa.Dom.ElementBase=function Owa$Dom$ElementBase(a){Owa.Dom.ElementBase._setupBase();this._oDomNode=a;this._oTarget=a};Owa.Utility.inherit(Owa.Dom.ElementBase,Owa.Dom.NonSingletonNode);Owa.Dom.ElementBase.prototype.get_TagName=function Owa$Dom$ElementBase$get_TagName(){return this._get_DomNode().tagName};Owa.Dom.ElementBase.prototype.setAttribute=function Owa$Dom$ElementBase$setAttribute(b,a){if(typeof a=="undefined"||a==null)this._get_DomNode().removeAttribute(b);else this._get_DomNode().setAttribute(b,a)};Owa.Dom.ElementBase.prototype.getAttribute=function Owa$Dom$ElementBase$getAttribute(b){var a=this._get_DomNode().getAttribute(b);if(typeof a=="undefined"||a==null)return null;else if(typeof a!="string")throw"Cannot get the attribute of none string type on IE";else return String.NormalizeDomString(a)};Owa.Dom.ElementBase.prototype.removeAttribute=function Owa$Dom$ElementBase$removeAttribute(a){this._get_DomNode().removeAttribute(a)};Owa.Dom.ElementBase.prototype.setIntAttribute=function Owa$Dom$ElementBase$setIntAttribute(b,a){this.setAttribute(b,a.toString(10))};Owa.Dom.ElementBase.prototype.getIntAttribute=function Owa$Dom$ElementBase$getIntAttribute(b){var a=this.getAttribute(b);if(a==null)a="";return parseInt(a,10)};Owa.Dom.ElementBase.prototype.setBoolAttribute=function Owa$Dom$ElementBase$setBoolAttribute(c,a){var b=Boolean.isInstance(a)||typeof a=="string"&&(a.toLowerCase()=="true"||a.toLowerCase()=="false")||(parseInt(a,10)==1||parseInt(a,10)==0);if(!b)throw"fValue "+a+" is not a valid boolean value.";this.setAttribute(c,a.toString(10))};Owa.Dom.ElementBase.prototype.getBoolAttribute=function Owa$Dom$ElementBase$getBoolAttribute(b){var a=this._get_DomNode().getAttribute(b);return typeof a=="string"&&a.toLowerCase()=="true"||parseInt(a,10)==1?true:false};Owa.Dom.ElementBase.prototype.forEachChild=function Owa$Dom$ElementBase$forEachChild(e,f){for(var d=this._get_DomNode().childNodes,a=0;a<d.length;a++){var b=d[a];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(b)){var c=this._wrapNode(b);if(e(c,f))return c}}return 0};Owa.Dom.ElementBase.prototype.hasChildNodes=function Owa$Dom$ElementBase$hasChildNodes(){var a=this._get_DomNode(),c=false;if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(d)){c=true;break}}return c};Owa.Dom.ElementBase.prototype.appendChild=function Owa$Dom$ElementBase$appendChild(a){this._get_DomNode().appendChild(a._get_DomNode());return a};Owa.Dom.ElementBase.prototype.removeChild=function Owa$Dom$ElementBase$removeChild(a){this._get_DomNode().removeChild(a._get_DomNode());return a};Owa.Dom.ElementBase.prototype.removeAllChildNodes=function Owa$Dom$ElementBase$removeAllChildNodes(){var a=this._get_DomNode();while(a.hasChildNodes())a.removeChild(a.lastChild)};Owa.Dom.ElementBase.prototype.replaceChild=function Owa$Dom$ElementBase$replaceChild(b,a){this._get_DomNode().replaceChild(b._get_DomNode(),a._get_DomNode());return a};Owa.Dom.ElementBase.prototype.swap=function Owa$Dom$ElementBase$swap(a){if(this._get_DomNode().swapNode)this._get_DomNode().swapNode(a._get_DomNode());else{var b=this.get_OwnerDocument().createElement("div");a.get_ParentElement().replaceChild(b,a);this.get_ParentElement().replaceChild(a,this);b.get_ParentElement().replaceChild(this,b)}};Owa.Dom.ElementBase.createClass("Owa.Dom.ElementBase",Owa.Dom.NonSingletonNode)})();g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/element.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Style");Owa.Style.Side={Top:"top",Right:"right",Bottom:"bottom",Left:"left"};Owa.Style.Unit={Pixels:"px",Percent:"%",Points:"pt",Em:"em"};Owa.Style.Positioning={Fixed:"fixed",Absolute:"absolute",Relative:"relative",Static:"static",Inherit:"inherit",Default:""};Owa.Style.Overflow={Auto:"auto",Hidden:"hidden",Scroll:"scroll",Visible:"visible",Inherit:"inherit",Default:""};var b={None:"none",Inherit:"inherit",Default:""};Owa.Style.Visibility={Visible:"visible",Hidden:"hidden",Collapse:"collapse",Inherit:"inherit",Default:""};Owa.Style.FontWeight={Normal:"normal",Bold:"bold",Bolder:"bolder",Lighter:"lighter",i100:"100",i200:"200",i300:"300",i400:"400",i500:"500",i600:"600",i700:"700",i800:"800",i900:"900"};Owa.ElementInsertionPoint={BeforeBegin:"beforeBegin",AfterBegin:"afterBegin",BeforeEnd:"beforeEnd",AfterEnd:"afterEnd"};Owa.Dom.Element=function Owa$Dom$Element(a){if(!a)throw"the DOM object is null";Owa.Dom.Element._setupBase();this._oDomNode=a;this._oTarget=a};Owa.Dom.Element.prototype._internalDispose=function Owa$Dom$Element$_internalDispose(){if(this._get_DomNode().oOriginalParent)this._get_DomNode().oOriginalParent=null;Owa.Dom.Element.callBase(this,"_internalDispose")};var f=function $toUnitEnum$(a){switch(a){case Owa.Style.Unit.Pixels:case Owa.Style.Unit.Percent:case Owa.Style.Unit.Points:case Owa.Style.Unit.Em:return a;break;default:throw a+" unknown unit type";}},a=function $toOverflowEnum$(a){switch(a){case Owa.Style.Overflow.Auto:case Owa.Style.Overflow.Hidden:case Owa.Style.Overflow.Scroll:case Owa.Style.Overflow.Visible:case Owa.Style.Overflow.Inherit:case Owa.Style.Overflow.Default:return a;break;default:throw a+" unknown overflow type";}},e=function $toVisibilityEnum$(a){switch(a){case Owa.Style.Visibility.Visible:case Owa.Style.Visibility.Hidden:case Owa.Style.Visibility.Collapse:case Owa.Style.Visibility.Inherit:case Owa.Style.Visibility.Default:return a;break;default:throw a+" unknown visibility type";}},d=function $toFontWeightEnum$(a){switch(a){case Owa.Style.FontWeight.Normal:case Owa.Style.FontWeight.Bold:case Owa.Style.FontWeight.Bolder:case Owa.Style.FontWeight.Lighter:case Owa.Style.FontWeight.i100:case Owa.Style.FontWeight.i200:case Owa.Style.FontWeight.i300:case Owa.Style.FontWeight.i500:case Owa.Style.FontWeight.i600:case Owa.Style.FontWeight.i800:case Owa.Style.FontWeight.i900:return a;break;case Owa.Style.FontWeight.i400:return Owa.Style.FontWeight.Normal;case Owa.Style.FontWeight.i700:return Owa.Style.FontWeight.Bold;default:throw a+" unknown fontweight type";}};Owa.Dom.Element.prototype.get_Id=function Owa$Dom$Element$get_Id(){return this._get_DomNode().id};Owa.Dom.Element.prototype.set_Id=function Owa$Dom$Element$set_Id(a){this._get_DomNode().id=a};Owa.Dom.Element.prototype.get_Title=function Owa$Dom$Element$get_Title(){return this._get_DomNode().title};Owa.Dom.Element.prototype.set_Title=function Owa$Dom$Element$set_Title(a){this._get_DomNode().title=a};Owa.Dom.Element.prototype.get_Name=function Owa$Dom$Element$get_Name(){return this._oDomNode.name};Owa.Dom.Element.prototype.set_Name=function Owa$Dom$Element$set_Name(a){this._oDomNode.name=a};Owa.Dom.Element.prototype._get_OffsetParent=function Owa$Dom$Element$_get_OffsetParent(){var a=this._get_DomNode().offsetParent;return a!=null?Owa.Dom.Node.wrapDomNode(a):null};Owa.Dom.Element.prototype.get_TextContent=function Owa$Dom$Element$get_TextContent(){return typeof this._get_DomNode().textContent!="undefined"?String.NormalizeDomString(this._get_DomNode().textContent):this._get_DomNode().innerText};Owa.Dom.Element.prototype.set_TextContent=function Owa$Dom$Element$set_TextContent(a){if(typeof this._get_DomNode().textContent!="undefined")this._get_DomNode().textContent=a;else this._get_DomNode().innerText=a};Owa.Dom.Element.prototype.get_InnerHtml=function Owa$Dom$Element$get_InnerHtml(){return this._get_DomNode().innerHTML};Owa.Dom.Element.prototype.set_InnerHtml=function Owa$Dom$Element$set_InnerHtml(a){this._get_DomNode().innerHTML=a};Owa.Dom.Element.prototype.set_InnerHtmlIEWorkaround=function Owa$Dom$Element$set_InnerHtmlIEWorkaround(b){if(!Owa.Utility.isIE())throw"set_innerHtmlIEWorkaround is only supported for IE";var a=this.clone(1);a._get_DomNode().innerHTML=b;this.get_ParentElement().replaceChild(a,this)};Owa.Dom.Element.prototype.get_OuterHtml=function Owa$Dom$Element$get_OuterHtml(){if(typeof this._get_DomNode().outerHTML!="undefined")return this._get_DomNode().outerHTML;else{var b=this._get_DomNode().ownerDocument,c=this._get_DomNode().cloneNode(true),a=b.createElement("div");b.documentElement.appendChild(a);a.appendChild(c);var d=a.innerHTML;Owa.Dom.NonSingletonNode._removeDomNode(a,1);return d}};Owa.Dom.Element.prototype.getDescendantById=function Owa$Dom$Element$getDescendantById(d){var b=this._get_DomNode().getElementsByTagName("*"),a=b[d];if(Owa.Utility.isArray(a)&&!(a.tagName&&a.tagName=="SELECT"))a=a[0];else if(a==null&&!Owa.Utility.isIE())for(var c=0;c<b.length;c++)if(b[c].id==d){a=b[c];break}return!!a?Owa.Dom.Node.wrapDomNode(a):null};Owa.Dom.Element.prototype.getAllDescendantsById=function Owa$Dom$Element$getAllDescendantsById(g){var b=[],d=this._get_DomNode();if(d.all){var c=d.all[g];if(c)if(Owa.Utility.isArray(c))for(var f=c,a=0;a<f.length;a++)b.push(Owa.Dom.Node.wrapDomNode(f[a]));else b.push(Owa.Dom.Node.wrapDomNode(c))}else for(var e=d.getElementsByTagName("*"),a=0;a<e.length;a++)e[a].id==g&&b.push(Owa.Dom.Node.wrapDomNode(e[a]));return b};Owa.Dom.Element.prototype.get_AllDecendantsEnumerator=function Owa$Dom$Element$get_AllDecendantsEnumerator(){var a=this._get_DomNode().getElementsByTagName("*");return new Owa.Dom.NodeEnumerator(a,Owa.Dom.NonSingletonNode._isIgnorableNode)};Owa.Dom.Element.prototype.getDescendantsByTagName=function Owa$Dom$Element$getDescendantsByTagName(d){for(var b=[],c=this._get_DomNode().getElementsByTagName(d),a=0;a<c.length;a++)b.push(Owa.Dom.Node.wrapDomNode(c[a]));return b};Owa.Dom.Element.prototype.get_Enumerator=function Owa$Dom$Element$get_Enumerator(){return new Owa.Dom.NodeEnumerator(this._get_DomNode().childNodes,Owa.Dom.NonSingletonNode._isIgnorableNode)};Owa.Dom.Element.prototype.forEachDescendant=function Owa$Dom$Element$forEachDescendant(d){for(var c=this._get_DomNode().getElementsByTagName("*"),a=0;a<c.length;a++){var b=c[a];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(b))if(d(Owa.Dom.Node.wrapDomNode(b)))return}};Owa.Dom.Element.prototype.clone=function Owa$Dom$Element$clone(b){var a=this._wrapNode(this._get_DomNode().cloneNode(b));a._clearPropertiesForClone();b&&a.forEachDescendant(function(a){Owa.Dom.Element.isInstance(a)&&a._clearPropertiesForClone()});return a};Owa.Dom.Element.prototype.getChildrenSnapshot=function Owa$Dom$Element$getChildrenSnapshot(){var a=[];this.forEachChild(function(b){a.push(b)});return a};Owa.Dom.Element.prototype.getChildById=function Owa$Dom$Element$getChildById(e){var b=this._get_DomNode(),a;if(typeof b.children!="undefined"){a=b.children[e];if(Owa.Utility.isArray(a)&&!(a.tagName&&a.tagName=="SELECT"))a=a[0]}else for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];if(d.id==e){a=d;break}}return!!a?Owa.Dom.Node.wrapDomNode(a):null};Owa.Dom.Element.prototype.insertAdjacentElement=function Owa$Dom$Element$insertAdjacentElement(d,c){var a=this._get_DomNode(),b=c._get_DomNode();if(c.get_NodeType()==Owa.NodeType.Element&&typeof a.insertAdjacentElement!="undefined")a.insertAdjacentElement(d,b);else switch(d){case Owa.ElementInsertionPoint.BeforeBegin:a.parentNode.insertBefore(b,a);break;case Owa.ElementInsertionPoint.AfterBegin:a.insertBefore(b,a.firstChild);break;case Owa.ElementInsertionPoint.BeforeEnd:a.appendChild(b);break;case Owa.ElementInsertionPoint.AfterEnd:a.parentNode.insertBefore(b,a.nextSibling);break;default:throw d+" insertion point not supported";}return c};Owa.Dom.Element.prototype.insertAdjacentHtml=function Owa$Dom$Element$insertAdjacentHtml(c,d){var a=this._get_DomNode();if(typeof a.insertAdjacentHTML!="undefined")a.insertAdjacentHTML(c,d);else{var b=a.ownerDocument.createRange();!(a.tagName&&a.tagName.toLowerCase()=="body")&&b.setStartBefore(a);var e=b.createContextualFragment(d),f=Owa.Dom.Node.wrapDomNode(e);this.insertAdjacentElement(c,f)}};Owa.Dom.Element.prototype.insertAdjacentText=function Owa$Dom$Element$insertAdjacentText(c,d){var a=this._get_DomNode(),b=new Owa.Dom.Element(a.ownerDocument.createTextNode(d));this.insertAdjacentElement(c,b)};function isCssClassInString(a,b){a=a.replace("\t"," ");return b.length==0||a.length<b.length?false:a==b?true:a.startsWith(b+" ")?true:a.endsWith(" "+b)?true:a.contains(" "+b+" ")?true:false}function removeCssClassFromString(a,b){var c=false;a=a.replace("\t"," ");if(a==b)a="";else if(!(b.length==0||a.length<=b.length))if(a.startsWith(b+" ")){a=a.substr(b.length+1);c=true}else if(a.endsWith(" "+b)){a=a.substr(0,a.length-(b.length+1));c=true}else if(a.contains(" "+b+" ")){a=a.replace(" "+b+" "," ");c=true}if(c)a=removeCssClassFromString(a,b);return a}Owa.Dom.Element.prototype.get_CssClasses=function Owa$Dom$Element$get_CssClasses(){var c=this._get_DomNode().className;c=c.replace("\t"," ");for(var b=c.split(" "),d=[],a=0;a<b.length;a++)b[a]&&d.push(b[a]);return d};Owa.Dom.Element.prototype.set_CssClasses=function Owa$Dom$Element$set_CssClasses(a){var b="";if(a&&a.length)b=a.join(" ");this._get_DomNode().className=b};Owa.Dom.Element.prototype.removeCssClass=function Owa$Dom$Element$removeCssClass(b){var a=removeCssClassFromString(this._get_DomNode().className,b);if(a!=this._get_DomNode().className)this._get_DomNode().className=a};Owa.Dom.Element.prototype.addCssClass=function Owa$Dom$Element$addCssClass(a){if(!this.hasCssClass(a))this._oDomNode.className=this._oDomNode.className.concat(" "+a)};Owa.Dom.Element.prototype.replaceCssClass=function Owa$Dom$Element$replaceCssClass(c,d){var b=this._get_DomNode().className,a=removeCssClassFromString(b,d);if(a==b)throw"The CSS class to be replaced doesn't exist.";if(!isCssClassInString(a,c))a=a.concat((a.length==0?"":" ")+c);if(a!=b)this._get_DomNode().className=a.trim()};Owa.Dom.Element.prototype.hasCssClass=function Owa$Dom$Element$hasCssClass(a){return isCssClassInString(this._get_DomNode().className,a)};Owa.Dom.Element.prototype.focus=function Owa$Dom$Element$focus(a){var b=this._get_DomNode();function focusElement(){try{b.focus()}catch(a){}}if(!a)focusElement();else try{this.get_OwnerDocument().get_ContainerWindow().setTimeout(focusElement,a)}catch(c){}};Owa.Dom.Element.prototype.set_IsDisabled=function Owa$Dom$Element$set_IsDisabled(a){if(this.get_TagName().toLowerCase()!="div")throw"Can only set disabled to DIV element.";this._get_DomNode().disabled=a};Owa.Dom.Element.prototype.getEffectivePadding=function Owa$Dom$Element$getEffectivePadding(a){return this._getEffectivePadding(a,true)};Owa.Dom.Element.prototype._getEffectivePadding=function Owa$Dom$Element$_getEffectivePadding(c,b){var a;switch(c){case Owa.Style.Side.Top:a=this._getEffectiveStyle("padding-top","paddingTop");break;case Owa.Style.Side.Right:a=this._getEffectiveStyle("padding-right","paddingRight");break;case Owa.Style.Side.Bottom:a=this._getEffectiveStyle("padding-bottom","paddingBottom");break;case Owa.Style.Side.Left:a=this._getEffectiveStyle("padding-left","paddingLeft");break;default:throw"INVALID_PROPERTY";}if(a.length==0)return 0;if(b&&!a.contains(Owa.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectivePadding()";return Owa.Utility.IntFromSize(a,10)};Owa.Dom.Element.prototype.set_Padding=function Owa$Dom$Element$set_Padding(c,b){var a;switch(c){case Owa.Style.Side.Top:a="paddingTop";break;case Owa.Style.Side.Right:a="paddingRight";break;case Owa.Style.Side.Bottom:a="paddingBottom";break;case Owa.Style.Side.Left:a="paddingLeft";break;default:throw"INVALID_PROPERTY";}this._setStyleValue(a,b,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.getEffectiveBorderWidth=function Owa$Dom$Element$getEffectiveBorderWidth(a){return this._getEffectiveBorderWidth(a,true)};Owa.Dom.Element.prototype._getEffectiveBorderWidth=function Owa$Dom$Element$_getEffectiveBorderWidth(c,b){var a;switch(c){case Owa.Style.Side.Top:a=this._getEffectiveStyle("border-top-width","borderTopWidth");break;case Owa.Style.Side.Right:a=this._getEffectiveStyle("border-right-width","borderRightWidth");break;case Owa.Style.Side.Bottom:a=this._getEffectiveStyle("border-bottom-width","borderBottomWidth");break;case Owa.Style.Side.Left:a=this._getEffectiveStyle("border-left-width","borderLeftWidth");break;default:throw"INVALID_PROPERTY";}if(a.length==0)return 0;if(b&&!a.contains(Owa.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectiveBorderWidth()";return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.set_BorderWidth=function Owa$Dom$Element$set_BorderWidth(c,b){var a;switch(c){case Owa.Style.Side.Top:a="borderTopWidth";break;case Owa.Style.Side.Right:a="borderRightWidth";break;case Owa.Style.Side.Bottom:a="borderBottomWidth";break;case Owa.Style.Side.Left:a="borderLeftWidth";break;default:throw"INVALID_PROPERTY";}this._setStyleValue(a,b,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.getEffectiveMargin=function Owa$Dom$Element$getEffectiveMargin(a){return this._getEffectiveMargin(a,true)};Owa.Dom.Element.prototype._getEffectiveMargin=function Owa$Dom$Element$_getEffectiveMargin(c,b){var a;switch(c){case Owa.Style.Side.Top:a=this._getEffectiveStyle("margin-top","marginTop");break;case Owa.Style.Side.Right:a=this._getEffectiveStyle("margin-right","marginRight");break;case Owa.Style.Side.Bottom:a=this._getEffectiveStyle("margin-bottom","marginBottom");break;case Owa.Style.Side.Left:a=this._getEffectiveStyle("margin-left","marginLeft");break;default:throw"INVALID_PROPERTY";}if(a.length==0)return 0;if(b&&!a.contains(Owa.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectiveMargin()";return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.set_Margin=function Owa$Dom$Element$set_Margin(c,b){var a;switch(c){case Owa.Style.Side.Top:a="marginTop";break;case Owa.Style.Side.Right:a="marginRight";break;case Owa.Style.Side.Bottom:a="marginBottom";break;case Owa.Style.Side.Left:a="marginLeft";break;default:throw"INVALID_PROPERTY";}this._setStyleValue(a,b,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_textIndent=function Owa$Dom$Element$set_textIndent(a){this._setStyleValue("textIndent",a)};Owa.Dom.Element.prototype._get_EffectivePaddingBorderHeight=function Owa$Dom$Element$_get_EffectivePaddingBorderHeight(){var a=0;a+=this._getEffectivePadding(Owa.Style.Side.Top);a+=this._getEffectivePadding(Owa.Style.Side.Bottom);a+=this._getEffectiveBorderWidth(Owa.Style.Side.Top);a+=this._getEffectiveBorderWidth(Owa.Style.Side.Bottom);return a};Owa.Dom.Element.prototype._get_EffectivePaddingBorderWidth=function Owa$Dom$Element$_get_EffectivePaddingBorderWidth(){var a=0;a+=this._getEffectivePadding(Owa.Style.Side.Left);a+=this._getEffectivePadding(Owa.Style.Side.Right);a+=this._getEffectiveBorderWidth(Owa.Style.Side.Left);a+=this._getEffectiveBorderWidth(Owa.Style.Side.Right);return a};Owa.Dom.Element.prototype._get_EffectiveMarginHeight=function Owa$Dom$Element$_get_EffectiveMarginHeight(){var a=0;a+=this._getEffectiveMargin(Owa.Style.Side.Top);a+=this._getEffectiveMargin(Owa.Style.Side.Bottom);return a};Owa.Dom.Element.prototype._get_EffectiveMarginWidth=function Owa$Dom$Element$_get_EffectiveMarginWidth(){var a=0;a+=this._getEffectiveMargin(Owa.Style.Side.Left);a+=this._getEffectiveMargin(Owa.Style.Side.Right);return a};Owa.Dom.Element.prototype.get_OffsetHeight=function Owa$Dom$Element$get_OffsetHeight(){return this._oDomNode.offsetHeight};Owa.Dom.Element.prototype.get_OffsetWidth=function Owa$Dom$Element$get_OffsetWidth(){return this._oDomNode.offsetWidth};Owa.Dom.Element.prototype._get_OffsetLeft=function Owa$Dom$Element$_get_OffsetLeft(){if(this.get_OwnerDocument().get_IsRtl()){var a=this._get_OffsetParent();if(a){var b=a.get_ScrollWidth()-a.get_ClientWidth();if(b>0)return this._get_DomNode().offsetLeft+b}}return this._get_DomNode().offsetLeft};Owa.Dom.Element.prototype._get_OffsetTop=function Owa$Dom$Element$_get_OffsetTop(){return this._get_DomNode().offsetTop};Owa.Dom.Element.prototype.get_ClientWidth=function Owa$Dom$Element$get_ClientWidth(){var a=this._oDomNode.clientWidth;a=this._oDomNode.clientWidth;if(a==0&&Owa.Utility.isIE())if(!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";a=this._oDomNode.clientWidth}return a};Owa.Dom.Element.prototype.get_ClientHeight=function Owa$Dom$Element$get_ClientHeight(){var a=this._oDomNode.clientHeight;if(a==0&&Owa.Utility.isIE())if(!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";a=this._oDomNode.clientHeight}return a};Owa.Dom.Element.prototype.get_ScrollWidth=function Owa$Dom$Element$get_ScrollWidth(){var a=this._oDomNode.scrollWidth;a=this._oDomNode.scrollWidth;if(Owa.Utility.isFirefox()||Owa.Utility.isSafari()){var b=this._getEffectiveBorderWidth(Owa.Style.Side.Left,false)+this._getEffectiveBorderWidth(Owa.Style.Side.Right,false);if(this._oDomNode.clientWidth+b==this._oDomNode.offsetWidth&&this._oDomNode.scrollWidth==this._oDomNode.offsetWidth)a=this._oDomNode.clientWidth}return a};Owa.Dom.Element.prototype.get_ScrollHeight=function Owa$Dom$Element$get_ScrollHeight(){return this._oDomNode.scrollHeight};Owa.Dom.Element.prototype.get_ClientLeft=function Owa$Dom$Element$get_ClientLeft(){return this._get_DomNode().clientLeft};Owa.Dom.Element.prototype.get_Width=function Owa$Dom$Element$get_Width(){var a=this._getEffectiveStyle("width","width");return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.get_Height=function Owa$Dom$Element$get_Height(){var a=this._getEffectiveStyle("height","height");return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.set_Width=function Owa$Dom$Element$set_Width(a,b){this._setStyleValue("width",a,b)};Owa.Dom.Element.prototype.set_Height=function Owa$Dom$Element$set_Height(a,b){this._setStyleValue("height",a,b)};Owa.Dom.Element.prototype.set_MinWidth=function Owa$Dom$Element$set_MinWidth(a,b){this._setStyleValue("minWidth",a,b)};Owa.Dom.Element.prototype.set_MaxHeight=function Owa$Dom$Element$set_MaxHeight(a,b){this._setStyleValue("maxHeight",a,b)};Owa.Dom.Element.prototype.get_Top=function Owa$Dom$Element$get_Top(){var a=this._getEffectiveStyle("top","top");return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.get_Left=function Owa$Dom$Element$get_Left(){var a=this._getEffectiveStyle("left","left");return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.get_Right=function Owa$Dom$Element$get_Right(){var a=this._getEffectiveStyle("right","right");return Owa.Utility.IntFromSize(a)};Owa.Dom.Element.prototype.set_Top=function Owa$Dom$Element$set_Top(a,b){this._setStyleValue("top",a,b)};Owa.Dom.Element.prototype.set_Bottom=function Owa$Dom$Element$set_Bottom(a,b){this._setStyleValue("bottom",a,b)};Owa.Dom.Element.prototype.set_Left=function Owa$Dom$Element$set_Left(a,b){this._setStyleValue("left",a,b)};Owa.Dom.Element.prototype.set_Right=function Owa$Dom$Element$set_Right(a,b){this._setStyleValue("right",a,b)};Owa.Dom.Element.prototype.get_FontSize=function Owa$Dom$Element$get_FontSize(){var a=this._oDomNode.style.fontSize,b=a.length>2?a:null;return b};Owa.Dom.Element.prototype._setStyleValue=function Owa$Dom$Element$_setStyleValue(c,b,a){if(b===null)this._oDomNode.style[c]="";else{if(!a)a=Owa.Style.Unit.Pixels;this._oDomNode.style[c]=b+f(a)}};Owa.Dom.Element.prototype.get_ScrollLeft=function Owa$Dom$Element$get_ScrollLeft(){return Owa.Utility.isFirefox()&&this.get_OwnerDocument().get_IsRtl()?this.get_ScrollWidth()-this.get_ClientWidth()+this._get_DomNode().scrollLeft:this._get_DomNode().scrollLeft};Owa.Dom.Element.prototype.get_ScrollTop=function Owa$Dom$Element$get_ScrollTop(){return this._get_DomNode().scrollTop};Owa.Dom.Element.prototype.set_ScrollLeft=function Owa$Dom$Element$set_ScrollLeft(b){var a;if(Owa.Utility.isFirefox()&&this.get_OwnerDocument().get_IsRtl())a=-(this.get_ScrollWidth()-this.get_ClientWidth()-b);else a=b;this._get_DomNode().scrollLeft=a};Owa.Dom.Element.prototype.set_ScrollTop=function Owa$Dom$Element$set_ScrollTop(a){this._get_DomNode().scrollTop=a};Owa.Dom.Element.prototype.get_OverflowX=function Owa$Dom$Element$get_OverflowX(){var b=this._getEffectiveStyle("overflow-x","overflowX");if(b==Owa.Style.Overflow.Default)b=this._getEffectiveStyle("overflow","overflow");return a(b)};Owa.Dom.Element.prototype.set_OverflowX=function Owa$Dom$Element$set_OverflowX(b){this._oDomNode.style.overflowX=a(b)};Owa.Dom.Element.prototype.get_OverflowY=function Owa$Dom$Element$get_OverflowY(){var b=this._getEffectiveStyle("overflow-y","overflowY");if(b==Owa.Style.Overflow.Default)b=this._getEffectiveStyle("overflow","overflow");return a(b)};Owa.Dom.Element.prototype.set_OverflowY=function Owa$Dom$Element$set_OverflowY(b){this._oDomNode.style.overflowY=a(b)};Owa.Dom.Element.prototype.get_IsShown=function Owa$Dom$Element$get_IsShown(){var a=this._getEffectiveStyle("display","display");return b.None!=a};Owa.Dom.Element.prototype.set_IsShown=function Owa$Dom$Element$set_IsShown(a){this._oDomNode.style.display=a?b.Default:b.None};Owa.Dom.Element.prototype.get_IsDisplayed=function Owa$Dom$Element$get_IsDisplayed(){return this.get_OffsetWidth()!=0};Owa.Dom.Element.prototype.set_IsShownAroundIEBug=function Owa$Dom$Element$set_IsShownAroundIEBug(c){var a=this.get_ParentElement(),b=this.get_NextSibling();a&&Owa.Utility.isIE()&&a.removeChild(this);this.set_IsShown(c);if(a&&Owa.Utility.isIE())if(b)b.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,this);else a.appendChild(this)};Owa.Dom.Element.prototype.set_Visibility=function Owa$Dom$Element$set_Visibility(a){this._oDomNode.style.visibility=e(a)};Owa.Dom.Element.prototype.set_FontWeight=function Owa$Dom$Element$set_FontWeight(a){this._oDomNode.style.fontWeight=d(a)};Owa.Dom.Element.prototype.isPositionalElement=function Owa$Dom$Element$isPositionalElement(){var a=this._getEffectiveStyle("position","position").toLowerCase();return a==""||a=="static"?false:true};Owa.Dom.Element.prototype.get_PositionalParent=function Owa$Dom$Element$get_PositionalParent(){var a=this._get_OffsetParent();while(a&&!a.isPositionalElement())a=a._get_OffsetParent();if(a==null)a=this.get_OwnerDocument()._get_DomNode().body.parentNode?new Owa.Dom.Element(this.get_OwnerDocument()._get_DomNode().body.parentNode):null;return a};Owa.Dom.Element.prototype.get_PositionalTop=function Owa$Dom$Element$get_PositionalTop(){var b=this._get_OffsetTop(),a=this._get_OffsetParent();while(a&&!a.isPositionalElement()){if(a._get_OffsetParent()!=null)b+=a._get_OffsetTop();a=a._get_OffsetParent()}if(a==null){var c=this.get_OwnerDocument(),e=c.get_Body(),d=c.get_DocumentElement();b+=e._getEffectiveMargin(Owa.Style.Side.Top);b+=d._getEffectivePadding(Owa.Style.Side.Top);b+=d._getEffectiveBorderWidth(Owa.Style.Side.Top)}return b};Owa.Dom.Element.prototype.get_PositionalLeft=function Owa$Dom$Element$get_PositionalLeft(){var b=this._get_OffsetLeft(),a=this._get_OffsetParent();while(a&&!a.isPositionalElement()){if(a._get_OffsetParent()!=null)b+=a._get_OffsetLeft();a=a._get_OffsetParent()}if(a==null){var c=this.get_OwnerDocument(),e=c.get_Body(),d=c.get_DocumentElement();b+=e._getEffectiveMargin(Owa.Style.Side.Left);b+=d._getEffectivePadding(Owa.Style.Side.Left);b+=d._getEffectiveBorderWidth(Owa.Style.Side.Left)}return b};Owa.Dom.Element.prototype.get_DocumentTop=function Owa$Dom$Element$get_DocumentTop(){var b=this._get_OffsetTop(),a=this._get_OffsetParent();while(a){var d=a.get_TagName().toLowerCase();if(d=="body"||d=="html")break;b+=a._get_OffsetTop()+a._get_DomNode().clientTop;b-=a.get_ScrollTop();a=a._get_OffsetParent()}var c=this.get_OwnerDocument(),f=c.get_Body(),e=c.get_DocumentElement();b+=f._getEffectiveMargin(Owa.Style.Side.Top);b+=e._getEffectivePadding(Owa.Style.Side.Top);b+=e._getEffectiveBorderWidth(Owa.Style.Side.Top);return b};Owa.Dom.Element.prototype.get_DocumentLeft=function Owa$Dom$Element$get_DocumentLeft(){var a=this._get_OffsetLeft(),b=this._get_OffsetParent();while(b){a+=b._get_OffsetLeft()+b._get_DomNode().clientLeft;a-=b.get_ScrollLeft();b=b._get_OffsetParent()}var c=this.get_OwnerDocument(),e=c.get_Body(),d=c.get_DocumentElement();a+=e._getEffectiveMargin(Owa.Style.Side.Left);a+=d._getEffectivePadding(Owa.Style.Side.Left);a+=d._getEffectiveBorderWidth(Owa.Style.Side.Left);return a};Owa.Dom.Element.prototype.scrollIntoView=function Owa$Dom$Element$scrollIntoView(a){this._get_DomNode().scrollIntoView(a)};Owa.Dom.Element.prototype.get_RelativeTop=function Owa$Dom$Element$get_RelativeTop(a){return this.get_DocumentTop()-a.get_DocumentTop()};Owa.Dom.Element.prototype.get_RelativeLeft=function Owa$Dom$Element$get_RelativeLeft(a){return this.get_DocumentLeft()-a.get_DocumentLeft()};Owa.Dom.Element.prototype.set_PositionalLeft=function Owa$Dom$Element$set_PositionalLeft(d){var a=this.get_PositionalParent(),b=this._get_OffsetParent(),c=b.get_RelativeLeft(a);this.set_Left(d-c,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_PositionalTop=function Owa$Dom$Element$set_PositionalTop(d){var a=this.get_PositionalParent(),b=this._get_OffsetParent(),c=b.get_RelativeTop(a);this.set_Top(d-c,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_PositionalParent=function Owa$Dom$Element$set_PositionalParent(a){if(this._get_DomNode().oOriginalParent)throw"This element has already been reparented.";this.setExpando("_originalParent",this.get_ParentElement());this.setExpando("_originalOffsetX",this._get_OffsetLeft());this.setExpando("_originalOffsetY",this._get_OffsetTop());this._get_DomNode().oOriginalParent=this._get_DomNode().parentNode;this._get_DomNode().iOriginalY=this._get_OffsetTop();this._get_DomNode().iOriginalX=this._get_OffsetLeft();a.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,this)};Owa.Dom.Element.prototype.set_Opacity=function Owa$Dom$Element$set_Opacity(a){if(Owa.Utility.isIE()){if(this._get_DomNode().filters.alpha)this._get_DomNode().filters.alpha.opacity=a}else this._get_DomNode().style.opacity=a/100};Owa.Dom.Element.prototype.moveToTop=function Owa$Dom$Element$moveToTop(){for(var f=this._get_DomNode(),d=this._get_DomNode().parentNode,b=0,c=0;c<d.childNodes.length;c++){var e=d.childNodes[c];if(e.nodeType==Owa.NodeType.Element){var a=getInt(Owa.Dom.Node.wrapDomNode(e)._getEffectiveStyle("z-index","zIndex"));a=isNaN(a)?0:a;if(a>b)b=a}}f.style.zIndex=b+1};Owa.Dom.Element.prototype.fillHeight=function Owa$Dom$Element$fillHeight(e,c,d){var b;if(e!=null)b=e;else b=this.get_ParentElement();var a=b.get_OffsetHeight();a-=b._get_EffectivePaddingBorderHeight();if(c!=null){a-=c.get_OffsetHeight();a-=c._get_EffectiveMarginHeight()}if(d!=null){a-=d.get_OffsetHeight();a-=d._get_EffectiveMarginHeight()}a-=this._get_EffectiveMarginHeight();a-=this._get_EffectivePaddingBorderHeight();if(a<0)a=0;this._oDomNode.style.height=a+Owa.Style.Unit.Pixels};Owa.Dom.Element.prototype.fillWidth=function Owa$Dom$Element$fillWidth(e,c,d){var b;if(e!=null)b=e;else b=this.get_ParentElement();var a=b.get_OffsetWidth();a-=b._get_EffectivePaddingBorderWidth();if(c!=null){a=a-c.get_OffsetWidth();a-=c._get_EffectiveMarginWidth()}if(d!=null){a=a-d.get_OffsetWidth();a-=d._get_EffectiveMarginWidth()}a-=this._get_EffectiveMarginWidth();a-=this._get_EffectivePaddingBorderWidth();if(a<0)a=0;this._oDomNode.style.width=a+Owa.Style.Unit.Pixels};Owa.Dom.Element.prototype.click=function Owa$Dom$Element$click(){if(this._get_DomNode().click)this._get_DomNode().click();else{var b=this.get_OwnerDocument(),a=b._get_DomDocument().createEvent("MouseEvents");a.initEvent("click",true,true);this._get_DomNode().dispatchEvent(a)}};var c=!!window.getComputedStyle;Owa.Dom.Element.prototype._getEffectiveStyle=function Owa$Dom$Element$_getEffectiveStyle(d,f){var a;if(c){var e=typeof this._oDomNode.ownerDocument.defaultView!="undefined"?this._oDomNode.ownerDocument.defaultView:this._oDomNode.ownerDocument.parentWindow;if(Owa.Utility.isFirefox()&&e.getComputedStyle(this._oDomNode,"")==null)if(d.toLowerCase()=="display"){a=this._oDomNode.style.display;if(a==null||a=="")a=b.None}else throw"Trying to compute "+d+', but the style object is null. Is the element "\'display: none"?';else a=e.getComputedStyle(this._oDomNode,"").getPropertyValue(d)}else if(this._oDomNode.currentStyle)a=this._oDomNode.currentStyle[f];return a===undefined?"":a};Owa.Dom.Element.createClass("Owa.Dom.Element",Owa.Dom.ElementBase,Owa.Collections.IEnumerable)})();g_fModuleLoaded[".\\dom/element.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/input.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Dom");Owa.Dom.Input=function Owa$Dom$Input(a){if(!a)throw"the DOM element is null";Owa.Dom.Input.constructBase(this,[a])};Owa.Dom.Input.Type={Button:"button",Checkbox:"checkbox",File:"file",Hidden:"hidden",Radio:"radio",SelectOne:"select-one",Text:"text",Textarea:"textarea",ButtonTag:"buttonTag",Password:"password"};Owa.Dom.Input.prototype.get_Type=function Owa$Dom$Input$get_Type(){return this.get_TagName().toLowerCase()=="button"?Owa.Dom.Input.Type.ButtonTag:this.get_TagName().toLowerCase()=="textarea"?Owa.Dom.Input.Type.Textarea:this._get_DomNode().type};Owa.Dom.Input.prototype.set_Type=function Owa$Dom$Input$set_Type(a){this._get_DomNode().type=a};Owa.Dom.Input.prototype.get_IsChecked=function Owa$Dom$Input$get_IsChecked(){throwIfCheckedNotValid(this);return this._get_DomNode().checked};Owa.Dom.Input.prototype.set_IsChecked=function Owa$Dom$Input$set_IsChecked(a){throwIfCheckedNotValid(this);this._get_DomNode().checked=a};Owa.Dom.Input.prototype.get_IsDisabled=function Owa$Dom$Input$get_IsDisabled(){return this._get_DomNode().disabled};Owa.Dom.Input.prototype.set_IsDisabled=function Owa$Dom$Input$set_IsDisabled(a){this._get_DomNode().disabled=a};Owa.Dom.Input.prototype.get_Value=function Owa$Dom$Input$get_Value(){throwIfValueNotValid(this);return this._get_DomNode().value};Owa.Dom.Input.prototype.set_Value=function Owa$Dom$Input$set_Value(a){throwIfValueNotValid(this);this._get_DomNode().value=a};function throwIfCheckedNotValid(b){var a=b.get_Type();if(a!=Owa.Dom.Input.Type.Checkbox&&a!=Owa.Dom.Input.Type.Radio)throw new Error('Property "checked" is not supported for inputs of type: '+a);}function throwIfValueNotValid(b){var a=b.get_Type();if(a!=Owa.Dom.Input.Type.Text&&a!=Owa.Dom.Input.Type.Textarea&&a!=Owa.Dom.Input.Type.SelectOne&&a!=Owa.Dom.Input.Type.Password&&a!=Owa.Dom.Input.Type.Radio)throw new Error('Property "value" is not supported for inputs of type: '+a);}Owa.Dom.Input.createClass("Owa.Dom.Input",Owa.Dom.Element)})();g_fModuleLoaded[".\\dom/input.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/frame.js".toLowerCase()]&&(function(){Owa.Dom.Frame=function Owa$Dom$Frame(a){Owa.Dom.Frame.constructBase(this,[a])};Owa.Dom.Frame.prototype.get_ContentWindow=function Owa$Dom$Frame$get_ContentWindow(){var a=null;try{a=this._oDomNode.contentWindow}catch(b){}return a?new Owa.Dom.Window(a):null};Owa.Dom.Frame.prototype.set_Source=function Owa$Dom$Frame$set_Source(a){this._oDomNode.src=a};Owa.Dom.Frame.prototype.initFrameBorder=function Owa$Dom$Frame$initFrameBorder(a){if(this.get_ParentElement())throw new Error("Can't set frame border after inserting into DOM");this._oDomNode.frameBorder=a?1:0};Owa.Dom.Frame.prototype.initAllowTransparency=function Owa$Dom$Frame$initAllowTransparency(a){if(this.get_ParentElement())throw new Error("Can't set frame transparency after inserting into DOM");this._oDomNode.allowTransparency=a?true:false};Owa.Dom.Frame.prototype.get_ContentDocument=function Owa$Dom$Frame$get_ContentDocument(){return this.get_ContentWindow().get_Document()};Owa.Dom.Frame.createClass("Owa.Dom.Frame",Owa.Dom.Element)})();g_fModuleLoaded[".\\dom/frame.js".toLowerCase()]=1;if(Owa==null)var Owa={};(function(){Owa.DomUtility={};Owa.DomUtility.getAncestorById=function Owa$DomUtility$getAncestorById(a,d,c){a=Owa.Dom.Node.wrapDomNode(a);var b=a.getAncestorById(d,c);return b?b._get_DomNode():null};Owa.DomUtility.getAncestorByClass=function Owa$DomUtility$getAncestorByClass(a,d,c){a=Owa.Dom.Node.wrapDomNode(a);var b=a.getAncestorByClass(d,c);return b?b._get_DomNode():null};Owa.DomUtility.calculateVerticalScrollBar=function Owa$DomUtility$calculateVerticalScrollBar(a){var b=0,c=a.get_OffsetHeight();a.forEachChild(function(a){b+=a.get_IsShown()?a.get_OffsetHeight():0});a.set_OverflowY(b>c?Owa.Style.Overflow.Scroll:Owa.Style.Overflow.Hidden);if(Owa.Utility.isSafari()&&a.get_IsShown()){var d=a.get_ScrollTop();a.set_IsShown(false);a.get_OffsetWidth();a.set_IsShown(true);a.set_ScrollTop(d)}};Owa.DomUtility.isOwaWindow=function Owa$DomUtility$isOwaWindow(a){return!!a.getGlobalVariable("g_fOwa")};Owa.DomUtility.getTextFromHtml=function Owa$DomUtility$getTextFromHtml(e,d){var a;try{var c=Owa.Dom.Document.get_Current(),b;a=c.createElement("DIV");c.appendChild(a);a.set_IsShown(false);a.set_InnerHtml(e);b=a.getDescendantById(d);return!b?"":b.get_TextContent()}finally{a&&a.remove(true)}}})();function Point(a,b){this.iX=a;this.iY=b}function Bounds(c,d,b,a){this.iX=c;this.iY=d;this.iHeight=a;this.iWidth=b}function SelectionRange(a,b){this.w3c=window.getSelection?true:false;this.range=a;this.document=b}function createSelectionRange(b){if(!b)b=document;if(window.getSelection){var d=b.defaultView,a=d.getSelection();if(Owa.Utility.isFirefox())return new SelectionRange(a.getRangeAt(0),b);else{var c=b.createRange();c.setStart(a.anchorNode,a.anchorOffset);c.setEnd(a.focusNode,a.focusOffset);if(c.collapsed!=a.isCollapsed){c.setStart(a.extentNode,a.extentOffset);c.setEnd(a.baseNode,a.baseOffset)}return new SelectionRange(c,b)}}else return new SelectionRange(b.selection.createRange(),b)}function createTextRange(a){if(!a)a=document;return document.createRange?new SelectionRange(a.createRange(),a):new SelectionRange(a.body.createTextRange(),a)}function createRecipientRange(s,o){var l;if(!o)l=createSelectionRange(s);else l=o;var f=l.duplicate();f.collapse(true);var a=f.range;if(f.w3c){var i=a.startContainer.nodeValue;if(!i)return f;var m=i.substring(0,a.startOffset),q=i.substring(a.startOffset),r=i.length,h=m.lastIndexOf(";"),g=q.indexOf(";");if(h==-1)h=0;else h++;if(g==-1)g=r;else g+=m.length;a.setStart(a.startContainer,h);a.setEnd(a.endContainer,g)}else{var c=a.parentElement();if(!c)return null;while(c.tagName!="DIV"){c=c.parentElement;if(!c)return null}var k=false,b=false,n=0;while(!b){a.moveStart("character",-1);if(a.text.charAt(0)==";")b=true;n++;var e=a.duplicate();e.setEndPoint("EndToStart",e);var d=e.parentElement();if(d.nodeType!=3){var j=d.tagName;if(j=="A"){if(n==1){a.moveToElementText(d);k=true}else a.moveStart("character",1);b=true}else if(j=="SPAN"||!c.contains(d))b=true}}b=k;while(!b){a.moveEnd("character",1);var p=a.text.slice(-1);if(p.charAt(0)==";")b=true;var e=a.duplicate();e.setEndPoint("StartToEnd",e);var d=e.parentElement();if(d.nodeType!=3){var j=d.tagName;if(j=="A")b=true;else if(j=="SPAN"||!c.contains(d))b=true}}!k&&a.moveEnd("character",-1)}return f}function RemoveSemicolon(a){var b=a.nodeValue;if(a.nodeType==3&&b.charAt(0)==";")if(b.charAt(1)==" ")a.deleteData(0,2);else a.deleteData(0,1)}function isEmptyChar(a){return a<=32||a==160||a==8206||a==8207}function isSemicolon(a){return a==59}function isValidRecipientTextNode(a){if(!a||!a.length)return false;var c=a.charCodeAt(0);if(!isEmptyChar(c)&&!isSemicolon(c))return true;for(var b=1;b<a.length;b++)if(!isEmptyChar(a.charCodeAt(b)))return true;return false}function isValidPendingRecipient(a){if(!a||!a.length)return false;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(!isEmptyChar(c)&&!isSemicolon(c))return true}return false}SelectionRange.prototype.recipientDeleteKey=function SelectionRange$recipientDeleteKey(n){if(this.w3c){var b=false,g=false,l=null,d=this.range.startContainer,c=d.nodeValue,i=d.nodeType,a=d.nextSibling;if(i==3)if(c==null)b=true;else if(this.range.startOffset==c.length)b=true;else{c=c.slice(this.range.startOffset,c.length);b=!isValidRecipientTextNode(c)}else if(i==1){a=d;if(a.tagName!="SPAN"){if(a.tagName=="DIV"){b=true;g=true;l=a;var e=document.createElement("a");this.range.insertNode(e);a=e.nextSibling;e.parentNode.removeChild(e);if(a!=null&&a.nodeType==3){var j=a;a=a.nextSibling;j.parentNode.removeChild(j)}}}else b=true}if(b)if(isRecipientSpan(a)){var m=a.firstChild,h=m.className;if(h.contains("rwUR")||h.contains("rwRR")){if(g){browserWorkAround(l);this.setCaretAfter(a)}var f=a.nextSibling,k=a.previousSibling;a.parentNode.removeChild(a);if(f){RemoveSemicolon(f);k&&combineTextNodes(k,f)}canEvt(n)}}}};SelectionRange.prototype.recipientBackspaceKey=function SelectionRange$recipientBackspaceKey(i){if(this.w3c){var c=false,o=null,d=this.range.startContainer,f=d.nodeValue,k=d.nodeType,a=d.previousSibling;if(k==3)if(f==null)c=true;else if(this.range.startOffset==0)c=true;else{f=f.substring(0,this.range.startOffset);c=!isValidRecipientTextNode(f)}else if(k==1){a=d;if(a.tagName!="SPAN"){if(a.tagName=="DIV"){c=true;o=a;var g=document.createElement("a");this.range.insertNode(g);a=g.previousSibling;g.parentNode.removeChild(g);if(a!=null&&a.nodeType==3){var l=a;a=a.previousSibling;l.parentNode.removeChild(l)}}}else c=true}if(c)if(isRecipientSpan(a)){var n=a.parentNode,b=a.firstChild,j=b.className;if(j.contains("rwUR")){var m=Owa.Dom.Node.wrapDomNode(b).get_TextContent();b.fDel=1;var e=this.document.createTextNode(m);a.parentNode.replaceChild(e,a);var h=e.nextSibling;this.setCaretAfter(e);h&&RemoveSemicolon(h);canEvt(i)}else if(j.contains("rwRR")){var h=a.nextSibling;this.setCaretBefore(a);a.parentNode.removeChild(a);h&&RemoveSemicolon(h);canEvt(i)}browserWorkAround(n)}}else{this.moveStart(-1);this.moveEnd(-1);var b=this.parentElement(),a=b.parentNode;if(b&&b.className=="rwUR"){var m=b.innerText;b.fDel=1;var e=this.document.createTextNode(m);a.parentNode.replaceChild(e,a);this.setEndPoint("StartToEnd",this);this.select();canEvt(i)}}};SelectionRange.prototype.getText=function SelectionRange$getText(){return this.w3c?this.range.toString():this.range.text};SelectionRange.prototype.htmlText=function SelectionRange$htmlText(){if(this.w3c){if(window.XMLSerializer)return(new XMLSerializer).serializeToString(this.range.cloneContents())}else return this.range.htmlText};SelectionRange.prototype.getStartRecipientTextNode=function SelectionRange$getStartRecipientTextNode(f){if(this.w3c)return this.range.endContainer;else{var g=this.duplicate();g.collapse(true);var d=g.range,c=0,a;while(!c){d.moveStart("character",-1);d.setEndPoint("EndToStart",d);var e=d.duplicate();e.setEndPoint("EndToStart",e);var b=e.parentElement();if(b.nodeType==1){var h=b.tagName;if(h=="SPAN"){c=1;if(b.firstChild!=null&&b.firstChild.tagName!="SPAN")b=b.parentElement;a=b.nextSibling}else if(h=="A"){c=1;a=b.nextSibling;while(a&&a.nodeType==3&&!isValidPendingRecipient(a.data))a=a.nextSibling}else if(!f.contains(b)){c=1;a=f.firstChild}}}return!a||a.nodeType!=3||a.parentNode!=f?null:a}};SelectionRange.prototype.selectionExists=function SelectionRange$selectionExists(){return this.w3c?!this.range.collapsed:this.document.selection.type!="None"};SelectionRange.prototype.IsTypeControl=function SelectionRange$IsTypeControl(){return this.w3c?false:this.document.selection.type=="Control"};SelectionRange.prototype.inRange=function SelectionRange$inRange(a){if(this.w3c){var b=this.range.compareBoundaryPoints(Range.START_TO_START,a.range),c=this.range.compareBoundaryPoints(Range.END_TO_END,a.range);return b<0&&c>0}else return this.range.inRange(a.range)};SelectionRange.prototype.isEqual=function SelectionRange$isEqual(a){if(this.w3c){var b=this.range.compareBoundaryPoints(Range.START_TO_START,a.range),c=this.range.compareBoundaryPoints(Range.END_TO_END,a.range);return b==0&&c==0}else return this.range.isEqual(a.range)};SelectionRange.prototype.bounding=function SelectionRange$bounding(){if(this.w3c){var b=this.range.cloneRange(),a=document.createElement("SPAN");b.insertNode(a);b.selectNode(a);b.deleteContents();return new Bounds(a.offsetLeft,a.offsetTop,a.offsetLeft,a.offsetTop)}else return new Bounds(this.range.boundingLeft,this.range.boundingTop,this.range.boundingWidth,this.range.boundingHeight)};SelectionRange.prototype.offset=function SelectionRange$offset(){if(this.w3c){var c=this.range.cloneRange(),a=document.createElement("SPAN");c.insertNode(a);var f=a.parentNode,b=getCY(a)-f.scrollTop,d=Owa.Dom.Node.wrapDomNode(a).get_ClientHeight();if(d>0)b+=d;else b+=13;var e=getCX(a);c.selectNode(a);c.deleteContents();return new Point(e,b)}else return new Point(this.range.offsetLeft,this.range.offsetTop)};SelectionRange.prototype.moveEnd=function SelectionRange$moveEnd(b){if(this.w3c){var a;if(b>0)for(a=0;a<b;a++)this.range.endOffset!=this.range.endContainer.nodeValue.length&&this.range.setEnd(this.range.endContainer,this.range.endOffset+1);else if(b<0)for(a=0;a>b;a--)this.range.endOffset!=0&&this.range.setEnd(this.range.endContainer,this.range.endOffset-1)}else document.selection&&this.range.moveEnd("character",b)};SelectionRange.prototype.moveStart=function SelectionRange$moveStart(b){if(this.w3c){var a;if(b>0)for(a=0;a<b;a++)this.range.startOffset!=0&&this.range.setStart(this.range.startContainer,this.range.startOffset+1);else if(b<0)for(a=0;a>b;a--)this.range.startOffset!=0&&this.range.setStart(this.range.startContainer,this.range.startOffset-1)}else this.range.moveStart("character",b)};SelectionRange.prototype.setCaretAfter=function SelectionRange$setCaretAfter(b){if(this.w3c){var a=b.nextSibling,c=window.getSelection();if(Owa.Utility.isFirefox()){c.removeAllRanges();if(a){this.range.setStart(a,0);this.range.setEnd(a,0)}else if(b.nodeType==3){var d=b.nodeValue.length;this.range.setStart(b,d);this.range.setEnd(b,d)}c.addRange(this.range)}else a&&c.setBaseAndExtent(a,0,a,0)}else{this.range.select(b);this.range.collapse(false);this.range.moveStart("character",1)}};SelectionRange.prototype.setCaretBefore=function SelectionRange$setCaretBefore(b){if(this.w3c){var a=b.previousSibling,d=window.getSelection();if(Owa.Utility.isFirefox()){d.removeAllRanges();if(a){var c=a.nodeValue.length;this.range.setStart(a,c);this.range.setEnd(a,c)}else if(b.nodeType==3){this.range.setStart(b,0);this.range.setEnd(b,0)}d.addRange(this.range)}else if(a){var c=a.nodeValue.length;d.setBaseAndExtent(a,c,a,c)}}else{this.range.select(b);this.range.collapse(true);this.range.moveStart("character",-1)}};SelectionRange.prototype.moveToElementText=function SelectionRange$moveToElementText(a){return this.w3c?this.range.selectNodeContents(a):this.range.moveToElementText(a)};SelectionRange.prototype.trySelectRecipient=function SelectionRange$trySelectRecipient(a){try{this._selectRecipient(a)}catch(b){}};SelectionRange.prototype._selectRecipient=function SelectionRange$_selectRecipient(a){if(this.w3c){var d=window.getSelection();if(Owa.Utility.isFirefox()){d.removeAllRanges();this.range.selectNode(a);a=a.parentNode;if(a&&a.tagName=="SPAN"){var c=a.nextSibling,b=a.previousSibling;if(c&&b){var e=b.nodeValue.length;this.range.setStart(b,e);this.range.setEnd(c,0)}else this.range.selectNode(a)}d.addRange(this.range)}else{this.range.selectNode(a);this.select();a=a.parentNode;if(a&&a.tagName=="SPAN"){var c=a.nextSibling,b=a.previousSibling;if(c&&b){var e=b.nodeValue.length;d.setBaseAndExtent(b,e,c,0)}else this.range.selectNode(a)}}}else{this.range.moveToElementText(a);a=a.parentNode;if(a&&a.tagName=="SPAN"){this.range.moveToElementText(a);this.range.moveStart("character",-1);this.range.moveEnd("character",1)}this.range.select()}};SelectionRange.prototype.collapse=function SelectionRange$collapse(a){return this.range.collapse(a)};SelectionRange.prototype.select=function SelectionRange$select(){if(this.w3c){var a=window.getSelection();if(a.removeAllRanges){a.removeAllRanges();a.addRange(this.range)}else a.setBaseAndExtent(this.range.startContainer,this.range.startOffset,this.range.endContainer,this.range.endOffset);return this.range}else return this.range.select()};SelectionRange.prototype.parentElement=function SelectionRange$parentElement(){return this.w3c?this.range.commonAncestorContainer:this.range.parentElement()};SelectionRange.prototype.duplicate=function SelectionRange$duplicate(){return this.w3c?new SelectionRange(this.range.cloneRange(),this.document):new SelectionRange(this.range.duplicate(),this.document)};SelectionRange.prototype.setEndPoint=function SelectionRange$setEndPoint(b,a){if(this.w3c)switch(b){case"StartToEnd":return this.range.setEnd(a.range.StartContainer,a.range.StartOffset);break;case"StartToStart":return this.range.setStart(a.range.StartContainer,a.range.StartOffset);break;case"EndToStart":return this.range.setStart(a.range.EndContainer,a.range.EndOffset);break;case"EndToEnd":return this.range.setEnd(a.range.EndContainer,a.range.EndOffset)}else if(document.selection)return this.range.setEndPoint(b,a.range)};SelectionRange.prototype.insertNode=function SelectionRange$insertNode(a){if(this.w3c){this.range.deleteContents();this.range.insertNode(a)}};SelectionRange.prototype.pasteHtml=function SelectionRange$pasteHtml(a){if(this.w3c)Owa.ExecCommand.execute(this.document,"inserthtml",false,a);else{while(this.range.length>0)this.range.remove(0);this.range=document.selection.createRange();this.range.pasteHTML(a)}};SelectionRange.prototype.moveTextAreaCursorToStartOrEnd=function SelectionRange$moveTextAreaCursorToStartOrEnd(a,c){if(a._oDomNode.childNodes&&a._oDomNode.firstChild&&a._oDomNode.firstChild.nodeType==3){this.moveToElementText(a._oDomNode);if(this.w3c){var b=c?0:a._oDomNode.value.length;a._oDomNode.setSelectionRange(b,b);a.focus(1)}else{this.collapse(c);this.select()}}};SelectionRange.prototype.getStartContainer=function SelectionRange$getStartContainer(){return!this.w3c?null:this.range.startContainer};SelectionRange.prototype.getStartContainerText=function SelectionRange$getStartContainerText(){return!this.w3c?null:this.range.startContainer.nodeValue};SelectionRange.prototype.getStartOffset=function SelectionRange$getStartOffset(){return!this.w3c?null:this.range.startOffset};SelectionRange.prototype.setStart=function SelectionRange$setStart(b,a){if(!this.w3c)return;this.range.setStart(b,a)};SelectionRange.prototype.setEnd=function SelectionRange$setEnd(b,a){if(!this.w3c)return;this.range.setEnd(b,a)};SelectionRange.prototype.expandSelectionAroundAnchors=function SelectionRange$expandSelectionAroundAnchors(){if(!this.w3c)return null;var a=null,b=null,e=!this.selectionExists();a=this.getAnchorUrl(this.range.startContainer);a&&this.range.setStart(this.range.startContainer,0);b=this.getAnchorUrl(this.range.endContainer);b&&this.range.setEnd(this.range.endContainer,this.range.endContainer.nodeValue.length);var c=a?a:b;if(!c&&!e){var d=this.range.cloneContents();if(d)c=this.getAnchorUrl(d.firstChild)}this.select();return c};SelectionRange.prototype.getAnchorUrl=function SelectionRange$getAnchorUrl(a){return!a?null:a.nodeName.toUpperCase()=="A"?a.getAttribute("href"):a.nodeType==Owa.NodeType.Text&&a.parentNode.nodeName.toUpperCase()=="A"?a.parentNode.getAttribute("href"):null};function mvIP(d,c,a){if(!a)a=document;var b=createTextRange(a);b.moveToElementText(d);b.collapse(c);b.select()}function combineTextNodes(b,a){if(b.nodeType==3&&a.nodeType==3){b.appendData(a.nodeValue);a.parentNode.removeChild(a)}}if(Owa==null)var Owa={};(function(){Owa.Layout={};Owa.Layout.fIsResized="_fResized";Owa.Layout.MaximumWidth=function Owa$Layout$MaximumWidth(a,e){if(!a)return 0;for(var b=0,c=0;c<a.length;c++){var d=e?e._getDescendant(a[c])._oDomNode:document.getElementById(a[c]);if(d){var f=Owa.Layout._getElementWidthCeiling(d);b=b<f?f:b}}return b};Owa.Layout.MaximumElementWidth=function Owa$Layout$MaximumElementWidth(a){if(!a)return 0;for(var b=0,c=0;c<a.length;c++)if(a[c]){var d=Owa.Layout._getElementWidthCeiling(a[c]._oDomNode);b=b<d?d:b}return b};Owa.Layout._getElementWidthCeiling=function Owa$Layout$_getElementWidthCeiling(a){var b=0;if(a&&a.offsetWidth)if(a.getBoundingClientRect!=null){var c=a.getBoundingClientRect();b=Math.ceil(c.right-c.left)}else b=a.offsetWidth+1;return b};Owa.Layout.SetWidths=function Owa$Layout$SetWidths(a,e,d){if(!a)return;for(var c=0;c<a.length;c++){var b=d?d._getDescendant(a[c])._oDomNode:document.getElementById(a[c]);if(b&&b.offsetWidth){b.style.width=e+"px";b.setAttribute(Owa.Layout.fIsResized,"1")}}};Owa.Layout.SetElementWidths=function Owa$Layout$SetElementWidths(a,c){if(!a)return;for(var b=0;b<a.length;b++)if(a[b]&&a[b].get_OffsetWidth()){a[b].set_Width(c);a[b].setAttribute(Owa.Layout.fIsResized,"1")}};Owa.Layout.setElementWidthsToLargest=function Owa$Layout$setElementWidthsToLargest(a,f,e){if(!a)return null;var b;if(!e){b=Owa.Layout.MaximumWidth(a,f);Owa.Layout.SetWidths(a,b,f)}else{for(var d=[],c=0;c<a.length;c++)if(a[c]){var g=e.getDescendantById(a[c]);if(g)d[c]=g}b=Owa.Layout.MaximumElementWidth(d);Owa.Layout.SetElementWidths(d,b)}return b}})();if(Owa==null)var Owa={};(function(){Owa.ExecCommand={};Owa.ExecCommand.execute=function Owa$ExecCommand$execute(b,c,d,a){c=c.toLowerCase();switch(c){case"createlink":if(!Owa.Utility.isIE()){var h=isDf(typeof L_Hyprlnk)?L_Hyprlnk:"",g=a?a:"http://",e=prompt(h,g);if(e&&e!=g){var f=createSelectionRange(b);f.selectionExists()&&b.execCommand("unlink",false,null);if(!f.selectionExists()&&Owa.Utility.isFirefox())f.pasteHtml(Owa.UIControls.Editor.prototype._applyLink(e));else b.execCommand(c,false,e)}}else b.execCommand(c,true,a);break;case"backcolor":if(Owa.Utility.isFirefox())b.execCommand("hiliteColor",d,a);else if(Owa.Utility.isSafari()){a="#"+a;b.execCommand(c,d,a)}else b.execCommand(c,d,a);break;case"forecolor":if(Owa.Utility.isSafari()){a="#"+a;b.execCommand(c,d,a)}else b.execCommand(c,d,a);break;default:b.execCommand(c,d,a)}}})();Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/control.js".toLowerCase()]&&(function(){Owa.Components.Control=function Owa$Components$Control(){this._oResourceSet={};this.__fDisposed=false;this.__fInitialized=false;if(this._fSupportUniqueId){this._sUniqueId=UniqueIdGenerator.get_Instance().get_Next();UniqueIdHashSet.get_Instance().put(this._sUniqueId,this)}if(this._fClearTimeoutCallbackInDisposing){this._oTimeoutCallbackHashtable={};this._oIntervalCallbackHashtable={}}this._oEvents=null};var a=Owa.Components.Control.prototype;a._fSupportUniqueId=false;a._fClearTimeoutCallbackInDisposing=false;a.initialize=function Owa$Components$Control$initialize(){this.__fInitialized=true};a.get_IsInitialized=function Owa$Components$Control$get_IsInitialized(){return this.__fInitialized};a.dispose=function Owa$Components$Control$dispose(){if(Owa.Components.Application.get_ShouldExplicitDisposeResource()){this._disposeAllResources();this._clearEventCollections()}this._fSupportUniqueId&&UniqueIdHashSet.get_Instance().remove(this._sUniqueId);this.__oResourceManager&&this.__oResourceManager.removeResource(this);if(this._fClearTimeoutCallbackInDisposing){var a=Owa.Dom.Window.get_Current();for(var b in this._oTimeoutCallbackHashtable)a.clearTimeout(parseInt(b));for(var b in this._oIntervalCallbackHashtable)a.clearInterval(parseInt(b));this._fClearTimeoutCallbackInDisposing=null}this.__fDisposed=true};a.get_IsDisposed=function Owa$Components$Control$get_IsDisposed(){return this.__fDisposed};a.get_UniqueId=function Owa$Components$Control$get_UniqueId(){return this._sUniqueId};a.getResourceManager=function Owa$Components$Control$getResourceManager(){return this.__oResourceManager};a.addResource=function Owa$Components$Control$addResource(a){if(!a)return;a.__oResourceManager&&a.__oResourceManager.removeResource(a);this._oResourceSet[a.get_UniqueId()]=a;a.__oResourceManager=this;return a};a.removeResource=function Owa$Components$Control$removeResource(a){delete this._oResourceSet[a.get_UniqueId()];a.__oResourceManager=null;return a};a._clearEventCollections=function Owa$Components$Control$_clearEventCollections(){if(this._oEvents){for(var a in this._oEvents)this._oEvents[a].clear();this._oEvents=null}};a._disposeAllResources=function Owa$Components$Control$_disposeAllResources(){for(var a in this._oResourceSet)!this._oResourceSet[a].__fDisposed&&this._oResourceSet[a].dispose();this._oResourceSet={}};a._createCallback=function Owa$Components$Control$_createCallback(a,c){var b=function(){return this.get_IsDisposed()?void 0:a.apply(this,arguments)};return Owa.Utility.createArgumentContextDelegate(this,b,c,a)};a._setTimeout=function Owa$Components$Control$_setTimeout(d,c,e){if(this._fClearTimeoutCallbackInDisposing){var a={},f=Owa.Utility.createContextDelegate(this,d,e),b=Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(this,this._timeoutCallback,a),c);a.fnCallback=f;a.iId=b;a.fIsInterval=false;this._oTimeoutCallbackHashtable[b]=true;return b}else return Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(this,d,e),c)};a._timeoutCallback=function Owa$Components$Control$_timeoutCallback(a){var c=a.iId,b=a.fnCallback;if(!a.fIsInterval)delete this._oTimeoutCallbackHashtable[c];if(this.get_IsDisposed())return;b()};a.stTmout=function Owa$Components$Control$stTmout(d,f){for(var b=[],a=2;a<arguments.length;a++)b.push(arguments[a]);var c=this,e=function(){c[d].apply(c,b)};return Owa.Dom.Window.get_Current().setTimeout(e,f)};a._clearTimeout=function Owa$Components$Control$_clearTimeout(a){if(this._fClearTimeoutCallbackInDisposing)delete this._oTimeoutCallbackHashtable[a];Owa.Dom.Window.get_Current().clearTimeout(a)};a._setInterval=function Owa$Components$Control$_setInterval(c,d,e){if(this._fClearTimeoutCallbackInDisposing){var a={},f=Owa.Utility.createContextDelegate(this,c,e),b=Owa.Dom.Window.get_Current().setInterval(Owa.Utility.createContextDelegate(this,this._timeoutCallback,a),d);a.fnCallback=f;a.iId=b;a.fIsInterval=true;this._oIntervalCallbackHashtable[b]=true;return b}else return Owa.Dom.Window.get_Current().setInterval(Owa.Utility.createContextDelegate(this,c,e),d)};a._clearInterval=function Owa$Components$Control$_clearInterval(a){if(this._fClearTimeoutCallbackInDisposing)delete this._oIntervalCallbackHashtable[a];Owa.Dom.Window.get_Current().clearInterval(a)};a._getEventHandlerCollection=function Owa$Components$Control$_getEventHandlerCollection(a){if(!this._oEvents)this._oEvents={};if(!this._oEvents[a])this._oEvents[a]=new Owa.Utility.EventHandlerCollection;return this._oEvents[a]};a._dispatchEvent=function Owa$Components$Control$_dispatchEvent(a,b,c){return!this._oEvents||!this._oEvents[a]?void 0:this._oEvents[a].dispatch(b,c)};Owa.Components.Control.createClass("Owa.Components.Control")})();g_fModuleLoaded[".\\components/control.js".toLowerCase()]=1;if(!Owa)var Owa={};if(!Owa.Controls)Owa.Controls={};(function(){Owa.Controls.Control=function Owa$Controls$Control(a){this._el=a;if(a&&a.id)this.sId=a.id};Owa.Controls.Control.prototype.getEl=function Owa$Controls$Control$getEl(){if(!this._el)this._el=window.document.getElementById(this.sId);return this._el};Owa.Controls.Control.prototype.addEvent=function Owa$Controls$Control$addEvent(c,d,a){if(this[a]){var b=this.crtEvtCB(a);attchEvt(c,d,b);return b}};Owa.Controls.Control.prototype.crtEvtCB=function Owa$Controls$Control$crtEvtCB(a){var b=this,c=function(c){b[a](c?c:event)};return c};Owa.Controls.Control.prototype.removeEvent=function Owa$Controls$Control$removeEvent(b,c,a){this[a]&&dtchEvt(b,c,this[a])};Owa.Controls.Control.prototype.crtOehCb=function Owa$Controls$Control$crtOehCb(a){var b=this;return function(c){return b[a](c)}};Owa.Controls.Control.prototype.crtCb=function Owa$Controls$Control$crtCb(d){for(var c=this,b=[],a=1;a<arguments.length;a++)b.push(arguments[a]);return function(){return c[d].apply(c,b)}};Owa.Controls.Control.prototype.crtCbWA=function Owa$Controls$Control$crtCbWA(d){for(var c=this,a=[],b=1;b<arguments.length;b++)a.push(arguments[b]);return function(){for(var e=[],b=0;b<a.length;b++)e.push(a[b]);for(var b=0;b<arguments.length;b++)e.push(arguments[b]);return c[d].apply(c,e)}};Owa.Controls.Control.prototype.stTmout=function Owa$Controls$Control$stTmout(d,f){for(var b=[],a=2;a<arguments.length;a++)b.push(arguments[a]);var c=this,e=function(){c[d].apply(c,b)};return window.setTimeout(e,f)}})();var g_oCS;if(!g_oCS)g_oCS={};var CSV_MRU_UPD_DT="dtMRUUpd",CSV_MRU_CACHE="sMRUHtmlCache",CSV_MM_PAR_STR="sMMPar",CSV_CALENDAR_FOLDERS_DT="dtCalendarFolders";function getCSVAsStr(a){try{return getCSW().g_oCS[a]}catch(b){return 0}}function setCSVAsStr(b,a){try{getCSW().g_oCS[b]=a.toString()}catch(c){}}!g_fModuleLoaded[".\\dom/xmlelement.js".toLowerCase()]&&(function(){Owa.Dom.XmlElement=function Owa$Dom$XmlElement(a){Owa.Dom.XmlElement.constructBase(this,[a])};Owa.Dom.XmlElement.prototype.get_LocalName=function Owa$Dom$XmlElement$get_LocalName(){var a=this._get_DomNode();return typeof a.localName!="undefined"?a.localName:a.baseName};Owa.Dom.XmlElement.prototype.get_NamespaceURI=function Owa$Dom$XmlElement$get_NamespaceURI(){return this._get_DomNode().namespaceURI};Owa.Dom.XmlElement.prototype.get_Xml=function Owa$Dom$XmlElement$get_Xml(){return Owa.Dom.XmlElement.getXmlFromXmlNode(this._get_DomNode())};Owa.Dom.XmlElement.prototype.get_TextContent=function Owa$Dom$XmlElement$get_TextContent(){var a=this._get_DomNode();return a.text||a.textContent};Owa.Dom.XmlElement.prototype.set_TextContent=function Owa$Dom$XmlElement$set_TextContent(b){var a=this._get_DomNode();if(typeof a.text!="undefined")a.text=b;else a.textContent=b};Owa.Dom.XmlElement.prototype.selectNodes=function Owa$Dom$XmlElement$selectNodes(f){var c=this._get_DomNode(),b=[];if(typeof c.selectNodes!="undefined")for(var a=c.selectNodes(f),e=0;e<a.length;e++)b.push(Owa.Dom.Node.wrapXmlDomNode(a[e]));else{var a=(new XPathEvaluator).evaluate(f,c,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(a!=null){var d=a.iterateNext();while(d){b.push(Owa.Dom.Node.wrapXmlDomNode(d));d=a.iterateNext()}}}return b};Owa.Dom.XmlElement.prototype.selectSingleNode=function Owa$Dom$XmlElement$selectSingleNode(d){var b=this._get_DomNode(),a=null;if(typeof b.selectSingleNode!="undefined")a=b.selectSingleNode(d);else{var c=(new XPathEvaluator).evaluate(d,b,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);a=c?c.singleNodeValue:null}return a?Owa.Dom.Node.wrapXmlDomNode(a):null};Owa.Dom.XmlElement.prototype._wrapNode=function Owa$Dom$XmlElement$_wrapNode(a){return Owa.Dom.Node.wrapXmlDomNode(a)};Owa.Dom.XmlElement.getXmlFromXmlNode=function Owa$Dom$XmlElement$getXmlFromXmlNode(b){var a=null;if(typeof b.xml!="undefined"){a=b.xml;a=a?a.trim():null}else a=(new XMLSerializer).serializeToString(b);return a};Owa.Dom.XmlElement.createClass("Owa.Dom.XmlElement",Owa.Dom.ElementBase)})();g_fModuleLoaded[".\\dom/xmlelement.js".toLowerCase()]=1;!g_fModuleLoaded[".\\dom/xmldocument.js".toLowerCase()]&&(function(){Owa.Dom.XmlDocument=function Owa$Dom$XmlDocument(){var a;if(document.implementation&&document.implementation.createDocument&&!Owa.Utility.isIE())a=document.implementation.createDocument("","",null);else try{a=new ActiveXObject("MSXML2.DomDocument")}catch(b){throw"The browser doesn't support create a XML DOC object";}a.preserveWhiteSpace=1;Owa.Dom.XmlDocument.constructBase(this,[a])};Owa.Dom.XmlDocument.prototype.loadXML=function Owa$Dom$XmlDocument$loadXML(c){var a=this._get_XmlDocument();if(typeof a.loadXML!="undefined")return a.loadXML(c);else{var f=new DOMParser,b=f.parseFromString(c,"text/xml"),e=(new XMLSerializer).serializeToString(b);if(e!=c&&/<\/parsererror>/.test(e))return false;while(a.hasChildNodes())a.removeChild(a.lastChild);for(var d=0;d<b.childNodes.length;d++){var g=a.importNode(b.childNodes[d],true);a.appendChild(g)}return true}};Owa.Dom.XmlDocument.prototype.get_Xml=function Owa$Dom$XmlDocument$get_Xml(){return Owa.Dom.XmlElement.getXmlFromXmlNode(this._get_XmlDocument())};Owa.Dom.XmlDocument.prototype.appendChild=function Owa$Dom$XmlDocument$appendChild(a){this._get_XmlDocument().appendChild(a._get_DomNode())};Owa.Dom.XmlDocument.prototype.selectNodes=function Owa$Dom$XmlDocument$selectNodes(f){var d=this._get_XmlDocument(),b=[];if(typeof d.selectNodes!="undefined")for(var a=d.selectNodes(f),e=0;e<a.length;e++)b.push(this._wrapNode(a[e]));else{var a=(new XPathEvaluator).evaluate(f,d,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(a!=null){var c=a.iterateNext();while(c){b.push(this._wrapNode(c));c=a.iterateNext()}}}return b};Owa.Dom.XmlDocument.prototype.selectSingleNode=function Owa$Dom$XmlDocument$selectSingleNode(d){var b=this._get_XmlDocument(),a=null;if(typeof b.selectSingleNode!="undefined")a=b.selectSingleNode(d);else{var c=(new XPathEvaluator).evaluate(d,b,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);a=c?c.singleNodeValue:null}return a?Owa.Dom.Node.wrapXmlDomNode(a):null};Owa.Dom.XmlDocument.prototype.createElementNS=function(d,c){var b=this._get_XmlDocument(),a=null;if(typeof b.createElementNS!="undefined")a=b.createElementNS(c,d);else a=b.createNode(1,d,c);return new Owa.Dom.XmlElement(a)};Owa.Dom.XmlDocument.prototype._wrapNode=function Owa$Dom$XmlDocument$_wrapNode(a){return Owa.Dom.Node.wrapXmlDomNode(a)};Owa.Dom.XmlDocument.prototype._get_XmlDocument=function Owa$Dom$XmlDocument$_get_XmlDocument(){return this._get_DomDocument()};Owa.Dom.XmlDocument.createClass("Owa.Dom.XmlDocument",Owa.Dom.DocumentBase)})();g_fModuleLoaded[".\\dom/xmldocument.js".toLowerCase()]=1;function rtrvUCCk(){if(!isDf(typeof a_sUCCkStr))return"";var c=document.cookie,b="";if(!isExpLgn()){var a=c.match(a_sUCCkStr+"=(.*?)(;|$)");if(!a)return"";b=a[1]}else{var e=a_sUCCkStr+"_(.*?)=(.*?)&(.*?)(;|$)",d=new RegExp(e,"g"),a;while((a=d.exec(c))!=null)if(Owa.Encoder.toBase64String(a_sMailboxUniqueId).indexOf(a[3])==0){b=a[2];break}}return unescape(b)}function Cky(a){this.sNm=a;this.Add=function Cky$Add(b){var a=this.sNm+"=1";if(b)a+=";expires="+b.toGMTString();if(Owa.Utility.isHttps())a+=";secure";document.cookie=a};this.Expire=function Cky$Expire(){var a=new Date,c=Owa.Utility.isChrome()?a.valueOf():a.getTime();a.setTime(c-2*7*24*60*60*1e3);var b=this.sNm+"=1; expires="+a.toUTCString();if(Owa.Utility.isHttps())b+=";secure";document.cookie=b};this.IsLdd=function Cky$IsLdd(){return document.cookie.indexOf(this.sNm)>=0}}var MAX_ALLOWED_URL_LENGTH=1744;!g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()]&&(function(){(function(){Type.createNamespace("Owa.KeyCodes");var a=Owa.KeyCodes;a.BACK_SPACE=8;a.DELETE=46;a.DOWN=40;a.END=35;a.ENTER=13;a.ESC=27;a.F9=120;a.HOME=36;a.LEFT=37;a.PAGE_DOWN=34;a.PAGE_UP=33;a.RIGHT=39;a.SPACEBAR=32;a.TAB=9;a.UP=38;a.getKeySemicolon=function Owa$KeyCodes$getKeySemicolon(){return Owa.Utility.isFirefox()?59:186};a.isAlphaNumCharacter=function Owa$KeyCodes$isAlphaNumCharacter(a){return a<=57&&a>=48||a<=90&&a>=65||a<=105&&a>=96};a.isNonAlphaNumCharacter=function Owa$KeyCodes$isNonAlphaNumCharacter(a){return Owa.Utility.isFirefox()&&(a==59||a==107||a==188||a==109)?1:!Owa.Utility.isFirefox()&&(a<=189&&a>=186)?1:a<=192&&a>=190||a<=222&&a>=219?1:a==111||a==106||a==109||a==107||a==110?1:0};a.isCharacter=function Owa$KeyCodes$isCharacter(b){return a.isAlphaNumCharacter(b)||a.isNonAlphaNumCharacter(b)||b==a.SPACEBAR};a.isCharacterExcludeSemicolon=function Owa$KeyCodes$isCharacterExcludeSemicolon(b){return a.isCharacter(b)&&b!=a.getKeySemicolon()};a.isDirtyingKey=function Owa$KeyCodes$isDirtyingKey(b){return b!=a.ESC}})()})();g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/perfmarkers.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Component.PerfMarkers");var d=null,a=[],b=0,c=0,g=3e5,e="pfmk",f="/owa/csdc.gif",h="owacsdc",i={"Logon.Start":"M1","ListView.Init.End":"M2","MessageView.Init.End":"M3","Navigation.Init.End":"M4","ReadConversation.Init.End":"M5","ReadMessage.Init.End":"M6","ListView.Delete.Start":"M7","ListView.CbDel.End":"M8","ListView.SetRdSt.Start":"M9","ListView.CbSetRdSt.End":"M10","CategoryMenu.OnClose.Start":"M11","FldrVLV.CbSelCat.End":"M12","CbOnSlctCat.End":"M13","FldrVLV.FlgItms.Start":"M14","FldrVLV.CbFlgItms.End":"M15","FlgItm.Start":"M16","CbFlgItms.End":"M17","FolderManager.CpMvItms.Start":"M18","CbCpMvItms.End":"M19","LoadView.End":"M20","FolderTreeNode.OnEmptyFdr.Start":"M21","FolderTree.CbOnEmptyFld.End":"M22","SearchControl.Search.Start":"M23","SearchControl.ClearSearch.Start":"M24","ListView.New.Start":"M25","EditMessagePage.Init.End":"M26","AttchSubmit.Start":"M27","AttchSubmit.Cancel":"M28","ShwAttchDlg.End":"M29","EditMessage.ProcessOnSend.Start":"M30","EditMessage.CbProcessItem.End":"M31","cbOeh.Error":"M32","SwitchReadingPane.Start":"M33","onMailSelChng.Start":"M34","ReadingPane.Exists":"M35","ReadingPane.NotExists":"M36","LoadView.NoCache":"M37","ListView.sndDel.End":"M38","StartPage.Start":"M39","ReadingPane.Visible.End":"M40","SL_OnFilesUploadingStarted.End":"M41","SL_OnFilesToAttachSelected.Start":"M42","FolderManager.CpMvItms.EWS.End":"M43","ListView.SetRdSt.End":"M44","MessageCache.Hitted":"M45","MessageCache.NoCache":"M46","ConversationRow.Updated":"M47","MsgVLV.expand":"M48"};addPerfMarker=function Owa$Component$PerfMarkers$addPerfMarker(d,b){try{window.msWriteProfilerMark&&!b&&window.msWriteProfilerMark(d);if(isClientSideDataCollectingEnabled()){if(!b)b=new Date;var f=i[d];if(!f)f=d;var e=f+":"+b.valueOf().toString();a.push(e);if(e.length>c)c=e.length;isExceedUrlLength()&&Owa.Dom.Window.get_Current().setTimeout(uploadPerfMarkers,1)}}catch(g){}};function uploadPerfMarkers(){try{if(a.length>0){var c=f+"?UA=0&"+e+"=",d=c+serializePerfMarkersForQueryString(c),b=new oeReq("","",null,null,GET,null,null,null,null,null,null,false);b.sUrl=d;b.fIgnoredForPerfConsole=true;b.send()}}catch(g){}}function clearTimer(){if(b!=0){Owa.Dom.Window.get_Current().clearTimeout(b);b=0}}Owa.Component.PerfMarkers.initialize=function Owa$Component$PerfMarkers$initialize(){try{if(isClientSideDataCollectingEnabled())b=Owa.Dom.Window.get_Current().setTimeout(cbTimerTriggeredUploadPerfMarkers,g)}catch(a){}};Owa.Component.PerfMarkers.dispose=function Owa$Component$PerfMarkers$dispose(){try{if(isClientSideDataCollectingEnabled()){uploadPerfMarkers();clearTimer()}}catch(a){}};function cbTimerTriggeredUploadPerfMarkers(){try{uploadPerfMarkers();refreshUploadTimer()}catch(a){}}Owa.Component.PerfMarkers.getQueryString=function Owa$Component$PerfMarkers$getQueryString(d){try{var b="";if(a.length>0){sPrefix="&"+e+"=";var c=serializePerfMarkersForQueryString(d+sPrefix);if(c.length>0){b=sPrefix+c;refreshUploadTimer()}}return b}catch(f){}};function refreshUploadTimer(){clearTimer();b=Owa.Dom.Window.get_Current().setTimeout(cbTimerTriggeredUploadPerfMarkers,g)}function isExceedUrlLength(){var d=f+"?UA=0&"+e+"=",b=d.length+a.length*(c+1);return b>=MAX_ALLOWED_URL_LENGTH?true:false}function serializePerfMarkersForQueryString(f){var b="";if(a.length>0&&c>0){var d=Math.min(parseInt((MAX_ALLOWED_URL_LENGTH-f.length)/(c+1)),a.length),e=a.splice(0,d);b=e.join(";")}return b}function isClientSideDataCollectingEnabled(){if(d==null){var a=h+"=1";d=document.cookie.indexOf(a)!=-1}return d}})();g_fModuleLoaded[".\\components/perfmarkers.js".toLowerCase()]=1;function updCmp(a,d,c,b){try{if(a==null)a=window;window.t_onUpdCmp&&window.t_onUpdCmp(a,d,c,b)}catch(e){}}var MMRdy_Bdy=1,MMRdy_Frm=2,g_MMRdy_Stat=0;function readFmUpdCmp(a){if(isFlgSt(g_MMRdy_Stat,MMRdy_Bdy|MMRdy_Frm)){g_MMRdy_Stat=0;updCmp(a)}}function popLgn(){opnWin("?ae=Dialog&t=CloseWindow&exsvurl=1",800,600,1)}function rplLgn(){self.location.reload(true)}var MASTER_WINDOW_COOKIE_NAME_1="MstrPgLd1",MASTER_WINDOW_COOKIE_NAME_2="MstrPgLd2",MASTER_WINDOW_COOKIE_RENEW_TIME=45*1e3,MASTER_WINDOW_COOKIE_EXPIRY_TIME=60*1e3,g_mstrCk=0,g_mstrCk2=0,g_fIsMasterWindowErrorShown=0,g_mstrWindow=null;function removeFromWindowManager(){try{var a=gtMstr();if(a){var b=a.g_winMgr;window.sHash&&b.RmWin(window.sHash)}}catch(c){}}function gtIMMgr(){try{if(!g_IMMgr)g_IMMgr=gtMstrIMMgr();else g_IMMgr.Chk()}catch(a){g_IMMgr=gtMstrIMMgr()}return g_IMMgr}function gtMstrIMMgr(){var a=gtMstr();return a&&a.g_IMMgr?a.g_IMMgr:0}function gtMstr(){if(g_mstrWindow)try{if(!g_mstrWindow.closed)return g_mstrWindow}catch(c){return null}var b=0,a=window;while(1)try{if(!a.closed&&isDf(typeof a.a_isMstr)&&a.a_isMstr){b=1;break}if(a.parent==a&&!(a.opener||a.dialogArguments&&a.dialogArguments.opener)||a.opener==a&&a.parent==a)break;if(a.opener&&a.opener!=a)a=a.opener;else if(a.dialogArguments&&a.dialogArguments.opener&&a.dialogArguments.opener!=a)a=a.dialogArguments.opener;else if(a.parent!=a)a=a.parent;else break;if(isDf(typeof a.g_mstrWindow)&&a.g_mstrWindow&&!a.g_mstrWindow.closed){g_mstrWindow=a.g_mstrWindow;return g_mstrWindow}if(a.closeModalDialog)break}catch(c){break}g_mstrWindow=b?a:null;return g_mstrWindow}function createMasterWindowCookies(){if(isDf(typeof a_oPndGt)&&isDf(typeof a_isMstr)){if(!g_mstrCk){g_mstrCk=new Cky(MASTER_WINDOW_COOKIE_NAME_1);g_mstrCk2=new Cky(MASTER_WINDOW_COOKIE_NAME_2)}if(g_mstrCk.IsLdd()&&g_mstrCk2.IsLdd()){Owa.Components.Application.failWithWarning(htmlEnc(L_ErrNoOthrIns).format("<br><br>","<br>"));g_fIsMasterWindowErrorShown=1;return false}else{g_mstrCk.Add();var a=new Date;a.setTime(a.getTime()+MASTER_WINDOW_COOKIE_EXPIRY_TIME);g_mstrCk2.Add(a);setTimeout("refreshMasterWindowCookies()",MASTER_WINDOW_COOKIE_RENEW_TIME)}}return true}function expireMasterWindowCookies(){g_mstrCk&&!g_fIsMasterWindowErrorShown&&g_mstrCk.Expire();g_mstrCk2&&!g_fIsMasterWindowErrorShown&&g_mstrCk2.Expire()}function refreshMasterWindowCookies(){var a=new Date;a.setTime(a.getTime()+MASTER_WINDOW_COOKIE_EXPIRY_TIME);g_mstrCk2=new Cky(MASTER_WINDOW_COOKIE_NAME_2);g_mstrCk2.Add(a);setTimeout("refreshMasterWindowCookies()",MASTER_WINDOW_COOKIE_RENEW_TIME)}var CT_HTML=1,CT_JS=2,CT_UNK=3,oeReq,oeSt,oeResp,cbOehST,cbOeh;!g_fModuleLoaded[".\\components/oeh.js".toLowerCase()]&&(function(){(function(){Type.createNamespace("Owa.Components");var c="X-UserActivity",a=0;oeReq=Owa.Components.OehRequest=function Owa$Components$OehRequest(e,d,k,l,a,b,j,g,h,c,i,f){this.sUrl="ev.owa?oeh=1";this.sUrl+="&ns="+e+"&ev="+d;if(c)this.sUrl+="&rid="+c;if(b)this.sUrl=b+"/"+this.sUrl;else if(Owa.Components.OehRequest.sHardCodeOwaPathForTest)this.sUrl="/"+Owa.Components.OehRequest.sHardCodeOwaPathForTest+"/"+this.sUrl;if(!a)a=POST;this.sVerb=a.toUpperCase();this.sNs=e;this.sEv=d;this.sQS="";this.fSync=j;this.oCtx=k;this.oDoc=new Owa.Dom.XmlDocument;this.oRoot=this.oDoc.createElement("params");this.oDoc.appendChild(this.oRoot);this.cb=l;this._fNotUserAction=!!g;this._fNeverDispose=!!h;this._fSubPageContent=!!f;this._fProcessXhrStatusZeroAsError=0;!i&&isDf(typeof a_sCnNm)&&this.add(a_sCnNm,rtrvUCCk())};Owa.Components.OehRequest.prototype.add=function Owa$Components$OehRequest$add(c,a){a=Owa.Components.OehRequest.parseValueToString(a);if(this.sVerb==POST){var b=this.oDoc.createElement(c);b.set_TextContent(a);this.oRoot.appendChild(b)}else{var d=this.sQS;d+="&"+c+"="+urlEnc(a);this.sQS=d}};Owa.Components.OehRequest.prototype.addRg=function Owa$Components$OehRequest$addRg(e,b){for(var c=this.oDoc.createElement(e),a=0;a<b.length;a++){var d=this.oDoc.createElement("item"),f=Owa.Components.OehRequest.parseValueToString(b[a]);d.set_TextContent(f);c.appendChild(d)}this.oRoot.appendChild(c)};Owa.Components.OehRequest.prototype.addSt=function Owa$Components$OehRequest$addSt(c,b){var a=this.oDoc.createElement(c);a.appendChild(b.oE);this.oRoot.appendChild(a)};Owa.Components.OehRequest.prototype.addRgSt=function Owa$Components$OehRequest$addRgSt(e,b){for(var c=this.oDoc.createElement(e),a=0;a<b.length;a++){var d=this.oDoc.createElement("item");d.appendChild(b[a].oE);c.appendChild(d)}this.oRoot.appendChild(c)};Owa.Components.OehRequest.prototype.send=function Owa$Components$OehRequest$send(){if(this._fSubPageContent)this.sQS+="&SP=1";if(this._fNotUserAction)this.sUrl+="&UA=0";else this.sNs!="EwsProxy"&&refreshLastServerActivityTime((new Date).valueOf());if(!this.fSync){this.sQS+=ClientPerfCounters.getQS(this.sUrl+this.sQS);var e=Owa.Component.PerfMarkers.getQueryString(this.sUrl+this.sQS);this.sQS+=e}this.oAjaxRequest=new Owa.Dom.AjaxRequest(this.sUrl+this.sQS,this.sVerb,this,cbOeReq,this.fSync,this._fNeverDispose,cbOeReqCancel);++a;this._fProcessXhrStatusZeroAsError&&this.oAjaxRequest.set_ProcessXhrStatusZeroAsError();this._fNotUserAction&&this.oAjaxRequest.setRequestHeader(c,"0");var b;if(this.sVerb==POST){var d=this.oDoc.get_Xml();b=this.oAjaxRequest.send(isDf(typeof d)&&d?d.replace(/([\x00-\x08\x0b-\x0c\x0e-\x1f])/g,"?"):"")}else b=this.oAjaxRequest.send("");return this.fSync?b:null};Owa.Components.OehRequest.prototype.cancelCallback=function Owa$Components$OehRequest$cancelCallback(){if(!this.oAjaxRequest)throw"Cannot call 'cancelCallback' before the request is sent";this.oAjaxRequest.cancelCallback()};Owa.Components.OehRequest.prototype.set_ProcessXhrStatusZeroAsError=function Owa$Components$OehRequest$set_ProcessXhrStatusZeroAsError(){this._fProcessXhrStatusZeroAsError=1};Owa.Components.OehRequest.prototype.get_IsNotUserAction=function Owa$Components$OehRequest$get_IsNotUserAction(){return this._fNotUserAction};Owa.Components.OehRequest.hasPendingRequests=function Owa$Components$OehRequest$hasPendingRequests(){return a>0};Owa.Components.OehRequest.get_CurrentPendingRequestsCount=function Owa$Components$OehRequest$get_CurrentPendingRequestsCount(){return a};Owa.Components.OehRequest.abortOehRequests=function Owa$Components$OehRequest$abortOehRequests(c,f,e,d){var b=Owa.Dom.AjaxRequest.abortAjaxRequests(c,f,e,d);a=Math.max(0,a-b)};function cbOeReqCancel(){a--}function cbOeReq(g){var b=new oeResp(g),f=b.oXmlHttp;if(f.status==200){var c=f.getResponseHeader("X-OWA-EventResult");if(!(c=="0"||(c==null||c=="")))if(c=="1"){var d=Owa.Dom.Document.get_Current().createElement("div");d.set_InnerHtml(b.sBody);var e=d.getDescendantById("err");b.sErr=e.getAttribute("_msg");b.sErrorDetails=e.getAttribute("_details");var i=e.getAttribute("_cd");b.iErr=i?parseInt(i,10):0;var k=d.getDescendantById("debugInfo");if(k)b.sErrDbg=k.get_OuterHtml();var h=d.getDescendantById("divCstInfo");if(h)b.divCustom=h}else b.sErr=L_IntErr}else b.sErr=getHttpErr(f.status);Owa.Components.OehRequest.get_onResponseReceived().dispatch(b);--a;var j=g.oCtx;if(j.cb){!j.cb(b)&&updCmp(window,b);b.cleanUpAfterCallback()}return b}function getHttpErr(b){var a=null;switch(b){case 0:a=L_NmNtRslv;break;case 403:a=L_AcsDnd;break;case 12002:case 408:a=L_Tmout;break;case 400:case 500:a=L_IntErr;break;case 12029:case 12007:a=L_NmNtRslv;break;case 503:a=L_SvcUnv;break;default:if(isDf(typeof L_HttpErr))a=L_HttpErr.format(b.toString());else a=b.toString()}return a}Owa.Components.OehRequest.parseValueToString=function Owa$Components$OehRequest$parseValueToString(a){var b;if(a==null)b="";else if(a.getDate!=null)b=a.toIsoString();else b=a.toString();return b};var b="OnResponseReceived";Owa.Components.OehRequest._oEvents={};Owa.Components.OehRequest._oEvents[b]=new Owa.Utility.EventHandlerCollection;Owa.Components.OehRequest.get_onResponseReceived=function Owa$Components$OehRequest$get_onResponseReceived(){return Owa.Components.OehRequest._oEvents[b]}})();(function(){oeSt=Owa.Components.OehStructure=function Owa$Components$OehStructure(a,b){this.oDoc=a.oDoc;this.oE=this.oDoc.createElement(b);this.oE.set_TextContent("")};Owa.Components.OehStructure.prototype.add=function Owa$Components$OehStructure$add(b,a){a=Owa.Components.OehRequest.parseValueToString(a);this.oE.setAttribute(b,a)}})();(function(){oeResp=Owa.Components.OehResponse=function Owa$Components$OehResponse(c){var a=c.oXmlHttp;this.sBody=a.responseText;this.oReq=c.oCtx;this.oCtx=this.oReq.oCtx;this.oXmlHttp=a;this.iStatus=a.status;this.fST=a.status==440;var b=a.getResponseHeader("Content-Type");if(!b)b="";if(b.toUpperCase().indexOf("HTML")>=0)this.iCT=CT_HTML;else if(b.toUpperCase().indexOf("JAVASCRIPT")>=0)this.iCT=CT_JS;else this.iCT=CT_UNK};Owa.Components.OehResponse.prototype.get_Context=function Owa$Components$OehResponse$get_Context(){return this.oCtx};Owa.Components.OehResponse.prototype.CheckErrors=function Owa$Components$OehResponse$CheckErrors(a){return a?this.isErr():!cbOeh(this)};Owa.Components.OehResponse.prototype.IsNetworkConnectionError=function Owa$Components$OehResponse$IsNetworkConnectionError(){switch(this.iStatus){case 0:case 12007:return true}return false};Owa.Components.OehResponse.prototype.isErr=function Owa$Components$OehResponse$isErr(){return this.fST||this.sErr};Owa.Components.OehResponse.prototype.getResponseAsDomElement=function Owa$Components$OehResponse$getResponseAsDomElement(d,a){a=a||Owa.Dom.Document.get_Current();var c=a.get_Body();c.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,this.sBody);var b=c.get_LastChild();this._sResponseElement=b;this._fResponseElementTentative=d;return b};Owa.Components.OehResponse.prototype.cleanUpAfterCallback=function Owa$Components$OehResponse$cleanUpAfterCallback(){if(this._fResponseElementTentative){this._sResponseElement.remove();delete this._sResponseElement}};Owa.Components.OehResponse.prototype.getResponseHeader=function Owa$Components$OehResponse$getResponseHeader(a){return this.oXmlHttp.getResponseHeader(a)};cbOehST=function Owa$Components$OehResponse$sessionTimeoutCallback(a){if(a.fST){if(g_iLgn==1)popLgn();else g_iLgn==2&&rplLgn();return 0}return 1};cbOeh=function Owa$Components$OehResponse$GenericCallback(a,d,c,b){if(!cbOehST(a))return 0;if(a.sErr){ClientPerfCounters.increment(ClientPerfCounters.Name.OehErrors);if(b||a.oReq.get_IsNotUserAction()){ClientPerfCounters.increment(ClientPerfCounters.Name.OehErrorsSuppressed);return 0}else{addPerfMarker("cbOeh.Error");shwErrDlg(a,0,0,0,0,0,0,d,c)}}else return 1;return 0}})()})();g_fModuleLoaded[".\\components/oeh.js".toLowerCase()]=1;function rndm(){return Math.round(Math.random()*1e6)}var CC_ACC=0,CC_FBST=1,CC_MRUFNTS=2,CC_FNTLST=3,CC_PR=4,CC_SC=5,CC_MRUC=6,CC_MTR=7,CC_MTC=8,CC_MTCFG=9,CC_THM=10,ADD=0,REF=1,DEL=2,g_CC=null;function hasClientCacheAutoCompleteCache(){return g_CC&&isDf(typeof g_CC.sAcc)&&g_CC.sAcc}function hasClientCachePrimaryRecipient(){return g_CC&&isDf(typeof g_CC.sPr)}function hasClientCacheFromAddress(){return g_CC&&isDf(typeof g_CC.sDfltFr)}function hasClientCacheSubscriptionCache(){return g_CC&&isDf(typeof g_CC.sSc)}function hasClientCacheMruCache(){return g_CC&&isDf(typeof g_CC.sMruc)}function initCC(c){if(chkCC())return;var a=null,b=Owa.Utility.getRootOwaWindow();try{a=b._domWindow.g_CC}catch(e){}if(!isDf(typeof a)||!a){var d=new oeReq("ClientCache","Get",0,cbCC,POST,0,c);d.send()}else g_CC=a}function initACC(){initCC(true);if(hasClientCacheAutoCompleteCache())try{g_rgoRcp=eval("new Array("+g_CC.sAcc+")")}catch(a){}}function isExpLgn(){return isDf(typeof a_fIsExpLgn)&&a_fIsExpLgn}function updSc(a){tryUpdCC(CC_SC,a,REF)}function fnChkCC(){return 1}function chkCC(){if(!g_CC)return false;try{g_CC.chkCC()}catch(a){return false}return true}function tryUpdCC(b,c,a){if(!g_CC)return false;try{g_CC.updCC(b,c,a)}catch(d){}}function fnUpdCC(i,a,h){if(!a)return;switch(i){case CC_ACC:switch(h){case ADD:var f=eval(a);if(!f._em)return;g_rgoRcp=eval("new Array("+this.sAcc+")");for(var e=0;e<g_rgoRcp.length;e++)if(g_rgoRcp[e]&&g_rgoRcp[e]._em.toLowerCase()==f._em.toLowerCase())return;if(this.sAcc!="")this.sAcc+=",";this.sAcc+=a;g_rgoRcp.push(f);break;case REF:this.sAcc=a;break;case DEL:var b=this.sAcc.split(a),d;if(b[0].trim()!="")if(b[1].trim()=="")d=b[0].slice(0,b[0].length-1);else d=b[0]+b[1].slice(1,b[1].length);else if(b[1].trim()=="")d="";else d=b[1].slice(1,b[1].length);this.sAcc=d}break;case CC_FBST:this.iFmtBrSt=a;break;case CC_MRUFNTS:this.sMruFnts=a;break;case CC_FNTLST:this._rgFontList=a;break;case CC_PR:this.sPr=a;break;case CC_SC:this.sSc=a;break;case CC_MRUC:this.sMruc=a;break;case CC_MTR:switch(h){case REF:if(!this.oMailTipsRequesters)this.oMailTipsRequesters={};var c;do c=rndm();while(this.oMailTipsRequesters[c]);this.oMailTipsRequesters[c]=a;a.setHash(c);break;case DEL:if(this.oMailTipsRequesters){var c=a.getHash();if(c&&this.oMailTipsRequesters[c])delete this.oMailTipsRequesters[c]}}break;case CC_MTC:if(!this.oMailTipsCache)this.oMailTipsCache={};Owa.Components.MailTipsResponder.updateClientCache(a,this.oMailTipsCache);break;case CC_MTCFG:if(a){if(!this.oMailTipsConfig)this.oMailTipsConfig={};for(var g in a)this.oMailTipsConfig[g]=a[g]}break;case CC_THM:this.iThmId=a}}function cbCC(a){if(a.sErr||a.iStatus==440)return;if(a.sBody){var c="("+a.sBody+")";setCC(c);var b=Owa.Utility.getRootOwaWindow();if(!Owa.Dom.Window.get_Current().equals(b))try{b._domWindow.setCC(c)}catch(d){}}}function setCC(a){g_CC=eval(a);g_CC.updCC=fnUpdCC;g_CC.chkCC=fnChkCC}function gtCCUrl(){initCC(true);var a="";if(!chkCC())a=g_ver;else a=g_ver+","+g_CC.sLng+","+g_CC.iThmId+","+(g_CC.fTxt?"Text":"HTML")+","+g_CC.fShwBcc+","+g_CC.fShwFrm;return"&cc="+Owa.Encoder.toBase64String(a,true)}function getStr(a,c){if(!a)return"";else{var b=a.toString();return c?jsEnc(b):b}}Type.createNamespace("Owa.Components.Storage");!g_fModuleLoaded[".\\components/istorage.js".toLowerCase()]&&(function(){Owa.Components.Storage.IStorage=function Owa$Components$Storage$IStorage(){throw new Error("Can't create an instance of interface");};Owa.Components.Storage.IStorage.prototype.get_Data=function Owa$Components$Storage$IStorage$get_Data(){throw new Error("Not implemented");};Owa.Components.Storage.IStorage.prototype.set_Data=function Owa$Components$Storage$IStorage$set_Data(){throw new Error("Not implemented");};Owa.Components.Storage.IStorage.createInterface("Owa.Components.Storage.IStorage")})();g_fModuleLoaded[".\\components/istorage.js".toLowerCase()]=1;Type.createNamespace("Owa.Components.Storage");!g_fModuleLoaded[".\\components/clipboard.js".toLowerCase()]&&(function(){Owa.Components.Storage.Clipboard=function Owa$Components$Storage$Clipboard(){Owa.Components.Storage.Clipboard.constructBase(this)};Owa.Components.Storage.Clipboard.saveContolContentsToClipboard=function Owa$Components$Storage$Clipboard$saveContolContentsToClipboard(c){var a=$(c),b=new Owa.Components.Storage.Clipboard;b.set_Data(a.get_TextContent())};Owa.Components.Storage.Clipboard.get_MimeType=function Owa$Components$Storage$Clipboard$get_MimeType(){return Owa.Utility.isSafari()?"text/plain":Owa.Utility.isFirefox()?"text/unicode":"text"};Owa.Components.Storage.Clipboard.prototype.get_Data=function Owa$Components$Storage$Clipboard$get_Data(){var b=Owa.Components.Storage.Clipboard.get_MimeType(),a;if(window.clipboardData)a=window.clipboardData.getData(b);return a};Owa.Components.Storage.Clipboard.prototype.set_Data=function Owa$Components$Storage$Clipboard$set_Data(b){var a=Owa.Components.Storage.Clipboard.get_MimeType();window.clipboardData&&window.clipboardData.setData(a,b)};Owa.Components.Storage.Clipboard.createClass("Owa.Components.Storage.Clipboard",Owa.Components.Control,Owa.Components.Storage.IStorage)})();g_fModuleLoaded[".\\components/clipboard.js".toLowerCase()]=1;var IT_MSG="IPM.Note",IT_CNT="IPM.Contact",IT_PDL="IPM.DistList",IT_TSK="IPM.Task",IT_PST="IPM.Post",IT_MTG="IPM.Schedule.Meeting",IT_MTR="IPM.Schedule.Meeting.Request",IT_MTC="IPM.Schedule.Meeting.Canceled",IT_MT_RSP_POS="IPM.Schedule.Meeting.Resp.Pos",IT_MT_RSP_TNT="IPM.Schedule.Meeting.Resp.Tent",IT_MT_RSP_NEG="IPM.Schedule.Meeting.Resp.Neg",IT_TSK_REQ="IPM.TaskRequest",IT_TSK_REQ_ACC="IPM.TaskRequest.Accept",IT_TSK_REQ_DEC="IPM.TaskRequest.Decline",IT_TSK_REQ_UPD="IPM.TaskRequest.Update",IT_MSG_SECURE="IPM.Note.Secure",IT_MSG_SIGNED="IPM.Note.Sign",IT_MSG_MULTIPART_SIGNED="IPM.Note.MultipartSigned",IT_APP="IPM.Appointment",IT_SHR="IPM.Sharing",IT_APP_EXC="IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}",IT_APV_RQ="IPM.Note.Microsoft.Approval.Request",IT_APV_RPLY_APP="IPM.Note.Microsoft.Approval.Reply.Approve",IT_APV_RPLY_RJT="IPM.Note.Microsoft.Approval.Reply.Reject",IT_SMS="IPM.Note.Mobile.SMS",IT_AD="AD",IT_SUFFIX_SMIME="SMIME",IT_SUFFIX_SMIME_SIGNED="SMIME.Signed",IT_SUFFIX_SMIME_MULTIPART_SIGNED="SMIME.MultipartSigned",IT_SUFFIX_SMIME_SIGNED_ENCRYPTED="SMIME.SignedEncrypted",IT_SUFFIX_SMIME_ENCRYPTED="SMIME.Encrypted";function isOfClss(a,b){return a.lc().startsW(b.lc())&&(a.length==b.length||a.length>b.length&&a.charAt(b.length)==".")}function hasClassSuffix(a,b){if(a==null)return false;a=a.toLowerCase();b="."+b.toLowerCase();return a.endsWith(b)}function isSMime(a){return hasClassSuffix(a,IT_SUFFIX_SMIME)||hasClassSuffix(a,IT_SUFFIX_SMIME_MULTIPART_SIGNED)||hasClassSuffix(a,IT_SUFFIX_SMIME_ENCRYPTED)||hasClassSuffix(a,IT_SUFFIX_SMIME_SIGNED_ENCRYPTED)||hasClassSuffix(a,IT_SUFFIX_SMIME_SIGNED)}function isCal(a){return isOfClss(a,IT_APP)||isOfClss(a,IT_APP_EXC)}function isApprovalRequest(a){return a&&isOfClss(a,IT_APV_RQ)}function getApplicationElementForItem(b,a,d,e,c){return isOfClss(d,IT_SHR)&&(a=="Open"||a=="Preview"||a=="")&&!(e||c)?"PreFormAction":b}function isMvAllw(a,b){return a==""||isOfClss(a,T_MSG)?1:isOfClss(a,T_CAL)?isOfClss(b,IT_APP):isOfClss(a,T_CON)?isOfClss(b,IT_CNT)||isOfClss(b,IT_PDL):isOfClss(a,T_TSK)?isOfClss(b,IT_TSK):0}function updCMM(){setCSVAsStr(CSV_MRU_UPD_DT,new Date);setCSVAsStr(CSV_MRU_CACHE,"")}function cbCpMvItms(h,s,a,f,t,d,k,u){var r=isDf(h._oResponse),i,b,j,e=0,q=wt(),o=0,n=q==s;if(n){if(!cbOeh(h))return}else if(h.isErr&&h.isErr())return;if(shwRspWrn(h,"errCpyMv",!n))return;updCMM();if(!k&&f==d)return;if(u){if(isStPg())try{q.rfrshCal()}catch(v){}else isDf(typeof a_fCal)&&a_fCal&&refresh();return}a=a||Owa.UIControls.SubPage.get_Instance();var g=0;if(isReadConversationPageObject(a)){var l=a.get_ParentSubPage();if(l!=null&&isFolderViewSubPageObject(l))a=l}if(isNavigationPageObject(a)){b=a.getLstVw(f);j=a.getLstVw(d);e=a.getSubPageVariable("a_sLstFID");if(!b)b=a.getLstVw(e);if(b&&b.isFltrd())g=1}else if(isFolderViewSubPageObject(a)){b=a.get_VirtualListView();e=a.get_FolderId();g=b.isFltrd();o=1;if(d==f)j=b}else if(!k&&n){window.close();return}if(j)if(e==d)i=1;else!o&&a.get_SubPageController().invokeFunction("stDrty",[d]);d&&isPFId(d)&&a.get_SubPageController().invokeFunction("stDrty",[d]);var m;if(b&&b.isCnvVw&&b.isCnvVw())m=1;if(!r&&b&&(!k||m))if(e==f||g)if(m)i=1;else if(isFolderViewSubPageObject(a)&&a.isPF()&&!k)i=1;else{b.rmvRws(t);b.isDumpsterVw()&&b.updCnts();i=g}else!o&&stDrty(f);var c;if(e==f||g)c=b;else if(e==d)c=j;if(c){if(i||c.get_SearchControl())if(!g&&(c.isCnvVw&&c.isCnvVw()))c.cbCnvCpMv(h);else{if(c.get_SearchControl())c.get_SearchControl().fReExecuteSearch=true;c.rfrsh()}var p=c.get_SubPage().gtCnvRP();p&&p.rfrsh(0,1)}}function shwRspWrn(c,e,d){if(c.sBody){var b=Owa.Dom.Document.get_Current().createElement("div");b.set_InnerHtml(c.sBody);var a=b.getDescendantById(e);if(a!=null&&a.getAttribute("_msg")!=null){!d&&OKDlg(a.getAttribute("_msg"),null,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng).show();return 1}}}function mvItm(a){if(g_fJnkRq)return;var g=new Array(a.sId),e=null,d=null,f=a.oCallerSubPage;if(a.iActn==ACTN_NTJNK){e=f.getSubPageVariable("a_sJnkId");d=a_sInbxId}else if(a.iActn==ACTN_ADDBSL){e=f.getSubPageVariable("a_sFId");d=a_sJnkId}var b={};b.iActn=a.iActn;b.rgIds=g;b.sDstFId=d;b.fCls=a.fCls;b.oCallerSubPage=a.oCallerSubPage;var c=new oeReq("MsgVLV2","Move",b,cbMvItm);c.addRg("id",g);c.add("destId",d);c.add("fId",e);c.add("fAddToMRU",0);c.send();g_fJnkRq=1}function cbCopyMoveItem(c){var a=this._get_TreeControl().gtSelNd(),d=a.gtFId(),b=a.gtFCC(),e=this.get_ButtonCaptions(c)==L_Cp;cbCopyMoveItem.fnCallback(d,null,b,e);cbCopyMoveItem.fnCallback=null}function updateFolderPickerCopyMoveItemButton(){var a=this._get_TreeControl().gtSelNd(),b=a?a.gtER():0;this.enableButton(this.get_ButtonCaptions()[0],a?!(b&&!hasER(b,ER_CC))&&!a.isS(DFT_SFR)&&!a.isS(DFT_ERT):false)}function updateFolderPickerCopyMoveFolderButton(){var a=this._get_TreeControl().gtSelNd();this.enableButton(this.get_ButtonCaptions()[0],a?a.canAcceptSubFolderType(this.get_SourceTreeNode().gtFCC()):false)}Type.createNamespace("Owa.Components.CssSprites");!g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()]&&(function(){function mapFilenameToClassName(a){return"sprites-"+a.replace(".","-")}function getImageClass(a){return"csimg csimgbg "+mapFilenameToClassName(a)}Owa.Components.CssSprites.getImageMarkup=function Owa$Components$CssSprites$getImageMarkup(d,c,e,b){var f=b?b:getRsrcF,a;a='<img src="';a+=f("clear1x1.gif");a+='" class="';if(d!="clear1x1.gif")a+=getImageClass(d);if(e){a+=" ";a+=e}a+='" ';if(c)a+=c;a+=">";return a};Owa.Components.CssSprites.getImageElement=function Owa$Components$CssSprites$getImageElement(c,a){if(!a)a=Owa.Dom.Document.get_Current();var b=a.createElement("img");b.setAttribute("src",getRsrcF("clear1x1.gif"));c!="clear1x1.gif"&&b.addCssClass(getImageClass(c));return b};Owa.Components.CssSprites.updateImage=function Owa$Components$CssSprites$updateImage(a,d){if(!a.get_CssClasses)a=Owa.Dom.Node.wrapDomNode(a);for(var e=a.get_CssClasses(),b=null,c=0;c<e.length;c++)if(e[c].startsWith("sprites-")){b=e[c];break}if(d=="clear1x1.gif"){if(b){a.removeCssClass("csimg csimgbg");a.removeCssClass(b)}}else if(b)a.replaceCssClass(mapFilenameToClassName(d),b);else a.addCssClass(getImageClass(d))}})();g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()]=1;function parseTm(h,f,g){var j=new RegExp("([012]?[0-9]|2[0-4])([^\\d]+([0-5]?[0-9])?)?","gi");parseTm.rxAmPm.lastIndex=0;var c=j.exec(h);if(null==c)return-1;var b=parseTm.rxAmPm.exec(h),e=null!=b&&!!b[2],i=null!=b&&!!b[1],k=Number(c[3]),a=Number(c[1]);if(null==b&&f!=null&&g!=null&&cmpDy(f,g)&&a<12){var d=f.ghrs();if(d<12&&a<d)e=1;else if(12<=d&&d<=a+12&&a+12<=23)e=1}if(c[1]<12&&e)a+=12;if(a==12&&i)a=0;return 23<a?-1:a*60+k}parseTm.rxAmPm;function fmtDt(a,e,d){var g=0,c=0,b="";if(!isDf(typeof d))d=0;while(g<e.length){var h=e.charAt(g);switch(h){case"d":c=prsRpt(e,g,h);var k=!d?a.gdt():a.gdtl();if(c==4)b+=getDtf(DTF_FULDN)[!d?a.getUTCDay():a.getDay()];else if(c==3)b+=getDtf(DTF_ABRDN)[!d?a.getUTCDay():a.getDay()];else if(c==2)b+=k>9?k:"0"+k;else b+=k;break;case"M":c=prsRpt(e,g,h);var i=(!d?a.gmo():a.gmol())+1;if(c==4)b+=getDtf(DTF_FULMN)[!d?a.gmo():a.gmol()];else if(c==3)b+=getDtf(DTF_ABRMN)[!d?a.gmo():a.gmol()];else if(c==2)b+=i>9?i:"0"+i;else b+=i;break;case"y":c=prsRpt(e,g,h);var o=!d?a.gyr():a.gyrl(),m=o%100;if(c==4)b+=o;else b+=9<m?m:"0"+m;break;case"h":c=prsRpt(e,g,h);var f=!d?a.ghrs():a.ghrsl();if(f>12)f-=12;if(f==0)f=12;if(c==2)b+=9<f?f:"0"+f;else b+=f;break;case"H":c=prsRpt(e,g,h);var f=!d?a.ghrs():a.ghrsl();if(c==2)b+=9<f?f:"0"+f;else b+=f;break;case"m":c=prsRpt(e,g,h);var i=!d?a.gmins():a.gminsl();if(c==2)b+=9<i?i:"0"+i;else b+=i;break;case"s":c=prsRpt(e,g,h);var l=!d?a.gsecs():a.gsecsl();if(c==2)b+=9<l?l:"0"+l;else b+=l;break;case"t":c=prsRpt(e,g,h);var f=!d?a.ghrs():a.ghrsl();b+=11<f?getDtf(DTF_PM):getDtf(DTF_AM);break;case"'":case'"':var p=h,j=g+1;while(j<e.length){var n=e.charAt(j++);if(n==p)break;else if(n=="\\"){j++;if(j>=e.length)break;b+=e.charAt(j)}else b+=n}c=j-g;break;default:b+=h;c=1}g+=c}return b}var g_fDtfInit=0;function initDtf(){if(g_fDtfInit)return;if(!fmtDt.sAM)fmtDt.sAM=isDf(typeof L_AM)?L_AM:0;if(!fmtDt.sPM)fmtDt.sPM=isDf(typeof L_PM)?L_PM:0;if(!fmtDt.rgFulDN)fmtDt.rgFulDN=isDf(typeof a_rgFulDN)?a_rgFulDN:0;if(!fmtDt.rgAbrDN)fmtDt.rgAbrDN=isDf(typeof a_rgAbrDN)?a_rgAbrDN:0;if(!fmtDt.rgFulMN)fmtDt.rgFulMN=isDf(typeof a_rgFulMN)?a_rgFulMN:0;if(!fmtDt.rgAbrMN)fmtDt.rgAbrMN=isDf(typeof a_rgAbrMN)?a_rgAbrMN:0;g_fDtfInit=1}var DTF_AM=1,DTF_PM=2,DTF_FULDN=3,DTF_ABRDN=4,DTF_FULMN=5,DTF_ABRMN=6;function getDtf(a){initDtf();switch(a){case DTF_AM:return fmtDt.sAM;break;case DTF_PM:return fmtDt.sPM;break;case DTF_FULDN:return fmtDt.rgFulDN;break;case DTF_ABRDN:return fmtDt.rgAbrDN;break;case DTF_FULMN:return fmtDt.rgFulMN;break;case DTF_ABRMN:return fmtDt.rgAbrMN;break;default:return null}}function prsRpt(c,b,d){var a=b+1;while(a<c.length&&c.charAt(a)==d)a++;return a-b}function rndrATLst(c,a){c.clr();for(var b=0;b<48;++b){var d=b*30,a=new Date(a);a.shrs(0,d);c.add(a,fmtDt(a,g_sShtTmFmt))}}function toDate(c,b,a){return new Date(Date.UTC(c,b-1,a,0,0,0))}function cmpDy(a,b){return a.gyr()==b.gyr()&&a.gmo()==b.gmo()&&a.gdt()==b.gdt()}function cmpDt(a,b){return cmpDy(a,b)&&cmpTm(a,b)}function cmpTm(a,b){return a.ghrs()==b.ghrs()&&a.gmins()==b.gmins()}function cpyDt(a,b){b.syr(a.gyr(),a.gmo(),a.gdt());return b}function cpyTm(b,a){a.shrs(b.ghrs(),b.gmins());return a}function dtST(a,b,c,d){a.smsecs(0);a.ssecs(d);a.smins(c);a.shrs(b);return a}function getUTCDifference(e,b){if(!b)b=0;var a=new Date,c=new Date,d=a.getTimezoneOffset(),f=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds()));c.setTime(f.getTime()+(d+e)*6e4+b);return c}var DLG_MOD=1,DLG_RSZ=2,DLG_STA=4,DLG_CTR=8,DLG_SCR=16,MDL_DLG_BKG="divModalDlgBkgd",MDL_DLG_IFRM="iFrameModalDlg",bResize=false,bIsResizing=false,CH_MDL_DLG_HGHT=0,CH_MDL_DLG_WDTH=0,oDivMdlDlgBkgd,oDivMdlDlgFrm,oParentWindow;function shwMdlDlg(f,e,d,b,c,a){if(window.showModalDialog)a&&a(shwDlg(f,e,d,DLG_MOD|DLG_CTR,b,c));else shwMdlDlgAsIFrame(f,e,d,b,c,a,false,true)}function closeModalDialog(){if(oDivMdlDlgBkgd){oParentWindow&&oParentWindow.mdlDlgCallback&&oParentWindow.mdlDlgCallback(window.top.returnValue);if(bResize){var a=Owa.Dom.Window.get_Current().get_TopWindow();bIsResizing=true;a.resizeTo(CH_MDL_DLG_WDTH,CH_MDL_DLG_HGHT)}oDivMdlDlgBkgd.set_Visibility(Owa.Style.Visibility.Hidden);oDivMdlDlgFrm._oDomNode.setAttribute("src","about:blank")}else Owa.Dom.Window.get_Current().get_TopWindow().close()}function shwMdlDlgAsIFrame(p,g,f,o,k,m,i,l){window.mdlDlgCallback=m;var c={};c.opener=window;c.oPar=o;c.mdlDlg=true;Owa.Dom.Window.get_Current().get_TopWindow().setGlobalVariable("dialogArguments",c);oParentWindow=window;var b="?ae=Dialog&t="+p;if(k)b+=k;var d=window.location.href,j=d.indexOf("?"),n=d.indexOf("ecp")>-1;if(j>0)d=d.substring(0,j);var a=Owa.Dom.Document.get_Current();if(!oDivMdlDlgBkgd){oDivMdlDlgBkgd=a.createElement("DIV");oDivMdlDlgBkgd=a.appendChild(oDivMdlDlgBkgd);oDivMdlDlgBkgd.set_Id(MDL_DLG_BKG)}oDivMdlDlgBkgd.set_Visibility(Owa.Style.Visibility.Visible);if(n){if(!oDivMdlDlgFrm){oDivMdlDlgFrm=a.createElement("IFRAME");oDivMdlDlgFrm=oDivMdlDlgBkgd.appendChild(oDivMdlDlgFrm);oDivMdlDlgFrm.set_Id(MDL_DLG_IFRM)}b="/owa/"+b;oDivMdlDlgFrm._oDomNode.setAttribute("src",b)}else{var h=Owa.Components.SubPageControllerFactory.createControllerByUrl(oDivMdlDlgBkgd,b,MDL_DLG_IFRM,false,false,false,l);Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().addChildController(h);oDivMdlDlgFrm=h._get_Element()}if(i){bResize=i;oDivMdlDlgFrm.set_Height(100,Owa.Style.Unit.Percent);oDivMdlDlgFrm.set_Width(100,Owa.Style.Unit.Percent);oDivMdlDlgBkgd.set_Height(100,Owa.Style.Unit.Percent);oDivMdlDlgBkgd.set_Width(100,Owa.Style.Unit.Percent);oDivMdlDlgBkgd.set_Left(0);oDivMdlDlgBkgd.set_Top(0);CH_MDL_DLG_HGHT==0&&CH_MDL_DLG_WDTH==0&&this.computeMdlDlgHeightAndWidth();var e;window.onresize=function(){e&&clearTimeout(e);e=setTimeout(resizeCompleted,500)};bIsResizing=true;Owa.Dom.Window.get_Current().get_TopWindow().resizeTo(g,f)}else{oDivMdlDlgBkgd.set_Height(f);oDivMdlDlgBkgd.set_Width(g);oDivMdlDlgBkgd.set_Left((a.get_Body().get_OffsetWidth()-g)/2);oDivMdlDlgBkgd.set_Top((a.get_Body().get_OffsetHeight()-f)/2)}}function resizeCompleted(){if(!bIsResizing)this.computeMdlDlgHeightAndWidth();else bIsResizing=false}function shwABDlg(f,e,b,c,d,a){sN="AddressBook";if(window.showModalDialog){if(a){b=b||DLG_MOD|DLG_CTR;a(shwDlg(sN,f,e,b,c,d))}}else this.shwMdlDlgAsIFrame(sN,f,e,c,d,a,true,true)}function shwDlg(i,h,g,d,f,e){var c={};c.opener=window;c.oPar=f;if(!d)d=DLG_RSZ|DLG_CTR;function _chkF(a){return d&a?"yes;":"no;"}var a="help:no;";a+="dialogwidth:"+scaleX(h)+"px;dialogheight:"+scaleY(g)+"px;";a+="resizable:"+_chkF(DLG_RSZ);a+="status:"+_chkF(DLG_STA);a+="scroll:"+_chkF(DLG_SCR);a+="center:"+_chkF(DLG_CTR);var b="?ae=Dialog&t="+i;if(isDf(typeof sOwaVDir))b=sOwaVDir+b;if(e)b+=e;try{return d&DLG_MOD?window.showModalDialog(b,c,a):window.showModelessDialog(b,c,a)}catch(j){}}function computeMdlDlgHeightAndWidth(){var a=Owa.Dom.Window.get_Current().get_TopWindow()._domWindow,b=Owa.Dom.Window.get_Current().get_TopWindow().get_Document()._oDomNode;CH_MDL_DLG_HGHT="innerHeight"in a?a.innerHeight:b.documentElement.offsetHeight;CH_MDL_DLG_WDTH="innerWidth"in a?a.innerWidth:b.documentElement.offsetWidth}function scaleX(a){return screen.deviceXDPI&&screen.logicalXDPI?a*(screen.deviceXDPI/screen.logicalXDPI):a}function scaleY(a){return screen.deviceYDPI&&screen.logicalYDPI?a*(screen.deviceYDPI/screen.logicalYDPI):a}function shwAB(g,h){var a={},e=$(TO),d=$(CC),b=$(BCC),c=$(FROM);if(e)a.sTo=e.get_InnerHtml();if(d)a.sCc=d.get_InnerHtml();if(b)a.sBcc=b.get_InnerHtml();if(c)a.sFrom=c.get_InnerHtml();a.sTgt=g;var f=function(){e&&setRwHtml(e,a.sTo);d&&setRwHtml(d,a.sCc);b&&0<a.sBcc.length&&shwBcc(1);b&&setRwHtml(b,a.sBcc);c&&setRwHtml(c,a.sFrom);revtRSpn()};shwABDlg(a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,a,"&a="+h,f)}var g_fDrty=0;function drty(){g_fDrty=1}function clrDrty(){g_fDrty=0}function isDrty(){return g_fDrty==1}Type.createNamespace("Owa.Components.Storage");!g_fModuleLoaded[".\\components/dragdrop.js".toLowerCase()]&&(function(){Owa.Components.Storage.DragDrop=function Owa$Components$Storage$DragDrop(a){Owa.Components.Storage.DragDrop.constructBase(this);this._oEvent=a};Owa.Components.Storage.DragDrop.Effect={All:"all",Copy:"copy",Link:"link",Move:"move",None:"none"};var a="__dragdropContext";function get_MimeType(){return Owa.Utility.isSafari()?"text/plain":Owa.Utility.isFirefox()?"owadragcontext":"text"}Owa.Components.Storage.DragDrop.prototype.get_Data=function Owa$Components$Storage$DragDrop$get_Data(){var b=get_MimeType();if(this._oEvent._oEvent.dataTransfer){var a=this._oEvent._oEvent.dataTransfer.getData(b);if(!a&&(Owa.Utility.isSafari()||Owa.Utility.isIE()&&Owa.Utility.isGreaterThanIE9UsingTrident())&&(this._oEvent.get_Type()=="dragenter"||this._oEvent.get_Type()=="dragover"))a=getDragDropData(b)}else a=getDragDropData(b);return a};function getDragDropData(c){var b=Owa.Utility.getRootOwaWindow().getGlobalVariable(a);if(b)return b[c];else{b=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable(a);if(b)return b[c]}}function setDragDropData(c,d){var b={};b[c]=d;Owa.Utility.getIFrameParentOwaWindow().setGlobalVariable(a,b);Owa.Utility.getRootOwaWindow().setGlobalVariable(a,b)}Owa.Components.Storage.DragDrop.prototype.clear=function Owa$Components$Storage$DragDrop$clear(){setDragDropData(get_MimeType(),null)};Owa.Components.Storage.DragDrop.prototype.set_Data=function Owa$Components$Storage$DragDrop$set_Data(d){var b=get_MimeType();if(this._oEvent._oEvent.dataTransfer){this._oEvent._oEvent.dataTransfer.effectAllowed=Owa.Components.Storage.DragDrop.Effect.All;this._oEvent._oEvent.dataTransfer.setData(b,d);(Owa.Utility.isSafari()||Owa.Utility.isIE()&&Owa.Utility.isGreaterThanIE9UsingTrident())&&setDragDropData(b,d);if(Owa.Utility.isFirefox()){var e=document.createElement("canvas");e.width=e.height=0;this._oEvent._oEvent.dataTransfer.setDragImage(e,0,0)}}else{var c={};c[b]=d;Owa.Utility.getIFrameParentOwaWindow().setGlobalVariable(a,c);Owa.Utility.getRootOwaWindow().setGlobalVariable(a,c)}};Owa.Components.Storage.DragDrop.prototype.setEffect=function Owa$Components$Storage$DragDrop$setEffect(b){if(this._oEvent._oEvent.dataTransfer)if(b==Owa.Components.Storage.DragDrop.Effect.None)this._oEvent._oEvent.dataTransfer.dropEffect=b;else{var a="";try{a=this._oEvent._oEvent.dataTransfer.effectAllowed}catch(e){}a=a.toLowerCase();if(a==""||a==Owa.Components.Storage.DragDrop.Effect.All||a.contains(b))this._oEvent._oEvent.dataTransfer.dropEffect=b;else this._oEvent._oEvent.dataTransfer.dropEffect=Owa.Components.Storage.DragDrop.Effect.All}var d=this._oEvent._oEvent;d._effect=b;if(Owa.Utility.isSafari()){var c=new Image;c.src=getRsrcF("clear1x1.gif");this._oEvent._oEvent.dataTransfer.setDragImage(c,1,1)}};Owa.Components.Storage.DragDrop.prototype.deny=function Owa$Components$Storage$DragDrop$deny(){this.setEffect(Owa.Components.Storage.DragDrop.Effect.None);this._oEvent.preventDefault();this._oEvent.cancelBubble()};var b=null;Owa.Components.Storage.DragDrop.isSimulateInFireFox=function Owa$Components$Storage$DragDrop$isSimulateInFireFox(){if(Boolean.isInstance(b))return b;b=Owa.Utility.isFirefox()&&Owa.Utility.get_FirefoxVersion()<3.5;return b};Owa.Components.Storage.DragDrop.createClass("Owa.Components.Storage.DragDrop",Owa.Components.Control,Owa.Components.Storage.IStorage)})();g_fModuleLoaded[".\\components/dragdrop.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/FireFoxDNDSimulator.js".toLowerCase()]&&(function(){if(Owa.Components.Storage.DragDrop.isSimulateInFireFox()){Owa.Components.Storage.DragDrop.__dragDropContext={};var a="oLastTarget",c="sLastEffect",d="fMouseButtonDown",b="fDragging",e="fDragStartFired";function getDragDropContext(){var a=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable("Owa");return a.Components.Storage.DragDrop.__dragDropContext}function getDragDropVariable(a){return getDragDropContext()[a]}function setDragDropVarible(b,a){getDragDropContext()[b]=a}function fireEvent(d,e,b){var b=b?b:d.get_Target();if(!b)return;var a=d._oEvent,c=document.createEvent("MouseEvent");c.initMouseEvent(e,1,1,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget);b._get_DomNode().dispatchEvent(c);return c}function fireDragEvent(e){var b=getDragDropVariable(a),d=e.get_Target(),g;if(b&&b.equals(d)||e.get_Type()=="keydown"){if(e.get_Type()=="keydown")d=b;var f=fireEvent(e,"dragover",d);if(f){var g=f._effect;g&&setDragDropVarible(c,g);setCursor(d)}}else{if(b){fireEvent(e,"dragleave",b);resetCursor(b)}var f=fireEvent(e,"dragenter");if(f){var g=f._effect;g&&setDragDropVarible(c,g);setCursor(d)}}setDragDropVarible(a,d)}function setCursor(a){if(!a)return;var d=getDragDropVariable(c),b="no-drop";if(!a._get_DomNode().__cursorSaved){a._get_DomNode().__oldCursor=a._get_DomNode().style.cursor;a._get_DomNode().__cursorSaved=true}if(d)switch(d){case Owa.Components.Storage.DragDrop.Effect.All:b="alias";break;case Owa.Components.Storage.DragDrop.Effect.Move:b="alias";break;case Owa.Components.Storage.DragDrop.Effect.Copy:b="copy";break;case Owa.Components.Storage.DragDrop.Effect.Link:b="default";break;default:b="no-drop"}a._get_DomNode().style.cursor=b}function resetCursor(a){if(!a)return;if(a._get_DomNode().__cursorSaved){a._get_DomNode().style.cursor=a._get_DomNode().__oldCursor;a._get_DomNode().__cursorSaved=null;a._get_DomNode().__oldCursor=null}}function dragNDropSimulator(b){var a=new Owa.Dom.Event(b,this);if(a.isLeftButtonDown()){setDragDropVarible(d,1);setDragDropVarible(e,0)}}function dragNDropOnMouseDown(b){var a=new Owa.Dom.Event(b,this);a.isRightButtonDown()&&stopDragNDrop(a,true)}function dragNDropOnMouseMove(f){if(getDragDropVariable(d)&&!getDragDropVariable(e)){var a=new Owa.Dom.Event(f,this);setDragDropVarible(e,1);setDragDropVarible(c,Owa.Components.Storage.DragDrop.Effect.None);fireEvent(a,"dragstart");var g=new Owa.Components.Storage.DragDrop(a);if(g.get_Data())setDragDropVarible(b,1);else return}if(getDragDropVariable(d)&&getDragDropVariable(b)){var a=new Owa.Dom.Event(f,this);fireDragEvent(a)}}function dragNDropOnMouseOver(c){if(getDragDropVariable(b)){var a=new Owa.Dom.Event(c,this);fireDragEvent(a)}}function dragNDropOnKeyDown(c){if(getDragDropVariable(b)){var a=new Owa.Dom.Event(c,this);27==a.get_KeyCodeForKeyUpDown()&&stopDragNDrop(a,true)}}function dragNDropOnMouseUp(f){var a=new Owa.Dom.Event(f,this);a.isLeftButtonDown()&&setDragDropVarible(d,0);if(getDragDropVariable(b))if(a.isLeftButtonDown()){var e=getDragDropVariable(c);e&&e!=Owa.Components.Storage.DragDrop.Effect.None&&fireEvent(a,"drop");stopDragNDrop(a,false)}}function dragNDropOnMouseOut(c){var b=new Owa.Dom.Event(c,this);if(getDragDropVariable(a)){fireEvent(b,"dragleave",getDragDropVariable(a));resetCursor(getDragDropVariable(a))}setDragDropVarible(a,null)}function stopDragNDrop(g,h){if(getDragDropVariable(b)){var f=getDragDropVariable(a),i=new Owa.Components.Storage.DragDrop(g);h&&f&&fireEvent(g,"dragleave",f);resetCursor(getDragDropVariable(a));setDragDropVarible(d,0);setDragDropVarible(b,0);setDragDropVarible(e,0);setDragDropVarible(a,null);setDragDropVarible(c,null);i.set_Data(null)}}function dragNDropOnDragStart(b){var a=new Owa.Dom.Event(b);a.cancelBubble();a.preventDefault()}document.addEventListener("mousedown",dragNDropOnMouseDown,true);document.addEventListener("mousemove",dragNDropOnMouseMove,true);document.addEventListener("mouseover",dragNDropOnMouseOver,true);document.addEventListener("keydown",dragNDropOnKeyDown,true);document.addEventListener("mouseup",dragNDropOnMouseUp,true);document.addEventListener("mouseout",dragNDropOnMouseOut,true)}Owa.Components.Storage.DragDrop.enableDNDInFireFox=function Owa$Components$DragDrop$Storage$enableDNDInFireFox(b){if(Owa.Components.Storage.DragDrop.isSimulateInFireFox()){var a=b._get_DomNode();a.addEventListener("mousedown",dragNDropSimulator,true);a.addEventListener("draggesture",dragNDropOnDragStart,true)}}})();g_fModuleLoaded[".\\components/FireFoxDNDSimulator.js".toLowerCase()]=1;var MAX_REQ_ITMS=500,IT_AD_PFX="AD.";function isValidDropFolder(a,c){if(a.get_TypeName()!==Owa.Components.DraggableObjects.Type.Items&&a.get_TypeName()!==Owa.Components.DraggableObjects.Type.Conversations)return false;var d=a.get_RootElement(),b=true;d.foreach_Item(function(a){if(!isMoveAllow(c,a.get_ItemType())){b=false;return true}});return b}function isMoveAllow(a,b){return!a||isOfClss(a,T_MSG)?!isOfClss(b,IT_AD):isOfClss(a,T_CAL)?isOfClss(b,IT_APP):isOfClss(a,T_CON)?isOfClss(b,IT_CNT)||isOfClss(b,IT_PDL):isOfClss(a,T_TSK)?isOfClss(b,IT_TSK):false}function checkLimit(a){var b=false;if(a.get_TypeName()===Owa.Components.DraggableObjects.Type.Items&&a.get_RootElement().getLength_Item()>MAX_REQ_ITMS)b=true;if(b){alrt(L_ErrMaxItms,0,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng);return true}return false}function canAttach(a){if(a.get_TypeName()!==Owa.Components.DraggableObjects.Type.Items&&a.get_TypeName()!==Owa.Components.DraggableObjects.Type.Conversations)return false;var b=true,c=a.get_RootElement();c.foreach_Item(function(a){if(a.get_ItemType().startsWith(IT_AD_PFX)){b=false;return true}});return b}Type.createNamespace("Owa.Components.Storage");!g_fModuleLoaded[".\\components/storableobject.js".toLowerCase()]&&(function(){Owa.Components.Storage.StorableObject=function Owa$Components$Storage$StorableObject(c,d,b,a){Owa.Components.Storage.StorableObject.constructBase(this);this._sTypeName=c;this._iVersion=d;this._sRootElementType=b;this._sRootElementName=a};Owa.Components.Storage.StorableObject.prototype.save=function Owa$Components$Storage$StorableObject$save(b){var a=this.saveToXml();b.set_Data(a.get_Xml())};Owa.Components.Storage.StorableObject.DocumentElementName="OwaStorableObject";Owa.Components.Storage.StorableObject.prototype.load=function Owa$Components$Storage$StorableObject$load(b){var c=b.get_Data(),a=new Owa.Dom.XmlDocument;a.loadXML(c);return this.loadFromXml(a)};Owa.Components.Storage.StorableObject.prototype.loadFromXml=function Owa$Components$Storage$StorableObject$loadFromXml(b){var c=b.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);this._rootElement=null;if(c.getAttribute("type")===this.get_TypeName()){var d=parseInt(c.getAttribute("version"),10);if(d!=this.get_Version())return false}else return false;var a=b.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName+"/"+this._sRootElementName);if(!a)return false;this.get_RootElement().load(a);return true};Owa.Components.Storage.StorableObject.prototype.saveToXml=function Owa$Components$Storage$StorableObject$saveToXml(){var a=new Owa.Dom.XmlDocument,b;a.loadXML("<"+Owa.Components.Storage.StorableObject.DocumentElementName+"><"+this._sRootElementName+"></"+this._sRootElementName+"></"+Owa.Components.Storage.StorableObject.DocumentElementName+">");this.get_RootElement().save(a.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName+"/"+this._sRootElementName));b=a.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);b.setAttribute("type",this.get_TypeName());b.setAttribute("version",this.get_Version().toString());return a};Owa.Components.Storage.StorableObject.prototype.get_RootElement=function Owa$Components$Storage$StorableObject$get_RootElement(){if(!this._rootElement)this._rootElement=this._createRootElement();return this._rootElement};Owa.Components.Storage.StorableObject.prototype.get_TypeName=function Owa$Components$Storage$StorableObject$get_TypeName(){return this._sTypeName};Owa.Components.Storage.StorableObject.prototype.get_Version=function Owa$Components$Storage$StorableObject$get_Version(){return this._iVersion};Owa.Components.Storage.StorableObject.prototype._createRootElement=function Owa$Components$Storage$StorableObject$_createRootElement(){var a=Type.getType(this._sRootElementType);return new a};Owa.Components.Storage.StorableObject._registeredType={};Owa.Components.Storage.StorableObject.register=function Owa$Components$Storage$StorableObject$register(b,f,e,d,c){var a=Owa.Components.Storage.StorableObject._registeredType[b];if(a)throw new Error("Type already registered");a={};a.sTypeName=b;a.iVersion=f;a.sRootElementType=e;a.sRootElementName=d;a.sObjectType=c?c:"Owa.Components.Storage.StorableObject";Owa.Components.Storage.StorableObject._registeredType[b]=a};Owa.Components.Storage.StorableObject.create=function Owa$Components$Storage$StorableObject$create(c){var a=Owa.Components.Storage.StorableObject._registeredType[c];if(a){var b=Type.getType(a.sObjectType);return new b(a.sTypeName,a.iVersion,a.sRootElementType,a.sRootElementName)}else throw new Error("Type isn't registered");};Owa.Components.Storage.StorableObject.createFromStorage=function Owa$Components$Storage$StorableObject$createFromStorage(h){var f=h.get_Data(),e,a,b,d,c;if(!f)return null;b=new Owa.Dom.XmlDocument;b.loadXML(f);d=b.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);if(!d)return null;e=d.getAttribute("type");a=Owa.Components.Storage.StorableObject._registeredType[e];if(!a)return null;var g=Type.getType(a.sObjectType);c=new g(a.sTypeName,a.iVersion,a.sRootElementType,a.sRootElementName);return c.loadFromXml(b)?c:null};Owa.Components.Storage.StorableObject.createClass("Owa.Components.Storage.StorableObject",Owa.Components.Control);Owa.Components.Storage.StorableElement=function Owa$Components$Storage$StorableElement(){Owa.Components.Storage.StorableElement.constructBase(this);this._propertyValues={};if(!this._simpleProperties){var b=[],c=[];for(var a in this)if(a.startsWith("_property.")){b.push(this[a]);delete this[a]}else if(a.startsWith("_array_property.")){c.push(this[a]);delete this[a]}this.constructor.prototype._simpleProperties=b;this.constructor.prototype._arrayProperties=c}};Owa.Components.Storage.StorableElement.PropertyType={String:"String",Number:"Number",Boolean:"Boolean"};Owa.Components.Storage.StorableElement.prototype.save=function Owa$Components$Storage$StorableElement$save(c){for(var b=0;b<this._simpleProperties.length;b++){var a=this._simpleProperties[b],d=this._propertyValues[a.sName];switch(a.sType){case Owa.Components.Storage.StorableElement.PropertyType.String:c.setAttribute(a.sName,d);break;case Owa.Components.Storage.StorableElement.PropertyType.Number:(d||d===0)&&c.setAttribute(a.sName,d.toString());break;case Owa.Components.Storage.StorableElement.PropertyType.Boolean:c.setAttribute(a.sName,d?"true":"false")}}for(var b=0;b<this._arrayProperties.length;b++){var a=this._arrayProperties[b],e=this._propertyValues[a.sName];if(e&&e.length>0)for(var h=c.get_OwnerDocument(),f=0;f<e.length;f++){var g=h.createElement(a.sName);c.appendChild(g);e[f].save(g)}}};Owa.Components.Storage.StorableElement.prototype.load=function Owa$Components$Storage$StorableElement$load(h){for(var b=0;b<this._simpleProperties.length;b++){var a=this._simpleProperties[b],e=h.getAttribute(a.sName);switch(a.sType){case Owa.Components.Storage.StorableElement.PropertyType.String:this._propertyValues[a.sName]=e;break;case Owa.Components.Storage.StorableElement.PropertyType.Number:this._propertyValues[a.sName]=parseInt(e,10);break;case Owa.Components.Storage.StorableElement.PropertyType.Boolean:this._propertyValues[a.sName]=e==="true"?true:false}}for(var b=0;b<this._arrayProperties.length;b++){var a=this._arrayProperties[b],c=h.selectNodes("./"+a.sName);if(c&&c.length>0){for(var g=[],d=0;d<c.length;d++){var i=Type.getType(a.sType),f=new i;f.load(c[d]);g.push(f)}this._propertyValues[a.sName]=g}}};Owa.Components.Storage.StorableElement.prototype._getProperty=function Owa$Components$Storage$StorableElement$_getProperty(a){return this._propertyValues[a]};Owa.Components.Storage.StorableElement.prototype._setProperty=function Owa$Components$Storage$StorableElement$_setProperty(b,a){this._propertyValues[b]=a};Owa.Components.Storage.StorableElement.defineProperty=function Owa$Components$Storage$StorableElement$defineProperty(c,a,e,d){var b={};b.sName=a;b.sType=e;c.prototype["_property."+a]=b;c.prototype["get_"+a]=function Owa$Components$Storage$StorabelElement$_getPropertyAnonymous(){return this._getProperty(a)};if(!d)c.prototype["set_"+a]=function Owa$Components$Storage$StorabelElement$_setPropertyAnonymous(b){this._setProperty(a,b)};delete c;delete e;delete d;delete b};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyDefinition=function Owa$Components$Storage$StorableElement$_getArrayPropertyDefinition(b){return this["_array_property."+b]};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyByIndex=function Owa$Components$Storage$StorableElement$_getArrayPropertyByIndex(c,b){var a=this._propertyValues[c];return a?a[b]:null};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyAll=function Owa$Components$Storage$StorableElement$_getArrayPropertyAll(b){var a=this._propertyValues[b];return a?a:[]};Owa.Components.Storage.StorableElement.prototype._clearArrayProperty=function Owa$Components$Storage$StorableElement$_clearArrayProperty(a){this._propertyValues[a]=null};Owa.Components.Storage.StorableElement.prototype._appendArrayProperty=function Owa$Components$Storage$StorableElement$_appendArrayProperty(c,b){var a=this._propertyValues[c];if(a)a.push(b);else this._propertyValues[c]=[b]};Owa.Components.Storage.StorableElement.prototype._createOneOfArrayProperty=function Owa$Components$Storage$StorableElement$_createOneOfArrayProperty(c){var a=this._getArrayPropertyDefinition(c);if(!a)return null;else{var b=Type.getType(a.sType);return new b}};Owa.Components.Storage.StorableElement.prototype._getLengthOfArrayProperty=function Owa$Components$Storage$StorableElement$_getLengthOfArrayProperty(b){var a=this._propertyValues[b];return a?a.length:0};Owa.Components.Storage.StorableElement.prototype._removeArrayPropertyByIndex=function Owa$Components$Storage$StorableElement$_removeArrayPropertyByIndex(c,b){var a=this._propertyValues[c];a&&a.removeAt(b)};Owa.Components.Storage.StorableElement.prototype._foreachArrayProperty=function Owa$Components$Storage$StorableElement$_foreachArrayProperty(d,c){for(var a=this._propertyValues[d],b=0;a&&b<a.length;b++)if(c(a[b]))break};Owa.Components.Storage.StorableElement.defineArrayProperty=function Owa$Components$Storage$StorableElement$defineArrayProperty(b,a,d){var c={};c.sName=a;c.sType=d;b.prototype["_array_property."+a]=c;b.prototype["get_"+a]=function Owa$Components$Storage$StorableElement$_getArrayPropertyByIndexAnonymous(b,a){return this._getArrayPropertyByIndex(a)};b.prototype["getAll_"+a]=function Owa$Components$Storage$StorableElement$_getArrayPropertyAllAnonymous(){return this._getArrayPropertyAll(a)};b.prototype["clear_"+a]=function Owa$Components$Storage$StorableElement$_clearArrayPropertyAnonymous(){return this._clearArrayProperty(a)};b.prototype["append_"+a]=function Owa$Components$Storage$StorableElement$_appendArrayPropertyAnonymous(b){return this._appendArrayProperty(a,b)};b.prototype["createOne_"+a]=function Owa$Components$Storage$StorableElement$_createOneOfArrayPropertyAnonymous(){return this._createOneOfArrayProperty(a)};b.prototype["getLength_"+a]=function Owa$Components$Storage$StorableElement$_getLengthOfArrayPropertyAnonymous(){return this._getLengthOfArrayProperty(a)};b.prototype["remove_"+a]=function Owa$Components$Storage$StorableElement$_removeArrayPropertyByIndexAnonymous(b){return this._removeArrayPropertyByIndex(a,b)};b.prototype["foreach_"+a]=function Owa$Components$Storage$StorableElement$_foreachArrayPropertyAnonymous(b){return this._foreachArrayProperty(a,b)};delete b;delete d;delete c};Owa.Components.Storage.StorableElement.createClass("Owa.Components.Storage.StorableElement",Owa.Components.Control)})();g_fModuleLoaded[".\\components/storableobject.js".toLowerCase()]=1;Type.createNamespace("Owa.Components.DraggableObjects");!g_fModuleLoaded[".\\components/draggableobjects.js".toLowerCase()]&&(function(){Owa.Components.DraggableObject=function Owa$Components$DraggableObject(){Owa.Components.DraggableObject.constructBase(this,arguments)};Owa.Components.DraggableObject.prototype.set_DenyCopy=function Owa$Components$DraggableObject$set_DenyCopy(a){this._denyCopy=a};Owa.Components.DraggableObject.prototype.get_DenyCopy=function Owa$Components$DraggableObject$get_DenyCopy(){return this._denyCopy};Owa.Components.DraggableObject.prototype.set_DenyMove=function Owa$Components$DraggableObject$set_DenyMove(a){this._denyMove=a};Owa.Components.DraggableObject.prototype.get_DenyMove=function Owa$Components$DraggableObject$get_DenyMove(){return this._denyMove};Owa.Components.DraggableObject.prototype.set_LegacyDN=function Owa$Components$DraggableObject$set_LegacyDN(a){this._legacyDN=a};Owa.Components.DraggableObject.prototype.get_LegacyDN=function Owa$Components$DraggableObject$get_LegacyDN(){return this._legacyDN};Owa.Components.DraggableObject.prototype.loadFromXml=function Owa$Components$DraggableObject$loadFromXml(b){var c=Owa.Components.DraggableObject.callBase(this,"loadFromXml",[b]);if(!c)return false;var a=b.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);if(a){this.set_DenyCopy(a.getAttribute("denyCopy")==="true");this.set_DenyMove(a.getAttribute("denyMove")==="true");this.set_LegacyDN(a.getAttribute("legacyDN"))}return true};Owa.Components.DraggableObject.prototype.saveToXml=function Owa$Components$DraggableObject$saveToXml(){var b=Owa.Components.DraggableObject.callBase(this,"saveToXml"),a=b.selectSingleNode("/OwaStorableObject");if(a){a.setAttribute("denyCopy",this.get_DenyCopy()?"true":"false");a.setAttribute("denyMove",this.get_DenyMove()?"true":"false");a.setAttribute("legacyDN",this.get_LegacyDN()?this.get_LegacyDN():null)}return b};Owa.Components.DraggableObject.register=function Owa$Components$DraggableObject$register(c,d,b,a){Owa.Components.Storage.StorableObject.register(c,d,b,a,"Owa.Components.DraggableObject")};Owa.Components.DraggableObject.createClass("Owa.Components.DraggableObject",Owa.Components.Storage.StorableObject);Owa.Components.DraggableObjects.Type={Folder:"Folder",Items:"Items",Conversations:"Conversations",NavigationHeader:"NavigationHeader",NavigationNode:"NavigationNode",Buddy:"Buddy"};Owa.Components.DraggableObjects.FolderElement=function Owa$Components$DraggableObjects$FolderElement(){Owa.Components.DraggableObjects.FolderElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsInDeletedItems",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsInJunkItems",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderType",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderContainerClass",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsOutlookSearchFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsRemote",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.DraggableObjects.FolderElement.createClass("Owa.Components.DraggableObjects.FolderElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Folder,1,"Owa.Components.DraggableObjects.FolderElement","Folder");Owa.Components.DraggableObjects.NavigationNodeElement=function Owa$Components$DraggableObjects$NavigationNodeElement(){Owa.Components.DraggableObjects.NavigationNodeElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"NavigationNodeId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"GroupSection",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.NavigationNodeElement.createClass("Owa.Components.DraggableObjects.NavigationNodeElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.NavigationNode,1,"Owa.Components.DraggableObjects.NavigationNodeElement","NavigationNode");Owa.Components.DraggableObjects.NavigationHeaderElement=function Owa$Components$DraggableObjects$NavigationHeaderElement(){Owa.Components.DraggableObjects.NavigationHeaderElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationHeaderElement,"NavigationNodeId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationHeaderElement,"GroupSection",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.NavigationHeaderElement.createClass("Owa.Components.DraggableObjects.NavigationHeaderElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.NavigationHeader,1,"Owa.Components.DraggableObjects.NavigationHeaderElement","NavigationHeader");Owa.Components.DraggableObjects.ItemElement=function Owa$Components$DraggableObjects$ItemElement(){Owa.Components.DraggableObjects.ItemElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"ItemId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"UrlEncItemId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"ItemType",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.ItemElement.createClass("Owa.Components.DraggableObjects.ItemElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObjects.ConversationElement=function Owa$Components$DraggableObjects$ConversationElement(){Owa.Components.DraggableObjects.ConversationElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationElement,"Topic",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationElement,"TimeStamp",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.ConversationElement.createClass("Owa.Components.DraggableObjects.ConversationElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObjects.ItemsElement=function Owa$Components$DraggableObjects$ItemsElement(){Owa.Components.DraggableObjects.ItemsElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemsElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemsElement,"IsCrossFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ItemsElement,"Item",Owa.Components.DraggableObjects.ItemElement);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ItemsElement,"Conversation",Owa.Components.DraggableObjects.ConversationElement);Owa.Components.DraggableObjects.ItemsElement.createClass("Owa.Components.DraggableObjects.ItemsElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Items,1,"Owa.Components.DraggableObjects.ItemsElement","Items");Owa.Components.DraggableObjects.ConversationsElement=function Owa$Components$DraggableObjects$ConversationsElement(){Owa.Components.DraggableObjects.ConversationsElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationsElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationsElement,"IsCrossFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ConversationsElement,"Item",Owa.Components.DraggableObjects.ItemElement);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ConversationsElement,"Conversation",Owa.Components.DraggableObjects.ConversationElement);Owa.Components.DraggableObjects.ConversationsElement.createClass("Owa.Components.DraggableObjects.ConversationsElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Conversations,1,"Owa.Components.DraggableObjects.ConversationsElement","Conversations");Owa.Components.DraggableObjects.BuddyElement=function Owa$Components$DraggableObjects$BuddyElement(){Owa.Components.DraggableObjects.BuddyElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.BuddyElement,"GroupId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.BuddyElement,"BuddyId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.BuddyElement.createClass("Owa.Components.DraggableObjects.BuddyElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Buddy,1,"Owa.Components.DraggableObjects.BuddyElement","Buddy")})();g_fModuleLoaded[".\\components/draggableobjects.js".toLowerCase()]=1;!g_fModuleLoaded[".\\core/browsererrorhandler.js".toLowerCase()]&&(function(){var d=-(~2147500034+1),e=-(~2147500037+1),f=-(~2147942408+1),c=-(~2147942405+1),g=-(~2147942414+1),b="df5284f9d6134a689c4e494b74df12bd",a="143abf4577894d22ae34a054a6dce7fe";Type.createNamespace("Owa.BrowserErrorHandler");Owa.BrowserErrorHandler.isAccessDeny=function Owa$BrowserErrorHandler$isAccessDeny(a){return a==b};Owa.BrowserErrorHandler.isNoMemoryError=function Owa$BrowserErrorHandler$isNoMemoryError(b){return b==a};Owa.BrowserErrorHandler.handleFrameAccessError=function Owa$BrowserErrorHandler$handleFrameAccessError(a){if(a.number==c)throw new Error(b);else throw a;};Owa.BrowserErrorHandler.handleNewWindowError=function Owa$BrowserErrorHandler$handleNewWindowError(b){switch(b.number){case d:case e:case g:case f:throw new Error(a);default:throw b;}}})();g_fModuleLoaded[".\\core/browsererrorhandler.js".toLowerCase()]=1;function getEvt(a){try{if(!a)return null;if(a.event)return a.event;if(a.ownerDocument)a=a.ownerDocument;var b=Owa.Dom.Node.wrapDomNode(a);return b.get_ContainerWindow()._domWindow.event}catch(c){Owa.BrowserErrorHandler.handleFrameAccessError(c)}}function attchEvt(a,c,d){var b="__"+c;if(a[b]){if(schRg(d,a[b])>-1)return}else{a[b]=[];if(a["on"+c])a[b][0]=a["on"+c];a["on"+c]=dspchEvt}a[b][a[b].length]=d}function dtchEvt(a,c,e){var b="__"+c;if(a[b]){var d=schRg(e,a[b]);d>-1&&a[b].splice(d,1);if(a[b].length==0){a["on"+c]=null;a[b]=null}}}function dspchEvt(a){if(Owa.Dom.Event.isInstance(a))a=a._oEvent;a=a||getEvt(this);for(var c="__"+a.type,d=true,b=0;b<this[c].length;b++)if(this[c][b]){this.__fn=this[c][b];d=this.__fn(a)&&d}if(this.__fn)try{delete this.__fn}catch(a){this.__fn=null}return d}function schRg(c,b){var a=b.length;while(a--)if(b[a]&&b[a]===c)break;return a}function isLBDwn(a){return!isDf(typeof a.which)?(a.button&1)!=0:a.which==1}function isRBDwn(a){return!isDf(typeof a.which)?(a.button&2)!=0:a.which==3}function isAltKD(a){return a.altKey}function isCtrlKD(a){return Owa.Utility.isMac()?a.metaKey:a.ctrlKey}function isShftKD(a){return a.shiftKey}function prvntDft(a){a.preventDefault?a.preventDefault():(a.returnValue=false)}function cnclBbl(a){a.cancelBubble=true}function getEvtCX(a){return a.clientX}function getEvtCY(a){return a.clientY}function getEvtTgt(b){var a=b.srcElement||b.target;if(a&&isDf(typeof a.nodeType)&&a.nodeType!=1)a=a.parentNode;return a}function getKeyCode(a){return a.keyCode}function getCharCode(a){return a.charCode||a.keyCode}function getEvtType(a){return a.type}function edDoc(b){var a=$("ifBdy");return!a?null:b?a.get_ContentDocument():a.get_ContentDocument()._get_DomNode()}function edEvt(){return getEvt(edDoc())}function shwErrDlg(c,n,o,j,f,e,g,l,k){var i=Owa.PageHierarchy.getOwaTopWindow(),d={};if(!i.equals(Owa.Dom.Window.get_Current()))return i.invokeFunction("shwErrDlg",arguments);if(c){n=c.sErr;g=c.sErrorDetails;f=c.sErrDbg;if(!e&&c.oES)e=c.oES}var b="divErrDlg"+rndm(),a='<div style="padding:0 5">'+htmlEnc(n)+"</div>";if(g)a+='<div style="padding:10 5">'+htmlEnc(g)+"</div>";if(j)a+='<div style="padding:10 5">'+htmlEnc(j)+"</div>";if(f){a+='<div style="padding:10 5">';var p="<span class=lnk id=spnShw onclick=\"hideEm(getOneDescendant(wda('"+b+"'),'spnShw'));showEm(getOneDescendant(wda('"+b+"'), 'spnHd'));showEm(getOneDescendant(wda('"+b+"'),'divEDtls'));\">&nbsp;"+htmlEnc(L_ShwRpt)+Owa.Components.CssSprites.getImageMarkup("expnd.gif")+"</span><span class=lnk id=spnHd onclick=\"showEm(getOneDescendant(wda('"+b+"'),'spnShw'));hideEm(getOneDescendant(wda('"+b+"'), 'spnHd'));hideEm(getOneDescendant(wda('"+b+"'), 'divEDtls'));\" style=display:none>&nbsp;"+htmlEnc(L_HdRpt)+Owa.Components.CssSprites.getImageMarkup("cllps.gif")+"</span>";a+=htmlEnc(L_RptDtlsMsg).format(p);if(e)a+='<br><br><a href="http://watson.microsoft.com/dw/dcp.asp?LCID='+a_LCID+'" target=_blank>'+htmlEnc(L_VwPrvcy)+"</a>";a+="</div>"}if(f){a+="<div id=divEDtls style=display:none>";if(Owa.Utility.isIE())a+='<span class="lnk cpy" onclick="setData(getOneDescendant(wda(\''+b+"'), 'divErrBdy').innerText)\">"+Owa.Components.CssSprites.getImageMarkup("copy.gif")+htmlEnc(L_CpyDtls)+"</span>";a+="<div id=divErrBdy>"+f+"</div>";a+="</div>"}var h=[];if(e){h.push(L_SndRpt);d.oES=e}if(l)d.fnCb=l;if(k)d.oCbCtx=k;if(c)d.oCbRsp=c;d.oES=e;h.push(L_Cls);var m=new BtnDlg(b,a,o?o:L_ErrTtl,h,430,Owa.BUTTON_DIALOG_ICON.ERROR,onClsErrDlg,0,0,0,0,0,d);wtda(b).className+=" errDlg";m.show();return m}function onClsErrDlg(b,a){if(a.oES&&b==0)sndER(a.oES);else a.fnCb&&a.fnCb(a.oCbRsp,a.oCbCtx);return false}function sndER(b){try{var a=new oeReq("Error","ClientError",null,cbSndER);a.add("ln",b.sLn);a.add("msg",b.sMsg);a.add("cs",b.sCS);a.add("fn",b.sFn);a.add("b",b.sBdy);a.send()}catch(c){}}function cbSndER(a){a.sErr&&shwErrDlg(a)}function extractOEHErrorInfo(b,e){if(!b)return null;var a={};a.sFn=e;a.sLn=0;var c=b.getDescendantById("exceptionType");if(c)a.sMsg=c.get_TextContent();else return null;var d=b.getDescendantById("exceptionCallStack");if(d)a.sCS=d.get_TextContent();a.sBdy=b.get_OuterHtml();return a}!g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()]&&(function(){Owa.Dom.NodeEnumerator=function Owa$Dom$NodeEnumerator(b,a){Owa.Dom.NodeEnumerator.constructBase(this);this._oDomList=b;this._currentIndex=-1;this._fnIsIgnorable=a};Owa.Dom.NodeEnumerator.prototype.moveNext=function Owa$Dom$NodeEnumerator$moveNext(){for(this._currentIndex++;this._currentIndex<this._oDomList.length;this._currentIndex++)if(!this._fnIsIgnorable||!this._fnIsIgnorable(this._oDomList[this._currentIndex]))return true};Owa.Dom.NodeEnumerator.prototype.get_Current=function Owa$Dom$NodeEnumerator$get_Current(){if(this._currentIndex<0||this._currentIndex>=this._oDomList.length)throw"invalid operation, current position in enumerator is invalid";return Owa.Dom.Node.wrapDomNode(this._oDomList[this._currentIndex])};Owa.Dom.NodeEnumerator.prototype.reset=function Owa$Dom$NodeEnumerator$reset(){this._currentIndex=-1};Owa.Dom.NodeEnumerator.createClass("Owa.Dom.NodeEnumerator",Owa.Collections.IEnumerator)})();g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b=function _AttachedEventHandler$(c,a,b){this._oElement=c;this._sEventName=a;this._oDelegate=b};b.prototype.equals=function _AttachedEventHandler$equals(a){return!!a&&this._oElement===a._oElement&&this._sEventName===a._sEventName&&(this._oDelegate===a._oDelegate||this._oDelegate.equals&&this._oDelegate.equals(a._oDelegate))};Owa.UIControls.UIControlBase=function Owa$UIControls$UIControlBase(a,b){a&&this._initializeDomElement(a,b);this._oAttachedEventHandler=new Owa.Collection.Set;Owa.UIControls.UIControlBase.constructBase(this)};var a=Owa.UIControls.UIControlBase.prototype;a._fRemoveElementInDisposing=false;a._fDetachEventHandlersInDisposing=true;a._fSupportUniqueId=true;a._fClearTimeoutCallbackInDisposing=true;a._fIsFirstShow=true;a._fPendingResize=false;a.set_RemoveElementInDisposing=function Owa$UIControls$UIControlBase$set_RemoveElementInDisposing(a){this._fRemoveElementInDisposing=a};a.initialize=function Owa$UIControls$UIControlBase$initialize(){Owa.UIControls.UIControlBase.callBase(this,"initialize")};a.dispose=function Owa$UIControls$UIControlBase$dispose(){this._fDetachEventHandlersInDisposing&&this._detachAllEventHanders();this._oElement&&this._oElement.dispose();if(this.get_IsDomElementLoaded()){this._get_Element().dispose();this._fRemoveElementInDisposing&&this._get_Element().remove(true)}this.get_SizeChanged().clear();this.get_IsVisibleChanged().clear();this.get_FirstShow().clear();this._oElement=null;this._oParent=null;Owa.UIControls.UIControlBase.callBase(this,"dispose")};a._detachAllEventHanders=function Owa$UIControls$UIControlBase$_detachAllEventHanders(){for(var c=this._oAttachedEventHandler.toArray(),b=0;b<c.length;b++){var a=c[b],f=a._oElement,d=a._sEventName,e=a._oDelegate;f.detachEvent(d,e)}this._oAttachedEventHandler.clear()};a.get_Id=function Owa$UIControls$UIControlBase$get_Id(){return this._sId};a.get_IsShown=function Owa$UIControls$UIControlBase$get_IsShown(){return!this.get_IsDomElementLoaded()?false:this._get_Element().get_IsShown()};a.get_IsDomElementLoaded=function Owa$UIControls$UIControlBase$get_IsDomElementLoaded(){return this._get_Element()!=null};a._initializeDomElement=function Owa$UIControls$UIControlBase$_initializeDomElement(a,b){this._oElement=a;this._oParent=b;if(a.get_Id())this._sId=a.get_Id()};a._get_Parent=function Owa$UIControls$UIControlBase$_get_Parent(){return this._oParent};a._get_Element=function Owa$UIControls$UIControlBase$_get_Element(){return this._oElement};a._getDescendant=function Owa$UIControls$UIControlBase$_getDescendant(a){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getDescendantById(a)};a._getAttribute=function Owa$UIControls$UIControlBase$_getAttribute(a){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getAttribute(a)};a._getIntAttribute=function Owa$UIControls$UIControlBase$_getIntAttribute(a){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getIntAttribute(a)};a._setIntAttribute=function Owa$UIControls$UIControlBase$_setIntAttribute(b,a){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";this._get_Element().setIntAttribute(b,a)};a._attachEvent=function Owa$UIControls$UIControlBase$_attachEvent(d,c,a,f){var e=Owa.Utility.createArgumentContextDelegate(this,a,f);d.attachEvent(c,e);this._oAttachedEventHandler.add(new b(d,c,e));return a};a._detachEvent=function Owa$UIControls$UIControlBase$_detachEvent(c,a,e){var d=Owa.Utility.createArgumentContextDelegate(this,e);c.detachEvent(a,d);this._oAttachedEventHandler.remove(new b(c,a,d))};a._cancelBubbleEvent=function Owa$UIControls$UIControlBase$_cancelBubbleEvent(b,a){this._attachEvent(b,a,cancelBubbleEvent)};a._cancelEvent=function Owa$UIControls$UIControlBase$_cancelEvent(b,a){this._attachEvent(b,a,cancelEvent)};a.fireFirstShow=function Owa$UIControls$UIControlBase$fireFirstShow(){if(this._fIsFirstShow){this.onFirstShow();this._dispatchEvent(e);this._fIsFirstShow=false}};a.fireIsVisibleChanged=function Owa$UIControls$UIControlBase$fireIsVisibleChanged(a){a&&this._fPendingResize&&this.fireSizeChanged();a&&this._fIsFirstShow&&this.fireFirstShow();this.onIsVisibleChanged(a);this._dispatchEvent(c,{fIsVisible:a})};a.fireSizeChanged=function Owa$UIControls$UIControlBase$fireSizeChanged(a){if(this._get_Element().get_IsDisplayed()){this._fPendingResize=false;this.onResize(a);this._dispatchEvent(d)}else this._fPendingResize=true};a.onFirstShow=function Owa$UIControls$UIControlBase$onFirstShow(){};a.onIsVisibleChanged=function Owa$UIControls$UIControlBase$onIsVisibleChanged(){};a.onResize=function Owa$UIControls$UIControlBase$onResize(){};var e="FirstShow",c="IsVisibleChanged",d="SizeChanged";a.get_FirstShow=function Owa$UIControls$UIControlBase$get_FirstShow(){return this._getEventHandlerCollection(e)};a.get_IsVisibleChanged=function Owa$UIControls$UIControlBase$get_IsVisibleChanged(){return this._getEventHandlerCollection(c)};a.get_SizeChanged=function Owa$UIControls$UIControlBase$get_SizeChanged(){return this._getEventHandlerCollection(d)};function cancelEvent(a){a.preventDefault();a.cancelBubble()}function cancelBubbleEvent(a){a.cancelBubble()}Owa.UIControls.UIControlBase.createClass("Owa.UIControls.UIControlBase",Owa.Components.Control)})();g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.UIControl=function Owa$UIControls$UIControl(a,b){Owa.UIControls.UIControl.constructBase(this,[a,b]);if(this._oSubPage)this._oSubPage.addResource(this);else!!Owa.Components.Application&&Owa.Components.Application.get_GlobalResourceManager().addResource(this)};var a=Owa.UIControls.UIControl.prototype;Owa.UIControls.UIControl.prototype.set_SubPage=function Owa$UIControls$UIControl$set_SubPage(a){this._oSubPage=a;this._oSubPage&&this.getResourceManager()==Owa.Components.Application.get_GlobalResourceManager()&&this._oSubPage.addResource(this)};Owa.UIControls.UIControl.prototype.get_SubPage=function Owa$UIControls$UIControl$get_SubPage(){if(!this._oSubPage){var a=Owa.UIControls.SubPage&&Owa.UIControls.SubPage.get_Instance();this._oSubPage=a}return this._oSubPage};Owa.UIControls.UIControl.prototype.dispose=function Owa$UIControls$UIControl$dispose(){this._oSubPage=null;Owa.UIControls.UIControl.callBase(this,"dispose")};a.setSubPageVariable=function Owa$UIControls$UIControl$setSubPageVariable(b,a){return this.get_SubPage().setSubPageVariable(b,a)};a.getSubPageVariable=function Owa$UIControls$UIControl$getSubPageVariable(a){return this.get_SubPage().getSubPageVariable(a)};Owa.UIControls.UIControl.createClass("Owa.UIControls.UIControl",Owa.UIControls.UIControlBase)})();g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/clientaction.js".toLowerCase()]&&(function(){Owa.Components.ClientAction=function Owa$Components$ClientAction(d,c,b){this._sActionName=d;this._fEnabled=true;this._oActionEventHandlers=new Owa.Utility.EventHandlerCollection;this._oStateChangeEventHandlers=new Owa.Utility.EventHandlerCollection;if(c)for(var a=0;a<c.length;a++)this._oActionEventHandlers.add(c[a]);if(b)for(var a=0;a<b.length;a++)this._oStateChangeEventHandlers.add(b[a])};Owa.Components.ClientAction.prototype.get_Name=function Owa$Components$ClientAction$get_Name(){return this._sActionName};Owa.Components.ClientAction.prototype.get_ActionEventHandlers=function Owa$Components$ClientAction$get_ActionEventHandlers(){return this._oActionEventHandlers};Owa.Components.ClientAction.prototype.get_StateChangeEventHandlers=function Owa$Components$ClientAction$get_StateChangeEventHandlers(){return this._oStateChangeEventHandlers};Owa.Components.ClientAction.prototype.set_Enabled=function Owa$Components$ClientAction$prototype$set_Enabled(a){a?this.enable():this.disable()};Owa.Components.ClientAction.prototype.get_Enabled=function Owa$Components$ClientAction$prototype$get_Enabled(){return this._fEnabled};Owa.Components.ClientAction.prototype.disable=function Owa$Components$ClientAction$prototype$disable(){this._fEnabled=false;this._oStateChangeEventHandlers.dispatch({fEnabled:false})};Owa.Components.ClientAction.prototype.enable=function Owa$Components$ClientAction$prototype$enable(){this._fEnabled=true;this._oStateChangeEventHandlers.dispatch({fEnabled:true})};Owa.Components.ClientAction.prototype.triggerAction=function Owa$Components$ClientAction$prototype$triggerAction(b,c,a){if(this._fEnabled)return this._oActionEventHandlers.dispatch(b,{sActionName:this._sActionName,oEvent:c,fIsHotkey:a})}})();g_fModuleLoaded[".\\components/clientaction.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/clientactiontable.js".toLowerCase()]&&(function(){Owa.Components.ClientActionTable=function Owa$Components$ClientActionTable(a){this._fnDefaultHandler=a;this._oActionTables={}};Owa.Components.ClientActionTable.prototype.getAction=function Owa$Components$ClientActionTable$getAction(a){if(!this._oActionTables[a]){var b=this._fnDefaultHandler;this._oActionTables[a]=new Owa.Components.ClientAction(a);this._oActionTables[a].get_ActionEventHandlers().add(function(c){return b(a,c)})}return this._oActionTables[a]};Owa.Components.ClientActionTable.prototype.addAction=function Owa$Components$ClientActionTable$addAction(a){if(this._oActionTables[a.get_Name()])throw new Error("action already registered");else this._oActionTables[a.get_Name()]=a};Owa.Components.ClientActionTable.prototype.addAsAction=function Owa$Components$ClientActionTable$addAsAction(c,b,a){this.addAction(new Owa.Components.ClientAction(c,b,a));return this}})();g_fModuleLoaded[".\\components/clientactiontable.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/button.js".toLowerCase()]&&(function(){var a=[[Owa.Strings.CssClass.ButtonDefault,Owa.Strings.CssClass.ButtonDisabled,Owa.Strings.CssClass.ButtonDown,Owa.Strings.CssClass.ButtonDown],[Owa.Strings.CssClass.ToolbarButtonHoverable,Owa.Strings.CssClass.ToolbarButtonDisabled,Owa.Strings.CssClass.ToolbarButtonDown,Owa.Strings.CssClass.ToolbarButtonDown,Owa.Strings.CssClass.ToolbarButtonShareHoverable],[Owa.Strings.CssClass.MenuButtonDefault,Owa.Strings.CssClass.MenuButtonDisabled,Owa.Strings.CssClass.MenuButtonDown,Owa.Strings.CssClass.MenuButtonDown],[Owa.Strings.CssClass.NotificationButtonDefault,"",Owa.Strings.CssClass.NotificationButtonDown,Owa.Strings.CssClass.NotificationButtonPushed],[Owa.Strings.CssClass.OptionsSaveButtonHoverable,Owa.Strings.CssClass.OptionsSaveButtonDisabled,Owa.Strings.CssClass.OptionsSaveButtonDown,Owa.Strings.CssClass.OptionsSaveButtonDown]],b={Default:0,Raised:0,Disable:1,Pressed:2,Pushed:3},c={Button:0,ToolbarButton:1,MenuItemButton:2,NotificationButton:3,OptionsSaveButton:4},d="imgToolbarButtonIcon";Owa.UIControls.Button=function Owa$UIControls$Button(a,b){Owa.UIControls.Button.constructBase(this,[a,b]);this._clientAction=null;if(this._getIntAttribute(Owa.Strings.Attributes.IsToolbarButton)==1)this._styleGroup=c.ToolbarButton;else if(this._getIntAttribute(Owa.Strings.Attributes.IsMenuItem)==1)this._styleGroup=c.MenuItemButton;else if(this._getIntAttribute(Owa.Strings.Attributes.IsNotificationButton)==1)this._styleGroup=c.NotificationButton;else if(this._getIntAttribute(Owa.Strings.Attributes.IsOptionsSaveButton)==1)this._styleGroup=c.OptionsSaveButton;else this._styleGroup=c.Button};Owa.UIControls.Button.create=function Owa$UIControls$Button$create(d,a,c){var b;if(a.getAttribute(Owa.Strings.Attributes.SubMenuId))b=new Owa.UIControls.MenuButton(a,c);else if(a.getAttribute(Owa.Strings.Attributes.ToggleSiblingIds))b=new Owa.UIControls.ToggleButton(a,c);else if(a.getAttribute(Owa.Strings.Attributes.IsSticky))b=new Owa.UIControls.StickyButton(a,c);else if(a.getAttribute(Owa.Strings.Attributes.SwapSiblingIds))b=new Owa.UIControls.SwapButton(a,c);else if(a.getAttribute(Owa.Strings.Attributes.ComboMenuId))b=new Owa.UIControls.ComboButton(a,c);else b=new Owa.UIControls.Button(a,c);b.set_SubPage(d);return b};Owa.UIControls.Button.prototype.initialize=function Owa$UIControls$Button$initialize(d){if(d.getAction(this._get_ClientActionId())){this._clientAction=d.getAction(this._get_ClientActionId());this._clientAction.get_StateChangeEventHandlers().add(Owa.Utility.createDelegate(this,this._onClientActionStateChanged))}this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown);this._attachEvent(this._get_Element(),"keypress",this._onKeyPress);var c=this._get_ButtonElement();this._attachEvent(c,"click",this._onClick);this._attachEvent(c,"mousedown",this._onMouseDown);this._attachEvent(c,"mouseup",this._onMouseUp);this._attachEvent(this._get_Element(),"mouseout",this._onMouseUp);(this._get_ButtonElement().hasCssClass(a[this._styleGroup][b.Disable])||this._get_Element().hasCssClass(a[this._styleGroup][b.Disable]))&&this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,1)};Owa.UIControls.Button.prototype.dispose=function Owa$UIControls$Button$dispose(){var a=this._get_ButtonElement();a&&a.dispose();Owa.UIControls.Button.callBase(this,"dispose")};Owa.UIControls.Button.prototype.click=function Owa$UIControls$Button$click(){!this.get_IsDisabled()&&this._get_Element().click()};Owa.UIControls.Button.prototype.getToolbarIcon=function Owa$UIControls$Button$getToolbarIcon(){if(c.ToolbarButton==this._styleGroup){var a=this._get_ButtonElement();if(a)return a.getDescendantById(d)}return 0};Owa.UIControls.Button.prototype._get_ClientActionId=function Owa$UIControls$Button$_get_ClientActionId(){return this.get_Id()};Owa.UIControls.Button.prototype.get_IsDisabled=function Owa$UIControls$Button$get_IsDisabled(){return this._getIntAttribute(Owa.Strings.Attributes.IsDisabled)==1};Owa.UIControls.Button.prototype.set_IsDisabled=function Owa$UIControls$Button$set_IsDisabled(e){if(e){addAndRemoveClasses(this._get_ButtonElement(),a[this._styleGroup][b.Disable],a[this._styleGroup]);this.get_IsPushed()&&this._get_ButtonElement().addCssClass(a[this._styleGroup][b.Pushed])}else{var d=a[this._styleGroup][this.get_IsPushed()?b.Pushed:b.Raised];if(g_fRtl&&c.ToolbarButton==this._styleGroup&&!this.get_IsPushed()&&(Owa.Strings.Ids.AddThisCalendar==this._sId||Owa.Strings.Ids.ShareMyCalendar==this._sId||Owa.Strings.Ids.ViewThisCalendar==this._sId))d=Owa.Strings.CssClass.ToolbarButtonShareHoverable;addAndRemoveClasses(this._get_ButtonElement(),d,a[this._styleGroup])}this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,e?1:0)};Owa.UIControls.Button.prototype.get_IsPushed=function Owa$UIControls$Button$get_IsPushed(){return this._getIntAttribute(Owa.Strings.Attributes.ButtonPushed)==1};Owa.UIControls.Button.prototype.set_IsPushed=function Owa$UIControls$Button$set_IsPushed(c){if(this.get_IsDisabled())return;if(this._getIntAttribute(Owa.Strings.Attributes.ButtonAlwaysPushed)==1)return;if(c)addAndRemoveClasses(this._get_ButtonElement(),a[this._styleGroup][b.Pushed],a[this._styleGroup]);else this._release();this._setIntAttribute(Owa.Strings.Attributes.ButtonPushed,c?1:0)};Owa.UIControls.Button.prototype.get_IsShown=function Owa$UIControls$Button$get_IsShown(){return this._get_ButtonFrame().get_IsShown()};Owa.UIControls.Button.prototype.set_IsShown=function Owa$UIControls$Button$set_IsShown(a){this._get_ButtonFrame().set_IsShown(a)};Owa.UIControls.Button.prototype.get_MenuReferencePosition=function Owa$UIControls$Button$get_MenuReferencePosition(b){var a=this._get_ButtonFrame(),c=b?a.get_DocumentLeft()+a.get_OffsetWidth():a.get_DocumentLeft(),d=a.get_DocumentTop()+a.get_OffsetHeight();return{iX:c,iY:d}};Owa.UIControls.Button.prototype._onMouseDown=function Owa$UIControls$Button$_onMouseDown(){!this.get_IsDisabled()&&!this.get_IsPushed()&&this._press()};Owa.UIControls.Button.prototype._onMouseUp=function Owa$UIControls$Button$_onMouseUp(){!this.get_IsDisabled()&&!this.get_IsPushed()&&this._release()};Owa.UIControls.Button.prototype._onClick=function Owa$UIControls$Button$_onClick(a){a.cancelBubble();a.preventDefault();if(!this.get_IsDisabled()){!this.get_IsPushed()&&this._release();this._clientAction.triggerAction(a.get_CurrentTarget(),a)}};Owa.UIControls.Button.prototype._onKeyDown=function Owa$UIControls$Button$_onKeyDown(a){a.get_KeyCodeForKeyUpDown()==Owa.KeyCodes.ENTER&&a.preventDefault()};Owa.UIControls.Button.prototype._onKeyPress=function Owa$UIControls$Button$_onKeyPress(a){a.preventDefault()};Owa.UIControls.Button.prototype._onClientActionStateChanged=function Owa$UIControls$Button$_onClientActionStateChanged(a){this.set_IsDisabled(!a.fEnabled)};Owa.UIControls.Button.prototype._press=function Owa$UIControls$Button$_press(){!this.get_IsDisabled()&&addAndRemoveClasses(this._get_ButtonElement(),a[this._styleGroup][b.Pressed],a[this._styleGroup])};Owa.UIControls.Button.prototype._release=function Owa$UIControls$Button$_release(){if(!this.get_IsDisabled()){var d=a[this._styleGroup][b.Raised];if(g_fRtl&&c.ToolbarButton==this._styleGroup&&(Owa.Strings.Ids.AddThisCalendar==this._sId||Owa.Strings.Ids.ShareMyCalendar==this._sId||Owa.Strings.Ids.ViewThisCalendar==this._sId))d=Owa.Strings.CssClass.ToolbarButtonShareHoverable;addAndRemoveClasses(this._get_ButtonElement(),d,a[this._styleGroup])}};Owa.UIControls.Button.prototype._get_ButtonElement=function Owa$UIControls$Button$_get_ButtonElement(){return this._getIntAttribute(Owa.Strings.Attributes.IsNotificationButton)==1?this._get_Element():this._get_Element().get_ParentElement()};Owa.UIControls.Button.prototype._get_ButtonFrame=function Owa$UIControls$Button$_get_ButtonFrame(){return this._getIntAttribute(Owa.Strings.Attributes.HasBigButtonWrapper)==1?this._get_ButtonElement().get_ParentElement():this._get_ButtonElement()};function addAndRemoveClasses(d,e,c){for(var a=d.get_CssClasses(),b=0;b<c.length;b++)a.remove(c[b]);a.add(e);d.set_CssClasses(a)}Owa.UIControls.Button.createClass("Owa.UIControls.Button",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/button.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/stickybutton.js".toLowerCase()]&&(function(){Owa.UIControls.StickyButton=function Owa$UIControls$StickyButton(b,a){Owa.UIControls.StickyButton.constructBase(this,[b,a])};Owa.UIControls.StickyButton.prototype._onClick=function Owa$UIControls$StickyButton$_onClick(a){a.cancelBubble();if(this.get_IsDisabled())return;if(!this.get_IsPushed())this.set_IsPushed(true);else this.set_IsPushed(false);this._clientAction.triggerAction(a.get_Target(),a)};Owa.UIControls.StickyButton.createClass("Owa.UIControls.StickyButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/stickybutton.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/swapbutton.js".toLowerCase()]&&(function(){Owa.UIControls.SwapButton=function Owa$UIControls$SwapButton(b,a){Owa.UIControls.SwapButton.constructBase(this,[b,a]);this._rgSwapButtons=[]};Owa.UIControls.SwapButton.prototype.initialize=function Owa$UIControls$SwapButton$initialize(d){Owa.UIControls.SwapButton.callBase(this,"initialize",[d]);if(this._get_Parent())for(var b=this._getAttribute(Owa.Strings.Attributes.SwapSiblingIds).split(";"),a=0;a<b.length;++a){var c=this._get_Parent().getChildButton(b[a]);c&&this._rgSwapButtons.add(c)}};Owa.UIControls.SwapButton.prototype._onClick=function Owa$UIControls$SwapButton$_onClick(b){if(this.get_IsDisabled())return;this.set_IsShown(false);for(var a=0;a<this._rgSwapButtons.length;++a)this._rgSwapButtons[a].set_IsShown(!this._rgSwapButtons[a].get_IsShown());Owa.UIControls.SwapButton.callBase(this,"_onClick",[b])};Owa.UIControls.SwapButton.createClass("Owa.UIControls.SwapButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/swapbutton.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/togglebutton.js".toLowerCase()]&&(function(){Owa.UIControls.ToggleButton=function Owa$UIControls$ToggleButton(b,a){Owa.UIControls.ToggleButton.constructBase(this,[b,a]);this._rgToggleSiblingIds=[]};Owa.UIControls.ToggleButton.prototype.initialize=function Owa$UIControls$ToggleButton$initialize(b){Owa.UIControls.ToggleButton.callBase(this,"initialize",[b]);var a=this._getAttribute(Owa.Strings.Attributes.ToggleSiblingIds);if(a)this._rgToggleSiblingIds=a.split(";")};Owa.UIControls.ToggleButton.prototype._onClick=function Owa$UIControls$ToggleButton$_onClick(c){c.cancelBubble();if(this.get_IsDisabled())return;if(!this.get_IsPushed()){this.set_IsPushed(true);var d=this._get_Parent();if(d&&d.getChildButton)for(var a=0;a<this._rgToggleSiblingIds.length;++a){var b=this._get_Parent().getChildButton(this._rgToggleSiblingIds[a]);if(b)b.get_IsPushed()&&b.set_IsPushed(false)}}else this.set_IsPushed(false);this._clientAction.triggerAction(c.get_Target(),c)};Owa.UIControls.ToggleButton.createClass("Owa.UIControls.ToggleButton",Owa.UIControls.StickyButton)})();g_fModuleLoaded[".\\uicontrols/togglebutton.js".toLowerCase()]=1;var UITest_Popup_Flag=2;!g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var c="onDataBind",d="onPreShow",e="onClose",a=null;Owa.UIControls.Popup=function Owa$UIControls$Popup(c,a,b){Owa.UIControls.Popup.constructBase(this,[c,a]);this.fIsOpen=0;this._fIsInitialized=0;this._fSuppressClose=0;this._fAutomaticEnableClose=1;this._fDisableOffscreenBox=b;if(a&&Owa.UIControls.Popup.isInstance(a))this._oParentPopup=a;this._fIsReparented=this._reparentPopup()};Owa.UIControls.Popup.prototype._reparentPopup=function Owa$UIControls$Popup$_reparentPopup(){if(!this._get_Element())return false;var a=this._get_Container();if(a)this._get_Element().set_PositionalParent(a);else{var b=this._get_Element().get_OwnerDocument();this._get_Element().set_PositionalParent(b.get_Body())}return true};Owa.UIControls.Popup.prototype.initialize=function Owa$UIControls$Popup$initialize(){!a&&initializeTextBox();this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"selectstart",this._onSelectStart);this._attachEvent(this._get_Element(),"click",this._forwardEvent);if(!this._fIsReparented)this._fIsReparented=this._reparentPopup();this._fIsInitialized=1};Owa.UIControls.Popup.prototype._get_Container=function Owa$UIControls$Popup$_get_Container(){var a=this._get_Element().get_ParentElement();while(a)if(Owa.Dom.Element.isInstance(a)&&(a.get_OverflowX()==Owa.Style.Overflow.Scroll||a.get_OverflowX()==Owa.Style.Overflow.Auto||a.get_OverflowY()==Owa.Style.Overflow.Scroll||a.get_OverflowY()==Owa.Style.Overflow.Auto||a.get_TagName().toLowerCase()=="body"))break;else a=a.get_ParentElement();return a};Owa.UIControls.Popup.prototype.get_IsInitialized=function Owa$UIControls$Popup$get_IsInitialized(){return this._fIsInitialized};Owa.UIControls.Popup.prototype.dispose=function Owa$UIControls$Popup$dispose(){this.fIsOpen&&this.close();if(this.get_IsDomElementLoaded()){this._get_Element()._get_DomNode().oOriginalParent=null;this._get_Element().dispose()}Owa.UIControls.Popup.callBase(this,"dispose")};Owa.UIControls.Popup.prototype.get_OnDataBind=function Owa$UIControls$Popup$get_OnDataBind(){return this._getEventHandlerCollection(c)};Owa.UIControls.Popup.prototype.get_OnPreShow=function Owa$UIControls$Popup$get_OnPreShow(){return this._getEventHandlerCollection(d)};Owa.UIControls.Popup.prototype.get_OnClose=function Owa$UIControls$Popup$get_OnClose(){return this._getEventHandlerCollection(e)};Owa.UIControls.Popup.prototype.showRelative=function Owa$UIControls$Popup$showRelative(b,c){var a=this._get_Element().getExpando("_originalParent");b+=a.get_DocumentLeft()+(g_fRtl?a.get_OffsetWidth():0);c+=a.get_DocumentTop();this.show(b,c)};Owa.UIControls.Popup.prototype.get_Width=function Owa$UIControls$Popup$get_Width(){var a=this._get_Element(),b;if(!a.get_IsShown()){a.set_IsShown(true);b=a.get_OffsetWidth();a.set_IsShown(false)}else b=a.get_OffsetWidth();return b};Owa.UIControls.Popup.prototype.showUnder=function Owa$UIControls$Popup$showUnder(a,d,b){var c=!g_fRtl&&b||g_fRtl&&!b,e=a.get_DocumentLeft()+(c?a.get_OffsetWidth():0),f=a.get_DocumentTop()+a.get_OffsetHeight()+(d||0);this.show(e,f,b)};Owa.UIControls.Popup.prototype.show=function Owa$UIControls$Popup$show(e,f,d){this._dispatchEvent(c,this);var a={};a.iX=e;a.iY=f;a.fFarCorner=!!d;var b=this._get_Element().get_ParentElement();if(b)a.iY=a.iY-b.get_DocumentTop()+b.get_ScrollTop();UITest_Popup_Flag=1;this._iTShowTimer=this._setTimeout(this._tShow,1,a)};Owa.UIControls.Popup.prototype._fireOnPreShow=function Owa$UIControls$Popup$_fireOnPreShow(){this._dispatchEvent(d,this)};Owa.UIControls.Popup.prototype._tShow=function Owa$UIControls$Popup$_tShow(b){this._iTShowTimer=0;var a=this._get_Element();a.set_IsShown(1);this.fIsOpen=1;this._fireOnPreShow();a.moveToTop();var c=b.fFarCorner^g_fRtl?b.iX-a.get_OffsetWidth():b.iX,d=b.iY;a.set_PositionalLeft(Owa.Utility.getVisiblePositionX(a,c,g_fRtl));a.set_PositionalTop(Owa.Utility.getVisiblePositionY(a,d));this._addTextBoxEventHandlers();this._enableClose();this.fIsOpen&&this._attachEvent(Owa.Dom.Window.get_Current(),"resize",this.close);UITest_Popup_Flag=2};Owa.UIControls.Popup.prototype.close=function Owa$UIControls$Popup$close(){if(this._iTShowTimer){this._clearTimeout(this._iTShowTimer);this._iTShowTimer=0;UITest_Popup_Flag=2}if(this.fIsOpen){this._get_Element().set_IsShown(0);this.fIsOpen=0;this._removeTextBoxEventHandlers();this._detachEvent(Owa.Dom.Window.get_Current(),"resize",this.close);this._dispatchEvent(e,this)}};Owa.UIControls.Popup.prototype._suppressClose=function Owa$UIControls$Popup$_suppressClose(a){this._fSuppressClose=1;this._fAutomaticEnableClose=this._fAutomaticEnableClose&&a;this._oParentPopup&&this._oParentPopup._suppressClose(a)};Owa.UIControls.Popup.prototype._enableClose=function Owa$UIControls$Popup$_enableClose(){this._fSuppressClose=0;this._fAutomaticEnableClose=1;!this._fDisableOffscreenBox&&setFocusToTextBox()};Owa.UIControls.Popup.prototype._onBlurTextBox=function Owa$UIControls$Popup$_onBlurTextBox(){this._closeOnBlur();clearFocusFlag()};Owa.UIControls.Popup.prototype._closeOnBlur=function Owa$UIControls$Popup$_closeOnBlur(){this.fIsOpen&&!this._fSuppressClose&&this.close();this.fIsOpen&&this._fAutomaticEnableClose&&this._setTimeout(this._enableClose,1)};Owa.UIControls.Popup.prototype._onMouseDown=function Owa$UIControls$Popup$_onMouseDown(a){this._suppressClose(true);this._forwardEvent(a);a.cancelBubble()};Owa.UIControls.Popup.prototype._onKeyDown=function Owa$UIControls$Popup$_onKeyDown(a){this._suppressClose(true);this._forwardEvent(a);a.cancelBubble()};Owa.UIControls.Popup.prototype._onSelectStart=function Owa$UIControls$Popup$_onSelectStart(a){a.preventDefault();a.cancelBubble()};Owa.UIControls.Popup.prototype._forwardEvent=function Owa$UIControls$Popup$_forwardEvent(b){var a="on"+b.get_Type();this[a]&&this[a](b)};Owa.UIControls.Popup.prototype._addTextBoxEventHandlers=function Owa$UIControls$Popup$_addTextBoxEventHandlers(){this._fnOnBlur=this._attachEvent(a,"blur",this._onBlurTextBox);this._fnOnKeyDown=this._attachEvent(a,"keydown",this._onKeyDown)};Owa.UIControls.Popup.prototype._removeTextBoxEventHandlers=function Owa$UIControls$Popup$_removeTextBoxEventHandlers(){if(this._fnOnBlur){this._detachEvent(a,"blur",this._fnOnBlur);this._fnOnBlur=null}if(this._fnOnKeyDown){this._detachEvent(a,"keydown",this._fnOnKeyDown);this._fnOnKeyDown=null}!this._oParentPopup&&clearFocusFlag()};function initializeTextBox(){var b=Owa.Dom.Document.get_Current();a=b.createElement("input");a.set_Type(Owa.Dom.Input.Type.Text);a.addCssClass("offscreen");a.setAttribute("readonly","true");b.appendChild(a)}var b="_hasFocus";function setFocusToTextBox(){if(a.getBoolAttribute(b))return;var c=a.get_OwnerDocument().get_Body();a.set_Top(c.get_ScrollTop());a.set_Left(c.get_ScrollLeft());a.focus();a.focus();a.setBoolAttribute(b,true);a.set_Top(null);a.set_Left(null)}function clearFocusFlag(){a.setBoolAttribute(b,false)}Owa.UIControls.Popup.createClass("Owa.UIControls.Popup",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/menubutton.js".toLowerCase()]&&(function(){var a=null,b="onBeforePopup";Owa.UIControls.MenuButton=function Owa$UIControls$MenuButton(a,b){Owa.UIControls.MenuButton.constructBase(this,[a,b]);this._oSubMenuPopup=null;this._oComboDropDownButton=null};Owa.UIControls.MenuButton.prototype.initialize=function Owa$UIControls$MenuButton$initialize(b){Owa.UIControls.MenuButton.callBase(this,"initialize",[b]);this._oSubMenuPopup=new Owa.UIControls.Popup(this._get_Element().get_ParentElement().getDescendantById(this._getAttribute(Owa.Strings.Attributes.SubMenuId)));this._oSubMenuPopup.set_SubPage(this.get_SubPage());var a=this._getAttribute(Owa.Strings.Attributes.ComboDropDownId);if(a)this._oComboDropDownButton=this._get_Parent().getChildButton(a)};Owa.UIControls.MenuButton.prototype.dispose=function Owa$UIControls$MenuButton$dispose(){this._oSubMenuPopup.dispose();if(this==a)a=null;Owa.UIControls.MenuButton.callBase(this,"dispose")};Owa.UIControls.MenuButton.prototype.get_OnBeforePopup=function Owa$UIControls$MenuButton$get_OnBeforePopup(){return this._getEventHandlerCollection(b)};Owa.UIControls.MenuButton.prototype._showPopup=function Owa$UIControls$MenuButton$_showPopup(){this._dispatchEvent(b,this);var a=(this._oComboDropDownButton?this._oComboDropDownButton:this).get_MenuReferencePosition(g_fRtl);this._get_SubMenuPopup().show(a.iX,a.iY)};Owa.UIControls.MenuButton.prototype._get_SubMenuPopup=function Owa$UIControls$MenuButton$_get_SubMenuPopup(){if(!this._oSubMenuPopup.get_IsInitialized()){this._oSubMenuPopup.initialize();this._oSubMenuPopup.get_OnClose().add(this._createCallback(this._onDropDownClose))}return this._oSubMenuPopup};Owa.UIControls.MenuButton.prototype._onClick=function Owa$UIControls$MenuButton$_onClick(a){a.cancelBubble();a.preventDefault();!this.get_IsDisabled()&&this.show()};Owa.UIControls.MenuButton.prototype._onDropDownClose=function Owa$UIControls$MenuButton$_onDropDownClose(){this.set_IsPushed(false);this._oComboDropDownButton&&this._oComboDropDownButton.set_IsPushed(false)};Owa.UIControls.MenuButton.prototype.show=function Owa$UIControls$MenuButton$show(){a&&a.hide();var c=this._get_Element().get_OwnerDocument();if(this._get_SubMenuPopup().get_Id()=="tblspellcheckMnu"){if(g_SplLng==SP_RESET)g_SplLng=a_iSp;var b=$("divSpl").getExpando("oSpellCheckerComboBox");b.set_SelectedValue(g_SplLng);b.oSpSel=crtSelTxR()}else this._attachEvent(c,"mouseout",this._onDocumentMouseOut);this._attachEvent(c,"mouseup",this._onDocumentMouseUp);a=this;this.set_IsPushed(true);this._oComboDropDownButton&&this._oComboDropDownButton.set_IsPushed(true);this._showPopup()};Owa.UIControls.MenuButton.prototype.hide=function Owa$UIControls$MenuButton$hide(){if(a==this)a=null;this._get_SubMenuPopup().close();var b=this._get_Element().get_OwnerDocument();this._detachEvent(b,"mouseout",this._onDocumentMouseOut);this._detachEvent(b,"mouseup",this._onDocumentMouseUp)};Owa.UIControls.MenuButton.prototype._onDocumentMouseUp=function Owa$UIControls$MenuButton$_onDocumentMouseUp(){this._get_SubMenuPopup().fIsOpen&&!this._get_SubMenuPopup()._fSuppressClose&&this.hide()};Owa.UIControls.MenuButton.prototype._onDocumentMouseOut=function Owa$UIControls$MenuButton$_onDocumentMouseOut(a){a.get_Target()==null&&this.hide()};Owa.UIControls.MenuButton.get_CurrentPopupButton=function Owa$UIControls$MenuButton$get_CurrentPopupButton(){return a};Owa.UIControls.MenuButton.hideAnyPopupMenu=function Owa$UIControls$MenuButton$hideAnyPopupMenu(){a&&a.hide()};Owa.UIControls.MenuButton.createClass("Owa.UIControls.MenuButton",Owa.UIControls.StickyButton)})();g_fModuleLoaded[".\\uicontrols/menubutton.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/combobutton.js".toLowerCase()]&&(function(){Owa.UIControls.ComboButton=function Owa$UIControls$ComboButton(a,b){Owa.UIControls.ComboButton.constructBase(this,[a,b]);this._oComboDropDownTwisty=null};Owa.UIControls.ComboButton.prototype.initialize=function Owa$UIControls$ComboButton$initialize(a){Owa.UIControls.ComboButton.callBase(this,"initialize",[a]);this._oComboDropDownTwisty=this._get_Parent().getChildButton(this._getAttribute(Owa.Strings.Attributes.ComboMenuId))};Owa.UIControls.ComboButton.prototype.dispose=function Owa$UIControls$ComboButton$dispose(){Owa.UIControls.ComboButton.callBase(this,"dispose");this._oComboDropDownTwisty=null};Owa.UIControls.ComboButton.prototype.set_IsDisabled=function Owa$UIControls$ComboButton$set_IsDisabled(a){Owa.UIControls.ComboButton.callBase(this,"set_IsDisabled",[a]);this._oComboDropDownTwisty.set_IsDisabled(a)};Owa.UIControls.ComboButton.prototype.set_IsShown=function Owa$UIControls$ComboButton$set_IsShown(a){Owa.UIControls.ComboButton.callBase(this,"set_IsShown",[a]);this._oComboDropDownTwisty.set_IsShown(a)};Owa.UIControls.ComboButton.prototype.set_IsPushed=function Owa$UIControls$ComboButton$set_IsPushed(a,b){Owa.UIControls.ComboButton.callBase(this,"set_IsPushed",[a]);!b&&this._oComboDropDownTwisty.set_IsPushed(a)};Owa.UIControls.ComboButton.prototype.set_ComboEnabled=function Owa$UIControls$ComboButton$set_ComboEnabled(a){this._oComboDropDownTwisty.set_IsDisabled(!a)};Owa.UIControls.ComboButton.createClass("Owa.UIControls.ComboButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/combobutton.js".toLowerCase()]=1;Type.createNamespace("Owa.UIControls");!g_fModuleLoaded[".\\uicontrols/toolbar.js".toLowerCase()]&&(function(){Owa.UIControls.Toolbar=function Owa$UIControls$Toolbar(b,a){Owa.UIControls.Toolbar.constructBase(this,[b,a]);this._oBtns={}};Owa.UIControls.Toolbar.prototype.initialize=function Owa$UIControls$Toolbar$initialize(h){var j=this._oBtns,e=[],a=[];a.add(this._get_Element());while(a.length>0){var i=a[0];a.removeAt(0);var f=i.get_Enumerator();while(f.moveNext()){var b=f.get_Current();if(b.get_NodeType()!=Owa.NodeType.Element)continue;var g=b.getAttribute(Owa.Strings.Attributes.Type);if(g==Owa.Strings.Names.LinkButton||g==Owa.Strings.Names.LinkNotificationButton){var c=Owa.UIControls.Button.create(this.get_SubPage(),b,this);if(c){j[c.get_Id()]=c;e.add(c)}else a.add(b)}else a.add(b)}}for(var d=0;d<e.length;++d)e[d].initialize(h)};Owa.UIControls.Toolbar.prototype.dispose=function Owa$UIControls$Toolbar$dispose(){this._get_Element().detachAllEvents();for(var a in this._oBtns)this._oBtns[a].dispose();Owa.UIControls.Toolbar.callBase(this,"dispose")};Owa.UIControls.Toolbar.prototype.getChildButton=function Owa$UIControls$Toolbar$getChildButton(a){return this._oBtns[a]};Owa.UIControls.Toolbar.createClass("Owa.UIControls.Toolbar",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/toolbar.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");var enblB;!g_fModuleLoaded[".\\components/ToolbarCollection.js".toLowerCase()]&&(function(){Owa.Components.ToolbarCollection=function Owa$Components$ToolbarCollection(a){Owa.Components.ToolbarCollection.constructBase(this);this._rgToolbars=null;this._oSubPage=a};Owa.Components.ToolbarCollection.get=function Owa$Components$ToolbarCollection$get(b){var a=b._oToolbarCollection;if(!a)a=Owa.Components.ToolbarCollection.create(b);return a};Owa.Components.ToolbarCollection.create=function Owa$Components$ToolbarCollection$create(a){var b=new Owa.Components.ToolbarCollection(a);a._oToolbarCollection=a.addResource(b);return b};Owa.Components.ToolbarCollection.get_Current=function Owa$Components$ToolbarCollection$get_Current(){return this.get(Owa.UIControls.SubPage.get_Instance())};var a=Owa.Components.ToolbarCollection.prototype;a._fSupportUniqueId=true;Owa.Components.ToolbarCollection.prototype.addToolbars=function Owa$Components$ToolbarCollection$addToolbars(c,e){if(this._rgToolbars==null)this._rgToolbars=[];for(var b=0;b<c.length;b++){var d=this._oSubPage._getDescendant(c[b]);if(d){var a=new Owa.UIControls.Toolbar(d);a.set_SubPage(this._oSubPage);a.initialize(e);this._rgToolbars.push(a)}}};Owa.Components.ToolbarCollection.prototype.getButton=function Owa$Components$ToolbarCollection$getButton(c){if(this._rgToolbars==null)return null;for(var a=0;a<this._rgToolbars.length;a++){var b=this._rgToolbars[a].getChildButton(c);if(b)return b}return null};Owa.Components.ToolbarCollection.prototype.set_IsButtonShown=function Owa$Components$ToolbarCollection$set_IsButtonShown(c,b){var a=this.getButton(c);if(!a)return;a.set_IsShown(b?1:0)};Owa.Components.ToolbarCollection.prototype.set_IsButtonDisabled=function Owa$Components$ToolbarCollection$set_IsButtonDisabled(c,b){var a=this.getButton(c);if(!a)return;a.set_IsDisabled(b?1:0)};enblB=function enableButton(b,c,a){if(!a)a=Owa.UIControls.SubPage.get_Instance();Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(b,!!c)};Owa.Components.ToolbarCollection.prototype.set_IsButtonPushed=function Owa$Components$ToolbarCollection$set_IsButtonPushed(c,b){var a=this.getButton(c);if(!a)return;a.set_IsPushed(b?1:0)};Owa.Components.ToolbarCollection.prototype.dispose=function Owa$Components$ToolbarCollection$dispose(){if(this._rgToolbars==null)return;for(var a=0;a<this._rgToolbars.length;a++)this._rgToolbars[a].dispose();this._rgToolbars=null;this._oSubPage=null;Owa.Components.ToolbarCollection.callBase(this,"dispose")};Owa.Components.ToolbarCollection.prototype.adjustToolbarWidths=function Owa$Components$ToolbarCollection$adjustToolbarWidths(){for(var b=8,a=0;a<arguments.length;a++)b+=this._sizeToolbar(arguments[a]);return b};Owa.Components.ToolbarCollection.fixToolbars=function Owa$Components$ToolbarCollection$fixToolbars(){if(g_fRtl&&Owa.Utility.isIE()){var b=Owa.Dom.Document.get_Current(),a=b.createElement("img");b.appendChild(a);a.setAttribute("src",getRsrcF("clear1x1.gif"));a.remove(1)}};Owa.Components.ToolbarCollection.prototype._sizeToolbar=function Owa$Components$ToolbarCollection$_sizeToolbar(e){if(!e)return 0;var a=this._oSubPage._getDescendant(e);if(!a||!a.get_IsShown())return 0;var d=a.getBoolAttribute("fRtAlgn");d=d&&!g_fRtl||!d&&g_fRtl;var b=a.getDescendantById("divMeasure");if(!b)return 0;a.set_Width(2e3,Owa.Style.Unit.Pixels);var c=0;if(d)c=a.get_DocumentLeft()+a.get_OffsetWidth()-b.get_DocumentLeft();else c=b.get_DocumentLeft()-a.get_DocumentLeft()+b.get_OffsetWidth();c+=b._getEffectiveMargin(Owa.Style.Side.Left)+b._getEffectiveMargin(Owa.Style.Side.Right);c+=3;a.set_Width(c);return c};Owa.Components.ToolbarCollection.createClass("Owa.Components.ToolbarCollection",Owa.Components.Control)})();g_fModuleLoaded[".\\components/ToolbarCollection.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/BackgroundFader.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");Owa.Components.BackgroundFader=function Owa$Components$BackgroundFader(c,d,b,a){Owa.Components.BackgroundFader.constructBase(this);this._oElement=c;this.iPulses=d;this._iFadeTime=b;this._iPauseTime=a;this._rgActiveFadeTimers=[];this._fFading=0};var a=Owa.Components.BackgroundFader.prototype,c=[new RegExp("rgb\\((\\d+),\\s+(\\d+),\\s+(\\d+)\\)","i"),new RegExp("#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})","i")],b=[10,16];a.fadeInFadeOut=function Owa$Components$BackgroundFader$fadeInFadeOut(b,c,f){if(this._fFading)return;this._fFading=1;for(var a=0;a<this._rgActiveFadeTimers.length;a++)clearTimeout(this._rgActiveFadeTimers[a]);this._setBackgroundColor(b);this._fade(b,c,this._iFadeTime);for(var a=0;a<this.iPulses*2-1;a++){var e,d;if(a%2==0){e=c;d=b}else{e=b;d=c}var h=this.stTmout("_fade",(this._iFadeTime+this._iPauseTime)*(a+1),e,d,this._iFadeTime);this._rgActiveFadeTimers.push(h)}var g=this.stTmout("_setBackgroundColor",(this._iFadeTime+this._iPauseTime)*(this.iPulses*2),f?"transparent":"",1);this._rgActiveFadeTimers.push(g)};a._fade=function Owa$Components$BackgroundFader$_fade(f,c,i){var n=40,a=Math.round(n*(i/1e3)),h=i/a,g=h,b=0;if(f.length<7)f+=f.substr(1,3);if(c.length<7)c+=c.substr(1,3);var d=this._parseColorComponents(f);if(!d)return;var e=this._parseColorComponents(c);if(!e)return;var l,k,j,m;while(b<a){l=Math.floor(d[0]*((a-b)/a)+e[0]*(b/a));k=Math.floor(d[1]*((a-b)/a)+e[1]*(b/a));j=Math.floor(d[2]*((a-b)/a)+e[2]*(b/a));m=this._makeHex(l,k,j);this.stTmout("_setBackgroundColor",g,m);b++;g=h*b}this.stTmout("_setBackgroundColor",g,c)};a._parseColorComponents=function Owa$Components$BackgroundFader$_parseColorComponents(f){for(var e=null,a=0;a<c.length;a++){var d=f.match(c[a]);if(d&&4==d.length){e=new Array(3);e[0]=parseInt(d[1],b[a]);e[1]=parseInt(d[2],b[a]);e[2]=parseInt(d[3],b[a]);break}}return e};a._makeHex=function Owa$Components$BackgroundFader$_makeHex(c,b,a){c=c.toString(16);b=b.toString(16);a=a.toString(16);if(c.length==1)c="0"+c;if(b.length==1)b="0"+b;if(a.length==1)a="0"+a;return"#"+c+b+a};a._setBackgroundColor=function Owa$Components$BackgroundFader$_setBackgroundColor(a,b){this._oElement._get_DomNode().style.backgroundColor=a;if(b)this._fFading=0};Owa.Components.BackgroundFader.createClass("Owa.Components.BackgroundFader",Owa.Components.Control)})();g_fModuleLoaded[".\\components/BackgroundFader.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/MailTipsButtonHandler.js".toLowerCase()]&&(function(){var g="mailTips",m="warn.png",e="info.gif",l="pgrs-sm.gif",b="extend",j="imgToolbarButtonDropdownIcon",d="imgTipButtonProgress",k="up-arrw.gif",h="alertdropdown.gif",f=1,i=0,p=2,o=1e3,n=100,c=null;Owa.Components.MailTipsButtonHandler=function Owa$Components$MailTipsButtonHandler(){try{this.oButton=Owa.Components.ToolbarCollection.get_Current().getButton(g)}catch(e){this.oButton=null}if(this.oButton){var a=this.oButton._get_ButtonElement();g_fRtl&&a.addCssClass("rtl");var b='<img id="'+d+'" src="'+getThmF(l)+'" style="display:none" class="tbLh tbBefore">',c=this.oButton.getToolbarIcon();if(c)c.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterEnd,b);else a.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,b);this._oBackgroundFader=new Owa.Components.BackgroundFader(a,p,o,n);this.sFadedColor=getStyle("mailTipsButtonFaded").backgroundColor}else this._oBackgroundFader=0};Owa.Components.MailTipsButtonHandler.get_Instance=function Owa$Components$MailTipsButtonHandler$get_Instance(){if(!c)c=new Owa.Components.MailTipsButtonHandler;return c};var a=Owa.Components.MailTipsButtonHandler.prototype;a.dispose=function Owa$Components$MailTipsButtonHandler$dispose(){this.oButton&&this.oButton.dispose()};a.doesButtonExist=function Owa$Components$MailTipsButtonHandler$doesButtonExist(){return this.oButton?1:0};a.updateDropDownIcon=function Owa$Components$MailTipsButtonHandler$updateDropDownIcon(c){if(this.oButton){var a=this.oButton._get_ButtonElement();if(a){var b=a.getDescendantById(j);b&&Owa.Components.CssSprites.updateImage(b,c?k:h);this._updateExtendClass(a,c)}}};a.updateIconAndColor=function Owa$Components$MailTipsButtonHandler$updateIconAndColor(h,c,d){if(this.oButton){var g=this.oButton.getToolbarIcon();if(g){var b=e;switch(h){case f:b=m;break;case i:b=e}Owa.Components.CssSprites.updateImage(g,b)}var a=this.oButton._get_ButtonElement();if(a&&!a.hasCssClass(d)){a.hasCssClass(c)&&a.removeCssClass(c);a.addCssClass(d)}}};a.toggleProgressIcon=function Owa$Components$MailTipsButtonHandler$toggleProgressIcon(a){if(this.oButton){var c=this.oButton.getToolbarIcon(),b=this.oButton._get_ButtonElement().getDescendantById(d);if(c&&b){c.set_IsShown(!a);b.set_IsShown(a)}a&&this.set_IsShown(1)}};a.get_IsShown=function Owa$Components$MailTipsButtonHandler$get_IsShown(){return this.oButton?this.oButton.get_IsShown():0};a.set_IsShown=function Owa$Components$MailTipsButtonHandler$set_IsShown(a){if(this.oButton){var b=this.oButton._get_ButtonElement(),c=b.get_ParentElement().get_ParentElement();this._updateExtendClass(c,a);this.oButton.set_IsShown(a)}};a.fadeInFadeOut=function Owa$Components$MailTipsButtonHandler$fadeInFadeOut(a){this._oBackgroundFader&&this._oBackgroundFader.fadeInFadeOut(a,this.sFadedColor)};a.setEndColor=function Owa$Components$MailTipsButtonHandler$setEndColor(a){this._oBackgroundFader&&this._oBackgroundFader.setEndColor(a)};a.focusToolbar=function Owa$Components$MailTipsButtonHandler$focusToolbar(){this.oButton&&this.oButton._get_ButtonElement().get_ParentElement().focus()};a._updateExtendClass=function Owa$Components$MailTipsButtonHandler$_updateExtendClass(a,c){if(c&&!a.hasCssClass(b))a.addCssClass(b);else!c&&a.hasCssClass(b)&&a.removeCssClass(b)};Owa.Components.MailTipsButtonHandler.createClass("Owa.Components.MailTipsButtonHandler",Owa.Components.Control)})();g_fModuleLoaded[".\\components/MailTipsButtonHandler.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/Infobar.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");var h="divInfobarColor",l="divIB",i="divInfobarMessage",j="infobarMessageItem",k="divErr",d="highSeverity",e="lowSeverity",b=1,c=0,g="divInfobarLoading";Owa.UIControls.Infobar=function Owa$UIControls$Infobar(a){this.oMailTipsButtonHandler=Owa.Components.MailTipsButtonHandler.get_Instance();Owa.UIControls.Infobar.constructBase(this,[a])};var a=Owa.UIControls.Infobar.prototype,f=0;a.exists=function Owa$UIControls$Infobar$exists(){return this._get_Element()?1:0};a.get_IsShown=function Owa$UIControls$Infobar$get_IsShown(){var a=this._get_Element();return a?a.get_IsShown():0};a.set_IsShown=function Owa$UIControls$Infobar$set_IsShown(a,k){var d=this._get_Element();if(a){var e=-1;if(this._hasHighSeverityMessages()){this.setColor(b);e=b}else if(0<this.getMessages().length){this.setColor(c);e=c}var g=this.getErrorMessage(),i=0;if(!f||g&&g.get_IsShown()||!this.oMailTipsButtonHandler.doesButtonExist()){d.set_IsShown(a);this.oMailTipsButtonHandler.updateDropDownIcon(a);i=1}else if(f){d.set_IsShown(0);this.oMailTipsButtonHandler.updateDropDownIcon(0)}this.oMailTipsButtonHandler.set_IsShown(1);if(!i&&-1<e){var l=gtStl(d.getChildById(h)._get_DomNode()).color;this.oMailTipsButtonHandler.fadeInFadeOut(l)}}else{d.set_IsShown(a);this.oMailTipsButtonHandler.updateDropDownIcon(a)}if(!k){var j=this.get_SubPage();j.safeResizeBodies&&j.safeResizeBodies()}};a.getOffsetHeight=function Owa$UIControls$Infobar$getOffsetHeight(){var a=this._get_Element();return a.get_IsShown()?a.get_OffsetHeight():0};a.expandHeight=function Owa$UIControls$Infobar$expandHeight(b){if(this.get_IsShown()){var a=this.getDivIB();if(a){var c=a.get_OffsetHeight();a.set_MaxHeight(c+b,Owa.Style.Unit.Pixels)}}};a.getDivIB=function Owa$UIControls$Infobar$getDivIB(){var a=this._get_Element();if(a)return a.getChildById(l)};a.getMessages=function Owa$UIControls$Infobar$getMessages(){var a=[],b=this.getDivIB();b&&b.forEachChild(function(b){b.get_IsShown()&&a.push(b)});return a};a.getMessageById=function Owa$UIControls$Infobar$getMessageById(b){var a=this.getDivIB();return a?a.getChildById(b):0};a.getErrorMessage=function Owa$UIControls$Infobar$getErrorMessage(){return this.getMessageById(k)};a.buildMessage=function Owa$UIControls$Infobar$buildMessage(e,c,b){var d=this.getDivIB();if(d){if(!c)c=i;if(!b&&0!=b)b=1;var a=Owa.Dom.Document.get_Current().createElement("div");a.set_Id(c);a.setIntAttribute("iType",b);a.addCssClass(j);a.set_InnerHtml(e);Owa.UIControls.Infobar.insertDashImage(a);return a}return 0};a.replaceOrInsertMessage=function Owa$UIControls$Infobar$replaceOrInsertMessage(a){var b=this.getMessageById(a.get_Id());if(b)this.replaceMessage(a,b);else this.insertMessage(a)};a.buildReplaceOrInsertMessageAndRefresh=function Owa$UIControls$Infobar$buildReplaceOrInsertMessageAndRefresh(e,c,d){var a=this.buildMessage(e,c,d);if(a){this.replaceOrInsertMessage(a);this.set_IsShown(1);var b=this.get_SubPage();b.safeResizeBodies&&b.safeResizeBodies()}return a};a.insertMessage=function Owa$UIControls$Infobar$insertMessage(a){var c=this.getDivIB();if(c){var d=c.forEachChild(this._compareTwoMessages,a);if(d)d.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,a);else c.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,a)}this._isHighSeverity(a)&&this.setColor(b)};a.checkRemoveMessageAndRefresh=function Owa$UIControls$Infobar$checkRemoveMessageAndRefresh(d,c){var a=this.getMessageById(d);if(a){this.removeMessage(a);if(!c){var b=this.get_SubPage();b.safeResizeBodies&&b.safeResizeBodies()}}};a.removeMessage=function Owa$UIControls$Infobar$removeMessage(b,a){b.remove(1);this.refreshRemoveOrHide(a)};a.hideMessage=function Owa$UIControls$Infobar$hideMessage(a){a.set_IsShown(0);this.refreshRemoveOrHide()};a.refreshRemoveOrHide=function Owa$UIControls$Infobar$refreshRemoveOrHide(a){!this._hasHighSeverityMessages()&&this.setColor(c);if(0==this.getMessages().length){this.set_IsShown(0,a);this.oMailTipsButtonHandler.set_IsShown(0)}};a.setColor=function Owa$UIControls$Infobar$setColor(i){var j=this._get_Element(),g=j.getChildById(h),f=e,a=d;switch(i){case b:f=d;a=e;break;case c:f=e;a=d}if(!g.hasCssClass(f)){g.hasCssClass(a)&&g.removeCssClass(a);g.addCssClass(f)}this.oMailTipsButtonHandler.updateIconAndColor(i,a,f)};a.replaceMessage=function Owa$UIControls$Infobar$replaceMessage(c,b){var a=this.getDivIB();a&&a.replaceChild(c,b)};a.setLoadingStatus=function Owa$UIControls$Infobar$setLoadingStatus(a){var c=this._get_Element();if(a&&0==this.getMessages().length){var b=this.buildMessage(L_Ld,g,2);this.replaceOrInsertMessage(b)}else!a&&this.checkRemoveMessageAndRefresh(g);this.oMailTipsButtonHandler.toggleProgressIcon(a)};a.setHideByDefaultValue=function Owa$UIControls$Infobar$setHideByDefaultValue(a){f=a};a.focusToolbarOnButtonClick=function Owa$UIControls$Infobar$focusToolbarOnButtonClick(){this.oMailTipsButtonHandler.focusToolbar()};a.refresh=function Owa$UIControls$Infobar$refresh(){var a=this.get_IsShown();(a||0<this.getMessages().length)&&this.set_IsShown(true)};a._compareTwoMessages=function Owa$UIControls$Infobar$_compareTwoMessages(c,d){var b=c.getIntAttribute("iType"),e=d.getIntAttribute("iType"),a;if(!b&&0!=b)a=1;else if(b>e)a=0;else if(b<e)a=1;else{var f=c.get_TextContent(),g=d.get_TextContent();a=f>g}return a};a._isHighSeverity=function Owa$UIControls$Infobar$_isHighSeverity(a){if(a.get_IsShown()){var b=a.getIntAttribute("iType");return 4<b}return 0};a._hasHighSeverityMessages=function Owa$UIControls$Infobar$_hasHighSeverityMessages(){var a=this.getDivIB();return a?a.forEachChild(this._isHighSeverity):0};Owa.UIControls.Infobar.insertDashImage=function insertDashImage(d){var c=Owa.Dom.Document.get_Current(),b=Owa.Components.CssSprites.getImageElement("dash.gif",c);b.addCssClass("dashImg");g_fRtl&&b.addCssClass("rtl");b.set_Id("imgDash");var a=c.createElement("div");if(g_fRtl)a.addCssClass("fltRight");else a.addCssClass("fltLeft");a.appendChild(b);d.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,a)};Owa.UIControls.Infobar.createClass("Owa.UIControls.Infobar",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/Infobar.js".toLowerCase()]=1;function tglInfo(h){var c=h.parentNode,g=getOneDescendant(c,"imgExp"),a=getOneDescendant(c,"divIbE"),j=getOneDescendant(c,"spnS"),k=getOneDescendant(c,"spnH"),b=0,f=Owa.Dom.Node.wrapDomNode(h).getAncestorById("divInfobar"),i=new Owa.UIControls.Infobar(f);if(!isDisp(a)){b=0;Owa.Components.CssSprites.updateImage(g,"cllps.gif");showEm(a);if(a.offsetHeight>150)a.style.height=150;i.expandHeight(a.offsetHeight)}else{b=1;Owa.Components.CssSprites.updateImage(g,"expnd.gif");showEm(a,1);var l=a.offsetHeight}showEm(k,b);showEm(j,!b);var e=Owa.Components.SubPageControllerFactory.getControllerFromParent(f),d=e&&e.get_SubPage();d&&d.safeResizeBodies&&d.safeResizeBodies()}function setDebugInfo(a,d){if(d){var b=Owa.Dom.Document.get_Current().createElement("DIV");b=Owa.Dom.Document.get_Current().appendChild(b);hideEm(b);b.set_InnerHtml(d);var c=b.get_TextContent();a.getDescendantById("imgEICpy").setAttribute("_sErrDbg",c);a.getDescendantById("imgEISnd").setAttribute("_sErrDbg",c);showEm(a.getDescendantById("tdEICpy"));showEm(a.getDescendantById("tdEISnd"));a._get_DomNode().title=c;b.remove(true)}else{a.getDescendantById("imgEICpy").setAttribute("_sErrDbg","");a.getDescendantById("imgEISnd").setAttribute("_sErrDbg","");a._get_DomNode().title="";hideEm(a.getDescendantById("tdEICpy"));hideEm(a.getDescendantById("tdEISnd"))}}function showErr(a,f,g,e,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var d=a.getDescendantById("tdMsg");if(e!=null&&e==1)d.set_TextContent(f);else d.set_InnerHtml(f);setDebugInfo(a,g);showEm(a);b=b||Owa.UIControls.SubPage.get_Instance();var c=new Owa.UIControls.Infobar(a.getAncestorById("divInfobar"));c.set_SubPage(b);c.checkRemoveMessageAndRefresh("divDAErr",1);c.set_IsShown(1);c.dispose();b.resizeBodyOffset&&b.resizeBodyOffset()}function showErrInNav(a,f,e){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var d=a.getDescendantById("tdMsg"),c=a.getAncestorById("divInfobar"),b=c.getChildById("divInfobarColor");d.set_InnerHtml(f);setDebugInfo(a,e);a.set_IsShown(true);c.set_IsShown(true);b.removeCssClass("lowSeverity");b.addCssClass("highSeverity")}function hideErr(b,a){if(!Owa.Dom.Node.isInstance(b))b=Owa.Dom.Node.wrapDomNode(b);a=a||Owa.UIControls.SubPage.get_Instance();var c=new Owa.UIControls.Infobar(b.getAncestorById("divInfobar"));c.set_SubPage(a);c.hideMessage(b);c.dispose();a.safeResizeBodies&&a.safeResizeBodies();a.resizeBodyOffset&&a.resizeBodyOffset()}function hideErrInNav(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b=a.getAncestorById("divInfobar");a.set_IsShown(false);b.set_IsShown(false)}function canEvt(a){if(a==null)a=getEvt(this);if(!Owa.Dom.Event.isInstance(a))a=new Owa.Dom.Event(a,getEvtTgt(a));a.cancelBubble();a.preventDefault()}function canEdEvt(a){canEvt(a._oEvent)}function onEvtCanInpt(b){if(b.isCtrlKeyDown())return;var a=b.get_Target();if(!a)return;if(a.get_TagName){if(!a._get_DomNode().disabled&&isInpt(a))return;while(a){if(a.getAttribute(Owa.Strings.Attributes.AllowContextMenu))return;a=a.get_ParentElement()}}if(b.get_Type()=="contextmenu"&&Owa.Utility.isIE()&&Owa.Utility.isWindows8orGreater()&&b.get_CurrentTarget()._get_DomNode()===window.document)return;b.preventDefault();b.cancelBubble()}function isInpt(a){if(!a)return;if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b=a.get_TagName().toLowerCase();return b=="input"||b=="textarea"||a.getAttribute("contentEditable")=="true"||a.get_OwnerDocument().get_IsDesignMode()}function cancelSelectStart(a){if(isInpt(a.get_Target()))return;a.preventDefault()}var isWP,isSWP,isStOpPg,isStPg,wt,getCSW,getWindowClientLeft,getWindowClientTop,isNavigationPageObject,isCalendarPageObject,isFolderViewSubPageObject;(function(){Type.createNamespace("Owa.PageHierarchy");isWP=Owa.PageHierarchy.isWebPart=function Owa$PageHierarchy$isWebPart(){return isDf(typeof a_fWP)&&a_fWP};isSWP=Owa.PageHierarchy.isSmallWebPart=function Owa$PageHierarchy$isSmallWebPart(){return isDf(typeof a_fSWP)&&a_fSWP};isStOpPg=Owa.PageHierarchy.isInStartOrOptionPage=function Owa$PageHierarchy$isInStartOrOptionPage(){var a=wt();return isDf(typeof a.a_fStPg)&&a.a_fStPg||isDf(typeof a.a_fOpPg)&&a.a_fOpPg};isStPg=Owa.PageHierarchy.isInStartPage=function Owa$PageHierarchy$isInStartPage(){var a=wt();return isDf(typeof a.a_fStPg)&&a.a_fStPg};Owa.PageHierarchy.getOwaTopWindow=function Owa$PageHierarchy$getOwaTopWindow(){return new Owa.Dom.Window(wt())};wt=function Owa$PageHierarchy$wt(a){a=a||window;while(1)try{var b=0;if(isDf(typeof a.frameElement)&&a.frameElement&&isDf(typeof a.frameElement.ownerDocument)&&a.frameElement.ownerDocument)b=a.frameElement.ownerDocument.parentWindow||a.frameElement.ownerDocument.defaultView;if(!isDf(typeof b)||!isDf(typeof b.g_fOwa)||!b.g_fOwa)break;a=b;if(a.closeModalDialog)break}catch(c){break}return a};Owa.PageHierarchy.getElementByIdFromTop=function Owa$PageHierarchy$getElementByIdFromTop(a){return Owa.PageHierarchy.getOwaTopWindow().get_Document().getElementById(a)};getCSW=Owa.PageHierarchy.getCentralStorageWindow=function Owa$PageHierarchy$getCentralStorageWindow(){var a=window;try{while(!a.isStOpPg()){var b=a.opener;if(b&&b.g_fOwa)a=b;else break}a=a.wt()}catch(c){}return a};function getWindowClientValue(c,b){var e=c[b](),a=c.get_OwnerDocument().get_ContainerWindow();if(!Owa.PageHierarchy.isWebPart())while(1)try{var f=a.get_FrameElement(),d=a.get_ParentWindow();if(!d.getGlobalVariable("g_fOwa"))break;e+=f[b]();a=d}catch(g){break}return e}getWindowClientLeft=Owa.PageHierarchy.getWindowClientLeft=function Owa$PageHierarchy$getWindowClientLeft(a){return getWindowClientValue(a,"get_DocumentLeft")};getWindowClientTop=Owa.PageHierarchy.getWindowClientTop=function Owa$PageHierarchy$getWindowClientTop(a){return getWindowClientValue(a,"get_DocumentTop")};function isSubPageObject(a,b){return a.sTypeName==b}function isOneOfSubPageObject(b,a){return a[b.sTypeName]}isNavigationPageObject=Owa.PageHierarchy.isNavigationPageObject=function Owa$PageHierarchy$isNavigationPageObject(a){return isSubPageObject(a,"NavigationPage")};isCalendarPageObject=Owa.PageHierarchy.isCalendarPageObject=function Owa$PageHierarchy$isCalendarPageObject(a){return isSubPageObject(a,"CalendarViewPage")};isReadConversationPageObject=Owa.PageHierarchy.isReadConversationPageObject=function Owa$PageHierarchy$isReadConversationPageObject(a){return isSubPageObject(a,"ReadConversationPage")};var a={FolderViewsSubPage:true,DirectoryView:true,MessageViewSubPage:true,ContactViewPage:true,TaskViewPage:true,DumpsterViewPage:true};isFolderViewSubPageObject=Owa.PageHierarchy.isFolderViewSubPageObject=function Owa$PageHierarchy$isFolderViewSubPageObject(b){return isOneOfSubPageObject(b,a)};Owa.PageHierarchy.getFolderViewSubPageFromSubPageController=function Owa$PageHierarchy$getVirtualListViewFromSubPageController(b){if(!b)return null;var a=b.get_SubPage();return a&&Owa.PageHierarchy.isFolderViewSubPageObject(a)?a:null};Owa.PageHierarchy.getVirtualListViewFromSubPageController=function Owa$PageHierarchy$getVirtualListViewFromSubPageController(b){var a=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b);return a?a.get_VirtualListView():null}})();(function(){Owa.Controls.EventDispatcher=function Owa$Controls$EventDispatcher(){Owa.Controls.EventDispatcher.baseClass.call(this);this.init()};Owa.Utility.inherit(Owa.Controls.EventDispatcher,Owa.Controls.Control);Owa.Controls.EventDispatcher.prototype.init=function Owa$Controls$EventDispatcher$init(){this._ev={}};Owa.Controls.EventDispatcher.prototype.register=function Owa$Controls$EventDispatcher$register(a){if(this._ev[a])return;this._ev[a]=[]};Owa.Controls.EventDispatcher.prototype.fire=function Owa$Controls$EventDispatcher$fire(j){var i=wt();if(i!=window)return i.g_oEd.fire.apply(i.g_oEd,arguments);if(!this._ev[j])return;for(var d=[],a=1;a<arguments.length;a++)d.push(arguments[a]);for(var e=this._ev[j].slice(0),a=0;a<e.length;a++){var c=e[a][0],k=e[a][1],g=e[a][2];if(!c)c=window;var h=c[k];if(!h)continue;if(g){for(var f=[],b=0;b<g.length;b++)f.push(g[b]);for(var b=0;b<d.length;b++)f.push(d[b]);h.apply(c,f)}else h.apply(c,d)}};Owa.Controls.EventDispatcher.prototype.attachEvent=function Owa$Controls$EventDispatcher$attachEvent(b,e,f){var c=wt();if(c!=window)return c.g_oEd.attachEvent.apply(c.g_oEd,arguments);if(!this._ev[b])return;if(this.isAttached(b,e,f))return;for(var g=this._ev[b],a=[],d=3;d<arguments.length;d++)a.push(arguments[d]);g.push([e,f,a.length?a:null])};Owa.Controls.EventDispatcher.prototype.isAttached=function Owa$Controls$EventDispatcher$isAttached(d,e,f){var c=wt();if(c!=window)return c.g_oEd.isAttached.apply(c.g_oEd,arguments);if(!this._ev[d])return;for(var b=this._ev[d],a=0;a<b.length;a++)if(b[a][0]==e&&b[a][1]==f)return 1};Owa.Controls.EventDispatcher.prototype.detachEvent=function Owa$Controls$EventDispatcher$detachEvent(d,e,f){var c=wt();if(c!=window)return c.g_oEd.detachEvent.apply(c.g_oEd,arguments);if(!this._ev[d])return;for(var a=this._ev[d],b=0;b<a.length;b++)if(a[b][0]==e&&a[b][1]==f)break;if(b<a.length)if(b==a.length-1)a.pop();else a[b]=a.pop()}})();if(!window.g_oEd)window.g_oEd=new Owa.Controls.EventDispatcher;g_oEd.register("ReloadNavigationTree");Owa.Components.OehRequest.get_onResponseReceived().add(checkEveryOehResponse);var g_iFlrTimer=0;function checkEveryOehResponse(a){if(a.iErr==26){var b=Owa.Dom.Document.get_Current().createElement("div");b.set_InnerHtml(a.sErr);var c=b.getDescendantById("spRedirUrl");c&&setFlrReTimer(c.get_InnerHtml());a.sErr=b.get_TextContent()}}function setFlrReTimer(a){if(g_iFlrTimer!=0)return;g_iFlrTimer=setTimeout('flrRedir("'+a+'")',3e4)}function flrRedir(a){g_iFlrTimer=0;var b=getCSW();b.document.location.href=a}(function(){Owa.Controls.OEHManagerBase=function Owa$Controls$OEHManagerBase(){Owa.Controls.OEHManagerBase.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.OEHManagerBase,Owa.Controls.Control);Owa.Controls.OEHManagerBase.prototype.prepCtx=function Owa$Controls$OEHManagerBase$prepCtx(c,d){for(var a=[],b=0;b<c.length;b++)a.push(c[b]);a.push(d);return a};Owa.Controls.OEHManagerBase.prototype.prepArgs=function Owa$Controls$OEHManagerBase$prepArgs(c,b){var a=b.get_Context();b.oCtx=a.pop();a.unshift(b);a.unshift(c);return a};Owa.Controls.OEHManagerBase.prototype.prepCB=function Owa$Controls$OEHManagerBase$prepCB(b,a){a=a?1:0;return this.crtCbWA("fire",b,a)};Owa.Controls.OEHManagerBase.prototype.fire=function Owa$Controls$OEHManagerBase$fire(d,e,f){var a=this.prepArgs(d,f);g_oEd.fire.apply(g_oEd,a);if(e){var b=window;while(b&&!b.isStOpPg())try{var c=b.opener;if(c&&c.g_fOwa){b=c;b.g_oEd&&b.g_oEd.fire.call(b.g_oEd,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11])}else break}catch(g){break}}}})();function tryGtActMd(b){var a=wt();if(a&&a.gtActMd)return a.gtActMd();if(!b)try{a=a.opener;return!(a&&a.g_fOwa)?[]:a.tryGtActMd(0)}catch(c){}return[]}var FL_MBX="MBX",FL_PUB="PSF",FL_OUM="OUM",FL_AMB="AMB",FL_GS="GS",NM_MAIL=0,NM_CAL=1,NM_CTS=2,NM_TSK=3,NM_AB=5,NM_DOC=6,NM_PF=7;(function(){Owa.Controls.FolderManager=function Owa$Controls$FolderManager(){Owa.Controls.FolderManager.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.FolderManager,Owa.Controls.OEHManagerBase);Owa.Controls.FolderManager.prototype.isMyFId=function Owa$Controls$FolderManager$isMyFId(a){return this.gtFL(a)==FL_MBX};Owa.Controls.FolderManager.prototype.gtFL=function Owa$Controls$FolderManager$gtFL(a){return Owa.Controls.FolderManager.getOwaStoreObjectIdPrefix(a)};Owa.Controls.FolderManager.prototype.isDelFId=function Owa$Controls$FolderManager$isDelFId(b){if(isDf(typeof a_rgDlItms)&&a_rgDlItms)for(var a=0;a<a_rgDlItms.get_Length();a++)if(b==a_rgDlItms.get_Item(a))return 1;return 0};Owa.Controls.FolderManager.prototype.getPrimaryDeletedItemsFolderId=function Owa$Controls$FolderManager$prototype$getPrimaryDeletedItemsFolderId(){return isDf(typeof a_rgDlItms)&&a_rgDlItms&&a_rgDlItms.length>0?a_rgDlItms[0]:null};Owa.Controls.FolderManager.prototype.isJunkFolderId=function Owa$Controls$FolderManager$isJunkFolderId(a){return a==a_sJnk};Owa.Controls.FolderManager.prototype.prstTrExpSt=function Owa$Controls$FolderManager$prstTrExpSt(){if(!g_oMMFrst)return;var b=g_oMMFrst.gtTr("favorite"),d=g_oMMFrst.gtTr("mail"),c=g_oMMFrst.gtTr("buddy"),a=new oeReq("Tree","PersistExpand",null,null,POST);b&&a.add("fts",b.gtNdFrstChld(b.gtNdRt()).isExp()?1:0);d&&a.add("mts",d.gtNdRt().isExp()?1:0);c&&a.add("bts",c.gtNdRt().isExp()?1:0);a.send()};Owa.Controls.FolderManager.prototype.rnmFld=function Owa$Controls$FolderManager$rnmFld(e,d,c,b){var a=new oeReq("Tree","Rename",this.prepCtx(arguments,b),this.prepCB("RenameFolder",1),POST);a.add("destId",d);a.add("fN",c);a.send()};Owa.Controls.FolderManager.prototype.nwFld=function Owa$Controls$FolderManager$nwFld(i,d,h,g,c,e,f,b){var a=new oeReq("Tree","New",this.prepCtx(arguments,b),this.prepCB("NewFolder",1),POST);a.add("destId",d);a.add("fDstD",h?1:0);a.add("fN",c);a.add("fC",g);a.addRg("cms",tryGtActMd());a.add("exp",e?1:0);a.add("rdt",f);a.send()};Owa.Controls.FolderManager.prototype.cpMvFld=function Owa$Controls$FolderManager$cpMvFld(k,c,g,b,d,j,h,i,e){if(b&&g_oFldrMgr.gtFL(b)==FL_AMB&&(c&&g_oFldrMgr.gtFL(c)!=FL_AMB)){var f=htmlEnc(L_ErrArvMvFld)+'&nbsp;&nbsp;<a href="#" onclick="opnHlp(\''+a_sArchivePolicyUrl+'\')" title="'+L_Hlp+'">'+Owa.Components.CssSprites.getImageMarkup("help.png")+"</a>";OKDlgHtml(f,null,null,null,L_ErrMvFldFailed).show();return}var a;if(j)a=new oeReq("Tree","Copy",this.prepCtx(arguments,e),this.prepCB("CopyFolder",1),POST);else a=new oeReq("Tree","Move",this.prepCtx(arguments,e),this.prepCB("MoveFolder",1),POST);a.add("id",c);a.add("destId",b);a.add("fSrcD",g?1:0);a.add("fDstD",d?1:0);a.addRg("cms",tryGtActMd());a.add("exp",h?1:0);a.add("rdt",d?FRT_ALL:i);a.send()};Owa.Controls.FolderManager.prototype.cpMvItms=function Owa$Controls$FolderManager$cpMvItms(o,c,g,b,d,f,p,n){var i,a;addPerfMarker("FolderManager.CpMvItms.Start");c=c||Owa.UIControls.SubPage.get_Instance();if(isNavigationPageObject(c))a=c.getLstVw(c.getSubPageVariable("a_sLstFID"));else if(isFolderViewSubPageObject(c))a=c.get_VirtualListView();var k=a!=null&&a.get_ContextFolderId?a.get_ContextFolderId():g;if(Owa.Pages.ReadConversationPage&&Owa.Pages.ReadConversationPage.isInstance(c)){var m=c.get_SubPage().get_ParentSubPage();if(isFolderViewSubPageObject(m))c=m}var j=null,e=null,h=this.prepCtx(arguments,n);if(f){j="Copy";e=this.prepCB("CopyItems",1)}else{j="Move";e=this.prepCB("MoveItems",1)}if(g&&this.isDelFId(g)||a&&a.isCnvVw&&a.isCnvVw()&&b[0]&&!Ews.BaseId.IsOwaCnvId(b[0])||Owa.Utility.isIdType(d,Owa.Utility.OwaPrefixes.PublicStoreFolderPrefix)||Owa.Utility.isIdType(b[0],Owa.Utility.OwaPrefixes.PublicStoreItemPrefix)||a&&a.isDumpsterVw&&a.isDumpsterVw()){i=new oeReq("MsgVLV2",j,h,e,POST);b&&b.length&&i.addRg("id",b);g&&i.add("fId",g);i.add("destId",d);a&&a.isCnvVw&&a.isCnvVw()&&a.cnvCpMv(b,d,f);i.send()}else{h.moveCopyParams={cb:e,oCallerSubPage:c,sSourceFolderId:g,sContextFolderId:k,sDstFId:d,fC:f};e=Owa.Utility.createDelegate(this,this.cbMoveCopy);!f&&g&&Owa.PendingOperationsManager.increment(k);if(a)h.moveCopyParams.rgIKs=Owa.Pages.ListViewSubPage.getInstanceKeysAndAddToOperationsManager(b,a);if(b[0]&&Ews.BaseId.IsOwaCnvId(b[0])){var l=Owa.Pages.ListViewSubPage.getConversationActionInfos(b,a);a.cnvCpMv(b,d,f);!f&&a.rmvRws(b);EwsService.ApplyConversationAction(e,h,j,l.oContainerId,l.rgCnvIdAndLastModifiedTime,null,null,EwsService.ConvertToEwsId(d))}else{!f&&a&&a.rmvRws(b);if(f)EwsService.CopyItems(e,h,EwsService.ConvertToEwsIds(b),EwsService.ConvertToEwsId(d));else EwsService.MoveItems(e,h,EwsService.ConvertToEwsIds(b),EwsService.ConvertToEwsId(d))}addPerfMarker("FolderManager.CpMvItms.EWS.End")}addPerfMarker("CbCpMvItms.End")};Owa.Controls.FolderManager.prototype.cbMoveCopy=function Owa$UIControls$FolderManager$cbMoveCopy(c){if(!Ews.ResponseWrapper.isInstance(c))return;var e,a=c.get_Context().moveCopyParams;try{var d=null;a.oCallerSubPage=a.oCallerSubPage||Owa.UIControls.SubPage.get_Instance();if(isNavigationPageObject(a.oCallerSubPage))d=a.oCallerSubPage.getLstVw(a.oCallerSubPage.getSubPageVariable("a_sLstFID"));else if(isFolderViewSubPageObject(a.oCallerSubPage))d=a.oCallerSubPage.get_VirtualListView();e=c.CheckErrors()}finally{!a.fC&&a.sSourceFolderId&&Owa.PendingOperationsManager.decrement(a.sContextFolderId);a.rgIKs&&!a.fC&&Owa.PendingOperationsManager.removeInstanceKeys(a.sSourceFolderId,a.rgIKs);a.sDstFId&&Owa.PendingOperationsManager.tickleXTC(a.sDstFId)}if(e)d.rfrsh();else{b.UpdateFolderId(a.sDstFId);a.cb(c)}};Owa.Controls.FolderManager.prototype.delFld=function Owa$Controls$FolderManager$delFld(f,c,d,e,b){var a=new oeReq("Tree","Delete",this.prepCtx(arguments,b),this.prepCB("DeleteFolder",1),POST);a.add("id",c);a.add("fSrcD",d?1:0);a.add("pd",e?1:0);a.addRg("cms",tryGtActMd());a.send()};Owa.Controls.FolderManager.prototype.mkAllRd=function Owa$Controls$FolderManager$mkAllRd(d,c,b){var a=new oeReq("Tree","MarkAllAsRead",this.prepCtx(arguments,b),this.prepCB("MarkAllAsRead",1),POST);a.add("id",c);a.send()};Owa.Controls.FolderManager.prototype.emptyFld=function Owa$Controls$FolderManager$emptyFld(d,a,c){g_oEd.fire("EmptyFolderStarted",a);g_oEd.fire("UpdateCount",a,0,0);g_oEd.attachEvent("RemoveSubscriptions",this,"cbRemoveSubscriptions");var b=new oeReq("MsgVLV2","RemoveSubscriptions",this.prepCtx(arguments,c),this.prepCB("RemoveSubscriptions",1),POST);b.add("destId",a);b.send()};Owa.Controls.FolderManager.prototype.cbRemoveSubscriptions=function Owa$Controls$FolderManager$cbRemoveSubscriptions(f,e,a,d){g_oEd.detachEvent("RemoveSubscriptions",this,"cbRemoveSubscriptions");var c=EwsService.ConvertToEwsIds([a]);fSoftDelete=this.isDelFId(a)||this.isJunkFolderId(a)||Owa.Utility.isIdType(a,Owa.Utility.OwaPrefixes.PublicStoreFolderPrefix);fDeleteSubfolders=this.isDelFId(a)||this.isJunkFolderId(a);var b=this.prepCtx([e,a],d);b.oEmptyFolderParams={sFId:a,cb:this.prepCB("EmptyFolder",1)};EwsService.EmptyFolder(Owa.Utility.createDelegate(this,this.cbEmptyFolder),b,c,fSoftDelete?Ews.DeleteTypes.SoftDelete:Ews.DeleteTypes.MoveToDeletedItems,fDeleteSubfolders);Owa.PendingOperationsManager.increment(a);addPerfMarker("FolderTree.CbOnEmptyFld.End")};Owa.Controls.FolderManager.prototype.cbEmptyFolder=function Owa$UIControls$FolderManager$cbEmptyFolder(a){var b=a.get_HttpError(),h=b&&b==L_Tmout,d=a.get_Context().oEmptyFolderParams;if(!b){var g=a.get_Response();if(g)for(var f=g.get_ResponseMessages().get_Messages(),c,e=0;e<f.get_Length();e++){c=f[e];if(c&&c.get_ResponseCode()=="ErrorTimeoutExpired"){h=true;break}}}if(h){Owa.PendingOperationsManager.addEmptyFolderPending(d.sFId);g_oEd.attachEvent("UpdateCount",this,"cbEmptyFolderCount")}else try{if(a.CheckErrors())return;else d.cb(a)}finally{Owa.PendingOperationsManager.decrement(d.sFId)}};Owa.Controls.FolderManager.prototype.cbEmptyFolderCount=function Owa$Controls$FolderManager$cbEmptyFolderCount(a,b){if(Owa.PendingOperationsManager.hasEmptyFolderPending(a)&&b==0)try{Owa.PendingOperationsManager.removeEmptyFolderPending(a)}finally{Owa.PendingOperationsManager.decrement(a)}};Owa.Controls.FolderManager.getOwaStoreObjectIdPrefix=function Owa$Controls$FolderManager$getOwaStoreObjectIdPrefix(a){return a.startsWith("PSF.")?FL_PUB:a.startsWith("OUM.")?FL_OUM:a.startsWith("AMB.")?FL_AMB:a.startsWith("GS.")?FL_GS:FL_MBX};g_oEd.register("NewFolder");g_oEd.register("MoveFolder");g_oEd.register("DeleteFolder");g_oEd.register("MarkAllAsRead");g_oEd.register("EmptyFolderStarted");g_oEd.register("RemoveSubscriptions");g_oEd.register("EmptyFolder");g_oEd.register("UpdateFolderCount");g_oEd.register("CopyFolder");g_oEd.register("CopyItems");g_oEd.register("MoveItems");g_oEd.register("RenameFolder");g_oEd.register("UpdateCount");var a=function MruManager(){this._rgIds=null};a.prototype.UpdateFolderId=function mruManager$prototype$UpdateFolderId(b){if(this._rgIds!=null&&this._rgIds.length>0)for(var a=0;a<this._rgIds.length&&a<5;++a)if(this._rgIds[a]==b)return;var c=new oeReq("MsgVLV2","AddToMru",null,Owa.Utility.createDelegate(this,this.ServerUpdateCallback),POST);c.add("fId",b);c.send()};a.prototype.ServerUpdateCallback=function mruManager$prototype$ServerUpdateCallback(a){if(!a.isErr||!a.isErr())this._rgIds=eval(a.sBody)};var b=new a})();var g_oFldrMgr;if(!g_oFldrMgr)g_oFldrMgr=new Owa.Controls.FolderManager;function isAB(){return isDf(typeof initAB)}function isSngPkr(){return isAB()&&isDf(typeof a_fSngPk)&&a_fSngPk}function isADOnly(){return isAB()&&isDf(typeof a_fADOnly)&&a_fADOnly}function isPaaPkr(){return isAB()&&isDf(typeof a_fPaaPk)&&a_fPaaPk}function isMblPkr(){return isAB()&&isDf(typeof a_fMblPk)&&a_fMblPk}function isRepFw(){return isDf(typeof a_iNit)&&(a_iNit==RF_RPLY||a_iNit==RF_FWD||a_iNit==RF_PSTRPLY)}function isJnkEnbl(){return isDf(typeof a_fJnkEnbl)?a_fJnkEnbl:0}function isJnkFld(a){if(!a)a=Owa.UIControls.SubPage.get_Instance();return a&&isDf(typeof a.getSubPageVariable("a_fJnkFld"))?a.getSubPageVariable("a_fJnkFld"):0}Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/hotkey.js".toLowerCase()]&&(function(){var a=Owa.KeyCodes,c={TAB:a.TAB,ENTER:a.ENTER,UP:a.UP,DOWN:a.DOWN,HOME:a.HOME,END:a.END,PAGEUP:a.PAGE_UP,PAGEDOWN:a.PAGE_DOWN,ESC:a.ESC};Owa.Components.HotKey=function Owa$Components$HotKey(c,d,b,a){this._oKeyPart=c;this._sCmd=d;this._fEnabled=true;this._fIgnoreEventFromInput=b;this._ffIngoreEventFromExternalFrame=a};Owa.Components.HotKey.createFromKeyStroke=function Owa$Components$createFromKeyStroke(d,c,b,a){return new Owa.Components.HotKey(parseKey(d),c,b,a)};var b=Owa.Components.HotKey.prototype;b.get_IngoreEventFromInput=function Owa$Components$HotKey$get_IngoreInputEvent(){return this._fIgnoreEventFromInput};b.get_IngoreEventFromExternalFrame=function Owa$Components$HotKey$get_IngoreEventFromExternalFrame(){return this._ffIngoreEventFromExternalFrame};b.get_oKeyPart=function Owa$Components$HotKey$get_oKeyPart(){return this._oKeyPart};b.get_Command=function Owa$Components$HotKey$get_Command(){return this._sCmd};b.get_IsEnabled=function Owa$Components$HotKey$get_IsEnabled(){return this._fEnabled};b.set_IsEnabled=function Owa$Components$HotKey$set_IsEnabled(a){this._fEnabled=a};function parseKey(j){for(var g=0,f=0,i=0,e=0,b=0,h=j.toUpperCase().split("+"),d=0;d<h.length;d++){var a=h[d];if("CTRL"==a)g=1;else if("MACCTRL"==a)e=1;else if("SHIFT"==a)f=1;else if("ALT"==a)i=1;else if(c[a])b=c[a];else if(isNaN(getInt(a)))b=a.charCodeAt(0);else b=getInt(a)}return{iCtrl:g,iShift:f,iAlt:i,iMacCtrl:e,iKey:b}}})();g_fModuleLoaded[".\\components/hotkey.js".toLowerCase()]=1;var g_fLckd=0,g_fPrcSp=0,g_fShPrg=0,g_SplLng=SP_RESET,g_sLstSpTx=SP_RESET,g_iLstSpLng=0,g_oCurSel=0,g_oCurrentSpellCheckRequest=null,g_sImgPHId="OWAImgPlaceHolder",SP_RESET=-1;function onKDBuf(){var a=edEvt();if(!a)return;if(getKeyCode(a)==27&&g_fPrcSp){g_fPrcSp=0;if(g_oCurrentSpellCheckRequest){g_oCurrentSpellCheckRequest.cancelCallback();g_oCurrentSpellCheckRequest=null}g_sLstSpTx=SP_RESET;g_rgWR=0;g_sSCTxt=0;cnclBbl(a);window.setTimeout(relLck,500)}else return false}function relLck(){lckBdy(0);updCmp(window,window.oR)}function lckBdy(d){if(g_fLckd==d)return;var b=edDoc(),f=Owa.UIControls.SubPage.get_Instance();if(d){try{setFcsBdy(0)}catch(h){return 0}g_fLckd=d;isHtml()&&f.getComposeEditor().enableFormatbar(0);var a=getEm("SPAN",b);a=b.appendChild(a);a.id="buffer";a.style.pixelWidth=1;a.style.overflow="hidden";a.contentEditable=true;a.onkeydown=onKDBuf;setFcs(a);var c=Owa.Dom.Node.wrapDomNode(b);c.detachAllEvents("activate");c.detachAllEvents("deactivate");c.attachEvent("deactivate",new Function("setFcs(ifBdy.document.all.buffer);"));c.attachEvent("activate",new Function("setFcs(ifBdy.document.all.buffer);"))}else{g_fPrcSp=0;var c=Owa.Dom.Node.wrapDomNode(b);if(isHtml()){var g=f.getComposeEditor();g._attachContentWindowEvents();g.enableFormatbar(1)}var e=getOneDescendant(b,"buffer");if(e){e.onkeydown=null;rn(e)}g_fLckd=d;try{setFcsBdy(0)}catch(h){return 0}if(g_oCurSel){doCllps(g_oCurSel,0);g_oCurSel=0}if(g_fShPrg){g_fShPrg=0;hdPrgrsInd()}}return 1}function procSpl(g,h){if(Owa.Components.OehRequest.hasPendingRequests()||g_fLckd)return;g_oCurSel=crtSelTxR();if(!lckBdy(1))return;var a={};a.iOp=h;a.oCb=g;var e=$("divSpl").getExpando("oSpellCheckerComboBox");if(e.oSpSel){g_oCurSel=e.oSpSel;e.oSpSel=0}for(var f=edDoc().images,c=0;c<f.length;c++)iaeh(f[c],"<span id="+g_sImgPHId+' style="width:0px;height:0px;overflow:hidden">&nbsp;</span>');try{a.oRng=gtSpTxtR(a.iOp);a.sTxt=a.oRng.text;if(a.oRng.text==""||g_sLstSpTx==a.oRng.text&&g_iLstSpLng==g_SplLng){lckBdy(0);a.iOp&&a.iOp&OP_SND&&g(a.iOp);updCmp(window);return}if(g_SplLng==SP_RESET)g_SplLng=a_iSp;g_sLstSpTx=a.oRng.text;g_iLstSpLng=g_SplLng;clrSpUI(1);var d=new oeReq("SpellChecker","SpellCheck",a,cbProcSpl);d.add("Tx",a.oRng.text);d.add("Lng",g_SplLng);g_fShPrg=1;shwPrgrsInd(L_ChkSpl,100);g_fPrcSp=1;d.send();g_oCurrentSpellCheckRequest=d}finally{var b=edDoc().all(g_sImgPHId);if(b&&!b.length)b=[b];if(b)for(var c=b.length-1;c>=0;c--)rn(b[c])}}function cbProcSpl(b){g_oCurrentSpellCheckRequest=null;if(!g_fPrcSp)return;var a=b.oCtx,g=a.oRng,f=a.sTxt,d=0,c;if(b.sErr){b.fST&&popLgn();d=b.sErr}if(!d){c=eval(b.sBody);if(!c.length){lckBdy(0);if(a.iOp&&a.iOp&OP_SND){a.oCb(a.iOp);return}replaceOrInsertInfobarMessage(L_ChkSplNoErr,"divSpIB");setFcsBdy(0)}else{checkRemoveInfobarMessage("divSpIB");if(a.iOp&&a.iOp&OP_SND){var e=replaceOrInsertInfobarMessage(L_ChkSplOnSnd,"divSpIB",7);e.addCssClass("error")}prcSCk(c,g,f);posElm(edDoc().body,1);setFcsBdy(0);window.oR=b;return true}}else{g_sLstSpTx=SP_RESET;lckBdy(0);!b.fST&&shwErrDlg(b)}}function mvToCh(c,b){var a=c.duplicate();a.collapse(1);a.move("character",b);return a}var g_iLsIdxCRLFs=0,g_iTotCRLFs=0;function cntCRLFs(b,c){var a=b.indexOf("\r\n",g_iLsIdxCRLFs);while(a>=0&&a<c){g_iTotCRLFs++;g_iLsIdxCRLFs=a+2;a=b.indexOf("\r\n",g_iLsIdxCRLFs)}return g_iTotCRLFs}var g_oCurRng=0;function initRng(c,h,e,a){g_oCurRng.moveStart("character",a);g_oCurRng.moveEnd("character",h);var f=g_oCurRng.parentElement()?g_oCurRng.parentElement().nodeName:"";if(f=="XMP"||f=="PLAINTEXT")return 0;if(g_oCurRng.text==e){var i=g_oCurRng.duplicate();i.collapse(0);i.pasteHTML("<a></a>");return g_oCurRng.duplicate()}else{var j=g_oCurRng.duplicate();if(j.text==e)return j;var b=gtCurPos(g_oCurRng),a=0,d=0,g=c+h;if(b.st!=c)a=c-b.st;if(b.end!=g)d=g-b.end;a&&g_oCurRng.moveStart("character",a);d&&g_oCurRng.moveEnd("character",d);if(g_oCurRng.text==e)return g_oCurRng.duplicate()}}function doPrcSCk(){if(g_iResIdx==g_rgRes.length||!g_fPrcSp){g_fPrcSp&&mrkRngs();return}for(var j=0;g_iResIdx<g_rgRes.length&&j<2;j++){var a=g_rgRes[g_iResIdx];++g_iResIdx;if(!a)continue;var c,e,b,i,l,f=a[0],d=a[1];switch(f){case 0:c=a[2];e=a[3];break;case 1:f=0;var h=g_rgRes[a[2]];c=h[2];e=h[3];break;case 2:c=a[2];e=null}var g=d-cntCRLFs(g_sSCTxt,d);i=g-g_iLS;var k=g_sSCTxt.substr(d,c);b=initRng(d,c,k,i);g_iLS=g;if(!b||isIgA(b.text))continue;b.iT=f;b.rgSg=e;g_rgWR.push(b)}window.setTimeout(doPrcSCk,1)}var g_rgSg=0,g_rgWR=0,g_iDxWR=0,g_rgRes=0,g_iResIdx=0,g_sSCTxt=0,g_iLS=0;function prcSCk(c,d,b){g_iLsIdxCRLFs=0;g_iTotCRLFs=0;g_rgSg=[];g_rgWR=[];g_iDxWR=0;g_rgRes=c;g_iResIdx=0;g_iLS=0;g_sSCTxt=b;var a=c[0][1];g_iLS=a-cntCRLFs(b,a);g_oCurRng=mvToCh(d,g_iLS);doPrcSCk()}function mrkRngs(){if(!g_fPrcSp)return;if(g_iDxWR==g_rgWR.length){lckBdy(0);g_rgWR=0;g_sSCTxt=0;updCmp(window,window.oR);return}for(var a=0;g_iDxWR<g_rgWR.length&&a<2;a++){var b=g_rgWR[g_iDxWR];g_rgWR[g_iDxWR]=0;++g_iDxWR;doMrkRng(b)}window.setTimeout(mrkRngs,1)}function doMrkRng(a){var f=a.iT,e=a.rgSg,c=-1,b=a.parentElement();if(b&&b.tagName&&b.tagName.toUpperCase()=="A")return;if(e){c=g_rgSg.length;g_rgSg[c]=e}var d=a.htmlText;try{d="<span id=misspelled tabIndex=-1 t="+f+" s='"+c+"'>"+d+"</span>";a.pasteHTML("");a.pasteHTML(d)}catch(g){}}function unmrkW(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);a.remove(false)}function clrSpUI(d){var c=edDoc(1),a=gtInvWs(c);if(a){var b=a.get_Enumerator();while(b.moveNext())unmrkW(b.get_Current());if(d)g_rgSg.length=0}return a?1:0}function gtWrd(h,f,g){var d=crtSelTxR();if(!d)return;var a=gtCurWrd(d.parentElement());if(a){var c=gtCurPos(d);gtElPos(a);if(!h||c.st!=c.end||f!=32||f==32&&(c.st>a.st&&c.end<a.end))return a;var b=getEm("SPAN",edDoc());if(c.st<=a.st)b=ibb(a,b);else b=iae(a,b);b.innerText=" ";d.moveToElementText(b);c.end==a.end&&doCllps(d,0);var e=a.firstChild;e&&e.nodeType==1&&e.tagName=="DIV"&&e.removeNode();b.removeNode();canEvt(g);return 0}return a}function gtSpTxtR(c){var a,b=gtCurPos(g_oCurSel,1,1);if(b.end==b.st||c==OP_SND)a=gtSpTxt();else a=b.sel;return a}function replW(b,d){var c=b.oR.duplicate(),a=b.firstChild;while(a){if(a.nodeType==3){a.parentNode.innerText=d;break}a=a.firstChild}unmrkW(b);c.findText(d);doCllps(c,0)}function delDupW(b){var a=b.oR.duplicate();a.setEndPoint("StartToEnd",a);a.moveEnd("character",1);a.collapse(0);b.oR.moveEnd("character",1);b.oR.text="";rn(b);doCllps(a,0)}function igNW(a){var b=a.oR.duplicate();unmrkW(a);doCllps(b,0)}var g_rgIgA=[];function isIgA(b){for(var a=0;a<g_rgIgA.length;++a)if(g_rgIgA[a]==b)return 1;return 0}function addIgA(a){!isIgA(a)&&g_rgIgA.push(a)}function ignrAll(b){var f=b.oR.duplicate(),d=Owa.Dom.Node.wrapDomNode(b).get_TextContent();addIgA(d);var c=gtInvWs();if(c){var a=c.get_Enumerator();while(a.moveNext()){var e=a.get_Current(),g=e.get_TextContent();g.lc()==d.lc()&&unmrkW(e)}}doCllps(f,0)}function gtCurWrd(a){while(a){if(a.id=="misspelled")return a;if(a.tagName&&a.tagName.lc()=="body")return null;a=a.parentNode}return null}function gtInvWs(a){if(!a)a=edDoc(1);var b=a.get_Body().getAllDescendantsById("misspelled");return!b.length?null:b}function crtTxR(){return edDoc().body.createTextRange()}function crtSelTxR(){try{var a=edDoc().selection;if(a.type=="None"||a.type=="Text")return a.createRange()}catch(b){}}function selWrd(b){var a=crtTxR();a.moveToElementText(b);a.select()}function gtCurPos(a,c,d){var b={};if(!a)a=crtSelTxR();if(a&&cntns(edDoc().body,a.parentElement(),1))gtOffset(a,b,c,d);else{a=crtTxR();doCllps(a,1);b.st=b.end=0;if(c)b.sel=a}return b}function gtOffset(a,b,d,c){c&&a.text.length&&a.expand("word");var e=gtBdTxR(a,"EndToEnd");b.st=e.text.length-a.text.length;b.end=b.st+a.text.length;if(d)b.sel=a}function gtBdTxR(b,c){var a=b.duplicate();a.moveToElementText(edDoc().body);a.setEndPoint(c,b);return a}function gtSpTxt(){var b,a=wtda(g_sRFId,edDoc().parentWindow);if(!isRepFw()||!a||a.length)b=crtTxR();else{var c=crtTxR();c.moveToElementText(a);b=gtBdTxR(c,"EndToStart")}return b}function gtElPos(b){var a=crtTxR();a.moveToElementText(b);gtOffset(a,b)}var SP_E="0",SP_DE="1",SP_D="2";function cmPreShwSpl(a){switch(a.t){case SP_E:case SP_DE:cmPreShwErr(a);break;case SP_D:cmPreShwDup()}}function cmPreShwEd(){function Itm(b,a){this.itm=b;this.cmd=a}var b;if(typeof divCut=="undefined"||typeof divDel=="undefined")b=[new Itm(wda("divUndo"),"Undo"),new Itm(wda("divCpy"),"Copy"),new Itm(wda("divPst"),"Paste"),new Itm(wda("divSlA"),"SelectAll")];else b=[new Itm(wda("divUndo"),"Undo"),new Itm(wda("divCut"),"Cut"),new Itm(wda("divCpy"),"Copy"),new Itm(wda("divPst"),"Paste"),new Itm(wda("divDel"),"Delete"),new Itm(wda("divSlA"),"SelectAll")];for(var d=0;d<b.length;++d){var a=b[d],c,e=g_oMmBdy&&(a.cmd=="Cut"||a.cmd=="Copy"||a.cmd=="Paste"),f=isDf(typeof a_fCopyRestricted)&&a_fCopyRestricted==1&&(a.cmd=="Cut"||a.cmd=="Copy");if(e||f)c=0;else c=queryStatus(a.cmd);a.itm.UNSELECTABLE="on";ctxMnuDsbl(a.itm,!c)}}function cmPreShwErr(g){var d=g_rgSg[g.s],c=wda("divScm"),b=c.all.divSg,e=[],a;if(!d||!d.length)showEm(c.all.nSg);else{for(a=0;a<d.length;++a)if(d[a]&&b[a]){b[a].all.spnT.innerText=d[a];if(d[a]==L_ChkSplNoSug)g=b[a];e.push(b[a])}showEm(c.all.nSg,1);cmShwEm(e,0)}showEm(c.all.divS1);if(e.length<b.length){var f=[];a=e.length;for(a;a<b.length;++a)f.push(b[a]);cmShwEm(f,1)}cmShwEm(new Array(c.all.divIgA));cmShwEm(new Array(c.all.divDdw),1)}function cmPreShwDup(){var a=wda("divScm");showEm(a.all.nSg,1);cmShwEm(a.all.divSg,1);cmShwEm(new Array(a.all.divIgA),1);showEm(a.all.divS1,1);cmShwEm(new Array(a.all.divDdw),0)}function shwCMSp(b,e){var d=getEvtCY(b)+12+gtHdrHgt(),c=getEvtCX(b)+10,a=wda("divScm");a.preShw(e);a.lnks=cmLnks(a);a.show(b,c,d);selWrd(a.word)}function gtHdrHgt(){var a=0,b=$("divBdy");a=getCY(b);return a}function shwCMEd(b){var a=wda("divEcm");showEm(a);var d=getEvtCY(b)+12+gtHdrHgt(),c=getEvtCX(b)+10;a.preShw();a.lnks=cmLnks(a);a.show(b,c,d);a.word.select()}function doCllps(a,b){a.collapse(b);a.select()}function onSelSpl(d,b){if(gtAttrN(b,"_lnk")==0)return;var c=wda("divScm"),a=c.word;if(!a.oR){a.oR=crtTxR();a.oR.moveToElementText(a)}switch(d){case"replace":replW(a,b.all.spnT.innerText);g_sLstSpTx=SP_RESET;drty();break;case"delete":delDupW(a);g_sLstSpTx=SP_RESET;drty();break;case"ignore":igNW(a);break;case"ignoreall":ignrAll(a)}a.oR=null}function onSelEdt(a){doEdCtxM(a,wda("divEcm").word)}function onCMEd(b){var a=edEvt(),f=0;if(a)f=getEvtTgt(edEvt());if(!b.id)b=gtCurWrd(f);var d=wda("divScm"),c=wda("divEcm");if(b&&d){var g=edDoc().body;d.word=b;d.word.fR=0;shwCMSp(a,b)}else if(c){var e=crtSelTxR();if(!e){isDf(typeof a_fCopyRestricted)&&a_fCopyRestricted==1&&canEvt(a);return}c.word=e;c.word.fR=1;shwCMEd(a)}canEvt(a)}function onEdWScr(){if(onEdWScr.caller)return;clsEdCtxMs()}function clsEdCtxMs(){var b=$("divScm"),a=$("divEcm");b&&b.hide&&b.hide();a&&a.hide&&a.hide()}function lstCntns(c){for(var b=arguments.length,a=1;a<b;a++)if(c==arguments[a])return 1}function hndSpK(b){if(g_fLckd)return false;var a=getKeyCode(b),f=isCtrlKD(b),g=a==27?1:0,e=lstCntns(a,8,13,32,46),h=a==46?1:a==8?-1:1,d=a>=48&&a<=90||a>=186&&a<=222;if(!g&&!f&&(e||d)){var c=gtWrd(h,a,b);c&&unmrkW(c)}}var g_SplLng=SP_RESET;function queryStatus(a){return edDoc().queryCommandSupported(a)&&edDoc().queryCommandEnabled(a)?1:0}function doEdCtxM(b,a){a&&a.select();Owa.ExecCommand.execute(edDoc(),b)}function onMUSpl(){var a=getEvt(this);canEvt(a)}function clkSpOK(){g_SplLng=$("divSpl").getExpando("oSpellCheckerComboBox").get_SelectedValue();wda("spellcheck").click()}function clkSpCn(){var a=Owa.UIControls.MenuButton.get_CurrentPopupButton();a&&a.get_Id()=="spellcheckd"&&a.hide()}function dispSp(){var b=$("divSpl");if(b){var a=b.getExpando("oSpellCheckerComboBox");if(a){a.oSpSel=0;a.dispose()}}var c=wda("divScm");c.word=0;dispCtxMnu(c)}!g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()]&&(function(){var b="onChange",a=Owa.Strings.CssClass.ComboDropDownSelectedItem;Owa.UIControls.ComboDropDownList=function Owa$UIControls$ComboDropDownList(d,a,c,b){Owa.UIControls.ComboDropDownList.constructBase(this,[d,a,c]);this._rgListItems=false;this._oComboBox=a;this._iSelectedItemIndex=-1;this._fForceOnChangeHandlers=b};Owa.UIControls.ComboDropDownList.prototype.initialize=function Owa$UIControls$ComboDropDownList$prototype$initialize(){Owa.UIControls.ComboDropDownList.callBase(this,"initialize");this._get_Element().addCssClass("dropDownListMaxHeight");this._initializeItems();this.get_OnPreShow().add(this._createCallback(this._onPreShow));this._attachEvent(this._get_Element(),"click",this._onClick)};Owa.UIControls.ComboDropDownList.prototype.dispose=function Owa$UIControls$ComboDropDownList$prototype$dispose(){this._get_Element().detachAllEvents();for(var a=0;a<this._rgListItems.length;++a)this._rgListItems[a].oDomItem.detachAllEvents();Owa.UIControls.ComboDropDownList.callBase(this,"dispose")};Owa.UIControls.ComboDropDownList.prototype.get_OnChange=function Owa$UIControls$ComboDropDownList$prototype$get_OnChange(){return this._getEventHandlerCollection(b)};Owa.UIControls.ComboDropDownList.prototype._onClick=function Owa$UIControls$ComboDropDownList$prototype$_onClick(a){a.cancelBubble()};Owa.UIControls.ComboDropDownList.prototype._onKeyDown=function Owa$UIControls$ComboDropDownList$prototype$_onKeyDown(a){switch(a.get_KeyCodeForKeyUpDown()){case 9:this.close();break;case 40:this._arrowDown();break;case 38:this._arrowUp();break;case 13:this.close();break;case 36:this.set_SelectedItemIndex(0);break;case 35:this.set_SelectedItemIndex(this._rgListItems.length-1);break;case 34:this._pageDown();break;case 33:this._pageUp();break;default:return}a.cancelBubble()};Owa.UIControls.ComboDropDownList.prototype._onPreShow=function Owa$UIControls$ComboDropDownList$prototype$_onPreShow(){var b=this._oComboBox._get_Element().get_OffsetWidth(),a=this._get_Element(),c=a.get_OffsetHeight()<a.get_ScrollHeight()?20:0;a.set_Width(null);if(a.get_OffsetWidth()+c<b)a.set_Width(b);else a.set_Width(a.get_OffsetWidth()+c);this._ensureVisible()};Owa.UIControls.ComboDropDownList.prototype._onItemClick=function Owa$UIControls$ComboDropDownList$prototype$_onItemClick(c,b){for(var a=0;a<this._rgListItems.length;++a)if(this._rgListItems[a].oDomItem==b){this.set_SelectedItemIndex(a,this._fForceOnChangeHandlers);break}this.close()};Owa.UIControls.ComboDropDownList.prototype._pageDown=function Owa$UIControls$ComboDropDownList$prototype$_pageDown(){var a=this.get_SelectedItemIndex()+this._get_PageSize();if(a>=this._rgListItems.length-1)a=this._rgListItems.length-1;this.set_SelectedItemIndex(a)};Owa.UIControls.ComboDropDownList.prototype._pageUp=function Owa$UIControls$ComboDropDownList$prototype$_pageUp(){var a=this.get_SelectedItemIndex()-this._get_PageSize();if(a<0)a=0;this.set_SelectedItemIndex(a)};Owa.UIControls.ComboDropDownList.prototype._arrowDown=function Owa$UIControls$ComboDropDownList$prototype$_arrowDown(){this.get_SelectedItemIndex()<this._rgListItems.length-1&&this.set_SelectedItemIndex(this.get_SelectedItemIndex()+1)};Owa.UIControls.ComboDropDownList.prototype._arrowUp=function Owa$UIControls$ComboDropDownList$prototype$_arrowUp(){this.get_SelectedItemIndex()>0&&this.set_SelectedItemIndex(this.get_SelectedItemIndex()-1)};Owa.UIControls.ComboDropDownList.prototype.hasValue=function Owa$UIControls$ComboDropDownList$prototype$hasValue(a){return this._getValueIndex(a)>=0};Owa.UIControls.ComboDropDownList.prototype.selectValue=function Owa$UIControls$ComboDropDownList$prototype$selectValue(c,b){var a=this._getValueIndex(c);if(a>=0)this.set_SelectedItemIndex(a,0,b);else throw new Error("value specified for selection not present");};Owa.UIControls.ComboDropDownList.prototype.get_SelectedValue=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedValue(){return this.get_SelectedItemIndex()>=0?this._rgListItems[this.get_SelectedItemIndex()].oValue:undefined};Owa.UIControls.ComboDropDownList.prototype.get_SelectedItem=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedItem(){return this.get_SelectedItemIndex()>=0?this._rgListItems[this.get_SelectedItemIndex()]:undefined};Owa.UIControls.ComboDropDownList.prototype.addItem=function Owa$UIControls$ComboDropDownList$prototype$addItem(d,c){if(this.hasValue(c))throw new Error("value already present in comboBoxList");var a=this._get_Element().get_OwnerDocument().createElement("DIV"),b=this._get_Element().get_OwnerDocument().createElement("SPAN");b.addCssClass("listItm");b.set_TextContent(d);a.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b);this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,a);this._addDomItem(a,c)};Owa.UIControls.ComboDropDownList.prototype.clearItems=function Owa$UIControls$ComboDropDownList$prototype$clearItems(){this.set_SelectedItemIndex(-1);for(var a=0;a<this._rgListItems.length;)this._remove(a)};Owa.UIControls.ComboDropDownList.prototype.getDomItemByIndex=function Owa$UIControls$ComboDropDownList$prototype$getDomItemByIndex(a){if(a<0||a>=this._rgListItems.length)throw new Error("Argument out of range");return this._rgListItems[a].oDomItem};Owa.UIControls.ComboDropDownList.prototype.getValueByIndex=function Owa$UIControls$ComboDropDownList$prototype$getValueByIndex(a){if(a<0||a>=this._rgListItems.length)throw new Error("Argument out of range");return this._rgListItems[a].oValue};Owa.UIControls.ComboDropDownList.prototype.getItemCount=function Owa$UIControls$ComboDropDownList$prototype$getItemCount(){return this._rgListItems.length};Owa.UIControls.ComboDropDownList.prototype.get_SelectedItemIndex=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedItemIndex(){return this._iSelectedItemIndex};Owa.UIControls.ComboDropDownList.prototype.set_SelectedItemIndex=function Owa$UIControls$ComboDropDownList$prototype$set_SelectedItemIndex(c,d,e){if(c==this._iSelectedItemIndex&&!d)return;if(c>=this._rgListItems.length)throw new Error("Argument out of range");this._iSelectedItemIndex>=0&&this._rgListItems[this._iSelectedItemIndex].oDomItem.removeCssClass(a);this._iSelectedItemIndex=c;if(this._iSelectedItemIndex>=0){this._rgListItems[this._iSelectedItemIndex].oDomItem.addCssClass(a);this._ensureVisible()}else{this._iSelectedItemIndex=-1;this._get_Element().set_ScrollTop(0)}!e&&this._dispatchEvent(b,this)};Owa.UIControls.ComboDropDownList.prototype._ensureVisible=function Owa$UIControls$ComboDropDownList$prototype$_ensureVisible(){var a=this._get_Element().get_ScrollHeight()/this._rgListItems.length,b=this._get_Element().get_ScrollTop()/a;if(this._iSelectedItemIndex<b)this._get_Element().set_ScrollTop(this._iSelectedItemIndex*a);else{var c=(this._get_Element().get_ScrollTop()+this._get_Element().get_OffsetHeight())/a-1;this._iSelectedItemIndex>c&&this._get_Element().set_ScrollTop((this._iSelectedItemIndex+1)*a-this._get_Element().get_OffsetHeight())}};Owa.UIControls.ComboDropDownList.prototype._getValueIndex=function Owa$UIControls$ComboDropDownList$prototype$_getValueIndex(b){for(var a=0;a<this._rgListItems.length;++a)if(Owa.Utility.isEqual(this._rgListItems[a].oValue,b))return a;return-1};Owa.UIControls.ComboDropDownList.prototype._remove=function Owa$UIControls$ComboDropDownList$prototype$_remove(a){if(this.get_SelectedItemIndex()==a)this.set_SelectedItemIndex(-1);else if(this.get_SelectedItemIndex()>a)this._iSelectedItemIndex--;this._rgListItems[a].oDomItem.detachAllEvents();this._rgListItems[a].oDomItem.remove(true);this._rgListItems.removeAt(a)};Owa.UIControls.ComboDropDownList.prototype._get_PageSize=function Owa$UIControls$ComboDropDownList$prototype$_get_PageSize(){var a=this._rgListItems.length*this._get_Element().get_OffsetHeight()/this._get_Element().get_ScrollHeight();return new Number(a.toFixed(0))};Owa.UIControls.ComboDropDownList.prototype._initializeItems=function Owa$UIControls$ComboDropDownList$prototype$_initializeItems(){if(this._rgListItems)throw new Error("Invalid operation");this._rgListItems=[];var a=this._get_Element().get_Enumerator();while(a.moveNext()){var b=a.get_Current();this._addDomItem(b,b.getAttribute(Owa.Strings.Attributes.Value))}};Owa.UIControls.ComboDropDownList.prototype._addDomItem=function Owa$UIControls$ComboDropDownList$prototype$_addDomItem(a,b){this._rgListItems.add({oDomItem:a,oValue:b});this._attachEvent(a,"click",this._onItemClick,a)};Owa.UIControls.ComboDropDownList.createClass("Owa.UIControls.ComboDropDownList",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()]&&(function(){var b="onShow",a="onChange";Owa.UIControls.ComboBox=function Owa$UIControls$ComboBox(c,d,b,a){Owa.UIControls.ComboBox.constructBase(this,[c,d]);this._oDropDownList=null;this._oClientAction=null;this._oSelectedValue=null;this._oTextBox=null;this._fSelectedValueCanBeNull=false;this._fDisableOffscreenBox=b;this._fForceOnChangeHandlers=a};Owa.UIControls.ComboBox.prototype.initialize=function Owa$UIControls$ComboBox$prototype$initialize(){this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown);this._initializeDropDown();this._oDropDownList.get_OnDataBind().add(this._createCallback(this._onPreShow));this._oDropDownList.get_OnChange().add(this._createCallback(this._onChange));this._initializeSelection();this.set_IsEnabled(this._getIntAttribute("fEnbld"))};Owa.UIControls.ComboBox.prototype.dispose=function Owa$UIControls$ComboBox$dispose(){this._oDropDownList.dispose();this._oDropDownList=null;Owa.UIControls.ComboBox.prototype._isEditable()&&this._oTextBox.detachAllEvents();Owa.UIControls.ComboBox.callBase(this,"dispose")};Owa.UIControls.ComboBox.prototype.get_OnShow=function Owa$UIControls$ComboBox$prototype$get_OnShow(){return this._getEventHandlerCollection(b)};Owa.UIControls.ComboBox.prototype.get_OnChange=function Owa$UIControls$ComboBox$prototype$get_OnChange(){return this._getEventHandlerCollection(a)};Owa.UIControls.ComboBox.prototype._onChange=function Owa$UIControls$ComboBox$prototype$_onChange(){var a=this._oDropDownList.get_SelectedValue();(isDf(typeof a)&&a!==null||this._fSelectedValueCanBeNull)&&this._selectValue(a)};Owa.UIControls.ComboBox.prototype._onPreShow=function Owa$UIControls$ComboBox$prototype$_onPreShow(){this._oDropDownList.hasValue(this._oSelectedValue)&&this._oDropDownList.selectValue(this._oSelectedValue);this._dispatchEvent(b,this)};Owa.UIControls.ComboBox.prototype._onMouseDown=function Owa$UIControls$ComboBox$prototype$_onMouseDown(a){this.get_IsEnabled()&&a.isLeftButtonDown()&&(!this._isEditable()||this._isEditable()&&!a.get_Target().equals(this._oTextBox))&&this.showDropDown()};Owa.UIControls.ComboBox.prototype._onClick=function Owa$UIControls$ComboBox$prototype$_onClick(a){a.preventDefault()};Owa.UIControls.ComboBox.prototype._onKeyDown=function Owa$UIControls$ComboBox$prototype$_onKeyDown(a){if(this.get_IsEnabled()){this._isEditable()&&a.get_KeyCodeForKeyUpDown()==9&&this.hideDropDown();a.get_KeyCodeForKeyUpDown()==13&&this.showDropDown()}};Owa.UIControls.ComboBox.prototype.get_SelectedValue=function Owa$UIControls$ComboBox$prototype$get_SelectedValue(){return this._oSelectedValue};Owa.UIControls.ComboBox.prototype.set_SelectedValue=function Owa$UIControls$ComboBox$prototype$set_SelectedValue(b,a){this._selectValue(b,a)};Owa.UIControls.ComboBox.prototype.renderValue=function Owa$UIControls$ComboBox$prototype$renderValue(b){var a=this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan);if(Owa.Utility.isIE())a.set_InnerHtmlIEWorkaround(b);else a.set_InnerHtml(b);this._oDropDownList.set_SelectedItemIndex(-1);this._oSelectedValue=null};Owa.UIControls.ComboBox.prototype.get_IsEnabled=function Owa$UIControls$ComboBox$prototype$get_IsEnabled(){return this._getIntAttribute(Owa.Strings.Attributes.IsDisabled)!=1};Owa.UIControls.ComboBox.prototype.set_IsEnabled=function Owa$UIControls$ComboBox$prototype$set_IsEnabled(a){this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,a?0:1);if(a)this._get_Element().removeCssClass(Owa.Strings.CssClass.ComboBoxDisable);else this._get_Element().addCssClass(Owa.Strings.CssClass.ComboBoxDisable)};Owa.UIControls.ComboBox.prototype.showDropDown=function Owa$UIControls$ComboBox$prototype$showDropDown(){this._oDropDownList.showRelative(0,this._get_Element().get_OffsetHeight())};Owa.UIControls.ComboBox.prototype.hideDropDown=function Owa$UIControls$ComboBox$prototype$hideDropDown(){this._oDropDownList.close()};Owa.UIControls.ComboBox.prototype.get_DropDownList=function Owa$UIControls$ComboBox$prototype$get_DropDownList(){return this._oDropDownList};Owa.UIControls.ComboBox.prototype.setWidthAccordingToSelectedValue=function Owa$UIControls$ComboBox$prototype$setWidthAccordingToSelectedValue(){var b=this._getDescendant("spanListItm"),a=b.get_OffsetWidth();a>0&&this._get_Element().set_Width(a+30)};Owa.UIControls.ComboBox.prototype._selectValue=function Owa$UIControls$ComboBox$prototype$_selectValue(b,c){var d=this._oSelectedValue;if(!Owa.Utility.isEqual(d,b)){this._oSelectedValue=b;this._oDropDownList.hasValue(b)&&this._oDropDownList.selectValue(b,c);this._renderSelectedValue()}if(!c&&(this._fForceOnChangeHandlers||!Owa.Utility.isEqual(d,b))){this._dispatchEvent(a,this);this._oClientAction!=null&&this._oClientAction.get_ActionEventHandlers().dispatch({oValue:this._oSelectedValue})}};Owa.UIControls.ComboBox.prototype._renderSelectedValue=function Owa$UIControls$ComboBox$prototype$_renderSelectedValue(){var a=this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan),b=this._oDropDownList.get_SelectedItem().oDomItem.get_InnerHtml();if(Owa.Utility.isIE())a.set_InnerHtmlIEWorkaround(b);else a.set_InnerHtml(b)};Owa.UIControls.ComboBox.prototype._initializeDropDown=function Owa$UIControls$ComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.ComboDropDownList(this._getDescendant(Owa.Strings.Ids.ComboDropDownList),this,this._fDisableOffscreenBox,this._fForceOnChangeHandlers);this._oDropDownList.set_SubPage(this.get_SubPage());this._oDropDownList.initialize()};Owa.UIControls.ComboBox.prototype._initializeSelection=function Owa$UIControls$ComboBox$prototype$_initializeSelection(){var a=this._getAttribute(Owa.Strings.Attributes.Value);if(a)this._oDropDownList.selectValue(a);else this._oDropDownList.getItemCount()>0&&this._oDropDownList.set_SelectedItemIndex(0)};Owa.UIControls.ComboBox.createClass("Owa.UIControls.ComboBox",Owa.UIControls.UIControl);Owa.UIControls.ComboBox.prototype._isEditable=function Owa$UIControls$ComboBox$prototype$_isEditable(){return false}})();g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/spellcheckcombobox.js".toLowerCase()]&&(function(){Owa.UIControls.SpellCheckComboBox=function Owa$UIControls$SpellCheckComboBox(a,b){Owa.UIControls.SpellCheckComboBox.constructBase(this,[a,b])};Owa.UIControls.SpellCheckComboBox.prototype.initialize=function Owa$UIControls$SpellCheckComboDropDownList$prototype$initialize(){Owa.UIControls.SpellCheckComboBox.callBase(this,"initialize");this._oDropDownList.get_OnClose().add(this._createCallback(this._onClose))};Owa.UIControls.SpellCheckComboBox.create=function Owa$UIControls$SpellCheckComboBox$create(b,c){var a=new Owa.UIControls.SpellCheckComboBox(b,c);a.initialize();return a};Owa.UIControls.SpellCheckComboBox.prototype._initializeDropDown=function Owa$UIControls$SpellCheckComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.SpellCheckComboDropDownList(this._getDescendant(Owa.Strings.Ids.ComboDropDownList),this);this._oDropDownList.initialize()};Owa.UIControls.SpellCheckComboBox.prototype.showDropDown=function Owa$UIControls$SpellCheckComboBox$prototype$showDropDown(){this._get_Parent()._suppressClose(false);this._oDropDownList.showRelative(0,this._get_Element().get_OffsetHeight())};Owa.UIControls.SpellCheckComboBox.prototype._onClose=function Owa$UIControls$SpellCheckComboBox$prototype$_onClose(){this._get_Parent()._setTimeout(this._get_Parent()._enableClose,1)};Owa.UIControls.SpellCheckComboBox.createClass("Owa.UIControls.SpellCheckComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/spellcheckcombobox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/spellcheckcombodropdownlist.js".toLowerCase()]&&(function(){var a="onClose";Owa.UIControls.SpellCheckComboDropDownList=function Owa$UIControls$SpellCheckComboDropDownList(b,a){Owa.UIControls.SpellCheckComboDropDownList.constructBase(this,[b,a]);this._containingPopup=a._get_Parent()};Owa.UIControls.SpellCheckComboDropDownList.create=function Owa$UIControls$SpellCheckComboDropDownList$create(b,c){var a=new Owa.UIControls.SpellCheckComboDropDownList(b,c);a.initialize();return a};Owa.UIControls.SpellCheckComboDropDownList.prototype.get_OnClose=function Owa$UIControls$SpellCheckComboDropDownList$prototype$get_OnClose(){return this._getEventHandlerCollection(a)};Owa.UIControls.SpellCheckComboDropDownList.prototype._onItemClick=function Owa$UIControls$SpellCheckComboDropDownList$prototype$_onItemClick(b,c){for(var a=0;a<this._rgListItems.length;++a)if(this._rgListItems[a].oDomItem==c){this.set_SelectedItemIndex(a);break}this._containingPopup._setTimeout(this._containingPopup._enableClose,1);this.close();b.cancelBubble()};Owa.UIControls.SpellCheckComboDropDownList.createClass("Owa.UIControls.SpellCheckComboDropDownList",Owa.UIControls.ComboDropDownList)})();g_fModuleLoaded[".\\uicontrols/spellcheckcombodropdownlist.js".toLowerCase()]=1;function gtMmPar(){var a=getCSVAsStr(CSV_MM_PAR_STR);if(!a){a=getSMimeParameters();setCSVAsStr(CSV_MM_PAR_STR,a)}return a}function getSMimeParameters(){if(!chkMime())return"";var a=[];a.push("SSL:"+(isSSL()?"1":"0"));a.push("Ver:"+gtMmCtrlVer());var b="&smime="+urlEnc(a.join(";"));return b}function gtMmCt(){if(typeof a_fEnbSMm!="undefined"&&!a_fEnbSMm)return null;if(!gtMmCt.oMmCt&&!gtMmCt.initialized){gtMmCt.initialized=true;try{gtMmCt.oMmCt=new ActiveXObject("OwaSMime2.MimeCtlVer")}catch(a){}}return gtMmCt.oMmCt}gtMmCt.oMmCt=null;function isSSL(){return window.document.location.protocol=="https:"}function gtMmCtrlVer(){var a="0.0.0000.0";if(!chkMime())return a;var b=gtMmCt();if(b)try{a=b.VersionString}catch(c){}return a}function chkMime(){return Owa.Utility.isIE()&&Owa.Utility.isWin()&&gtMmCt()}var DLF_URI="?ae=Folder&t=IPF.DocumentLibrary&URL=",RF_W=459,RF_H=582,SMS_W=581,SMS_H=432,ECP_W=500,ECP_H=550,ITTP_MSG=0,ITTP_TXT=1,ITTP_MTG=2,NO_DLG_OPNER="eaf27cfa0a0b4ec9b690cb47f61d53bd";function openEcpChangeCalendarSharingPermissionWin(a){opnWin(getEcpVdir()+"customize/calendarsharing.slab?id="+Owa.Encoder.urlEncode(a),ECP_W,ECP_H)}function openEcpChangeCalendarPublishPermissionWin(a){opnWin(getEcpVdir()+"customize/calendarpublishing.slab?fldID="+Owa.Encoder.urlEncode(a),ECP_W,ECP_H)}function newMail(a,b){newItm(IT_MSG,null,gtCCUrl()+(a?"&fOMF=1":""),null,null,b)}function newCnt(b,a){newItm(IT_CNT,b,"",RF_W,RF_H,a)}function newPdl(b,a){newItm(IT_PDL,b,"",null,null,a)}function newSms(a){newItm(IT_SMS,null,null,SMS_W,SMS_H,a)}function newSmsToCt(a,b){if(b.length>0){var c=a.getSubPageVariable("a_fDir");newMessageOrMeeting(a,ITTP_TXT,b,isDf(typeof c)&&c)}}function opnNwSms(c,b,a){openItm("?ae=Item&t=IPM.Note.Mobile.SMS&a=New&rt=MOBILE&to="+urlEnc(c)+"&nm="+urlEnc(b),null,null,null,null,a)}function newCstm(a,d,c){if(a.get_TagName().toLowerCase()=="div")a=a.getDescendantById("nwCstm");var b=a.getAttribute("_t");b&&newItm(b,d,"",null,null,c)}function newItm(g,b,c,f,e,d){var a="?ae=Item&a=New&t="+g;a+=String.isNullOrEmpty(b)?"":"&fId="+urlEnc(b);a+=c?c:"";openItm(a,0,0,f,e,d)}function opnNwMsg(g,f,a,c,e,d){var b="?ae=Item&t="+(e?IT_APP:IT_MSG)+"&a=New&to="+urlEnc(g)+"&nm="+urlEnc(f);if(a&&a!="")b+="&subject="+urlEnc(a);if(c)b+="&ao="+urlEnc(c);openItm(b,null,null,null,null,d)}function addrBk(){opnWin("?ae=Dialog&t=AddressBook",a_iABW,a_iABH,1,null,null,null,getNavigationPage())}function newMsgToCt(a,b,c){if(b.length>0){var d=isDf(typeof a.getSubPageVariable("a_fDir"))&&a.getSubPageVariable("a_fDir");newMessageOrMeeting(a,c,b,d)}}function newMessageOrMeeting(c,e,f,g){var d=g?"ABDA":"ABCA",b={};b.oCallerSubPage=c;var a=new oeReq(d,"MsgToPeople",b,cbNewMessageOrMeeting);a.addRg("id",f);a.add("it",e);a.send()}function cbNewMessageOrMeeting(a){if(!cbOeh(a))return;openItm(a.sBody,null,null,null,null,a.oCtx.oCallerSubPage)}function openItmRdFm(e,d,b,c){var a="?ae=Item&a=Open&t="+urlEnc(e)+"&id="+urlEnc(d);if(b)a=a+"&email="+urlEnc(b);openItm(a,null,null,RF_W,RF_H,c)}function openItm(d,c,e,g,f,b){var a=opnWin(d+gtMmPar(),g,f,null,c,null,null,b);if(a)try{if(e)a.close();else a.focus()}catch(h){}return a}function opnWin(a,e,d,j,c,x,v,l,m,u,h,y,w){if(!m){if(Owa.Utility.isSafari()&&a.indexOf("?ae=")==0)a=getOwaVdir()+a;a+=a.indexOf("?")>=0?"&":"?";if(l)a+=PARENT_SUBPAGE_ID_ATTR+"="+l.get_SubPageController().get_UniqueId();else a+=PARENT_SUBPAGE_ID_ATTR+"="+Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_UniqueId()}h=h||m;var n=false;if(!e&&!d)n=true;if(!e)e=700;if(!d)d=500;if(j)var t=Math.round((screen.availHeight-d)/2),s=Math.round((screen.availWidth-e)/2);var b,f=Owa.Dom.Window.get_Current();if(c&&f.get_Name()==c){j&&f.moveTo(t,s);!n&&f.resizeTo(e,d);f.navigate(a);b=f._domWindow}else{var p=0;if(x)p=1;var q=1;if(v)q=0;var r=0;if(y)r=1;var o=0;if(w)o=1;var k="toolbar="+r+",location="+o+",directories=0,status="+q+",menubar="+p+",scrollbars=1,resizable=1,width="+e+",height="+d;if(j)k+=",top="+t+",left="+s;if(!c)c=new String(rndm());if(u){var i=gtMstr();if(i&&i.g_winMgr){var g=i.g_winMgr.GetActiveWindow();if(g)try{if(g.dialogArguments)g=g.dialogArguments.opener;b=g.open(a,c,k);if(b){addWM(b);b.opener=window}}catch(z){}}}if(!b)b=sfWinOpn(a,c,k,null,h,true)}return b}function _sfWinOpnPrivate(c,b,d,e,f,g){try{var a;if(f)a=c.open(b,d,e,f);else if(e)a=c.open(b,d,e);else if(d)a=c.open(b,d);else if(b)a=c.open(b);else a=c.open();a&&g&&addWM(a);return a}catch(h){Owa.BrowserErrorHandler.handleNewWindowError(h)}}function sfWinOpn(h,g,e,f,i,c){var b=window;try{if(b.dialogArguments)b=b.dialogArguments.opener}catch(k){throw new Error(NO_DLG_OPNER);}var d=_sfWinOpnPrivate(b,h,g,e,f,c);if(!d&&!i){var a={};a.oWindow=b;a.sUrl=h;a.sName=g;a.sFeatures=e;a.bReplace=f;a.fAddToWinManager=c;var j=new BtnDlg("divPopUpBlockerYesNoDialog",L_PopUpError.format("<br><br>"),null,[L_Yes,L_No],500,Owa.BUTTON_DIALOG_ICON.QUESTION,onClosePopUpBlockerDialog,b,null,null,null,null,a);j.show()}return d}function onClosePopUpBlockerDialog(d,a){if(d==0){var c=_sfWinOpnPrivate(a.oWindow,a.sUrl,a.sName,a.sFeatures,a.bReplace,a.fAddToWinManager);if(!c){var b=new BtnDlg("divPopUpBlockerOKDialog",L_PopUpFinalError.format("<br><br>"),null,[L_OK],500,Owa.BUTTON_DIALOG_ICON.INFORMATION,null,a.oWindow,null,null,null,null,null);b.show()}}}function opnHlp(a){if(!a){try{var c=getViewSubPageControllerByFolderId(a_sLstFID);a=c.getVariable("a_sHlpUrl")}catch(d){}if(!a)return}var b=opnWin(a,a_iHW,a_iHH,1,a_sHWN,1,0,null,true,null,null,1,1);b&&b.focus()}function addWM(b){try{var a=gtMstr();a&&a.g_winMgr.AddWin(b)}catch(c){}}function opnDocItm(d,a,b,e){if(isFldr(a)||isShpSt(a)||isUncSt(a))opnDocFldr(d,0,b,e);else if(isDoc(a)){var c;if(isUnc(a))c="UncDocument";else if(isShp(a))c="SharepointDocument";else return;sfWinOpn("ev.owa?ns="+c+"&ev=GetDoc&URL="+urlEnc(d)+(b?"&id="+urlEnc(b):"")+"&"+a_sCnNm+"="+rtrvUCCk())}}function opnWebRFrm(c,b){if(isDoc(b)){var a;if(isUnc(b))a="unc";else if(isShp(b))a="wss";else return;openItm("WebReadyView.aspx?t="+a+"&URL="+urlEnc(c))}}function opnDocFldr(d,h,f,g){var a=window.parent,e=f?"&id="+urlEnc(f):"",c="";if(isDf(typeof a_sCurUri))c="&prntFId="+(a_sCurUri?urlEnc(a_sCurUri):"");if(g)sfWinOpn(DLF_URI+urlEnc(d));else if(a.nav){var b=a.nvCtx();b.fR=h;b.oC=e;b.sPrntFdrUri=c;a.nav(a.NM_DOC,a.T_DOC,d,b)}else document.location.href=DLF_URI+urlEnc(d)+e+c}function isDoc(a){return(a&16)==16}function isFldr(a){return(a&4)==4||(a&32)==32}function isUnc(a){return(a&2)==2}function isShp(a){return(a&1)==1}function isShpSt(a){return a==1}function isUncSt(a){return a==2}Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/application.js".toLowerCase()]&&(function(){Owa.Components.Application={};var a=null,g=null,h=false,f=null,c={},d=new Owa.Collection.Set;window.onload=Owa$Components$Application$_onWindowLoad;window._fIsWinFocused=false;Owa.Components.Application.get_IsWinLoaded=function Owa$Components$Application$get_IsWinLoaded(){return h};Owa.Components.Application.get_RootSubPage=function Owa$Components$Application$get_RootSubPage(){return a};Owa.Components.Application.set_ActiveSubPage=function Owa$Components$Application$set_ActiveSubPage(a){g=a};Owa.Components.Application.get_ShouldExplicitDisposeResource=function Owa$Components$Application$get_ShouldExplicitDisposeResource(){return a&&(a._fSupportHostSubPages||a._fSupportHostedInSubPage)};function GlobalResourceManager(){GlobalResourceManager.constructBase(this)}GlobalResourceManager.createClass("GlobalResourceManager",Owa.Components.Control);var e;Owa.Components.Application.get_GlobalResourceManager=function Owa$Components$Application$get_GlobalResourceManager(){if(!e)e=new GlobalResourceManager;return e};function Owa$Components$Application$_onWindowLoad(){var a=Owa.Dom.Window.get_Current(),b=a.get_Document();if(Owa.Utility.isIE()){b.attachEvent("focusin",Owa$Components$Application$_onWindowFocus);b.attachEvent("focusout",Owa$Components$Application$_onWindowBlur)}else{f=document.activeElement;a.attachEvent("focus",Owa$Components$Application$_onWindowFocus);a.attachEvent("blur",Owa$Components$Application$_onWindowBlur)}checkScripts()}Owa.Components.Application.start=function Owa$Components$Application$start(){if(Owa.Utility.isIE()&&!Owa.Utility.isActiveXControlSupported())if(Owa.PageHierarchy.getOwaTopWindow().equals(Owa.Dom.Window.get_Current())){Owa.Components.Application.failWithWarning(htmlEnc(L_ActiveXDisabled).format('<a href="logoff.owa">',"</a>"));return}stJS=setJSReady;getLoadedScript();var c=Owa.Dom.Document.get_Current().get_Body();if(!a){var d=c.getAttribute("_PageType");if(c&&d){if(d=="NavigationPage"){stIMEnabFlg();if(!createMasterWindowCookies())return}var e=eval("Owa.Pages."+d);a=new e(c)}else a=new Owa.UIControls.SubPage(c)}Owa.Components.Application.set_ActiveSubPage(a);attachApplicationWiseEventHandlers();if(Owa.Utility.isDefined(typeof createGlobalVariables)){createGlobalVariables(a);createGlobalVariables=null}c.getBoolAttribute("_fIM")&&initIM();a.initialize();Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_IsShown()&&a.fireIsVisibleChanged(true);b&&b.dispatch();gtMstr();Owa.Component.PerfMarkers.initialize()};function getLoadedScript(){for(var a in window.oJS)c[a]=true}function setJSReady(a){c[a]=true;Owa.Components.Application._notifyAllPendingController()}function attachApplicationWiseEventHandlers(){cancelDragDrop();var a=Owa.Dom.Window.get_Current(),b=a.get_Document();a.attachEvent("unload",Owa$Components$Application$_onWindowUnload);a.attachEvent("resize",Owa.Utility.createWindowResizeHandler(a,Owa$Components$Application$_onWindowResize));a.attachEvent("beforeunload",Owa$Components$Application$_onWindowBeforeUnload);b.attachEvent("contextmenu",onEvtCanInpt);b.attachEvent("keydown",Owa$Components$Application$_onKeyDown);Owa.Utility.isFirefox()&&b.attachEvent("keypress",Owa.Components.Application.preventFirefoxDefaultKeyEvent);window.onerror=window$onerror}function cancelDragDrop(){var a=Owa.Dom.Document.get_Current().get_Body();a.attachEvent("dragenter",canEvt);a.attachEvent("dragover",canEvt);a.attachEvent("drop",canEvt);a.attachEvent("dragend",clearDragContext)}function clearDragContext(a){var b=new Owa.Components.Storage.DragDrop(a);b.clear();a.cancelBubble();a.preventDefault()}Owa.Components.Application.preventFirefoxDefaultKeyEvent=function Owa$Components$Application$preventFirefoxDefaultKeyEvent(a){var c=[78,110,114,82,107];if(Owa.Utility.isFirefox()&&a.isCtrlKeyDown())for(var b=1;b<c.length;b++)c[b]==a.get_CharCodeForKeyPress()&&a.preventDefault()};function checkScripts(){for(var b=[],a=0;true;a++){var f=$("_scr"+a);if(f)b.push(f);else break}if(!b.length)return;for(var a=0;a<b.length;a++){var g=b[a];if(!chkScr(g)){setTimeout(checkScripts,50);return}}if(!$("divEOF")){setTimeout(checkScripts,50);return}var c=Owa.Dom.Window.get_Current(),e=c.get_ParentWindow(),d=c.get_FrameElement();if(d&&e)if(e.getGlobalVariable("g_fOwa")&&!d.getAttribute(PARENT_SUBPAGE_ID_ATTR)){setTimeout(checkScripts,50);return}h=true;Owa.Components.Application.start()}function chkScr(c){var a=c._get_DomNode().readyState,b=c.getAttribute("_sid");return!isDf(typeof a)&&isJS(b)?1:(a=="complete"||a=="loaded")&&isJS(b)?1:0}function Owa$Components$Application$_onWindowUnload(){var b=Owa.Dom.Document.get_Current().get_Body();b.getBoolAttribute("_fIM")&&dispIM();isDf(typeof dispRecipContextMenus)&&dispRecipContextMenus();!a.get_IsDisposed()&&a.dispose();Owa.Dom.AjaxRequest.disposeAjaxRequests();removeFromWindowManager();detachApplicationWiseEventHandlers();UniqueIdHashSet.get_Instance().clear();Owa.Dom.Document.dispose();Owa.Dom.Window.dispose()}function detachApplicationWiseEventHandlers(){Owa.Dom.Document.get_Current().get_Body().detachAllEvents();Owa.Dom.Document.get_Current().detachAllEvents();window.onload=window.onunload=window.onbeforeunload=window.onerror=null;Owa.Dom.Window.get_Current().detachAllEvents();for(var b=["onbeforeunload","onafterprint","onerror","onresize","onblur","onload","onscroll","onfocus","onbeforeprint","onunload","onhelp"],a=0;a<b.length;a++)window[b[a]]=null}function Owa$Components$Application$_onWindowBeforeUnload(b){Owa.Component.PerfMarkers.dispose();if(!a.get_IsDisposed())return a.onBeforeUnload(b)}function Owa$Components$Application$_onWindowResize(b){if(!a.get_IsDisposed())return a.fireSizeChanged(b)}function Owa$Components$Application$_onWindowFocus(){window._fIsWinFocused=true}function Owa$Components$Application$_onWindowBlur(){if(!Owa.Utility.isIE()&&document.activeElement!=f){f=document.activeElement;return}window._fIsWinFocused=false}function Owa$Components$Application$_onKeyDown(a){return g.fireKeyDownPageEvent(a)}function window$onerror(b,q,r){annotateFunctions(Owa);try{var f=Owa.Dom.Window.get_Current().get_TopWindow().getGlobalVariable("dialogArguments");if(f&&f.opener){var e=f.opener;e.closeModalDialog&&e.oDivMdlDlgBkgd&&e.closeModalDialog()}b=b.trim();if(Owa.BrowserErrorHandler.isAccessDeny(b)){shwErrDlg(0,L_ErrRfBrws);return true}if(Owa.BrowserErrorHandler.isNoMemoryError(b)){shwErrDlg(0,L_ErrOOM);return true}else if(!a_fSndClntErr)return true;else if(b==NO_DLG_OPNER)b="window.open failed: the opener window of this IE dialog window is closed. Try close this dialog and reopen it";var j="",i="",g="",m=null;if(arguments.caller){var c=arguments.caller.callee,h=0;while(c&&h<20){var d=c.toString(),a=c.sFnNm;if(!a)a=getFunctionName(c);a+=d.substring(d.indexOf("("),d.indexOf(")")+1);if(h==0)m="\n"+a;else g+="\n";g+="\n"+a;var o=d.indexOf("(")+1,n=d.indexOf(")"),p=expArgs(d.substring(o,n),c.arguments);j+=htmlEnc(a)+"\r\n";i+=htmlEnc(a)+p+"\r\n";c=c.caller;++h}}var l="";if(window.event)for(var k in event)l+="\r\n\t"+k.toString()+" = "+event[k];Owa.Components.Application.handleClientError(b,q,r,null,m,g,j,i,l)}catch(s){window.status=s.message}return true}Owa.Components.Application.handleClientError=function Owa$Components$Application$handleClientError(g,e,d,h,j,c,b,f,i){if(!a_fSndClntErr)return;try{var a={};a.sMsg=g;a.sLn=d!=null?d:"";a.sCS=c!=null?c:"";a.sFn=j!=null?j:"";if(e==null)e=window.location.href;if(b==null&&c!=null)b=htmlEnc(c);a.sBdy="Client Information\n------------------\nUser Agent: "+htmlEnc(navigator.userAgent)+"\nCPU Class: "+htmlEnc(navigator.cpuClass)+"\nPlatform: "+htmlEnc(navigator.platform)+"\nSystem Language: "+htmlEnc(navigator.systemLanguage)+"\nUser Language: "+htmlEnc(navigator.userLanguage?navigator.userLanguage:navigator.language)+"\nCookieEnabled: "+htmlEnc(navigator.cookieEnabled)+"\nException Details\n-----------------\nDate: "+new Date+"\nMessage: "+htmlEnc(g);a.sBdy+="\nUrl: "+htmlEnc(e);if(d!=null)a.sBdy+="\nLine: "+d;if(h!=null)a.sBdy+="\nPosition: "+h;if(b!=null)a.sBdy+="\n\nCall Stack\n----------\n"+b+"\n\n";if(f!=null)a.sBdy+="Detailed Call Stack\n-------------------\n"+f;if(i!=null)a.sBdy+="\n\nDump Event\n----------"+i;var k=shwErrDlg(0,L_ScptErr,0,L_ScptErrDtls,htmlEnc(a.sBdy),a,0)}catch(l){window.status=l.message}};function expArgs(b,d){var c=b.split(",");b="";if(c[0])for(var a=0;a<c.length;a++){b+="\r\n\t";var e=d[a];b+=c[a].trim()+" = "+getStringForValue(e,true)}for(var a=c.length;a<d.length;a++)b+="\r\n\targuments["+a+"] = "+getStringForValue(d[a],true);return b}function getStringForValue(a,f){if(a===null)return"null";else if(a===undefined)return"undefined";var e=typeof a;if(e=="string")return"'"+a+"'";else if(e=="function")return"["+getFunctionName(a)+"]";else if(e=="object"){var d="[object]";if(!f)return d;for(var c in a){if(c=="outerText"||c=="innerText"||c=="innerHTML")continue;var b;try{b=getStringForValue(a[c],false)}catch(g){b="error: ["+g.message+"]"}if(c=="outerHTML"&&b.length>500)b=b.substring(0,500)+"[...]";d+="\r\n\t\t"+c+" = "+b}return d}else return a}function getFunctionName(c){var a=c.toString(),b=a.indexOf("(");return b<9?"anonymous":a.substring(9,a.indexOf("("))}function annotateFunctions(d,b){try{if(!b)b="Owa.";for(var c in d){var a=d[c];if(typeof a=="function"){if(!a.sFnNm)a.sFnNm=b+c;a.prototype&&annotateFunctions(a.prototype,a.sFnNm+".")}else typeof a=="object"&&annotateFunctions(a,b+c+".")}}catch(e){}}Owa.Components.Application.loadExternalScript=function Owa$Components$Application$loadExternalScript(b){for(var a=0;a<b.length;a++){var f=getFileName(b[a]);if(!c[f]){var e=document.getElementsByTagName("head")[0]||document.documentElement,d=document.createElement("SCRIPT");d.type="text/javascript";d.src=b[a];e.insertBefore(d,e.firstChild)}}};Owa.Components.Application.failWithWarning=function Owa$Components$Application$failWithWarning(a){Owa.Dom.Document.get_Current().get_Body().set_InnerHtml('<body class="err"><table class="errDesc"><tr><td style="width:1%; vertical-align:top; padding-top:7px;">'+Owa.Components.CssSprites.getImageMarkup("bdi_wrn.gif")+'</td><td id="errMsg">'+a+'</td></tr></table><hr class="line" size="2"></body>')};Owa.Components.Application.isScriptLoaded=function Owa$Components$Application$isScriptLoaded(a){return!!c[getFileName(a)]};function getFileName(b){var a=b.split("/");return a[a.length-1]}Owa.Components.Application._notifyAllPendingController=function Owa$Components$Application$_notifyAllPendingController(){for(var b=d.toArray(),a=0;a<b.length;a++)b[a].notifyScriptReady()};Owa.Components.Application.addPendingController=function Owa$Components$Application$addPendingController(a){d.add(a)};Owa.Components.Application.removePendingController=function Owa$Components$Application$removePendingController(a){d.remove(a)};var b;Owa.Components.Application.get_OnApplicationStart=function Owa$Components$Application$get_OnApplicationStart(){if(!b)b=new Owa.Utility.EventHandlerCollection;return b}})();g_fModuleLoaded[".\\components/application.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/hotkeymanager.js".toLowerCase()]&&(function(){Owa.Components.HotKeyManager=function Owa$Components$HotKeyManager(b,a){Owa.Components.HotKeyManager.constructBase(this);this._fEnabled=true;this._oHotKeyTable={};this._oActionTable=b;this._oFallbackHotkeyManager=a};var a=Owa.Components.HotKeyManager.prototype;a.addHotKey=function Owa$Components$HotKeyManager$addHotKey(g,d,c,e){var b=Owa.Components.HotKey.createFromKeyStroke(g,d,c,e);this._insertHotKey(b);var a=b.get_oKeyPart();if(Owa.Utility.isMac()&&a.iCtrl&&!a.iMacCtrl){var f={iCtrl:0,iShift:a.iShift,iAlt:a.iAlt,iMacCtrl:1,iKey:a.iKey};b=new Owa.Components.HotKey(f,d,c);this._insertHotKey(b)}return this};a.dispose=function Owa$Components$HotKeyManager$dispose(){this._oHotKeyTable=null;this._oActionTable=null;this._oFallbackHotkeyManager=null;Owa.Components.HotKeyManager.callBase(this,"dispose")};a.set_Enabled=function Owa$Components$HotKeyManager$set_Enabled(a){this._fEnabled=a};a._insertHotKey=function Owa$Components$HotKeyManager$_insertHotKey(a){var b=calculateHashFromKey(a);this._oHotKeyTable[b]=a;var d=this,c=this._oActionTable.getAction(a.get_Command());c.get_StateChangeEventHandlers().add(function(a){d._oHotKeyTable[b].set_IsEnabled(a.fEnabled)})};a._onKeyDown=function Owa$Components$HotKeyManager$_onKeyDown(a){if(!this._fEnabled)return;var d=isInpt(a.get_Target());if(this._fHookOnDocumentDueToNonFocusableTarget&&(d&&!this._oTargetNode.contains(a.get_Target())))return;var e=calculateHashFromEvent(a),b=this._oHotKeyTable[e];if(b){if(b.get_IngoreEventFromInput()&&d)return;if(b.get_IngoreEventFromExternalFrame()&&!Owa.Dom.Document.get_Current().contains(a.get_Target()))return;var c=false;if(b.get_IsEnabled())c=this._oActionTable.getAction(b.get_Command()).triggerAction(a.get_Target(),a,true);if(!c){a.preventDefault();a.cancelBubble()}}else this._oFallbackHotkeyManager&&this._oFallbackHotkeyManager._onKeyDown(a)};function calculateHashFromKey(b){var a=b.get_oKeyPart();return computeHash(a.iCtrl,a.iAlt,a.iShift,a.iMacCtrl,a.iKey)}function calculateHashFromEvent(a){return computeHash(a.isCtrlKeyDown()?1:0,a.isAltKeyDown()?1:0,a.isShiftKeyDown()?1:0,a.isMacCtrlKeyDown()?1:0,a.get_KeyCodeForKeyUpDown())}function computeHash(c,d,b,a,e){return getInt(e.toString()+c+d+b+a)}Owa.Components.HotKeyManager.createClass("Owa.Components.HotKeyManager",Owa.Components.Control)})();g_fModuleLoaded[".\\components/hotkeymanager.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/hotkeymanagerpage.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");Owa.Components.HotKeyManagerPage=function Owa$Components$HotKeyManagerPage(b,c,a){Owa.Components.HotKeyManagerPage.constructBase(this,[b,a]);c.get_KeyDownPage().add(this._createCallback(this._onKeyDown))};Owa.Components.HotKeyManagerPage.createClass("Owa.Components.HotKeyManagerPage",Owa.Components.HotKeyManager)})();g_fModuleLoaded[".\\components/hotkeymanagerpage.js".toLowerCase()]=1;Type.createNamespace("Owa.UIControls");var VARIABLE_SCOPE_GLOBAL=1,VARIABLE_SCOPE_SUBPAGE=2;!g_fModuleLoaded[".\\uicontrols/subpage.js".toLowerCase()]&&(function(){var c;Owa.UIControls.SubPage=function Owa$UIControls$SubPage(a){Owa.UIControls.SubPage.constructBase(this,[a]);if(!this._fSupportHostSubPages&&!this._fSupportHostedInSubPage)c=this;this._fIsActivate=false;this._oSubPageVariable={};this._rgSubPageVariableScope={};this.sTypeName=a.getAttribute("_PageType");Owa.Components.Application.get_GlobalResourceManager().addResource(this);if(!this.sTypeName)this.sTypeName="SubPage";this._oClientActionTable=new Owa.Components.ClientActionTable(Owa.Utility.createDelegate(this,this._onUserAction));this._oHotKeyManager=new Owa.Components.HotKeyManagerPage(this._oClientActionTable,this);this._fCloseOnEsc=true};var a=Owa.UIControls.SubPage.prototype;a._fSupportUniqueId=true;a._fSupportHostedInSubPage=false;a._fSupportHostSubPages=false;a.initialize=function Owa$UIControls$SubPage$initialize(){Owa.UIControls.SubPage.callBase(this,"initialize");isDf(typeof onWL)&&onWL&&!window._wl&&onWL();if(this._fSupportHostedInSubPage){eval("var createGlobalVariables = null;");var b=this._get_Element().getChildById("divVariableDeclarations");if(b){var a=b.get_InnerHtml(),c=a.indexOf("{"),d=a.lastIndexOf("}");eval(a.substring(c+1,d))}createGlobalVariables&&createGlobalVariables(this)}this._get_Element().attachEvent("mousedown",this._createCallback(this._onMouseDown));this._initializeHotkeys();g_iLastServerActivityTime=Owa.Utility.getRootOwaWindow().getGlobalVariable("g_iLastServerActivityTime");window._wl=1};a.dispose=function Owa$UIControls$SubPage$dispose(){isDf(typeof unload)&&unload&&unload();this._oHotKeyManager.dispose();this._oHotKeyManager=null;this._oClientActionTable=null;this._clearEventCollections();Owa.UIControls.SubPage.callBase(this,"dispose")};a.fireIsVisibleChanged=function Owa$UIControls$SubPage$fireIsVisibleChanged(c){Owa.UIControls.SubPage.callBase(this,"fireIsVisibleChanged",[c]);for(var e=this.get_SubPageController(),b=e.get_ChildrenControllers(),a=0;a<b.length;a++){var d=b[a].get_SubPage();d&&b[a].get_IsShown(false)&&d.fireIsVisibleChanged(c)}};a.fireSizeChanged=function Owa$UIControls$SubPage$fireSizeChanged(d){if(!this.get_IsShown(true))return;Owa.UIControls.SubPage.callBase(this,"fireSizeChanged",[d]);for(var e=this.get_SubPageController(),b=e.get_ChildrenControllers(),a=0;a<b.length;a++){var c=b[a].get_SubPage();c&&Owa.UIControls.DivSubPageController.isInstance(b[a])&&c.fireSizeChanged(d)}};a.fireKeyDownPageEvent=function Owa$UIControls$SubPage$fireKeyDownPageEvent(a){this.onKeyDown(a);this._dispatchEvent(b,a)};a.activate=function Owa$UIControls$SubPage$activate(){Owa.Components.Application.set_ActiveSubPage(this);this._fIsActivate=true};a.deactivate=function Owa$UIControls$SubPage$deactivate(){this._fIsActivate=false};a.get_IsShown=function Owa$UIControls$SubPage$get_IsShown(a){return this.__fDisposed?false:this.get_SubPageController().get_IsShown(a)};a.get_SubPageController=function Owa$UIControls$SubPage$get_SubPageController(){return Owa.Components.SubPageControllerFactory.getControllerByElement(this._get_Element())};a.onBeforeUnload=function Owa$UIControls$SubPage$onBeforeUnload(){};a.onKeyDown=function Owa$UIControls$SubPage$onKeyDown(){};a._onUserAction=function Owa$UIControls$SubPage$_onUserAction(b){switch(b){case"new":this._onNewItem();break;case"close":var a=this.get_ParentSubPage();if(a)a.get_ActionTable().getAction("close").triggerAction();else this._fCloseOnEsc&&Owa.Dom.Window.get_Current().close()}};a._onNewItem=function Owa$UIControls$SubPage$_onNewItem(){};a._initializeHotkeys=function Owa$UIControls$SubPage$_initializeHotkeys(){this.addHk(L_HKBrwsRfrsh,"disabledAction");this.addHk(L_HkSv,"disabledAction");this.get_HotKeyManager().addHotKey(L_HkSel,"disabledAction",true,true);this.get_HotKeyManager().addHotKey(Owa.KeyCodes.BACK_SPACE.toString(),"disabledAction",true);this.addHk(L_HkNew,"new");this.addHk("27","close")};a.get_ActionTable=function Owa$UIControls$SubPage$get_ActionTable(){return this._oClientActionTable};a.get_HotKeyManager=function Owa$UIControls$SubPage$get_HotKeyManager(){return this._oHotKeyManager};a.addHk=function Owa$UIControls$SubPage$addHk(b,a){this.get_HotKeyManager().addHotKey(b,a)};a.declareSubPageVariable=function Owa$UIControls$SubPage$declareSubPageVariable(a,c,b){if(!this._fSupportHostedInSubPage||b==VARIABLE_SCOPE_GLOBAL)window[a]=c;else{this._rgSubPageVariableScope[a]=b;this.setSubPageVariable(a,c)}};a.invokeSubPageFunction=function Owa$UIControls$SubPage$invokeSubPageFunction(a,b){return typeof this[a]==Type.Const.Function?Owa.Dom.Window.get_Current().invokeFunction(a,b,this):typeof window[a]==Type.Const.Function?Owa.Dom.Window.get_Current().invokeFunction(a,b):void 0};a.isSubPageFunctionExists=function Owa$UIControls$SubPage$isSubPageFunctionExists(a){return typeof this[a]==Type.Const.Function?true:typeof Owa.Dom.Window.get_Current().getGlobalVariable(a)==Type.Const.Function};a.setSubPageVariable=function Owa$UIControls$SubPage$setSubPageVariable(a,b){if(this._fSupportHostedInSubPage){var c=this._rgSubPageVariableScope[a];if(typeof c=="undefined"||c==VARIABLE_SCOPE_GLOBAL)window[a]=b;else this._oSubPageVariable[a]=b}else window[a]=b};a.getSubPageVariable=function Owa$UIControls$SubPage$getSubPageVariable(a){if(this._fSupportHostedInSubPage){var b=this._rgSubPageVariableScope[a];return typeof b=="undefined"||b==VARIABLE_SCOPE_GLOBAL?window[a]:this._oSubPageVariable[a]}else return window[a]};a.get_ActionHandler=function Owa$UIControls$SubPage$get_ActionHandler(){if(!this._cbActionHandler)this._cbActionHandler=Owa.Utility.createDelegate(this,this._onUserAction);return this._cbActionHandler};a.get_SubPage=function Owa$UIControls$SubPage$get_SubPage(){return this};a.get_ParentSubPage=function Owa$UIControls$SubPage$get_ParentSubPage(){var a=this.get_SubPageController().get_ParentController();return a&&a.get_SubPage()};a._onMouseDown=function Owa$UIControls$SubPage$_onMouseDown(a){Owa.Components.Application.set_ActiveSubPage(this);a.cancelBubble()};Owa.UIControls.SubPage.get_Instance=function Owa$UIControls$SubPage$get_Instance(){return c};var b="KeyDownPage";a.get_KeyDownPage=function Owa$UIControls$SubPage$get_KeyDownPage(){return this._getEventHandlerCollection(b)};Owa.UIControls.SubPage.createClass("Owa.UIControls.SubPage",Owa.UIControls.UIControlBase)})();g_fModuleLoaded[".\\uicontrols/subpage.js".toLowerCase()]=1;var g_oFormatCombobox=null;!g_fModuleLoaded[".\\components/formutility.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Pages");Owa.Pages.FormSubPage=function Owa$Pages$FormSubPage(b,a){this._fCompose=a;Owa.Pages.FormSubPage.constructBase(this,[b])};var a=Owa.Pages.FormSubPage.prototype;a.initialize=function Owa$Pages$FormSubPage$initialize(){Owa.Pages.FormSubPage.callBase(this,"initialize");var d=Owa.Dom.Document.get_Current();this._oTxtBdy=this._getDescendant("txtBdy");this._oDivBdy=this._getDescendant("divBdy");this._oIfBdy=this._getDescendant("ifBdy");this._oTxtBdy&&this._oDivBdy&&this._oDivBdy.appendChild(this._oTxtBdy);Owa.Components.ToolbarCollection.get(this.get_SubPage()).addToolbars(["divTB"],this.get_ActionTable());this._getDescendant("aRqRcpt")&&this._attachEvent(this._getDescendant("aRqRcpt"),"click",this.sndRR);var e=d.get_Body();e.attachEvent("scroll",this._createCallback(this.fireSizeChanged));var f=this.get_SubPage();this._initializeAttachmentWell();(this._oIfBdy||this._oTxtBdy)&&this._initializeItemBody();for(var c=this._get_IsNextPrevEnabled(),b=[this.get_ActionTable().getAction("next"),this.get_ActionTable().getAction("previous")],a=0;a<b.length;a++)b[a].set_Enabled(c)};a._get_IsNextPrevEnabled=function Owa$Pages$FormSubPage$_get_IsNextPrevEnabled(){try{var a=this.get_SubPageController().get_OpenerController();if(a){var b=Owa.PageHierarchy.getVirtualListViewFromSubPageController(a);if(b&&!b.isCnvVw())return true}return false}catch(c){return false}};a._get_ContentBody=function Owa$Pages$FormSubPage$_get_ContentBody(){return this._oTxtBdy?this._oTxtBdy.get_Value():"<html><body></body></html>"};a._initializeItemBody=function Owa$Pages$FormSubPage$_initializeItemBody(){!this._oIfBdy&&this._oTxtBdy.set_IsShown(true);this._setTimeout(this.onResize,10)};a.get_IsTextBody=function Owa$Pages$FormSubPage$get_IsTextBody(){return this.getSubPageVariable("a_fTxt")};a.get_IsCopyRestricted=function Owa$Pages$FormSubPage$get_IsCopyRestricted(){return this.getSubPageVariable("a_fCopyRestricted")};a.get_ItemId=function Owa$Pages$FormSubPage$get_ItemId(){return this.getSubPageVariable("a_sId")};a.set_ItemId=function Owa$Pages$FormSubPage$set_ItemId(a){return this.setSubPageVariable("a_sId",a)};a.get_ItemClassName=function Owa$Pages$FormSubPage$get_ItemClassName(){return this.getSubPageVariable("a_sT")};a.get_CurrentStoreObjectType=function Owa$Pages$FormSubPage$get_CurrentStoreObjectType(){return this.getSubPageVariable("a_iT")};a.get_IsPublicItem=function Owa$Pages$FormSubPage$get_IsPublicItem(){return this.getSubPageVariable("a_fP")};a.get_TargetFolderId=function Owa$Pages$FormSubPage$get_TargetFolderId(){return this.getSubPageVariable("a_sFldId")};a.get_FolderId=function Owa$Pages$FormSubPage$get_FolderId(){return this.getSubPageVariable("a_sFId")};a.get_ChangeKey=function Owa$Pages$FormSubPage$get_ChangeKey(){return this.getSubPageVariable("a_sCK")};a.set_ChangeKey=function Owa$Pages$FormSubPage$set_ChangeKey(a){return this.setSubPageVariable("a_sCK",a)};a.get_FlagAction=function Owa$Pages$FormSubPage$get_FlagAction(){return this.getSubPageVariable("a_iFlgAction")};a.set_FlagAction=function Owa$Pages$FormSubPage$set_FlagAction(a){return this.setSubPageVariable("a_iFlgAction",a)};a.get_Categories=function Owa$Pages$FormSubPage$get_Categories(){return this.getSubPageVariable("a_rgCats")};a.set_Categories=function Owa$Pages$FormSubPage$set_Categories(a){return this.setSubPageVariable("a_rgCats",a)};a.get_utRecipientWellPresence=function Owa$Pages$FormSubPage$get_utRecipientWellPresence(a){if(!this._utRecipientWellPresence&&a)this._utRecipientWellPresence=new Owa.IM.UriTable;return this._utRecipientWellPresence};a.get_utQueryPresence=function Owa$Pages$FormSubPage$get_utQueryPresence(a){if(!this._utQueryPresence&&a)this._utQueryPresence=new Owa.IM.UriTable;return this._utQueryPresence};a.get_IsInDeletedItems=function Owa$Components$FormSubPage$get_IsInDeletedItems(){return this.getSubPageVariable("a_fInDelItms")};a.get_CanDelete=function Owa$Components$FormSubPage$get_CanDelete(){return this.getSubPageVariable("a_fCD")};a.sndRR=function Owa$Pages$FormSubPage$sndRR(){var a=new oeReq("ReadMessage","SRR",0,this._createCallback(this.cbSndRR));a.add("Id",this.get_ItemId());a.send()};a.cbSndRR=function Owa$Pages$FormSubPage$cbSndRR(a){if(this.get_IsDisposed())return;if(!cbOeh(a))return;this._getDescendant("divSRR").set_InnerHtml(a.sBody)};a._initializeIFrameBody=function Owa$Pages$FormSubPage$_initializeIFrameBody(a,b){a.set_IsRtl(g_fRtl);!b.getBoolAttribute("ocsi")&&apBdyStl(a,null,this.get_SubPage());this.fireSizeChanged();Owa.Utility.isFirefox()&&a.attachEvent("keypress",Owa.Components.Application.preventFirefoxDefaultKeyEvent)};a.dispose=function Owa$Pages$FormSubPage$dispose(){Owa.Components.ToolbarCollection.get(this.get_SubPage()).dispose();this._disposeAttachmentWell();(this._oIfBdy||this._oTxtBdy)&&this._disposeContentBody(this._fCompose);var a=Owa.Dom.Document.get_Current(),b=a.get_Body();b.detachEvent("scroll",this._createCallback(this.fireSizeChanged));this._utRecipientWellPresence=null;this._utQueryPresence=null;this._oTxtBdy=null;this._oDivBdy=null;this._oIfBdy=null;Owa.Pages.FormSubPage.callBase(this,"dispose")};a._disposeContentBody=function Owa$Pages$FormSubPage$_disposeContentBody(){if(this._oIFrameBodyHotkeyManager){try{this._oIFrameBodyHotkeyManager.dispose()}catch(c){}this._oIFrameBodyHotkeyManager=null}if(this._oIfBdy&&this._oIfBdy.get_ContentWindow()){var a=this._oIfBdy.get_ContentDocument();if(a){var b=a.get_Body();a.detachAllEvents();b.detachAllEvents()}}};a._disposeAttachmentWell=function Owa$Pages$FormSubPage$_disposeAttachmentWell(){var a=this._getDescendant("divAtch");if(!a)return;var b=a.getBoolAttribute("_isRW");a.dispose();if(!b)return;Owa.Utility.isSafari()&&Owa.Dom.Document.get_Current().detachEvent("keydown",onKeyDownAw)};a.onResize=function Owa$Pages$FormSubPage$onResize(){Owa.Pages.FormSubPage.callBase(this,"onResize");this._resizeBodiesInternal()};a.safeResizeBodies=function Owa$Pages$FormSubPage$safeResizeBodies(){if(this.get_IsShown(true))this._resizeBodiesInternal();else this._fPendingResizeBodies=1};a.safeResizeWells=function Owa$Pages$FormSubPage$safeResizeWells(){if(this.get_IsShown(true))this._resizeWellsInternal();else this._fPendingResizeWells=1};a.onIsVisibleChanged=function Owa$Pages$FormSubPage$onIsVisibleChanged(a){Owa.Pages.FormSubPage.callBase(this,"onIsVisibleChanged",[a]);if(a){this._fPendingResizeBodies&&this._resizeBodiesInternal();this._fPendingResizeWells&&this._resizeWellsInternal()}};a.onKeyDown=function Owa$Components$FormSubPage$onKeyDown(a){if(a.get_KeyCodeForKeyUpDown()==Owa.KeyCodes.TAB){var b=a.get_Target().get_Id();if(a.isShiftKeyDown()){if(b=="send"||b=="saveclose"){a.cancelBubble();a.preventDefault()}}else if(b=="txtBdy"&&!Owa.Utility.isIE()){a.cancelBubble();a.preventDefault()}else if(this._isEditorTabAfterSubject&&this._isEditorTabAfterSubject()&&b=="txtSubj"&&Owa.Utility.isSafari()){a.cancelBubble();a.preventDefault();setFcsBdy(0,this.get_SubPage())}}};a._onUserAction=function Owa$Pages$FormSubPage$_onUserAction(b,a){switch(b){case"close":window.close();break;case"delete":delItm();break;case"flag":this.showFlagMenu();break;case"cat":this._showCategoryMenu();break;case BID_MV:var c=this.get_SubPage();shwCMMnu(c,Owa.Utility.createDelegate(this,this._cbCopyMove));break;case"help":opnHlp(a.getAttribute("href"));break;default:Owa.Pages.FormSubPage.callBase(this,"_onUserAction",[b,a])}};a._replyForwardItem=function Owa$Pages$FormSubPage$_replyForwardItem(d,b,c,a){return openItm("?ae=PreFormAction&a="+b+"&t="+d+"&"+getIdQS(this.get_SubPage())+(a?a:""),c?0:window.name)};a._cbCopyMove=function Owa$Pages$FormSubPage$_cbCopyMove(a,d,c,b){if(!isMvAllw(c,this.get_ItemClassName())){alrt(L_MvUnmtchTyp);return}if(!b&&a==this.get_FolderId()){window.close();return}g_oFldrMgr.cpMvItms(wt(),this.get_SubPage(),this.get_FolderId(),[this.get_ItemId()],a,b)};var c=400;a._fLMDC=0;a._oDlgMDtl=0;a._loadMessageDetail=function Owa$Pages$FormSubPage$_loadMessageDetail(){if(this._fLMDC)return;if(!this._oDlgMDtl){this._fLMDC=1;this._loadMessageDetailDialog();return}this._showMessageDetailDialog()};a._loadMessageDetailDialog=function Owa$Pages$FormSubPage$_loadMessageDetailDialog(){var a=new oeReq("ReadMessage","LMD",0,this._createCallback(this._cbLoadMessageDetailDialog),GET);a.add("Id",getIdQS(this.get_SubPage()));a.send()};a._cbLoadMessageDetailDialog=function Owa$Pages$FormSubPage$_cbLoadMessageDetailDialog(b){if(!cbOeh(b))return;var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_IsShown(false);a.set_InnerHtml(b.sBody);var d=a.getDescendantById("divMDtlTitle").get_TextContent();this._oDlgMDtl=this.addResource(new BtnDlg("divMDtl",a.get_InnerHtml(),d,new Array(L_Cls),c,null,null,null,0,1));a.remove(true);this._showMessageDetailDialog();this._fLMDC=0};a._showMessageDetailDialog=function Owa$Pages$FormSubPage$_showMessageDetailDialog(){var a=this._oDlgMDtl._getDescendant("divSctBdy"),e=this._oDlgMDtl._getDescendant("txtMailHdrs"),f=250,b=15,d=f-a._get_OffsetTop();if(d<b)d=b;a.set_Height(d);e.set_Height(a.get_Height()-b);e.set_Width(c-100);this._oDlgMDtl.show()};a.refreshVirtualListView=function Owa$Pages$FormSubPage$refreshVirtualListView(b){try{var a=this.get_SubPageController().get_OpenerController();if(a&&!a.get_SubPage().isSubPageFunctionExists("ref")&&!a.get_SubPage().isSubPageFunctionExists("udRP"))a=a.get_ParentController();if(a){a.invokeFunction("ref");!b&&a.invokeFunction("udRP",[1])}}catch(c){}};if(isDf(typeof _resizeBodiesInternal))a._resizeBodiesInternal=_resizeBodiesInternal;if(isDf(typeof _adjustMessageBody))a._adjustMessageBody=_adjustMessageBody;a._initAttachmentDeleteLinks=function Owa$Pages$FormSubPage$_initAttachmentDeleteLinks(d){for(var b=d.getAllDescendantsById("delImg"),a=0;a<b.length;a++){var c=b[a];c.attachEvent("click",this.onClickAttachmentDelete)}};a.onClickAttachmentDelete=function Owa$Components$FormSubPage$onClickAttachmentDelete(a){var c=a.get_Target(),b=c.get_ParentElement().get_ParentElement();dltAtt(b);a.cancelBubble();a.preventDefault()};a.SL_HasInlineImages=function Owa$Pages$FormSubPage$SL_HasInlineImages(){return!!this.getSubPageVariable("a_fHasInlineImages")};a._initializeAttachmentWell=function Owa$Pages$FormSubPage$_initializeAttachmentWell(){var a=this._getDescendant("divAtch");if(!a)return;this._attachEvent(a,"contextmenu",this.onCtxAtch);if(!a.getBoolAttribute("_isRW"))return;if(a.getBoolAttribute("_isEventAttach")){if(Owa.Utility.isSafari()){Owa.Dom.Document.get_Current().attachEvent("keydown",onKeyDownAw);Owa.Dom.Document.get_Current().attachEvent("click",onAwBlur)}else a.attachEvent("keydown",onKeyDownAw);this._attachEvent(a,"resize",this.safeResizeBodies);a.attachEvent("click",onClickAw);a.attachEvent("dblclick",onDblClickAw);this._initAttachmentDeleteLinks(a)}if(!chkMime()){var b={};b.oCallerSubPage=this;a.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,b));a.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,b));initDE(a)}this.resizeAttachmentWell()};a.onCtxAtch=function Owa$Pages$FormSubPage$onCtxAtch(d){var a=d.get_Target();if(a&&a.get_Id()=="lnkAtmt"){var b=a.get_ParentElement();if(b!=null){var c=b.getAttribute("_url");if(c)a.setAttribute("href",c);else!b.getAttribute("_idx")&&a.setAttribute("href",gtAttUrl(b,null,this.get_SubPage()))}}};a.resizeAttachmentWell=function Owa$Pages$FormSubPage$resizeAttachmentWell(){var i=this._getDescendant("divAtch");if(!i)return;var d=this._getDescendant("divAttachHr"),c=this._getDescendant("divWellAttach"),g=false,f=this._getDescendant("divAttachL");if(f)g=f.getBoolAttribute(Owa.Layout.fIsResized);var b=false,e=false,a=i.hasChildNodes();if(d){b=d.get_IsShown()!=a;b&&d.set_IsShown(a)}if(c){var h=c.get_IsShown();b=h!=a;e=!h&&a&&!g;b&&c.set_IsShown(a)}b&&this.safeResizeBodies();return e};a.showFlagMenu=function Owa$Pages$FormSubPage$showFlagMenu(){var a=Owa.UIControls.FlagContextMenu.get_Instance(true);a.set_SelectCount(1);a.set_ItemId(this.get_ItemId());a.set_IsSelectedItemTask(false);a.get_OnSelectFlag().add(this._createCallback(this._flagItem));this.get_FlagAction()&&a.set_FlagAction(this.get_FlagAction());var b=Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("flag");a.set_FlagButton(b);a.showUnder(b._get_ButtonFrame())};a._flagItem=function Owa$Pages$FormSubPage$_flagItem(c){addPerfMarker("FlgItm.Start");var e=c.sCommand,d=c.dtDate,b=getInt(e),f=Owa.UIControls.SubPage.get_Instance();if(b==FA_DtRem){Owa.UIControls.FlagDialog.loadInstanceAndShow(Owa.Utility.createDelegate(this,this._onCloseFlagDialog),this.get_ItemId(),this.get_ChangeKey(),this.get_TargetFolderId(),this.get_CurrentStoreObjectType());return}var a=new oeReq("Flg","flgItm",b,this._createCallback(this._cbFlagItems));if(!this.get_ItemId()){this.get_TargetFolderId()&&a.add("fldrId",this.get_TargetFolderId());a.add("typ",this.get_CurrentStoreObjectType())}else{a.add("id",this.get_ItemId());a.add("ck",this.get_ChangeKey())}a.add("flga",e);d&&a.add("ddt",d);a.send()};a._onCloseFlagDialog=function Owa$Pages$FormSubPage$_onCloseFlagDialog(c,f,d,e,b){if(!this.get_ItemId())g_fDltDrft=1;this.set_ItemId(f);this.set_ChangeKey(d);var a=Owa.UIControls.FlagContextMenu.get_Instance();a.set_FlagAction(c);b&&a.set_DueDate(b);this._updateFlagInfobarMessag(e);rfVwAftEdt(this.get_IsPublicItem(),this.get_SubPage())};a._cbFlagItems=function Owa$Pages$FormSubPage$_cbFlagItems(a){if(!cbOeh(a))return;if(!this.get_ItemId())g_fDltDrft=1;eval(a.sBody);this._updateFlagInfobarMessag(sIBMsg);rfVwAftEdt(this.get_IsPublicItem(),this.get_SubPage());this.get_FlagAction()&&this.set_FlagAction(a.oCtx);addPerfMarker("CbFlgItms.End")};a._updateFlagInfobarMessag=function Owa$Pages$FormSubPage$_updateFlagInfobarMessag(c){if(c.length==0)checkRemoveInfobarMessage("divFlg",this.get_SubPage());else{var b=Owa.Dom.Document.get_Current().createElement("DIV");b.set_InnerHtml(c);var a=b.getDescendantById("divFlg");a&&replaceOrInsertInfobarMessageElement(a,this.get_SubPage())}this.resizeBodyOffset()};a._showCategoryMenu=function Owa$Pages$FormSubPage$_showCategoryMenu(){var c=Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("cat"),d=c.get_MenuReferencePosition(g_fRtl),b=null;if(this.get_TargetFolderId())b=this.get_TargetFolderId();else if(this.get_ItemId())b=this.get_ItemId();var a=Owa.UIControls.CategoryMenu.get_Instance(true);a.set_ItemType(this.get_CurrentStoreObjectType());a.set_FolderId(b);a.get_OnChangeCategory().add(this._createCallback(this._onSelectCategories));a.get_OnClearCategory().add(this._createCallback(this._onClearCategories));a.updateStates([this.get_Categories()],c);a.show(d.iX,d.iY)};a._onClearCategories=function Owa$Pages$FormSubPage$_onClearCategories(){var a=new oeReq("Cat","clr",0,this._createCallback(this._cbOnClearCategories));a.add("id",this.get_ItemId());a.add("ck",this.get_ChangeKey());a.send();if(this._getDescendant("divWellCategories")){this._getDescendant("divCategoriesHr")&&this._getDescendant("divCategoriesHr").set_IsShown(false);this._getDescendant("divWellCategories").set_IsShown(false);this._getDescendant("divFieldCategories").set_InnerHtml("")}this.set_Categories([]);this.safeResizeBodies();this.resizeBodyOffset()};a._cbOnClearCategories=function Owa$Pages$FormSubPage$_cbOnClearCategories(a){if(!cbOeh(a))return;eval(a.sBody);rfVwAftEdt(this.get_IsPublicItem(),this.get_SubPage())};a._onSelectCategories=function Owa$Pages$FormSubPage$_onSelectCategories(b){var a=new oeReq("Cat","mdfy",0,this._createCallback(this._cbOnSelectCategories));a.addRg("catAdd",b.rgAdd);a.addRg("catRem",b.rgRem);if(!this.get_ItemId()){this.get_TargetFolderId()&&a.add("fId",this.get_TargetFolderId());a.add("typ",this.get_CurrentStoreObjectType())}else{a.add("id",this.get_ItemId());a.add("ck",this.get_ChangeKey())}a.send()};a._cbOnSelectCategories=function Owa$Pages$FormSubPage$_cbOnSelectCategories(d){if(!cbOeh(d))return;if(!this.get_ItemId())g_fDltDrft=1;eval(d.sBody);var a=this._getDescendant("divFieldCategories"),c=this._getDescendant("divCategoriesHr"),b=this._getDescendant("divWellCategories");a&&a.set_InnerHtml(sCats);c&&c.set_IsShown(this.get_Categories().length!=0);b&&b.set_IsShown(this.get_Categories().length!=0);this.safeResizeWells();this.safeResizeBodies();this.resizeBodyOffset();rfVwAftEdt(this.get_IsPublicItem(),this.get_SubPage());addPerfMarker("CbOnSlctCat.End")};a.resizeBodyOffset=function Owa$Pages$FormSubPage$resizeBodyOffset(){this.getSubPageVariable("a_fEditContactForm")&&contactOffsetBody();this.getSubPageVariable("a_fEditDLForm")&&dlOffsetBody();RepositionContactsBody(this.get_SubPage())};a._resizeWellsInternal=function Owa$Pages$FormSubPage$_resizeWellsInternal(){isDf(typeof resizeWells)&&resizeWells()};a._promoteInlineAttachments=function Owa$Pages$FormSubPage$_promoteInlineAttachments(){if(!this.getSubPageVariable("a_fHasInlineImages"))return;var c=this.getSubPageVariable("a_iT"),b=c==a_IT_CAL?"EditCalendarItem":"EditMessage",a=new oeReq(b,"PromoteInlineAttachments",null,this._cbPromoteInlineAttachments);if(a_sId){a.add("Id",a_sId);a.add("CK",a_sCK);a.add("Body",this.getComposeEditor().getHtml(1,1))}a.send()};a._cbPromoteInlineAttachments=function Owa$Pages$FormSubPage$_cbPromoteInlineAttachments(b){if(b.fST){popLgn();return}if(b.sErr)alert(b.sErr);else{if(!b.sBody)return;var a=Owa.Dom.Document.get_Current().createElement("div");a.set_IsShown(false);Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml(b.sBody);var b={};if(a.getDescendantById("ck"))b.sCK=a.getDescendantById("ck").get_TextContent();if(a.getDescendantById("attItms"))b.sAtts=a.getDescendantById("attItms").get_InnerHtml();procAttRsp(b);a.remove(true);var c=Owa.UIControls.SubPage.get_Instance();c!=null&&c._sl_oAttMgr!=null&&c._sl_oAttMgr.OnAttachmentWellUpdatedByServer()}};Owa.Pages.FormSubPage.createClass("Owa.Pages.FormSubPage",Owa.UIControls.SubPage);var b="divInfoDrftSv";Owa.Pages.EditFormSubPage=function Owa$Pages$EditFormSubPage(a){Owa.Pages.EditFormSubPage.constructBase(this,[a,true]);this._sl_oAttMgr=null;this._sl_fProcessingAttachments=false;this._fAutoSavingItem=false;this._sl_rgCommandsToDisable=["send","save","saveclose","caninv","cat","flag","markcomplete","delete","compliance"];this._sl_rgCommandsToDisableOriginalState=new Array(this._sl_rgCommandsToDisable.length);this._rgAutoSaveCommandsToDisable=this._sl_rgCommandsToDisable.concat(["attachfile","insertimage","checknames","spellcheck"]);this._rgAutoSaveCommandsToDisableOriginalState=new Array(this._rgAutoSaveCommandsToDisable.length)};var a=Owa.Pages.EditFormSubPage.prototype;a.initialize=function Owa$Pages$EditFormSubPage$initialize(){initCmbFrmt();Owa.Pages.EditFormSubPage.callBase(this,"initialize");var a=this._getDescendant("divSpl");if(a){var c=Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("spellcheckd")._get_SubMenuPopup(),b=new Owa.UIControls.SpellCheckComboBox.create(a,c);a.setExpando("oSpellCheckerComboBox",b)}this._fEnableAutoSave&&this._setAutoSaveTimer()};a.get_ShortTimeFormat=function Owa$Pages$EditFormSubPage$get_ShortTimeFormat(){return this.getSubPageVariable("a_sShtTmFmt")};a.get_TimeZoneOffset=function Owa$Pages$EditFormSubPage$get_TimeZoneOffset(){return this.getSubPageVariable("a_iTzOffset")};a.get_AutoSaveInterval=function Owa$Pages$EditFormSubPage$get_AutoSaveInterval(){return this.getSubPageVariable("a_iASI")*1e3};a._setAutoSaveTimer=function Owa$Pages$EditFormSubPage$_setAutoSaveTimer(){this._autoSaveTimerId=this._setTimeout(this._autoSave,this.get_AutoSaveInterval())};a._clearAutoSaveTimer=function Owa$Pages$EditFormSubPage$_clearAutoSaveTimer(){if(this._autoSaveTimerId){this._clearTimeout(this._autoSaveTimerId);this._autoSaveTimerId=0}};a._handleAutoSavePermanentError=function Owa$Pages$EditFormSubPage$_handleAutoSavePermanentError(){this._clearAutoSaveTimer();this._fShutOffAutosaveDueToError=true};a._resetAutoSaveTimer=function Owa$Pages$EditFormSubPage$_resetAutoSaveTimer(){this._clearAutoSaveTimer();this._setAutoSaveTimer();this._fShutOffAutosaveDueToError=false};a._autoSave=function Owa$Pages$EditFormSubPage$_autoSave(){if(this._fShutOffAutosaveDueToError)return;if(!g_fDrty||Owa.Components.OehRequest.hasPendingRequests()||this._sl_fProcessingAttachments){this._resetAutoSaveTimer();return}this._fAutoSavingItem=true;this.disableSaveUserActionsUI(true,true);this.processOnAutoSave()};a._onCompleteAutoSave=function Owa$Pages$EditFormSubPage$_onCompleteAutoSave(){this._fAutoSavingItem=false;this.disableSaveUserActionsUI(false,true);!this._fShutOffAutosaveDueToError&&this._resetAutoSaveTimer()};a._updateAutoSaveInfobar=function Owa$Pages$EditFormSubPage$_updateAutoSaveInfobar(e,f){var a=this.get_SubPage();if(!a._oInfobar){a._oInfobar=a.addResource(new Owa.UIControls.Infobar(a._getDescendant("divInfobar")));a._oInfobar.set_SubPage(a)}if(f){a._oInfobar.checkRemoveMessageAndRefresh(b);return}else this._fShutOffAutosaveDueToError&&this._resetAutoSaveTimer();var g=getUTCDifference(this.get_TimeZoneOffset()),d=fmtDt(g,this.get_ShortTimeFormat()),c;if(e)c=L_DrftAutoSavedAt.replace("{0}",d);else c=L_DrftSavedAt.replace("{0}",d);var h=4;a._oInfobar.buildReplaceOrInsertMessageAndRefresh(htmlEnc(c),b,h);a._oInfobar.setHideByDefaultValue(0);a._oInfobar.set_IsShown(1)};a._initializeItemBody=function Owa$Pages$EditFormSubPage$_initializeItemBody(){this._initEdit(this.get_SubPage(),this._get_ContentBody(),this._oIfBdy,this._createCallback(this.onResize));disableInsertImageButton(!isHtml());Owa.Pages.EditFormSubPage.callBase(this,"_initializeItemBody")};a.dispose=function Owa$Pages$EditFormSubPage$dispose(){window.oR=null;dispCmbFrmt();this._clearAutoSaveTimer();Owa.Pages.EditFormSubPage.callBase(this,"dispose")};a._disposeContentBody=function Owa$Pages$EditFormSubPage$_disposeContentBody(){Owa.Pages.EditFormSubPage.callBase(this,"_disposeContentBody");isSpC()&&dispSp();this._oIfBdy&&this._oIfBdy.get_ContentDocument().detachAllEvents();dispTxtBdy("txtBdy");var b=this._getDescendant("txtSubj");b&&b.detachAllEvents();var c=this._getDescendant("txtLoc");c&&c.detachAllEvents();var a=this._getDescendant("divFmtBr");a&&isFormatBarInitialized(a)&&this.getComposeEditor().dispose()};a.onBeforeUnload=function Owa$Pages$EditFormSubPage$onBeforeUnload(a){if(g_fDrty){if(Owa.Utility.isSafari())return L_ClsPmpt;else a._oEvent.returnValue=L_ClsPmpt;clrDrty();Owa.Dom.Window.get_Current().setTimeout(drty,100)}};a._shouldBlockUserAction=function Owa$Pages$EditFormSubPage$_shouldBlockUserAction(c){var a=[];if(this._sl_fProcessingAttachments)a=this._sl_rgCommandsToDisable;else if(this._fAutoSavingItem)a=this._rgAutoSaveCommandsToDisable;for(var b=0;b<a.length;b++)if(c==a[b])return true;return false};a._onUserAction=function Owa$Pages$EditFormSubPage$_onUserAction(a,b){if(this._shouldBlockUserAction(a))return;switch(a){case"attachfile":shwAttchDlg();break;case"insertimage":shwAttchDlg(true);break;case"insertsignature":addSignatureToExistingMessage();break;case"imphigh":case"implow":case"msgsgnd":case"msgencypt":drty();break;case"spellcheck":procSpl();break;default:return Owa.Pages.EditFormSubPage.callBase(this,"_onUserAction",[a,b])}};a._isEditorTabAfterSubject=function Owa$Pages$EditFormSubPage$_isEditorTabAfterSubject(){return true};a.getComposeEditor=function Owa$Pages$EditFormSubPage$getComposeEditor(c){var a=this._getDescendant("divFmtBr");if(!isFormatBarInitialized(a)){var b=Owa.Utility.isIE()?dlgHelper:null;return new Owa.UIControls.OwaEditor(a,edDoc(1),b,c)}else return a.getExpando("formatBar")};a._initEdit=function Owa$Pages$EditFormSubPage$_initEdit(l,e,c,s){initTxtBdy(l,"txtBdy");var n=$("txtSubj");if(n){n.attachEvent("keydown",onKDTxt);n.attachEvent("paste",drty)}var q=$("txtLoc");q&&q.attachEvent("keydown",onKDTxt);var d=isRepFw();if(isDf(typeof a_iDltDrft)&&!d)g_fDltDrft=a_iDltDrft;else if(d&&isDf(typeof a_fCbResp))g_fDltDrft=0;else if(d)g_fDltDrft=1;if(!c)return;var f=Owa.Utility.isIE();f&&c.set_IsShown(false);var i;if(!e.match(/<html/i)||a_fTxt)i=c.get_ContentDocument().get_DocumentElement().get_OuterHtml();var k="";if(i)k=i;else if(!a_fTxt)k=e;var m=$("divFmtBr");if(m&&isHtml()&&!(g_oMmBdy&&a_sId))var u=l.getComposeEditor(k);else{c.get_ContentDocument().set_DesignMode(1);wrtBdy(c.get_ContentDocument(),k)}var b=c.get_ContentDocument(),a=b.get_Body();if(d)g_sRFId="divRpF"+rndm();if(i)if(a_fTxt){if(!d)a.set_TextContent(e);else if(e.trim()){var t=g_fRtl?"rtl":"ltr";a.set_InnerHtml('<DIV>&nbsp;</DIV><DIV dir="'+t+'" id='+g_sRFId+"></DIV>");b.getElementById(g_sRFId).set_TextContent(e)}}else{a.set_InnerHtml(e);initEditMarkup(b,a,d)}if(d&&!a_fTxt){var r="font-family: Times New Roman; color: #000000; font-size: 16px";wrapHtmlBodyWithDefaultFont(b,a,r);initEditMarkup(b,a,1);var h=b.getElementById("divRplyFwdMsg");if(!h)h=b.getElementById("x_divRplyFwdMsg");if(h){h.set_Id(g_sRFId);h._get_DomNode().style.direction=g_fRtl?"rtl":"ltr"}}!(g_oMmBdy&&a_sId)&&addSignatureToNewMessage();this._initializeIFrameBodyEditor(b,a,s);if(f&&!Owa.Utility.isGreaterThanIE9UsingTrident()&&$("divEcm")){a.attachEvent("contextmenu",onCMEd);b.get_ContainerWindow().attachEvent("scroll",onEdWScr)}a.attachEvent("paste",onPste);if(!chkMime()){var g={};g.oCallerSubPage=l;if(!Owa.Utility.isFirefox()){a.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,g));a.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,g));a.attachEvent("dragenter",setDE);a.attachEvent("dragover",setDE)}else{b.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,g));b.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,g));b.attachEvent("dragenter",setDE);b.attachEvent("dragover",setDE)}}if(isSpC()){a.attachEvent("cut",onPste);a.attachEvent("dragstart",onPste);a.attachEvent("dragend",onPste)}a.attachEvent("drop",drty);if(f&&!Owa.Utility.isGreaterThanIE9UsingTrident()){var p=$("divScm");if(p){CtxMnu(p._get_DomNode(),onSelSpl);p._get_DomNode().preShw=cmPreShwSpl}var o=$("divEcm");if(o){CtxMnu(o._get_DomNode(),onSelEdt);o._get_DomNode().preShw=cmPreShwEd}}var j=$("txtBdy");if(a_fTxt){var m=$("divFmtBr");m&&m.set_IsShown(false);if(!f){j.set_Value(j.get_Value());c.set_IsShown(false);j.set_IsShown(true);rszBdy(j)}}if(isDf(typeof a_fCopyRestricted)&&a_fCopyRestricted==1){a.attachEvent("copy",canEvt);a.attachEvent("cut",canEvt);a.attachEvent("dragstart",canEvt)}f&&c.set_IsShown(true);updCmp(window)};a._initializeIFrameBodyEditor=function Owa$Pages$EditFormSubPage$_initializeIFrameBodyEditor(a,b,d){initializeIFrameBodyEditorHotkeys(a);isFormatBarInitialized(this._getDescendant("divFmtBr"))&&this.getComposeEditor().attachEditorEventHandlers(a);var c=a.get_ContainerWindow().get_FrameElement().get_ContentWindow();a.attachEvent("keydown",this.onKeyDown);a.attachEvent("click",this.onClick);b.attachEvent("paste",drty);b.attachEvent("paste",d);c.attachEvent("beforeunload",this._createCallback(Owa.Pages.EditFormSubPage.prototype.onBeforeUnload));this._initializeIFrameBody(a,b)};a.onKeyDown=function Owa$UIControls$EditFormSubPage$onKeyDown(a){a&&isSpC()&&g_iLstSpLng&&hndSpK(a._oEvent);onKDTxt(a);Owa.UIControls.AutoCompleteCache.hide()};a.onClick=function Owa$UIControls$EditFormSubPage$onClick(){Owa.UIControls.AutoCompleteCache.hide();Owa.UIControls.MenuButton.hideAnyPopupMenu();var a=createSelectionRange(edDoc());a&&!a.IsTypeControl()&&!cntns(edDoc().body,a.parentElement())&&a.select()};a.disableSaveUserActionsUI=function Owa$Pages$EditFormSubPage$disableSaveUserActionsUI(f,g){var c=null,b=null;if(g){c=this._rgAutoSaveCommandsToDisable;b=this._rgAutoSaveCommandsToDisableOriginalState}else{c=this._sl_rgCommandsToDisable;b=this._sl_rgCommandsToDisableOriginalState}for(var a=0;a<c.length;a++){var d=Owa.Components.ToolbarCollection.get_Current().getButton(c[a]);if(d)if(f){b[a]=d.get_IsDisabled();d.set_IsDisabled(true)}else d.set_IsDisabled(b[a])}var e=this._getDescendant("divCmbFrmt");if(e!=null){var h=e.getExpando("oComboBox");h.set_IsEnabled(!f)}};a.SL_OnAttachmentManagerLoaded=function Owa$Pages$EditFormSubPage$SL_OnAttachmentManagerLoaded(){this._sl_oAttMgr=this._getDescendant("sl_attMgr")._oDomNode.content.AttachmentManager};a.SL_OnFilesToAttachSelected=function Owa$Pages$EditFormSubPage$SL_OnFilesToAttachSelected(){addPerfMarker("SL_OnFilesToAttachSelected.Start")};a.SL_OnFilesUploadingStarted=function Owa$Pages$EditFormSubPage$SL_OnFilesUploadingStarted(){addPerfMarker("SL_OnFilesUploadingStarted.End")};a.SL_RenderAttachedFiles=function Owa$Pages$EditFormSubPage$SL_RenderAttachedFiles(e,c,d,b){if(this._sl_fProcessingAttachments!=b){this._sl_fProcessingAttachments=b;this.disableSaveUserActionsUI(b)}var a={};a.sCK=e;a.sAtts=c;a.sIbd=d;procAttRsp(a)};a.SL_HasInlineImages=function Owa$Pages$EditFormSubPage$SL_HasInlineImages(){return!!this.getSubPageVariable("a_fHasInlineImages")};a.SL_CreateImplicitDraftItem=function Owa$Pages$EditFormSubPage$SL_CreateImplicitDraftItem(){var a=new oeReq("Attachments","CreateImplicitDraftItem",null,this.SL_cbCreateImplicitDraftItem);a.add("IT",this.getSubPageVariable("a_iT"));a.set_ProcessXhrStatusZeroAsError();var b=this.getSubPageVariable("a_sFldId");typeof b!="undefined"&&b!=null&&a.add("FId",b);a.send()};a.SL_cbCreateImplicitDraftItem=function Owa$Pages$EditFormSubPage$SL_cbCreateImplicitDraftItem(b){if(b.fST){popLgn();return}var c=false;if(b.sErr){alert(b.sErr);if(b.IsNetworkConnectionError())c=true;else return}else{var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml(b.sBody);var e=a.getDescendantById("itemId");a_sId=e.get_TextContent();var f=a.getDescendantById("ck");a_sCK=f.get_TextContent();a.remove(true);g_fDltDrft=1;drty()}var d=Owa.UIControls.SubPage.get_Instance();d._sl_oAttMgr!=null&&d._sl_oAttMgr.OnCreateImplicitDraftItem(c)};a.SL_CleanupUnlinkedAttachments=function Owa$Pages$EditFormSubPage$SL_CleanupUnlinkedAttachments(){if(Owa.Components.OehRequest.hasPendingRequests())return false;var a=new oeReq("Attachments","CleanupUnlinkedAttachments",null,this.SL_cbCleanupUnlinkedAttachments);a.add("Id",a_sId);a.add("CK",a_sCK);a.set_ProcessXhrStatusZeroAsError();var b=this.getComposeEditor().getHtml(1,1);a.add("BodyMarkup",b);a.send();return true};a.SL_cbCleanupUnlinkedAttachments=function Owa$Pages$EditFormSubPage$SL_cbCleanupUnlinkedAttachments(b){if(b.fST){popLgn();return}var c=Owa.UIControls.SubPage.get_Instance(),d=false;if(b.sErr){alert(b.sErr);if(b.IsNetworkConnectionError())d=true;else return}else{var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml(b.sBody);var e=a.getDescendantById("attSz"),f=parseInt(e.get_TextContent(),10);c.setSubPageVariable("a_sl_iTotalAttachmentSize",f);var g=a.getDescendantById("ck");a_sCK=g.get_TextContent();a.remove(true);drty()}c._sl_oAttMgr!=null&&c._sl_oAttMgr.OnCleanupUnlinkedAttachments(d)};Owa.Pages.EditFormSubPage.createClass("Owa.Pages.EditFormSubPage",Owa.Pages.FormSubPage);Owa.Pages.ReadFormSubPage=function Owa$Pages$ReadFormSubPage(a){Owa.Pages.ReadFormSubPage.constructBase(this,[a,false])};var a=Owa.Pages.ReadFormSubPage.prototype;a.initialize=function Owa$Pages$ReadFormSubPage$initialize(){Owa.Pages.ReadFormSubPage.callBase(this,"initialize");if(!this.get_IsPreview()){g_oEd.attachEvent("CopyItems",null,"cbCpMvItms");g_oEd.attachEvent("MoveItems",null,"cbCpMvItms")}var a=this._getDescendant("divSubj"),d=this._getDescendant("txtSubj");if(a&&d&&a.getAttribute("_editable")){this._attachEvent(a,"click",this._onClickSubject);this._attachEvent(a,"focus",this._onClickSubject);this._attachEvent(d,"blur",this._onBlurSubjectInput);d.set_Value(a.get_TextContent())}if(this.get_IsPreview()){this._setTimeout(this._fireOnLoadReadingPane,1);if(!this.get_IsCopyRestricted()){var g=this.get_ParentSubPage();g&&this._cancelBubbleEvent(this._get_Element(),"selectstart")}}var e=this._getDescendant("divActionIcons");if(e){var c=[];c[0]=this.get_ActionTable();var f=this.get_SubPage().get_SubPageController(),b=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(f.get_ParentController());if(b)c[1]=b.get_ActionTable();if(isJnkFld(this.get_SubPage()))this._actionButtons=new Owa.UIControls.JunkMailActionButtons(e,Owa.Utility.createArgumentContextDelegate(this,this._onActionButtonClicked),c);else this._actionButtons=new Owa.UIControls.ActionButtons(e,Owa.Utility.createArgumentContextDelegate(this,this._onActionButtonClicked),false,c);this.get_IsReplyRestricted()&&this._actionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.REPLY);this.get_IsReplyAllRestricted()&&this._actionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.REPLY_ALL);this.get_IsForwardRestricted()&&this._actionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.FORWARD);if(b)b.hasMultipleItemsSelected&&b.hasMultipleItemsSelected()&&this._actionButtons.setMultipleSelection(true)}};a._onActionButtonClicked=function Owa$Pages$ReadFormSubPage$_onActionButtonClicked(a){this._onUserAction(a.sAction)};a._onUserAction=function Owa$Pages$ReadFormSubPage$_onUserAction(a,b){switch(a){case"forward":this._replyForwardItem(this.get_ItemClassName(),"Forward",this.get_IsPreview());break;default:Owa.Pages.ReadFormSubPage.callBase(this,"_onUserAction",[a,b])}};a._fireOnLoadReadingPane=function Owa$Pages$ReadFormSubPage$_fireOnLoadReadingPane(){try{var a=this.get_SubPage().get_SubPageController().get_ParentController();a&&a.invokeFunction("onLoadReadingPane")}catch(b){}};a._initializeItemBody=function Owa$Pages$ReadFormSubPage$_initializeItemBody(){this._initializeReadBody();this._oTxtBdy&&this._oTxtBdy.setBoolAttribute("readOnly",true);var a=this._getDescendant("aIbBlk");a&&this._attachEvent(a,"click",this._onClickIBLink);a=this._getDescendant("aIbRR");a&&this._attachEvent(a,"click",this._onClickIBLink);Owa.Pages.ReadFormSubPage.callBase(this,"_initializeItemBody")};a._initializeReadBody=function Owa$Pages$ReadFormSubPage$_initializeReadBody(){if(!this._oIfBdy)return;var d="";if(!this.get_IsTextBody()){d=this._get_ContentBody();this._oIfBdy.set_IsShown(false)}wrtBdy(this._oIfBdy.get_ContentDocument(),d);var c=this._oIfBdy.get_ContentDocument(),a=c.get_Body();this._initializeIFrameBodyReader(c,a);a.attachEvent("dragenter",canEdEvt);a.attachEvent("dragover",canEdEvt);a.attachEvent("drop",canEdEvt);var b=this.get_IsCopyRestricted();if(b){a.attachEvent("copy",canEvt);a.attachEvent("contextmenu",canEvt);a.attachEvent("dragstart",canEvt);a.attachEvent("selectstart",canEvt)}if(this.get_IsTextBody()){this._oIfBdy.set_IsShown(false);this._oTxtBdy.set_IsShown(true);rszBdy(this._oTxtBdy,this.get_SubPage())}else{b&&this._oTxtBdy.set_Value("");this._oIfBdy.set_IsShown(true)}};a._initializeIFrameBodyReader=function Owa$Pages$ReadFormSubPage$_initializeIFrameBodyReader(a,b){this._initializeIFrameBodyReaderHotkeys(a);this._initializeIFrameBody(a,b)};a._initializeIFrameBodyReaderHotkeys=function Owa$Pages$ReadFormSubPage$_initializeIFrameBodyReaderHotkeys(a){this._oIFrameBodyActionTable=new Owa.Components.ClientActionTable;this._oIFrameBodyHotkeyManager=new Owa.Components.HotKeyManagerDom(this._oIFrameBodyActionTable,a,this.get_HotKeyManager())};a.get_ActionButtons=function Owa$Pages$ReadFormSubPage$get_ActionButtons(){return new Array(this._actionButtons)};a.get_IsPreview=function Owa$Pages$ReadFormSubPage$get_IsPreview(){return this.getSubPageVariable("a_fPrv")};a.get_SaveNamespace=function Owa$Pages$ReadFormSubPage$get_SaveNamespace(){return this.getSubPageVariable("a_sNmSpc")};a.get_IsPhishing=function Owa$Components$ReadFormSubPage$get_IsPhishing(){return this.getSubPageVariable("a_fPhsh")};a.get_IsReplyRestricted=function Owa$Components$ReadFormSubPage$get_IsReplyRestricted(){return this.getSubPageVariable("a_fReplyRestricted")};a.get_IsReplyAllRestricted=function Owa$Components$ReadFormSubPage$get_IsReplyAllRestricted(){return this.getSubPageVariable("a_fReplyAllRestricted")};a.get_IsForwardRestricted=function Owa$Components$ReadFormSubPage$get_IsForwardRestricted(){return this.getSubPageVariable("a_fForwardRestricted")};a.get_IsSMimeEmbeddedItem=function Owa$Pages$ReadFormSubPage$get_IsSMimeEmbeddedItem(){return this.getSubPageVariable("a_fSmEmb")};a.set_IsSMimeEmbeddedItem=function Owa$Pages$ReadFormSubPage$set_IsSMimeEmbeddedItem(a){return this.setSubPageVariable("a_fSmEmb",a)};a.get_NextPreviousOption=function Owa$Pages$ReadFormSubPage$get_NextPreviousOption(){return this.getSubPageVariable("a_fNxtSel")};a.forwardAsAttachment=function Owa$Components$ReadFormSubPage$forwardAsAttachment(){var a=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(this.get_SubPageController().get_ParentController());a&&a.fwIA()};a.get_IsDeleteSupported=function Owa$Components$ReadFormSubPage$get_IsDeleteSupported(){return!this.get_CanDelete()||!this.get_ItemId()||this.get_IsSMimeEmbeddedItem()?0:1};a.dispose=function Owa$Pages$ReadFormSubPage$dispose(){if(this.get_IsDisposed())return;try{this._actionButtons&&this._actionButtons.dispose();for(var c=["aIbBlk","aIbRR","divSubj","txtSubj"],a=0;a<c.length;a++){var b=this._getDescendant(c[a]);b&&b.dispose()}this.get_IsSMimeEmbeddedItem()&&this.delMsg(1,1,1);Owa.Pages.ReadFormSubPage.callBase(this,"dispose")}catch(d){}};a._onClickIBLink=function Owa$Pages$ReadFormSubPage$_onClickIBLink(m){var c=m.get_CurrentTarget(),k=c.getAttribute("_sIT"),p=c.getAttribute("_sAct"),q=c.getAttribute("_iSt"),e=c.getAttribute("_fPhsh"),h=c.getAttribute("_fAWB"),d=c.getAttribute("_fRR");if(!this.get_IsTextBody()||e==1||d==1){var f=getUrl(k,p,q,e,h,0,0,d,this.get_SubPage());if(isSMime(k))f+=gtMmPar();if(this.get_IsSMimeEmbeddedItem()){this.set_IsSMimeEmbeddedItem(0);f+="&smemb=1&exdltdrft=1"}var j=null;if(d==1)j=this._getDescendant("aIbRR");else j=this._getDescendant("aIbBlk");var o=window.document.location.protocol+"//"+window.document.location.host+window.document.location.pathname+f,g=this.get_SubPageController().get_ParentController();if(!g||!Owa.UIControls.DivSubPageController.isInstance(this.get_SubPageController()))this.get_SubPageController().navigate(o);else{var n=g.get_SubPage()._getDescendant("ifRP"),b=Owa.Components.SubPageControllerFactory.getControllerByElement(n),l=b._get_Element().get_ParentElement();this.get_SubPageController().remove();b=Owa.Components.SubPageControllerFactory.createControllerByUrl(l,f,"ifRP",false);g.addChildController(b)}if(!this.get_ItemId())return;var a=0;if(d==1||e==1||h==1)try{var i=this.get_SubPageController(),b=this.get_IsPreview()?i.get_ParentController():i.get_OpenerController();if(b)a=b.get_SubPage();if(!Owa.PageHierarchy.isFolderViewSubPageObject(a)&&!Owa.PageHierarchy.isCalendarPageObject(a)){b=b.get_ParentController();if(b)a=b.get_SubPage();if(!Owa.PageHierarchy.isFolderViewSubPageObject(a)&&!Owa.PageHierarchy.isCalendarPageObject(a))a=null}}catch(r){}d==1&&a&&sendRefresh(a,{fUdRP:this.get_IsPreview()?0:1},1);e==1&&a&&sendRefresh(a,{sId:this.get_ItemId(),fUdRP:this.get_IsPreview()?0:1},0);h==1&&a&&sendRefresh(a,{fUdRP:this.get_IsPreview()?0:1},2)}};a._onClickSubject=function Owa$Pages$ReadFormSubPage$_onClickSubject(){var b=this._getDescendant("divSubj"),a=this._getDescendant("txtSubj");a.set_Value(b.get_TextContent());b.set_Visibility(Owa.Style.Visibility.Hidden);a.set_IsShown(true);this._adjustSubjectPosition();a._get_DomNode().select()};a._onBlurSubjectInput=function Owa$Pages$ReadFormSubPage$_onBlurSubjectInput(){if(Owa.Components.OehRequest.hasPendingRequests())return;var c=0,b=this._getDescendant("divSubj"),a=this._getDescendant("txtSubj");if(b.get_TextContent()!=a.get_Value())c=savRMsg(this.get_SaveNamespace(),"Subj",a.get_Value(),this.get_IsPreview(),this.get_SubPage());c&&b.set_TextContent(a.get_Value());b.set_Visibility(Owa.Style.Visibility.Visible);a.set_IsShown(false)};a._adjustSubjectPosition=function Owa$Pages$ReadFormSubPage$_adjustSubjectPosition(){var a=this._getDescendant("txtSubj");if(a)if(Owa.Utility.isFirefox())a.set_Padding(Owa.Style.Side.Top,1);else if(Owa.Utility.isIE()){a.set_Padding(Owa.Style.Side.Left,1);a.set_Padding(Owa.Style.Side.Right,1);a.set_Padding(Owa.Style.Side.Top,1)}};Owa.Pages.ReadFormSubPage.createClass("Owa.Pages.ReadFormSubPage",Owa.Pages.FormSubPage);Owa.Pages.ReadMessageFormSubPage=function Owa$Pages$ReadMessageFormSubPage(a){Owa.Pages.ReadMessageFormSubPage.constructBase(this,[a,false])};var a=Owa.Pages.ReadMessageFormSubPage.prototype;a._initializeBaseHotkeys=function Owa$Components$ReadMessageFormSubPage$_initializeBaseHotkeys(){Owa.Pages.ReadMessageFormSubPage.callBase(this,"_initializeHotkeys");this.addHk("Ctrl+188","previous");this.addHk("Ctrl+190","next");this.addHk(L_HkDlt,"delete")};a._initializeHotkeys=function Owa$Components$ReadMessageFormSubPage$_initializeHotkeys(){this._initializeBaseHotkeys();if(!(isJnkFld(this.get_SubPage())||this.get_IsPhishing())){!this.get_IsReplyRestricted()&&this.addHk(L_HkRpl,"reply");!this.get_IsReplyAllRestricted()&&this.addHk(L_HkRplAll,"replyall");this.addHk(L_HkCht,"chat");this.get_CurrentStoreObjectType()!=this.getSubPageVariable("a_IT_APV_RQ")&&!this.get_IsForwardRestricted()&&this.addHk(L_HkFwd,"forward")}};a._onUserAction=function Owa$Pages$ReadMessageFormSubPage$_onUserAction(b,c){switch(b){case"replyall":this._replyForwardItem(this.get_ItemClassName(),"ReplyAll",this.get_IsPreview());break;case"reply":this._replyForwardItem(this.get_ItemClassName(),"Reply",this.get_IsPreview());break;case"fwia":this.forwardAsAttachment();break;case"crrul":opnEcpNewRul(this.get_SubPage(),getIdQS());break;case"messagedetails":this._loadMessageDetail();break;case"delete":if(!this.get_IsDeleteSupported())return;this.delMsg(this.get_IsInDeletedItems()||this.get_IsPublicItem());break;case"previous":getItm(this.get_ItemId(),window.name,0);break;case"next":getItm(this.get_ItemId(),window.name,1);break;case"chat":nwChtSsnFrm();break;case"print":if(g_fDrty)alrt(L_SavePrt,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_SavePrtTtl);else if(g_oMmBdy)window.print();else opnPrntFrm(this.get_ItemClassName());break;case"ntjnk":var a=this._getDescendant("spnFrom");shwNtJnkDlg(this.get_SubPage(),this.get_ItemId(),0,a!=null?a.get_Title():null);break;default:Owa.Pages.ReadMessageFormSubPage.callBase(this,"_onUserAction",[b,c])}};a.delMsg=function Owa$Pages$ReadMessageFormSubPage$delMsg(a,f,g){if(this.get_IsPreview()){var b=this.get_SubPageController().get_ParentController();if(b){var c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b);c&&c._onUserAction(a?BID_PDLT:BID_DL)}}else{var d=this.get_ItemId();if(!d)return;if(!f)if(a&&!confirm(L_PrDelPrp))return;var e=new oeReq("ReadMessage",a?"PermanentDelete":"Delete",null,this._createCallback(this.cbDelMsg),null,null,g);e.add("Id",d);e.send()}};a.cbDelMsg=function Owa$Pages$ReadMessageFormSubPage$cbDelMsg(c){if(c.fST){popLgn();return}if(c.sErr){shwErrDlg(c);return}try{var e=this.get_SubPageController().get_OpenerController(),a=null;if(e)a=Owa.PageHierarchy.getVirtualListViewFromSubPageController(e);var d=a&&a.isCnvVw&&a.isCnvVw(),b=0;if(a){var f=d?null:window.name;b=a.rmvRws(new Array(this.get_ItemId()),f,this.get_NextPreviousOption())}else b=1;(b||!a.gtSelCnt()||d)&&window.close()}catch(g){}};Owa.Pages.ReadMessageFormSubPage.createClass("Owa.Pages.ReadMessageFormSubPage",Owa.Pages.ReadFormSubPage)})();g_fModuleLoaded[".\\components/formutility.js".toLowerCase()]=1;function sendRefresh(a,b,c){try{if(a.getSubPageVariable("a_fCal"))rfCalVw(a_fPrv,isDf(typeof a_sId)?a_sId:null);else{c==1&&a._setTimeout(a.rfVwRemoveIrm,100,b);c==0&&a._setTimeout(a.rfVwPhsh,100,b);c==2&&a._setTimeout(a.rfVwRemoveWB,100,b)}}catch(d){}}function dispCmbFrmt(){g_oFormatCombobox&&g_oFormatCombobox.dispose()}function dispTxtBdy(b){var a=$(b);if(a){!chkMime()&&dispDE($(b));a.detachAllEvents()}}function isHtml(){var a=$("divCmbFrmt");if(!a)return false;var b=a.getExpando("oComboBox");return b.get_SelectedValue()=="0"}function isBdy(a){return Owa.Dom.Node.wrapDomNode(a.ownerDocument).get_IsDesignMode()}function disableInsertImageButton(b){var a=Owa.Components.ToolbarCollection.get_Current().getButton("insertimage");if(a&&b!=a.get_IsDisabled()){a.set_IsDisabled(b);a._get_Element()._get_DomNode().style.cursor=b?"default":"hand";a.getToolbarIcon()._get_DomNode().style.cursor=b?"default":"hand"}}function setSelfLocationWithoutPrompt(b){var a=isDrty();clrDrty();self.location=b;a&&Owa.Dom.Window.get_Current().setTimeout(drty,100)}function initDE(a){if(a){a.attachEvent("dragenter",setDE);a.attachEvent("dragover",setDE)}}function dispDE(a){a&&a.detachAllEvents()}function setDE(a){var a=a?a:edEvt();if(!a)a=getEvt(this);if(!a)return;var b=Owa.Dom.Event.isInstance(a)?a:new Owa.Dom.Event(a),c=new Owa.Components.Storage.DragDrop(b),d=Owa.Components.Storage.StorableObject.createFromStorage(c);if(d){b.cancelBubble();b.preventDefault();c.setEffect(Owa.Components.Storage.DragDrop.Effect.Copy)}else{b.cancelBubble();b.preventDefault()}}function insertSS(a,c,d){var b=getSS(a,c),e=a.get_StyleSheetCount();if(!b)if(e<31)b=d?a.insertBlankStyleSheet(c,d):a.insertBlankStyleSheet(c);else b=a.getStyleSheetAt(e-1);return b}function getSS(a,b){return a.getStyleSheetByAttribute("id",b)}function applyParagraphStylesToDocument(a,i){if(a.get_Body().getIntAttribute("fPStyle"))return;if(Owa.Utility.isIE())for(var g=a.get_StyleSheetCount(),e=0;e<g;e++){var c=a.getStyleSheetAt(e);if(c.get_OwnerNode()){var b=c.get_OwnerNode().get_InnerHtml(),h=/(<style[^>]*>)[\s]*p[\s]*{[^}]*}/i,f=/}[\s]*p[\s]*{[^}]*/gi;b=b.replace(h,"$1").replace(f,"");c._oDomStyleSheet.cssText=b}}var d=getSS(a,"owaParaStyle");if(!d)d=insertSS(a,"owaParaStyle");!i&&d.addRule("P","margin-top:0;margin-bottom:0;");a.get_Body().setIntAttribute("fPStyle",1)}function applyNoPrintStylesToDocument(b){var a=getSS(b,"owaPrintStyle");if(!a){a=insertSS(b,"owaPrintStyle","print");var c=b.get_StyleSheetCount();a.get_Id()=="owaPrintStyle"&&a.addRule("BODY","display:none;visibility:hidden;")}}function removeNoPrintStylesFromDocument(b){var a=getSS(b,"owaPrintStyle");a&&a.remove()}function removeTempEditStylesFromDocument(b){var a=getSS(b,"owaTempEditStyle");a&&a.remove()}function SL_OnPluginError(d,a){SL_DisableAttachmentManager();var b=L_ErrAttSilverlightFailure+"\n";if(d!=null&&d!=0){var i=d.getHost().Source;b=i+"\n"}b+="Code: "+a.ErrorCode+"\n";var c=a.ErrorType;b+="Category: "+c+"\n";b+="Message: "+a.ErrorMessage+"\n";var g=null,f=null,e=null,h=null;if(c=="ParserError"){g=a.xamlFile;f=a.lineNumber;e=a.charPosition}else if(c=="RuntimeError"){if(a.lineNumber!=0){f=a.lineNumber;e=a.charPosition}h=a.methodName}Owa.Components.Application.handleClientError(b,g,f,e,h,null,null,null,null)}function SL_OnUnhandledException(b,a,c){SL_DisableAttachmentManager(b);if(!b){a=L_ErrAttSilverlightFailure+"\n"+a;Owa.Components.Application.handleClientError(a,null,null,null,null,c,null,null,null)}}function SL_DisableAttachmentManager(d){var a=Owa.UIControls.SubPage.get_Instance();if(a!=null&&a._sl_oAttMgr!=null){a._sl_oAttMgr=null;a._sl_disabled=1;if(a._sl_fProcessingAttachments){a._sl_fProcessingAttachments=false;a.disableSaveUserActionsUI(false)}var c=a._get_Element().getDescendantById("inProgressAttachment");if(c){var b=c.get_ParentElement();b!=null&&b.remove(true)}RefreshAttachmentWell(d)}}function SL_GetOuterHTML(a){var b=new Owa.Dom.Element(a);return b.get_OuterHtml()}function getFB(d,a,e){if(!a||!a.length)return;var b={};b.oDP=d;b.cbOnErr=e;var c=new oeReq("DatePicker","GetFreeBusy",b,cbGetFB,POST);c.add("m",d.dt);c.addRg("fId",a);c.send()}function cbGetFB(a){if(a.fST){popLgn();return}if(a.sErr){a.oCtx.cbOnErr&&a.oCtx.cbOnErr(a,1);return}var d=a.oCtx.oDP,c=Owa.Dom.Document.get_Current().createElement("div");c.set_InnerHtml(a.sBody);var b=c.getChildById("fb"),e=toDate(b.getIntAttribute("_y"),b.getIntAttribute("_m"),1);d.updateFb(b.get_TextContent(),e);a.oCtx.cbOnErr(a,0)}var g_ver="14.3.319.2",g_iLgn=1,UP=38,DOWN=40,g_fRtl=window.document.documentElement.getAttribute("dir")=="rtl",g_sDE=g_fRtl?"&#x200F;":"&#x200E;",g_ocmS,T_CAL="IPF.Appointment",T_CON="IPF.Contact",T_DOC="IPF.DocumentLibrary",T_MSG="IPF.Note",T_TSK="IPF.Task",T_NTS="IPF.StickyNote",T_JNL="IPF.Journal",g_iMinVWW=163,g_iMinRPW=50,g_iMinRPH=50,BTN_BIU=1,BTN_JUSTIFY=2,BTN_LISTS=4,BTN_INDENT=8,BTN_DIR=16,BTN_FORE_COLOR=32,BTN_BACK_COLOR=64,BTN_REMOVE_FORMAT=128,BTN_INSERT_RULE=256,BTN_UNDO_REDO=512,BTN_LINKS=1024,BTN_SUBSCRIPT_SUPERSCRIPT=2048,BTN_STRIKE=4096,BTN_CUSTOMIZE=8192;function isFlgSt(b,a){return(b&a)==a}function isPFId(a){return a.startsW("PSF.")}function updateCalendarFolders(){setCSVAsStr(CSV_CALENDAR_FOLDERS_DT,new Date)}function padF(a){return"f"+a}function canDrg(a){a=a?a:event;var c=Owa.Dom.Event.isInstance(a)?a:new Owa.Dom.Event(a),b=new Owa.Components.Storage.DragDrop(c);b.deny()}function wda(a){return window.document.getElementById(a)}function getExpLgnAddress(){var b="",a=window.location.pathname.split("/");if(a.length>2&&a[2].indexOf("@")!==-1)b+=a[2]+"/";return b}function getEcpVdir(){return"/ecp/"+getExpLgnAddress()}function getOwaVdir(){return isDf(typeof a_fAnonymousAccess)&&a_fAnonymousAccess?Owa.Dom.Window.get_Current().get_Location().pathname:"/owa/"+getExpLgnAddress()}!g_fModuleLoaded[".\\components/hotkeymanagerdom.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");Owa.Components.HotKeyManagerDom=function Owa$Components$HotKeyManagerDom(c,b,a){Owa.Components.HotKeyManagerDom.constructBase(this,[c,a]);this._oTargetNode=b||Owa.Dom.Document.get_Current();this._oEventTargetNode=this._oTargetNode;this._fHookOnDocumentDueToNonFocusableTarget=false;if(!Owa.Dom.Document.isInstance(this._oTargetNode)&&!isInpt(this._oTargetNode)){this._fHookOnDocumentDueToNonFocusableTarget=true;this._oEventTargetNode=this._oTargetNode.get_OwnerDocument()}this._oEventTargetNode.attachEvent("keydown",this._createCallback(this._onKeyDown))};var a=Owa.Components.HotKeyManagerDom.prototype;a.dispose=function Owa$Components$HotKeyManagerDom$dispose(){this._oEventTargetNode.detachEvent("keydown",this._createCallback(this._onKeyDown));this._oTargetNode=null;this._oEventTargetNode=null;Owa.Components.HotKeyManagerDom.callBase(this,"dispose")};Owa.Components.HotKeyManagerDom.createClass("Owa.Components.HotKeyManagerDom",Owa.Components.HotKeyManager)})();g_fModuleLoaded[".\\components/hotkeymanagerdom.js".toLowerCase()]=1;var IMNS="IM";function sndIMReq(d,g,f,a){var c={};c.sC=d;c.cb=g;c.oCtrl=f;c.oRCtxt=a;c.oRCtxt.sEv=d;var e=false;if(d==IM_SI&&(!isDf(typeof a.fUserInitiated)||!a.fUserInitiated))e=true;var b=new oeReq(IMNS,d,c,cbIM,POST,"",false,e);switch(d){case IM_SCM:b.add("cMsg",a.sMsg);b.add("frmt",a.sFrmt);b.add("cId",a.sChtId);b.addRg("sUris",a.rgoRcp);break;case IM_SNCM:b.add("cMsg",a.sMsg);b.add("frmt",a.sFrmt);b.addRg("sUris",a.rgoRcp);if(isMSNPrv())isDf(typeof a.rType)&&a.rType.length>0&&a.rType[0]!=null&&b.add("iType",a.rType[0]);break;case IM_SC:b.add("sbsUris",isDf(typeof a.sUrisSub)?a.sUrisSub:"");b.add("unsbsUris",isDf(typeof a.sUrisUnsub)?a.sUrisUnsub:"");break;case IM_QP:b.add("qryUris",isDf(typeof a.sQryUris)?a.sQryUris:"");break;case IM_AB:isDf(typeof a.bdyAddr)&&b.add("bdyAddr",a.bdyAddr);isDf(typeof a.sDN)&&b.add("dName",a.sDN);isDf(typeof a.msg)&&b.add("msg",a.msg);isDf(typeof a.sGroupID)&&b.add("grpId",a.sGroupID);isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);break;case IM_RFBL:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.sGid)&&b.add("sGid",a.sGid);isDf(typeof a.iType)&&a.iType!=null&&b.add("iType",a.iType);break;case IM_ACPT:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.iType)&&b.add("iType",a.iType);isDf(typeof a.sGroupID)&&b.add("grpId",a.sGroupID);isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);break;case IM_DCL:case IM_UNBLK:case IM_BLK:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.iType)&&b.add("iType",a.iType);break;case IM_RFG:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.sGid)&&b.add("sGid",a.sGid);isDf(typeof a.sGroupID)&&b.add("grpId",a.sGroupID);isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);isDf(typeof a.sBuddyName)&&b.add("dName",a.sBuddyName);isDf(typeof a.fTagged)&&b.add("tag",a.fTagged);isDf(typeof a.rgGrpIds)&&b.addRg("grpIds",a.rgGrpIds);break;case IM_MB:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.sGid)&&b.add("sGid",a.sGid);isDf(typeof a.sOldGroupId)&&b.add("oldGrpId",a.sOldGroupId);isDf(typeof a.sOldGroupName)&&b.add("oldGrpNme",a.sOldGroupName);isDf(typeof a.sNewGroupId)&&b.add("newGrpId",a.sNewGroupId);isDf(typeof a.sNewGroupName)&&b.add("newGrpNme",a.sNewGroupName);isDf(typeof a.sBuddyName)&&b.add("dName",a.sBuddyName);isDf(typeof a.fTagged)&&b.add("tag",a.fTagged);isDf(typeof a.rgGrpIds)&&b.addRg("grpIds",a.rgGrpIds);break;case IM_CB:isDf(typeof a.sUri)&&b.add("bdyAddr",a.sUri);isDf(typeof a.sGid)&&b.add("sGid",a.sGid);isDf(typeof a.sGroupId)&&b.add("grpId",a.sGroupId);isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);isDf(typeof a.sBuddyName)&&b.add("dName",a.sBuddyName);isDf(typeof a.fTagged)&&b.add("tag",a.fTagged);isDf(typeof a.rgGrpIds)&&b.addRg("grpIds",a.rgGrpIds);break;case IM_CRG:isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);break;case IM_RMG:isDf(typeof a.sGroupName)&&b.add("grpNme",a.sGroupName);isDf(typeof a.sGroupID)&&b.add("grpId",a.sGroupID);break;case IM_RNG:isDf(typeof a.sGroupID)&&b.add("grpId",a.sGroupID);isDf(typeof a.sOldGroupName)&&b.add("oldGrpNme",a.sOldGroupName);isDf(typeof a.sNewGroupName)&&b.add("newGrpNme",a.sNewGroupName);break;case IM_NTP:case IM_NTPC:isDf(typeof a.sChtId)&&a.sChtId&&b.add("cId",a.sChtId);break;case IM_SI:isDf(typeof a.fMnlSI)&&b.add("mnlSI",a.fMnlSI);break;case IM_CPR:isDf(typeof a.prsnc)&&b.add("prsnce",a.prsnc);break;case IM_ECS:b.add("cId",a.sChtId);b.add("fDisc",a.fDisc);break;case IM_ITMINFO:b.add("mId",a.sMsgId);isDf(typeof a.gtNrmSub)&&a.gtNrmSub&&b.add("gtNrmSub","1");break;case IM_PSTEXP:b.addRg("grpIds",a.rgGrpIds);break;case IM_PXY:b.addRg("sUris",a.rgsUris);break;case IM_PIC:b.add("cId",a.sChtId)}a.sLDn&&b.add("lDn",a.sLDn);b.send()}function cbIM(b){hdPrgrsInd();if(b.sErr){var a=b.oCtx.oRCtxt;if(!cbOehST(b)){isDf(typeof a.feOnST)&&a.feOnST&&a.feOnST(a,true);return}if(a){a.iErr=b.iErr;a.sErr=b.sErr}isDf(typeof a.feOnErr)&&a.feOnErr&&a.feOnErr(a);return}var c=b.oCtx;c&&c.cb&&c.oRCtxt&&c.cb(c.oRCtxt,b.sBody)}var BID_PR="postreply",BID_PT="post",BID_RE="reply",BID_RECMB="replycombo",BID_RED="replydrpdwn",BID_REC="replybychat",BID_RES="replybysms",BID_REP="replybyphone",BID_RA="replyall",BID_FW="forward",BID_FWA="fwia",BID_FWCMB="forwardcombo",BID_FWD="forwarddrpdwn",BID_FWAD="fwiadrpdwn",BID_NP="newpst",BID_NT="newtsk",BID_DL="delete",BID_PDLT="permanentdelete",BID_IGNCNV="ignoreconversation",BID_CANIGNCNV="cancelignoreconversation",BID_CANIGNCNVDD="cancelignoreconversationdd",BID_DLDD="deletedrpdwn",BID_DLIGNDD="deleteigndrpdwn",BID_CM="checkmessages",BID_PN="print",BID_EDT="edt",BID_MV="move",BID_CHT="chat",BID_ABLST="ablst",BID_RMBLST="rmblst",BID_SNDSMS="sendsms",BID_CHP="chgperm",BID_SHCAL="shcurcal",BID_OPNCAL="opnshcal",BID_SHCNT="shcurcnt",BID_OPNCNT="opnshcnt",BID_SHTSK="shcurtsk",BID_OPNTSK="opnshtsk",BID_CAT="cat",BID_EXPALL="expandAll",BID_CLPSALL="collapseAll",BID_ACT="actions",BID_USECNV="useConversations",BIG_CNVOPTS="conversationOptions",BID_UNBLKBDY="unblkbdy",BID_BLKBDY="blkbdy",g_oDwn="btnDn",g_oRsd="btnR",g_oDsa="btnDa",g_oDwnTB="tbfP",g_oRsdTB="tbfHvr",g_oDsaTB="tbfD",g_oEmtDa="miDa",g_oMir="miR",g_oMid="miDn",g_oFlt="flat",g_oChtBtnFlt="chtBtnflat",g_oChtBtnDn="chtBtnDn",g_rgAllStyles=[g_oDwn,g_oRsd,g_oDsa,g_oDwnTB,g_oRsdTB,g_oDsaTB,g_oEmtDa,g_oMir,g_oMid,g_oFlt,g_oChtBtnFlt,g_oChtBtnDn];function initCmbFrmt(){var a=$("divCmbFrmt");if(a){g_oFormatCombobox=new Owa.UIControls.ComboBox(a);g_oFormatCombobox.initialize();a.setExpando("oComboBox",g_oFormatCombobox);g_oFormatCombobox.get_OnChange().add(onChgHtmlTxt);if(isDf(typeof a_fEdtMsg)&&a_fEdtMsg&&isDf(typeof a_fTxt))if(a_fTxt)g_oFormatCombobox.set_SelectedValue("1");else g_oFormatCombobox.set_SelectedValue("0")}}!g_fModuleLoaded[".\\uicontrols/transparentmask.js".toLowerCase()]&&(function(){Owa.UIControls.TransparentMask=function Owa$UIControls$TransparentMask(e,d,b){var a=b.createElement("div");b.appendChild(a);Owa.UIControls.TransparentMask.constructBase(this,[a]);var c=b.createElement("img");a.appendChild(c);c.setAttribute("src",getRsrcF("clear1x1.gif"));a.addCssClass("dlgMask");a._get_DomNode().style.zIndex=d;a.set_Id(e);this._cancelEvent(a,"keydown");this._cancelEvent(a,"contextmenu");this._cancelEvent(a,"click");this._cancelEvent(a,"mousedown")};Owa.UIControls.TransparentMask.prototype.dispose=function Owa$UIControls$TransparentMask$prototype$dispose(){this._get_Element().remove(true);Owa.UIControls.TransparentMask.callBase(this,"dispose")};Owa.UIControls.TransparentMask.prototype.setHandler=function Owa$UIControls$TransparentMask$setHandler(a,c){var b=this._get_Element();b.detachAllEvents(a);this._attachEvent(b,a,c)};Owa.UIControls.TransparentMask.createClass("Owa.UIControls.TransparentMask",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/transparentmask.js".toLowerCase()]=1;var g_iDlgZ=10,g_iDlgZFct=5,Dlg;!g_fModuleLoaded[".\\uicontrols/dialog.js".toLowerCase()]&&(function(){var a=[],c="onClose",d="onShow",b="onCancel";Dlg=Owa.UIControls.Dialog=function Owa$UIControls$Dialog(d,a,g,j,f,h,i,e){this.sId=d;this._fClickAway=g;this._fFocus=j;this._fNoDispose=h;this._oDialogParent=f;this._fKeyDown=i;var c=new Owa.Dom.Window(wt());if(a){a='<div id="'+d+'" class="dlg">'+a;if(!e)a+=getDropShadowMarkup();a+="</div>";c.get_Document().get_Body().insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,a)}var b=c.get_Document().getElementById(d);b._get_DomNode().style.zIndex=g_iDlgZ+g_iDlgZFct;b._get_DomNode().oDlg=this;Owa.UIControls.Dialog.constructBase(this,[b]);this._attachEvent(b,"dragstart",this._onDragStart);this._fOnOtherFrame=!c.equals(Owa.Dom.Window.get_Current());this.set_SubPage(Owa.Components.Application.get_RootSubPage())};Owa.UIControls.Dialog.prototype._fRemoveElementInDisposing=true;Owa.UIControls.Dialog.prototype.dispose=function Owa$UIControls$Dialog$dispose(){var a=this._get_Element();a._get_DomNode().oDlg=null;Owa.UIControls.Dialog.callBase(this,"dispose");this.fDisposed=1};Owa.UIControls.Dialog.prototype.show=function Owa$UIControls$Dialog$show(c,e,m,l){var b=this._get_Element(),f=b.get_OwnerDocument(),g=f.get_Body();b.set_IsShown(true);if(c==null){c=(g.get_ClientWidth()-b.get_ClientWidth())/2;e=(g.get_ClientHeight()-b.get_ClientHeight())/2;if(c<0||e<0){var i=0;if(c<0){i=c*-2+50;c=25}var j=0;if(e<0){j=e*-2+100;e=50}var k=f.get_ContainerWindow();k.resizeBy(i,j)}}b.set_Left(c);b.set_Top(e);g_iDlgZ+=g_iDlgZFct;this._oMask=new Owa.UIControls.TransparentMask(this.sId+"C",0,f);this._oMask.set_SubPage(this.get_SubPage());this._oMask.setHandler("keydown",this._createCallback(this._onKeyDown,null));this._oMask.setHandler("dragstart",this._createCallback(this._onDragStart,null));this._oMask._get_Element().moveToTop();b.moveToTop();!this._fKeyDown&&this._attachEvent(b,"keydown",this._onKeyDown);if(this._fClickAway){var h=this._createCallback(this._onClickAway,null);this._oMask.setHandler("click",h);this._oMask.setHandler("contextmenu",h)}m&&b.set_Top(getVisiblePositionY(b._get_DomNode(),e)+g.get_ClientHeight()-Owa.Dom.Document.get_Current().get_Body().get_ClientHeight());l&&b.set_Left(b.get_Left()-b.get_ClientWidth());this._fFocus&&b.focus(1);this._fOnOtherFrame&&a.indexOf(this)==-1&&a.push(this);this._dispatchEvent(d)};Owa.UIControls.Dialog.prototype.hide=function Owa$UIControls$Dialog$hide(e,d){if(this._fIsHiding)return;this._fIsHiding=1;if(this._oMask){this._oMask.dispose();this._oMask=null}this._oDialogParent&&setFcs(this._oDialogParent);this._get_Element().set_IsShown(false);if(!d){this._dispatchEvent(c);e&&this._dispatchEvent(b)}g_iDlgZ-=g_iDlgZFct;this._fOnOtherFrame&&a.remove(this);!this._fNoDispose&&this.dispose();this._fIsHiding=0};Owa.UIControls.Dialog.prototype._createCallback=function Owa$Components$Dialog$_createCallback(a,b){return Owa.Utility.createArgumentContextDelegate(this,a,b)};Owa.UIControls.Dialog.prototype.get_OnClose=function Owa$UIControls$Dialog$get_OnClose(){return this._getEventHandlerCollection(c)};Owa.UIControls.Dialog.prototype.get_OnShow=function Owa$UIControls$Dialog$get_OnShow(){return this._getEventHandlerCollection(d)};Owa.UIControls.Dialog.prototype.get_OnCancel=function Owa$UIControls$Dialog$get_OnCancel(){return this._getEventHandlerCollection(b)};Owa.UIControls.Dialog.prototype._onClickAway=function Owa$UIControls$Dialog$_onClickAway(a){a.preventDefault();a.cancelBubble();this.hide(1)};Owa.UIControls.Dialog.prototype._onKeyDown=function Owa$UIControls$Dialog$_onKeyDown(a){a.get_KeyCodeForKeyUpDown()==27&&this.hide(1);a.cancelBubble()};Owa.UIControls.Dialog.prototype._onDragStart=function Owa$UIControls$Dialog$_onDragStart(b){var a=new Owa.Components.Storage.DragDrop(b);a.deny()};Owa.UIControls.Dialog.createClass("Owa.UIControls.Dialog",Owa.UIControls.UIControl);function closeAllOpenedDialog(){for(var c=a.slice(0),b=0;b<c.length;b++)c[b].hide(null,true)}Owa.Dom.Window.get_Current().attachEvent("onunload",closeAllOpenedDialog)})();g_fModuleLoaded[".\\uicontrols/dialog.js".toLowerCase()]=1;var BtnDlg;!g_fModuleLoaded[".\\uicontrols/buttondialog.js".toLowerCase()]&&(function(){Owa.BUTTON_DIALOG_ICON={INFORMATION:0,QUESTION:1,WARNING:2,ERROR:3,OOF:7};var a="onButtonDialogClose";BtnDlg=Owa.UIControls.ButtonDialog=function Owa$UIControls$ButtonDialog(t,i,g,d,e,m,j,p,q,r,f,k,s,n){var a='<div class="btnDlg">';if(g!=null)a+=Owa.Components.CssSprites.getImageMarkup("closedlg.gif",'id="imgX" tabindex="0"',"dlgX",null)+'<div id="divDlgTtl" class="dlgTtl">'+(g==""?"&nbsp;":htmlEnc(g))+"</div>";a+='<div class="dlgSpacer"></div>';a+='<div class="dlgBdy" id="divBtnDlgBdy"><div class="dlgPrMsg">';if(m!=null)a+=getBtnDlgIcn(m)+"<div class='msgWithIcon'>"+i+"</div>";else a+=i;a+='</div><div class="dlgBtns">';if(f)a+='<div class="btnMsg">'+htmlEnc(f)+"</div>";for(var b=0;b<d.length;++b)a+='<button id="btn'+b+'">'+htmlEnc(d[b])+"</button>";if(f)a+='<div class="btnMsgClr"></div>';a+="</div>";if(k)a+='<div class="dlgSecMsg">'+htmlEnc(k)+"</div>";a+="</div>";a+=getDropShadowMarkup();a+="</div>";Owa.UIControls.ButtonDialog.constructBase(this,[t,a,q,1,p,r,false,true]);this.get_OnCancel().add(this._createCallback(this._onDialogCancel));j&&this.get_OnButtonDialogClose().add(j);this.oContext=s;if(n){var h=this._get_Element().get_OffsetWidth(),o=e?Math.max(e,h):h;this._get_Element().set_Width(o)}else if(e)this._get_Element().set_Width(e);else this._get_Element()._get_DomNode().style.width="30em";this.iBC=d.length;for(var b=0;b<d.length;++b){var c=this._getDescendant("btn"+b);c.setIntAttribute("iIcnTp",b);this._attachEvent(c,"click",this._onClickButton);c.onmouseover=new Function("btnOnMsOvrBtn(this)");c.onmouseout=new Function("btnOnMsOutBtn(this)")}this._adjustWidthForButtons();var l=this._getDescendant("imgX");l&&this._attachEvent(l,"click",this._onClickXImg)};Owa.UIControls.ButtonDialog.prototype.dispose=function Owa$UIControls$ButtonDialog$dispose(){for(var a=0;a<this.iBC;++a){var c=this._getDescendant("btn"+a);c.detachAllEvents()}var b=this._getDescendant("imgX");b&&b.detachAllEvents();Owa.UIControls.ButtonDialog.callBase(this,"dispose")};Owa.UIControls.ButtonDialog.prototype.getButton=function Owa$UIControls$ButtonDialog$getButton(c){for(var b=0;b<this.iBC;b++){var a=this._getDescendant("btn"+b);if(a.get_TagName().lc()=="button"&&a.get_TextContent()==c)return a}};Owa.UIControls.ButtonDialog.prototype.enableButton=function Owa$UIControls$ButtonDialog$enableButton(c,b){var a=this.getButton(c);if(a){a.set_IsDisabled(!b);if(b)!Owa.Utility.isIE()&&a.removeCssClass("dsbl");else{a.removeCssClass("btnHvr");!Owa.Utility.isIE()&&a.addCssClass("dsbl")}}};Owa.UIControls.ButtonDialog.prototype.get_OnButtonDialogClose=function Owa$UIControls$ButtonDialog$get_OnButtonDialogClose(){return this._getEventHandlerCollection(a)};Owa.UIControls.ButtonDialog.prototype._adjustWidthForButtons=function Owa$UIControls$ButtonDialog$_adjustWidthForButtons(){for(var c=50,e=1,b=0;b<this.iBC;++b)c=Math.max(c,this._getDescendant("btn"+b).get_OffsetWidth()+e);for(var d=0,a=0,b=0;b<this.iBC;++b){a=this._getDescendant("btn"+b);a.set_Width(c);d+=a.getEffectivePadding(Owa.Style.Side.Left)+a.getEffectiveMargin(Owa.Style.Side.Left)+a.getEffectivePadding(Owa.Style.Side.Right)+a.getEffectiveMargin(Owa.Style.Side.Left)+c}a&&a.focus(1);this._get_Element().get_OffsetWidth()<d&&this._get_Element().set_Width(d)};Owa.UIControls.ButtonDialog.prototype._onDialogCancel=function Owa$UIControls$ButtonDialog$_onDialogCancel(){this._dispatchEvent(a,-1,this.oContext)};Owa.UIControls.ButtonDialog.prototype._onClickButton=function Owa$UIControls$ButtonDialog$_onClickButton(c){var a=c.get_Target();if(a.get_IsDisabled())return;var b=a.getIntAttribute("iIcnTp");this.triggerButtonClickEvent(b)};Owa.UIControls.ButtonDialog.prototype._onClickXImg=function Owa$UIControls$ButtonDialog$_onClickXImg(){this.triggerButtonClickEvent(-1)};Owa.UIControls.ButtonDialog.prototype.triggerButtonClickEvent=function Owa$UIControls$ButtonDialog$triggerButtonClickEvent(c){var b=this._dispatchEvent(a,c,this.oContext);!b&&this.hide()};function getBtnDlgIcn(b){var a;switch(b){case Owa.BUTTON_DIALOG_ICON.INFORMATION:a="bdi_inf.gif";break;case Owa.BUTTON_DIALOG_ICON.QUESTION:a="bdi_qst.gif";break;case Owa.BUTTON_DIALOG_ICON.WARNING:a="bdi_wrn.gif";break;case Owa.BUTTON_DIALOG_ICON.OOF:a="oof.gif";break;case Owa.BUTTON_DIALOG_ICON.ERROR:a="warn.png"}return Owa.Components.CssSprites.getImageMarkup(a)}Owa.UIControls.ButtonDialog.createClass("Owa.UIControls.ButtonDialog",Owa.UIControls.Dialog)})();g_fModuleLoaded[".\\uicontrols/buttondialog.js".toLowerCase()]=1;function alrt(c,a,b,d){OKDlg(c,a,null,b,d).show()}function OKDlg(d,a,b,c,e){return OKDlgHtml(htmlEnc(d),a,b,c,e)}function OKDlgHtml(d,b,c,e,a){return new BtnDlg("okDlg"+rndm(),d,a?a:"",[L_OK],null,e,c,b)}function showConfirmDialog(d,c,a){var b=new BtnDlg("okDlg"+rndm(),htmlEnc(d),"",[L_OK,L_Cncl],null,Owa.BUTTON_DIALOG_ICON.QUESTION,null,null,null,null,null,null,a);b.get_OnButtonDialogClose().add(function(b){b==0&&c(a)});b.show()}if(!Owa.IM)Owa.IM={};var imns=Owa.IM,g_IMMgr=0,g_fIsIMEnab=0,g_fSignedIn=0,g_fSigningIn=isDf(typeof a_fSignedOutOfIM)&&!a_fSignedOutOfIM?1:0,g_iIM_SI=0,IM_TYPE_NONE=0,IM_TYPE_OCS=1,IM_TYPE_MSN=2,IM_PRTM1=5e3,IM_PRTM2=0,IM_PRTM_FRM=1,IM_SNCM="SndNwChtMsg",IM_SCM="SndChtMsg",IM_SC="SubChng",IM_QP="QryPrsnc",IM_AB="AddBdy",IM_RFBL="RemFrmBdyLst",IM_ACPT="AcceptBdy",IM_DCL="DeclineBdy",IM_BLK="BlockBuddy",IM_UNBLK="UnblockBuddy",IM_RFG="RemFrmGrp",IM_MB="MvBdy",IM_CB="CpBdy",IM_CRG="CrGrp",IM_RMG="RemGrp",IM_RNG="RenGrp",IM_GBL="GtBdyLst",IM_ISO="InvSmOne",IM_NTP="NtfyTpng",IM_NTPC="NtfyTpngCncl",IM_EDL="ExpndDL",IM_SI="SgnIn",IM_SO="SgnOut",IM_CPR="ChngPrsnc",IM_ADIMM="AccptDeclIMMsg",IM_ATCS="AddToChtSsn",IM_RFCS="RemFrmChtSsn",IM_ECS="EndChtSsn",IM_ITMINFO="GetItemIMInfo",IM_PSTEXP="PersistExpand",IM_PXY="GetProxies",IM_PIC="ParticipateInConversation",IM_PR_AV=0,IM_PR_MBAV=1,IM_PR_BSY=2,IM_PR_MBBSY=3,IM_PR_DND=4,IM_PR_BRB=5,IM_PR_AWAY=6,IM_PR_OFFL=7,IM_PR_ONLN=8,IM_PR_APPROFFL=9,IM_PR_IDLE=10,IM_PR_INCLL=11,IM_PR_OUTLNCH=12,IM_PR_BLKD=13,IM_PR_UNKNWN=14,g_rgsPrsncNm=["available","maybeavailable","busy","maybebusy","donotdisturb","berightback","away","offline","online","appearoffline","idle","inacall","outtolunch","blocked","unknown"];if(isDf(typeof L_Avlbl))var g_rgsPrsncLocNm=[L_Avlbl,L_MbAvlbl,L_Bsy,L_MbBsy,L_DND,L_BRB,L_Awy,L_Offl,L_Onln,L_ApprOffl,L_Idle,L_InCll,L_OutL,L_Blkd,L_Unknwn];var g_rgsJBF=["avlbl.png","away.png","busy.png","busy.png","dnd.png","away.png","away.png","offline.png","avlbl.png","offline.png","away.png","busy.png","away.png","blocked.png","unkwn.png"],OCS_Nn=0,OCS_Onln=3e3,OCS_IdlOnln=4500,OCS_Bsy=6e3,OCS_IdlBsy=7500,OCS_DND=9e3,OCS_BRB=12000,OCS_Awy=15000,OCS_Offln=18000,MSN_Offln=0,MSN_Onln=1,MSN_ApprOffln=2,MSN_Bsy=3,MSN_Idl=4,MSN_BRB=5,MSN_Awy=6,MSN_InCll=7,MSN_OtTLnch=8;function gtIMType(){var b=gtMstr();if(b){var a=b.a_iIMType;if(isDf(typeof a))return a}return IM_TYPE_NONE}function isMSNPrv(){return gtIMType()==IM_TYPE_MSN?1:0}function isOCSPrv(){return gtIMType()==IM_TYPE_OCS?1:0}function gtDfltPrsnc(){return isMSNPrv()?IM_PR_OFFL:IM_PR_UNKNWN}function stIMEnabFlg(){var a=gtMstr();if(!a||a&&isDf(typeof a.a_fIsExpLgn)&&a.a_fIsExpLgn){g_fIsIMEnab=0;return}if(isDf(typeof a.a_fIsImEnab))g_fIsIMEnab=a.a_fIsImEnab}function initIM(){stIMEnabFlg();if(g_fIsIMEnab)g_IMMgr=gtMstrIMMgr()}function dispIM(){g_IMMgr=0}function isSlfUri(a){if(!isDf(typeof a)&&!a)return 0;a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);return isSameUri(gtUri(),a)?1:0}function isSameUri(a,b){a=typeof a=="string"?Owa.IM.IMUtils.CleanUri(a):a;b=typeof b=="string"?Owa.IM.IMUtils.CleanUri(b):b;return a==b}function gtSlfPrsnc(c){var b=gtMstr(),a=gtDfltPrsnc();try{if(isDf(typeof c)&&c)a=b.a_iIMLstPrsnc;else a=b.a_iIMPrsnc}catch(d){}return a}function stSlfPrsnc(a,f){if(!isDf(typeof a))return;var b=gtMstr();try{if(isDf(typeof a)){if(isDf(typeof f)&&f)b.a_iIMLstPrsnc=a;else b.a_iIMLstPrsnc=b.a_iIMPrsnc;b.a_iIMPrsnc=a}var e=$("imgUserTileJB");e&&Owa.Components.CssSprites.updateImage(e,gtIMFFrmId(b.a_iIMPrsnc));var d=[],c={};c.prsnc=a;c.fNm=gtIMFFrmId(a);c.sUri=a_sUri;d.push(c);pushPrsnc(d)}catch(g){}}function gtUri(){var b="",a=gtMstr();if(a)try{b=a.a_sUri}catch(c){}return b}function gtDN(){var a=gtMstr();if(a)return isDf(typeof a.a_sDN)&&a.a_sDN?a.a_sDN:isDf(typeof a.a_sUri)&&a.a_sUri?imns.IMUtils.NrmSipUri(a.a_sUri):""}function gtIMFFrmId(a){return a>IM_PR_UNKNWN?null:g_rgsJBF[a]}function gtPrsncIdFrmVal(b){var a=gtIMType();if(a==IM_TYPE_OCS)switch(b){case OCS_Nn:return IM_PR_UNKNWN;case OCS_Onln:return IM_PR_AV;case OCS_IdlOnln:return IM_PR_MBAV;case OCS_Bsy:return IM_PR_BSY;case OCS_IdlBsy:return IM_PR_MBBSY;case OCS_DND:return IM_PR_DND;case OCS_BRB:return IM_PR_BRB;case OCS_Awy:return IM_PR_AWAY;case OCS_Offln:return IM_PR_OFFL}else if(a==IM_TYPE_MSN)switch(b){case MSN_Offln:return IM_PR_OFFL;case MSN_Onln:return IM_PR_ONLN;case MSN_ApprOffln:return IM_PR_APPROFFL;case MSN_Bsy:return IM_PR_BSY;case MSN_Idl:return IM_PR_IDLE;case MSN_BRB:return IM_PR_BRB;case MSN_Awy:return IM_PR_AWAY;case MSN_InCll:return IM_PR_INCLL;case MSN_OtTLnch:return IM_PR_OUTLNCH}return gtDfltPrsnc()}function gtPrsncValFrmNm(c){for(var b=gtIMType(),a=0;a<g_rgsPrsncNm.length;a++)if(c==g_rgsPrsncNm[a])if(b==IM_TYPE_OCS){switch(a){case IM_PR_UNKNWN:return OCS_Nn;case IM_PR_AV:return OCS_Onln;case IM_PR_MBAV:return OCS_IdlOnln;case IM_PR_BSY:return OCS_Bsy;case IM_PR_MBBSY:return OCS_IdlBsy;case IM_PR_DND:return OCS_DND;case IM_PR_BRB:return OCS_BRB;case IM_PR_AWAY:return OCS_Awy;case IM_PR_OFFL:return OCS_Offln}return OCS_Nn}else if(b==IM_TYPE_MSN){switch(a){case IM_PR_OFFL:return MSN_Offln;case IM_PR_ONLN:return MSN_Onln;case IM_PR_APPROFFL:return MSN_ApprOffln;case IM_PR_BSY:return MSN_Bsy;case IM_PR_IDLE:return MSN_Idl;case IM_PR_BRB:return MSN_BRB;case IM_PR_AWAY:return MSN_Awy;case IM_PR_INCLL:return MSN_InCll;case IM_PR_OUTLNCH:return MSN_OtTLnch}return MSN_Offln}return b==IM_TYPE_MSN?MSN_Offln:OCS_Nn}function pushPrsnc(a){if(!isDf(typeof a_isMstr))pushFrmPrsnc(a);else{pushPrsncRP(a);g_winMgr.PushPrsnc(a)}}function pushPrsncRP(d){var e=0;if(isDf(typeof a_sLstFID)&&a_sLstFID){var b;try{b=getViewSubPageControllerByFolderId(a_sLstFID).getElementById("ifRP");if(!b)return;var c=Owa.Components.SubPageControllerFactory.getControllerByElement(b),a=c.get_SubPage();a&&a.get_IsShown(true)&&a.invokeSubPageFunction("pushFrmPrsnc",[d,a])}catch(f){}}}function updFrmPrsnc(a){if(g_fIsIMEnab&&gtMstr()&&(gtMstr().g_fSignedIn||gtMstr().g_fSigningIn)){a=a||Owa.UIControls.SubPage.get_Instance();updSndrPrsnc(a);updAllRwPrsnc(a);if(isOCSPrv())if(!isDf(typeof a_fChtWin))a._setTimeout(qryPrsnc,IM_PRTM1,a);else a._setTimeout(subPrsnc,IM_PRTM2,a)}}function pushFrmPrsnc(a,h){if(isDf(typeof a)&&a&&a.length)for(var g,d,e,f=0;f<a.length;f++){d=a[f];e=d.sUri;var b=[],c=gtIMMgr().pxyLst.GetProxies(e);if(c&&c.length)b=c;else b.push(e);for(var g=0;g<b.length;g++){var i=b[g];pushFrmPrsncForUri(i,d,h)}}}function pushFrmPrsncForUri(f,d,a){var c,b,e;a=a||Owa.UIControls.SubPage.get_Instance();if(!a.get_utRecipientWellPresence())return;b=a.get_utRecipientWellPresence().Get(f);if(b)for(c=0;c<b.length;c++){setJBPrsnc(b[c].jb,d.prsnc);if(isDf(typeof a_fChtWin)){e=b[c].spn;if(isSameUri(e.getAttribute("_uri"),f)&&isDf(typeof d.sDN)){e._oDomNode.childNodes[1].nodeValue=d.sDN;rszRw(a._getDescendant(TO));gtIMMgr().UpdChtTtl(g_oChtWin.sChtId,0,f,d.sDN)}}}}function qryPrsnc(c){if(g_fIsIMEnab&&gtMstr()&&(gtMstr().g_fSignedIn||gtMstr().g_fSigningIn)){var b=[];for(var a in c.get_utQueryPresence(true).Keys())!isBuddy(a)&&!isSlfUri(a)&&b.push(a);try{gtIMMgr().QryPrsnc(b)}catch(d){}}}function subPrsnc(b){var a=[];for(var c in b.get_utQueryPresence(true).Keys())a.push(c);try{gtIMMgr().SubPrsnc(a)}catch(d){}}function gtPrsncFrmMstr(b){var a={};if(b&&gtIMMgr())try{a.prsnc=gtIMMgr().gtPrsnc(b);var c=gtIMMgr().gtDN(b);if(c)a.sDN=c}catch(d){a.prsnc=gtDfltPrsnc()}else a.prsnc=gtDfltPrsnc();a.fNm=gtIMFFrmId(a.prsnc);return a}function isBuddy(a){if(!isDf(typeof a)||!a)return 0;if(gtIMMgr())try{return gtIMMgr().IsBdy(a)}catch(b){return 0}else return 0}function gtStlUri(a){if(!isDf(typeof a)||!a)return;if(gtIMMgr())try{return gtIMMgr().GtStlUri(a)}catch(b){return 0}else return}function addBdyLstReq(i,a,f,j,h){if(!isDf(typeof a)||!a)return;if(Owa.Utility.isDefined(typeof a.getAttribute))a=crtRecipObjectFromDomObject(a);var k=gtRcpDn(a),d=gtRcpIM(a),g=0;if(getInt(a._ao)==AO_D&&a._sipTrsp)g=1;if(!d&&!a._sipTrsp){noIMInfoErr();return}if(isSlfUri(d)&&!a._sipTrsp){slfBddyErr();return}if(isBuddy(d)&&!a._sipTrsp)return;var b={};if(g)b.sLDn=a._em;b.sDN=k;b.bdyAddr=d;b.sEml=isDf(typeof a._em)&&a._em?a._em:0;b.msg=isDf(typeof f)&&f?f:"";if(getInt(a._ao)==AO_D&&isDf(typeof a._lgDn)&&a._lgDn)b.sEml=a._lgDn;var e=gtIMMgr().bdyLst,c;if(h)c=e.GetGroup(h);if(!c)c=e.GetGroup(e.sOtherContactsID);if(c){b.sGroupID=imns.IMUtils.NrmGrpID(c.groupID);b.sGroupName=c.groupName}b.feOnErr=onIMRequestError;b.feOnST=onIMRequestError;b.fnCallback=j;b.oCallerSubPage=i;sndIMReq(IM_AB,cbAddBdyReq,0,b)}function cbAddBdyReq(b,c){var a=b.oCallerSubPage;if(isMSNPrv())Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_ABLST,true);else if(isDf(typeof a_fOrgP)||a&&(isDf(typeof a.getSubPageVariable("a_fDir"))&&a.getSubPageVariable("a_fDir"))){Owa.Components.ToolbarCollection.get(a).set_IsButtonShown(BID_RMBLST,true);Owa.Components.ToolbarCollection.get(a).set_IsButtonShown(BID_ABLST,false);Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_RMBLST,false)}if(c)if(gtIMMgr())try{gtIMMgr().StStlUri(c,b.bdyAddr)}catch(d){}b.fnCallback&&b.fnCallback()}function rmBdyLstReq(g,a){if(!isDf(typeof a)||!a)return;var h=gtRcpDn(a),c=gtRcpIM(a);c=gtIMMgr().pxyLst.GetBuddyPrimaryUri(c);var d=0;if(a._ao==AO_D&&a._sipTrsp)d=1;var e=gtIMMgr().bdyLst,f;if(!d)f=e.GtBdy(c).sGid;if(!c&&!a._sipTrsp){noIMInfoErr();return}if(!isBuddy(c)&&!a._sipTrsp)return;var b={};if(d)b.sLDn=a._em;b.sUri=c;b.sGid=f;b.iType=e.GetBuddyType(c);b.feOnErr=onIMRequestError;b.feOnST=onIMRequestError;b.oCallerSubPage=g;sndIMReq(IM_RFBL,cbRmBdyReq,0,b)}function cbRmBdyReq(c,b){var a=c.oCallerSubPage;if(isMSNPrv()){Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_RMBLST,true);Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_CHT,true)}else if(isDf(typeof a_fOrgP)||isDf(typeof a_fDir)&&a_fDir){Owa.Components.ToolbarCollection.get(a).set_IsButtonShown(BID_RMBLST,false);Owa.Components.ToolbarCollection.get(a).set_IsButtonShown(BID_ABLST,true);Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_ABLST,false)}if(b)if(gtIMMgr())try{gtIMMgr().StStlUri(b,c.sUri)}catch(d){}}function rmFrmGrpReq(m,b){if(!isDf(typeof b)||!b)return;var o=gtRcpDn(b),c=gtRcpIM(b),i=0,k,f=0;if(b._ao==AO_D&&b._sipTrsp)i=1;var d=gtIMMgr().bdyLst,g=d.GtBdy(c),l;if(!i)l=g.sGid;if(!c&&!b._sipTrsp){noIMInfoErr();return}if(!isBuddy(c)&&!b._sipTrsp)return;var j=b.getAttribute("_gID");if(j){var n=d.GetGroup(j);k=n.groupName;f=imns.IMUtils.NrmGrpID(j)}var a={};if(i)a.sLDn=b._em;a.sUri=c;a.sGid=l;a.iType=d.GetBuddyType(c);if(f){a.sGroupID=f;a.sGroupName=k}a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;if(isOCSPrv()){a.sBuddyName=g.dn;a.fTagged=g.fTag;for(var e=g.GetBuddyGroups(),h=0;h<e.length;h++)e[h]=imns.IMUtils.NrmGrpID(e[h].groupID);a.rgGrpIds=e}a.oCallerSubPage=m;if(f==imns.IMUtils.NrmGrpID(d.sOtherContactsID))sndIMReq(IM_RFBL,cbRmBdyReq,0,a);else sndIMReq(IM_RFG,null,0,a)}function copyToGroupRequest(h,g){CB(g,h);var f=gtIMMgr().bdyLst,b=f.GtBdy(h);if(!b)return;var e=f.GetGroup(g);if(!e)return;var a={};a.sUri=b.uri;a.sGid=b.sGid;a.sGroupId=imns.IMUtils.NrmGrpID(e.groupID);a.sGroupName=e.groupName;a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;if(isOCSPrv()){a.sBuddyName=b.dn;a.fTagged=b.fTag;for(var c=b.GetBuddyGroups(),d=0;d<c.length;d++)c[d]=imns.IMUtils.NrmGrpID(c[d].groupID);a.rgGrpIds=c}sndIMReq(IM_CB,null,0,a)}function moveToGroupRequest(j,i,h){MB(i,h,j);var e=gtIMMgr().bdyLst,b=e.GtBdy(j);if(!b)return;var g=e.GetGroup(i),f=e.GetGroup(h);if(!g||!f)return;var a={};a.sUri=b.uri;a.sGid=b.sGid;a.sOldGroupId=imns.IMUtils.NrmGrpID(g.groupID);a.sOldGroupName=g.groupName;a.sNewGroupId=imns.IMUtils.NrmGrpID(f.groupID);a.sNewGroupName=f.groupName;a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;if(isOCSPrv()){a.sBuddyName=b.dn;a.fTagged=b.fTag;for(var c=b.GetBuddyGroups(),d=0;d<c.length;d++)c[d]=imns.IMUtils.NrmGrpID(c[d].groupID);a.rgGrpIds=c}sndIMReq(IM_MB,null,0,a)}function removeGroupRequest(d){var c=gtIMMgr();if(!c)return;var b=c.bdyLst.GetGroup(d);if(!b)return;var a={};a.sGroupID=imns.IMUtils.NrmGrpID(b.groupID);a.sGroupName=b.groupName;a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;sndIMReq(IM_RMG,null,0,a)}function renameGroupRequest(b,c){var a={};a.sGroupID=imns.IMUtils.NrmGrpID(b.groupID);a.sOldGroupName=b.groupName;a.sNewGroupName=c;a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;sndIMReq(IM_RNG,null,0,a)}function createGroupRequest(b){var a={};a.sGroupName=b;a.feOnErr=onIMRequestError;a.feOnST=onIMRequestError;sndIMReq(IM_CRG,null,0,a)}function cbBuddyInviteRequest(a){Owa.UIControls.BuddyDialog.getDialog().removeBuddy(a.sUri)}function blkBdyReq(a,b){if(!isDf(typeof a)||!a)return;var c=gtRcpIM(a);blockBuddyRequest(c,b)}function blockBuddyRequest(a,c){if(!a){noIMInfoErr();return}a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);var b={};b.sUri=a;b.iType=gtIMMgr().bdyLst.GetBuddyType(a);if(isDf(typeof c)&&c)sndIMReq(IM_UNBLK,null,0,b);else sndIMReq(IM_BLK,null,0,b)}function gtRcpDn(a){var b=Owa.Dom.Node.wrapDomNode(a);return isDf(typeof a._dn)&&a._dn&&a._dn!="0"?a._dn:a.getAttribute&&a.getAttribute("_dn")&&a.getAttribute("_dn")!="0"?a.getAttribute("_dn"):isDf(typeof a.dn)&&a.dn?a.dn:b.get_TextContent()&&b.get_TextContent()!="0"?b.get_TextContent():isDf(typeof a._em)&&a._em?a._em:a.getAttribute&&a.getAttribute("_em")?a.getAttribute("_em"):isDf(typeof a.eml)&&a.eml?a.eml:isDf(typeof a._uri)&&a._uri?imns.IMUtils.NrmSipUri(a._uri):a.getAttribute&&a.getAttribute("_uri")?imns.IMUtils.NrmSipUri(a.getAttribute("_uri")):isDf(typeof a.uri)&&a.uri?a.uri:""}function enbIMBtns(e,g,d,f){var c=g&&(gtMstr()&&gtMstr().g_fSignedIn)&&!isJnkFld(e)&&!f,b=c&&(isOCSPrv()||d&&isMSNPrv());f&&enblIMBtnsRP(b);var a=Owa.Components.ToolbarCollection.get(e);a.set_IsButtonDisabled(BID_CHT,!b);a.set_IsButtonDisabled(BID_REC,!b);a.set_IsButtonShown(BID_ABLST,!d);a.set_IsButtonDisabled(BID_ABLST,!c);a.set_IsButtonShown(BID_RMBLST,d);a.set_IsButtonDisabled(BID_RMBLST,!c)}function enblIMBtnsRP(b){if(isDf(typeof a_sLstFID)&&a_sLstFID){var a=getViewSubPageControllerByFolderId(a_sLstFID);a&&a.invokeFunction("enblIMBtnsFrm",[b])}}function enblIMBtnsFrm(b){var a=Owa.Components.Application.get_RootSubPage();Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_CHT,!b);Owa.Components.ToolbarCollection.get(a).set_IsButtonDisabled(BID_REC,!b)}function onIMRequestError(a,c){if(a.iErr==28)noIMInfoErr();else if(a.iErr==29)slfBddyErr();else if(a.sEv==IM_AB)ACF(a.bdyAddr);else if(a.sEv==IM_RFBL)RCF(a.sUri);else if(a.sEv==IM_RFG)RE(L_ErrRemoveBuddyFromGroupFailed.replace(/\{0\}/,Owa.IM.IMUtils.NrmSipUri(a.sUri)).replace(/\{1\}/,a.sGroupName));else if(a.sEv==IM_CB)REMB(L_ErrCopyBuddyFailed.replace(/\{0\}/,Owa.IM.IMUtils.NrmSipUri(a.sUri)).replace(/\{1\}/,a.sGroupName));else if(a.sEv==IM_MB)REMB(L_ErrAddBuddyToGroupFailed.replace(/\{0\}/,Owa.IM.IMUtils.NrmSipUri(a.sUri)).replace(/\{1\}/,a.sNewGroupName));else if(a.sEv==IM_RNG||a.sEv==IM_CRG){var b;if(!a||a.sErr)b=a.sErr;else if(a.sEv==IM_RNG)b=L_ErrRenameGroupFailed.replace(/\{0\}/,htmlEnc(a.sOldGroupName)).replace(/\{1\}/,htmlEnc(a.sNewGroupName));else if(a.sEv==IM_CRG)b=L_ErrAddGroupFailed.replace(/\{0\}/,htmlEnc(a.sGroupName));REGE(b,c)}else a.sEv==IM_RMG&&RE(L_ErrRemGrp.replace(/\{0\}/,a.sGroupName))}function noIMInfoErr(){alrt(L_ErrNoIMInfo,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function slfChtErr(){alrt(L_ErrSlfCht,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}function slfBddyErr(){alrt(L_ErSlfBdy,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function failStrtCht(){alrt(L_ErrStrtCht,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function failChtMsgDlv(a){if(a.iErr==28)noIMInfoErr();else if(a.iErr==29)slfChtErr();else a.oChtWin&&a.oChtWin.InActMsg(imns.ACT_FAILMSGDLV)}function nwChtFrmRcp(a){try{gtIMMgr().NwChtSsnRcp(a)}catch(b){}}function nwChtSsnFrm(){var f=$("spnFrom"),e=crtRecipObjectFromDomObject(f);if(gtIMMgr()){var d=Owa.Utility.isDefined(typeof a_sFId)?a_sFId:null,c=Owa.Utility.isDefined(typeof a_sId)?a_sId:null,a=$("divSubj"),b="";if(a)b=a.get_TextContent();gtIMMgr().NwChtSsnMw(b,e,d,c)}}Owa.IM.UriTable=function Owa$IM$UriTable(){this.table={};this.count=0};Owa.IM.UriTable.prototype.Keys=function Owa$IM$UriTable$Keys(){return this.table};Owa.IM.UriTable.prototype.Get=function Owa$IM$UriTable$Get(b){if(!b||typeof b!="string")return 0;var a=this.table[b];if(typeof a!="undefined")return a;a=this.table[Owa.IM.IMUtils.CleanUri(b)];return typeof a=="undefined"?0:a};Owa.IM.UriTable.prototype.Set=function Owa$IM$UriTable$Set(b,d){if(!b||typeof b!="string")return 0;var c=Owa.IM.IMUtils.CleanUri(b),a=0;if(!this.Get(c))a=1;this.table[c]=d;if(d!==null){this.count+=a;return a}return 0};Owa.IM.UriTable.prototype.Remove=function Owa$IM$UriTable$Remove(b,c,d){if(!b||typeof b!="string")return 0;var a=Owa.IM.IMUtils.CleanUri(b);if(typeof this.table[a]=="undefined")return 0;if(c)delete this.table[a];this.table[a]=d?null:0;this.count--;return 1};Owa.IM.UriTable.prototype.Count=function Owa$IM$UriTable$Count(){return this.count};Owa.IM.IMUtils=function Owa$IM$IMUtils(){};Owa.IM.IMUtils.CleanUri=function Owa$IM$IMUtils$CleanUri(a){return typeof a!="string"?"":isOCSPrv()?Owa.IM.IMUtils.FrmSipUri(a.toLowerCase()):Owa.IM.IMUtils.NrmSipUri(a.toLowerCase())};Owa.IM.IMUtils.NrmSipUri=function Owa$IM$IMUtils$NrmSipUri(a){return Owa.IM.IMUtils.NormalizeString("sip",a)};Owa.IM.IMUtils.NrmGrpID=function Owa$IM$IMUtils$NrmGrpID(a){return Owa.IM.IMUtils.NormalizeString("grp",a)};Owa.IM.IMUtils.NormalizeString=function Owa$IM$IMUtils$NormalizeString(b,a){if(a==null||a=="")return"";if(b==null||b=="")return a;b=b+":";if(typeof a!="string")a+="";var a=a.trim();return a.lc().indexOf(b)==0?a.substring(b.length,a.length):a};Owa.IM.IMUtils.FrmSipUri=function Owa$IM$IMUtils$FrmSipUri(a){return Owa.IM.IMUtils.FormalizeString("sip",a)};Owa.IM.IMUtils.FormalizeString=function Owa$IM$IMUtils$FormalizeString(b,a){if(b==null||b=="")return a;if(a==null)return"";b=b+":";if(typeof a!="string")a+="";if(a=="")return"";a=a.trim();if(a.lc().indexOf(b)!=0)a=b+a;return a};var oToastButtonTimer=0,oPendingToasts={},iPendingToastsCount=0;Owa.IM.IMUtils.ShowNewChatToast=function Owa$IM$IMUtils$ShowNewChatToast(e,g,b,a,d){var c=15000,f=gtIMMgr().bdyLst.GtBdy(g);if(f)b=f.dn;var i=$(Owa.Strings.Ids.NewChatNotificationButtonId);if(!i)return;if(iPendingToastsCount>0){window.clearTimeout(oToastButtonTimer);b=L_MultipleToastsHeader;a=L_MultipleToastsBody.replace(/\{0\}/,iPendingToastsCount+1)}else if(d)a=L_InvitedToConference;else if(!a||a=="")a=L_InvitedToConversation;oPendingToasts[e]={sChatId:e,sUri:g,fIsConf:d};iPendingToastsCount++;showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,true);Owa.UIControls.NewItemAlertDialog.hideDialog(1);Owa.UIControls.NewItemAlertDialog.clearTimer();if(!Owa.UIControls.NotificationDialog.anyDialogsOpen()){var h=new Owa.UIControls.NewItemAlertDialog(Owa.Strings.Ids.NewChatNotificationButtonId,b,a,Owa.Components.CssSprites.getImageMarkup("newchat.gif","","nwItmImg",null),function(){},Owa.IM.IMUtils.ClickNewChatToast);h.show();Owa.UIControls.NewItemAlertDialog.setTimer("Owa.UIControls.NewItemAlertDialog.hideDialog();",c)}oToastButtonTimer=window.setTimeout("Owa.IM.IMUtils.HideNewChatToast();",c)};Owa.IM.IMUtils.HideNewChatToast=function Owa$IM$IMUtils$HideNewChatToast(a){if(!a){oPendingToasts={};iPendingToastsCount=0}else{var b=oPendingToasts[a];if(b){delete oPendingToasts[a];if(iPendingToastsCount>0)iPendingToastsCount--}}if(iPendingToastsCount>0)return;window.clearTimeout(oToastButtonTimer);oToastButtonTimer=0;showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,false);Owa.UIControls.NewItemAlertDialog.isType(Owa.Strings.Ids.NewChatNotificationButtonId)&&Owa.UIControls.NewItemAlertDialog.hideDialog()};Owa.IM.IMUtils.ClickNewChatToast=function Owa$IM$IMUtils$ClickNewChatToast(){window.clearTimeout(oToastButtonTimer);showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,false);if(!Owa.Utility.isChrome()&&!Owa.Utility.isSafari())window.setTimeout("Owa.IM.IMUtils.ClickNewChatToastDelayed()",1);else Owa.IM.IMUtils.ClickNewChatToastDelayed()};Owa.IM.IMUtils.ClickNewChatToastDelayed=function Owa$IM$IMUtils$ClickNewChatToastDelayed(){var a;for(a in oPendingToasts){var b=oPendingToasts[a];NIM(a,b.sUri,"","","",null,b.fIsConf);var c={};c.sChtId=a;sndIMReq(IM_PIC,0,0,c)}oPendingToasts={};iPendingToastsCount=0};Owa.IM.IMUtils.SetMenuSISOBeforeShow=function Owa$IM$IMUtils$SetMenuSISOBeforeShow(a){a.showMenuItem("divSOIM",this.fShowMenuItemSOIM);a.showMenuItem("divSIIM",this.fShowMenuItemSIIM);var b,c=gtIMType();if(c==IM_TYPE_OCS)b=["divAVLBL","divBSY","divDND","divBRB","divAWAY"];else b=["divAVLBL","divBSY","divAWAY","divOFFL"];a.enableMenuItems(b,this.fShowMenuItemSOIM)};Owa.IM.IMUtils.SetMenuSISO=function Owa$IM$IMUtils$SetMenuSISO(a){if(a){this.fShowMenuItemSOIM=false;this.fShowMenuItemSIIM=false}else{this.fShowMenuItemSOIM=gtMstr()&&gtMstr().g_fSignedIn;this.fShowMenuItemSIIM=gtMstr()&&!gtMstr().g_fSignedIn}};function ButtonStyle(b,c){b.className=c;var a=gtStl(b);this.color=a.color;this.backgroundColor=a.backgroundColor;this.borderColor=a.borderTopColor;this.borderStyle=a.borderTopStyle;this.borderWidth=a.borderTopWidth;this.padding=a.padding;this.fontWeight=a.fontWeight}function showEms(a,c){if(!a.length)a=new Array(a);for(var b=0;b<a.length;b++)showEm(a[b],c)}function showEm(a,b){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();if(b)hideEm(a);else a.style.display=""}function hideEm(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();a.style.display="none"}function setVsblEm(b,a){b.style.visibility=a?"visible":"hidden"}function isDisp(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();return a!=null&&gtStl(a).display!="none"}function getEm(b,a){if(!a)a=window.document;return a.createElement(b)}function wdb(){return window.document.body}function wtda(b,a){if(!a)a=wt();return getOneDescendant(gtWD(a),b)}function adEm(g,d,c,b,e,f){var a=getEm(g,b?god(b):0);if(d)a.id=d;if(e)a.className=e;if(c)f?(a.innerText=c):(a.innerHTML=c);b&&b.appendChild(a);return a}function posEm(a,b,c){spl(a,b);spt(a,c)}function rszEm(a,c,b){spw(a,c);sph(a,b)}function gtScrPrnt(d,c){var a=d,b=null;while((a=a.offsetParent)!=null&&(!c||!(a.nodeName.match(/^body$/i)||a.nodeName.match(/^html$/i))))if(a.scrollHeight>a.offsetHeight){b=a;break}return b}function getCX(a,c,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);if(b&&!Owa.Dom.Node.isInstance(b))b=Owa.Dom.Node.wrapDomNode(b);return c?a.get_PositionalLeft():a.get_DocumentLeft()}function getCY(a,c,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);if(b&&!Owa.Dom.Node.isInstance(b))b=Owa.Dom.Node.wrapDomNode(b);return c?a.get_PositionalTop():a.get_DocumentTop()}function sph(a,b){if("pixelHeight"in a.style)a.style.pixelHeight=b;else a.style.height=b+"px"}function spw(b,a){if(a>=0)b.style.width=a+"px"}function gch(a){return a.clientHeight}function gcw(a){return a.clientWidth}function goh(a){return a.offsetHeight}function gow(a){return a.offsetWidth}function got(a){return a.offsetTop}function gol(a){return a.offsetLeft}function gsw(a){return a.scrollWidth}function spl(a,b){if("pixelLeft"in a.style)a.style.pixelLeft=b;else a.style.left=b+"px"}function splc(b,a){gol(b)!=a&&spl(b,a)}function spt(a,b){if("pixelTop"in a.style)a.style.pixelTop=b;else a.style.top=b+"px"}function ibb(a,b){return Owa.Dom.Node.wrapDomNode(a).insertAdjacentElement("beforeBegin",Owa.Dom.Node.wrapDomNode(b))._get_DomNode()}function iab(a,b){return Owa.Dom.Node.wrapDomNode(a).insertAdjacentElement("afterBegin",Owa.Dom.Node.wrapDomNode(b))._get_DomNode()}function ibe(a,b){return Owa.Dom.Node.wrapDomNode(a).insertAdjacentElement("beforeEnd",Owa.Dom.Node.wrapDomNode(b))._get_DomNode()}function iae(a,b){return Owa.Dom.Node.wrapDomNode(a).insertAdjacentElement("afterEnd",Owa.Dom.Node.wrapDomNode(b))._get_DomNode()}function ibeh(a,b){Owa.Dom.Node.wrapDomNode(a).insertAdjacentHtml("beforeEnd",b)}function iaeh(a,b){Owa.Dom.Node.wrapDomNode(a).insertAdjacentHtml("afterEnd",b)}function iatae(a,b){Owa.Dom.Node.wrapDomNode(a).insertAdjacentText("afterEnd",b)}function rn(a){Owa.Dom.Node.wrapDomNode(a).remove(true)}function ra(b,a){b.removeAttribute(a)}function chk(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();a.checked=1}function chkd(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();return a.checked?1:0}function ac(a){document.documentElement.appendChild(a)}function god(a){return a.ownerDocument}function gtw(b){var a=gow(b);a+=parseInt(0+gtStl(b,"marginLeft"),10);a+=parseInt(0+gtStl(b,"marginRight"),10);return a}function setFcs(a,b){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();try{function fcs(){try{a.focus()}catch(b){}}if(god(a).parentWindow)god(a).parentWindow.setTimeout(fcs,b?b:1);else god(a).defaultView&&god(a).defaultView.setTimeout(fcs,b?b:1)}catch(c){}}function setData(a){a!=null&&window.clipboardData.setData("Text",a)}String.prototype.startsW=function String$startsW(a){return this.indexOf(a)==0};String.prototype.lc=function String$lc(){return this.toLowerCase()};function errSty(c,b){if(!g_oDsSty)g_oDsSty=getStyle("cmDsbld");var a=c.style;a.color=b?g_oDsSty.color:"";a.cursor=b?g_oDsSty.cursor:""}function getStyle(c,b){if(b)var a=getEm(b);else var a=getEm("A");a.style.display="none";a.className=c;ibe(document.body,a);return gtStl(a)}function btnOnMsOvrBtn(a){Owa.Dom.Node.wrapDomNode(a).addCssClass("btnHvr")}function btnOnMsOutBtn(a){Owa.Dom.Node.wrapDomNode(a).removeCssClass("btnHvr")}function gtWD(a){try{return a.document}catch(b){Owa.BrowserErrorHandler.handleFrameAccessError(b)}}var g_oDsSty=null;function gtStl(a,b){return a.currentStyle?b?a.currentStyle[b]:a.currentStyle:b?window.getComputedStyle(a,b):window.getComputedStyle(a,"")}function getOneDescendant(d,e){if(d.getElementById)return d.getElementById(e);var b=d.getElementsByTagName("*"),a=b[e];if(isRg(a))a=a[0];else if(a==null&&!Owa.Utility.isIE())for(var c=0;c<b.length;c++)if(b[c].id==e){a=b[c];break}return a}function getOneChild(c,b){var a=c.firstChild;while(a){if(a.id==b)return a;a=a.nextSibling}return null}function getDescendants(e,f){var a=[];if(e.all){var c=e.all[f];if(c)if(isRg(c))a=c;else a.push(c)}else for(var d=e.getElementsByTagName("*"),b=0;b<d.length;b++)d[b].id==f&&a.push(d[b]);return a}function scrollIntoView(d,c){var b=0,a=d;while(a&&a!=c){b+=got(a);a=a.offsetParent}c.scrollTop=b}function getVisiblePositionX(b,i){var d=gcw(god(b).body),c=gcw(b),g=getInt(gtStl(b,"borderLeftWidth"))+getInt(gtStl(b,"borderRightWidth"));if(!isNaN(g))c+=g;var f=0,a=i,e=Owa.Dom.Node.wrapDomNode(b.parentNode);if(e.get_OverflowX()==Owa.Style.Overflow.Scroll||e.get_OverflowX()==Owa.Style.Overflow.Auto)d=e.get_Width();else{f=getCX(b.offsetParent);a=f+i}if(!g_fRtl){var h=a+c-d;if(h>0)a-=h;if(a<0)a=0}else{if(a<0)a=0;if(a+c>d)a=d-c}return a-f}function getVisiblePositionY(a,i){var c=god(a).body,e=gch(a),f=getInt(gtStl(a,"borderTopWidth"))+getInt(gtStl(a,"borderBottomWidth"));if(!isNaN(f))e+=f;var d=0,b=i,g=Owa.Dom.Node.wrapDomNode(a.parentNode);if(g.get_OverflowY()==Owa.Style.Overflow.Scroll||g.get_OverflowY()==Owa.Style.Overflow.Auto)c=a.parentNode;else{d=getCY(a.offsetParent);b=d+i}var h=b+e-goh(c)-c.scrollTop;if(h>0)b-=h;if(b<0)b=0;return b-d}var OP_SAV=1,OP_SND=2,OP_CLS=4,OP_DEL=16,OP_SN_ALL=32,OP_SN_MD=64,OP_GT_CERT=128,OP_VLD_CERT=256,OP_SND_MR=512,OP_AUTO_SV=1024,OP_AUTO_SV_RSLV=2048,RF_EXPDFT=1,RF_IMPDFT=2,RF_RPLY=3,RF_FWD=4,RF_PSTRPLY=5,R_TNT=2,R_ACC=3,R_DEC=4,ACTN_NTJNK=1,ACTN_ADDBSL=2,SSL=1,BSL=2,SRL=3;(function(){Owa.Controls.NavigationManager=function Owa$Controls$NavigationManager(){Owa.Controls.NavigationManager.baseClass.call(this);this._NFDicts={}};Owa.Utility.inherit(Owa.Controls.NavigationManager,Owa.Controls.OEHManagerBase);Owa.Controls.NavigationManager.prototype.addFvr=function Owa$Controls$NavigationManager$addFvr(f,e,b,c,d){var a=new oeReq("NavigationNode","AddToFavorites",this.prepCtx(arguments,d),this.prepCB("AddToFavorites",1),POST);a.add("Id",e);if(b){a.add("tgtid",b);a.add("mt",c?2:1)}a.send()};Owa.Controls.NavigationManager.prototype.rmvFrmFvr=function Owa$Controls$NavigationManager$rmvFrmFvr(d,e,c){if(!g_oMMFrst)return;var a=g_oMMFrst.gtTr("favorite");if(!a)return;var b=a.gtNdByFId(e);b&&this.rmv(d,b.gtNId(),GS_FVR,c)};Owa.Controls.NavigationManager.prototype.rmv=function Owa$Controls$NavigationManager$rmv(e,c,d,b){var a=new oeReq("NavigationNode","Remove",this.prepCtx(arguments,b),this.prepCB("RemoveNavigation",1),POST);a.add("srcNId",c);a.add("GS",d);a.addRg("cms",tryGtActMd());a.send()};Owa.Controls.NavigationManager.prototype.rmvOUM=function Owa$Controls$NavigationManager$rmvOUM(d,c,b){var a=new oeReq("NavigationNode","RemoveOtherInbox",this.prepCtx(arguments,b),this.prepCB("RemoveFromView",1),POST);a.add("Id",c);a.send()};Owa.Controls.NavigationManager.prototype.canAddToFvr=function Owa$Controls$NavigationManager$canAddToFvr(a,d,e,c,b){return(g_oFldrMgr.gtFL(a)==FL_MBX||g_oFldrMgr.gtFL(a)==FL_AMB)&&isOfClss(d,T_MSG)&&e!=DFT_ROT&&!c&&!this.isInFvr(a)&&!b};Owa.Controls.NavigationManager.prototype.nw=function Owa$Controls$NavigationManager$nw(f,d,c,e,b){if(c){var a=new oeReq("NavigationNode","AddFolder",this.prepCtx(arguments,b),this.prepCB("NewNavigation",1),POST);a.add("SB",e);a.add("pid",c);a.add("GS",d);a.send()}else{var a=new oeReq("NavigationNode","AddGroup",this.prepCtx(arguments,b),this.prepCB("NewNavigation",1),POST);a.add("SB",e);a.add("GS",d);a.send()}};Owa.Controls.NavigationManager.prototype.rnm=function Owa$Controls$NavigationManager$rnm(f,d,c,e,b){var a=new oeReq("NavigationNode","Rename",this.prepCtx(arguments,b),this.prepCB("RenameNavigation",1),POST);a.add("srcNId",c);a.add("SB",e);a.add("GS",d);a.send()};Owa.Controls.NavigationManager.prototype.isInFvr=function Owa$Controls$NavigationManager$isInFvr(b){var a=this._NFDicts[GS_FVR];if(a)return!!a[padF(b)]};Owa.Controls.NavigationManager.prototype.stNFDict=function Owa$Controls$NavigationManager$stNFDict(b,a){this._NFDicts[b]=a};Owa.Controls.NavigationManager.prototype.addFltrToFav=function Owa$Controls$NavigationManager$addFltrToFav(f,c,e,d,b){var a=new oeReq("MsgVLV2","AddFilterToFavorites",this.prepCtx(arguments,b),this.prepCB("AddFilterToFavorites",1),POST);a.add("fltrSbj",e);this.addFltrVwSt(d,c,a);a.send()};Owa.Controls.NavigationManager.prototype.addFltrVwSt=function Owa$Controls$NavigationManager$addFltrVwSt(c,b,d){var a=c.get_FilterViewCriteria();a&&a.addStatement(d,b)};g_oEd.register("AddToFavorites");g_oEd.register("AddFilterToFavorites");g_oEd.register("RemoveFromView");g_oEd.register("RemoveNavigation");g_oEd.register("NewNavigation");g_oEd.register("RenameNavigation")})();var g_oNvNdMgr;if(!g_oNvNdMgr)g_oNvNdMgr=new Owa.Controls.NavigationManager;var EVT_ERR_EP=24,g_fFirstPendingCreated=false;function pndGt(){this.pndGtMgr=new PndGtMgr;this.pndGtMgr.sndFnshRq(cbFnshRq,true);function disp(){this.pndGtMgr.fDisposed=1;this.pndGtMgr.sndFnshRq(null,true);if(this.pndGtMgr.hdnIfrm){try{if(Owa.Utility.isGreaterThanIE9()){window.self.pdnRsp=null;document.body.removeChild(this.pndGtMgr.ifrDiv)}else{var a=this.pndGtMgr.htmlDoc;a.parentWindow.pdnRsp=null;a.removeChild(this.pndGtMgr.ifrDiv)}}catch(b){}this.pndGtMgr.hdnIfrm.src="about:blank"}}this.disp=disp}function PndGtMgr(){if(Owa.Utility.isIE())this.hdnIfrm=this.CreatePendingGetIFrame();this.CHK_TMOUT=6e4;this.CHK_FNSH_TMOUT=3e4;this.CHK_FNSH_CNT=18000;this.lstNtf=-1;this.fStpTmr=1;this.fRqAlive=0;this.retryCnt=0;this.finishRetryCnt=0;this.MAX_FINISH_RETRY=3;this.fDisposed=0;this.fDisposed=0;this.lstErrTmStmp=-1;this.MIN_TM_BTWN_ERR=3e4;this.iSrvErrCnt=0;this.fErrLstPndGt=0;this.oCheckStateTimer;this.fLastFinishRequest=0;return this}PndGtMgr.prototype.CreatePendingGetIFrame=function PndGtMgr$CreatePendingGetIFrame(){if(Owa.Utility.isGreaterThanIE9()){window.self.pdnRsp=function pdnRsp(a){window.evlRsp(a)};var b=document.createElement("div");b.style.display="none";b.innerHTML="<iframe id='hdnIfrm' frameborder='0' height='0' width='100%'></iframe>";document.body.appendChild(b);this.ifrDiv=b;return document.getElementById("hdnIfrm")}else{var a=new ActiveXObject("htmlfile");this.htmlDoc=a;a.open();a.write("<html>");a.write("<script>try{document.domain='"+document.domain+"';}catch(e){}</script>");a.write("</html>");a.close();a.parentWindow.pdnRsp=function htmlDoc$parentWindow$pdnRsp(a){window.evlRsp(a)};var b=a.createElement("div");this.ifrDiv=b;try{a.appendChild(b)}catch(c){a.body.appendChild(b)}b.innerHTML="<iframe id='hdnIfrm'></iframe>";return this.htmlDoc.parentWindow.document.all.hdnIfrm}};PndGtMgr.prototype.finishReqTimeout=function PndGtMgr$finishReqTimeout(a,b){if(a==this.fLastFinishRequest){try{b.cancelCallback()}catch(c){}this.sndFnshRq(cbFnshRq)}};PndGtMgr.prototype.updTmStmp=function PndGtMgr$updTmStmp(){this.lstNtf=(new Date).getTime();this.startTmr()};PndGtMgr.prototype.chkPndGtState=function PndGtMgr$chkPndGtState(){if(this.fDisposed)return;if(!this.fStpTmr){if(this.lstNtf==-1)this.lstNtf=(new Date).getTime();var a=(new Date).getTime()-this.lstNtf;if(a>this.CHK_TMOUT){this.hndErrPndGt();this.sndFnshRq(cbFnshRq)}else this.startTmr()}};PndGtMgr.prototype.sndFnshRq=function PndGtMgr$sndFnshRq(d,e){this.fStpTmr=1;this.fRqAlive=0;if(this.hdnIfrm)this.hdnIfrm.src="about:blank";var c=false;if(!d)c=true;var a=new oeReq("PendingRequest","FinishNotificationRequest",this,d,POST,null,c,true,true);if(e){a.add("Fn",1);a.sUrl+="&Fn=1"}a.send();if(!Owa.Utility.isIE()){var b=(new Date).getTime();this.fLastFinishRequest=b;setTimeout(function(){a_oPndGt.pndGtMgr.finishReqTimeout(b,a)},this.CHK_FNSH_TMOUT)}};PndGtMgr.prototype.startTmr=function PndGtMgr$startTmr(){this.fStpTmr=0;this.oCheckStateTimer&&clearTimeout(this.oCheckStateTimer);this.oCheckStateTimer=setTimeout("a_oPndGt.pndGtMgr.chkPndGtState()",this.CHK_TMOUT)};PndGtMgr.prototype.retryPndGt=function PndGtMgr$retryPndGt(){if(this.fDisposed)return;if(!this.fRqAlive){this.retryCnt=this.retryCnt+1;if(this.retryCnt>2){this.hndErrPndGt();this.retryCnt=0;this.startTmr()}else{this.sndPndGt();setTimeout("a_oPndGt.pndGtMgr.retryPndGt()",this.CHK_FNSH_CNT+1e4)}}else{!a_oPndGt.pndGtMgr.fErrLstPndGt&&shwNE(0,0,1);this.retryCnt=0;this.startTmr()}};PndGtMgr.prototype.sndPndGt=function PndGtMgr$sndPndGt(){if(this.hdnIfrm)this.hdnIfrm.src="ev.owa?UA=0&oeh=1&ns=PendingRequest&ev=PendingNotificationRequest&"+a_sCnNm+"="+rtrvUCCk();else{var a=0;function handler(){var b=this;if(b!=null)if(b.readyState==3){var c=b.responseText,e=c.substring(a);a=c.length;var d=executeResponse(e);a=c.length-d}else if(b.readyState==4){var c=b.responseText,e=c.substring(a);delete b}}var c=(new Date).getTime().toString(36),b=new XMLHttpRequest;b.onreadystatechange=handler;b.open("GET","ev.owa?UA=0&oeh=1&ns=PendingRequest&ev=PendingNotificationRequest&"+a_sCnNm+"="+rtrvUCCk()+"n="+c,true);b.send(null)}g_fFirstPendingCreated=true};PndGtMgr.prototype.hndErrPndGt=function PndGtMgr$hndErrPndGt(c){var a=new oeReq("PendingRequest","PendingNotificationRequest",this,null,GET),b=document.createElement("div");if(!this.errorDiv&&c)throw new Error("Server should not call hndErrPndGt without an error div!");b.innerHTML=this.errorDiv;var f=getOneDescendant(b,"err");if(f){a.sErr=f.getAttribute("_msg");var h=f.getAttribute("_cd");if(h)a.iErr=getInt(h)}else a.sErr=L_PndGtErr;if(c&&this.fStpTmr&&isDf(typeof a.iErr)&&a.iErr==EVT_ERR_EP)return;var e=Owa.Dom.Node.prototype._wrapNode(b).getDescendantById("debugInfo");if(e)a.sErrDbg=e.get_OuterHtml();var g=null;if(a_fSndClntErr)g=extractOEHErrorInfo(e,a.sUrl);var i=getOneDescendant(b,"divCstInfo");if(i)a.divCustom=i;else a.divCustom=null;if(c&&!this.fStpTmr){var d=(new Date).getTime();if(this.lstErrTmStmp==-1)this.lstErrTmStmp=d;if(d-this.lstErrTmStmp<=this.MIN_TM_BTWN_ERR)this.iSrvErrCnt++;else this.iSrvErrCnt=0;this.lstErrTmStmp=d;this.fErrLstPndGt=1;this.iSrvErrCnt<2&&this.sndFnshRq(cbFnshRq)}if(g)a.oES=g;shwNE(1,a,1)};function cbFnshRq(a){a_oPndGt.pndGtMgr.fLastFinishRequest=(new Date).getTime();if(a.sErr||isDf(typeof a.sBody)&&a.sBody.indexOf("syncFnshRq")==-1)if(a.fST){rplLgn();a_oPndGt.pndGtMgr.finishRetryCnt=0;a_oPndGt.pndGtMgr.startTmr()}else if(a_oPndGt.pndGtMgr.finishRetryCnt>=a_oPndGt.pndGtMgr.MAX_FINISH_RETRY){shwNE(1,a,1);a_oPndGt.pndGtMgr.finishRetryCnt=0;a_oPndGt.pndGtMgr.startTmr()}else{a_oPndGt.pndGtMgr.finishRetryCnt++;a_oPndGt.pndGtMgr.sndFnshRq(cbFnshRq)}else{a_oPndGt.pndGtMgr.finishRetryCnt=0;eval(a.sBody);if(a_oPndGt.pndGtMgr.lstNtf==-1)setTimeout("a_oPndGt.pndGtMgr.sndPndGt()",1);else a_oPndGt.pndGtMgr.sndPndGt();if(syncFnshRq)a_oPndGt.pndGtMgr.startTmr();else setTimeout("a_oPndGt.pndGtMgr.retryPndGt()",a_oPndGt.pndGtMgr.CHK_FNSH_CNT)}}function executeResponse(d){var a=d;if(!a)return 0;while(1){var b=a.indexOf("<script>");if(b!=-1){var c=a.indexOf("</script>",b);if(c!=-1){eval(a.substring(b+8,c));a=a.substring(c+9)}else return a.length}else return a.length}return 0}function evlRsp(a){a_oPndGt.pndGtMgr.updTmStmp();window.eval(a);updCmp(window,a,1);a_oPndGt.pndGtMgr.fRqAlive&&!a_oPndGt.pndGtMgr.fErrLstPndGt&&shwNE(0,0,1)}function rstPndRq(){if(!g_fFirstPendingCreated)return;a_oPndGt.pndGtMgr.fErrLstPndGt=0;a_oPndGt.pndGtMgr.sndFnshRq(cbFnshRq)}!g_fModuleLoaded[".\\components/pendingoperationsmanager.js".toLowerCase()]&&(function(){Type.createNamespace("Owa");Owa.PendingOperationsManager=function Owa$PendingOperationsManager(){g_oEd.register(Owa.PendingOperationsManager.OperationsStartedEventName);g_oEd.register(Owa.PendingOperationsManager.OperationsCompleteEventName);this._oOperationsHash={};this._oEmptyFolderHash={};this._oContextHash={}};Owa.PendingOperationsManager.createClass("Owa.PendingOperationsManager");var a=Owa.PendingOperationsManager,b=Owa.PendingOperationsManager.prototype,c=2e3;a.OperationsStartedEventName="OperationsStarted";a.OperationsCompleteEventName="OperationsComplete";a.getSingletonInstance=function Owa$PendingOperationsManager$getSingletonInstance(){!g_oPendingOperationsManager&&createPendingOperationsManager();return g_oPendingOperationsManager};a.increment=function Owa$PendingOperationsManager$increment(b){return a.getSingletonInstance().increment(b)};a.decrement=function Owa$PendingOperationsManager$decrement(b){return a.getSingletonInstance().decrement(b)};a.hasPendingOperations=function Owa$PendingOperationsManager$hasPendingOperations(b){return a.getSingletonInstance().hasPendingOperations(b)};a.addEmptyFolderPending=function Owa$PendingOperationsManager$addEmptyFolderPending(b){return a.getSingletonInstance().addEmptyFolderPending(b)};a.removeEmptyFolderPending=function Owa$PendingOperationsManager$removeEmptyFolderPending(b){return a.getSingletonInstance().removeEmptyFolderPending(b)};a.hasEmptyFolderPending=function Owa$PendingOperationsManager$hasEmptyFolderPending(b){return a.getSingletonInstance().hasEmptyFolderPending(b)};a.setContext=function Owa$PendingOperationsManager$setContext(d,b,c){return a.getSingletonInstance().setContext(d,b,c)};a.getContext=function Owa$PendingOperationsManager$getContext(c,b){return a.getSingletonInstance().getContext(c,b)};a.getContextByPreviousInstanceKey=function Owa$PendingOperationsManager$getContextByPreviousInstanceKey(c,b){return a.getSingletonInstance().getContextByAdjacentInstanceKey(c,b,true)};a.getContextByNextInstanceKey=function Owa$PendingOperationsManager$getContextByNextInstanceKey(c,b){return a.getSingletonInstance().getContextByAdjacentInstanceKey(c,b,false)};a.clearContext=function Owa$PendingOperationsManager$clearContext(c,b){return a.getSingletonInstance().clearContext(c,b)};a.clearFolderContext=function Owa$PendingOperationsManager$clearFolderContext(b){return a.getSingletonInstance().clearFolderContext(b)};a.removeInstanceKeys=function Owa$PendingOperationsManager$removeInstanceKeys(d,b){if(!b)return;var c=a.getSingletonInstance();Owa.Dom.Window.get_Current().setTimeout(function(){for(var a=0;a<b.get_Length();a++)c.clearContext(d,b[a])},FOLDER_COUNT_SYNC_DURATION)};a.tickleXTC=function Owa$PendingOperationsManager$prototype$tickleXTC(e){if(typeof g_oMMFrst!="undefined"&&g_oMMFrst!=null){var f=g_oMMFrst.gtTr("archive"),g=g_oMMFrst.gtTr("mail"),b=a.getSingletonInstance(),d={};d.sFId=e;if(e&&f&&f.getRemoteArchiveFlag()&&f.gtNdByFId(e)){d.isArchive=1;b._iArchiveXTCTimer&&Owa.Dom.Window.get_Current().clearTimeout(b._iArchiveXTCTimer);b._iArchiveXTCTimer=Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(b,b.tickleOEH,d),c)}else if(e&&g&&g.getRemoteArchiveFlag()&&g.gtNdByFId(e)){d.isArchive=0;b._iMainMailboxXTCTimer&&Owa.Dom.Window.get_Current().clearTimeout(b._iMainMailboxXTCTimer);b._iMainMailboxXTCTimer=Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(b,b.tickleOEH,d),c)}}};b.increment=function Owa$PendingOperationsManager$prototype$increment(a){if(!this._oOperationsHash[a]){this._oOperationsHash[a]=0;g_oEd.fire(Owa.PendingOperationsManager.OperationsStartedEventName,a)}this._oOperationsHash[a]++};b.decrement=function Owa$PendingOperationsManager$prototype$decrement(a){if(!this._oOperationsHash[a])throw new Error("No hash element exists for this ID");this._oOperationsHash[a]--;if(this._oOperationsHash[a]==0){g_oEd.fire(Owa.PendingOperationsManager.OperationsCompleteEventName,a);delete this._oOperationsHash[a]}Owa.PendingOperationsManager.tickleXTC(a)};b.hasPendingOperations=function Owa$PendingOperationsManager$prototype$hasPendingOperations(a){return this._oOperationsHash[a]};b.addEmptyFolderPending=function Owa$PendingOperationsManager$prototype$addEmptyFolderPending(a){this._oEmptyFolderHash[a]=true};b.removeEmptyFolderPending=function Owa$PendingOperationsManager$prototype$removeEmptyFolderPending(a){delete this._oEmptyFolderHash[a]};b.hasEmptyFolderPending=function Owa$PendingOperationsManager$prototype$hasEmptyFolderPending(a){return this.hasPendingOperations(a)&&this._oEmptyFolderHash[a]};b.setContext=function Owa$PendingOperationsManager$prototype$setContext(a,e,b){a=a?a:"_";var c=this._oContextHash[a];if(!c){c={};this._oContextHash[a]=c}if(c[e])this._oContextHash[a][e]=b;else{for(var f in c){var d=c[f];if(d.sNextIK==b.oRowInfo.sInstanceKey)b.sPreviousIK=d.oRowInfo.sInstanceKey;else if(d.sPreviousIK==b.oRowInfo.sInstanceKey)b.sNextIK=d.oRowInfo.sInstanceKey}this._oContextHash[a][e]=b}};b.getContext=function Owa$PendingOperationsManager$prototype$getContext(a,c){a=a?a:"_";var b=this._oContextHash[a];return b?b[c]:null};b.getContextByAdjacentInstanceKey=function Owa$PendingOperationsManager$prototype$getContextByAdjacentInstanceKey(b,d,f){b=b?b:"_";var g=[],c=this._oContextHash[b];if(!c)return null;for(var e in c){var a=c[e];if(f){if(Owa.Utility.isDefined(typeof a.sPreviousIK)&&a.sPreviousIK==d)return a}else if(Owa.Utility.isDefined(typeof a.sNextIK)&&a.sNextIK==d)return a}return null};b.clearContext=function Owa$PendingOperationsManager$prototype$clearContext(a,c){a=a?a:"_";var b=this._oContextHash[a];if(b){oRowCtx=b[c];if(oRowCtx){var e=b[oRowCtx.sPreviousIK],d=b[oRowCtx.sNextIK];if(d)d.sPreviousIK=oRowCtx.sPreviousIK;if(e)e.sNextIK=oRowCtx.sNextIK;delete this._oContextHash[a][c];return true}}return false};b.clearFolderContext=function Owa$PendingOperationsManager$prototype$clearFolderContext(a){a=a?a:"_";delete this._oContextHash[a][sInstanceKey]};b.tickleOEH=function Owa$PendingOperationsManager$prototype$tickleOEH(a){var b=new oeReq("Notify","Tickle",0,null,POST);b.add("sId",a.sFId);b.send();if(a.isArchive)this._iArchiveXTCTimer=0;else this._iMainMailboxXTCTimer=0}})();g_fModuleLoaded[".\\components/pendingoperationsmanager.js".toLowerCase()]=1;var g_oPendingOperationsManager=null;function createPendingOperationsManager(){if(!g_oPendingOperationsManager)g_oPendingOperationsManager=new Owa.PendingOperationsManager}Owa.PendingOperationsManager.getSingletonInstance();var ER_MDF=1,ER_RD=2,ER_DLT=4,ER_CH=8,ER_CC=16;function hasER(b,a){return b&a}(function(){Owa.Controls.PolicyTagManager=function Owa$Controls$PolicyTagManager(){Owa.Controls.PolicyTagManager.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.PolicyTagManager,Owa.Controls.OEHManagerBase);Owa.Controls.PolicyTagManager.prototype.applyPolicy=function Owa$Controls$PolicyTagManager$applyMovePolicy(b,g,e,f,c,d){var a=new oeReq(b,"ApplyPolicy",this.prepCtx(arguments,d),this.prepCB("Apply"+b,1),POST);a.addRg("id",e);a.add("tag",f);c&&a.add("fId",c);a.send()};Owa.Controls.PolicyTagManager.prototype.inheritPolicy=function Owa$Controls$PolicyTagManager$inheritPolicy(b,f,e,c,d){var a=new oeReq(b,"InheritPolicy",this.prepCtx(arguments,d),this.prepCB("Inherit"+b,1),POST);a.addRg("id",e);c&&a.add("fId",c);a.send()};g_oEd.register("ApplyDeletePolicy");g_oEd.register("InheritDeletePolicy");g_oEd.register("ApplyMovePolicy");g_oEd.register("InheritMovePolicy")})();var g_oPtgMgr;if(!g_oPtgMgr)g_oPtgMgr=new Owa.Controls.PolicyTagManager;var RBT_ADDL=1,RBT_PDL=2,AO_N=0,AO_S=1,AO_D=2,AO_O=3,RESOLVE_IN_PROGRESS=0,RESOLVE_NO_RECIPIENTS=1,RESOLVE_MAX_RECIPIENTS=2,RESOLVE_COMPLETE=3,RESOLVE_ANR_CANCEL=4,RESOLVE_UNRESOLVED_RECIPIENTS=5,RESOLVE_REQUEST_ERROR=6,RESOLVE_ANR_COMPLETE=7,TO="divTo",CC="divCc",BCC="divBcc",SMIMEFROM="divSMimeFrom",FROM="divFrom",BTNFROM="btnFrom",MAX_LPW=5,RCP_RES=1,RCP_AMB=2,RCP_PND=4,g_rgoRcp=0,RT_EX="EX",RT_SMTP="SMTP",RT_PDL="MAPIPDL",RT_MBL="MOBILE",R_DL=1,R_RM=2,MAX_RECIPIENT_ROWS=5,g_primaryRecipient,g_subscriptionRecipients,g_mruRecipients,g_fromAddress;function updSndrPrsnc(c){for(var e=["spnFrom","spnOrg","spnSender"],a=0;a<e.length;a++)for(var f=e[a],d=c._get_Element().getAllDescendantsById(f),b=0;b<d.length;b++)updRSpnPrsnc(d[b],c)}function updAllRwPrsnc(a){var c,d,e,b;a=a||Owa.UIControls.SubPage.get_Instance();if(!isDf(typeof a_fCal))b=[TO,CC,BCC];else b=[TO,CC,BCC,"divAccept","divTent","divDecline"];for(c=0;c<b.length;c++){var f=b[c];e=a._get_Element().getAllDescendantsById(f);for(d=0;d<e.length;d++)updRwPrsnc(e[d],a)}}function updRwPrsnc(e,c){for(var a=e.getAllDescendantsById("spnR"),d=a.length<128?a.length:128,b=0;b<d;b++)updRSpnPrsnc(a[b],c)}function updRSpnPrsnc(d,c){var h=d.getDescendantById("spnR"),e=gtDfltPrsnc();if(h)d=h;var a=gtRcpIM(d);if(a)a=a.trim();if(!a)return;c=c||Owa.Components.Application.get_RootSubPage();var b=d.get_FirstChild();if(b&&b.get_NodeType()==Owa.NodeType.Element&&b.get_TagName().toLowerCase()=="img"){var j=gtPrsncFrmMstr(a);e=j.prsnc;var k=g_rgsPrsncLocNm[e],i=b.get_Title();if(e==IM_PR_UNKNWN&&i!=""&&k!=i)return;Owa.Components.CssSprites.updateImage(b,j.fNm);b.set_Title(k);var g={};g.spn=d;g.sUri=a;g.jb=b;var f=c.get_utRecipientWellPresence(true).Get(a);if(!f){f=[];c.get_utRecipientWellPresence(true).Set(a,f)}f.push(g)}e==IM_PR_UNKNWN&&!c.get_utQueryPresence(true).Get(a)&&c.get_utQueryPresence(true).Set(a,a)}function setJBPrsnc(a,b){a.setAttribute("src",getRsrcF("clear1x1.gif"));Owa.Components.CssSprites.updateImage(a,gtIMFFrmId(b));a.set_Title(g_rgsPrsncLocNm[b])}function renderJB(c,e,f,b){if(!c)return;var d=c.get_FirstChild();if(!d)return;var a=Owa.Dom.Document.get_Current().createElement("img");a.set_Id(e?e:"imgjb");a.addCssClass("jb");a.addCssClass("jbs");if(!f){a.attachEvent("click",onRwCmJb);a.attachEvent("dblclick",onDblClkJb)}a.setAttribute("unselectable","on");a.setIntAttribute("tabIndex",-1);if(!Owa.Utility.isDefined(typeof b))b=gtDfltPrsnc();setJBPrsnc(a,b);c._get_DomNode().insertBefore(a._get_DomNode(),d._get_DomNode())}function gtRcpIM(a){if(a&&a._uri)return a._uri;if(a&&a.uri)return a.uri;if(a&&a._sa)return a._sa;if(a&&a.sa)return a.sa;if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b=0;if(!a.getAttribute)return b;if(a.getAttribute("_uri"))b=a.getAttribute("_uri");else if(a.getAttribute("uri"))b=a.getAttribute("uri");else if(a.getAttribute("_sa")&&a.getAttribute("_rt")==RT_SMTP)b=imns.IMUtils.FrmSipUri(a.getAttribute("_sa"));else if(getInt(a.getAttribute("_ao"))==AO_O&&a.getAttribute("_em")!=null)b=imns.IMUtils.FrmSipUri(a.getAttribute("_em"));return b}function dispRwPrsnc(a){var c,d,b;a=a||Owa.UIControls.SubPage.get_Instance();if(!a.get_utRecipientWellPresence())return;for(d in a.get_utRecipientWellPresence().Keys()){b=a.get_utRecipientWellPresence().Get(d);if(!b)continue;for(c=0;c<b.length;c++){b[c].spn=null;b[c].jb=null}}}function dispJB(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b=a.getDescendantById("imgjb");b&&b.detachAllEvents()}function onRwCmJb(a){if(a==null)a=getEvt(this);if(Owa.Dom.Event.isInstance(a))a=a._oEvent;var b=getEvtTgt(a).parentNode;shwRcpMnu(b,a)}function onDblClkJb(a){if(a==null)a=getEvt(this);canEvt(a)}function addRcpForIM(a,j,k,m,e,g,i,l,h,f){var c=createOwaRcpSpan(j,k,m,e,g,i,l,h,f,"",1),d=a.getAllDescendantsById("spnR");d.length&&a.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace);a.appendChild(c);var b=c.get_FirstChild();renderJB(b);updRSpnPrsnc(b);rszRw(a)}function removeRcpForIM(g,h){for(var e=g.getChildrenSnapshot(),c=0;c<e.length;c++){var a=e[c],d="";if(a.get_NodeType()==Owa.NodeType.Text)continue;if(a.get_Id()=="spnR")d=a.getAttribute("_uri");else{var f=a.getDescendantById("spnR");if(f)d=f.getAttribute("_uri")}if(isSameUri(d,h)){var b;if(c==0)b=a.get_NextSibling();else b=a.get_PreviousSibling();b&&b.get_NodeType()==Owa.NodeType.Text&&b.get_TextContent()==Owa.SeparatorSpace&&b.remove(true);a.remove(true)}}rszRw(g)}function checkMaxRecipients(a,b){if(!isDf(typeof a_iMaxRcp))return 1;if(a>a_iMaxRcp){!b&&alrt(L_ErrMaxRcp.format(a_iMaxRcp,a,a-a_iMaxRcp));return 0}return 1}function isRecipientSpan(b){if(b&&b.nodeType==1)if(b.tagName=="SPAN")if(b.childNodes.length==1){var a=b.childNodes[0];if(a&&a.tagName=="SPAN")if(a.childNodes.length==1)if(a.className.contains("rwRR")||a.className.contains("rwUR")){var c=a.childNodes[0];if(c.nodeType==3&&c.nodeValue!=null)return true}}return false}function browserWorkAround(a,f){if(!Owa.Utility.isIE()){var b=a.firstChild;if(b){var d=document.createTextNode("\u00a0");if(b.nodeType!=3)a.insertBefore(d,b);else(b.nodeValue==null||b.nodeValue.length==0)&&a.replaceChild(d,b)}var c=a.lastChild;if(c){var d=document.createTextNode("\u00a0");if(c.nodeType!=3)a.appendChild(d);else(c.nodeValue==null||c.nodeValue.length==0)&&a.replaceChild(d,c);if(Owa.Utility.isSafari()&&f){a.focus();var e=window.getSelection();e.setPosition(d,1);e.collapseToEnd()}}Owa.Utility.isFirefox()&&removeBrs(a)}}function removeBrs(c){for(var b=c.getElementsByTagName("BR"),a=b.length-1;a>=0;a--)Owa.Dom.Node.wrapDomNode(b[a]).remove(false)}function hasNoRcpId(a){return(getInt(a.getAttribute("_ao"))==AO_S||getInt(a.getAttribute("_ao"))==AO_D)&&!a.getAttribute("_id")}function gtDftRT(){return isDf(typeof a_sDftRT)?a_sDftRT:RT_SMTP}function isDftRT(a){return a==gtDftRT()}function isCstmRT(a){return!isNoE(a._em)&&!isNoE(a._rt)&&a._rt!=RT_EX&&a._rt!=RT_SMTP&&a._rt!=RT_PDL}function getSmtpOrCustomRoutingAddress(a){var b="";if(isCstmRT(a)){var c=isDftRT(a._rt)?a._em:a._rt+": "+a._em;if(a._dn.lc().indexOf(c.lc())<0)b=" "+g_sDE+"["+htmlEnc(c)+"]"+g_sDE}else if(!isNoE(a._sa)&&a._dn.lc().indexOf(a._sa.lc())<0)b=" "+g_sDE+"["+htmlEnc(a._sa)+"]"+g_sDE;return b}function gtRBT(){return isDf(typeof a_iRBT)?a_iRBT:0}function isADDLAllw(){var a=gtRBT();return isFlgSt(a,RBT_ADDL)?0:1}function isPDLAllw(){var a=gtRBT();return isFlgSt(a,RBT_PDL)?0:1}function AnrOptions(e,b,d,a,c){this.fResolveOnlyFromAddressBook=e;this.fResolveAgainstAllContacts=b;this.sDefaultRoutingType=d;this.fOnlyAllowDefaultRoutingType=a;this.iRecipientBlockType=c}function getAnrOptions(d,c,b){var a=new AnrOptions(d,c);if(isDf(typeof a_sDftRT))a.sDefaultRoutingType=a_sDftRT;if(isDf(typeof a_fOlyDftRT))a.fOnlyAllowDefaultRoutingType=a_fOlyDftRT;if(b)a.iRecipientBlockType=b;else if(isDf(typeof a_iRBT))a.iRecipientBlockType=a_iRBT;return a}function shwBcc(c){var a=$("divWellBcc");if(a){var d=$(BCC);a.set_IsShown(c);d.set_IsDisabled(c?false:true);var b=Owa.UIControls.SubPage.get_Instance();b.safeResizeBodies();b.safeResizeWells()}}function addRecipientSpanToContacts(a){var e=getInt(a.getAttribute("_ao")),f=getSubPageFromRecipientSpan(a);if(e==AO_O){var d={};d.oCallerSubPage=f;var b=new oeReq("ABDA","AOOToCt",d,cbaddToCt),c=a.getAttribute("_em"),j=crtRecipObjectFromDomObject(a);if(isCstmRT(j)){var g=a.getAttribute("_rt");if(g==RT_MBL){b.add("mp",c);b.send();return}else c="["+g+": "+c+"]"}b.add("em",c);a.getAttribute("_dn")&&b.add("dn",a.getAttribute("_dn"));b.send()}else if(e==AO_D){var d={};d.oCallerSubPage=f;var b=new oeReq("ABDA","AddToContacts",d,cbaddToCt),i=a.getAttribute("_id");if(!isNoE(i)){var h=[];h[0]=i;b.addRg("id",h)}b.add("email",a.getAttribute("_em"));b.send()}}function cbaddToCt(a){if(a.sErr){if(a.fST)popLgn();else shwErrDlg(a);return}if(a.sBody){var b=Owa.Dom.Document.get_Current().createElement("DIV");b.set_InnerHtml(a.sBody);var d=b.getDescendantById("sCntUrl"),c=b.getDescendantById("sCntErr");if(d&&d.get_TextContent())opnWin(d.get_TextContent()+urlEnc(b.getDescendantById("sCntId").get_TextContent()),null,null,null,null,null,null,a.oCtx.oCallerSubPage);else c&&c.get_InnerHtml()&&alrt(c.get_InnerHtml(),0,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}}function getRcpStr(a){return"new Recip('"+getStr(a._dn,1)+"','"+getStr(a._em,1)+"','"+getStr(a._sa,1)+"','"+getStr(a._al,1)+"','"+getStr(a._rt,1)+"',"+getStr(a._ao,1)+",'"+getStr(a._id,1)+"',"+(a._rf?getStr(a._rf,1):"0")+","+(a._ei?getStr(a._ei,1):"0")+",'"+getStr(a._uri,1)+"','"+getStr(a._mo,1)+"')"}function rszRw(a,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);Owa.UIControls.EditRecipientWell.onResize(a,MAX_RECIPIENT_ROWS,b)}function setRwHtml(a,c){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);a.set_InnerHtml(c);var b=a.getExpando("_oControl");if(b)b._onResize();else rszRw(a)}function shwRcpMnu(a,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var c=$("divRm");if(!c){getRecipientContextMenu(a,b);return}if(!shwRcpMnu.RecipientContextMenu)shwRcpMnu.RecipientContextMenu=Owa.UIControls.RecipientContextMenu.create(c,a);else shwRcpMnu.RecipientContextMenu.resetRecipient(a);shwRcpMnu.RecipientContextMenu.show(b.clientX,b.clientY)}function getRecipientContextMenu(d,b){if(shwRcpMnu._fRequestInProgress)return;else shwRcpMnu._fRequestInProgress=true;var c=[d,b.clientX,b.clientY],a=new oeReq("RecipWell","GetRecipientContextMenu",c,cbGetRecipientContextMenu);isDf(typeof a_iJnkMnuType)&&a_iJnkMnuType&&a.add("recipJnkMnuType",a_iJnkMnuType);a.send()}function cbGetRecipientContextMenu(a){shwRcpMnu._fRequestInProgress=false;if(a.fST){popLgn();return}var c=a.sErr!=null;if(c)return;else{var b=Owa.Dom.Document.get_Current().createElement("DIV");b=Owa.Dom.Document.get_Current().appendChild(b);b.set_IsShown(false);b.set_InnerHtml(a.sBody)}var f=a.oCtx[0],d=a.oCtx[1],e=a.oCtx[2];shwRcpMnu.RecipientContextMenu=Owa.UIControls.RecipientContextMenu.create($("divRm"),f);shwRcpMnu.RecipientContextMenu.show(d,e)}function shwOneOffPrp(a,b){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var c=new Owa.UIControls.RecipientOneOffDialog(a,b);c.show()}var READWRITE_RECIP_SPAN=0,READONLY_RECIP_SPAN=1;function getRecipientSpanState(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b=READONLY_RECIP_SPAN;if(a.hasCssClass("rwUR")||a.hasCssClass("rwRR"))b=READWRITE_RECIP_SPAN;return b}var g_AnrCtxMnu=null,g_AnrPnd=0;function isAnrMenuOpen(){return g_AnrCtxMnu&&g_AnrCtxMnu.fIsOpen}function shwAnrMnuForResolveNames(a){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_RESOLVE);g_AnrCtxMnu.set_Config(a);g_AnrCtxMnu.set_FnAnrCallback(a.fnCb);g_AnrCtxMnu.set_RecipientSpan(null);g_AnrCtxMnu.showAnrMenu()}function shwAnrMnuForContextMenu(a){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_CONTEXT);g_AnrCtxMnu.set_Config(null);if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);g_AnrCtxMnu.set_RecipientSpan(a);g_AnrCtxMnu.showAnrMenu()}function getSubPageFromRecipientSpan(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b,c;try{b=a.get_ParentElement().get_ParentElement().getExpando("_oControl")}catch(e){}if(b)c=b.get_SubPage();else{var d=Owa.Components.SubPageControllerFactory.getControllerFromParent(a);c=d?d.get_SubPage():null}return c}function dispReadWells(a){disposeReadRecipientSpans(a);g_fIsIMEnab&&dispRwPrsnc(a)}function disposeReadRecipientSpans(a){a=a||Owa.UIControls.SubPage.get_Instance();var d=a._getDescendant(TO),c=a._getDescendant(CC),b=a._getDescendant(BCC);d&&dispSpans(d);c&&dispSpans(c);b&&dispSpans(b)}function dispSpans(d){for(var b=d.getAllDescendantsById("spnR"),a=0;a<b.length;a++){var c=b[a];c.detachAllEvents();g_fIsIMEnab&&dispJB(c)}}function dispRecipContextMenus(){shwRcpMnu.RecipientContextMenu&&shwRcpMnu.RecipientContextMenu.dispose();g_AnrCtxMnu&&g_AnrCtxMnu.dispose()}function addRcpForRule(a,h,i,k,c,e,g,j,f,d){var b=createOwaRcpSpan(h,i,k,c,e,g,j,f,d);a.appendChild(b);a.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace)}var g_PropDefinitions={_dn:["_dn","","string"],_em:["_em","","string"],_sa:["_sa","","string"],_al:["_al","","string"],_rt:["_rt","","string"],_ao:["_ao",AO_N,"number"],_id:["_id","","string"],_rf:["_rf",0,"number"],_ei:["_ei",0,"number"],_uri:["_uri","","string"],_mo:["_mo","","string"]},PROP_NAME=0,PROP_DEFAULT_VALUE=1,PROP_TYPE=2,FORCE_TYPE_STRING=1;function validateNumericProp(c,a){if(!a)a=0;var b=getInt(c);if(isNaN(b))b=a;return b}function validateAddressOrigin(b){var a=getInt(b);if(isNaN(a)||a!=AO_N&&a!=AO_S&&a!=AO_D&&a!=AO_O)a=AO_N;return a}function validateProp(c,a,e){var f=g_PropDefinitions[c][PROP_NAME],b=g_PropDefinitions[c][PROP_DEFAULT_VALUE],d=g_PropDefinitions[c][PROP_TYPE];if(a!=b)switch(d){case"string":if(a)a=a.toString();else a=b;break;case"number":if(f=="_ao")a=validateAddressOrigin(a);else a=validateNumericProp(a,b)}if(e&&d!="string")a=a.toString();return a}function getHtmlEncodedRecipPropsStr(d){var c="";for(var b in g_PropDefinitions){var a=validateProp(b,d[b],FORCE_TYPE_STRING);a=htmlEnc(a);if(g_PropDefinitions[b][PROP_NAME]=="_em")a=a.replace(/&nbsp;/g," ");c+=" "+g_PropDefinitions[b][PROP_NAME]+'="'+a+'"'}return c}function transferFromRecipToSpan(c,b){for(var a in g_PropDefinitions){var d=validateProp(a,c[a],FORCE_TYPE_STRING);b.setAttribute(g_PropDefinitions[a][PROP_NAME],d)}transferHelper(b)}function transferBetweenDomObjects(d,b){for(var c in g_PropDefinitions){var a=g_PropDefinitions[c][PROP_NAME],e=validateProp(c,d.getAttribute(a),FORCE_TYPE_STRING);b.setAttribute(a,e)}transferHelper(b)}function transferHelper(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();normalizeDisplayName(a);normalizeTitle(a);setRecipientSpanClass(a);renderDN(a)}function getDomPropsForRecip(e){var b={};for(var a in g_PropDefinitions){var c=g_PropDefinitions[a][PROP_NAME],d=validateProp(a,e.getAttribute(c));b[a]=d}return b}function crtRecipObjectFromDomObject(b){var a=getDomPropsForRecip(b);return RecipFromCollection(a)}function crtRecipObjectFromAmbiguousSpan(a){var b=crtRecipObjectFromDomObject(a);if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);b._dn=a.get_TextContent();b.fAmb=1;return b}function crtRecipObjectFromTextNode(b){var a=new Recip(b);a.fPnd=1;return a}function isPendingRecipient(a){return a.fPnd&&a._dn&&!a._em&&!a._id&&!a._sa&&!a.fAmb?true:false}function RecipFromCollection(c){var a=new Recip;for(var b in g_PropDefinitions)a[b]=c[b];return a}function Recip(h,i,l,g,k,d,j,f,e,b,c,a){this._dn=h;this._em=i;this._sa=l;this._al=g;this._rt=k;this._id=j;this._ao=validateAddressOrigin(d);this._rf=validateNumericProp(f,0);this._ei=validateNumericProp(e,0);this._uri=b?b:"";this._mo=c?c:"";this._type=a?a:null}function crtRcpSpanFromDomObject(a){var d=Owa.Dom.Node.wrapDomNode(a).get_TextContent(),c=crtRcpSpan(a.getAttribute("_dn"),a.getAttribute("_em"),a.getAttribute("_rt"),a.getAttribute("_sa"),a.getAttribute("_ao"),a.getAttribute("_rf"),a.getAttribute("_id"),a.getAttribute("_ei"),a.getAttribute("_uri"),a.getAttribute("_mo"),0,0,0),b=c.childNodes[0];b.className=="rwUR"&&Owa.Dom.Node.wrapDomNode(b).set_TextContent(d);return c}function normalizeDisplayName(b){var d=b.getAttribute("_dn"),e=b.getAttribute("_sa"),c=b.getAttribute("_em"),a="";if(isNoE(d)){if(!isNoE(e))a=e;else if(!isNoE(c))a=c}else a=d;b.setAttribute("_dn",a)}function normalizeTitle(b){var c=b.getAttribute("_sa"),d=b.getAttribute("_uri"),a="";if(isNoE(c)){if(!isNoE(d))a=imns.IMUtils.NrmSipUri(d)}else a=c;b.setAttribute("title",a)}function renderDN(a,g){var c=0,e=a.getAttribute("_sa"),b;if(a.getAttribute("_dn"))c=a.getAttribute("_dn").trim();if(c){var f=crtRecipObjectFromDomObject(a),d="";if(a.getAttribute("_rt")!=RT_EX&&a.getAttribute("_rt")!=RT_PDL)d=getSmtpOrCustomRoutingAddress(f);b=htmlEnc(c)+d}else if(e!=null)b=htmlEnc(e);if(g)a.innerHTML="<A id=bdyNm class=aUs>"+b+"</A>";else a.innerHTML=b}function setRecipientSpanClass(a,c){var b="rwRR";if(c)b="rwRRO";var e=validateNumericProp(a.getAttribute("_rf"),0),g=a.getAttribute("_id"),h=a.getAttribute("_rt"),f=a.getAttribute("_em");b+=e&R_DL?" rwDL":"";var d=h==RT_PDL&&g;if(isNoE(f)&&!d&&!c)b="rwUR";a.className=b}function createOwaSpanFromRecip(b,a){return Owa.Dom.Node.wrapDomNode(createSpanFromRecip(b,a))}function createSpanFromRecip(b,d){var c=getEm("span"),a=getEm("span");transferFromRecipToSpan(b,a);var e=getRecipientType(b);e==RCP_RES&&!d&&a.setAttribute("_acu","1");c.appendChild(a);return fixRSpn(c)}function createOwaRcpSpan(k,l,o,e,h,j,m,i,f,n,g,b,c,a,d){return Owa.Dom.Node.wrapDomNode(crtRcpSpan(k,l,o,e,h,j,m,i,f,n,g,b,c,a,d))}function crtRcpSpan(k,l,p,h,d,f,m,e,i,n,j,c,q,g,b){var o=getEm("span"),a=getEm("span");k&&a.setAttribute("_dn",k);l&&a.setAttribute("_em",l);h&&a.setAttribute("_sa",h);d=validateAddressOrigin(d);a.setAttribute("_ao",d.toString());p&&a.setAttribute("_rt",p);f=validateNumericProp(f,0);a.setAttribute("_rf",f.toString());e=validateNumericProp(e,0);a.setAttribute("_ei",e.toString());m&&a.setAttribute("_id",m);i&&a.setAttribute("_uri",i);n&&a.setAttribute("_mo",n);b=getInt(b);if(isNaN(b))b=null;b&&a.setAttribute("_type",b.toString());c&&g&&a.setAttribute("_gID",g);setRecipientSpanClass(a,j);if(a.className!="rwUR"){normalizeTitle(a);normalizeDisplayName(a);renderDN(a,c);!q&&a.setAttribute("_acu","1")}o.appendChild(a);return fixRSpn(o,j,c)}function addSpanToOEHStrctMessaging(c,b){var a=crtRecipObjectFromDomObject(c);return convtToOEHStrctMessaging(a,b)}function convtToOEHStrctMessaging(a,c){var b=new oeSt(c,"Rcp");b.add("DN",a._dn);b.add("EM",a._em);b.add("RT",a._rt);b.add("AO",a._ao);if(a._ao==AO_S){b.add("ID",a._id);b.add("EI",a._ei)}else a._ao==AO_D&&b.add("RF",a._rf);return b}function convtToOEHStrct(a,c){var b=new oeSt(c,"recip");b.add("dn",a._dn);b.add("sa",a._sa);b.add("ra",a._em);b.add("al",a._al);b.add("rt",a._rt);b.add("id",a._id);b.add("ao",a._ao);b.add("rf",a._rf);b.add("ei",a._ei?a._ei:0);b.add("uri",isDf(typeof a._uri)?a._uri:"");return b}function setRSpnEH(b,a,c){b.oncontextmenu=a?null:onContextMenuSpnRw;b.onclick=a?null:onClkRcp;b.ondrop=a?null:canEvt;b.ondblclick=a?null:onDblClkRcp;if(Owa.Utility.isIE())b.onkeydown=a?null:canEvt;else b.onkeydown=a||c?null:onKDRcp;g_fIsIMEnab&&a&&dispJB(b)}function fixRSpn(b,c,d){b.tabIndex=-1;b.setAttribute("contentEditable","false");var a=b.childNodes[0];a.tabIndex=-1;if(Owa.Utility.isIE())!c&&a.setAttribute("contentEditable","true");else a.setAttribute("contentEditable","false");setRSpnEH(a,d,c);if(a.title==null)a.title="";a.id="spnR";return b}function revtRSpn(f){for(var d=[TO,CC,BCC,FROM],a=0;a<d.length;a++){var e=$(d[a]);if(!e)continue;for(var c=e.getAllDescendantsById("spnR"),b=0;b<c.length;b++)setRSpnEH(c[b]._get_DomNode(),f)}}function markRSpnForCacheUpd(a){var b=a.firstChild;if(getRcpT(a)==RCP_RES){b.setAttribute("_acu","1");var c=crtRecipObjectFromDomObject(b);tryUpdCC(CC_ACC,getRcpStr(c),ADD)}return a}function getRecipientType(a){return a._em||a._rt==RT_PDL&&a._id?RCP_RES:isPendingRecipient(a)?RCP_PND:RCP_AMB}function getRecipientSpanType(a){return Owa.Dom.Node.isInstance(a)?getRcpT(a._oDomNode):getRcpT(a)}function getRcpT(a){a=getRcpSpn(a);if(a.nodeType==3)return RCP_PND;else if(a.tagName=="SPAN"){var b=a.childNodes[0];return b.getAttribute("_em")||b.getAttribute("_rt")==RT_PDL&&b.getAttribute("_id")?RCP_RES:RCP_AMB}}function getRcpSpn(b){var a=b.parentNode;return a&&a.tagName=="SPAN"?a:b}function getRcpW(a){return getRcpSpn(a).parentNode}function onContextMenuSpnRw(a){a=a||getEvt(this);if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.getAttribute("fSelOnly"))return;onRwCm(a)}function onRwCm(a){var b=getEvtTgt(a),c=b.className;if(c.contains("rwRR")){shwRcpMnu(b,a);canEvt(a)}else if(c.contains("rwUR")){shwAnrMnuForContextMenu(b);canEvt(a)}}function onDblClkRcp(a){if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.getAttribute("fSelOnly"))return;if(a==null)a=getEvt(this);var b=getEvtTgt(a);if(b.className=="rwUR")return;if(Owa.Dom.Node.wrapDomNode(b).getAttribute("_rt")==RT_PDL&&!isFtEnab(FT_CTS))return;onClicktoShowPropertiesSheet(b);canEvt(a)}function onClicktoShowPropertiesSheet(a){if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);var b,d=null;if(getInt(a.getAttribute("_ao"))==AO_O||getInt(a.getAttribute("_ao"))==AO_D&&!isFtEnab(FT_GAL)||getInt(a.getAttribute("_ao"))==AO_S&&!isFtEnab(FT_CTS))shwOneOffPrp(a);else if(hasNoRcpId(a))if(getInt(a.getAttribute("_ao"))==AO_D&&a.getAttribute("_em")!=null){var e=urlEnc(a.getAttribute("_em")),c=getSubPageFromRecipientSpan(a);openItm("?ae=PreFormAction&a=OpenADObject&lDn="+e,null,null,RF_W,RF_H,c)}else OKDlg(L_NoMtchPrsnAddr,null,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_NtFnd).show();else{if(getInt(a.getAttribute("_ao"))==AO_S)if(a.getAttribute("_rt")==RT_PDL)b=IT_PDL;else b=IT_CNT;else if(getInt(a.getAttribute("_ao"))==AO_D){if(getInt(a.getAttribute("_rf"))==R_DL)b="ADDistList";else b="AD.RecipientType.User";d=a.getAttribute("_em")!=null?urlEnc(a.getAttribute("_em")):null}var c=getSubPageFromRecipientSpan(a);openItmRdFm(b,a.getAttribute("_id"),d,c)}}function onKDRcp(a){a=a||getEvt(this);if(Owa.Utility.isIE()){canEvt(a);return}var g=getEvtTgt(a),c=getKeyCode(a),b=g.parentNode,d=getRcpW(b),f=Owa.Dom.Node.wrapDomNode(d).getExpando("_oControl").get_IsReadOnly();if(c==9||c==13||isCtrlKD(a)||isAltKD(a)||!Owa.Utility.isFirefox()||f)return;if(isRecipientSpan(b)){d.focus();if(Owa.KeyCodes.isCharacter(c)){var e=createTextRange();e.setCaretBefore(b);rn(b)}else if(!isShftKD(a)){switch(c){case Owa.KeyCodes.BACK_SPACE:case Owa.KeyCodes.DELETE:var e=createTextRange();e.setCaretBefore(b);rn(b);break;case Owa.KeyCodes.PAGE_DOWN:case Owa.KeyCodes.END:mvIP(d,0);break;case Owa.KeyCodes.PAGE_UP:case Owa.KeyCodes.HOME:mvIP(d,1);break;case Owa.KeyCodes.LEFT:case Owa.KeyCodes.UP:var e=createTextRange();e.setCaretBefore(b);break;case Owa.KeyCodes.RIGHT:case Owa.KeyCodes.DOWN:var e=createTextRange();e.setCaretAfter(b)}canEvt(a)}}}function onDblClkReadRcp(a){a=a||getEvt(this);var b=getEvtTgt(a);if(b.getAttribute("_rt")==RT_PDL&&!isFtEnab(FT_CTS))return;onClicktoShowPropertiesSheet(b);canEvt(a)}function onClkRcp(b){b=b||getEvt(this);var a=getEvtTgt(b);if(a.className.contains("rwRR")||a.className.contains("rwUR")){var c=createSelectionRange();c.trySelectRecipient(a)}}!g_fModuleLoaded[".\\uicontrols/RecipientWellBase.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b="spnR",g="focus",h="blur";Owa.RecipientType={To:1,Cc:2,Bcc:3,From:4};var f="To",e="Cc",d="Bcc",c="From";Owa.UIControls.RecipientWellBase=function Owa$UIControls$RecipientWellBase(b,a){if(!a)a=Owa.Dom.Document.get_Current();Owa.UIControls.RecipientWellBase.constructBase(this,[b,a])};var a=Owa.UIControls.RecipientWellBase.prototype;a.initialize=function Owa$UIControls$RecipientWellBase$initialize(){Owa.UIControls.RecipientWellBase.callBase(this,"initialize");var a=this._oElement;a.setExpando("_oControl",this);this._attachEvent(a,"dragstart",this._onDragStart);this._attachEvent(a,"dragenter",this._onDragEnter);this._attachEvent(a,"drop",this._onDrop)};a.dispose=function Owa$UIControls$RecipientWellBase$dispose(){this._oElement.detachAllEvents();this._oElement.setExpando("_oControl",null);this._disposeRecipientSpans();Owa.UIControls.RecipientWellBase.callBase(this,"dispose")};a.get_Recipients=function Owa$UIControls$RecipientWellBase$get_Recipients(){this._rgRecipientObjects=[];this._resetRecipientSpans();for(var a=0;a<this._rgRecipientSpans.length;++a)this._rgRecipientObjects.push(crtRecipObjectFromDomObject(this._rgRecipientSpans[a]._oDomNode));return this._rgRecipientObjects};a.get_RecipientSpans=function Owa$UIControls$RecipientWellBase$get_RecipientSpans(){this._resetRecipientSpans();return this._rgRecipientSpans};a.addHandler=function Owa$UIControls$RecipientWellBase$addHandler(a,b){a=this.checkEventName(a);this._attachEvent(this._oElement,a,b)};a.removeHandler=function Owa$UIControls$RecipientWellBase$removeHandler(a,b){a=this.checkEventName(a);this._detachEvent(this._oElement,a,b)};a.checkEventName=function Owa$UIControls$RecipientWellBase$checkEventName(a){if(Owa.Utility.isIE())if(a==g)a="focusin";else if(a==h)a="focusout";return a};a.set_RecipientType=function Owa$UIControls$RecipientWellBase$set_RecipientType(a){this._iRecipientType=a};a.get_RecipientType=function Owa$UIControls$RecipientWellBase$get_RecipientType(){return!this._iRecipientType?Owa.RecipientType.To:this._iRecipientType};a.get_WellTypeName=function Owa$UIControls$RecipientWellBase$get_WellTypeName(){var a=f,b=this.get_RecipientType();switch(this.get_RecipientType()){case Owa.RecipientType.Cc:a=e;break;case Owa.RecipientType.Bcc:a=d;break;case Owa.RecipientType.From:a=c}return a};a.set_IsReadOnly=function Owa$UIControls$RecipientWellBase$set_IsReadOnly(a){this._fReadOnly=!!a};a.get_IsReadOnly=function Owa$UIControls$RecipientWellBase$get_IsReadOnly(){return this._fReadOnly};a.set_IsSingleRecipient=function Owa$UIControls$RecipientWellBase$set_IsSingleRecipient(a){this._fSingleWell=a};a.get_IsSingleRecipient=function Owa$UIControls$RecipientWellBase$get_IsSingleRecipient(){return this._fSingleWell};a.set_IsADRecipientOnly=function Owa$UIControls$RecipientWellBase$set_IsADRecipientOnly(a){this._fADOnly=a};a.get_IsADRecipientOnly=function Owa$UIControls$RecipientWellBase$get_IsADRecipientOnly(){return this._fADOnly};a.set_IsRecipientMenuEnabled=function Owa$UIControls$RecipientWellBase$set_IsRecipientMenuEnabled(a){this._oElement.setBoolAttribute("fSelOnly",a)};a.get_IsRecipientMenuEnabled=function Owa$UIControls$RecipientWellBase$get_IsRecipientMenuEnabled(){return this._oElement.getBoolAttribute("fSelOnly")};a.set_MaxRows=function Owa$UIControls$RecipientWellBase$set_MaxRows(a){this._iMaxRows=a};a.get_MaxRows=function Owa$UIControls$RecipientWellBase$get_MaxRows(){return!isDf(typeof this._iMaxRows)?MAX_RECIPIENT_ROWS:this._iMaxRows};a.countRecipients=function Owa$UIControls$RecipientWellBase$countRecipients(){this._oPrototype._resetRecipientSpans();return this._rgRecipientSpans.length};a.isEqual=function Owa$UIControls$RecipientWellBase$isEqual(a){return this._oElement._oDomNode==a._oDomNode};a._disposeRecipientSpans=function Owa$UIControls$RecipientWellBase$_disposeRecipientSpans(){this._resetRecipientSpans();for(var a=0;a<this._rgRecipientSpans.length;a++){this._rgRecipientSpans[a].detachAllEvents();this._rgRecipientSpans[a]=null}this._rgRecipientSpans.length=0};a._resetRecipientSpans=function Owa$UIControls$RecipientWellBase$_resetRecipientSpans(){this._rgRecipientSpans=this._get_Element().getAllDescendantsById(b)};a._onDragStart=function Owa$UIControls$RecipientWellBase$_onDragStart(a){a.cancelBubble();a.preventDefault()};a._onDragEnter=function Owa$UIControls$RecipientWellBase$_onDragEntert(a){a.cancelBubble();a.preventDefault()};a._onDrop=function Owa$UIControls$RecipientWellBase$_onDrop(a){a.cancelBubble();a.preventDefault()};Owa.UIControls.RecipientWellBase.createClass("Owa.UIControls.RecipientWellBase",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/RecipientWellBase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/EditRecipientWell.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var f="onResize",b=0,d=17;Owa.AutoCompleteEvent={Show:1,Hide:2,NavigateUp:3,NavigateDown:4,DeleteEntry:5,AddEntryToWell:6};Owa.RecipientState={Resolved:1,Ambiguous:2,Pending:4,All:1|2|4};Owa.SeparatorSpace="; ";Owa.Separator=";";var e="_acu",c="divFH";Owa.UIControls.EditRecipientWell=function Owa$UIControls$EditRecipientWell(a,b){Owa.UIControls.EditRecipientWell.constructBase(this,[a,b])};Owa.UIControls.EditRecipientWell.create=function Owa$UIControls$EditRecipientWell$create(b,c){return new Owa.UIControls.EditRecipientWell(b,c)};Owa.UIControls.EditRecipientWell.get_RequestOehStructs=function Owa$UIControls$EditRecipientWell$get_RequestOehStructs(h,f,i){for(var g=[],d=null,b=0;b<f.length;b++){var a=f[b];if(i)d=addPendingValueToOehStruct(h,a.nodeValue);else{var e=getRecipientSpanType(a),c=null;if(e&Owa.RecipientState.Ambiguous)c=crtRecipObjectFromAmbiguousSpan(a);else if(e&Owa.RecipientState.Resolved)c=crtRecipObjectFromDomObject(a);d=convtToOEHStrctMessaging(c,h)}g[b]=d}return g};var a=Owa.UIControls.EditRecipientWell.prototype;a.initialize=function Owa$UIControls$EditRecipientWell$initialize(b,c){Owa.UIControls.EditRecipientWell.callBase(this,"initialize");this.set_IsReadOnly(c,true);b&&this.set_RecipientType(b);this._resetRecipientData();this._initializeAutoCompleteMenu();var a=this._oElement;this._attachEvent(a,"paste",this._onPaste);this._attachEvent(a,"resize",this._onResize);this._attachEvent(a,"click",this._onClick);this._attachEvent(a,"dblclick",this._onClick);!this.get_HaveParentLoadCache()&&!this.fHasCache&&this._getCache();this._onResize()};a.dispose=function Owa$UIControls$EditRecipientWell$dispose(){g_AnrPnd=0;this.oAutoCompleteFlags=null;this._oAutoCompleteCacheContainer=null;Owa.UIControls.EditRecipientWell.callBase(this,"dispose")};a.set_Recipients=function Owa$UIControls$EditRecipientWell$set_Recipients(b,e){if(!b.length)throw"argument rgRecipientObjects cannot be empty";for(var a=0;a<b.length;a++);var d=Owa.SeparatorSpace;if(this.get_IsSingleRecipient()){this._oElement.set_TextContent("");d=""}for(var a=0;a<b.length;a++){if(this.get_IsSingleRecipient()&&a==1)break;var c=b[a];if(isPendingRecipient(c))this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,c._dn+d);else{var f=createSpanFromRecip(c,!e);this._oElement._oDomNode.appendChild(f);!this.get_IsSingleRecipient()&&this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,d)}}browserWorkAround(this._oElement._oDomNode);this._onResize()};a.set_RecipientSpans=function Owa$UIControls$EditRecipientWell$set_RecipientSpans(b){if(!b.length)throw"argument rgRecipientSpans cannot be empty";for(var a=0;a<b.length;a++)if(!isRecipientSpan(b[a]._oDomNode))throw"argument is not of type Recipient Span";this.get_IsSingleRecipient()&&this._oElement.set_TextContent("");for(var a=0;a<b.length;a++){if(this.get_IsSingleRecipient()&&a==1)break;var c=b[a];fixRSpn(c._oDomNode);this._oElement.appendChild(c);!this.get_IsSingleRecipient()&&this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace)}browserWorkAround(this._oElement._oDomNode);this._onResize()};a.get_ResolvedRecipientSpans=function Owa$UIControls$EditRecipientWell$get_ResolvedRecipientSpans(){for(var c=Owa.UIControls.EditRecipientWell.callBase(this,"get_RecipientSpans"),b=[],a=0;a<c.length;++a){var e=c[a],d=e.get_ParentElement();if(isRecipientSpan(d._oDomNode)){var f=getRcpT(d._oDomNode);f&Owa.RecipientState.Resolved&&b.push(e)}}return b};a.get_Recipients=function Owa$UIControls$EditRecipientWell$get_Recipients(a){if(!a)a=Owa.RecipientState.All;for(var l=this._oElement,d=[],g=l.getChildrenSnapshot(),e=0;e<g.length;e++){var c=g[e];if(isRecipientSpan(c._oDomNode)){var j=getRcpT(c._oDomNode),h=c.getDescendantsByTagName("span")[0],b=null;if(a&Owa.RecipientState.Ambiguous&&j==Owa.RecipientState.Ambiguous)b=crtRecipObjectFromAmbiguousSpan(h);else if(a&Owa.RecipientState.Resolved&&j==Owa.RecipientState.Resolved)b=crtRecipObjectFromDomObject(h);b&&d.push(b)}else if(a&Owa.RecipientState.Pending)for(var m=c.get_TextContent(),i=m.split(Owa.Separator),f=0;f<i.length;f++){var k=trmStrSpaces(i[f]);k&&d.push(crtRecipObjectFromTextNode(k))}}return d};a.countRecipients=function Owa$UIControls$EditRecipientWell$countRecipients(){var b=0,e=this._oElement;nrm(e._oDomNode);for(var f=e.getChildrenSnapshot(),c=0;c<f.length;c++){var a=f[c];if(a.get_NodeType()==1&&a.get_TagName().toLowerCase()=="span"){if(!isNoE(a.get_TextContent()))b++}else for(var i=a.get_TextContent(),g=i.split(Owa.Separator),d=0;d<g.length;d++){var h=g[d].trim();if(isValidPendingRecipient(h))b++}}return b};a.set_IsReadOnly=function Owa$UIControls$EditRecipientWell$set_IsReadOnly(a,b){if(!b&&this.get_IsReadOnly()==!!a)return;Owa.UIControls.EditRecipientWell.callBase(this,"set_IsReadOnly",[a]);this.set_IsEnabled(!a);if(b&&a)return;this._set_Handlers(a)};a.set_Text=function Owa$UIControls$EditRecipientWell$set_Text(a){this._oElement.set_TextContent(a);if(a)this._cleanUpEditRecipientWell(true);else{browserWorkAround(this._oElement._oDomNode);this._onResize()}this._resetRecipientSpans()};a.get_Text=function Owa$UIControls$EditRecipientWell$get_Text(){return this._oElement.get_TextContent()};a.set_Html=function Owa$UIControls$EditRecipientWell$set_Html(a){this._oElement.set_InnerHtml(a);if(a)this._cleanUpEditRecipientWell(true);else{browserWorkAround(this._oElement._oDomNode);this._onResize()}this._resetRecipientSpans()};a.get_Html=function Owa$UIControls$EditRecipientWell$get_Html(){return this._oElement.get_InnerHtml()};a.set_HaveParentLoadCache=function Owa$UIControls$EditRecipientWell$set_HasParentLoadCache(a){this.fParentLoadsCache=a};a.get_HaveParentLoadCache=function Owa$UIControls$EditRecipientWell$get_HaveParentLoadCache(){return!isDf(typeof this.fParentLoadsCache)?true:this.fParentLoadsCache};a.setFocus=function Owa$UIControls$EditRecipientWell$setFocus(d){var c=this._oElement._oDomNode,a=this._oElement.get_InnerHtml().length==0;if(a&&Owa.Utility.isFirefox()){browserWorkAround(c);a=false}if(!a){var b=createTextRange();b.moveToElementText(c);b.collapse(d);b.select()}this._oElement.focus(1)};a.set_IsEnabled=function Owa$UIControls$EditRecipientWell$set_IsEnabled(a){if(this.get_IsReadOnly())a=false;!a&&this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);this._oElement.setAttribute("contentEditable",a?"true":"false");this.fIsEnabled=a};a.get_IsEnabled=function Owa$UIControls$EditRecipientWell$get_IsEnabled(){return!isDf(typeof this.fIsEnabled)?true:this.fIsEnabled};a.set_AutoCompleteSelection=function Owa$UIControls$EditRecipientWell$set_AutoCompleteSelection(a){this._oSelection=a};a.get_AutoCompleteSelection=function Owa$UIControls$EditRecipientWell$get_AutoCompleteSelection(){return this._oSelection};a.set_AutoCompleteContainer=function Owa$UIControls$EditRecipientWell$set_AutoCompleteContainer(a){this._oAutoCompleteCacheContainer=a};a.get_AutoCompleteContainer=function Owa$UIControls$EditRecipientWell$get_AutoCompleteContainer(){return!this._oAutoCompleteCacheContainer?Owa.Dom.Document.get_Current().get_Body():this._oAutoCompleteCacheContainer};a.set_OnUpdateFromCacheCallback=function Owa$UIControls$EditRecipientWell$set_OnUpdateFromCacheCallback(a){this._fnUpdateFromCacheCallback=a};a.get_OnUpdateFromCacheCallback=function Owa$UIControls$EditRecipientWell$get_OnUpdateFromCacheCallback(){return this._fnUpdateFromCacheCallback?this._fnUpdateFromCacheCallback:null};a.set_IgnoreFromData=function Owa$UIControls$EditRecipientWell$set_IgnoreFromData(a){this._fIgnoreFrom=a};a.get_IgnoreFromData=function Owa$UIControls$EditRecipientWell$get_IgnoreFromData(){return this._fIgnoreFrom};a.set_OnAutoResolveCallback=function Owa$UIControls$EditRecipientWell$set_OnAutoResolveCallback(a){this._fnAutoResolveCallback=a};a.get_OnAutoResolveCallback=function Owa$UIControls$EditRecipientWell$get_OnAutoResolveCallback(){return this._fnAutoResolveCallback?this._fnAutoResolveCallback:null};a.get_OnResize=function Owa$UIControls$EditRecipientWell$get_OnResize(){return this._getEventHandlerCollection(f)};a.set_AutoCompleteHideOneOffs=function Owa$UIControls$EditRecipientWell$set_AutoCompleteHideOneOffs(a){this._fAutoCompleteHideOneOffs=a};a.addRecipient=function Owa$UIControls$EditRecipientWell$addRecipient(h,i,l,c,e,g,j,f,d,k,m,a){var b=new Recip(h,i,c,null,l,e,j,g,f,d,k);this.set_Recipients([b],a)};a.removeRecipient=function Owa$UIControls$EditRecipientWell$removeRecipient(d){var e=d._oDomNode,b=getRcpSpn(e),c=b.nextSibling;c&&RemoveSemicolon(c);var a=b.previousSibling;while(a&&a.nodeType!=1)a=a.previousSibling;if(a){var f=createSelectionRange();f.setCaretAfter(a);this._oElement.focus()}else mvIP(this._oElement._oDomNode,1);rn(b);this._onResize()};a.addRecipientFromCache=function Owa$UIControls$EditRecipientWell$addRecipientFromCache(){var e=Owa.UIControls.AutoCompleteCache.get_Instance().get_SelectedCacheEntry(),b=this._replaceNodeHelper(e);this._oElement.focus();if(b&&!Owa.Utility.isIE()){var f=createTextRange(),c=b.nextSibling;if(c&&c.nodeType==3&&c.nodeValue==Owa.SeparatorSpace)f.setCaretAfter(c);else f.setCaretAfter(b)}this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);this._onResize();var d=this.get_OnUpdateFromCacheCallback();if(d){var a={};a.oRecipientWell=this;a.oRecipient=e;a.oNewElm=b;d(a)}};a._onKeyDown=function Owa$UIControls$EditRecipientWell$_onKeyDown(b){var c=b.get_KeyCodeForKeyUpDown(),a=false;switch(c){case 46:a=this._handleCacheEvent(Owa.AutoCompleteEvent.DeleteEntry);case 8:if(g_AnrPnd||isAnrMenuOpen())a=true;else if(Owa.Utility.isSafari()&&c==8&&!this.get_Text())a=true;else{var f=createSelectionRange();if(!f.selectionExists())if(c==46)f.recipientDeleteKey(b);else f.recipientBackspaceKey(b);Owa.Utility.isSafari()&&setTimeout('removeBrs(wda("'+this._oElement.get_Id()+'"))',1);if(!Owa.Utility.isIE()){this.get_RecipientSpans();this.get_RecipientSpans().length!=0&&this._setTimeout(this._fixSemiColons,2)}}break;case 9:if(!Owa.UIControls.AutoCompleteCache.isOpen())break;case 13:var d=this._handleCacheEvent(Owa.AutoCompleteEvent.AddEntryToWell);a=true;if(b.isCtrlKeyDown()||b.isMacCtrlKeyDown())a=d;break;case 27:a=this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);break;case 33:case 34:if(c==33)this.setFocus(1);else this.setFocus(0);this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);a=true;break;case 38:a=this._handleCacheEvent(Owa.AutoCompleteEvent.NavigateUp);break;case 40:a=this._handleCacheEvent(Owa.AutoCompleteEvent.NavigateDown)}Owa.KeyCodes.isDirtyingKey(c)&&drty();if(this._isAutoResolve(b)&&!d){var e={};e.oRecipientWell=this;e.isHotKey=c!=13;b.preventDefault();b.cancelBubble();this.get_OnAutoResolveCallback()(e);return}if(a){b.cancelBubble();b.preventDefault()}!d&&this._onResize()};a._isAutoResolve=function Owa$UIControls$EditRecipientWell$_isAutoResolve(a){var b=this.get_OnAutoResolveCallback(),c=a.get_KeyCodeForKeyUpDown();return b&&isCheckNames(a,c)?true:false};a._onKeyPress=function Owa$UIControls$EditRecipientWell$_onKeyPress(a){var d=a.get_CharCodeForKeyPress();if(59==d){this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);if(Owa.Utility.isIE()){anchortizeTxtNode(this._oElement.get_Id());if(!this.get_IsSingleRecipient()){var c=createSelectionRange();c.range.moveEnd("character",-1);var b=c.range.parentElement();if(b.tagName=="A"){b.insertAdjacentText("AfterEnd",Owa.SeparatorSpace);a.cancelBubble();a.preventDefault()}}}}this._onResize()};a._onKeyUp=function Owa$UIControls$EditRecipientWell$_onKeyUp(a){var b=a.get_KeyCodeForKeyUpDown();if((Owa.KeyCodes.isCharacterExcludeSemicolon(b)||b==8)&&!a.isCtrlKeyDown()&&!a.isAltKeyDown())this._handleCacheEvent(Owa.AutoCompleteEvent.Show);else if(b==35&&!a.isShiftKeyDown())this.setFocus(0);else b==36&&!a.isShiftKeyDown()&&this.setFocus(1)};Owa.UIControls.EditRecipientWell.onResize=function Owa$UIControls$EditRecipientWell$onResize(e,f,g){initializeLineHeight(e.get_ParentElement().getDescendantById(c));b=b==0?d:b;var h=isNaN(e.get_ScrollHeight())?d:e.get_ScrollHeight(),a=Math.floor(h/b);if(a==0||g)a=1;if(a>f)a=f;e.set_Height(b*a,"px");$("divHdrMessage")&&Owa.Pages.FormSubPage.isInstance(Owa.Components.Application.get_RootSubPage())&&Owa.UIControls.SubPage.get_Instance().safeResizeBodies()};a._onResize=function Owa$UIControls$EditRecipientWell$_onResize(){var a=this._oElement;if(!a.get_IsShown())return;Owa.UIControls.EditRecipientWell.onResize(a,this.get_MaxRows(),this.get_IsSingleRecipient());this._dispatchEvent(f,this)};a._onPaste=function Owa$UIControls$EditRecipientWell$_onPaste(a){Owa.UIControls.AutoCompleteCache.hide();if(this.get_IsReadOnly()){a.cancelBubble();a.preventDefault()}else this._setTimeout(this._cleanUpEditRecipientWell,1)};a._onFocus=function Owa$UIControls$EditRecipientWell$_onFocus(){this._fFocus=1;!this.fHasCache&&this._getCache();Owa.UIControls.AutoCompleteCache.get_Instance().resetRecipientWell(this)};a._onBlur=function Owa$UIControls$EditRecipientWell$_onBlur(){if(this.get_IsDisposed())return;this._fFocus=0};a._onClick=function Owa$UIControls$EditRecipientWell$_onClick(){var a=this._oElement;if(Owa.Utility.isFirefox()){var b=a.get_InnerHtml().length==0;if(b){a.set_InnerHtml("&nbsp;");mvIP(a._oDomNode,true)}a.focus()}this._handleCacheEvent(Owa.AutoCompleteEvent.Hide)};a._initializeAutoCompleteMenu=function Owa$UIControls$EditRecipientWell$_initializeAutoCompleteMenu(){!Owa.UIControls.AutoCompleteCache.get_Instance()&&Owa.UIControls.AutoCompleteCache.createInstance(this.get_AutoCompleteContainer());this._set_AutoCompleteFlags()};a._set_AutoCompleteFlags=function Owa$UIControls$EditRecipientWell$_set_AutoCompleteFlags(){var a={};a.isADDLAllw=isADDLAllw();a.isPDLAllw=isPDLAllw();a.iDefaultRoutingType=gtDftRT();a.isOnlyDefaultRouting=isDf(typeof a_fOlyDftRT)&&a_fOlyDftRT;a.isDefaultRoutingMobile=isDftRT(RT_MBL);a.hideOneOffs=this._fAutoCompleteHideOneOffs?1:0;this.oAutoCompleteFlags=a};a._set_Handlers=function Owa$UIControls$EditRecipientWell$_set_Handlers(a){if(!a)this._attachHandlers();else this._detachHandlers()};a._attachHandlers=function Owa$UIControls$EditRecipientWell$_attachHandlers(){var a=this._oElement;this._attachEvent(a,"keydown",this._onKeyDown);this._attachEvent(a,"keypress",this._onKeyPress);this._attachEvent(a,"keyup",this._onKeyUp);if(Owa.Utility.isIE()){this._attachEvent(a,"focusin",this._onFocus);this._attachEvent(a,"focusout",this._onBlur)}else{this._attachEvent(a,"focus",this._onFocus);this._attachEvent(a,"click",this._onFocus);this._attachEvent(a,"blur",this._onBlur)}};a._detachHandlers=function Owa$UIControls$EditRecipientWell$_detachHandlers(){var a=this._oElement;this._detachEvent(a,"keydown",this._onKeyDown);this._detachEvent(a,"keypress",this._onKeyPress);this._detachEvent(a,"keyup",this._onKeyUp);if(Owa.Utility.isIE()){this._detachEvent(a,"focusin",this._onFocus);this._detachEvent(a,"focusout",this._onBlur)}else{this._detachEvent(a,"focus",this._onFocus);this._detachEvent(a,"click",this._onFocus);this._detachEvent(a,"blur",this._onBlur)}};a._handleCacheEvent=function Owa$UIControls$EditRecipientWell$_handleCacheEvent(b){var a=0;switch(b){case Owa.AutoCompleteEvent.Show:Owa.UIControls.AutoCompleteCache.get_Instance().show();a=1;break;case Owa.AutoCompleteEvent.DeleteEntry:if(Owa.UIControls.AutoCompleteCache.isOpen()){Owa.UIControls.AutoCompleteCache.get_Instance().deleteCacheEntry();a=1}break;case Owa.AutoCompleteEvent.AddEntryToWell:if(Owa.UIControls.AutoCompleteCache.isOpen()){this.addRecipientFromCache();a=1}break;case Owa.AutoCompleteEvent.Hide:if(Owa.UIControls.AutoCompleteCache.isOpen()){Owa.UIControls.AutoCompleteCache.hide();this.set_AutoCompleteSelection(null);a=1}break;case Owa.AutoCompleteEvent.NavigateUp:if(Owa.UIControls.AutoCompleteCache.isOpen())if(Owa.UIControls.AutoCompleteCache.get_Instance().navigate(Owa.AutoCompleteEvent.NavigateUp))a=1;else{Owa.UIControls.AutoCompleteCache.hide();a=0}break;case Owa.AutoCompleteEvent.NavigateDown:if(Owa.UIControls.AutoCompleteCache.isOpen())if(Owa.UIControls.AutoCompleteCache.get_Instance().navigate(Owa.AutoCompleteEvent.NavigateDown))a=1;else{Owa.UIControls.AutoCompleteCache.hide();a=0}}return a};a._getCache=function Owa$UIControls$EditRecipientWell$_getCache(){if(!this.fHasCache){this.fHasCache=true;try{if(!hasClientCacheAutoCompleteCache()){var a=new oeReq("RecipWell","GetCache",0,this._createCallback(this._cbGetCache));a.send()}else g_rgoRcp=eval("new Array("+g_CC.sAcc+")")}catch(b){}}};a._cbGetCache=function Owa$UIControls$EditRecipientWell$_cbGetCache(a){if(!cbOeh(a))return;try{var b=a.sBody.toString();g_rgoRcp=eval("new Array("+b+")");tryUpdCC(CC_ACC,b,REF)}catch(c){}};a._resetRecipientData=function Owa$UIControls$EditRecipientWell$_resetRecipientData(){this._rgPendingRecipients=[];this._rgResolvedRecipients=[];this._rgAmbiguousRecipients=[]};a._loadRecipientData=function Owa$UIControls$EditRecipientWell$_loadRecipientData(){var c=0,e=this._oElement;Owa.Utility.isIE()&&unlnk(e._oDomNode);this._resetRecipientData();nrm(e._oDomNode);var b=e._oDomNode.childNodes;if(!b.length)return;for(var i=this.get_IsSingleRecipient(),f=[],d=0;d<b.length;d++){var a=b[d];if(c==1&&i){f.push(a);continue}if(checkForEmptyTextNode(a))continue;if(a.nodeType==1&&!isRecipientSpan(a)){var h=Owa.Dom.Node.wrapDomNode(a).get_TextContent();if(isValidPendingRecipient(h)){var j=document.createTextNode(h);Owa.Dom.Node.wrapDomNode(a).replace(Owa.Dom.Node.wrapDomNode(j));a=b[d]}else{f.push(a);continue}}var g=getRcpT(a);if(g==RCP_PND){var k=a.nodeValue;if(isValidPendingRecipient(k)){c++;this._rgPendingRecipients.push(a)}}else if(g==RCP_RES){c++;this._rgResolvedRecipients.push(a.childNodes[0])}else if(g==RCP_AMB){c++;this._rgAmbiguousRecipients.push(a.childNodes[0])}}deleteInvalidNodes(f)};a._addPendingRecipientsToRequest=function Owa$UIControls$EditRecipientWell$_addPendingRecipientsToRequest(c){if(this._rgPendingRecipients.length>0){for(var b=[],a=0;a<this._rgPendingRecipients.length;a++)b.push(this._rgPendingRecipients[a].nodeValue);c.addRg(this.get_WellTypeName(this.get_RecipientType()),b)}};a._addCacheOehData=function Owa$UIControls$EditRecipientWell$_addCacheOehData(f){for(var d=[],a=0;a<this._rgResolvedRecipients.length;a++)if(this._rgResolvedRecipients[a].getAttribute(e)){var b=this._rgResolvedRecipients[a],c=crtRecipObjectFromDomObject(b);d.push(convtToOEHStrct(c,f));tryUpdCC(CC_ACC,getRcpStr(c),ADD);b.setAttribute(e,"0")}return d};a._replacePendingNodes=function Owa$UIControls$EditRecipientWell$_replacePendingNodes(c){if(!c)return;var b=c.getAllDescendantsById("chk");if(!b.length)return;for(var a=0;a<b.length;a++)this._replacePendingNode(a,b[a]);this._fixSemiColons();this._onResize()};a._replacePendingNode=function Owa$UIControls$EditRecipientWell$_replacePendingNode(f,e){var d=this._rgPendingRecipients[f],c=e._oDomNode;if(c.childNodes.length==0){rn(d);return}if(Owa.Utility.isIE()&&d.nodeType==3)try{var g=d.data}catch(h){return}var b=fixRSpn(c.childNodes[0]);b=markRSpnForCacheUpd(b);replaceNode(d,b);while(c.childNodes.length){var a=c.childNodes[0];a=fixRSpn(a);a=markRSpnForCacheUpd(a);b=insertAdjacentElementAfterEnd(b,a)}};a._addAllRecipientsToRequest=function Owa$UIControls$EditRecipientWell$_addAllRecipientsToRequest(b){var a=[];if(this._rgPendingRecipients.length>0)a=a.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(b,this._rgPendingRecipients,true));if(this._rgAmbiguousRecipients.length>0)a=a.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(b,this._rgAmbiguousRecipients,false));if(this._rgResolvedRecipients.length>0)a=a.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(b,this._rgResolvedRecipients,false));if(a.length){var c=this.get_WellTypeName(this.get_RecipientType());if(this.get_IsSingleRecipient())b.addSt(c,a[0]);else b.addRgSt(c,a)}};function addPendingValueToOehStruct(c,b){var a=new oeSt(c,"Rcp");a.add("PND",b);return a}a._replaceNodeHelper=function Owa$UIControls$EditRecipientWell$_replaceNodeHelper(f){var c=this.get_AutoCompleteSelection();if(!c)return null;var b=null,a=this._oElement._oDomNode,d=createSpanFromRecip(f);if(Owa.Utility.isIE()){var e=c.parentElement();if(e.tagName=="A")b=e;else b=c.getStartRecipientTextNode(a);if(!b)return null;a.insertBefore(d,b);a.removeChild(b)}else c.insertNode(d);browserWorkAround(a);nrm(a);this._fixSemiColons();return d};a._fixSemiColons=function Owa$UIControls$EditRecipientWell$_fixSemiColons(){var h=this._oElement._oDomNode,c=h.childNodes;if(c.length==0)return;if(!Owa.Utility.isIE()){for(var f=[],d=0;d<c.length;d++){var b=c[d];b.nodeType==1&&f.push(b)}f.pop();c=f}for(var d=0;d<c.length;d++){var b=c[d];if(b.nodeType!=3&&b.nextSibling){var a=b.nextSibling,e=Owa.Dom.Node.wrapDomNode(a).get_TextContent();if(Owa.Utility.isIE()){e=trmStrSpaces(e);a.nodeType!=3&&!(a.tagName=="A"&&e.charAt(0)==Owa.Separator)&&addSeparator(b)}else if(a.nodeType==3){var g=e.length;if(!checkForSemicolonSeparator(a))a.insertData(0,Owa.SeparatorSpace);else e.charAt(g-1)!=" "&&a.insertData(g," ")}else addSeparator(b)}}browserWorkAround(h)};a._cleanUpEditRecipientWell=function Owa$UIControls$EditRecipientWell$_cleanUpEditRecipientWell(s){var w=this._oElement,c=this._oElement._oDomNode,g=0,l=null,d=Owa.Utility.isIE();if(!s&&!d){var t=createSelectionRange();l=t.range.startContainer}if(Owa.Utility.isSafari()){for(var q=c.getElementsByTagName("SPAN"),b=q.length-1;b>=0;b--){var r=q[b];isSafariClipboardSpan(r)&&Owa.Dom.NonSingletonNode._removeDomNode(r,false)}for(var p=c.getElementsByTagName("DIV"),b=p.length-1;b>=0;b--){var v=p[b];Owa.Dom.NonSingletonNode._removeDomNode(v,false)}removeBrs(c)}var k=c.childNodes;if(!k.length)return;var j=this.get_IsSingleRecipient(),i=[];if(d)var f=[];for(var b=0;b<k.length;b++){var a=k[b];if(a.nodeType==3){var h=Owa.Dom.Node.wrapDomNode(a).get_TextContent();if(!h||!h.trim().length)continue}if(g==1&&j){i.push(a);continue}if(checkForSemicolonSeparator(a))continue;if(checkForSemicolonSeparator(a,true)){i.push(a);continue}if(a.nodeType==1&&!isRecipientSpan(a)){var h=Owa.Dom.Node.wrapDomNode(a).get_TextContent();if(isValidPendingRecipient(h)){g++;var o=document.createTextNode(h);Owa.Dom.Node.wrapDomNode(a).replace(Owa.Dom.Node.wrapDomNode(o));d&&f.push(o)}else i.push(a);continue}var m=getRcpT(a);if(m==RCP_RES||m==RCP_AMB){g++;var e=a.childNodes[0];if(Owa.Utility.isFirefox()&&Owa.Utility.get_FirefoxVersion()>=3.6&&e.getAttribute("_rt")==RT_EX&&e.getAttribute("_em")){var u=e.getAttribute("_em");e.setAttribute("_em",u.replace(/[\n\r]/g,""))}var n=crtRcpSpanFromDomObject(e);if(!d&&l==a)l=n;Owa.Dom.Node.wrapDomNode(a).replace(Owa.Dom.Node.wrapDomNode(n))}else if(m==RCP_PND){d&&f.push(a);g++}}deleteInvalidNodes(i);if(d&&f.length)try{processTextNodesForIE(f,c,j)}catch(x){}if(!j)this._fixSemiColons();else browserWorkAround(c);this._onResize()};function processTextNodesForIE(f,h,e){for(var a=0,c=0;c<f.length;c++){if(e&&a)break;for(var b=f[c],j=b.nodeValue,i=j.split(Owa.Separator),d=0;d<i.length;d++){if(e&&a)break;var g=i[d].trim();if(isValidPendingRecipient(g)){var k=createAnchorForIE(b,g,h);a++}}h.removeChild(b)}}function createAnchorForIE(b,d,c){var a=getEm("A");a.innerText=d;c.insertBefore(a,b);return a}function deleteInvalidNodes(b){for(var a=0;a<b.length;a++){var d=b[a],c=d.nextSibling;c&&RemoveSemicolon(c);rn(d)}}function nrm(c){if(!Owa.Utility.isIE())c.normalize();else{var a=c.firstChild;while(a){if(a.nodeType==3){var b=a.nextSibling;while(b&&b.nodeType==3){a.appendData(b.data);var d=b;b=d.nextSibling;d.removeNode()}}a=a.nextSibling}}}function trmStrSpaces(a){return a.replace(new RegExp("^(\\s|\\u00a0)+"),"").replace(new RegExp("(\\s|\\u00a0)+$"),"")}function anchortizeTxtNode(d){var b=wda(d),a,c=createRecipientRange(document);if(!c)return null;a=c.getStartRecipientTextNode(b);if(!a)return null;if(!isValidRecipientTextNode(a.data))return null;createAnchorForIE(a,a.data,b);b.removeChild(a)}function addSeparator(a){iatae(a,Owa.SeparatorSpace)}function isSafariClipboardSpan(a){return a.tagName=="SPAN"&&(a.className=="Apple-style-span"||a.className=="Apple-converted-space")?true:false}function unlnk(a){if(Owa.Utility.isIE()){var c=a.getElementsByTagName("A");if(!c.length)return;var b=createTextRange();b.moveToElementText(a);Owa.ExecCommand.execute(b.range,"unlink")}}function checkForEmptyTextNode(a){return a.nodeType==3&&!isValidPendingRecipient(a.data)}function checkForSemicolonSeparator(a,b){if(a.nodeType!=3)return false;if(checkTextForSemicolonSeparator(a.nodeValue)){if(b)a.nodeValue=Owa.SeparatorSpace;return true}return false}function checkTextForSemicolonSeparator(e){for(var b=e.trim(),d="",a=0;a<b.length;a++){var c=b.charCodeAt(a);if(isEmptyChar(c))continue;if(!isSemicolon(c))return false;d+=b.charAt(a)}return d==Owa.Separator?true:false}function getHotKeyCharCode(a){return a.split("+")[1].charCodeAt(0)}function isCheckNames(b,a){var c=getHotKeyCharCode(L_HkRcps1),d=getHotKeyCharCode(L_HkRcps2);return a==13?true:(b.isCtrlKeyDown()||b.isMacCtrlKeyDown())&&a==c?true:b.isAltKeyDown()&&a==d?true:false}function initializeLineHeight(d){if(b)return;var a;if(!d){var e=Owa.Dom.Document.get_Current();a=e.createElement("div");a.set_Id(c);e.appendChild(a);d=a}d.set_TextContent("M");b=d.get_ClientHeight();d.set_TextContent("");a&&a.remove(true)}function replaceNode(a,b){if(typeof a.replaceNode!="undefined")a.replaceNode(b);else a.parentNode.replaceChild(b,a)}function insertAdjacentElementAfterEnd(a,b){if(a.nodeType==Owa.NodeType.Element&&typeof a.insertAdjacentElement!="undefined")a.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,b);else a.parentNode.insertBefore(b,a.nextSibling);return b}Owa.UIControls.EditRecipientWell.createClass("Owa.UIControls.EditRecipientWell",Owa.UIControls.RecipientWellBase)})();g_fModuleLoaded[".\\uicontrols/EditRecipientWell.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/SingleEditRecipientWell.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b="addBdyTxtFaded",d="addBdyTxt";Owa.UIControls.SingleEditRecipientWell=function Owa$UIControls$SingleEditRecipientWell(a,b){Owa.UIControls.SingleEditRecipientWell.constructBase(this,[a,b])};Owa.UIControls.SingleEditRecipientWell.create=function Owa$UIControls$SingleEditRecipientWell$create(b,c){return new Owa.UIControls.SingleEditRecipientWell(b,c)};var a=Owa.UIControls.SingleEditRecipientWell.prototype;a.initialize=function Owa$UIControls$SingleEditRecipientWell$initialize(a,b){Owa.UIControls.SingleEditRecipientWell.callBase(this,"initialize",[a,b]);this.set_IsSingleRecipient(true)};a.get_Recipient=function Owa$UIControls$SingleEditRecipientWell$get_Recipient(){var a=[];a=Owa.UIControls.SingleEditRecipientWell.callBase(this,"get_Recipients");var b=null;if(a.length)b=a[0];return b};a.set_DefaultText=function Owa$UIControls$SingleEditRecipientWell$set_DefaultText(a,b){this._sDefaultText=a;if(b){this._updateTextCss(true);this._oElement.set_TextContent(a)}};a.get_DefaultText=function Owa$UIControls$SingleEditRecipientWell$get_DefaultText(){return this._sDefaultText?this._sDefaultText:null};a._onKeyUpSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyUpSingleWell(b){var a=b.get_KeyCodeForKeyUpDown();!this._isActionKey(a)&&this.get_RecipientSpans().length&&this._handleCacheEvent(Owa.AutoCompleteEvent.Hide)};a._onKeyPressSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyPressSingleWell(a){var b=a.get_CharCodeForKeyPress();if(59==b){a.cancelBubble();a.preventDefault()}};a._onKeyDownSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyDownSingleWell(b){var a=b.get_KeyCodeForKeyUpDown();if(a==13||a==9||a==46||a==8||b.isAltKeyDown()||b.isCtrlKeyDown())return;if(this.get_RecipientSpans().length){var c=this.get_Text();if(a==37||a==39)this.set_Text(c);else this.set_Text("");mvIP(this._oElement._oDomNode,a!=37)}b.cancelBubble()};a._onFocusSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onFocusSingleWell(){if(this.get_DefaultText())if(this._oElement.get_TextContent()==this.get_DefaultText()){this._updateTextCss(false);this.set_Text("");if(Owa.Utility.isChrome()||Owa.Utility.isSafari()){var a=createTextRange();a.moveToElementText(this._oElement._oDomNode);a.collapse(true);a.select()}}};a._onBlurSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onBlurSingleWell(){if(this.get_DefaultText())this._oElement.get_TextContent().trim()==""&&this.set_DefaultText(this.get_DefaultText(),true)};var c=[13,9,8,46,37,39];a._set_Handlers=function Owa$UIControls$SingleEditRecipientWell$_set_Handlers(a){Owa.UIControls.SingleEditRecipientWell.callBase(this,"_set_Handlers",[a]);if(!a)this._addHandlers();else this._removeHandlers()};a._addHandlers=function Owa$UIControls$SingleEditRecipientWell$_addHandlers(){this.addHandler("focus",this._onFocusSingleWell);this.addHandler("blur",this._onBlurSingleWell);this.addHandler("keydown",this._onKeyDownSingleWell);this.addHandler("keypress",this._onKeyPressSingleWell);this.addHandler("keyup",this._onKeyUpSingleWell)};a._removeHandlers=function Owa$UIControls$SingleEditRecipientWell$_removeHandlers(){this.removeHandler("focus",this._onFocusSingleWell);this.removeHandler("blur",this._onBlurSingleWell);this.removeHandler("keydown",this._onKeyDownSingleWell);this.removeHandler("keypress",this._onKeyPressSingleWell);this.removeHandler("keyup",this._onKeyUpSingleWell)};a._isActionKey=function Owa$UIControls$SingleEditRecipientWell$_isActionKey(b){for(var a=0;a<c.length;a++)if(b==c[a])return true;return false};a._updateTextCss=function Owa$UIControls$SingleEditRecipientWell$_updateTextCss(a){this._oElement.removeCssClass(a?d:b);this._oElement.addCssClass(a?b:d)};Owa.UIControls.SingleEditRecipientWell.createClass("Owa.UIControls.SingeEditRecipientWell",Owa.UIControls.EditRecipientWell)})();g_fModuleLoaded[".\\uicontrols/SingleEditRecipientWell.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/FindSomeoneRecipientWell.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b="spnR";Owa.UIControls.FindSomeone=function Owa$UIControls$FindSomeone(b,a,c){Owa.UIControls.FindSomeone.constructBase(this,[a,c]);this.set_SubPage(b);this.sConsumerId=null;this._fIsAnrInProgress=false;this._fHasFocus=false};Owa.UIControls.FindSomeone.create=function Owa$UIControls$FindSomeone$create(c,b,d){var a=new Owa.UIControls.FindSomeone(c,b,d);a.initialize();return a};var a=Owa.UIControls.FindSomeone.prototype;a.initialize=function Owa$UIControls$FindSomeone$initialize(){Owa.UIControls.FindSomeone.callBase(this,"initialize");this._oRecipientWell=this.addResource(Owa.UIControls.SingleEditRecipientWell.create(this._oElement));this._oRecipientWell.set_SubPage(this.get_SubPage());this._oRecipientWell.set_OnAutoResolveCallback(this._createCallback(this.checkNames));this._oRecipientWell.set_DefaultText(L_FndSo);this._oRecipientWell.set_OnUpdateFromCacheCallback(this._createCallback(this._onCompleteResolveOrUpdateFromCache));this._oRecipientWell.set_AutoCompleteHideOneOffs(true);this._oRecipientWell.initialize();this._oRecipientWell.addHandler("focus",this._createCallback(this._onFocus));this._oRecipientWell.addHandler("blur",this._createCallback(this._onBlur));this.oAnrOptions=getAnrOptions(false,true);var a=this._get_Element(),b=a.getEffectivePadding(Owa.Style.Side.Left)+a.getEffectivePadding(Owa.Style.Side.Right);a.set_Width(a.get_ClientWidth()-b);this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([this._oRecipientWell],this.oAnrOptions)};a.dispose=function Owa$UIControls$FindSomeone$dispose(){Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId);Owa.UIControls.FindSomeone.callBase(this,"dispose")};a.checkNames=function Owa$UIControls$FindSomeone$checkNames(){this._fIsAnrInProgress=true;Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveOrUpdateFromCache))};a._onCompleteResolveOrUpdateFromCache=function Owa$UIControls$FindSomeone$_onCompleteResolveOrUpdateFromCache(){this._fIsAnrInProgress=false;var a=this._oRecipientWell.get_Recipient();if(a){var c=getRecipientType(a);if(c==RCP_RES){var d=this._oElement.getDescendantById(b);onClicktoShowPropertiesSheet(d);setTimeout('removeBrs(wda("'+this._oRecipientWell._oElement.get_Id()+'"))',1);this._oRecipientWell._setTimeout(this._oRecipientWell._onResize,2);!this._fHasFocus&&this._reset();return}}this._oRecipientWell.setFocus(0)};a._onFocus=function Owa$UIControls$FindSomeone$_onFocus(){this._fHasFocus=true;this._get_Element().addCssClass("fcs")};a._onBlur=function Owa$UIControls$FindSomeone$_onBlur(){this._fHasFocus=false;!this._fIsAnrInProgress&&this._setTimeout(this._reset,1)};a._reset=function Owa$UIControls$FindSomeone$_reset(){this._get_Element().removeCssClass("fcs");this._oRecipientWell.set_DefaultText(this._oRecipientWell.get_DefaultText(),true);Owa.UIControls.AutoCompleteCache.isOpen()&&!Owa.UIControls.AutoCompleteCache.isClicked()&&Owa.UIControls.AutoCompleteCache.hide()};Owa.UIControls.FindSomeone.createClass("Owa.UIControls.FindSomeone",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/FindSomeoneRecipientWell.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/RecipientAutoCompleteCache.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var e="cchBx",h="rwACO",c="AC",g="rwACDn",f="rwACEm",d="rwACIU",i="rwACIH",b=null;Owa.UIControls.AutoCompleteCache=function Owa$UIControls$AutoCompleteCache(a,b){Owa.UIControls.AutoCompleteCache.constructBase(this,[a,b])};Owa.UIControls.AutoCompleteCache._createElement=function Owa$UIControls$AutoCompleteCache$_createElement(b){var a=Owa.Dom.Document.get_Current().createElement("div");a.set_IsShown(false);b.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,a);a.set_CssClasses([h]);a.set_Id(e);return a};Owa.UIControls.AutoCompleteCache.get_Instance=function Owa$UIControls$AutoCompleteCache$get_Instance(){return b};Owa.UIControls.AutoCompleteCache.createInstance=function Owa$UIControls$AutoCompleteCache$createInstance(a){var c=Owa.UIControls.AutoCompleteCache._createElement(a);b=new Owa.UIControls.AutoCompleteCache(c,a);b.initialize();return b};Owa.UIControls.AutoCompleteCache.hide=function Owa$UIControls$AutoCompleteCache$hide(){b&&b.get_IsOpen()&&b.hide()};Owa.UIControls.AutoCompleteCache.isOpen=function Owa$UIControls$AutoCompleteCache$isOpen(){return b&&b.get_IsOpen()?true:false};Owa.UIControls.AutoCompleteCache.isClicked=function Owa$UIControls$AutoCompleteCache$isClicked(){return b?b._fIsClicked:false};var a=Owa.UIControls.AutoCompleteCache.prototype;a.initialize=function Owa$UIControls$AutoCompleteCache$initialize(){Owa.UIControls.AutoCompleteCache.callBase(this,"initialize");this._attachEvent(this._oParent,"mousedown",this._onMouseDown);this._attachEvent(this._oParent,"mouseup",this._onMouseUp);this._rgMatchItems=[];this._rgMenuItems=[];this._iSelectedItemIndex=-1};a.dispose=function Owa$UIControls$AutoCompleteCache$dispose(){this._detachEvent(this._oParent,"mousedown",this._onMouseDown);this._detachEvent(this._oParent,"mouseup",this._onMouseUp);this._rgMatchItems=null;this._rgMenuItems=null;Owa.UIControls.AutoCompleteCache.callBase(this,"dispose")};a.resetRecipientWell=function Owa$UIControls$AutoCompleteCache$resetRecipientWell(a){if(a&&!a.get_IsDisposed()){this.oRecipientWell=a;var b=this.oRecipientWell.get_AutoCompleteContainer();this._oParent._oDomNode!=b._oDomNode&&this._resetParentContainer(b);this._oElement.moveToTop()}};a._resetParentContainer=function Owa$UIControls$AutoCompleteCache$_resetParentContainer(a){this._oElement.remove();this._oElement=Owa.UIControls.AutoCompleteCache._createElement(a);this._oParent=a};a.set_IsOpen=function Owa$UIControls$AutoCompleteCache$set_IsOpen(a){this._fOpen=a};a.get_IsOpen=function Owa$UIControls$AutoCompleteCache$get_IsOpen(){return this._fOpen?true:false};a.show=function Owa$UIControls$AutoCompleteCache$show(){var g=null;this.hide();if(this._isRecipientWellValid()&&this.oRecipientWell._oElement.hasChildNodes()){var d=null;try{d=createSelectionRange();var j=d.parentElement();if(!j||j.tagName=="SPAN")return}catch(m){return}var h=createRecipientRange(document,d);if(!h)return;g=trmStrSpacesAndSemicolons(h.getText());!isNoE(g)&&this._get_Matches(g,this.oRecipientWell.get_IsADRecipientOnly());if(this._rgMatchItems.length){for(var f=0;f<this._rgMatchItems.length;f++)this._addCacheEntry(this._rgMatchItems[f],f);isAnrMenuOpen()&&g_AnrCtxMnu.close();this._oElement.set_IsShown(true);this.set_IsOpen(true);this.oRecipientWell.set_AutoCompleteSelection(h);var c=this._oElement._oDomNode,i=c.style,b=window.document.body.clientWidth,a=c.offsetWidth,e=d.offset().iX;if(a>.5*b){i.overflow="hidden";i.textOverflow="ellipsis";i.width=getInt(.5*b)+"px";a=c.offsetWidth}if(g_fRtl){e-=a;if(e<0)e=1<b-a?1:b-a}else if(a+e+3>b)e=1<b-a?b-a:1;var k=e-getCX(c.offsetParent),l=d.offset().iY+d.bounding().iHeight+5-getCY(c.offsetParent);posEm(c,k,l);this.set_SelectedItemIndex(0)}}};a.hide=function Owa$UIControls$AutoCompleteCache$prototype$hide(){this.reset();this.set_IsOpen(false)};a.reset=function Owa$UIControls$AutoCompleteCache$reset(){if(!this._oElement)return;this._oElement.set_IsShown(false);if(Owa.Utility.isSafari()&&!Owa.Utility.isChrome())try{var b=createSelectionRange();b!=null&&b.select()}catch(c){if(this._isRecipientWellValid()){var a=createTextRange();a.moveToElementText(this.oRecipientWell._oElement._oDomNode);a.collapse(0);a.select()}}this._oElement.set_InnerHtml("");this._rgMatchItems=[];this._rgMenuItems=[];this._iSelectedItemIndex=-1};a._addCacheEntry=function Owa$UIControls$AutoCompleteCache$_addCacheEntry(h,j){var e=c;e=e.concat(j);var b=Owa.Dom.Document.get_Current().createElement("div");b.set_Id(e);b.set_CssClasses([d]);var a=Owa.Dom.Document.get_Current().createElement("font");a.set_CssClasses([g]);a.set_TextContent(h._dn.concat(" "));b.appendChild(a);var i=getSmtpOrCustomRoutingAddress(h);if(!isNoE(i)){a=Owa.Dom.Document.get_Current().createElement("font");a.set_CssClasses([f]);a.set_InnerHtml(i);b.appendChild(a)}b=this._oElement.appendChild(b);this._rgMenuItems.push(b)};a._get_Matches=function Owa$UIControls$AutoCompleteCache$_get_Matches(e,f){for(var d=0,b=this.oRecipientWell.oAutoCompleteFlags,c=0;c<g_rgoRcp.length;c++){var a=g_rgoRcp[c];if(!a)continue;if(f&&a._ao!=AO_D)continue;if(!b.isADDLAllw&&a._rf&R_DL&&a._ao==AO_D)continue;if(!b.isPDLAllw&&a._rt==RT_PDL)continue;if(b.isOnlyDefaultRouting&&a._rt!=b.iDefaultRoutingType)continue;if(!b.isDefaultRoutingMobile&&RT_MBL==a._rt)continue;if(b.hideOneOffs&&a._ao==AO_O)continue;if(mch(e,a)){this._rgMatchItems.push(a);d++;if(d==10)break}}};a.get_SelectedCacheEntry=function Owa$UIControls$AutoCompleteCache$get_SelectedCacheEntry(){if(this._iSelectedItemIndex<0)return;var a=this._rgMatchItems[this._iSelectedItemIndex];return a};a.deleteCacheEntry=function Owa$UIControls$AutoCompleteCache$deleteCacheEntry(){if(this._iSelectedItemIndex<0)return;var a=this._rgMatchItems[this._iSelectedItemIndex],b=this._iSelectedItemIndex-1;b=b<0?0:b;delFrmRcpArry(a._em);tryUpdCC(CC_ACC,getRcpStr(a),DEL);this.show();this.set_SelectedItemIndex(b);var c=new oeReq("RecipWell","DeleteFromCache",0,null,POST);c.add("em",a._em);c.add("id",a._id);c.send()};a.navigate=function Owa$UIControls$AutoCompleteCache$navigate(a){var b=0;switch(a){case Owa.AutoCompleteEvent.NavigateUp:var b=this._arrowUp();break;case Owa.AutoCompleteEvent.NavigateDown:var b=this._arrowDown()}return b};a._arrowDown=function Owa$UIControls$AutoCompleteCache$_arrowDown(){if(this.get_SelectedItemIndex()<this._rgMatchItems.length-1){this.set_SelectedItemIndex(this.get_SelectedItemIndex()+1);return 1}return 0};a._arrowUp=function Owa$UIControls$AutoCompleteCache$_arrowUp(){if(this.get_SelectedItemIndex()>0){this.set_SelectedItemIndex(this.get_SelectedItemIndex()-1);return 1}return 0};a.set_SelectedItemIndex=function Owa$UIControls$AutoCompleteCache$set_SelectedItemIndex(a){if(a==this._iSelectedItemIndex)return;this._iSelectedItemIndex>=0&&this._rgMenuItems[this._iSelectedItemIndex].set_CssClasses([d]);if(a>=this._rgMenuItems.length)a=-1;this._iSelectedItemIndex=a;this._iSelectedItemIndex>=0&&this._rgMenuItems[this._iSelectedItemIndex].set_CssClasses([i])};a.get_SelectedItem=function Owa$UIControls$AutoCompleteCache$get_SelectedItem(){return this.get_SelectedItemIndex()>=0?this._rgMatchItems[this.get_SelectedItemIndex()]:undefined};a.get_SelectedItemIndex=function Owa$UIControls$AutoCompleteCache$get_SelectedItemIndex(){return this._iSelectedItemIndex};a._onMouseDown=function Owa$UIControls$AutoCompleteCache$_onMouseDown(a){var d=a.get_Target(),b=getDivRecipient(d);if(b){var c=b.get_Id().substr(2);this.set_SelectedItemIndex(c);a.cancelBubble();a.preventDefault();this._fIsClicked=true}else this.get_IsOpen()&&this.hide()};a._onMouseUp=function Owa$UIControls$AutoCompleteCache$_onMouseUp(a){this._fIsClicked=false;var f=a.get_Target(),b=getDivRecipient(f);if(b){var e=b.get_Id().substr(c.length);this.set_SelectedItemIndex(e);var d=this.get_SelectedItem();d&&this._isRecipientWellValid()&&this.oRecipientWell.addRecipientFromCache(d);a.cancelBubble();a.preventDefault()}};a._isRecipientWellValid=function Owa$UIControls$AutoCompleteCache$_isRecipientWellValid(){return this.oRecipientWell&&!this.oRecipientWell.get_IsDisposed()};function mch(b,a){var e=a._dn.lastIndexOf(" "),f=a._dn.substring(0,e),g=a._dn.substr(e+1);b=b.toUpperCase();for(var d=[f,g,a._dn,a._em,a._sa,a._al],c=0;c<d.length;++c)if(d[c])if(b==d[c].substr(0,b.length).toUpperCase())return 1;return 0}function getDivRecipient(c){var a=null;if(c){var a=c.get_ParentElement(),b=a?a.get_ParentElement():null;if(!b||b.get_Id()!=e)a=null}return a}function delFrmRcpArry(b){var a=0;while(a<g_rgoRcp.length){if(g_rgoRcp[a]!=null&&g_rgoRcp[a]._em==b){g_rgoRcp.removeAt(a);break}a++}}function trmStrSpacesAndSemicolons(a){return a.replace(new RegExp("^(\\s|\\u00a0|;)+"),"").replace(new RegExp("(\\s|\\u00a0|;)+$"),"")}Owa.UIControls.AutoCompleteCache.createClass("Owa.UIControls.AutoCompleteCache",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/RecipientAutoCompleteCache.js".toLowerCase()]=1;var SELECTED_MENU_ITEM_CLASS="cmHiLite";!g_fModuleLoaded[".\\uicontrols/ContextMenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var j="onSelect",c="cmd",b="_lnk",g="_isMnuDvdr",d="sSmId",e="sSmScript",h="ctxMnu",i="cmLnk",f="cmDsbld",k="cstmCM";Owa.UIControls.ContextMenu=function Owa$UIControls$ContextMenu(b,c,a){Owa.UIControls.ContextMenu.constructBase(this,[b,c]);a&&this.set_SubPage(a);this._oSubmenus={};this._oCurrentSubmenu=null;this._iCurrentSubmenuTimer=null};var a=Owa.UIControls.ContextMenu.prototype;a._fRemoveElementInDisposing=true;Owa.UIControls.ContextMenu.create=function Owa$UIControls$ContextMenu$create(b,d,c){var a=new Owa.UIControls.ContextMenu(b,d,c);a.initialize();return a};Owa.UIControls.ContextMenu.createFromHtml=function Owa$UIControls$ContextMenu$createFromHtml(e,c,d){var b=Owa.Dom.Document.get_Current().createElement("DIV"),a;Owa.Dom.Document.get_Current().get_Body().appendChild(b);b.set_InnerHtml(e);a=new Owa.UIControls.ContextMenu(b.get_FirstChild(),null,d);a.set_RemoveElementInDisposing(c);a.initialize();return a};a.initialize=function Owa$UIControls$ContextMenu$initialize(){Owa.UIControls.ContextMenu.callBase(this,"initialize");this.setMenuItems();this._attachEvent(this._get_Element(),"mouseover",this._onMouseOver);this._attachEvent(this._get_Element(),"mouseout",this._onMouseOut);this._attachEvent(this._get_Element(),"click",this._onClick);if(this._get_Element().getAttribute("fScrl"))if(this._rgMenuItems.length>10){this._get_Element().set_Height(230);this._fCallAdjustMenuWithScrollbarWidth=1}};Owa.UIControls.ContextMenu.prototype._fireOnPreShow=function Owa$UIControls$ContextMenu$_fireOnPreShow(){this._fCallAdjustMenuWithScrollbarWidth&&this._adjustMenuWithScrollbarWidth();this._adjustSpacerWidths();Owa.UIControls.ContextMenu.callBase(this,"_fireOnPreShow")};a._getDescendant=function Owa$UIControls$ContextMenu$_getDescendant(b){var a=Owa.UIControls.ContextMenu.callBase(this,"_getDescendant",[b]);if(a)return a;for(var c in this._oSubmenus){a=this._oSubmenus[c]._getDescendant(b);if(a)return a}};a.setMenuItems=function Owa$UIControls$ContextMenu$setMenuItems(){this._rgMenuItems=[];this._rgCustomMenuIds=[];var f=this._get_Element().get_AllDecendantsEnumerator();while(f.moveNext()){var a=f.get_Current();if((a.getBoolAttribute(b)||a.getBoolAttribute(g))&&a.getAncestorByClass(h).equals(this._get_Element())){this._rgMenuItems.push(a);var e=a.getAttribute(d);if(e){var j=this._get_Element().getDescendantById(e);this._oSubmenus[e]=this.addResource(this._createSubmenu(j));this._oSubmenus[e].get_OnSelect().add(this._createCallback(this._fireOnSelect))}if(a.getAttribute(c)==k){var i=a.get_Id();if(!i)throw"Customized menu item must have an Id.";this._rgCustomMenuIds.push(i)}}}this._rgAllMenuItems=this._getAllMenuItems()};a.dispose=function Owa$UIControls$ContextMenu$dispose(){this.fIsOpen&&this.close();this._rgMenuItems=null;this._rgCustomMenuIds=null;Owa.UIControls.ContextMenu.callBase(this,"dispose")};a.close=function Owa$UIControls$ContextMenu$close(){this.fIsOpen&&this._oParentPopup&&Owa.UIControls.ContextMenu.isInstance(this._oParentPopup)&&this._oParentPopup.selectMenuItemByAttribute("",0);this._hideSubmenu();Owa.UIControls.ContextMenu.callBase(this,"close")};a.getRootMenu=function Owa$UIControls$ContextMenu$getRootMenu(){var a=this;while(a._oParentPopup)a=a._oParentPopup;return a};a.getAllMenuItemIds=function Owa$UIControls$ContextMenu$getAllMenuItemIds(){for(var b=[],a=0;a<this._rgMenuItems.length;a++)b.push(this._rgMenuItems[a].get_Id());return b};a.showAtEvent=function Owa$UIControls$ContextMenu$showAtEvent(a){this.show(a.get_ClientX(),a.get_ClientY())};a._tShow=function Owa$UIControls$ContextMenu$show(){Owa.UIControls.ContextMenu.callBase(this,"_tShow",arguments);this._get_Element().getAttribute("fScrl")&&this._get_Element().hasCssClass("ctxMnuIco")&&this._getDescendant("cmpane").set_Height(this._get_Element().get_ScrollHeight())};a.show=function Owa$UIControls$ContextMenu$show(){this._normalizeMenuDivider();return Owa.UIControls.ContextMenu.callBase(this,"show",arguments)};a.showMenuItems=function Owa$UIControls$ContextMenu$showMenuItems(b,c){for(var a=0;a<b.length;a++)this.showMenuItem(b[a],c)};a.showMenuItem=function Owa$UIControls$ContextMenu$showMenuItem(b,c){var a=this._getMenuItem(b);null!=a&&showMenuItem(a,c)};a._normalizeMenuDivider=function Owa$UIControls$ContextMenu$_normalizeMenuDivider(){for(var c=null,a=false,d=0;d<this._rgMenuItems.length;d++){var b=this._rgMenuItems[d];if(b.getBoolAttribute(g)){showMenuItem(b,a);if(a)c=b;a=false}else if(b.get_IsShown())a=true}!a&&c&&this.showMenuItem(c.get_Id(),false)};a.enableMenuItems=function Owa$UIControls$ContextMenu$enableMenuItems(b,c){for(var a=0;a<b.length;a++)this.enableMenuItem(b[a],c)};a.enableMenuItem=function Owa$UIControls$ContextMenu$enableMenuItem(a,b){setMenuItemEnabled(this._getMenuItem(a),b)};a.enableMenuItemByCommand=function Owa$UIControls$ContextMenu$enableMenuItemByCommand(a,b){setMenuItemEnabled(this._getMenuItemByCommand(a),b)};a.checkMenuItem=function Owa$UIControls$ContextMenu$checkMenuItem(c,d){var b=this._getMenuItem(c),a=b.getDescendantById("imgI");if(d)a.addCssClass(SELECTED_MENU_ITEM_CLASS);else a.removeCssClass(SELECTED_MENU_ITEM_CLASS)};a.selectMenuItem=function Owa$UIControls$ContextMenu$selectMenuItem(a,b){if(b)a.addCssClass(SELECTED_MENU_ITEM_CLASS);else a.removeCssClass(SELECTED_MENU_ITEM_CLASS)};a.replaceMenuItemIcon=function Owa$UIControls$ContextMenu$replaceMenuItemIcon(d,b){var a=this._getMenuItem(d),c=a.getDescendantById("imgI");Owa.Components.CssSprites.updateImage(c,b)};a.get_CustomMenuIds=function Owa$UIControls$ContextMenu$get_CustomMenuIds(){return this._rgCustomMenuIds};a.getMenuItemAttribute=function Owa$UIControls$ContextMenu$getMenuItemAttribute(b,a){return this._getMenuItem(b).getAttribute(a)};a.selectMenuItemByAttribute=function Owa$UIControls$ContextMenu$selectMenuItemByAttribute(b,c){for(var a=0;a<this._rgMenuItems.length;a++)this.selectMenuItem(this._rgMenuItems[a],this._rgMenuItems[a].getAttribute(b)==c)};a.getMenuItem=function Owa$UIControls$ContextMenu$getMenuItem(a){return this._getMenuItem(a)};a.getAllMenuItems=function Owa$UIControls$ContextMenu$getAllMenuItems(){return this._rgAllMenuItems};Owa.UIControls.Popup.prototype._get_Container=function Owa$UIControls$Popup$_get_Container(){return null};a.get_OnSelect=function Owa$UIControls$ContextMenu$get_OnSelect(){return this._getEventHandlerCollection(j)};a._onMouseDown=function Owa$UIControls$ContextMenu$_onMouseDown(a){this._oCurrentSubmenu&&this._oCurrentSubmenu._suppressClose(true);Owa.UIControls.ContextMenu.callBase(this,"_onMouseDown",[a])};a._clearMenuSelection=function Owa$UIControls$ContextMenu$_clearMenuSelection(){for(var a=0;a<this._rgMenuItems.length;a++){var b=this._rgMenuItems[a];this.selectMenuItem(b,false)}};a._onMouseOver=function Owa$UIControls$ContextMenu$_onMouseOver(i){var a=getMenuItemForEvent(i);if(a&&a.getBoolAttribute(b)){this._clearMenuSelection();this.selectMenuItem(a,true);var g=a.getAttribute(d);if(g){var c=this._oSubmenus[g];this._showSubmenu(a,c)}else{var f=a.getAttribute(e);if(f){var h=new Function("return "+f),c=h(this.get_SubPage());c._oParentPopup=this;this._showSubmenu(a,c)}else this._hideSubmenu()}}};a._onMouseOut=function Owa$UIControls$ContextMenu$_onMouseOut(b){if(!this._oCurrentSubmenu||!this._oCurrentSubmenu.fIsOpen){this._clearMenuSelection();var a=getMenuItemForEvent(b);a&&this.selectMenuItem(a,false)}};a._onClick=function Owa$UIControls$ContextMenu$_onClick(f){var a=getMenuItemForEvent(f);if(!a||!a.getBoolAttribute(b))return;if(this._hasSubmenu(a))return;var e=a.getAttribute(c),d={};d.sCommand=e;d.oMenuItem=a;d.oMenu=this;this._fireOnSelect(d)};Owa.UIControls.ContextMenu.prototype._hasSubmenu=function Owa$UIControls$ContextMenu$_hasSubmenu(a){return a.getAttribute(d)||a.getAttribute(e)};a._createSubmenu=function Owa$UIControls$ContextMenu$_createSubmenu(a){return Owa.UIControls.ContextMenu.create(a,this,this.get_SubPage())};a._adjustMenuWithScrollbarWidth=function Owa$UIControls$ContextMenu$_adjustMenuWithScrollbarWidth(){this._get_Element().set_Width(this._get_Element().get_OffsetWidth()+10)};a._adjustSpacerWidths=function Owa$UIControls$ContextMenu$_adjustSpacerWidths(){for(var b=0;b<this._rgMenuItems.length;b++){var a=this._rgMenuItems[b];this._hasSubmenu(a)&&a.get_IsShown()&&this._adjustSpacerWidth(a)}};a._adjustSpacerWidth=function Owa$UIControls$ContextMenu$_adjustSpacerWidth(b){var a=b.get_OffsetWidth();a-=b.getEffectivePadding(Owa.Style.Side.Left);a-=b.getEffectivePadding(Owa.Style.Side.Right);a-=b.getEffectiveBorderWidth(Owa.Style.Side.Left);a-=b.getEffectiveBorderWidth(Owa.Style.Side.Right);var d=b.getDescendantById("spnImg");if(d){a-=d.get_OffsetWidth();a-=d.get_NextSibling().get_OffsetWidth()}var e=b.getDescendantById("spnT");a-=e.get_OffsetWidth();var c=b.getDescendantById("imgRA");a-=c.get_OffsetWidth();a-=c.getEffectiveMargin(Owa.Style.Side.Left);a-=c.getEffectiveMargin(Owa.Style.Side.Right);e.get_NextSibling().set_Width(a)};a._showSubmenu=function Owa$UIControls$ContextMenu$_showSubmenu(c,b){if(this._oCurrentSubmenu!=b){this._hideSubmenu();var a={};a.oMenuItem=c;a.oSubmenu=b;this._iCurrentSubmenuTimer=this._setTimeout(this._cbShowSubmenu,300,a)}};Owa.UIControls.ContextMenu.prototype._cbShowSubmenu=function Owa$UIControls$ContextMenu$_cbShowSubmenu(c){if(!this._iCurrentSubmenuTimer)throw"Hitting the timer callback without having the timer.";this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null;var e=c.oMenuItem,a=c.oSubmenu;if(this._oCurrentSubmenu==a)throw"Trying to show the submenu again.";var d=this._get_Element().get_OffsetWidth(),b=this._get_Element().get_DocumentLeft(),f=g_fRtl?b:b+d,g=e.get_DocumentTop();a.show(this._adjustSubmenuPosX(a,this,f),g);this._oCurrentSubmenu=a};Owa.UIControls.ContextMenu.prototype._adjustSubmenuPosX=function Owa$UIControls$ContextMenu$_adjustSubmenuPosX(h,e,c){var d=e._get_Element().get_OffsetWidth(),f=e._get_Element().get_DocumentLeft(),a=h._get_Element();if(a){a.set_IsShown(true);var b=a.get_OffsetWidth();a.set_IsShown(false);var g=a.get_ParentElement().get_OffsetWidth();if(g_fRtl&&f<b)c+=d+b;else if(!g_fRtl&&c+b>g)c-=d+b}return c};a._hideSubmenu=function Owa$UIControls$ContextMenu$_hideSubmenu(){if(this._iCurrentSubmenuTimer){this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null}if(this._oCurrentSubmenu){this._oCurrentSubmenu.close();this._oCurrentSubmenu=null}};a._fireOnSelect=function Owa$UIControls$ContextMenu$_fireOnSelect(b){this._suppressClose(true);this._removeTextBoxEventHandlers();var a=this._dispatchEvent(j,b);if(a){this._addTextBoxEventHandlers();this._enableClose()}else this.close();return a};a._getMenuItem=function Owa$UIControls$ContextMenu$_getMenuItem(b){var a=this._getDescendant(b);if(a)return a;for(var c in this._oSubmenus){a=this._oSubmenus[c]._getMenuItem(b);if(a)return a}return null};a._getMenuItemByCommand=function Owa$UIControls$ContextMenu$_getMenuItemByCommand(d){for(var a=0;a<this._rgAllMenuItems.length;a++){var b=this._rgAllMenuItems[a];if(b.getAttribute(c)==d)return b}return null};a._getAllMenuItems=function Owa$UIControls$ContextMenu$_getAllMenuItems(){var a=this._rgMenuItems;for(var b in this._oSubmenus)a=a.concat(this._oSubmenus[b]._rgMenuItems);return a};a.changeShowerSubPage=function Owa$UIControls$ContextMenu$changeShowerSubPage(a){this._oSubPage=a};function getMenuItemForEvent(b){var a=b.get_Target();if(!a.hasCssClass(i))a=a.getAncestorByClass(i,h);return a}function setMenuItemEnabled(a,c){a.setIntAttribute(b,c?1:0);if(c)a.removeCssClass(f);else a.addCssClass(f)}function showMenuItem(a,b){a.set_IsShown(b)}Owa.UIControls.ContextMenu.createClass("Owa.UIControls.ContextMenu",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/ContextMenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/RecipientContextMenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.RecipientContextMenu=function Owa$UIControls$RecipientContextMenu(a,b){Owa.UIControls.RecipientContextMenu.constructBase(this,[a,b])};var a=Owa.UIControls.RecipientContextMenu.prototype;Owa.UIControls.RecipientContextMenu.create=function Owa$UIControls$RecipientContextMenu$create(c,b){var a=new Owa.UIControls.RecipientContextMenu(c,b);a.set_SubPage(Owa.Components.Application.get_RootSubPage());a.initialize();a.get_OnSelect().add(a._createCallback(a._onSelect));a.get_OnClose().add(a._createCallback(a._onClose));a.get_OnPreShow().add(a._createCallback(a._onPreShow));a.oRecipientSpan=b;a.oRecipient=crtRecipObjectFromDomObject(b);a._attachEvent(a._get_Element(),"keydown",a._onKeyDown);return a};a.resetRecipient=function Owa$UIControls$RecipientContextMenu$resetRecipient(a){this.oRecipientSpan=a;this.oRecipient=crtRecipObjectFromDomObject(a)};a.showNoOpMenuItems=function Owa$UIControls$RecipientContextMenu$showNoOpMenuItems(b,c){for(var a=0;a<b.length;a++)this.showNoOpMenuItem(b[a],c)};a.showNoOpMenuItem=function Owa$UIControls$RecipientContextMenu$showNoOpMenuItem(b,c){var a=this._getMenuItem(b);a.set_IsShown(c)};a._onKeyDown=function Owa$UIControls$RecipientContextMenu$_onKeyDown(a){if(!this.oRecipientSpan)return;if(a.get_KeyCodeForKeyUpDown()==27){this.isEsc=1;this.close();a.preventDefault();a.cancelBubble()}};a._onPreShow=function Owa$UIControls$RecipientContextMenu$_onPreShow(){var a=this.oRecipient,l=this.oRecipientSpan.get_ParentElement(),c=null;if(l)c=l.get_Id();var h=0,g=0,b=0,i=0,d=isMobileRoutingType(a._rt),p=!String.isNullOrEmpty(a._mo),r=getRecipientSpanState(this.oRecipientSpan)==READONLY_RECIP_SPAN,j=this.oRecipientSpan.get_Id();if(j=="spnFrom"||j=="spnSender")h=1;else if(c=="divTo"||c=="divCc"||c=="divBcc"||c=="divFrom")g=1;if(!a._rt&&!a._em&&!a._sa)b=1;var n=h&&this.oRecipientSpan.getBoolAttribute("_fJnk"),q=getSubPageFromRecipientSpan(this.oRecipientSpan),i=isJnkEnbl()&&r&&(n||g)&&!q.getSubPageVariable("a_fP")&&!b,e=isPrivateDistributionList(a._rt),m=isDistributionList(a._rf);this._set_MenuHeader(e||m);if(g_fIsIMEnab&&gtIMMgr()&&!d)this._conditionInstantMessagingMenuItems();else this._hideInstantMessagingMenuItems();this.showNoOpMenuItems(["divAdOf","divAdPh","divCWPh","divCHPh","divCMPh"],0);this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(0);if(!isChatWindow()){var f=null;if(a._ao)f=validateAddressOrigin(a._ao);!m&&!e&&!b&&this._conditionPropertyMenuItems(f);this.enableMenuItem("divNwEml",!b);this.showMenuItem("divNwEml",!(b||d));this._getMenuItem("divSndSms")&&this.enableMenuItem("divSndSms",d||p);if(isFtEnab(FT_CAL)){this.enableMenuItem("divNwMtg",!b);this.showMenuItem("divNwMtg",!(b||d))}this._oElement.getDescendantById("divNewActionDivider").set_IsShown(!d);isFtEnab(FT_CTS)&&this.showMenuItem("divAC",f!=AO_S);var o=!e||isFtEnab(FT_CTS)&&e;this.enableMenuItem("divPr",o);this.oRecipientWell=this._get_RecipientWell();var k=false;if(this.oRecipientWell)k=!this.oRecipientWell.get_IsReadOnly()&&this.oRecipientWell.get_IsEnabled();this.showMenuItem("divRmv",k);this._getMenuItem("divJnkSender")&&this.showMenuItem("divJnkSender",i&&h);this._getMenuItem("divJnkRecipient")&&this.showMenuItem("divJnkRecipient",i&&g)}else{this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(0);this._oElement.getDescendantById("divNewActionDivider").set_IsShown(0);this._oElement.getDescendantById("divInstantMessagingDivider").set_IsShown(0);this.showMenuItems(["divNwEml","divNwMtg","divAC","divPr","divRmv"],0);this._getMenuItem("divJnkSender")&&this.showMenuItem("divJnkSender",0);this._getMenuItem("divJnkRecipient")&&this.showMenuItem("divJnkRecipient",0);this._getMenuItem("divSndSms")&&this.showMenuItem("divSndSms",0)}};a._conditionPropertyMenuItems=function Owa$UIControls$RecipientContextMenu$_conditionPropertyMenuItems(a){var c=a==AO_D||a==AO_S||a==AO_O;if(!c)return;var e=!this.oRecipient._em,d=hasNoExchangeId(a,this.oRecipient);if((a==AO_D||a==AO_O)&&e||a==AO_S&&d||(a==AO_S||a==AO_O)&&!isFtEnab(FT_CTS))return;this._update_Property("AdOf",L_Elps);this._update_Property("AdPh",L_Elps);this._update_Property("CWPh",L_Elps);this._update_Property("CHPh",L_Elps);this._update_Property("CMPh",L_Elps);var b=1;switch(a){case AO_D:this.showNoOpMenuItems(["divAdOf","divAdPh"],1);break;case AO_S:this.showNoOpMenuItems(["divCWPh","divCHPh","divCMPh"],1);break;case AO_O:b=0}this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(b);this._get_Properties(a)};a._hideInstantMessagingMenuItems=function Owa$UIControls$RecipientContextMenu$_hideInstantMessagingMenuItems(){var b=["divCht","divUnblkBdy","divBlkBdy","divRmBdyLst","divAdBdyLst"],c=this._oElement.getDescendantById("divInstantMessagingDivider");c&&c.set_IsShown(0);for(var a=0;a<b.length;a++){var d=this._getMenuItem(b[a]);d&&this.showMenuItem(b[a],0)}};a._conditionInstantMessagingMenuItems=function Owa$UIControls$RecipientContextMenu$_conditionInstantMessagingMenuItems(){var j=isDistributionList(this.oRecipient_rf),a=gtRcpIM(this.oRecipientSpan._get_DomNode()),n=isExistingChatSession(a),d=isInstantMessagingIsDown(),f=0,b=0,e=0;if(!j&&a){f=isSlfUri(a);if(!f){b=isBuddy(a);if(!b&&this.oRecipientSpan.getBoolAttribute("_sipTrsp")){var i=gtStlUri(a);if(i)b=isBuddy(i)}e=gtIMMgr().IsBlkd(a)}}var c=!j&&a&&!f,l=c&&!n&&!d&&(isOCSPrv()||b&&isMSNPrv());this.showMenuItem("divCht",1);this.enableMenuItem("divCht",l);var h=c&&e;this._getMenuItem("divUnblkBdy")&&this.showMenuItem("divUnblkBdy",h);if(this._getMenuItem("divBlkBdy")){var k=c&&!e&&b;this.showMenuItem("divBlkBdy",!h);this.enableMenuItem("divBlkBdy",k)}var g=c&&b;this.showMenuItem("divRmBdyLst",g);this.enableMenuItem("divRmBdyLst",!d);var m=c&&!d;this.showMenuItem("divAdBdyLst",!g);this.enableMenuItem("divAdBdyLst",m)};a._set_MenuHeader=function Owa$UIControls$RecipientContextMenu$_set_MenuHeader(c){var a=this._oElement.getDescendantById("spnHdr"),b=this.oRecipientSpan.get_TextContent();a.set_TextContent(b);a.setAttribute("title",b);if(c)a.addCssClass("bld");else a.removeCssClass("bld")};a._get_Properties=function Owa$UIControls$RecipientContextMenu$_get_Properties(){var a=new oeReq("RecipWell","GetRecipProps",this.oRecipient,this._createCallback(this._get_PropertiesCallback));a.add("ao",this.oRecipient._ao);a.add("em",this.oRecipient._em);a.add("rt",this.oRecipient._rt);this.oRecipient._id&&a.add("id",this.oRecipient._id);a.send()};a._update_Property=function Owa$UIControls$RecipientContextMenu$_update_Property(a,c){var b=this._getMenuItem("div"+a);b.getDescendantById("spn"+a).set_TextContent(c)};a._get_PropertiesCallback=function Owa$UIControls$RecipientContextMenu$_get_PropertiesCallback(b){if(b.fST){popLgn();return}var c=b.sErr!=null,f=b.oCtx,d=validateAddressOrigin(f._ao);if(!c){var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_IsShown(false);a.set_InnerHtml(b.sBody);if(a.getDescendantById("err"))c=true;else switch(d){case AO_D:this._update_Property("AdOf",a.getDescendantById("AdOf").get_TextContent());this._update_Property("AdPh",a.getDescendantById("AdPh").get_TextContent());var e=a.getDescendantById("AdId");e&&this._oElement.setAttribute("_id",e.get_TextContent());break;case AO_O:this.showNoOpMenuItems(["divCWPh","divCHPh","divCMPh"],1);this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(1);case AO_S:this._update_Property("CWPh",a.getDescendantById("CWPh").get_TextContent());this._update_Property("CHPh",a.getDescendantById("CHPh").get_TextContent());this._update_Property("CMPh",a.getDescendantById("CMPh").get_TextContent())}a.remove(true)}c&&this._set_PropertiesToUnavailable(d)};a._set_PropertiesToUnavailable=function Owa$UIControls$RecipientContextMenu$_set_PropertiesToUnavailable(a){switch(a){case AO_D:this._update_Property("AdOf",L_NotAvailable);this._update_Property("AdPh",L_NotAvailable);break;case AO_S:this._update_Property("CWPh",L_NotAvailable);this._update_Property("CHPh",L_NotAvailable);this._update_Property("CMPh",L_NotAvailable)}};a._get_SmtpAddress=function Owa$UIControls$RecipientContextMenu$_get_SmtpAddress(){return htmlEnc(this.oRecipientSpan.getAttribute("title"))};a._onSelect=function Owa$UIControls$RecipientContextMenu$_onSelect(b){var c=this.oRecipientSpan._get_DomNode();this.oRecipientWell=this._get_RecipientWell();var a=getSubPageFromRecipientSpan(this.oRecipientSpan);switch(b.sCommand){case"ac":addRecipientSpanToContacts(c);break;case"prps":onClicktoShowPropertiesSheet(c);break;case"rmv":this.oRecipientWell=this._get_RecipientWell();if(this.oRecipientWell){this.oRecipientWell._oElement.focus(1);this.oRecipientWell.removeRecipient(this.oRecipientSpan)}break;case"tobsl":if(a_sJnkId==a.getSubPageVariable("a_sFId")||!a.getSubPageVariable("a_sId"))addToJnkLst(a,BSL,this._get_SmtpAddress(),0,b.oMenuItem.get_TextContent(),0,null,null);else addToJnkLst(a,BSL,this._get_SmtpAddress(),0,b.oMenuItem.get_TextContent(),!a.getSubPageVariable("a_fPrv"),a.getSubPageVariable("a_sId"),ACTN_ADDBSL);break;case"tossl":addToJnkLst(a,SSL,this._get_SmtpAddress(),0,b.oMenuItem.get_TextContent(),0,null,null);break;case"dmtossl":addToJnkLst(a,SSL,this._get_SmtpAddress(),1,b.oMenuItem.get_TextContent(),0,null,null);break;case"rcvsrl":addToJnkLst(a,SRL,this._get_SmtpAddress(),0,b.oMenuItem.get_TextContent(),0,null,null);break;case"chat":nwChtFrmRcp(c);break;case"ablst":addBdyLstReq(a,c);break;case"rmblst":rmBdyLstReq(a,c);break;case"blkbdy":blockBuddyRequest(gtRcpIM(c));break;case"unblkbdy":blockBuddyRequest(gtRcpIM(c),1);break;case"nwmtg":case"nweml":if(this.oRecipient._id)newMessageOrMeeting(a,b.sCommand=="nwmtg"?ITTP_MTG:ITTP_MSG,new Array(this.oRecipient._id),this.oRecipient._ao==AO_D);else if(this.oRecipient._em){var d=this.oRecipientSpan.get_TextContent();opnNwMsg(this.oRecipient._em,d,0,0,b.sCommand=="nwmtg"?1:0,a)}break;case"sendsms":if(this.oRecipient._id)newMessageOrMeeting(a,ITTP_TXT,new Array(this.oRecipient._id),this.oRecipient._ao==AO_D);else if(this.oRecipient._rt=="MOBILE"&&this.oRecipient._em!="")opnNwSms(this.oRecipient._em,this.oRecipient._dn,a);else this.oRecipient._mo&&opnNwSms(this.oRecipient._mo,this.oRecipient._dn,a)}};a.dispose=function Owa$UIControls$RecipientContextMenu$dispose(){this.oRecipientSpan=null;this._detachEvent(this._get_Element(),"keydown",this._onKeyDown);Owa.UIControls.ContextMenu.callBase(this,"dispose")};a._onClose=function Owa$UIControls$RecipientContextMenu$_onClose(){this.isEsc==1&&this._hideSubmenu();if(this.oRecipientSpan&&getRecipientSpanState(this.oRecipientSpan)==READWRITE_RECIP_SPAN&&this.isEsc==1){var a=this._get_RecipientWell();a&&a._oElement.focus(1)}};a._get_RecipientWell=function Owa$UIControls$RecipientContextMenu$_get_RecipientWell(){var b=null,c=this.oRecipientSpan.get_ParentElement();if(c){var a=c.get_ParentElement();if(a)b=a.getExpando("_oControl")}return b};function isChatWindow(){return isDf(typeof a_fChtWin)}function hasNoExchangeId(a,b){return(a==AO_S||a==AO_D)&&!b}function isPrivateDistributionList(a){return a==RT_PDL}function isMobileRoutingType(a){return a==RT_MBL}function isDistributionList(a){return a&R_DL}function isExistingChatSession(a){return g_fIsIMEnab&&gtIMMgr()&&a&&isDf(typeof a_fChtWin)&&gtIMMgr().FndExstChtSsn(a)}function isInstantMessagingIsDown(){return g_fIsIMEnab&&gtIMMgr()&&gtMstr()&&gtMstr().g_iIM_SI}Owa.UIControls.RecipientContextMenu.createClass("Owa.UIControls.RecipientContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/RecipientContextMenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/LazyLoadContextMenu.js".toLowerCase()]&&(function(){Owa.UIControls.LazyLoadContextMenu=function Owa$UIControls$LazyLoadContextMenu(){this._fLoading=0;Owa.UIControls.LazyLoadContextMenu.constructBase(this)};var a=Owa.UIControls.LazyLoadContextMenu.prototype;a.show=function Owa$UIControls$LazyLoadContextMenu$show(b,c,a){if(this.get_IsDomElementLoaded())Owa.UIControls.LazyLoadContextMenu.callBase(this,"show",[b,c,a]);else this._loadAndShow(b,c,a)};a._loadAndShow=function Owa$UIControls$LazyLoadContextMenu$_loadAndShow(b,c,a){this._iX=b;this._iY=c;this._fFarCorner=a;this._loadHtmlContent()};a._loadHtmlContent=function Owa$UIControls$LazyLoadContextMenu$_loadHtmlContent(){if(this._fIsLoading)return;this._fIsLoading=true;this._createLoadHtmlContentRequest(this._createCallback(this._onHtmlContentLoaded)).send()};a._onHtmlContentLoaded=function Owa$UIControls$LazyLoadContextMenu$_onHtmlContentLoaded(a){this._fIsLoading=false;if(!cbOeh(a))return;var b=a.getResponseAsDomElement(false);this._initializeDomElement(b);this.initialize();if(this._oParentPopup){if(this._oParentPopup._oCurrentSubmenu!=this)return;this._iX=this._adjustSubmenuPosX(this,this._oParentPopup,this._iX)}this.show(this._iX,this._iY,this._fFarCorner)};a._createLoadHtmlContentRequest=function Owa$UIControls$LazyLoadContextMenu$_createLoadHtmlContentRequest(){throw Error("Not implemented");};Owa.UIControls.LazyLoadContextMenu.createClass("Owa.UIControls.LazyLoadContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/LazyLoadContextMenu.js".toLowerCase()]=1;var ACTION_RESOLVE=0,ACTION_CONTEXT=1,ACTION_ONEOFF=2;!g_fModuleLoaded[".\\uicontrols/RecipientAnrContextMenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b=null,i="divAm",e="divAmNms",g="divAmRmv",f="spnHdr",d="rmv",h="an",c="onHideContext";Owa.UIControls.RecipientAnrContextMenu=function Owa$UIControls$RecipientAnrContextMenu(){Owa.UIControls.RecipientAnrContextMenu.constructBase(this);this.get_OnSelect().add(this._createCallback(this._onSelect));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow))};Owa.UIControls.RecipientAnrContextMenu.createClass("Owa.UIControls.RecipientAnrContextMenu",Owa.UIControls.LazyLoadContextMenu);var a=Owa.UIControls.RecipientAnrContextMenu.prototype;Owa.UIControls.RecipientAnrContextMenu.get_Instance=function Owa$UIControls$RecipientAnrContextMenu$get_Instance(){if(!b){b=new Owa.UIControls.RecipientAnrContextMenu;b.set_SubPage(Owa.Components.Application.get_RootSubPage())}return b};a.set_Action=function Owa$UIControls$RecipientAnrContextMenu$set_Action(a){this.iAction=a};a.set_Config=function Owa$UIControls$RecipientAnrContextMenu$set_Config(a){this.oConfig=a};a.set_FnAnrCallback=function Owa$UIControls$RecipientAnrContextMenu$set_FnAnrCallback(a){this.fnOnEndAnrCallback=a};a.set_RecipientSpan=function Owa$UIControls$RecipientAnrContextMenu$set_RecipientSpan(a,b){this.oRecipientSpan=a;if(!a)this.oRecipientWell=null;else if(!b)this.oRecipientWell=this._get_RecipientWell()};a.set_AnrRecipientResults=function Owa$UIControls$RecipientAnrContextMenu$set_AnrRecipientResults(a){this._rgAnrRecipientResults=a};a.showAnrMenu=function Owa$UIControls$RecipientAnrContextMenu$showAnrMenu(){(this.iAction==ACTION_CONTEXT||this.iAction==ACTION_ONEOFF)&&Owa.UIControls.AutoCompleteCache.hide();switch(this.iAction){case ACTION_RESOLVE:this._iWellIndex=0;this._iRecipientIndex=0;this._showMenuOrfinishAnr();break;case ACTION_CONTEXT:this.showUnder(this.oRecipientSpan,0,false);break;case ACTION_ONEOFF:this.showUnder(this.oRecipientSpan,0,false)}};a.show=function Owa$UIControls$RecipientAnrContextMenu$show(b,c,a){this.fAddMenuHtml=0;this.fAddResolveOne=0;if(!this.get_IsDomElementLoaded())this.fAddMenuHtml=1;if(this.iAction==ACTION_RESOLVE||this.iAction==ACTION_CONTEXT)this.fAddResolveOne=1;if(!this.fAddResolveOne&&!this.fAddMenuHtml)Owa.UIControls.RecipientAnrContextMenu.callBase(this,"show",[b,c,a]);else this._loadAndShow(b,c,a)};a.dispose=function Owa$UIControls$RecipientAnrContextMenu$dispose(){g_AnrPnd=0;this.oConfig=null;this.oRecipientSpan=null;this.oRecipientWell=null;this._rgAnrRecipientResults=null;this.fnOnEndAnrCallback=null;this.oInstance=null;Owa.UIControls.RecipientAnrContextMenu.callBase(this,"dispose")};a.get_OnHideContext=function Owa$UIControls$ContextMenu$get_OnHideContext(){return this._getEventHandlerCollection(c)};a._get_RecipientWell=function Owa$UIControls$RecipientAnrContextMenu$_get_RecipientWell(){var b=null,c=this.oRecipientSpan.get_ParentElement();if(c){var a=c.get_ParentElement();if(a)b=a.getExpando("_oControl")}return b};a._createLoadHtmlContentRequest=function Owa$UIControls$RecipientAnrContextMenu$_createLoadHtmlContentRequest(b){var a=new oeReq("RecipWell","ResolveOneRecipientForAnrMenu",0,b);a.set_ProcessXhrStatusZeroAsError();this.fAddMenuHtml&&a.add("AddMenuMarkup",1);if(this.fAddResolveOne){a.add("AddRecipientResults",1);this._addResolveOneRecipientParams(a)}shwPrgrsInd(L_Ld);return a};a._addResolveOneRecipientParams=function Owa$UIControls$RecipientAnrContextMenu$_addResolveOneRecipientParams(a){a.add("n",this.oRecipientSpan.get_TextContent());Owa.Components.RecipientWellManager.get_Instance().addAnrOptions(this.oRecipientWell.sConsumerId,a)};a._onHtmlContentLoaded=function Owa$UIControls$RecipientAnrContextMenu$_onHtmlContentLoaded(a){hdPrgrsInd();this._fIsLoading=false;if(!cbOeh(a)){g_AnrPnd=0;return}eval(a.sBody);if(this.fAddMenuHtml){this.fAddMenuHtml=0;var b=this._createMenuAsDomElement(sHtmlMenu);this._initializeDomElement(b);this.initialize()}if(this.fAddResolveOne){this.fAddResolveOne=0;this._rgAnrRecipientResults=eval(rgRecips)}Owa.UIControls.RecipientAnrContextMenu.callBase(this,"show",[this._iX,this._iY,this._fFarCorner])};a._createMenuAsDomElement=function Owa$UIControls$RecipientAnrContextMenu$_createMenuAsDomElement(b){var a=Owa.Dom.Document.get_Current().get_Body();a.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,b);var c=a.get_LastChild();return c};a._initializeDomElement=function Owa$UIControls$RecipientAnrContextMenu$_initializeDomElement(a){Owa.UIControls.RecipientAnrContextMenu.callBase(this,"_initializeDomElement",[a]);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown)};a._onPreShow=function Owa$UIControls$RecipientAnrContextMenu$_onPreShow(){this.fPnd=1;this._updateMenuData()};a._updateMenuData=function Owa$UIControls$RecipientAnrContextMenu$_updateMenuData(){this._oElement.set_IsShown(false);this._buildAnrNamesHtml(this._rgAnrRecipientResults);this._set_MenuHeader();this.setRemoveText();if(this.oRecipientSpan.getBoolAttribute("fDel")||this.oRecipientSpan.get_TextContent()==""){g_AnrPnd=0;return}this._adjustMenu();this._oElement.set_IsShown(true)};a._adjustMenu=function Owa$UIControls$RecipientAnrContextMenu$_adjustMenu(){var a=this._get_NamesContainer();a.set_ScrollTop(0);this.selectMenuItem(this._rgMenuItems[0],1)};a._buildAnrNamesHtml=function Owa$UIControls$RecipientAnrContextMenu$_buildAnrNamesHtml(){var a="",c=this._get_NamesContainer();c.set_IsShown(false);for(var b=0;b<this._rgAnrRecipientResults.length;b++){var d=getSmtpOrCustomRoutingAddress(this._rgAnrRecipientResults[b]),e=htmlEnc(this._rgAnrRecipientResults[b]._dn);a+="<div _lnk=1 class=cmLnk cmd=an";a+=getHtmlEncodedRecipPropsStr(this._rgAnrRecipientResults[b]);a+=' title="';if(!isNoE(d))a+=d;else a+=e;a+='">';a+="<span class=amCo>";a+="<span class=amDN>"+e+"</span><span class=amEM>";if(!isNoE(d))a+=d;a+="</span>";a+="</span>";a+="</div>"}c._oDomNode.style.height=this._rgAnrRecipientResults.length>10?"15em":"";c.set_InnerHtml(a);$("divRemoveDivider").set_IsShown(true);c.set_IsShown(a.length);this.setMenuItems()};a._get_NamesContainer=function Owa$UIControls$RecipientAnrContextMenu$_get_NamesContainer(){return this._oElement.getDescendantById(e)};a._get_RemoveName=function Owa$UIControls$RecipientAnrContextMenu$_get_RemoveName(){return this._oElement.getDescendantById(g)};a._set_MenuHeader=function Owa$UIControls$RecipientAnrContextMenu$_set_MenuHeader(){var a=this._oElement.getDescendantById(f);if(this._get_NamesContainer().hasChildNodes()){sTitle=L_MulMtch;a.removeCssClass("noMatches")}else{sTitle=L_NoMtch;a.addCssClass("noMatches")}a.set_TextContent(sTitle);a.setAttribute("title",sTitle)};a.setRemoveText=function Owa$UIControls$RecipientAnrContextMenu$setRemoveText(){var a=L_Rmv;this._get_RemoveName().getDescendantById("spnT").set_TextContent(a)};a._onKeyDown=function Owa$UIControls$RecipientAnrContextMenu$_onKeyDown(b){if(!this.oRecipientSpan)return;var c=b.get_KeyCodeForKeyUpDown(),a=this._getSelectedMenuItemIndex();switch(c){case 40:case 38:case 36:case 35:this._handleNavigation(c,a);break;case 9:case 13:a>-1&&this._rgMenuItems[a].click();break;case 27:this.close()}b.preventDefault();b.cancelBubble()};a._getSelectedMenuItemIndex=function Owa$UIControls$RecipientAnrContextMenu$_getSelectedMenuItemIndex(){for(var a=0;a<this._rgMenuItems.length;a++)if(this._rgMenuItems[a].hasCssClass(SELECTED_MENU_ITEM_CLASS))return a;return-1};a._scrollToMenuItem=function Owa$UIControls$RecipientAnrContextMenu$_scrollToMenuItem(c){var a=this._get_NamesContainer(),b=a.get_ScrollHeight()/(this._rgMenuItems.length-2),d=a.get_ScrollTop()/b;if(c<d)a.set_ScrollTop(c*b);else{var e=(a.get_ScrollTop()+a.get_OffsetHeight())/b-1;c>e&&a.set_ScrollTop((c+1)*b-a.get_OffsetHeight())}};a._handleNavigation=function Owa$UIControls$RecipientAnrContextMenu$_handleNavigation(d,b){var c=this._rgMenuItems.length-1,a=0;switch(d){case 40:if(b<c)a=b+1;else a=c;break;case 38:if(b>0)a=b-1;else a=0;break;case 35:a=c;break;case 36:a=0}if(b!=a){b!=-1&&this.selectMenuItem(this._rgMenuItems[b],0);this.selectMenuItem(this._rgMenuItems[a],1);a!=c&&this._scrollToMenuItem(a)}};a._onSelect=function Owa$UIControls$RecipientAnrContextMenu$_onSelect(a){this.sCommand=a.sCommand;switch(a.sCommand){case d:this.oRecipientWell._oElement.focus(1);this.oRecipientWell.removeRecipient(this.oRecipientSpan);break;case h:this._addResolvedName(a.oMenuItem)}};a._addResolvedName=function Owa$UIControls$RecipientAnrContextMenu$_addResolvedName(a){transferBetweenDomObjects(a,this.oRecipientSpan);this.oRecipientSpan.setAttribute("_acu","1");this.oRecipientWell._onResize()};a._onClose=function Owa$UIControls$RecipientAnrContextMenu$_onClose(){this.fIsCanceled=!this.sCommand;switch(this.iAction){case ACTION_RESOLVE:if(this.sCommand)this._onHideAfterActionForResolve();else this._finishAnr();break;case ACTION_CONTEXT:case ACTION_ONEOFF:this._onHideAfterContextMenu()}this.selectMenuItem(this._get_RemoveName(),0);this.sCommand=null;this.fIsCanceled=null;if(this.iAction!=ACTION_RESOLVE)g_AnrPnd=0};a._getNextRecipient=function Owa$UIControls$RecipientAnrContextMenu$_getNextRecipient(){var a=null;this.oRecipientWell=this.oConfig.rgAmbiguousWells[this._iWellIndex];if(!this.oRecipientWell)return null;if(this._iRecipientIndex>=this.oRecipientWell._rgAmbiguousRecipients.length){this._iRecipientIndex=0;this._iWellIndex++;if(this._iWellIndex>=this.oConfig.rgAmbiguousWells.length)return null;this.oRecipientWell=this.oConfig.rgAmbiguousWells[this._iWellIndex]}a=this.oRecipientWell._rgAmbiguousRecipients[this._iRecipientIndex];this._iRecipientIndex++;return a};a._showMenuOrfinishAnr=function Owa$UIControls$RecipientAnrContextMenu$_showMenuOrfinishAnr(){var a=this._getNextRecipient();if(this.fIsOpen||!a)this._finishAnr();else{if(!Owa.Dom.Node.isInstance(a))a=Owa.Dom.Node.wrapDomNode(a);this.set_RecipientSpan(a,true);this.showUnder(this.oRecipientSpan,0,false)}};a._finishAnr=function Owa$UIControls$RecipientAnrContextMenu$_finishAnr(){g_AnrPnd=0;if(!this.oConfig)return;this._resetFocus();var a=this._getCommandResult();this.fnOnEndAnrCallback&&this.fnOnEndAnrCallback([a,this.oConfig])};a._onHideAfterActionForResolve=function Owa$UIControls$RecipientAnrContextMenu$_onHideAfterActionForResolve(){this._showMenuOrfinishAnr()};a._getCommandResult=function Owa$UIControls$RecipientAnrContextMenu$_getCommandResult(){var a=RESOLVE_ANR_COMPLETE;if(this.fIsCanceled)a=RESOLVE_ANR_CANCEL;return a};a._onHideAfterContextMenu=function Owa$UIControls$RecipientAnrContextMenu$_onHideAfterContextMenu(){this._resetFocus();var a=this._getCommandResult();this._dispatchEvent(c,this.oRecipientWell,a)};a._resetFocus=function Owa$UIControls$RecipientAnrContextMenu$resetFocus(){this.oRecipientWell._oElement.get_IsShown()&&this.oRecipientWell.setFocus();if(this.sCommand!=d&&this.oRecipientSpan){var b=this.oRecipientSpan._oDomNode.parentNode;if(b==null)return;var a=createSelectionRange();if(!Owa.Utility.isIE())a.setCaretAfter(b);else{a.moveToElementText(b);a.setEndPoint("StartToEnd",a);a.moveEnd(1);a.collapse(0)}this.oRecipientWell._onResize()}}})();g_fModuleLoaded[".\\uicontrols/RecipientAnrContextMenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/RecipientOneOffDialog.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var e="divOneOffPrp",d=400,b="txtSMTP",c="txtDN";Owa.UIControls.RecipientOneOffDialog=function Owa$UIControls$RecipientOneOffDialog(b,a){var f='<table cellpadding=0 cellspacing=0 class="oneOffPrp w100"><tr><td class="lbl" nowrap>'+htmlEnc(L_DispNm)+' </td><td class=oneOffTxtBx><input id=txtDN class=cntTxt type=text maxlength=256></td></tr><tr><td class="lbl" nowrap>'+htmlEnc(L_Addr)+" </td><td class=oneOffTxtBx><input id=txtSMTP class=cntTxt type=text maxlength=256></td></tr></table>",c=isFtEnab(FT_CTS)?[L_AddToCnt,L_OK,L_Cncl]:[L_OK,L_Cncl];Owa.UIControls.RecipientOneOffDialog.constructBase(this,[e,f,L_AddrPrp,c,d,null,a?a:null,null,0,0]);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this.oRecipientSpan=b;this._updateDialogUI()};Owa.UIControls.RecipientOneOffDialog.createClass("Owa.UIControls.RecipientOneOffDialog",Owa.UIControls.ButtonDialog);var a=Owa.UIControls.RecipientOneOffDialog.prototype;a.dispose=function Owa$UIControls$RecipientOneOffDialog$dispose(){Owa.UIControls.RecipientOneOffDialog.callBase(this,"dispose")};a.get_DisplayNameTextBox=function Owa$UIControls$RecipientOneOffDialog$get_DisplayNameTextBox(){return this._oElement.getDescendantById(c)};a.get_EmailAddressTextBox=function Owa$UIControls$RecipientOneOffDialog$get_EmailAddressTextBox(){return this._oElement.getDescendantById(b)};a._updateDialogUI=function Owa$UIControls$RecipientOneOffDialog$_updateDialogUI(){var c=this._get_EmailAddress(),a=this.oRecipientSpan.getAttribute("_dn");if(!a)a=c;this.originalDisplayName=a;this.originalEmailAddress=c;var b=this.get_EmailAddressTextBox(),d=this.get_DisplayNameTextBox();d.set_Value(a);b.set_Value(c);var e=getRecipientSpanState(this.oRecipientSpan)==READONLY_RECIP_SPAN;if(e){b.set_IsDisabled(true);this.enableButton(L_OK,0)}else{b.set_IsDisabled(false);this.enableButton(L_OK,1)}};a._get_EmailAddress=function Owa$UIControls$RecipientOneOffDialog$_get_EmailAddress(){var b="",d=this.oRecipientSpan.getAttribute("_sa");if(isNoE(d)){var a=this.oRecipientSpan.getAttribute("_em"),c=this.oRecipientSpan.getAttribute("_rt");if(!isNoE(c)&&!isNoE(a)&&c!=gtDftRT())b=c.trim()+": "+a.trim();else if(!isNoE(a))b=a.trim()}else b=d.trim();return b};a._get_RecipientWell=function Owa$UIControls$RecipientOneOffDialog$_get_RecipientWell(){if(Owa.UIControls.EditPDLRecipientOneOffDialog.isInstance(this))throw"Owa.UIControls.EditPDLRecipientOneOffDialog does not support get_RecipientWell method";var b=null,c=this.oRecipientSpan.get_ParentElement();if(c){var a=c.get_ParentElement();if(a)b=a.getExpando("_oControl")}return b};a._onButtonDialogClose=function Owa$UIControls$RecipientOneOffDialog$_onButtonDialogClose(g){if(g==-1)return;if(!isFtEnab(FT_CTS))g++;var i=this.get_EmailAddressTextBox(),j=this.get_DisplayNameTextBox(),b=j.get_Value().trim(),a=i.get_Value().trim();if(b||a)switch(g){case 0:var e=a.indexOf(":"),h=gtDftRT(),d="";if(e!=-1){h=a.substring(0,e).trim();d=a.substring(e+1).trim()}else d=a;var c=getEm("SPAN");c.setAttribute("_dn",b);c.setAttribute("_em",d);c.setAttribute("_ao",AO_O.toString());c.setAttribute("_rt",h);addRecipientSpanToContacts(c);break;case 1:if(!Owa.UIControls.EditPDLRecipientOneOffDialog.isInstance(this)&&getRecipientSpanState(this.oRecipientSpan)==READWRITE_RECIP_SPAN&&(b!=this.originalDisplayName||a!==this.originalEmailAddress)){if(!b)b=a;var f={};f.sDN=htmlEnc(b);f.sEm=htmlEnc(a);this._resolveOne(b,a,f)}}};a._resolveOne=function Owa$UIControls$RecipientOneOffDialog$_resolveOne(b,c,d){if(this._fIsLoading)return;this._fIsLoading=1;var a=new oeReq("RecipWell","ResolveOneRecipient",d,this._createCallback(this._resolveOneCallback));this._addAnrOptions(a);if(!isDftRT(RT_SMTP)||b.lc().indexOf(c.lc())<0)a.add("n",'"'+b+'" ['+c+"]");else a.add("n",b);a.send()};a._resolveOneCallback=function Owa$UIControls$RecipientOneOffDialog$_resolveOneCallback(a){this._fIsLoading=0;if(!cbOeh(a))return;var b=eval(a.sBody);if(b.length==1)transferFromRecipToSpan(b[0],this.oRecipientSpan);else this._updateRecipientInfo(b,a.oCtx.sDN,a.oCtx.sEm)};a._addAnrOptions=function Owa$UIControls$RecipientOneOffDialog$_addAnrOptions(b){var a=this._get_RecipientWell();Owa.Components.RecipientWellManager.get_Instance().addAnrOptions(a.sConsumerId,b)};a._updateRecipientInfo=function Owa$UIControls$RecipientOneOffDialog$_updateRecipientInfo(d,a,b){var c=a;if(a.lc().indexOf(b.lc())<0)c=a+" "+g_sDE+"["+b+"]"+g_sDE;this.oRecipientSpan.set_InnerHtml(c);this.oRecipientSpan.setAttribute("_dn","");this.oRecipientSpan.setAttribute("_sa","");this.oRecipientSpan.setAttribute("_em","");this.oRecipientSpan.setAttribute("_rt","");this.oRecipientSpan.setAttribute("_ao",AO_N.toString());this.oRecipientSpan.set_Title("");this.oRecipientSpan.set_CssClasses(["rwUR"]);this.oRecipientSpan.setAttribute("_acu","0");this._shwAnrMnuForOneOffDialog(d)};a._shwAnrMnuForOneOffDialog=function Owa$UIControls$RecipientOneOffDialog$_shwAnrMnuForOneOffDialog(a){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_ONEOFF);g_AnrCtxMnu.set_Config(null);g_AnrCtxMnu.set_FnAnrCallback(null);g_AnrCtxMnu.set_RecipientSpan(this.oRecipientSpan);g_AnrCtxMnu.set_AnrRecipientResults(a);Owa.UIControls.AutoCompleteCache.hide();g_AnrCtxMnu.showAnrMenu()};Owa.UIControls.EditPDLRecipientOneOffDialog=function Owa$UIControls$EditPDLRecipientOneOffDialog(a,b){Owa.UIControls.EditPDLRecipientOneOffDialog.constructBase(this,[a,b])};Owa.UIControls.EditPDLRecipientOneOffDialog.createClass("Owa.UIControls.EditPDLRecipientOneOffDialog",Owa.UIControls.RecipientOneOffDialog);var a=Owa.UIControls.EditPDLRecipientOneOffDialog.prototype;a._updateDialogUI=function Owa$UIControls$EditPDLRecipientOneOffDialog$_updateDialogUI(){Owa.UIControls.EditPDLRecipientOneOffDialog.callBase(this,"_updateDialogUI");this.getButton(L_AddToCnt).set_IsShown(false);this._attachEvent(this.get_EmailAddressTextBox(),"keyup",this._onEmailAddressKeyUp)};a._onEmailAddressKeyUp=function Owa$UIControls$EditPDLRecipientOneOffDialog$_onEmailAddressKeyUp(){var a=this.get_EmailAddressTextBox().get_Value();this.enableButton(L_OK,a.trim())}})();g_fModuleLoaded[".\\uicontrols/RecipientOneOffDialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/recipientwellmanager.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");var b=null;Owa.Components.RecipientWellManager=function Owa$Components$RecipientWellManager(){Owa.Components.RecipientWellManager.constructBase(this);this._rgConsumers=[]};var a=Owa.Components.RecipientWellManager.prototype;Owa.Components.RecipientWellManager.get_Instance=function Owa$Components$RecipientWellManager$get_Instance(){if(!b)b=new Owa.Components.RecipientWellManager;return b};a.dispose=function Owa$Components$RecipientWellManager$dispose(){for(var a=0;a<this._rgConsumers.length;a++){for(var b=this._rgConsumers[a].rgRecipientWells,c=0;c<b.length;c++)b[c].dispose();b=null;this._rgConsumers[a]=null}Owa.Components.RecipientWellManager.callBase(this,"dispose")};a.registerWells=function Owa$Components$RecipientWellManager$registerWells(a,d){if(!a.length)throw"argument rgRecipientWells cannot be empty";for(var c=0;c<a.length;c++);var b=rndm(),e=new Owa.Components._RecipientWellConsumer(b,a,d);this._addConsumer(e);return b};a.addRecipientWell=function Owa$Components$RecipientWellManager$addRecipientWell(c,b){var a=this._get_Consumer(c);if(a){var d=this._indexOfConsumerWell(a,b._oElement);if(d<0){b.sConsumerId=a.sId;a.rgRecipientWells.push(b);return true}}return false};a.removeRecipientWell=function Owa$Components$RecipientWellManager$removeRecipientWell(e,c){var a=this._get_Consumer(e);if(a){var b=this._indexOfConsumerWell(a,c);if(b>=0){var d=a.rgRecipientWells.splice(b,1)[0];d.dispose();return true}}return false};a.get_RecipientWell=function Owa$Components$RecipientWellManager$get_RecipientWell(d,c){var a=this._get_Consumer(d);if(a){var b=this._indexOfConsumerWell(a,c);if(b>=0)return a.rgRecipientWells[b]}return null};a.get_RecipientWells=function Owa$Components$RecipientWellManager$get_RecipientWells(b){var a=this._get_Consumer(b);return a?a.rgRecipientWells:[]};a.cloneRecipientWell=function Owa$Components$RecipientWellManager$cloneRecipientWell(b,a){var c=this._get_Consumer(b);return c?a.clone():null};a.disposeWells=function Owa$Components$RecipientWellManager$disposeWells(e){var d=this._indexOfConsumer(e);if(d>=0){for(var a=this._rgConsumers.splice(d,1)[0],c=a.rgRecipientWells,b=0;b<c.length;b++)c[b].dispose();a.rgRecipientWells=null;a=null}};a.set_AreWellsEnabled=function Owa$Components$RecipientWellManager$set_AreWellsEnabled(f,e){var a=this._get_Consumer(f);if(a){for(var c=a.rgRecipientWells,b=0;b<c.length;b++){var d=c[b];!d.get_IsReadOnly()&&d.set_IsEnabled(e)}a.fIsEnabled=e}};a.set_AreWellsReadOnly=function Owa$Components$RecipientWellManager$set_AreWellsReadOnly(e,f){var c=this._get_Consumer(e);if(c)for(var b=c.rgRecipientWells,a=0;a<b.length;a++){var d=b[a];d.set_IsReadOnly(f,false)}};a.get_AreWellsEnabled=function Owa$Components$RecipientWellManager$get_IsEnabled(b){var a=this._get_Consumer(b);return a?a.fIsEnabled:false};a.get_AllRecipientsByState=function Owa$Components$RecipientWellManager$get_AllRecipientsByState(i,b){if(!b)b=Owa.RecipientState.All;var g=this._get_Consumer(i),a=[];if(g)for(var f=g.rgRecipientWells,d=0;d<f.length;d++){var c=f[d],h=c.get_RecipientType()==Owa.RecipientType.From;if(Owa.UIControls.EditRecipientWell.isInstance(c)&&!h){var e=c.get_Recipients(b);if(e.length)a=a.concat(e)}}return a};a.get_AllResolvedRecipientSpans=function Owa$Components$RecipientWellManager$get_AllResolvedRecipientSpans(h){var f=this._get_Consumer(h),a=[];if(f)for(var e=f.rgRecipientWells,c=0;c<e.length;c++){var b=e[c],g=b.get_RecipientType()==Owa.RecipientType.From;if(Owa.UIControls.EditRecipientWell.isInstance(b)&&!g){var d=b.get_ResolvedRecipientSpans();if(d.length)a=a.concat(d)}}return a};a.validateMaxRecipients=function Owa$Components$RecipientWellManager$validateMaxRecipients(g,h){var d=this._get_Consumer(g),e=0;if(d)for(var c=d.rgRecipientWells,b=0;b<c.length;b++){var a=c[b],f=a.get_RecipientType()==Owa.RecipientType.From;if(Owa.UIControls.EditRecipientWell.isInstance(a)&&!f)e+=a.countRecipients()}return checkMaxRecipients(e,h)};a.loadAllRecipientData=function Owa$Components$RecipientWellManager$loadAllRecipientData(e,d){var a=this._get_Consumer(e);if(a){a.iCountPending=0;a.iCountResolved=0;a.iCountAmbiguous=0;a.iTotalRecipients=0;this._resetAllRecipientData(a);if(d)this._loadRecipientData(a,d);else for(var c=a.rgRecipientWells,b=0;b<c.length;b++)this._loadRecipientData(a,c[b])}};a._resetAllRecipientData=function Owa$Components$RecipientWellManager$_resetAllRecipientData(c){for(var b=c.rgRecipientWells,a=0;a<b.length;a++)b[a]._resetRecipientData()};a._loadRecipientData=function Owa$Components$RecipientWellManager$_loadRecipientData(a,b){var c=b.get_RecipientType()==Owa.RecipientType.From;b._loadRecipientData();a.iCountPending+=b._rgPendingRecipients.length;a.iCountResolved+=b._rgResolvedRecipients.length;a.iCountAmbiguous+=b._rgAmbiguousRecipients.length;if(!c)a.iTotalRecipients=a.iCountPending+a.iCountResolved+a.iCountAmbiguous};a.resolveWells=function Owa$Components$RecipientWellManager$resolveWells(b,f,g,e){var c=this._get_Consumer(b);if(c==null)return;var a={};a.oConsumer=c;a.fnConsumerCallback=f;a.fDoANR=!g;a.oRecipientWell=e;if(!this.get_AreWellsEnabled(b)){this._fireOnResolveComplete([RESOLVE_IN_PROGRESS,a]);return}this.set_AreWellsEnabled(b,false);if(!this.validateMaxRecipients(b)){this.set_AreWellsEnabled(true);this._fireOnResolveComplete([RESOLVE_MAX_RECIPIENTS,a]);return}this.loadAllRecipientData(b,e);if(!c.iTotalRecipients&&!c.iCountPending){this.set_AreWellsEnabled(true);this._fireOnResolveComplete([RESOLVE_NO_RECIPIENTS,a]);return}if(!c.iCountPending){this._handleAmbiguous(c,a);return}var d=new oeReq("RecipWell","Resolve",a,this._createCallback(this._cbResolveNames));d.set_ProcessXhrStatusZeroAsError();this._addAllPendingRecipientsToRequest(c,d);this.addCacheOehData(b,d);this.addAnrOptions(b,d);shwPrgrsInd(L_Ld);d.send()};a.addCacheOehData=function Owa$Components$RecipientWellManager$addCacheOehData(h,e){var a=[],d=this._get_Consumer(h);if(d!=null)for(var c=d.rgRecipientWells,b=0;b<c.length;b++){var g=c[b],f=g._addCacheOehData(e);if(f.length)a=a.concat(f)}a.length&&e.addRgSt("Recips",a)};a.addAnrOptions=function Owa$Components$RecipientWellManager$addAnrOptions(b,c){var a=this._get_Consumer(b);if(!a||!a.oAnrOptions)return;Owa.Components.RecipientWellManager.addAnrOptionsToRequest(a.oAnrOptions,c)};Owa.Components.RecipientWellManager.addAnrOptionsToRequest=function Owa$Components$RecipientWellManager$addAnrOptionsToRequest(a,b){a.fResolveOnlyFromAddressBook&&b.add("AB",1);a.fResolveAgainstAllContacts&&b.add("FSoneAnr",1);a.sDefaultRoutingType&&b.add("DefaultRT",a.sDefaultRoutingType);a.fOnlyAllowDefaultRoutingType&&b.add("OnlyDefaultRT",1);a.iRecipientBlockType&&b.add("RBT",a.iRecipientBlockType)};a.replaceAllPendingNodes=function Owa$Components$RecipientWellManager$replaceAllPendingNodes(e,d){var b=this._get_Consumer(e);if(b)for(var c=0;c<b.rgRecipientWells.length;c++){var a=b.rgRecipientWells[c];if(a._rgPendingRecipients.length){var f=a.get_WellTypeName();a._replacePendingNodes(d.getDescendantById(f))}}};a.addRecipientOehData=function Owa$Components$RecipientWellManager$addRecipientOehData(d,e){var b=this._get_Consumer(d);if(b)for(var c=0;c<b.rgRecipientWells.length;c++){var a=b.rgRecipientWells[c];if(a.get_RecipientType()==Owa.RecipientType.From&&(a.get_IgnoreFromData()||this._isFromWellPrimaryRecipient(a)))continue;a._addAllRecipientsToRequest(e)}};a._cbResolveNames=function Owa$Components$RecipientWellManager$_cbResolveNames(b){var c=b.oCtx,a=c.oConsumer;hdPrgrsInd();if(!cbOeh(b)){this.set_AreWellsEnabled(a.sId,true);this._fireOnResolveComplete([RESOLVE_REQUEST_ERROR,c]);return}var d=Owa.Dom.Document.get_Current().createElement("DIV");d.set_InnerHtml(b.sBody);this.replaceAllPendingNodes(a.sId,d);this.loadAllRecipientData(a.sId);this._handleAmbiguous(a,c)};a._handleAmbiguous=function Owa$Components$RecipientWellManager$_handleAmbiguous(d,a){var b;if(a.oRecipientWell)b=a.oRecipientWell._rgAmbiguousRecipients.length;else b=d.iCountAmbiguous;if(b&&a.fDoANR)this._beginAnrForResolve(a);else{var c=b?RESOLVE_UNRESOLVED_RECIPIENTS:RESOLVE_COMPLETE;this._fireOnResolveComplete([c,a])}};a._beginAnrForResolve=function Owa$Components$RecipientWellManager$_beginAnrForResolve(a){if(g_AnrPnd||isAnrMenuOpen())return;var d=a.oConsumer,b=[];if(!a.oRecipientWell)for(var c=0;c<d.rgRecipientWells.length;c++){var e=d.rgRecipientWells[c];this._addAmbiguousRecipientWell(b,e)}else this._addAmbiguousRecipientWell(b,a.oRecipientWell);a.rgAmbiguousWells=b;a.fnCb=this._createCallback(this._fireOnResolveComplete,[RESOLVE_COMPLETE,a]);shwAnrMnuForResolveNames(a)};a._addAmbiguousRecipientWell=function Owa$Components$RecipientWellManager$_addAmbiguousRecipientWell(c,a){if(a._rgAmbiguousRecipients.length){c.push(a);var b=a.get_RecipientType();b==Owa.RecipientType.Bcc&&shwBcc(1);b==Owa.RecipientType.From&&shwFrom(1)}};a._fireOnResolveComplete=function Owa$Components$RecipientWellManager$_fireOnResolveComplete(d){var a=d[0],e=d[1],b=e.oConsumer,c=e.fnConsumerCallback;if(c){if(a!=RESOLVE_ANR_CANCEL&&a!=RESOLVE_COMPLETE){this.loadAllRecipientData(b.sId);if(b.iTotalRecipients==0)a=RESOLVE_NO_RECIPIENTS;if(b.iCountPending||b.iCountAmbiguous)a=RESOLVE_UNRESOLVED_RECIPIENTS}c(a)}this.set_AreWellsEnabled(b.sId,true)};a._addAllPendingRecipientsToRequest=function Owa$Components$RecipientWellManager$_addAllPendingRecipientsToRequest(a,d){if(a.iCountPending)for(var b=0;b<a.rgRecipientWells.length;b++){var c=a.rgRecipientWells[b];c._rgPendingRecipients.length&&c._addPendingRecipientsToRequest(d)}};a._isFromWellPrimaryRecipient=function Owa$Components$RecipientWellManager$_isFromWellPrimaryRecipient(a){return a.get_RecipientType()==Owa.RecipientType.From&&a._rgResolvedRecipients.length&&isDf(typeof g_primaryRecipient)&&a._rgResolvedRecipients[0].getAttribute("_em").toLowerCase()==g_primaryRecipient._em.toLowerCase()};Owa.Components._RecipientWellConsumer=function Owa$Components$_RecipientWellConsumer(c,a,b){this.sId=c;this.rgRecipientWells=a;this.oAnrOptions=b;this.fIsEnabled=true};a._addConsumer=function Owa$Components$RecipientWellManager$_addConsumer(a){this._rgConsumers.push(a);for(var b=0;b<a.rgRecipientWells.length;b++){var c=a.rgRecipientWells[b];c.sConsumerId=a.sId}};a._get_Consumer=function Owa$Components$RecipientWellManager$_get_Consumer(c){var a=null,b=this._indexOfConsumer(c);if(b>=0)a=this._rgConsumers[b];return a};a._indexOfConsumer=function Owa$Components$RecipientWellManager$_indexOfConsumer(b){for(var a=0;a<this._rgConsumers.length;++a)if(b==this._rgConsumers[a].sId)return a;return-1};a._indexOfConsumerWell=function Owa$Components$RecipientWellManager$_indexOfConsumerWell(b,c){for(var a=0;a<b.rgRecipientWells.length;++a){var d=b.rgRecipientWells[a];if(d.isEqual(c))return a}return-1};Owa.Components.RecipientWellManager.createClass("Owa.Components.RecipientWellManager",Owa.Components.Control)})();g_fModuleLoaded[".\\components/recipientwellmanager.js".toLowerCase()]=1;var FT_GAL=[0,1],FT_CAL=[0,2],FT_CTS=[0,4],FT_ORG=[0,128],FT_NOTIF=[0,256],FT_SIG=[0,8192],FT_THM=[0,32768],FT_DUMPSTER=[0,33554432],FT_OWALIGHT=[0,536870912],FT_DLGACC=[0,1073741824],BUCKET=0,FLAG=1;function isSpC(){return isDf(typeof a_fSp)&&Owa.Utility.isIE()&&!Owa.Utility.isGreaterThanIE9UsingTrident()&&Owa.Utility.isWin()}function isFtEnab(a){return a_rgSeg[a[BUCKET]]&a[FLAG]}var iMAX_IE_STYLE_SHEETS=31,iSTYLE_SHEETS_IN_THEME=3,g_sRsrcUrl="../resources/";function getThmF(b){var a=isDf(typeof a_sCDN)?a_sCDN:"";return a_sThmUrl?a+a_sThmUrl+b:""}function getRsrcF(b){var a=isDf(typeof a_sCDN)?a_sCDN:"";return a_sThmUrl?a+a_sThmUrl+g_sRsrcUrl+b:""}function updateTheme(g,l,c){Owa.Dom.Window.get_Current().setGlobalVariable("a_sThmUrl",g);var k=getThmF("premium.css"),j=getThmF("csssprites.css"),i=getThmF("csssprites2.css"),e=0;if(!!c)e=1;var a=Owa.Dom.Document.get_Current();Owa.Utility.isIE()&&a.get_StyleSheetCount()+iSTYLE_SHEETS_IN_THEME+(e?1:0)>iMAX_IE_STYLE_SHEETS&&Owa.Dom.Window.get_Current().invokeFunction("cleanThemeStyleSheets",[g,c]);a.importStyleSheet(k);a.importStyleSheet(j);a.importStyleSheet(i);e&&a.importStyleSheet(c);for(var d=a.get_DocumentElement().getDescendantsByTagName("iframe"),h,f,b=0;b<d.length;b++){f=d[b].get_Id();if(d[b].hasCssClass("mainView")||f=="ifRP"||f=="ifCalRP"){h=d[b].get_ContentWindow();h.invokeFunction("updateTheme",[g,l,c])}}updCmp(window)}function cleanThemeStyleSheets(j,h){if(j==Owa.Dom.Window.get_Current().getGlobalVariable("a_sThmUrl")){var m=getThmF("premium.css"),l=getThmF("csssprites.css"),k=getThmF("csssprites2.css"),i=0;if(!!h)i=1;for(var f,a,d=Owa.Dom.Document.get_Current(),e=d.get_StyleSheetCount()-1;e>=0;e--){f=d.getStyleSheetAt(e);a=f.get_OwnerNode().getAttribute("href");a!=null&&a!=m&&a!=l&&a!=k&&a.search(/resources/i)==-1&&(i?a!=h:1)&&f.remove()}for(var c=d.get_DocumentElement().getDescendantsByTagName("iframe"),g,b=0;b<c.length;b++)if(c[b].hasCssClass("mainView")||c[b].get_Id()=="ifRP"||c[b].get_Id()=="ifCalRP"){g=c[b].get_ContentWindow();g.invokeFunction("cleanThemeStyleSheets",[j])}}}function getDropShadowMarkup(){var a='<div class="dropshadow dropshadow-bottom"></div>';if(!Owa.Dom.Document.get_Current().get_IsRtl()){a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-top-right.png",null,"dropshadow dropshadow-top-right");a+='<div class="dropshadow dropshadow-right"/></div>';a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-corner-bottom-right.png",null,"dropshadow dropshadow-corner-bottom-right");a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-bottom-left.png",null,"dropshadow dropshadow-bottom-left")}else{a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-top-left.png",null,"dropshadow dropshadow-top-left");a+='<div class="dropshadow dropshadow-left"></div>';a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-corner-bottom-left.png",null,"dropshadow dropshadow-corner-bottom-left");a+=Owa.Components.CssSprites.getImageMarkup("dropshadow-bottom-right.png",null,"dropshadow dropshadow-bottom-right")}return a}var g_winMgr=new WinMgr;function WinMgr(){this.rgoWinTbl={}}WinMgr.prototype.AddWin=function WinMgr$AddWin(b){if(!b)return;var a;while(1){a=rndm();if(!this.rgoWinTbl[a])break}b.sHash=a;this.rgoWinTbl[a]=b};WinMgr.prototype.RmWin=function WinMgr$RmWin(a){this.rgoWinTbl[a]=0};WinMgr.prototype.PushPrsnc=function WinMgr$PushPrsnc(b){var a;for(var c in this.rgoWinTbl){a=this.rgoWinTbl[c];try{a&&a.pushPrsnc&&a.pushPrsnc(b)}catch(d){}}};WinMgr.prototype.SetMapiDrty=function WinMgr$SetMapiDrty(c,d){var a;for(var b in this.rgoWinTbl){a=this.rgoWinTbl[b];try{a&&a.stMapiDrtyInternal&&!isDf(typeof a.a_isMstr)&&a.stMapiDrtyInternal(c,d)}catch(e){}}};WinMgr.prototype.Disp=function WinMgr$Disp(){delete this.rgoWinTbl};WinMgr.prototype.GetActiveWindow=function WinMgr$GetActiveWindow(){var a;for(var b in this.rgoWinTbl){a=this.rgoWinTbl[b];try{if(!a.closed&&a._fIsWinFocused)return a}catch(c){continue}}return null};var JNKDLG_W=400,g_fJnkRq=0;function shwNtJnkDlg(d,g,e,c){if(g_fJnkRq)return;var a={};a.iActn=ACTN_NTJNK;a.sId=g;a.fCls=!e;a.sSEm=c;a.oCallerSubPage=d;if(c==null||c=="")mvItm(a);else{var b=wtda("dvNtJnkDlg");b&&rn(b);var f="<table cellpadding=0 cellspacing=0 class=w100><tr><td colspan=2>"+L_NtJnkActn+"</td></tr><tr><td class=ntJnkChk><input id=chkNtJnk type=checkbox checked></td><td class=ntJnkChkLbl>"+L_NtJnkChk+" "+htmlEnc(c)+"</td></tr></table>";b=new BtnDlg("dvNtJnkDlg",f,L_MrkNtJnk,[L_OK,L_Cncl],null,Owa.BUTTON_DIALOG_ICON.INFORMATION,onClsNtJnkDlg,null,0,1,null,null,a);b.show()}}function onClsNtJnkDlg(d,a){if(d==0){var b=wtda("dvNtJnkDlg");if(b&&getOneDescendant(b,"chkNtJnk").checked){var c=a.oCallerSubPage;addToJnkLst(c,SSL,a.sSEm,0,L_MrkNtJnk,a.fCls,a.sId,a.iActn)}else mvItm(a)}}function addToJnkLst(d,i,b,g,h,f,j,e){if(!isJnkEnbl()||g_fJnkRq)return;var a={};a.sTtl=h;a.fCls=f;a.sId=j;a.iActn=e;a.oCallerSubPage=d;if(b==null||b=="")shwAddToJnkLstOkDlg(L_NoVldSndrRcp,1,a);else{if(g)b=b.substr(b.indexOf("@"),b.length-1);var c=new oeReq("JunkEmail","Add",a,cbAddToJnkLst);c.add("iLT",i);c.add("sNE",b);c.add("fFrmOpt",0);c.send();g_fJnkRq=1}}function addSndToJnkLst(d,g,c,e,f){if(!isJnkEnbl()||g_fJnkRq)return;var a={};a.sTtl=f;a.fCls=0;a.sId=c;a.oCallerSubPage=d;var b=new oeReq("JunkEmail","AddSender",a,cbAddToJnkLst);b.add("iLT",g);b.add("sId",c);b.add("fDmn",e);b.send();g_fJnkRq=1}function cbAddToJnkLst(a){g_fJnkRq=0;if(a.sErr){a.fST&&popLgn();shwErrDlg(a)}else{var b=Owa.Dom.Document.get_Current().createElement("DIV");b.set_InnerHtml(a.sBody);var d=b.getDescendantById("sMsg").get_TextContent(),c=b.getDescendantById("fErr")!=null;shwAddToJnkLstOkDlg(d,c,a.oCtx)}}function shwAddToJnkLstOkDlg(d,b,c){var a=wda("dvAddJnkLstDlg");a&&rn(a);a=new BtnDlg("dvAddJnkLstDlg",htmlEnc(d),c.sTtl,new Array(L_OK),JNKDLG_W,b?Owa.BUTTON_DIALOG_ICON.ERROR:Owa.BUTTON_DIALOG_ICON.INFORMATION,b?null:onClsAddToJnkLstOkDlg,null,null,null,null,null,c);a.show()}function onClsAddToJnkLstOkDlg(c,a){if(c==-1||!a)return;var b=a.iActn;(b==ACTN_NTJNK||b==ACTN_ADDBSL)&&mvItm(a)}!g_fModuleLoaded[".\\Ews/SoapElementBase.js".toLowerCase()]&&(function(){Type.createNamespace("Ews");Type.createNamespace("Ews.Xml");Ews.Xml.NamespaceURIs={Soap:"http://schemas.xmlsoap.org/soap/envelope/",Message:"http://schemas.microsoft.com/exchange/services/2006/messages",Type:"http://schemas.microsoft.com/exchange/services/2006/types"};var a={};Type.prototype.createXmlClass=function Type$createXmlClass(d,c,b){if(this.XmlName&&this.NamespaceUri){if(!a[this.XmlName])a[this.XmlName]={};a[this.XmlName][this.NamespaceUri]=this}this.createClass(d,c,b)};Ews.SoapElementBase=function Ews$SoapElementBase(){};Ews.SoapElementBase.ReadXmlNode=function Ews$SoapElementBase$ReadXmlNode(b){var c=b.get_LocalName(),d=b.get_NamespaceURI();if(a[c]&&a[c][d]){var e=new a[c][d](b);e.Load(b);return e}else return null};Ews.SoapElementBase.prototype.Load=function Ews$SoapElementBase$prototype$Load(b){var a=[];b.forEachChild(function(b){if(b.get_NodeType()==Owa.NodeType.Element){var c=Ews.SoapElementBase.ReadXmlNode(b);c&&a.push(c)}},null);this._LoadInternal(b,a)};Ews.SoapElementBase.prototype.Serialize=function Ews$SoapElementBase$prototype$Serialize(c){var a=Type.getInstanceType(this),b=c.createElementNS(a.XmlName,a.NamespaceUri);this._SerializeInternal(b);return b};Ews.SoapEnvelope=function Ews$SoapEnvelope(){Ews.SoapEnvelope._setupBase();this._oHeader=null;this._oBody=null};Ews.SoapEnvelope.XmlName="Envelope";Ews.SoapEnvelope.NamespaceUri=Ews.Xml.NamespaceURIs.Soap;Ews.SoapEnvelope.prototype._LoadInternal=function Ews$SoapEnvelope$prototype$_LoadInternal(d,c){for(var b=0;b<c.length;++b){var a=c[b];if(Ews.SoapHeader.isInstance(a))this._oHeader=a;else if(Ews.SoapBody.isInstance(a))this._oBody=a;else throw new Error("Bad Data, in SoapEnvelop, we only accept Header and Body in envelope");}};Ews.SoapEnvelope.prototype._SerializeInternal=function(a){this._oHeader&&a.appendChild(this._oHeader.Serialize(a.get_OwnerDocument()));a.appendChild(this._oBody.Serialize(a.get_OwnerDocument()))};Ews.SoapEnvelope.prototype.get_Header=function Ews$SoapEnvelop$prototype$get_Header(){return this._oHeader};Ews.SoapEnvelope.prototype.set_Header=function Ews$SoapEnvelop$prototype$set_Header(a){this._oHeader=a};Ews.SoapEnvelope.prototype.get_Body=function Ews$SoapEnvelop$prototype$get_Body(){return this._oBody};Ews.SoapEnvelope.prototype.set_Body=function Ews$SoapEnvelop$prototype$set_Body(a){this._oBody=a};Ews.SoapEnvelope.createXmlClass("Ews.SoapEnvelop",Ews.SoapElementBase);Ews.SoapHeader=function Ews$SoapHeader(){Ews.SoapHeader._setupBase();this._rgHeaders=[]};Ews.SoapHeader.XmlName="Header";Ews.SoapHeader.NamespaceUri=Ews.Xml.NamespaceURIs.Soap;Ews.SoapHeader.prototype._LoadInternal=function Ews$SoapHeader$prototype$_LoadInternal(d,b){for(var a=0;a<b.length;++a){var c=b[a];c!=null&&this._rgHeaders.push(c)}};Ews.SoapHeader.prototype._SerializeInternal=function(b){for(var a=0;a<this._rgHeaders.length;++a)b.appendChild(this._rgHeaders[a].Serialize(b.get_OwnerDocument()))};Ews.SoapHeader.prototype.get_Headers=function Ews$SoapHeader$prototype$get_Headers(){return this._rgHeaders};Ews.SoapHeader.createXmlClass("Ews.SoapHeader",Ews.SoapElementBase);Ews.SoapBody=function Ews$SoapBody(){Ews.SoapBody._setupBase();this._oChildElement=null};Ews.SoapBody.XmlName="Body";Ews.SoapBody.NamespaceUri=Ews.Xml.NamespaceURIs.Soap;Ews.SoapBody.prototype._LoadInternal=function Ews$SoapBody$prototype$_LoadInternal(c,a){if(a.length>1||a.length==0)throw new Error("SoapBody: Bad Data");var b=a[0];if(b==null)throw new Error("SoapBody: unsupported Soap");this._oChildElement=b};Ews.SoapBody.prototype._SerializeInternal=function(a){a.appendChild(this._oChildElement.Serialize(a.get_OwnerDocument()))};Ews.SoapBody.prototype.get_ChildElement=function Ews$SoapBody$prototype$get_ChildElement(){return this._oChildElement};Ews.SoapBody.prototype.set_ChildElement=function Ews$SoapBody$prototype$set_ChildElement(a){if(this._oChildElement)throw new Error("SoapBody: childElement already initialized");this._oChildElement=a};Ews.SoapBody.createXmlClass("Ews.SoapBody",Ews.SoapElementBase);Ews.SimpleStringSoapElement=function Ews$SimpleStringSoapElement(a){Ews.SimpleStringSoapElement._setupBase();this._sValue=a};Ews.SimpleStringSoapElement.prototype._LoadInternal=function Ews$SimpleStringSoapElement$prototype$_LoadInternal(a){this._sValue=a.get_TextContent()};Ews.SimpleStringSoapElement.prototype._SerializeInternal=function Ews$SimpleStringSoapElement$prototype$_SerializeInternal(a){a.set_TextContent(this._sValue)};Ews.SimpleStringSoapElement.prototype.get_Value=function Ews$SimpleStringSoapElement$prototype$get_Value(){return this._sValue};Ews.SimpleStringSoapElement.prototype.set_Value=function Ews$SimpleStringSoapElement$prototype$set_Value(a){this._sValue=a};Ews.SimpleStringSoapElement.createXmlClass("Ews.SimpleStringSoapElement",Ews.SoapElementBase);Ews.SimpleBooleanSoapElement=function Ews$SimpleBooleanSoapElement(a){Ews.SimpleBooleanSoapElement._setupBase();this._fValue=a};Ews.SimpleBooleanSoapElement.prototype._LoadInternal=function Ews$SimpleBooleanSoapElement$prototype$_LoadInternal(a){this._fValue=a.get_TextContent()=="true"};Ews.SimpleBooleanSoapElement.prototype._SerializeInternal=function Ews$SimpleBooleanSoapElement$prototype$_SerializeInternal(a){a.set_TextContent(""+this._fValue)};Ews.SimpleBooleanSoapElement.prototype.get_Value=function Ews$SimpleBooleanSoapElement$prototype$get_Value(){return this._fValue};Ews.SimpleBooleanSoapElement.prototype.set_Value=function Ews$SimpleBooleanSoapElement$prototype$set_Value(a){this._fValue=!!a};Ews.SimpleBooleanSoapElement.createXmlClass("Ews.SimpleBooleanSoapElement",Ews.SoapElementBase);Ews.SimpleDateTimeSoapElement=function Ews$SimpleDateTimeSoapElement(a){Ews.SimpleDateTimeSoapElement._setupBase();this._oValue=a};Ews.SimpleDateTimeSoapElement.prototype._LoadInternal=function Ews$SimpleDateTimeSoapElement$prototype$_LoadInternal(a){this._oValue=Date.parseISOString(a.get_TextContent())};Ews.SimpleDateTimeSoapElement.prototype._SerializeInternal=function Ews$SimpleDateTimeSoapElement$prototype$_SerializeInternal(a){a.set_TextContent(this._oValue.toIsoString()+"Z")};Ews.SimpleDateTimeSoapElement.prototype.get_Value=function Ews$SimpleDateTimeSoapElement$prototype$get_Value(){return this._oValue};Ews.SimpleDateTimeSoapElement.prototype.set_Value=function Ews$SimpleDateTimeSoapElement$prototype$set_Value(){this._oValue=oValue};Ews.SimpleDateTimeSoapElement.createXmlClass("Ews.SimpleDateTimeSoapElement",Ews.SoapElementBase);Ews.SingleChildSoapElement=function Ews$SingleChildSoapElement(a,b){Ews.SingleChildSoapElement._setupBase();this._oChildInstanceType=a;this._oValue=b};Ews.SingleChildSoapElement.prototype._LoadInternal=function Ews$SingleChildSoapElement$prototype$_LoadInternal(b,a){this._oValue=a[0]};Ews.SingleChildSoapElement.prototype._SerializeInternal=function Ews$SingleChildSoapElement$prototype$_SerializeInternal(a){a.appendChild(this._oValue.Serialize(a.get_OwnerDocument()))};Ews.SingleChildSoapElement.prototype.get_Value=function Ews$SingleChildSoapElement$prototype$get_Value(){return this._oValue};Ews.SingleChildSoapElement.prototype.set_Value=function Ews$SingleChildSoapElement$prototype$set_Value(a){this._oValue=a};Ews.SingleChildSoapElement.createXmlClass("Ews.SingleChildSoapElement",Ews.SoapElementBase);Ews.MultiChildrenSoapElement=function Ews$MultiChildrenSoapElement(a){Ews.MultiChildrenSoapElement._setupBase();this._oChildInstanceType=a;this._rgChildren=[]};Ews.MultiChildrenSoapElement.prototype._LoadInternal=function Ews$MultiChildrenSoapElement$prototype$_LoadInternal(c,b){for(var a=0;a<b.length;++a)this._rgChildren.push(b[a])};Ews.MultiChildrenSoapElement.prototype._SerializeInternal=function Ews$MultiChildrenSoapElement$prototype$_SerializeInternal(b){for(var a=0;a<this._rgChildren.length;++a)b.appendChild(this._rgChildren[a].Serialize(b.get_OwnerDocument()))};Ews.MultiChildrenSoapElement.prototype.get_Children=function Ews$MultiChildrenSoapElement$prototype$get_Children(){return this._rgChildren};Ews.MultiChildrenSoapElement.prototype.set_Children=function Ews$MultiChildrenSoapElement$prototype$set_Children(a){this._rgChildren=a};Ews.MultiChildrenSoapElement.createXmlClass("Ews.MultiChildrenSoapElement",Ews.SoapElementBase)})();g_fModuleLoaded[".\\Ews/SoapElementBase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/ItemId.js".toLowerCase()]&&(function(){Ews.IdBase=function Ews$IdBase(){Ews.IdBase._setupBase();this._sId=null;this._sChangeKey=null};Ews.IdBase.prototype._LoadInternal=function Ews$IdBase$prototype$_LoadInternal(a){this._sId=a.getAttribute("Id");this._sChangeKey=a.getAttribute("ChangeKey")};Ews.IdBase.prototype._SerializeInternal=function Ews$IdBase$prototype$_SerializeInternal(a){a.setAttribute("Id",this._sId);this._sChangeKey&&a.setAttribute("ChangeKey",this._sChangeKey)};Ews.IdBase.prototype.get_Id=function Ews$IdBase$prototype$get_Id(){return this._sId};Ews.IdBase.prototype.get_ChangeKey=function Ews$IdBase$prototype$get_ChangeKey(){return this._sChangeKey};Ews.IdBase.createXmlClass("Ews.IdBase",Ews.SoapElementBase);Ews.ItemId=function Ews$ItemId(){Ews.ItemId._setupBase();this._sId=null;this._sChangeKey=null};Ews.ItemId.XmlName="ItemId";Ews.ItemId.ItemType="item";Ews.ItemId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ItemId.createXmlClass("Ews.ItemId",Ews.IdBase);Ews.ConversationId=function Ews$ConversationId(){Ews.ConversationId._setupBase();this._sId=null;this._sChangeKey=null};Ews.ConversationId.XmlName="ConversationId";Ews.ConversationId.ItemType="item";Ews.ConversationId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationId.createXmlClass("Ews.ConversationId",Ews.IdBase);Ews.ItemIds=function Ews$ItemIds(){Ews.ItemIds._setupBase();Ews.ItemIds.constructBase(this,[Ews.ItemId])};Ews.ItemIds.XmlName="ItemIds";Ews.ItemIds.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ItemIds.prototype.get_ItemIds=function Ews$ItemIds$prototype$get_ItemIds(){return this.get_Children()};Ews.ItemIds.prototype.set_ItemIds=function Ews$ItemIds$prototype$set_ItemIds(a){this.set_Children(a)};Ews.ItemIds.createXmlClass("Ews.ItemIds",Ews.MultiChildrenSoapElement)})();g_fModuleLoaded[".\\Ews/ItemId.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/FolderId.js".toLowerCase()]&&(function(){Ews.FolderIdBase=function Ews$FolderIdBase(){Ews.FolderIdBase._setupBase();this._sId=null};Ews.FolderIdBase.prototype._LoadInternal=function Ews$FolderIdBase$prototype$_LoadInternal(a){this._sId=a.getAttribute("Id")};Ews.FolderIdBase.prototype._SerializeInternal=function Ews$FolderIdBase$prototype$_SerializeInternal(a){a.setAttribute("Id",this._sId)};Ews.FolderIdBase.prototype.get_Id=function Ews$FolderIdBase$prototype$get_Id(){return this._sId};Ews.FolderIdBase.createXmlClass("Ews.FolderIdBase",Ews.SoapElementBase);Ews.FolderId=function Ews$FolderId(){Ews.FolderId._setupBase();this._sChangeKey=null};Ews.FolderId.XmlName="FolderId";Ews.FolderId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.FolderId.prototype._LoadInternal=function Ews$FolderId$prototype$_LoadInternal(a){Ews.FolderId.callBase(this,"_LoadInternal",[a]);this._sChangeKey=a.getAttribute("ChangeKey")};Ews.FolderId.prototype._SerializeInternal=function Ews$FolderId$prototype$_SerializeInternal(a){Ews.FolderId.callBase(this,"_SerializeInternal",[a]);this._sChangeKey&&a.setAttribute("ChangeKey",this._sChangeKey)};Ews.FolderId.prototype.get_ChangeKey=function Ews$FolderId$prototype$get_ChangeKey(){return this._sChangeKey};Ews.FolderId.createXmlClass("Ews.FolderId",Ews.FolderIdBase);Ews.FolderIds=function Ews$FolderIds(){Ews.FolderIds._setupBase();Ews.FolderIds.constructBase(this,[Ews.FolderIdBase])};Ews.FolderIds.XmlName="FolderIds";Ews.FolderIds.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.FolderIds.prototype.get_FolderIds=function Ews$FolderIds$prototype$get_FolderIds(){return this.get_Children()};Ews.FolderIds.prototype.set_FolderIds=function Ews$FolderIds$prototype$set_FolderIds(a){this.set_Children(a)};Ews.FolderIds.createXmlClass("Ews.FolderIds",Ews.MultiChildrenSoapElement);Ews.ToFolderId=function Ews$ToFolderId(a){Ews.ToFolderId._setupBase();Ews.ToFolderId.constructBase(this,[Ews.FolderIdBase,a])};Ews.ToFolderId.XmlName="ToFolderId";Ews.ToFolderId.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ToFolderId.createXmlClass("Ews.ToFolderId",Ews.SingleChildSoapElement);Ews.DistinguishedFolderId=function Ews$DistinguishedFolderId(){Ews.DistinguishedFolderId._setupBase()};Ews.DistinguishedFolderId.prototype._LoadInternal=function Ews$DistinguishedFolderId$prototype$_LoadInternal(a){Ews.DistinguishedFolderId.callBase(this,"_LoadInternal",[a])};Ews.DistinguishedFolderId.prototype._SerializeInternal=function Ews$DistinguishedFolderId$prototype$_SerializeInternal(a){Ews.DistinguishedFolderId.callBase(this,"_SerializeInternal",[a])};Ews.DistinguishedFolderId.XmlName="DistinguishedFolderId";Ews.DistinguishedFolderId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.DistinguishedFolderId.createXmlClass("Ews.DistinguishedFolderId",Ews.FolderIdBase)})();g_fModuleLoaded[".\\Ews/FolderId.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/IdConverter.js".toLowerCase()]&&(function(){Type.createNamespace("Ews");Ews.IdStorageType={MailboxItemSmtpAddressBased:0,PublicFolder:1,PublicFolderItem:2,MailboxItemMailboxGuidBased:3,ConversationIdMailboxGuidBased:4};Ews.IdStorageTypeHash=[Ews.IdStorageType.MailboxItemSmtpAddressBased,Ews.IdStorageType.PublicFolder,Ews.IdStorageType.PublicFolderItem,Ews.IdStorageType.MailboxItemMailboxGuidBased,Ews.IdStorageType.ConversationIdMailboxGuidBased];Ews.GuidSeparator="/guid=";Ews.DummyStoreObjectId="AAA=";Ews.StoreObjectType={Unknown:0,OutlookSearchFolder:8,CalendarItemOccurrence:16};function RleDecompressor(a){for(var c=[],b=1;b<a.length;++b)if(b==a.length-1||a[i]!=a[i+1])c.push(a[b]);else{if(b==a.length-2)throw new Exception;for(var e=a[b+2],d=0;d<e+2;++d)c.push(a[b]);b+=2}return c}Ews.BaseId=function Ews$BaseId(){this._iMailboxType=Ews.IdStorageTypeHash[0];this._oMailboxIdentity=null;this._rgEntryId=null;this._iObjectType=null;this._rgChangeKey=null;this._oContainerId=null;this._sDistinguishedFolderId=null};Ews.BaseId.FromEwsId=function Ews$BaseId$FromEwsId(j){var l=j.get_Id(),f=j.get_ChangeKey(),b=Owa.Encoder.fromBase64String(l,0,l.length);if(!b)return null;var a=0;if(b[0]==1)b=RleDecompressor(b);else a=1;var h=b[a++],i=null,k=null;switch(h){case Ews.IdStorageType.MailboxItemMailboxGuidBased:case Ews.IdStorageType.ConversationIdMailboxGuidBased:var e=b[a]+(b[a+1]>>8);a+=2;i=b.slice(a,a+e);a+=e;if(b[a++])throw"Don't support recurrenceIds";e=b[a]+(b[a+1]>>8);a+=2;k=b.slice(a,e+a);break;default:throw"Not supported";}var c=null,g=0;if(f){c=Owa.Encoder.fromBase64String(f,0,f.length);g=c[0]+c[1]*256;if(c.length>8)c=c.slice(8,c.length);else c=null}else if(h==Ews.IdStorageType.ConversationIdMailboxGuidBased)g=-1;var d=new Ews.BaseId;d._iMailboxType=Ews.IdStorageTypeHash[h];d._oMailboxIdentity=i;d._rgEntryId=k;d._iObjectType=g;d._rgChangeKey=c;return d};Ews.BaseId.prototype._get_EwsIdPart=function Ews$BaseId$prototype$_get_EwsIdPart(){if(this._sEwsId)return this._sEwsId;var a=[];a.push(0);a.push(this._iMailboxType);switch(this._iMailboxType){case Ews.IdStorageType.MailboxItemMailboxGuidBased:case Ews.IdStorageType.ConversationIdMailboxGuidBased:a=this._appendByteArray(a,this._oMailboxIdentity);if(this._iObjectType==Ews.StoreObjectType.CalendarItemOccurrence)a.push(1);else a.push(0);a=this._appendByteArray(a,this._rgEntryId);break;case Ews.IdStorageType.PublicFolder:a=this._appendByteArray(a,this._rgEntryId);break;case Ews.IdStorageType.PublicFolderItem:a.push(0);a=this._appendByteArray(a,this._rgEntryId);a=this._appendByteArray(a,this._oContainerId._rgEntryId);break;default:throw"Not supported";}this._sEwsId=Owa.Encoder.toBase64String(a);return this._sEwsId};Ews.BaseId.prototype._appendByteArray=function Ews$BaseId$_appendByteArray(a,b){a.push(b.length&255);a.push(b.length>>8);a=a.concat(b);return a};Ews.BaseId.prototype._get_EwsChangeKey=function Ews$BaseId$prototype$_get_EwsChangeKey(){if(!this._sEwsChangeKey){var a=[];a.push(this._iObjectType&255);a.push(this._iObjectType>>8&255);a.push(0);a.push(0);if(this._rgChangeKey){a.push(this._rgChangeKey.length&255);a.push(this._rgChangeKey.length>>8&255);a.push(0);a.push(0);a=a.concat(this._rgChangeKey)}this._sEwsChangeKey=Owa.Encoder.toBase64String(a)}return this._sEwsChangeKey};Ews.BaseId.prototype.get_EwsId=function Ews$BaseId$prototype$get_EwsId(){if(this._oEwsId)return this._oEwsId;if(this._iObjectType==-1)this._oEwsId=new Ews.ConversationId;else if(this._sDistinguishedFolderId){this._oEwsId=new Ews.DistinguishedFolderId;this._oEwsId._sId=this._sDistinguishedFolderId;return this._oEwsId}else if(this._iObjectType<=Ews.StoreObjectType.OutlookSearchFolder&&this._iObjectType!=Ews.StoreObjectType.Unknown)this._oEwsId=new Ews.FolderId;else this._oEwsId=new Ews.ItemId;this._oEwsId._sId=this._get_EwsIdPart();this._oEwsId._sChangeKey=this._get_EwsChangeKey();this._oEwsId.fOtherMailbox=this._fOtherMailbox;this._oEwsId.fPublicFolder=this._fPublicFolder;return this._oEwsId};Ews.BaseId.prototype.get_EwsContainerId=function Ews$BaseId$prototype$get_EwsContainerId(){return this._oContainerId?this._oContainerId.get_EwsId():null};Ews.BaseId.IsOwaCnvId=function Ews$BaseId$IsOwaCnvId(a){if(a)return a.indexOf("CID.")==0||a.indexOf("ACI.")==0};Ews.BaseId.FromOwaId=function Ews$BaseId$FromOwaId(m,p,q,n){var a=q.split(Owa.Utility.OwaPrefixes.SeparatorChar),c=null,f=null,h=null,l=null,e=Ews.IdStorageType.MailboxItemMailboxGuidBased,j=false,k=false;switch(a[0]){case Owa.Utility.OwaPrefixes.PublicStoreItemPrefix:e=Ews.IdStorageType.PublicFolderItem;f=a[1];c=a[2];j=true;break;case Owa.Utility.OwaPrefixes.PublicStoreFolderPrefix:e=Ews.IdStorageType.PublicFolder;c=a[1];j=true;break;case Owa.Utility.OwaPrefixes.ConversationIdPrefix:e=Ews.IdStorageType.ConversationIdMailboxGuidBased;c=a[1];f=a[2];break;case Owa.Utility.OwaPrefixes.OtherUserMailboxObjectPrefix:k=true;case Owa.Utility.OwaPrefixes.ArchiveMailboxObjectPrefix:c=a[1];h=a[2];if(c==Ews.DummyStoreObjectId)l="archivemsgfolderroot";break;case Owa.Utility.OwaPrefixes.ArchiveConversationIdPrefix:e=Ews.IdStorageType.ConversationIdMailboxGuidBased;c=a[1];f=a[2];h=a[3];break;case Owa.Utility.OwaPrefixes.GSCalendarPrefix:throw"Not implemented";break;default:c=a[0]}var i=null;if(e==Ews.IdStorageType.ConversationIdMailboxGuidBased){var o=Owa.Encoder.fromBase64String(c);i={rgEntryId:o,iObjectType:-1}}else i=ParseStoreObjectId(c);var g=null;if(f)g=ParseStoreObjectId(f);if(h)m=ParseMailboxGuid(h,p);var b=new Ews.BaseId;b._iMailboxType=Ews.IdStorageTypeHash[e];b._oMailboxIdentity=m;b._rgEntryId=i.rgEntryId;b._iObjectType=i.iObjectType;b._sDistinguishedFolderId=l;b._fOtherMailbox=k;b._fPublicFolder=j;if(g){var d=new Ews.BaseId;d._iMailboxType=Ews.IdStorageTypeHash[Ews.IdStorageType.MailboxItemMailboxGuidBased];d._oMailboxIdentity=b._oMailboxIdentity;d._rgEntryId=g.rgEntryId;d._iObjectType=g.iObjectType;d._rgChangeKey=null;d._oContainerId=null;d._fOtherMailbox=k;d._fPublicFolder=j;b._oContainerId=d}if(n)b._rgChangeKey=Owa.Encoder.fromBase64String(n);return b};Ews.BaseId.ParseMailboxLegacyDN=function Ews$BaseId$ParseMailboxLegacyDN(b){var a=b.split(Owa.Utility.OwaPrefixes.SeparatorChar);switch(a[0]){case Owa.Utility.OwaPrefixes.OtherUserMailboxObjectPrefix:case Owa.Utility.OwaPrefixes.ArchiveMailboxObjectPrefix:return a[2];case Owa.Utility.OwaPrefixes.ArchiveConversationIdPrefix:return a[3];default:throw"Not implemented";return null}};function ParseStoreObjectId(e){var a=Owa.Encoder.fromBase64String(e),c=a[a.length-1],b;if(c==Ews.StoreObjectType.CalendarItemOccurrence)b=a;else{var d=a[0];b=a.slice(1,d+1)}return{rgEntryId:b,iObjectType:c}}function ParseMailboxGuid(b,d){var a=d[b];if(a)return a;var g=Owa.Encoder.fromBase64String(b),e=Owa.Utility.bytesToString(g),c=e.indexOf(Ews.GuidSeparator);if(c<0)throw"Legacy DN does not contain Guid";var f=e.slice(c+Ews.GuidSeparator.length);a=Owa.Utility.stringToBytes(f);d[b]=Owa.Utility.stringToBytes(f);return a}Ews.BaseId.prototype.get_MailboxType=function Ews$BaseId$prototype$get_MailboxType(){return this._iMailboxType};Ews.BaseId.prototype.get_MailboxIdentity=function Ews$BaseId$prototype$get_MailboxIdentity(){return this._oMailboxIdentity};Ews.BaseId.prototype.get_EntryId=function Ews$BaseId$prototype$get_EntryId(){return this._rgEntryId};Ews.BaseId.prototype.get_ObjectType=function Ews$BaseId$prototype$get_ObjectType(){return this._iObjectType};Ews.BaseId.prototype.get_DistinguishedFolderId=function Ews$BaseId$prototype$get_DistinguishedFolderId(){return this._sDistinguishedFolderId}})();g_fModuleLoaded[".\\Ews/IdConverter.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/RequestElements.js".toLowerCase()]&&(function(){Ews.RequestBase=function Ews$RequestBase(){Ews.RequestBase._setupBase();this._oDocument=null;this._sVersion=null};Ews.RequestBase.prototype.Execute=function Ews$RequestBase$prototype$Execute(c,e,a){this._oDocument=new Owa.Dom.XmlDocument;this._oDocument.appendChild(this._CreateSoapDomForRequest().Serialize(this._oDocument));var d=this._oDocument.get_Xml();function doubleCallbackSafeguard(a){if(a.get_Context()&&a.get_Context().fProcessed)throw new Error("callback called twice.");if(a.get_Context())a.get_Context().fProcessed=true;return e(a)}var b=c.get_AjaxRequest(Owa.Utility.createArgumentContextDelegate(this,this._ProcessResponse,[doubleCallbackSafeguard,a]),Owa.Utility.createArgumentContextDelegate(this,this._ProcessCancel,[doubleCallbackSafeguard,a]),Type.getInstanceType(this).XmlName,this._version);b.send(d)};Ews.RequestBase.prototype._set_RequestVersion=function Ews$RequestBase$prototype$set_RequestVersion(a){this._sVersion=a};Ews.RequestBase.prototype._CreateSoapDomForRequest=function Ews$RequestBase$prototype$_CreateSoapDomForRequest(){var a=new Ews.SoapEnvelope,b=new Ews.SoapBody;b.set_ChildElement(this);a.set_Body(b);return a};Ews.RequestBase.prototype._ProcessResponse=function Ews$RequestBase$prototype$_ProcessResponse(j,c,m){var f=j.oXmlHttp,g=f.status,e=null,a=null,b=null,o=f.getResponseHeader("X-OWA-EventResult");if(g==200){var k=new Owa.Dom.XmlDocument,d=f.responseText;if(o=="1"){var h=Owa.Dom.Document.get_Current().createElement("div");h.set_InnerHtml(d);var l=h.getDescendantById("err");a=l.getAttribute("_msg");b=l.getAttribute("_details");h.remove(true)}else if(!k.loadXML(d))a="Invalid Response from server:";else{var n=Ews.SoapElementBase.ReadXmlNode(k.get_DocumentElement());e=n.get_Body().get_ChildElement();e.set_Request(this)}if(a&&!b)b='Invalid Response XML: "'+d+'"\r\nRequest body: "'+this._oDocument.get_Xml()+'"'}else if(g==440)if(g_iLgn==1)popLgn();else g_iLgn==2&&rplLgn();else a=getHttpErr(g);if(c[0]){var i=new Ews.ResponseWrapper(e,j.sUrl,c[1],a,b,m),p=c[0](i);!p&&updCmp(window,i)}};Ews.RequestBase.prototype._ProcessCancel=function Ews$RequestBase$prototype$_ProcessCancel(b,a){this._ProcessResponse(b,a,true)};function getHttpErr(b){var a=null;switch(b){case 403:a=L_AcsDnd;break;case 12002:case 408:a=L_Tmout;break;case 400:case 500:a=L_IntErr;break;case 12029:case 12007:a=L_NmNtRslv;break;case 503:a=L_SvcUnv;break;case 581:a=L_ErrorCannotAuthenticateToEws;break;case 583:a=L_ErrorOwaForbiddenOnEws;break;case 584:a=L_ErrorCannotConnectToEws;break;case 593:a=L_ErrorEwsUnavailable;break;default:if(isDf(typeof L_HttpErr))a=L_HttpErr.format(b.toString());else a=b.toString()}return a}Ews.RequestBase.createXmlClass("ResponseCodeResponseCode",Ews.SoapElementBase);Ews.ResponseWrapper=function Ews$ResponseWrapper(d,f,e,c,a,b){Ews.ResponseWrapper._setupBase();this._sError=c;this._oResponse=d;this._sUrl=f;this._oContext=e;this._sErrorDetails=a;this._fSuppressErrors=!!b};Ews.ResponseWrapper.prototype.get_Response=function Ews$ResponseWrapper$prototype$get_Response(){if(this._sError!=null)throw this._sError;return this._oResponse};Ews.ResponseWrapper.prototype.get_Messages=function Ews$ResponseWrapper$prototype$get_Messages(){return this.get_Response().get_ResponseMessages().get_Messages()};Ews.ResponseWrapper.prototype.get_HttpError=function Ews$ResponseWrapper$prototype$get_HttpError(){return this._sError};Ews.ResponseWrapper.prototype.get_HttpErrorDetails=function Ews$ResponseWrapper$prototype$get_HttpErrorDetails(){return this._sError};Ews.ResponseWrapper.prototype.get_Context=function Ews$ResponseWrapper$prototype$get_Context(){return this._oContext};Ews.ResponseWrapper.prototype.get_Url=function Ews$ResponseWrapper$prototype$get_Url(){return this._sUrl};Ews.ResponseWrapper.prototype.CheckErrors=function Ews$ResponseWrapper$CheckErrors(a){return this.CheckHttpErrors(a)||this._oResponse.CheckResponseErrors(a)};Ews.ResponseWrapper.prototype.CheckHttpErrors=function Ews$ResponseWrapper$CheckHttpErrors(a){a=!!a||this._fSuppressErrors;if(this.get_HttpError()){!a&&shwErrDlg(null,this.get_HttpError(),null,null,this.get_HttpErrorDetails(),null,null,null,null);return true}return false};Ews.ResponseWrapper.createClass("Ews.ResponseWrapper")})();g_fModuleLoaded[".\\Ews/RequestElements.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/DeleteItemRequest.js".toLowerCase()]&&(function(){Ews.DeleteTypes={HardDelete:"HardDelete",SoftDelete:"SoftDelete",MoveToDeletedItems:"MoveToDeletedItems"};Ews.SendMeetingCancellations={SendToNone:"SendToNone",SendOnlyToAll:"SendOnlyToAll",SendToAllAndSaveCopy:"SendToAllAndSaveCopy"};Ews.AffectedTaskOccurrences={AllOccurrences:"AllOccurrences",SpecifiedOccurrenceOnly:"SpecifiedOccurrenceOnly"};Ews.DeleteItemRequest=function Ews$DeleteItemRequest(){Ews.DeleteItemRequest._setupBase();this._rgItemIds=null;this._sDeleteType=Ews.DeleteTypes.MoveToDeletedItems;this._sSendMeetingCancellations=null;this._sAffectedTaskOccurrences=null;this._set_RequestVersion(Ews.Ews2007_SP1)};Ews.DeleteItemRequest.XmlName="DeleteItem";Ews.DeleteItemRequest.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.DeleteItemRequest.prototype._LoadInternal=function Ews$DeleteItemRequest$prototype$_LoadInternal(c,b){for(var a=0;a<c.attributes.length;++a){var e=c.attributes[a].baseName,d=c.attributes[a].value;switch(e){case"DeleteType":this._sDeleteType=d;break;case"SendMeetingCancellations":this._sSendMeetingCancellations=d;break;case"AffectedTaskOccurrences":this._sAffectedTaskOccurrences=d}}if(b.length>1||b.length==0)throw"DeleteItems: Bad Data";this._rgItemIds=b[0].get_ItemIds()};Ews.DeleteItemRequest.prototype._SerializeInternal=function Ews$DeleteItemRequest$prototype$_SerializeInternal(a){this._sDeleteType&&a.setAttribute("DeleteType",this._sDeleteType);this._sSendMeetingCancellations&&a.setAttribute("SendMeetingCancellations",this._sSendMeetingCancellations);this._sAffectedTaskOccurrences&&a.setAttribute("AffectedTaskOccurrences",this._sAffectedTaskOccurrences);var b=new Ews.ItemIds;b.set_ItemIds(this._rgItemIds);a.appendChild(b.Serialize(a.get_OwnerDocument()))};Ews.DeleteItemRequest.prototype.get_DeleteType=function Ews$DeleteItemRequest$prototype$get_DeleteType(){return this._sDeleteType};Ews.DeleteItemRequest.prototype.set_DeleteType=function Ews$DeleteItemRequest$prototype$set_DeleteType(a){this._sDeleteType=a};Ews.DeleteItemRequest.prototype.get_SendMeetingCancellations=function Ews$DeleteItemRequest$prototype$get_SendMeetingCancellations(){return this._sSendMeetingCancellations};Ews.DeleteItemRequest.prototype.set_SendMeetingCancellations=function Ews$DeleteItemRequest$prototype$set_SendMeetingCancellations(a){this._sSendMeetingCancellations=a};Ews.DeleteItemRequest.prototype.get_AffectedTaskOccurrences=function Ews$DeleteItemRequest$prototype$get_AffectedTaskOccurrences(){return this._sAffectedTaskOccurrences};Ews.DeleteItemRequest.prototype.set_AffectedTaskOccurrences=function Ews$DeleteItemRequest$prototype$set_AffectedTaskOccurrences(a){this._sAffectedTaskOccurrences=a};Ews.DeleteItemRequest.prototype.get_ItemIds=function Ews$DeleteItemRequest$prototype$get_ItemIds(){return this._rgItemIds};Ews.DeleteItemRequest.prototype.set_ItemIds=function Ews$DeleteItemRequest$prototype$set_ItemIds(a){this._rgItemIds=a};Ews.DeleteItemRequest.createXmlClass("Ews.DeleteItemRequest",Ews.RequestBase)})();g_fModuleLoaded[".\\Ews/DeleteItemRequest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/ResponseElements.js".toLowerCase()]&&(function(){Ews.ResponseBase=function Ews$ResponseBase(){Ews.ResponseBase._setupBase();this._oResponseMessages=null};Ews.ResponseBase.prototype._LoadInternal=function Ews$ResponseBase$prototype$_LoadInternal(b,a){if(a.length>1||a.length==0)throw"ResponseBase: Bad Data";this._oResponseMessages=a[0]};Ews.ResponseBase.prototype._SerializeInternal=function Ews$ResponseBase$prototype$_SerializeInternal(a){a.appendChild(this._oResponseMessages.Serialize(a.get_OwnerDocument()))};Ews.ResponseBase.prototype.get_ResponseMessages=function Ews$ResponseBase$prototype$get_ResponseMessages(){return this._oResponseMessages};Ews.ResponseBase.prototype.set_Request=function Ews$ResponseBase$prototype$set_Request(a){this._oRequestElement=a};Ews.ResponseBase.prototype.CheckResponseErrors=function Ews$ResponseBase$CheckResponseErrors(h){for(var g=this.get_ResponseMessages(),c=g.get_Messages(),d="",e=false,a=null,b=0;b<c.get_Length();b++){var f=c[b].get_ResponseClass();if(f&&f!=Ews.ResponseClass.Success){switch(c[b].get_ResponseCode()){case"ErrorCannotDeleteObject":a=L_ErrDelItms;break;case"ErrorCannotEmptyFolder":a=L_ErrDelItms;break;case"ErrorItemNotFound":break;case"ErrorMoveCopyFailed":case"ErrorCrossMailboxMoveCopy":if(this.constructor.XmlName=="CopyItemResponse")if(this._oRequestElement.get_ItemIds()[b].fPublicFolder||this._oRequestElement.get_DestinationFolderId().fPublicFolder)a=L_ErrCpFailedPF;else if(this._oRequestElement.get_ItemIds()[b].fOtherMailbox||this._oRequestElement.get_DestinationFolderId().fOtherMailbox)a=L_ErrCpFailedOM;else a=L_ErrCpFailed;else if(this._oRequestElement.get_ItemIds()[b].fPublicFolder||this._oRequestElement.get_DestinationFolderId().fPublicFolder)a=L_ErrCpFailedPF;else if(this._oRequestElement.get_ItemIds()[b].fOtherMailbox||this._oRequestElement.get_DestinationFolderId().fOtherMailbox)a=L_ErrCpFailedOM;else a=L_ErrCpFailed;break;case"ErrorApplyConversationActionFailed":switch(this._oRequestElement.get_ConversationActions()[b].get_Action()){case Ews.ConversationActionTypeStrings.Delete:a=L_ErrDelItms;break;case Ews.ConversationActionTypeStrings.Move:a=L_ErrMvFailed;break;case Ews.ConversationActionTypeStrings.Copy:a=L_ErrCpFailed}break;default:d+=c[b].get_MessageText()+"<br/>";e=true}if(a){d+=c[b].get_MessageText()+"<br/>";e=true}}}if(e){!h&&shwErrDlg(null,a?a:L_IntErr,null,null,a?null:d,null,null,null,null);return true}return false};Ews.ResponseBase.createXmlClass("Ews.ResponseBase",Ews.SoapElementBase);Ews.ResponseMessages=function Ews$ResponseMessages(){Ews.ResponseMessages._setupBase();Ews.ResponseMessages.constructBase(this,[Ews.ResponseMessageBase])};Ews.ResponseMessages.XmlName="ResponseMessages";Ews.ResponseMessages.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ResponseMessages.prototype.get_Messages=function Ews$ResponseMessages$prototype$get_Messages(){return this.get_Children()};Ews.ResponseMessages.createXmlClass("Ews.ResponseMessages",Ews.MultiChildrenSoapElement);Ews.ResponseClass={Error:"Error",Success:"Success"};Ews.ResponseMessageBase=function Ews$ResponseMessageBase(a){Ews.ResponseMessageBase._setupBase();this._oResponseItemType=a;this._sResponseClass=null;this._oResponseCode=null;this._oDescriptiveLink=null;this._oMessageText=null;this._oResponseItem=null};Ews.ResponseMessageBase.prototype._LoadInternal=function Ews$ResponseMessageBase$prototype$_LoadInternal(d,c){this._sResponseClass=d.getAttribute("ResponseClass");for(var b=0;b<c.length;++b){var a=c[b];if(Ews.DescriptiveLink.isInstance(a))this._oDescriptiveLink=a;else if(Ews.ResponseMessageText.isInstance(a))this._oMessageText=a;else if(Ews.ResponseCode.isInstance(a))this._oResponseCode=a;else if(this._oResponseItemType&&this._oResponseItemType.isInstance(a))this._oResponseItem=a}};Ews.ResponseMessageBase.prototype._SerializeInternal=function Ews$ResponseMessageBase$prototype$_SerializeInternal(a){a.setAttribute("ResponseClass",this._sResponseClass);this._oMessageText&&a.appendChild(this._oMessageText.Serialize(a.get_OwnerDocument()));a.appendChild(this._oResponseCode.Serialize(a.get_OwnerDocument()));this._oDescriptiveLink&&a.appendChild(this._oDescriptiveLink.Serialize(a.get_OwnerDocument()));this._oResponseItem&&a.appendChild(this._oResponseItem.Serialize(a.get_OwnerDocument()))};Ews.ResponseMessageBase.prototype.get_ResponseClass=function Ews$ResponseMessageBase$prototype$get_ResponseClass(){return this._sResponseClass};Ews.ResponseMessageBase.prototype.get_ResponseCode=function Ews$ResponseMessageBase$prototype$get_ResponseCode(){return this._oResponseCode.get_Value()};Ews.ResponseMessageBase.prototype.get_MessageText=function Ews$ResponseMessageBase$prototype$get_MessageText(){return this._oMessageText?this._oMessageText.get_Value():null};Ews.ResponseMessageBase.prototype.get_DescriptiveLink=function Ews$ResponseMessageBase$prototype$get_DescriptiveLink(){return this._oDescriptiveLink?this._oDescriptiveLink.get_Value():null};Ews.ResponseMessageBase.prototype.get_ResponseItem=function Ews$ResponseMessageBase$prototype$get_ResponseItem(){return this._oResponseItem};Ews.ResponseMessageBase.createXmlClass("Ews.ResponseMessageBase",Ews.SoapElementBase);Ews.DescriptiveLink=function Ews$DescriptiveLink(){Ews.DescriptiveLink._setupBase();this._sValue=null};Ews.DescriptiveLink.XmlName="DescriptiveLinkKey";Ews.DescriptiveLink.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.DescriptiveLink.createXmlClass("Ews.DescriptiveLink",Ews.SimpleStringSoapElement);Ews.ResponseMessageText=function Ews$ResponseMessageText(){Ews.ResponseMessageText._setupBase();this._sValue=null};Ews.ResponseMessageText.XmlName="MessageText";Ews.ResponseMessageText.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ResponseMessageText.createXmlClass("Ews.ResponseMessageText",Ews.SimpleStringSoapElement);Ews.ResponseCode=function Ews$ResponseCode(){Ews.ResponseCode._setupBase();this._sValue=null};Ews.ResponseCode.XmlName="ResponseCode";Ews.ResponseCode.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ResponseCode.createXmlClass("Ews.ResponseCode",Ews.SimpleStringSoapElement)})();g_fModuleLoaded[".\\Ews/ResponseElements.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/DeleteItemResponse.js".toLowerCase()]&&(function(){Ews.DeleteItemResponse=function Ews$DeleteItemResponse(){Ews.DeleteItemResponse._setupBase()};Ews.DeleteItemResponse.XmlName="DeleteItemResponse";Ews.DeleteItemResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.DeleteItemResponse.createXmlClass("Ews.DeleteItemResponse",Ews.ResponseBase);Ews.DeleteItemResponseMessage=function Ews$DeleteItemResponseMessage(){Ews.DeleteItemResponseMessage._setupBase()};Ews.DeleteItemResponseMessage.XmlName="DeleteItemResponseMessage";Ews.DeleteItemResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.DeleteItemResponseMessage.createXmlClass("Ews.DeleteItemResponseMessage",Ews.ResponseMessageBase)})();g_fModuleLoaded[".\\Ews/DeleteItemResponse.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/MoveCopyRequest.js".toLowerCase()]&&(function(){Ews.MoveCopyRequestBase=function Ews$MoveCopyRequestBase(){Ews.MoveCopyRequestBase._setupBase();this._rgItemIds=null;this._oDestinationFolderId=null};Ews.MoveCopyRequestBase.prototype._LoadInternal=function Ews$MoveCopyRequestBase$prototype$_LoadInternal(b,a){if(a.length!=2)throw"MoveCopyRequestBase: Bad Data";this._oDestinationFolderId=a[0].get_FolderId();this._rgItemIds=a[1].get_ItemIds()};Ews.MoveCopyRequestBase.prototype._SerializeInternal=function Ews$MoveCopyRequestBase$prototype$_SerializeInternal(a){var c=new Ews.ToFolderId(this._oDestinationFolderId);a.appendChild(c.Serialize(a.get_OwnerDocument()));var b=new Ews.ItemIds;b.set_ItemIds(this._rgItemIds);a.appendChild(b.Serialize(a.get_OwnerDocument()))};Ews.MoveCopyRequestBase.prototype.get_DestinationFolderId=function Ews$MoveCopyRequestBase$prototype$get_DestinationFolderId(){return this._oDestinationFolderId};Ews.MoveCopyRequestBase.prototype.set_DestinationFolderId=function Ews$MoveCopyRequestBase$prototype$set_DestinationFolderId(a){this._oDestinationFolderId=a};Ews.MoveCopyRequestBase.prototype.get_ItemIds=function Ews$MoveCopyRequestBase$prototype$get_ItemIds(){return this._rgItemIds};Ews.MoveCopyRequestBase.prototype.set_ItemIds=function Ews$MoveCopyRequestBase$prototype$set_ItemIds(a){this._rgItemIds=a};Ews.MoveCopyRequestBase.createXmlClass("Ews.MoveCopyRequestBase",Ews.RequestBase);Ews.MoveItemRequest=function Ews$MoveItemRequest(){Ews.MoveItemRequest._setupBase()};Ews.MoveItemRequest.XmlName="MoveItem";Ews.MoveItemRequest.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.MoveItemRequest.createXmlClass("Ews.MoveItemRequest",Ews.MoveCopyRequestBase);Ews.CopyItemRequest=function Ews$CopyItemRequest(){Ews.CopyItemRequest._setupBase()};Ews.CopyItemRequest.XmlName="CopyItem";Ews.CopyItemRequest.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.CopyItemRequest.createXmlClass("Ews.CopyItemRequest",Ews.MoveCopyRequestBase)})();g_fModuleLoaded[".\\Ews/MoveCopyRequest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/MoveCopyResponse.js".toLowerCase()]&&(function(){Ews.MoveItemResponse=function Ews$MoveItemResponse(){Ews.MoveItemResponse._setupBase()};Ews.MoveItemResponse.XmlName="MoveItemResponse";Ews.MoveItemResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.MoveItemResponse.createXmlClass("Ews.MoveItemResponse",Ews.ResponseBase);Ews.MoveItemResponseMessage=function Ews$MoveItemResponseMessage(){Ews.MoveItemResponseMessage._setupBase()};Ews.MoveItemResponseMessage.XmlName="MoveItemResponseMessage";Ews.MoveItemResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.MoveItemResponseMessage.createXmlClass("Ews.MoveItemResponseMessage",Ews.ResponseMessageBase);Ews.CopyItemResponse=function Ews$CopyItemResponse(){Ews.CopyItemResponse._setupBase()};Ews.CopyItemResponse.XmlName="CopyItemResponse";Ews.CopyItemResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.CopyItemResponse.createXmlClass("Ews.CopyItemResponse",Ews.ResponseBase);Ews.CopyItemResponseMessage=function Ews$CopyItemResponseMessage(){Ews.CopyItemResponseMessage._setupBase()};Ews.CopyItemResponseMessage.XmlName="CopyItemResponseMessage";Ews.CopyItemResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.CopyItemResponseMessage.createXmlClass("Ews.CopyItemResponseMessage",Ews.ResponseMessageBase)})();g_fModuleLoaded[".\\Ews/MoveCopyResponse.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/EmptyFolderRequest.js".toLowerCase()]&&(function(){Ews.EmptyFolderRequest=function Ews$EmptyFolderRequest(){Ews.EmptyFolderRequest._setupBase();this._rgFolderIds=null;this._sDeleteType=Ews.DeleteTypes.MoveToDeletedItems;this._fDeleteSubFolders=false};Ews.EmptyFolderRequest.XmlName="EmptyFolder";Ews.EmptyFolderRequest.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.EmptyFolderRequest.prototype._LoadInternal=function Ews$EmptyFolderRequest$prototype$_LoadInternal(c,b){for(var a=0;a<c.attributes.length;++a){var e=c.attributes[a].baseName,d=c.attributes[a].value;switch(e){case"DeleteType":this._sDeleteType=d;break;case"DeleteSubFolders":this._fDeleteSubFolders=d=="true"}}if(b.length>1||b.length==0)throw"EmptyFolder: Bad Data";this._rgFolderIds=b[0].get_FolderIds()};Ews.EmptyFolderRequest.prototype._SerializeInternal=function Ews$EmptyFolderRequest$prototype$_SerializeInternal(a){a.setAttribute("DeleteType",this._sDeleteType);a.setAttribute("DeleteSubFolders",""+this._fDeleteSubFolders);var b=new Ews.FolderIds;b.set_FolderIds(this._rgFolderIds);a.appendChild(b.Serialize(a.get_OwnerDocument()))};Ews.EmptyFolderRequest.prototype.get_DeleteType=function Ews$EmptyFolderRequest$prototype$get_DeleteType(){return this._sDeleteType};Ews.EmptyFolderRequest.prototype.set_DeleteType=function Ews$EmptyFolderRequest$prototype$set_DeleteType(a){this._sDeleteType=a};Ews.EmptyFolderRequest.prototype.get_DeleteSubFolders=function Ews$EmptyFolderRequest$prototype$get_DeleteSubFolders(){return this._fDeleteSubFolders};Ews.EmptyFolderRequest.prototype.set_DeleteSubFolders=function Ews$EmptyFolderRequest$prototype$set_DeleteSubFolders(a){this._fDeleteSubFolders=a};Ews.EmptyFolderRequest.prototype.get_ItemIds=function Ews$EmptyFolderRequest$prototype$get_ItemIds(){return this._rgItemIds};Ews.EmptyFolderRequest.prototype.set_FolderIds=function Ews$EmptyFolderRequest$prototype$set_FolderIds(a){this._rgFolderIds=a};Ews.EmptyFolderRequest.createXmlClass("Ews.EmptyFolderRequest",Ews.RequestBase)})();g_fModuleLoaded[".\\Ews/EmptyFolderRequest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/EmptyFolderResponse.js".toLowerCase()]&&(function(){Ews.EmptyFolderResponse=function Ews$EmptyFolderResponse(){Ews.EmptyFolderResponse._setupBase()};Ews.EmptyFolderResponse.XmlName="EmptyFolderResponse";Ews.EmptyFolderResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.EmptyFolderResponse.prototype._LoadInternal=function Ews$EmptyFolderResponse$prototype$_LoadInternal(b,a){Ews.EmptyFolderResponse.callBase(this,"_LoadInternal",[b,a])};Ews.EmptyFolderResponse.prototype._SerializeInternal=function Ews$EmptyFolderResponse$prototype$_SerializeInternal(a){Ews.EmptyFolderResponse.callBase(this,"_SerializeInternal",[a])};Ews.EmptyFolderResponse.createXmlClass("Ews.EmptyFolderResponse",Ews.ResponseBase);Ews.EmptyFolderResponseMessage=function Ews$EmptyFolderResponseMessage(){Ews.EmptyFolderResponseMessage._setupBase()};Ews.EmptyFolderResponseMessage.XmlName="EmptyFolderResponseMessage";Ews.EmptyFolderResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.EmptyFolderResponseMessage.prototype._LoadInternal=function Ews$EmptyFolderResponseMessage$prototype$_LoadInternal(b,a){Ews.EmptyFolderResponseMessage.callBase(this,"_LoadInternal",[b,a])};Ews.EmptyFolderResponseMessage.prototype._SerializeInternal=function Ews$EmptyFolderResponseMessage$prototype$_SerializeInternal(a){Ews.EmptyFolderResponseMessage.callBase(this,"_SerializeInternal",[a])};Ews.EmptyFolderResponseMessage.createXmlClass("Ews.EmptyFolderResponseMessage",Ews.ResponseMessageBase)})();g_fModuleLoaded[".\\Ews/EmptyFolderResponse.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/Properties.js".toLowerCase()]&&(function(){Ews.IsReadProperty=function Ews$IsReadProperty(){Ews.IsReadProperty._setupBase()};Ews.IsReadProperty.XmlName="IsRead";Ews.IsReadProperty.ItemType="message";Ews.IsReadProperty.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.IsReadProperty.createXmlClass("Ews.IsRead",Ews.SimpleBooleanSoapElement)})();g_fModuleLoaded[".\\Ews/Properties.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/MessageItem.js".toLowerCase()]&&(function(){Ews.Message=function Ews$Message(){Ews.Message._setupBase();this._oProperties={}};Ews.Message.XmlName="Message";Ews.Message.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.Message.prototype._LoadInternal=function Ews$Message$prototype$_LoadInternal(f,c){for(var b=0;b<c.length;++b){var d=c[b],a=Type.getInstanceType(d);if(a.ItemType){var e=a.ItemType+":"+a.XmlName;this._oProperties[e]=d}}};Ews.Message.prototype._SerializeInternal=function Ews$MultiChildrenSoapElement$prototype$_SerializeInternal(a){var b=a.get_OwnerDocument();for(var c in this._oProperties)a.appendChild(this._oProperties[c].Serialize(b))};Ews.Message.prototype.get_ItemId=function Ews$Message$prototype$get_ItemId(){return this._oProperties["item:ItemId"]};Ews.Message.prototype.get_IsRead=function Ews$Message$prototype$get_IsRead(){return this._oProperties["message:IsRead"]!=null?this._oProperties["message:IsRead"].get_Value():true};Ews.Message.prototype.set_ItemId=function Ews$Message$prototype$set_ItemId(a){this._oProperties["item:ItemId"]=a};Ews.Message.prototype.set_IsRead=function Ews$Message$prototype$set_IsRead(b){var a=new Ews.IsReadProperty;a.set_Value(b);this._oProperties["message:IsRead"]=a};Ews.Message.createXmlClass("Ews.Message",Ews.SoapElementBase);Ews.Items=function Ews$Items(){Ews.Items._setupBase();Ews.Items.constructBase(this,[Ews.Message])};Ews.Items.XmlName="Items";Ews.Items.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.Items.createXmlClass("Ews.Items",Ews.MultiChildrenSoapElement)})();g_fModuleLoaded[".\\Ews/MessageItem.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/FieldURIs.js".toLowerCase()]&&(function(){Ews.FieldURI=function(a){Ews.FieldURI._setupBase();this._sPropertyId=a};Ews.FieldURI.XmlName="FieldURI";Ews.FieldURI.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.FieldURI.prototype._LoadInternal=function(a){this._sPropertyId=a.getAttribute("FieldURI")};Ews.FieldURI.prototype._SerializeInternal=function(a){a.setAttribute("FieldURI",this._sPropertyId)};Ews.FieldURI.prototype.get_PropertyId=function(){return this._sPropertyId};Ews.FieldURI.prototype.set_PropertyId=function(a){this._sPropertyId=a};Ews.FieldURI.createXmlClass("Ews.FieldURI",Ews.SoapElementBase)})();g_fModuleLoaded[".\\Ews/FieldURIs.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/UpdateItemRequest.js".toLowerCase()]&&(function(){Ews.MessageDisposition={SaveOnly:"SaveOnly",SendOnly:"SendOnly",SendAndSaveCopy:"SendAndSaveCopy"};Ews.ConflictResolution={NeverOverwrite:"NeverOverwrite",AutoResolve:"AutoResolve",AlwaysOverwrite:"AlwaysOverwrite"};Ews.UpdateItemRequest=function Ews$UpdateItemRequest(){Ews.UpdateItemRequest._setupBase();this._rgItemChanges=[];this._sDisposition=Ews.MessageDisposition.SaveOnly;this._sConflictResolution=Ews.ConflictResolution.AutoResolve;this._set_RequestVersion(Ews.Ews2007_SP1)};Ews.UpdateItemRequest.XmlName="UpdateItem";Ews.UpdateItemRequest.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.UpdateItemRequest.prototype._LoadInternal=function Ews$UpdateItemRequest$prototype$_LoadInternal(b,a){if(a.length>1||a.length==0)throw"DeleteItems: Bad Data";this._sDisposition=b.getAttribute("MessageDisposition");this._sConflictResolution=b.getAttribute("ConflictResolution");this._rgItemChanges=a[0].get_Children()};Ews.UpdateItemRequest.prototype._SerializeInternal=function Ews$UpdateItemRequest$prototype$_SerializeInternal(a){var b=new Ews.ItemChanges;b.set_Children(this._rgItemChanges);a.setAttribute("MessageDisposition",this._sDisposition);a.setAttribute("ConflictResolution",this._sConflictResolution);a.appendChild(b.Serialize(a.get_OwnerDocument()))};Ews.UpdateItemRequest.prototype.get_ItemChanges=function Ews$UpdateItemRequest$prototype$get_ItemChanges(){return this._rgItemChanges};Ews.UpdateItemRequest.prototype.set_ItemChanges=function Ews$UpdateItemRequest$prototype$set_ItemChanges(a){this._rgItemChanges=a};Ews.UpdateItemRequest.prototype.set_Disposition=function(a){this._sDisposition=a};Ews.UpdateItemRequest.prototype.get_Disposition=function(){return this._sDisposition};Ews.UpdateItemRequest.prototype.set_ConflictResolution=function(a){this._sConflictResolution=a};Ews.UpdateItemRequest.prototype.get_ConflictResolution=function(){return this._sConflictResolution};Ews.UpdateItemRequest.createXmlClass("UpdateItemRequest",Ews.RequestBase);Ews.UpdateItemResponse=function Ews$UpdateItemResponse(){Ews.UpdateItemResponse._setupBase()};Ews.UpdateItemResponse.XmlName="UpdateItemResponse";Ews.UpdateItemResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.UpdateItemResponse.createXmlClass("Ews.UpdateItemResponse",Ews.ResponseBase);Ews.UpdateItemResponseMessage=function Ews$UpdateItemResponseMessage(){Ews.UpdateItemResponseMessage._setupBase()};Ews.UpdateItemResponseMessage.XmlName="UpdateItemResponseMessage";Ews.UpdateItemResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.UpdateItemResponseMessage.createXmlClass("Ews.UpdateItemResponseMessage",Ews.ResponseMessageBase);Ews.ItemChanges=function Ews$ItemChanges(){Ews.ItemChanges._setupBase();Ews.ItemChanges.constructBase(this,[Ews.ItemChange])};Ews.ItemChanges.XmlName="ItemChanges";Ews.ItemChanges.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ItemChanges.createXmlClass("Ews.ItemChanges",Ews.MultiChildrenSoapElement);Ews.ItemChange=function Ews$ItemChange(){Ews.ItemChange._setupBase();this._oItemId=null;this._oUpdates=new Ews.Updates};Ews.ItemChange.XmlName="ItemChange";Ews.ItemChange.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ItemChange.prototype._LoadInternal=function Ews$ItemChange$prototype$_LoadInternal(b,a){if(a.length!=2)throw"ItemChange: Bad Data";this._oItemId=a[0];this._oUpdates=a[1]};Ews.ItemChange.prototype._SerializeInternal=function Ews$ItemChange$prototype$_SerializeInternal(a){var b=a.get_OwnerDocument();a.appendChild(this._oItemId.Serialize(b));a.appendChild(this._oUpdates.Serialize(b))};Ews.ItemChange.prototype.get_ItemId=function Ews$ItemChange$prototype$get_ItemId(){return this._oItemId};Ews.ItemChange.prototype.set_ItemId=function Ews$ItemChange$prototype$set_ItemId(a){this._oItemId=a};Ews.ItemChange.prototype.get_Updates=function Ews$ItemChange$prototype$get_Updates(){return this._oUpdates};Ews.ItemChange.prototype.set_Update=function Ews$ItemChange$prototype$set_Update(a){this._oUpdates=a};Ews.ItemChange.createXmlClass("Ews.ItemChange",Ews.SoapElementBase);Ews.Updates=function Ews$Updates(){Ews.Updates._setupBase();this._rgSetItemFields=[]};Ews.Updates.XmlName="Updates";Ews.Updates.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.Updates.prototype._LoadInternal=function Ews$Updates$prototype$_LoadInternal(d,a){if(a.length==0)throw new Error("Updates: Bad data");for(var b=0;b<a.length;++b){var c=a[b];if(Ews.SetItemField.isInstance(c))this._rgSetItemFields.push(c);else throw new Error("Updates: we only support setitemFiled for now");}};Ews.Updates.prototype._SerializeInternal=function Ews$Updates$prototype$_SerializeInternal(b){for(var c=b.get_OwnerDocument(),a=0;a<this._rgSetItemFields.length;++a)b.appendChild(this._rgSetItemFields[a].Serialize(c))};Ews.Updates.prototype.get_SetItemFields=function Ews$Updates$prototype$get_SetItemFields(){return this._rgSetItemFields};Ews.Updates.createXmlClass("Ews.Updates",Ews.SoapElementBase);Ews.SetItemField=function Ews$SetItemField(){Ews.SetItemField._setupBase();this._oProperty=null;this._oPartialValueItem=null};Ews.SetItemField.XmlName="SetItemField";Ews.SetItemField.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.SetItemField.prototype._LoadInternal=function Ews$SetItemField$prototype$_LoadInternal(b,a){this._oProperty=a[0];this._oPartialValueItem=a[0]};Ews.SetItemField.prototype._SerializeInternal=function Ews$SetItemField$prototype$_SerializeInternal(a){var b=a.get_OwnerDocument();a.appendChild(this._oProperty.Serialize(b));a.appendChild(this._oPartialValueItem.Serialize(b))};Ews.SetItemField.prototype.get_Property=function Ews$SetItemField$prototype$get_Property(){return this._oProperty};Ews.SetItemField.prototype.get_PartialValueItem=function Ews$SetItemField$prototype$get_PartialValueItem(){return this._oPartialValueItem};Ews.SetItemField.prototype.set_Property=function Ews$SetItemField$prototype$set_Property(a){this._oProperty=a};Ews.SetItemField.prototype.set_PartialValueItem=function Ews$SetItemField$prototype$set_PartialValueItem(a){this._oPartialValueItem=a};Ews.SetItemField.createXmlClass("Ews.SetItemField",Ews.SoapElementBase)})();g_fModuleLoaded[".\\Ews/UpdateItemRequest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/ConversationAction.js".toLowerCase()]&&(function(){Ews.ConversationActionTypeStrings={AlwaysCategorize:"AlwaysCategorize",AlwaysDelete:"AlwaysDelete",AlwaysMove:"AlwaysMove",Delete:"Delete",Move:"Move",Copy:"Copy",SetReadState:"SetReadState"};Ews.ConversationAction=function Ews$ConversationAction(){Ews.ConversationAction._setupBase();this._sAction=null;this._oConversationId=null;this._fProcessRightAway=null;this._oContextFolderId=null;this._oConversationLastSyncTime=null;this._oDestinationFolderId=null;this._rgCategories=null;this._fAlwaysDelete=null;this._fIsRead=null;this._sDeleteType=null};Ews.ConversationAction.XmlName="ConversationAction";Ews.ConversationAction.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationAction.prototype._LoadInternal=function Ews$ConversationAction$prototype$_LoadInternal(d,c){var b=0,a=c[b];if(!Ews.ConversationAction.isInstance(a))throw new Error("Expected Action as first child");else this._sAction=a.get_Value();b++;a=c[b];if(!Ews.ConversationId.isInstance(a))throw new Error("Expected ConversationId");else this._oConversationId=a;b++;a=c[b];if(Ews.ContextFolderId.isInstance(a)){this._oContextFolderId=a.get_Value();b++;a=c[b]}if(Ews.ConversationLastSyncTime.isInstance(a)){this._oConversationLastSyncTime=a.get_Value();b++;a=c[b]}if(Ews.ProcessRightAway.isInstance(a)){this._fProcessRightAway=a.get_Value();b++;a=c[b]}if(Ews.DestinationFolderId.isInstance(a)){this._oDestinationFolderId=a.get_Value();b++;a=c[b]}if(Ews.ConversationActionCategories.isInstance(a)){this._rgCategories=a.get_Value();b++;a=c[b]}if(Ews.ConversationActionEnableAlwaysDelete.isInstance(a)){this._fAlwaysDelete=a.get_Value();b++;a=c[b]}if(Ews.IsReadProperty.isInstance(a)){this._fIsRead=a.get_Value();b++;a=c[b]}if(Ews.ConversationActionDeleteType.isInstance(a))this._sDeleteType=a.get_Value()};Ews.ConversationAction.prototype._SerializeInternal=function Ews$ConversationAction$prototype$_SerializeInternal(a){var b=a.get_OwnerDocument();a.appendChild((new Ews.ConversationActionType(this._sAction)).Serialize(b));a.appendChild(this._oConversationId.Serialize(b));this._oContextFolderId&&a.appendChild((new Ews.ContextFolderId(this._oContextFolderId)).Serialize(b));this._oConversationLastSyncTime&&a.appendChild((new Ews.ConversationLastSyncTime(this._oConversationLastSyncTime)).Serialize(b));this._fProcessRightAway!==null&&a.appendChild((new Ews.ProcessRightAway(this._fProcessRightAway===true)).Serialize(b));this._oDestinationFolderId&&a.appendChild((new Ews.DestinationFolderId(this._oDestinationFolderId)).Serialize(b));this._rgCategories&&a.appendChild((new Ews.ConversationActionCategories(this._rgCategories)).Serialize(b));this._fAlwaysDelete!==null&&a.appendChild((new Ews.ConversationActionEnableAlwaysDelete(this._fAlwaysDelete)).Serialize(b));if(this._fIsRead!==null){var c=new Ews.IsReadProperty;c.set_Value(this._fIsRead);a.appendChild(c.Serialize(b))}this._sDeleteType!==null&&a.appendChild((new Ews.ConversationActionDeleteType(this._sDeleteType)).Serialize(b))};Ews.ConversationAction.prototype.get_Action=function Ews$ConversationAction$prototype$get_Action(){return this._sAction};Ews.ConversationAction.prototype.set_Action=function Ews$ConversationAction$prototype$set_Action(a){this._sAction=a};Ews.ConversationAction.prototype.get_ConversationId=function Ews$ConversationAction$prototype$get_ConversationId(){return this._oConversationId};Ews.ConversationAction.prototype.set_ConversationId=function Ews$ConversationAction$prototype$set_ConversationId(a){this._oConversationId=a};Ews.ConversationAction.prototype.get_ProcessRightAway=function Ews$ConversationAction$prototype$get_ProcessRightAway(){return this._fProcessRightAway};Ews.ConversationAction.prototype.set_ProcessRightAway=function Ews$ConversationAction$prototype$set_ProcessRightAway(a){this._fProcessRightAway=a};Ews.ConversationAction.prototype.get_ContextFolderId=function Ews$ConversationAction$prototype$get_ContextFolderId(){return this._oContextFolderId};Ews.ConversationAction.prototype.set_ContextFolderId=function Ews$ConversationAction$prototype$set_ContextFolderId(a){this._oContextFolderId=a};Ews.ConversationAction.prototype.get_ConversationLastSyncTime=function Ews$ConversationAction$prototype$get_ConversationLastSyncTime(){return this._oConversationLastSyncTime};Ews.ConversationAction.prototype.set_ConversationLastSyncTime=function Ews$ConversationAction$prototype$set_ConversationLastSyncTime(a){this._oConversationLastSyncTime=a};Ews.ConversationAction.prototype.get_DestinationFolderId=function Ews$ConversationAction$prototype$get_DestinationFolderId(){return this._oDestinationFolderId};Ews.ConversationAction.prototype.set_DestinationFolderId=function Ews$ConversationAction$prototype$set_DestinationFolderId(a){this._oDestinationFolderId=a};Ews.ConversationAction.prototype.get_Categories=function Ews$ConversationAction$prototype$get_Categories(){return this._rgCategories};Ews.ConversationAction.prototype.set_Categories=function Ews$ConversationAction$prototype$set_Categories(a){this._rgCategories=a};Ews.ConversationAction.prototype.get_AlwaysDelete=function Ews$ConversationAction$prototype$get_AlwaysDelete(){return this._fAlwaysDelete};Ews.ConversationAction.prototype.set_AlwaysDelete=function Ews$ConversationAction$prototype$set_AlwaysDelete(a){this._fAlwaysDelete=a};Ews.ConversationAction.prototype.get_IsRead=function Ews$ConversationAction$prototype$get_IsRead(){return this._fIsRead};Ews.ConversationAction.prototype.set_IsRead=function Ews$ConversationAction$prototype$set_IsRead(a){this._fIsRead=a};Ews.ConversationAction.prototype.get_DeleteType=function Ews$ConversationAction$prototype$get_DeleteType(){return this._sDeleteType};Ews.ConversationAction.prototype.set_DeleteType=function Ews$ConversationAction$prototype$set_DeleteType(a){this._sDeleteType=a};Ews.ConversationAction.createXmlClass("Ews.ConversationAction",Ews.SoapElementBase);Ews.ConversationActionType=function Ews$ConversationActionType(a){Ews.ConversationActionType._setupBase();Ews.ConversationActionType.constructBase(this,[a])};Ews.ConversationActionType.XmlName="Action";Ews.ConversationActionType.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationActionType.createXmlClass("Ews.ConversationActionType",Ews.SimpleStringSoapElement);Ews.ProcessRightAway=function Ews$ProcessRightAway(a){Ews.ProcessRightAway._setupBase();Ews.ProcessRightAway.constructBase(this,[a])};Ews.ProcessRightAway.XmlName="ProcessRightAway";Ews.ProcessRightAway.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ProcessRightAway.createXmlClass("Ews.ProcessRightAway",Ews.SimpleBooleanSoapElement);Ews.ContextFolderId=function Ews$ContextFolderId(a){Ews.ContextFolderId._setupBase();Ews.ContextFolderId.constructBase(this,[Ews.FolderId,a])};Ews.ContextFolderId.XmlName="ContextFolderId";Ews.ContextFolderId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ContextFolderId.createXmlClass("Ews.ContextFolderId",Ews.SingleChildSoapElement);Ews.ConversationLastSyncTime=function Ews$ConversationLastSyncTime(a){Ews.ConversationLastSyncTime._setupBase();Ews.ConversationLastSyncTime.constructBase(this,[a])};Ews.ConversationLastSyncTime.XmlName="ConversationLastSyncTime";Ews.ConversationLastSyncTime.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationLastSyncTime.createXmlClass("Ews.ConversationLastSyncTime",Ews.SimpleDateTimeSoapElement);Ews.DestinationFolderId=function Ews$DestinationFolderId(a){Ews.DestinationFolderId._setupBase();Ews.DestinationFolderId.constructBase(this,[Ews.FolderId,a])};Ews.DestinationFolderId.XmlName="DestinationFolderId";Ews.DestinationFolderId.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.DestinationFolderId.createXmlClass("Ews.DestinationFolderId",Ews.SingleChildSoapElement);Ews.ConversationActionCategories=function Ews$ConversationActionCategories(a){Ews.ConversationActionCategories._setupBase();Ews.ConversationActionCategories.constructBase(this,[Array,a])};Ews.ConversationActionCategories.XmlName="Categories";Ews.ConversationActionCategories.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationActionCategories.createXmlClass("Ews.ConversationActionCategories",Ews.SingleChildSoapElement);Ews.ConversationActionEnableAlwaysDelete=function Ews$ConversationActionEnableAlwaysDelete(a){Ews.ConversationActionEnableAlwaysDelete._setupBase();Ews.ConversationActionEnableAlwaysDelete.constructBase(this,[a])};Ews.ConversationActionEnableAlwaysDelete.XmlName="EnableAlwaysDelete";Ews.ConversationActionEnableAlwaysDelete.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationActionEnableAlwaysDelete.createXmlClass("Ews.ConversationActionEnableAlwaysDelete",Ews.SimpleBooleanSoapElement);Ews.ConversationActionDeleteType=function Ews$ConversationActionDeleteType(a){Ews.ConversationActionDeleteType._setupBase();Ews.ConversationActionDeleteType.constructBase(this,[a])};Ews.ConversationActionDeleteType.XmlName="DeleteType";Ews.ConversationActionDeleteType.NamespaceUri=Ews.Xml.NamespaceURIs.Type;Ews.ConversationActionDeleteType.createXmlClass("Ews.ConversationActionDeleteType",Ews.SimpleStringSoapElement)})();g_fModuleLoaded[".\\Ews/ConversationAction.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/ApplyConversationActionResponse.js".toLowerCase()]&&(function(){Ews.ApplyConversationActionResponse=function Ews$ApplyConversationActionResponse(){Ews.ApplyConversationActionResponse._setupBase()};Ews.ApplyConversationActionResponse.XmlName="ApplyConversationActionResponse";Ews.ApplyConversationActionResponse.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ApplyConversationActionResponse.createXmlClass("Ews.ApplyConversationActionResponse",Ews.ResponseBase);Ews.ApplyConversationActionResponseMessage=function Ews$ApplyConversationActionResponseMessage(){Ews.ApplyConversationActionResponseMessage._setupBase()};Ews.ApplyConversationActionResponseMessage.XmlName="ApplyConversationActionResponseMessage";Ews.ApplyConversationActionResponseMessage.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ApplyConversationActionResponseMessage.createXmlClass("Ews.ApplyConversationActionResponseMessage",Ews.ResponseMessageBase)})();g_fModuleLoaded[".\\Ews/ApplyConversationActionResponse.js".toLowerCase()]=1;!g_fModuleLoaded[".\\Ews/ApplyConversationActionRequest.js".toLowerCase()]&&(function(){Ews.ApplyConversationAction=function Ews$ApplyConversationAction(){Ews.ApplyConversationAction._setupBase();this._oConversationActions=new Ews.ConversationActions};Ews.ApplyConversationAction.XmlName="ApplyConversationAction";Ews.ApplyConversationAction.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ApplyConversationAction.prototype._LoadInternal=function Ews$ApplyConversationAction$prototype$_LoadInternal(b,a){this._oConversationActions=a[0]};Ews.ApplyConversationAction.prototype._SerializeInternal=function Ews$ApplyConversationAction$prototype$_SerializeInternal(a){a.appendChild(this._oConversationActions.Serialize(a.get_OwnerDocument()))};Ews.ApplyConversationAction.prototype.get_ConversationActions=function Ews$ApplyConversationAction$prototype$get_ConversationActions(){return this._oConversationActions.get_Children()};Ews.ApplyConversationAction.createXmlClass("Ews.ApplyConversationAction",Ews.RequestBase);Ews.ConversationActions=function Ews$ConversationActions(){Ews.ConversationActions._setupBase();Ews.ConversationActions.constructBase(this,[Ews.ConversationAction])};Ews.ConversationActions.XmlName="ConversationActions";Ews.ConversationActions.NamespaceUri=Ews.Xml.NamespaceURIs.Message;Ews.ConversationActions.createXmlClass("Ews.ConversationActions",Ews.MultiChildrenSoapElement)})();g_fModuleLoaded[".\\Ews/ApplyConversationActionRequest.js".toLowerCase()]=1;var EwsService;!g_fModuleLoaded[".\\ews/service.js".toLowerCase()]&&(function(){Ews.RequestNameParameter="&rq";Ews.RequestVersionParameter="&rv=";Ews.Ews2007_SP1="12.1";Ews.Service=function Ews$Service(a){this._oAjaxRequestClass=Owa.Dom.AjaxRequest;this._oMailboxGuid=a;this._sUrl="ev.Owa?oeh=1&ns=EwsProxy&ev=Proxy";this._oGuidHash={};this._fSyncronousRequest=false};Ews.Service.prototype.ConvertOwaIdToBaseId=function Ews$Service$prototype$ConvertOwaIdToBaseId(a){return Ews.BaseId.FromOwaId(this._oMailboxGuid,this._oGuidHash,a,null)};Ews.Service.prototype.ConvertToEwsId=function Ews$Service$prototype$ConvertToEwsId(a){return Ews.BaseId.FromOwaId(this._oMailboxGuid,this._oGuidHash,a,null).get_EwsId()};Ews.Service.prototype.ConvertToEwsIds=function Ews$Service$prototype$ConvertToEwsIds(b){for(var c=[],a=0;a<b.get_Length();a++)c[a]=this.ConvertToEwsId(b[a]);return c};Ews.Service.prototype.ConvertToOwaId=function Ews$Service$prototype$ConvertToOwaId(){throw"Not implement";};Ews.Service.prototype.ConvertToOwaIds=function Ews$Service$prototype$ConvertToOwaIds(){throw"Not implement";};Ews.Service.prototype.DeleteItems=function Ews$Service$prototype$DeleteItems(e,g,f,d,c,b){var a=new Ews.DeleteItemRequest;a.set_ItemIds(f);a.set_DeleteType(d);a.set_SendMeetingCancellations(c);a.set_AffectedTaskOccurrences(b);a.Execute(this,e,g)};Ews.Service.prototype.CopyItems=function Ews$Service$prototype$CopyItems(c,e,d,b){var a=new Ews.CopyItemRequest;a.set_ItemIds(d);a.set_DestinationFolderId(b);a.Execute(this,c,e)};Ews.Service.prototype.MoveItems=function Ews$Service$prototype$MoveItems(c,e,d,b){var a=new Ews.MoveItemRequest;a.set_ItemIds(d);a.set_DestinationFolderId(b);a.Execute(this,c,e)};Ews.Service.prototype.MarkAsRead=function Ews$Service$prototype$MarkAsRead(h,i,g,f){var c=new Ews.UpdateItemRequest;c.set_ConflictResolution(Ews.ConflictResolution.AlwaysOverwrite);for(var d=0;d<f.length;++d){var e=new Ews.Message;e.set_IsRead(g);var a=new Ews.SetItemField;a.set_Property(new Ews.FieldURI("message:IsRead"));a.set_PartialValueItem(e);var b=new Ews.ItemChange;b.set_ItemId(f[d]);b.get_Updates().get_SetItemFields().push(a);c.get_ItemChanges().push(b)}c.Execute(this,h,i)};Ews.Service.prototype.ApplyConversationAction=function(j,k,i,e,c,f,h,d){for(var g=new Ews.ApplyConversationAction,b=0;b<c.length;++b){var a=new Ews.ConversationAction;a.set_Action(i);a.set_ConversationId(c[b].Id);e&&a.set_ContextFolderId(e);c[b].LastUpdateTime&&a.set_ConversationLastSyncTime(c[b].LastUpdateTime);f&&a.set_DeleteType(f);isDf(h)&&a.set_IsRead(h);d&&a.set_DestinationFolderId(d);g.get_ConversationActions().push(a)}g.Execute(this,j,k)};Ews.Service.prototype.EmptyFolder=function Ews$Service$prototype$EmptyFolder(e,f,c,d,b){var a=new Ews.EmptyFolderRequest;a.set_FolderIds(c);a.set_DeleteType(d);b&&a.set_DeleteSubFolders(true);a.Execute(this,e,f)};Ews.Service.prototype.get_AjaxRequest=function Ews$Service$prototype$get_AjaxRequest(e,c,d,b){var a=new this._oAjaxRequestClass(this._sUrl+Ews.RequestNameParameter+d+(b?Ews.RequestVersionParameter+b:""),"POST",null,e,this._fSyncronousRequest,false,c);a.setRequestHeader("Content-Type","text/xml");return a};Ews.Service.prototype.testSet_AjaxRequestClass=function Ews$Service$prototype$testSet_AjaxRequestClass(a){this._oAjaxRequestClass=a};Ews.Service.prototype.AddGuidEntry=function Ews$Service$prototype$addGuidEntry(a,b){this._oGuidHash[a]=Owa.Utility.stringToBytes(b)};if(!EwsService&&Owa.Utility.getRootOwaWindow().getGlobalVariable("a_sMailboxGuid"))EwsService=new Ews.Service(Owa.Utility.stringToBytes(Owa.Utility.getRootOwaWindow().getGlobalVariable("a_sMailboxGuid")))})();g_fModuleLoaded[".\\ews/service.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()]&&(function(){var a="onColorSelected",c='<a onclick="event.returnValue=false;" href="#" unselectable="on">',b="</a>";Owa.UIControls.ColorPicker=function Owa$UIControls$ColorPicker(h,c,k,j,i,f,e,b,g,a){var d=this._generatePickerElement(c,k,j,i,f,e,g,a);Owa.UIControls.ColorPicker.constructBase(this,[d,c]);this.set_SubPage(h);this.sDefaultColorValue=b;this.sColorValue=b;this.oDialogHelper=a;Owa.UIControls.ColorPicker.callBase(this,"initialize");this._attachEvent(this._get_Element(),"click",this._onClick)};Owa.UIControls.ColorPicker.prototype.dispose=function Owa$UIControls$ColorPicker$dispose(){this._get_Element().detachAllEvents();this._get_Element().remove(true);Owa.UIControls.ColorPicker.callBase(this,"dispose")};Owa.UIControls.ColorPicker.prototype._onClick=function Owa$UIControls$ColorPicker$_onClick(e){var b=e.get_Target();if(b.hasCssClass("colorCell"))b=b.get_ParentElement();if(!b.hasCssClass("colorPickerCell")&&!b.hasCssClass("colorPickerButton"))return;if(b.get_Id()=="spanColorPickerMoreCell"){var c=this.oDialogHelper.ChooseColorDlg(this.sColorValue);c=c.toString(16);if(c.length<6){var d="000000".substring(0,6-c.length);c=d.concat(c)}this.sColorValue=c}else if(b.get_Id()=="spanColorPickerNoneCell")this.sColorValue=this.sDefaultColorValue;else this.sColorValue=b.getAttribute("sV");this._dispatchEvent(a,this)};Owa.UIControls.ColorPicker.prototype.get_OnColorSelected=function Owa$UIControls$ColorPicker$get_OnColorSelected(){return this._getEventHandlerCollection(a)};Owa.UIControls.ColorPicker.prototype._generatePickerElement=function Owa$UIControls$ColorPicker$_generatePickerElement(q,t,i,h,r,l,n,o){var g=Owa.Utility.isIE()?c:"",f=Owa.Utility.isIE()?b:"";if(o&&Owa.Utility.isDefined(typeof o.ChooseColorDlg))var m=1;var a="";a+='<DIV id="divColors">';for(var j=0;j<i;j++){for(var k=0;k<h;k++){var d=r(j,k,i,h);a+=g;a+='<DIV class="fltBefore colorPickerCell"';a+=d.sValue!=null?" sV="+d.sValue:"";a+="><DIV";a+=' class="colorCell ';a+=d.sClass?d.sClass:"";a+='"';a+=d.sStyle?" style="+d.sStyle:"";a+="></DIV></DIV>";a+=f}a+='<DIV class="clear"></DIV>'}a+="</DIV>";if(m||n){a+=g;a+='<DIV class="colorPickerActions">';if(m){a+=g;a+='<SPAN class="colorPickerButton" id="spanColorPickerMoreCell">'+l[0]+"</SPAN>";a+=f}if(n){a+=g;a+='<SPAN class="colorPickerButton" id="spanColorPickerNoneCell">'+l[1]+"</SPAN>";a+=f}a+="</DIV>";a+=f}var s=q?q.get_OwnerDocument():Owa.Dom.Document.get_Current(),e=s.createElement("div");e.set_Id(t);e.set_CssClasses(["colorPicker"]);e.set_InnerHtml(a);var p=e.getDescendantById("divColors");p.set_Width(h*20);p.set_Height(i*20);return e};Owa.UIControls.ColorPicker.createClass("Owa.UIControls.ColorPicker",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()]&&(function(){Owa.UIControls.ColorPickerPopup=function Owa$UIControls$ColorPickerPopup(c,b,n,l,k,f,j,e,i,g,h,d){this.fnOnPick=j;this.oColorPicker=new Owa.UIControls.ColorPicker(c,b,n,l,k,f,e,i,g,h);var a=this.oColorPicker._get_Element(),m=b.get_OwnerDocument();m.get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,a);a.addCssClass("pu");a.set_IsShown(false);Owa.UIControls.ColorPickerPopup.constructBase(this,[a,b,d]);this.set_SubPage(c);this.oColorPicker.get_OnColorSelected().add(this._createCallback(this._onPickInternal));Owa.UIControls.ColorPickerPopup.callBase(this,"initialize")};Owa.UIControls.ColorPickerPopup.prototype.dispose=function Owa$UIControls$ColorPickerPopup$dispose(){this.oColorPicker.dispose();Owa.UIControls.ColorPickerPopup.callBase(this,"dispose")};Owa.UIControls.ColorPickerPopup.prototype._onPickInternal=function Owa$UIControls$ColorPickerPopup$_onPickInternal(a){this.sColorValue=a.sColorValue;this.fnOnPick&&this.fnOnPick(this);this.close()};Owa.UIControls.ColorPickerPopup.prototype.showUnderParent=function Owa$UIControls$ColorPickerPopup$showUnderParent(){this.showUnder(this._get_Parent(),0)};Owa.UIControls.ColorPickerPopup.createClass("Owa.UIControls.ColorPickerPopup",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/editcategorydialog.js".toLowerCase()]&&(function(){Owa.UIControls.EditCategoryDialog=function Owa$UIControls$EditCategoryDialog(b,a){a=a||"catB noClr";var c='<table id=tblEdtCtg cellpadding=0 cellspacing=4><tr><td nowrap="nowrap">'+L_Clr+'</td><td class="edtCtgC2">'+L_CtgNm+'</td></tr><tr><td><div id=divCtgClr class="cmb">'+Owa.Components.CssSprites.getImageMarkup("drparw.gif",'id="divCmbDd"',"",null)+'<div class="cmbVis"><div class="cmbCont"><img class="cmbVASp"><span id="spanCmbSel"><img id=imgSw class="'+a+'"></span></div></div></div></td><td class="edtCtgC2"><input id=txtCtgNm type=text maxlength=255></td></tr></table>';Owa.UIControls.EditCategoryDialog.constructBase(this,["divEdtCtg",c,b,[L_OK,L_Cncl]]);this._attachEvent(this._getDescendant("divCtgClr"),"click",this.showColorPicker)};Owa.UIControls.EditCategoryDialog.createClass("Owa.UIControls.EditCategoryDialog",Owa.UIControls.ButtonDialog);Owa.UIControls.EditCategoryDialog.NO_COLOR=-1;Owa.UIControls.EditCategoryDialog.prototype.showColorPicker=function Owa$UIControls$EditCategoryDialog$showColorPicker(){if(!this._oColorPicker){var a=function(d,c){var b=d*5+c,a={};a.sClass="cat"+b;a.sValue=b;return a};this._oColorPicker=new Owa.UIControls.ColorPickerPopup(this.get_SubPage(),this._getDescendant("divCtgClr"),"divCatClrPk",5,5,a,this._createCallback(this._onClickColorPicker),[L_MrClrs,L_None],Owa.UIControls.EditCategoryDialog.NO_COLOR)}this._oColorPicker.showUnderParent()};Owa.UIControls.EditCategoryDialog.prototype._onClickColorPicker=function Owa$UIControls$EditCategoryDialog$_onClickColorPicker(a){this._sChangedColor=a.sColorValue;this._getDescendant("imgSw").set_CssClasses([Owa.UIControls.EditCategoryDialog.getCategoryClass(a.sColorValue)]);a.close()};Owa.UIControls.EditCategoryDialog.prototype.get_ChangedColor=function Owa$UIControls$EditCategoryDialog$get_ChangedColor(){return this._sChangedColor};Owa.UIControls.EditCategoryDialog.prototype.dispose=function Owa$UIControls$EditCategoryDialog$dispose(){this._getDescendant("divCtgClr").dispose();if(this._oColorPicker){this._oColorPicker.dispose();delete this._oColorPicker}Owa.UIControls.ManageCategoriesDialog.callBase(this,"dispose")};Owa.UIControls.EditCategoryDialog.getCategoryClass=function getCategoryClass(a){return"catB "+(a==Owa.UIControls.EditCategoryDialog.NO_COLOR?"noClr":"cat"+a)}})();g_fModuleLoaded[".\\uicontrols/editcategorydialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/createcategorydialog.js".toLowerCase()]&&(function(){Owa.UIControls.CreateCategoryDialog=function Owa$UIControls$CreateCategoryDialog(){Owa.UIControls.CreateCategoryDialog.constructBase(this,[L_CrtCtg]);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this._fFocus=false;this.get_OnShow().add(this._createCallback(this._focusOnInput))};Owa.UIControls.CreateCategoryDialog.createClass("Owa.UIControls.CreateCategoryDialog",Owa.UIControls.EditCategoryDialog);Owa.UIControls.CreateCategoryDialog.prototype._focusOnInput=function Owa$UIControls$CreateCategoryDialog$_focusOnInput(){this._getDescendant("txtCtgNm").focus(1)};Owa.UIControls.CreateCategoryDialog.prototype._onButtonDialogClose=function Owa$UIControls$CreateCategoryDialog$_onButtonDialogClose(c){if(c==-1||c==1)return;if(this._fCreating)return 1;var a=this.get_ChangedColor();a=a==null?Owa.UIControls.EditCategoryDialog.NO_COLOR:a;var b=new oeReq("Cat","CrtCtg",null,this._createCallback(this.cbCreateCategory));b.add("nm",this._getDescendant("txtCtgNm").get_Value());b.add("clr",a);b.send();this._fCreating=true;return 1};Owa.UIControls.CreateCategoryDialog.prototype.cbCreateCategory=function Owa$UIControls$CreateCategoryDialog$cbCreateCategory(d){this._fCreating=false;if(!cbOeh(d))return;var b=d.getResponseAsDomElement(false,this._get_Element().get_OwnerDocument());if(b.get_Id()=="divEIB"){var c=this._getDescendant("divEIB");c&&c.remove(true);this._getDescendant("divBtnDlgBdy").insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,b)}else{this._dispatchEvent(a,b);this.hide()}};var a="OnCategoryCreated";Owa.UIControls.CreateCategoryDialog.prototype.get_OnCategoryCreated=function Owa$UIControls$CreateCategoryDialog$get_OnCategoryCreated(){return this._getEventHandlerCollection(a)}})();g_fModuleLoaded[".\\uicontrols/createcategorydialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/changecategorycolordialog.js".toLowerCase()]&&(function(){Owa.UIControls.ChangeCategoryColorDialog=function Owa$UIControls$ChangeCategoryColorDialog(a,c){Owa.UIControls.ChangeCategoryColorDialog.constructBase(this,[L_ChgClr,c]);this._sCategoryName=a;var b=this._getDescendant("txtCtgNm");b.set_Value(a);b.set_IsDisabled(true);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose))};Owa.UIControls.ChangeCategoryColorDialog.createClass("Owa.UIControls.ChangeCategoryColorDialog",Owa.UIControls.EditCategoryDialog);Owa.UIControls.ChangeCategoryColorDialog.prototype._onButtonDialogClose=function Owa$UIControls$ChangeCategoryColorDialog$_onButtonDialogClose(d){if(d==-1||d==1)return;var b=this.get_ChangedColor();if(b==null)return;var c=new oeReq("Cat","ChgCtg",0,cbOeh);c.add("nm",this._sCategoryName);c.add("clr",b);c.send();this._dispatchEvent(a,Owa.UIControls.EditCategoryDialog.getCategoryClass(b))};var a="OnCategoryColorChanged";Owa.UIControls.ChangeCategoryColorDialog.prototype.get_OnCategoryColorChanged=function Owa$UIControls$ChangeCategoryColorDialog$get_OnCategoryColorChanged(){return this._getEventHandlerCollection(a)}})();g_fModuleLoaded[".\\uicontrols/changecategorycolordialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/managecategoriesdialog.js".toLowerCase()]&&(function(){var a=null,b=0;Owa.UIControls.ManageCategoriesDialog=function Owa$UIControls$ManageCategoriesDialog(c){if(Owa.UIControls.ManageCategoriesDialog._get_Instance())throw"Cannot create the singleton ManageCategoriesDialog more than once";var b=Owa.Dom.Document.get_Current().createElement("DIV");b.set_InnerHtml(c.sBody);this._oStringDiv=b.getDescendantById("divStr");var e=this._oStringDiv.getAttribute("L_MngCtgs");Owa.UIControls.ManageCategoriesDialog.constructBase(this,["divMngCtgs",c.sBody,e,[L_OK],290,null,null,null,1]);var a=this._getDescendant("divCtgLst");this._attachEvent(a,"keydown",this._OnKeyDownCategoryList);this._attachEvent(a,"click",this._OnClickCategoryList);this._attachEvent(this._getDescendant("lnkCrtCat"),"click",this._onClickCreateCategoryLink);this._attachEvent(this._getDescendant("lnkChgCatClr"),"click",this._onClickChangeCategoryColorLink);this._attachEvent(this._getDescendant("lnkDelCat"),"click",this._onClickDeleteCategoryLink);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));var d=a.getDescendantsByTagName("DIV");d.length&&this._selectCategory(d[0])};Owa.UIControls.ManageCategoriesDialog.createClass("Owa.UIControls.ManageCategoriesDialog",Owa.UIControls.ButtonDialog);Owa.UIControls.ManageCategoriesDialog.prototype.dispose=function Owa$UIControls$ManageCategoriesDialog$dispose(){var a=this._getDescendant("divCtgLst");a.dispose();this._getDescendant("lnkCrtCat").dispose();this._getDescendant("lnkChgCatClr").dispose();this._getDescendant("lnkChgCatClr").dispose();Owa.UIControls.ManageCategoriesDialog.callBase(this,"dispose")};Owa.UIControls.ManageCategoriesDialog.prototype._OnClickCategoryList=function Owa$UIControls$ManageCategoriesDialog$_OnClickCategoryList(d){var a=d.get_Target(),b=this._getDescendant("divCtgLst");while(!a.equals(b)){var c=a.get_ParentElement();if(c.equals(b)&&a.get_TagName().lc()=="div"){this._selectCategory(a);break}a=c}};Owa.UIControls.ManageCategoriesDialog.prototype._OnKeyDownCategoryList=function Owa$UIControls$ManageCategoriesDialog$_OnKeyDownCategoryList(c){if(!this._oSelectedCategory)return;var b=c.get_KeyCodeForKeyUpDown(),a=null;if(b==UP)a=this._oSelectedCategory.get_PreviousSibling();else if(b==DOWN)a=this._oSelectedCategory.get_NextSibling();a&&this._selectCategory(a)};Owa.UIControls.ManageCategoriesDialog.prototype._onClickCreateCategoryLink=function Owa$UIControls$ManageCategoriesDialog$_onClickCreateCategoryLink(){var a=new Owa.UIControls.CreateCategoryDialog;a.get_OnCategoryCreated().add(this._createCallback(this._onCategoryCreated));a.show();return false};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryCreated=function Owa$UIControls$ManageCategoriesDialog$_onCategoryCreated(a){this._getDescendant("divCtgLst").appendChild(a)};Owa.UIControls.ManageCategoriesDialog.prototype._onClickChangeCategoryColorLink=function Owa$UIControls$ManageCategoriesDialog$_onClickChangeCategoryColorLink(){if(this._oSelectedCategory){var c=this._getCategoryName(this._oSelectedCategory),b=this._oSelectedCategory.getDescendantsByTagName("IMG")[0].get_CssClasses().join(" "),a=new Owa.UIControls.ChangeCategoryColorDialog(c,b);a.get_OnCategoryColorChanged().add(this._createCallback(this._onCategoryColorChanged));a.show()}return false};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryColorChanged=function Owa$UIControls$ManageCategoriesDialog$_onCategoryColorChanged(a){this._oSelectedCategory.getDescendantsByTagName("IMG")[0].set_CssClasses(a.split(" "))};Owa.UIControls.ManageCategoriesDialog.prototype._onClickDeleteCategoryLink=function Owa$UIControls$ManageCategoriesDialog$_onClickDeleteCategoryLink(){if(!this._oSelectedCategory)return;var a=new BtnDlg("divDelCtg",htmlEnc(this._oStringDiv.getAttribute("L_CnfDlt"))+"<br><br>"+htmlEnc(this._oStringDiv.getAttribute("L_ExpDlt")),this._oStringDiv.getAttribute("L_DltCtg"),[L_OK,L_Cncl],388,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this._onDeleteCategoryDialogClose));a.show();return false};Owa.UIControls.ManageCategoriesDialog.prototype._onDeleteCategoryDialogClose=function Owa$UIControls$ManageCategoriesDialog$prototype$_onDeleteCategoryDialogClose(a){if(a==-1||a==1)return;var b=new oeReq("Cat","DltCtg",0,this._createCallback(this._onCategoryDeleted));b.add("nm",this._getCategoryName(this._oSelectedCategory));b.send()};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryDeleted=function Owa$UIControls$ManageCategoriesDialog$prototype$_onCategoryDeleted(b){if(!cbOeh(b))return;var a=this._oSelectedCategory.get_NextSibling()||this._oSelectedCategory.get_PreviousSibling();this._oSelectedCategory.remove(true);this._oSelectedCategory=null;a&&this._selectCategory(a)};Owa.UIControls.ManageCategoriesDialog.prototype._onButtonDialogClose=function Owa$UIControls$ManageCategoriesDialog$prototype$_onButtonDialogClose(){Owa.UIControls.CategoryMenu.removeInstance()};Owa.UIControls.ManageCategoriesDialog.prototype._selectCategory=function Owa$UIControls$ManageCategoriesDialog$prototype$_selectCategory(a){this._oSelectedCategory&&this._oSelectedCategory.removeCssClass("sel");a.addCssClass("sel");this._oSelectedCategory=a};Owa.UIControls.ManageCategoriesDialog.prototype._getCategoryName=function Owa$UIControls$ManageCategoriesDialog$prototype$_getCategoryName(a){var b=a.getAttribute("title")||a.get_TextContent();return b.trim()};Owa.UIControls.ManageCategoriesDialog.loadInstanceAndShow=function Owa$UIControls$ManageCategoriesDialog$loadInstanceAndShow(){if(b)return;var a=new oeReq("Cat","MngCtgs",0,cbLoadInstanceAndShow);a.send();b=1};Owa.UIControls.ManageCategoriesDialog._get_Instance=function Owa$UIControls$ManageCategoriesDialog$_get_Instance(){return a};function cbLoadInstanceAndShow(c){b=0;if(!cbOeh(c))return;a=null;a=new Owa.UIControls.ManageCategoriesDialog(c);a.show()}})();g_fModuleLoaded[".\\uicontrols/managecategoriesdialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/categorymenu.js".toLowerCase()]&&(function(){Owa.CATEGORY_STATE={UNCHECKED:0,PARTIAL:1,CHECKED:2};var b=null,e=["chk-unchk.gif","chk-prtl.gif","chk-chkd.gif"];Owa.UIControls.CategoryMenu=function Owa$UIControls$CategoryMenu(a){Owa.UIControls.CategoryMenu.constructBase(this);this.set_SubPage(a);this.get_OnDataBind().add(this._createCallback(this._applyStates));this.get_OnPreShow().add(this._createCallback(this._onPreShow));this.get_OnSelect().add(this._createCallback(this._onSelect));this.get_OnClose().add(this._createCallback(this._onClose))};Owa.UIControls.CategoryMenu.createClass("Owa.UIControls.CategoryMenu",Owa.UIControls.LazyLoadContextMenu);var a=Owa.UIControls.CategoryMenu.prototype;a.set_ItemType=function Owa$UIControls$CategoryMenu$set_ItemType(a){this._iItemType=a};a.get_ItemType=function Owa$UIControls$CategoryMenu$get_ItemType(){return this._iItemType};a.set_FolderId=function Owa$UIControls$CategoryMenu$set_FolderId(a){this._sFolderId=a};a.get_FolderId=function Owa$UIControls$CategoryMenu$get_FolderId(){return this._sFolderId};a._reset=function Owa$UIControls$CategoryMenu$_reset(){if(this._resetting)return;this._resetting=1;try{this.get_IsShown()&&this.close();this.get_OnChangeCategory().clear();this.get_OnClearCategory().clear();this.set_ItemType(null);this.set_FolderId(null)}finally{this._resetting=0}};a.updateStates=function Owa$UIControls$CategoryMenu$updateStates(e,h){this._oCategoryButton=h;for(var g=e.length,a={},c=0;c<g;c++)for(var f=e[c],d=0;d<f.length;d++){var b=f[d].trim();if(!a[b])a[b]=0;a[b]++}this._rgCategoryStates={};this._iCategoryCount=0;for(var b in a){this._rgCategoryStates[b]=a[b]==g?Owa.CATEGORY_STATE.CHECKED:Owa.CATEGORY_STATE.PARTIAL;this._iCategoryCount++}};a._applyStates=function Owa$UIControls$CategoryMenu$_applyStates(){if(!this._rgCategoryStates)return;for(var c=this._get_Element(),b=0;b<this._rgAllMenuItems.length;b++){var a=this._rgAllMenuItems[b];if(!isCategoryMenuItem(a,c))continue;var e=getCategoryNameOfMenuItem(a,c),d=this._rgCategoryStates[e]||Owa.CATEGORY_STATE.UNCHECKED;this._setMenuItemState(a,d)}this.enableMenuItemByCommand("clr",this._iCategoryCount!=0)};a._setMenuItemState=function Owa$UIControls$CategoryMenu$_setMenuItemState(b,a){b.setIntAttribute("iState",a);Owa.Components.CssSprites.updateImage(b.getDescendantById("imgI"),e[a])};a._onPreShow=function Owa$UIControls$CategoryMenu$_onPreShow(){this._oCategoryButton&&this._oCategoryButton.set_IsPushed(true)};a._onSelect=function Owa$UIControls$CategoryMenu$_onSelect(c){var b=c.sCommand,e=c.oMenuItem;this._sLatestCommand=b;if(b=="mng"){Owa.UIControls.ManageCategoriesDialog.loadInstanceAndShow();return}if(b=="clr"){this._dispatchEvent(d);return}var a;if(getMenuItemState(e)==Owa.CATEGORY_STATE.CHECKED)a=Owa.CATEGORY_STATE.UNCHECKED;else a=Owa.CATEGORY_STATE.CHECKED;this._setMenuItemState(e,a);return 1};a._onClose=function Owa$UIControls$CategoryMenu$_onClose(){addPerfMarker("CategoryMenu.OnClose.Start");this._oCategoryButton&&this._oCategoryButton.set_IsPushed(false);if(!this._sLatestCommand||this._sLatestCommand=="clr"){this._sLatestCommand=null;return}for(var d=[],e=[],g=this._get_Element(),f=0;f<this._rgAllMenuItems.length;++f){var b=this._rgAllMenuItems[f];if(!isCategoryMenuItem(b,g))continue;var a=getCategoryNameOfMenuItem(b,g),i=this._rgCategoryStates[a]||Owa.CATEGORY_STATE.UNCHECKED,h=getMenuItemState(b);if(i!=h)if(h==Owa.CATEGORY_STATE.CHECKED)d.push(a);else e.push(a)}if(!d.length&&!e.length)return;this._dispatchEvent(c,{rgAdd:d,rgRem:e});this._reset()};a._createLoadHtmlContentRequest=function Owa$UIControls$CategoryMenu$_createLoadHtmlContentRequest(b){var a=new oeReq("Cat","gtCM",null,b,GET);this._sFolderId&&a.add("fId",this._sFolderId);a.add("typ",this._iItemType);return a};Owa.UIControls.CategoryMenu.get_Instance=function Owa$UIControls$CategoryMenu$get_Instance(a){if(!b)b=this.createInstance();a&&b._reset();return b};Owa.UIControls.CategoryMenu.createInstance=function Owa$UIControls$CategoryMenu$createInstance(){b=new Owa.UIControls.CategoryMenu(Owa.Components.Application.get_RootSubPage());return b};Owa.UIControls.CategoryMenu.removeInstance=function Owa$UIControls$CategoryMenu$removeInstance(){if(!b)return;b._get_Element().remove(true);b.dispose();b=null};function getMenuItemState(a){return a.getIntAttribute("iState")}function isCategoryMenuItem(b,a){return!!getCategoryNameOfMenuItem(b,a)}function getCategoryNameOfMenuItem(d,c){var a=null,b=d.getAttribute("cmd");if(b)a=b.substr(c.getAttribute("sPfx").length);return a}var c="onChangeCategory",d="onClearCategory";a.get_OnChangeCategory=function Owa$UIControls$CategoryMenu$get_OnChangeCategory(){return this._getEventHandlerCollection(c)};a.get_OnClearCategory=function Owa$UIControls$CategoryMenu$get_OnClearCategory(){return this._getEventHandlerCollection(d)}})();g_fModuleLoaded[".\\uicontrols/categorymenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/copymovecontextmenu.js".toLowerCase()]&&(function(){Owa.UIControls.CopyMoveContextMenu=function Owa$UIControls$CopyMoveContextMenu(){Owa.UIControls.CopyMoveContextMenu.constructBase(this);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow));this.fCopyItemVisible=true};var c=0,a=null,b=null,d=-1;Owa.UIControls.CopyMoveContextMenu.get_Instance=function Owa$UIControls$CopyMoveContextMenu$get_Instance(){if(a){var c=null,d=getCSVAsStr(CSV_MRU_UPD_DT);if(d)c=new Date(Date.parse(d));if(c&&b&&b.eThn(c)){a.dispose();a=null}}if(!a)a=new Owa.UIControls.CopyMoveContextMenu;return a};Owa.UIControls.CopyMoveContextMenu.prototype.set_CopyMoveButton=function Owa$UIControls$CopyMoveContextMenu$set_CopyMoveButton(a){this._oCopyMoveButton=a};Owa.UIControls.CopyMoveContextMenu.prototype.set_OnTargetFolderSelected=function Owa$UIControls$CopyMoveContextMenu$set_OnTargetFolderSelected(a){this._fnCallback=a};Owa.UIControls.CopyMoveContextMenu.prototype.set_ViewType=function Owa$UIControls$CopyMoveContextMenu$set_ViewType(a){this._viewType=a};Owa.UIControls.CopyMoveContextMenu.prototype._onSelectMenuItem=function Owa$UIControls$CopyMoveContextMenu$_onSelectMenuItem(g){var d=g.sCommand,h=g.oMenuItem,b=0,e,f;if(d=="MvToMruF")this._fnCallback&&this._fnCallback(h.get_Id().substring(1),false,h.getAttribute("sT"),0);else if(d=="MvToF"){b=1;e=L_Mv;f=L_MvToFld}else if(d=="CpToF"){b=1;e=L_Cp;f=L_CpToFld}if(b){var a=Owa.UIControls.FolderPickerDialog.get_Default();a.set_IsShowPublicFolder(true);a.set_ButtonCaptions([e]);a.set_Title(f);a.set_IsShowArchiveFolder(this._viewType==c);a.onButtonClick=cbCopyMoveItem;a.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;if(this._fnCallback)cbCopyMoveItem.fnCallback=this._fnCallback;a.show()}};Owa.UIControls.CopyMoveContextMenu.prototype.set_CopyItemVisible=function Owa$UIControls$CopyMoveContextMenu$set_CopyItemVisible(a){this.fCopyItemVisible=a};Owa.UIControls.CopyMoveContextMenu.prototype.displayArchiveMenuItems=function Owa$UIControls$CopyMoveContextMenu$displayArchiveMenuItems(f){for(var b=this.getAllMenuItems(),a=0;a<b.length;a++){var c=b[a],d=c.get_Id().substr(1),e=d.split(Owa.Utility.OwaPrefixes.SeparatorChar);e[0]==Owa.Utility.OwaPrefixes.ArchiveMailboxObjectPrefix&&this.showMenuItem(c.get_Id(),f)}};Owa.UIControls.CopyMoveContextMenu.prototype.show=function Owa$UIControls$CopyMoveContextMenu$show(b,d,a){if(this.get_IsDomElementLoaded()){this.showMenuItem("divCopyToFolder",this.fCopyItemVisible);this.displayArchiveMenuItems(this._viewType==c)}Owa.UIControls.CopyMoveContextMenu.callBase(this,"show",[b,d,a])};Owa.UIControls.CopyMoveContextMenu.prototype._onClose=function Owa$UIControls$CopyMoveContextMenu$_onClose(){this._oCopyMoveButton&&this._oCopyMoveButton.set_IsPushed(false)};Owa.UIControls.CopyMoveContextMenu.prototype._onPreShow=function Owa$UIControls$CopyMoveContextMenu$_onPreShow(){this._oCopyMoveButton&&this._oCopyMoveButton.set_IsPushed(true)};Owa.UIControls.CopyMoveContextMenu.prototype._initializeDomElement=function Owa$UIControls$CopyMoveContextMenu$_initializeDomElement(a){b=new Date;Owa.UIControls.CopyMoveContextMenu.callBase(this,"_initializeDomElement",[a])};Owa.UIControls.CopyMoveContextMenu.prototype._createLoadHtmlContentRequest=function Owa$UIControls$CopyMoveContextMenu$_createLoadHtmlContentRequest(a){return new oeReq("MsgVLV2","GetCopyMoveMenu",0,a)};Owa.UIControls.CopyMoveContextMenu.createClass("Owa.UIControls.CopyMoveContextMenu",Owa.UIControls.LazyLoadContextMenu)})();g_fModuleLoaded[".\\uicontrols/copymovecontextmenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/monthpicker.js".toLowerCase()]&&(function(){var c="onMonthSelected",d=41,b="monthlyPickerSelected";Owa.UIControls.MonthPicker=function MonthPicker(b,a){Owa.UIControls.MonthPicker.constructBase(this,[b]);this.iCM=this._getIntAttribute("_cm");this.iCY=this._getIntAttribute("_cy");this.iShwY=this.iCY;this.selYM(this.iCY,this.iCM,1);this._attachEvent(this._get_Element(),"click",this._onClick);this._getEventHandlerCollection(c).add(a)};var a=Owa.UIControls.MonthPicker.prototype;a._onClick=function Owa$UIControls$MonthPicker$_onClick(b){var a=b.get_Target();while(a&&a.get_TagName().toLowerCase()!="div"){a=a.get_ParentElement();if(a==this._get_Element()){a=null;break}}if(a)if(a.get_Id()=="divMonthPickerNext")this.rfrsh(this.iShwY+1);else if(a.get_Id()=="divMonthPickerPrevious")this.rfrsh(this.iShwY-1);else a.getIntAttribute("_m")&&this.selYM(this.iShwY,a.getIntAttribute("_m"));b.cancelBubble()};a.selYM=function Owa$UIControls$MonthPicker$selYM(a,b,d){if((!a||this.iSY==a&&this.iShwY==a)&&(!b||this.iSM==b))return;if(a)this.iSY=a;if(b)this.iSM=b;this.rfrsh();!d&&this._dispatchEvent(c,this)};a.rfrsh=function Owa$UIControls$MonthPicker$rfrsh(a){if(!a)a=this.iSY;this.iShwY=a;var f=this._getDescendant("spnMpDt");f.set_TextContent(a.toString());function stCelFlg(e,d,c){var a=["monthPickerCell","fltBefore"];d&&a.push("monthlyPickerToday");c&&a.push(b);e.set_CssClasses(a)}for(var d=this._get_Element().getDescendantsByTagName("div"),c=0;c<d.length;c++){var e=d[c].getIntAttribute("_m");e&&stCelFlg(d[c],this.iCM==e&&this.iCY==a,this.iSM==e&&this.iSY==a)}};a.shw=function Owa$UIControls$MonthPicker$shw(j){var f=this._get_Element();f.set_IsShown(!j);var c=f.getDescendantsByTagName("div"),e=d;if(!j&&!this.resized){for(var a=0;a<c.length;a++){var i=c[a].getIntAttribute("_m");if(i){var g=c[a].hasCssClass(b);!g&&c[a].addCssClass(b);var h=c[a].get_ScrollWidth();!g&&c[a].removeCssClass(b);if(h>e)e=h}}for(var a=0;a<c.length;a++){var i=c[a].getIntAttribute("_m");i&&c[a].set_Width(e)}var k=3;f.set_Width((e+2)*k+e/2);this.resized=true}};a.getSelDts=function Owa$UIControls$MonthPicker$getSelDts(){return new Array(toDate(this.iSY,this.iSM,1))};Owa.UIControls.MonthPicker.createClass("Owa.UIControls.MonthPicker",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/monthpicker.js".toLowerCase()]=1;var DP_DAY=1,DP_WK=2,DP_WWK=3,DP_MTH=4;!g_fModuleLoaded[".\\uicontrols/DatePicker.js".toLowerCase()]&&(function(){var j=1,c=2,m=4,l=8,d=16;window.UNSEL="us";window.SEL="s";var n="dpSel",p=7;Owa.UIControls.DatePicker=function DatePicker(e,b,c,d){this.fDisableMonthList=d;Owa.UIControls.DatePicker.constructBase(this,[e]);this.iMode=DP_DAY;this._rgMonthLists={};var a=this._get_Element().get_FirstChild();this.dt=toDate(a.getAttribute("y"),a.getAttribute("m"),1);this._iFeatureMask=this._getIntAttribute("ui");this.workWeekMask=this._getIntAttribute("ww");b&&this.get_OnDateSelection().add(b);c&&this.get_OnMonthNavigate().add(c);this.initM(a)};var a=Owa.UIControls.DatePicker.prototype;a.dispose=function Owa$UIControls$DatePicker$dispose(){for(var a=this._get_Element().get_Enumerator();a.moveNext();)a.get_Current().hasCssClass("dpMonth")&&this.dispM(a.get_Current());Owa.UIControls.DatePicker.callBase(this,"dispose")};a.shw=function Owa$UIControls$DatePicker$shw(a){this._get_Element().set_IsShown(a?false:true)};a.navM=function Owa$UIControls$DatePicker$navM(b,e,c){var d=this.getM(b),a=e;if(!a){a=this.getSelDts();c=0}if(d==null)this._rndrM(b,a,c);else{this.getM(this.dt).set_IsShown(false);d.set_IsShown(true);this.oDivMnthLst=this._rgMonthLists[d.get_Id()];this.dt=b;this.restSel(a,c);this.adjustWidth();this._dispatchEvent(f,this)}};a.restSel=function Owa$UIControls$DatePicker$restSel(a,d){if(!a)return;if(a.push!=null)this.setSDs(a,1,d);else for(var e=this.getM(this.dt),b=0;b<6;b++){var c=e.getDescendantById("divWeek"+b).get_FirstChild();c.getIntAttribute("w")==a&&this.selW(c)}};a.setSDs=function Owa$UIControls$DatePicker$setSDs(a,f,e){!f&&this.unselAll();if(a)for(var c=0;c<a.length;c++){var d=this.findDy(a[c]);if(!d){if(!f){this.navM(a[c],a,e);return}}else this.selItem(d,1)}e&&this._dispatchEvent(b,this)};a.findDy=function Owa$UIControls$DatePicker$findDy(i,f){var b=0,h=0,g=7;if(this._iFeatureMask&(d|c)){++h;++g}if(!f)f=this.getM(this.dt);for(var e=0;e<6;e++){var a=f.getDescendantById("divWeek"+e).get_Enumerator(),b=0;while(a.moveNext()&&b<g){if(b>=h)if(cmpDy(this.getDayDt(a.get_Current()),i))return a.get_Current();b++}}};a.updateFb=function Owa$UIControls$DatePicker$updateFb(c,b){var a=this.getM(b);a.setAttribute("_fb",c);this.procDys([rFbUI],a)};a.updateSg=function Owa$UIControls$DatePicker$updateSg(c,b){var a=this.getM(b);a.setAttribute("_sg",c);this.procDys([rSgUI],a)};var g=["fb0","fb1"],o=[0,1,1,1,0];function rFbUI(b,d,c){for(var a=0;a<g.length;a++)b.removeCssClass(g[a]);b.addCssClass(g[o[getInt(d.getAttribute("_fb").charAt(c))]])}var e=["grt","gd","fr","por","sgNd"];function rSgUI(b,d,c){for(var a=0;a<e.length;a++)b.removeCssClass(e[a]);b.addCssClass(e[getInt(d.getAttribute("_sg").charAt(c))])}a.procDys=function Owa$UIControls$DatePicker$procDys(i,k){var j=0,a=0,f=0,b=7;if(this._iFeatureMask&(d|c)){f=1;b=8}for(var e=0;e<6;e++){for(a=f;a<b;a++);var h=k.getDescendantById("divWeek"+e).get_Enumerator(),a=0;while(h.moveNext()&&a<b){if(a>=f){for(var l=h.get_Current(),g=0;g<i.length;g++)i[g](l,k,j);j++}a++}}};a.getM=function Owa$UIControls$DatePicker$getM(a){return this._getDescendant("div"+(a.gmo()+1)+a.gyr())};a.isMChd=function Owa$UIControls$DatePicker$isMChd(a){return this.getM(a)!=null};a.onClkNP=function Owa$UIControls$DatePicker$onClkNP(c){var b=c.get_CurrentTarget(),a=toDate(b.getIntAttribute("y"),b.getIntAttribute("m"),1);if(!this.get_OnMonthNavigate().get_IsEmpty())this._dispatchEvent(h,a);else this.navM(a,0,0)};a.onMdMl=function Owa$UIControls$DatePicker$onMdMl(c){var a=c.get_Target();while(a&&!(a.hasCssClass&&a.hasCssClass("dpMnuItm")))a=a.get_ParentElement();if(!a||!a.getIntAttribute("m"))return;var b=toDate(a.getIntAttribute("y"),a.getIntAttribute("m"),1);if(b==this.dt)return;if(!this.get_OnMonthNavigate().get_IsEmpty())this._dispatchEvent(h,b);else this.navM(b,0,0);this._dispatchEvent(k,this);this.oDivMnthLst.set_IsShown(false)};a.onClkD=function Owa$UIControls$DatePicker$onClkD(c){var a=c.get_CurrentTarget();if(a.getAttribute("w")!=null)return;if((c.isShiftKeyDown()||c.isCtrlKeyDown())&&j&this._iFeatureMask){var d=this.getSelDts();if(a.get_Id()==SEL){if(1<d.length){this.unselItem(a);this.iMode=DP_DAY}}else if(d.length!=p){this.selItem(a,1);this.iMode=DP_DAY}}else{this.unselAll();switch(this.iMode){case DP_DAY:this.selItem(a,1);break;case DP_WK:this.selW(a);break;case DP_WWK:this.selWW(a);break;case DP_MTH:this.selItem(a,1);this.iMode=DP_DAY}}this._dispatchEvent(b,this)};a.onClkW=function Owa$UIControls$DatePicker$onClkW(a){if(!(this._iFeatureMask&j))return;this.selW(a.get_CurrentTarget());this._dispatchEvent(b,this)};a.selW=function Owa$UIControls$DatePicker$selW(d){this.unselAll();for(var b=d.get_ParentElement(),c=b.getChildrenSnapshot(),a=1;a<8;a++)this.selItem(c[a],1);this.iMode=DP_WK};a.selWW=function Owa$UIControls$DatePicker$selWW(d){this.unselAll();for(var b=d.get_ParentElement(),c=b.getChildrenSnapshot(),a=1;a<8;a++)this.workWeekMask>>a-1&1&&this.selItem(c[a],1);this.iMode=DP_WWK};a.getSelDts=function Owa$UIControls$DatePicker$getSelDts(){for(var d=this.getDyCells(this._get_Element(),SEL),a=[],b=0;b<d.length;b++)if(!d[b].getIntAttribute("w")){for(var e=this.getDayDt(d[b]),c=0;c<a.length;c++)if(a[c].toString()==e.toString())break;c==a.length&&a.push(e)}if(a.length==0)return null;if(!(j&this._iFeatureMask))a=a[0];return a};a.setM=function Owa$UIControls$DatePicker$setM(a,b){this.getM(this.dt).set_IsShown(false);if(this.getM(a)){this.oDivMnthLst=this._rgMonthLists[this.getM(a).get_Id()];return}this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b);this.dt=a;this.initM(b)};a.initM=function Owa$UIControls$DatePicker$initM(a){this._attachEvent(a.getDescendantById("imgNext"),"click",this.onClkNP);this._attachEvent(a.getDescendantById("imgPrev"),"click",this.onClkNP);var g=7,h=0;if(this._iFeatureMask&(d|c)){h=1;g=8}for(var e=0;e<6;e++){var o=a.getDescendantById("divWeek"+e),f=o.getChildrenSnapshot();this._iFeatureMask&(d|c)&&this._attachEvent(f[0],"click",this.onClkW);for(var b=h;b<g;b++)this._attachEvent(f[b],"click",this.onClkD)}if(this._iFeatureMask&m){var n=a.getDescendantById("divToday");this._attachEvent(n,"click",this.onClkB)}if(this._iFeatureMask&l){var k=a.getDescendantById("divNone");this._attachEvent(k,"click",this.onClkB)}if(!this.fDisableMonthList){this._attachEvent(a.getDescendantById("spanDate"),"mousedown",this.onMdDh);this._attachEvent(a.getDescendantById("spanMonthListDropDown"),"mousedown",this.onMdDh)}else{var j=a.getDescendantById("spanDate");j._get_DomNode().style.cursor="default";var i=a.getDescendantById("imgDropDwn");i.set_IsShown(false)}this.oDivMnthLst=a.getDescendantById("divMnthLst");this._attachEvent(this.oDivMnthLst,"mousedown",this.onMdMl);this._attachEvent(this.oDivMnthLst,"mouseout",this.onMOutML);this.oDivMnthLst.set_PositionalParent(this._get_Element().get_OwnerDocument().get_Body());this._rgMonthLists[a.get_Id()]=this.oDivMnthLst;this.adjustWidth()};a.dispM=function Owa$UIControls$DatePicker$dispM(a){a.getDescendantById("imgNext").detachAllEvents();a.getDescendantById("imgPrev").detachAllEvents();for(var c=0;c<6;c++)for(var e=a.getDescendantById("divWeek"+c),d=e.getChildrenSnapshot(),b=0;b<d.length;b++)d[b].detachAllEvents();this._iFeatureMask&m&&a.getDescendantById("divToday").detachAllEvents();this._iFeatureMask&l&&a.getDescendantById("divNone").detachAllEvents();if(!this.fDisableMonthList){a.getDescendantById("spanDate").detachAllEvents();a.getDescendantById("spanMonthListDropDown").detachAllEvents()}this._rgMonthLists[a.get_Id()].detachAllEvents()};a.onClkB=function Owa$UIControls$DatePicker$onClkB(b){var a=b.get_CurrentTarget();if(a.get_Id()=="divToday")this.setSDs(new Array(toDate(a.getIntAttribute("y"),a.getIntAttribute("m"),a.getIntAttribute("d"))),0,1);else this.setSDs(null,0,1)};Owa.UIControls.DatePicker.prototype.adjustWidth=function Owa$UIControls$DatePicker$adjustWidth(){var c=this.getM(this.dt),a=0,b=c.getDescendantById("divDpHdr");b.forEachChild(function(b){a+=b.get_OffsetWidth();a+=b._getEffectiveMargin(Owa.Style.Side.Left,false)+b._getEffectiveMargin(Owa.Style.Side.Right,false)});a+=b.getEffectiveMargin(Owa.Style.Side.Left)+b.getEffectiveMargin(Owa.Style.Side.Right);this._get_Element().set_Width(a)};a.onMOutML=function Owa$UIControls$DatePicker$onMOutML(c){var a=c.get_Target();while(a!=null&&a.get_Id()!="divMnthLst")a=a.get_ParentElement();var b=c.get_ToElementForMouseOut();while(b!=null&&b.get_Id()!="divMnthLst")b=b.get_ParentElement();if(b!=null&&b.get_Id||a==null)return;a.set_IsShown(false);c.cancelBubble()};a.onMdDh=function Owa$UIControls$DatePicker$onMdDh(e){var f=this.getM(this.dt);this.oDivMnthLst.set_IsShown(true);if(!this.oDivMnthLst.getBoolAttribute("fWidthAddjusted")){var c=0;this.oDivMnthLst.forEachChild(function(b){var a=b.get_OffsetWidth();if(a>c)c=a});this.oDivMnthLst.set_Width(c);this.oDivMnthLst.setBoolAttribute("fWidthAddjusted",true);if(Owa.Utility.isIE()){this.oDivMnthLst.set_IsShown(false);this.oDivMnthLst.set_IsShown(true)}}var b=this.oDivMnthLst.get_OffsetHeight()*(-3/7),a=e.get_Target();while(a&&a.get_Id()!="divDpHdr")a=a.get_ParentElement();var d=a.get_DocumentLeft();b+=f.get_DocumentTop();if(b<0)b=0;if(d<0)d=0;this.oDivMnthLst.set_Top(b);this.oDivMnthLst.set_Left(d);this.oDivMnthLst.moveToTop()};a.selItem=function Owa$UIControls$DatePicker$selItem(a,b){if(a.get_Id()==SEL)return;a.set_Id(SEL);b&&a.addCssClass(n)};a.unselItem=function Owa$UIControls$DatePicker$unselItem(d){if(d.get_Id()==UNSEL)return;function unsel(a){a.set_Id(UNSEL);a.removeCssClass(n)}unsel(d);var b=new Date(this.dt);b.smo(b.gmo()+1);var e=this.getDayDt(d),c=this.getM(b),a=0;if(c){a=this.findDy(e,c);a&&unsel(a)}b.smo(b.gmo()-2);c=this.getM(b);a=0;if(c){a=this.findDy(e,c);a&&unsel(a)}};a.unselAll=function Owa$UIControls$DatePicker$unselAll(c){for(var b=this.getDyCells(c?c:this._get_Element(),SEL),a=0;a<b.length;++a)this.unselItem(b[a])};a.getDayDt=function Owa$UIControls$DatePicker$getDayDt(b){var a=b;while(a){if(a.hasCssClass("dpMonth"))break;a=a.get_ParentElement()}var d=a.getIntAttribute("y"),c=a.getIntAttribute("m");if(b.getAttribute("y"))d=b.getIntAttribute("y");if(b.getAttribute("m"))c=b.getIntAttribute("m");var e=b.get_TextContent();return toDate(d,c,getInt(e))};a.getDyCells=function Owa$UIControls$DatePicker$getDyCells(e,d){var a=e.getAllDescendantsById(d),c=[];if(a)if(a.length==null)c[0]=a;else for(var b=0;b<a.length;++b)c[b]=a[b];return c};a._rndrM=function Owa$UIControls$DatePicker$_rndrM(c,f,e){if(this.fBsy)return;this.fBsy=1;var a={};a.dtM=c;a.fE=e;a.oS=f;var d=isDf(typeof a_sEscapedPath)?a_sEscapedPath:null,b=new oeReq("DatePicker","RenderMonth",a,this._createCallback(this._cbRndrM),GET,d);b.add("m",c);b.add("uF",this._iFeatureMask);b.send()};a._cbRndrM=function Owa$UIControls$DatePicker$_cbRndrM(a){if(a.fST){popLgn();return}var b=a.oCtx;this.fBsy=0;if(a.sErr){if(!this.get_OnError().get_IsEmpty())this._dispatchEvent(i,a,1);else shwErrDlg(a);return}var d=this._get_Element().get_OwnerDocument(),c=d.createElement("div");c.set_InnerHtml(a.sBody);this.setM(b.dtM,c.get_FirstChild());this.restSel(b.oS,b.fE);this._dispatchEvent(f,this);this._dispatchEvent(i,a,0)};var i="error",b="dateSelection",h="monthNavigate",f="afterMonthNavigate",k="afterMonthListSelected";a.get_OnError=function Owa$UIControls$DatePicker$get_OnError(){return this._getEventHandlerCollection(i)};a.get_OnDateSelection=function Owa$UIControls$DatePicker$get_OnDateSelection(){return this._getEventHandlerCollection(b)};a.get_OnMonthNavigate=function Owa$UIControls$DatePicker$get_OnMonthNavigate(){return this._getEventHandlerCollection(h)};a.get_OnAfterMonthNavigate=function Owa$UIControls$DatePicker$get_OnAfterMonthNavigate(){return this._getEventHandlerCollection(f)};a.get_OnAfterMonthListSelected=function Owa$UIControls$DatePicker$get_OnAfterMonthListSelected(){return this._getEventHandlerCollection(k)};Owa.UIControls.DatePicker.createClass("Owa.UIControls.DatePicker",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/DatePicker.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/DatePickerDropDown.js".toLowerCase()]&&(function(){var a="onchange";Owa.UIControls.DatePickerDropDown=function(a,b){Owa.UIControls.DatePickerDropDown.constructBase(this,[a,b]);this._oDatePicker=null};Owa.UIControls.DatePickerDropDown.prototype.initialize=function Owa$UIControls$DatePickerDropDown$prototype$initialize(){Owa.UIControls.DatePickerDropDown.callBase(this,"initialize");var a=this._getDescendant(this._get_Parent().get_Id()+"DP");this._oDatePicker=new Owa.UIControls.DatePicker(a,this._createCallback(this._onChanged));this._oDatePicker.set_SubPage(this.get_SubPage());this._oDatePicker.get_OnAfterMonthListSelected().add(this._createCallback(this._onAfterMonthListSelected));this.get_OnPreShow().add(this._createCallback(this._onPreShow));fmtDt.rgAbrDN=eval(this._oDatePicker._getAttribute("rgAbrDN"));fmtDt.rgAbrMN=eval(this._oDatePicker._getAttribute("rgAbrMN"));fmtDt.rgFulDN=eval(this._oDatePicker._getAttribute("rgFulDN"));fmtDt.rgFulMN=eval(this._oDatePicker._getAttribute("rgFulMN"))};Owa.UIControls.DatePickerDropDown.prototype.dispose=function Owa$UIControls$DatePickerDropDown$prototype$dispose(){Owa.UIControls.DatePickerDropDown.callBase(this,"dispose")};Owa.UIControls.DatePickerDropDown.prototype.get_OnChange=function Owa$UIControls$DatePickerDropDown$prototype$get_OnChange(){return this._getEventHandlerCollection(a)};Owa.UIControls.DatePickerDropDown.prototype._onKeyDown=function Owa$UIControls$DatePickerDropDown$prototype$_onKeyDown(a){a.get_KeyCodeForKeyUpDown()==9&&this.close()};Owa.UIControls.DatePickerDropDown.prototype._onChanged=function Owa$UIControls$DatePickerDropDown$prototype$_onChanged(){this._dispatchEvent(a,this);this.close()};Owa.UIControls.DatePickerDropDown.prototype._onAfterMonthListSelected=function Owa$UIControls$DatePickerDropDown$prototype$_onAfterMonthListSelected(){this._suppressClose(true)};Owa.UIControls.DatePickerDropDown.prototype._onPreShow=function Owa$UIControls$DatePickerDropDown$prototype$_onPreShow(){this._oDatePicker.adjustWidth()};Owa.UIControls.DatePickerDropDown.prototype.close=function Owa$UIControls$DatePickerDropDown$prototype$close(){this._oDatePicker.oDivMnthLst.set_IsShown(false);Owa.UIControls.DatePickerDropDown.callBase(this,"close")};Owa.UIControls.DatePickerDropDown.prototype.get_SelectedValue=function Owa$UIControls$DatePickerDropDown$prototype$get_SelectedValue(){return this._oDatePicker.getSelDts()};Owa.UIControls.DatePickerDropDown.prototype.hasValue=function Owa$UIControls$DatePickerDropDown$prototype$hasValue(a){return Date.isInstance(a)};Owa.UIControls.DatePickerDropDown.prototype.selectValue=function Owa$UIControls$DatePickerDropDown$prototype$selectValue(a){var b=a?[a]:null;this._oDatePicker.setSDs(b)};Owa.UIControls.DatePickerDropDown.createClass("Owa.UIControls.DatePickerDropDown",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/DatePickerDropDown.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/datecombobox.js".toLowerCase()]&&(function(){Owa.UIControls.DateComboBox=function Owa$UIControls$DateComboBox(a,b){Owa.UIControls.DateComboBox.constructBase(this,[a,b]);this._fSelectedValueCanBeNull=true};Owa.UIControls.DateComboBox.prototype._initializeDropDown=function Owa$UIControls$DateComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.DatePickerDropDown(this._getDescendant(Owa.Strings.Ids.DatePickerDropDown),this);this._oDropDownList.set_SubPage(this.get_SubPage());this._oDropDownList.initialize()};Owa.UIControls.DateComboBox.prototype._initializeSelection=function Owa$UIControls$DateComboBox$prototype$_initializeSelection(){this._selectValue(this._oDropDownList.get_SelectedValue())};Owa.UIControls.DateComboBox.prototype._renderSelectedValue=function Owa$UIControls$DateComboBox$prototype$_renderSelectedValue(){var a;if(!this._oSelectedValue)a=L_None;else a=fmtDt(this._oSelectedValue,this._getAttribute("sWkdDtFmt"));this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan).set_TextContent(a)};Owa.UIControls.DateComboBox.createClass("Owa.UIControls.DateComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/datecombobox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/PolicyContextMenuBase.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b="mtg-accept.gif",a="clear.gif";Owa.UIControls.PolicyContextMenuBase=function Owa$UIControls$PolicyContextMenuBase(a){Owa.UIControls.PolicyContextMenuBase.constructBase(this);this.set_SubPage(a);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));!Owa.Components.Application.get_ShouldExplicitDisposeResource()&&this._attachEvent(Owa.Dom.Window.get_Current(),"unload",this.dispose)};Owa.UIControls.PolicyContextMenuBase.prototype.dispose=function Owa$UIControls$PolicyContextMenuBase$dispose(){!Owa.Components.Application.get_ShouldExplicitDisposeResource()&&this._detachEvent(Owa.Dom.Window.get_Current(),"unload",this.dispose);Owa.UIControls.PolicyContextMenuBase.callBase(this,"dispose")};Owa.UIControls.PolicyContextMenuBase.prototype.set_LocalFolderId=function Owa$UIControls$PolicyContextMenuBase$set_LocalFolderId(a){this._sLocalFolderId=a};Owa.UIControls.PolicyContextMenuBase.prototype.set_SelectedIds=function Owa$UIControls$PolicyContextMenuBase$set_SelectedIds(a){if(!this._rgSelectedIds||a.length==1&&(this._rgSelectedIds.length!=1||a[0]!=this._rgSelectedIds[0]))this._markDirty();else a.length>1&&this._get_Element()&&this._uncheckAll();this._rgSelectedIds=a};Owa.UIControls.PolicyContextMenuBase.prototype._markDirty=function Owa$UIControls$PolicyContextMenuBase$_markDirty(){if(this._get_Element()){this._get_Element().remove(true);this._oElement=null}};Owa.UIControls.PolicyContextMenuBase.prototype._uncheckAll=function Owa$UIControls$PolicyContextMenuBase$_uncheckAll(){for(var c=this.getAllMenuItemIds(),b=0;b<c.length;b++)c[b]!="divS1"&&this.replaceMenuItemIcon(c[b],a)};Owa.UIControls.PolicyContextMenuBase.prototype._onSelectMenuItem=function Owa$UIControls$PolicyContextMenuBase$_onSelectMenuItem(a){var b=a.sCommand;if(b=="inheritPolicy")this._inheritPolicy();else this._applyPolicy(b);this._oParentPopup&&this._oParentPopup._fireOnSelect(a)};Owa.UIControls.PolicyContextMenuBase.prototype._createLoadHtmlContentRequest=function Owa$UIControls$PolicyContextMenuBase$_createLoadHtmlContentRequest(b){var a=this._createGetMenuReq(b);this._rgSelectedIds&&this._rgSelectedIds.length==1&&a.add("id",this._rgSelectedIds[0]);return a};Owa.UIControls.PolicyContextMenuBase.prototype._createGetMenuReq=function Owa$UIControls$PolicyContextMenuBase$_createGetMenuReq(){throw Error("Not implemented");};Owa.UIControls.PolicyContextMenuBase.prototype._applyPolicy=function Owa$UIControls$PolicyContextMenuBase$_applyPolicy(){throw Error("Not implemented");};Owa.UIControls.PolicyContextMenuBase.prototype._inheritPolicy=function Owa$UIControls$PolicyContextMenuBase$_inheritPolicy(){throw Error("Not implemented");};Owa.UIControls.PolicyContextMenuBase.prototype._cbPolicyChanged=function Owa$UIControls$PolicyContextMenuBase$_cbPolicyChanged(a,d,f,e){if(!cbOeh(a,true))return;var c=d==this;if(c){if(a.isErr()){shwErrDlg(a);return}this._uncheckAll();this.replaceMenuItemIcon(e,b)}else this._markDirty()};Owa.UIControls.PolicyContextMenuBase.createClass("Owa.UIControls.PolicyContextMenuBase",Owa.UIControls.LazyLoadContextMenu)})();g_fModuleLoaded[".\\uicontrols/PolicyContextMenuBase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/deletepolicycontextmenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.DeletePolicyContextMenu=function Owa$UIControls$DeletePolicyContextMenu(a){Owa.UIControls.DeletePolicyContextMenu.constructBase(this,[a]);g_oEd.attachEvent("ApplyDeletePolicy",this,"_cbApplyDeletePolicy");g_oEd.attachEvent("InheritDeletePolicy",this,"_cbInheritDeletePolicy")};Owa.UIControls.DeletePolicyContextMenu.prototype.dispose=function Owa$UIControls$DeletePolicyContextMenu$dispose(){this.get_SubPage()._oDeletePolicyContextMenu=null;g_oEd.detachEvent("ApplyDeletePolicy",this,"_cbApplyDeletePolicy");g_oEd.detachEvent("InheritDeletePolicy",this,"_cbInheritDeletePolicy");Owa.UIControls.DeletePolicyContextMenu.callBase(this,"dispose")};Owa.UIControls.DeletePolicyContextMenu.get_Instance=function Owa$UIControls$DeletePolicyContextMenu$get_Instance(a){a=a||Owa.UIControls.SubPage.get_Instance();if(!a._oDeletePolicyContextMenu)a._oDeletePolicyContextMenu=new Owa.UIControls.DeletePolicyContextMenu(a);return a._oDeletePolicyContextMenu};Owa.UIControls.DeletePolicyContextMenu.prototype._createGetMenuReq=function Owa$UIControls$DeletePolicyContextMenu$_createGetMenuReq(a){return new oeReq("DeletePolicy","GetPolicyMenu",0,a,GET)};Owa.UIControls.DeletePolicyContextMenu.prototype._applyPolicy=function Owa$UIControls$DeletePolicyContextMenu$_applyPolicy(a){g_oPtgMgr.applyPolicy("DeletePolicy",this,this._rgSelectedIds,a,this._sLocalFolderId)};Owa.UIControls.DeletePolicyContextMenu.prototype._inheritPolicy=function Owa$UIControls$DeletePolicyContextMenu$_inheritPolicy(){g_oPtgMgr.inheritPolicy("DeletePolicy",this,this._rgSelectedIds,this._sLocalFolderId)};Owa.UIControls.DeletePolicyContextMenu.prototype._cbApplyDeletePolicy=function Owa$UIControls$DeletePolicyContextMenu$_cbApplyDeletePolicy(d,a,b,c){this._cbPolicyChanged(d,a,b,c)};Owa.UIControls.DeletePolicyContextMenu.prototype._cbInheritDeletePolicy=function Owa$UIControls$DeletePolicyContextMenu$_cbInheritDeletePolicy(c,a,b){this._cbPolicyChanged(c,a,b,"inheritPolicy")};Owa.UIControls.DeletePolicyContextMenu.createClass("Owa.UIControls.DeletePolicyContextMenu",Owa.UIControls.PolicyContextMenuBase)})();g_fModuleLoaded[".\\uicontrols/deletepolicycontextmenu.js".toLowerCase()]=1;var FA_None=0,FA_Dflt=1,FA_SpDt=7,FA_DtRem=8,FA_MrkCmpl=9,FA_ClrFlg=10;!g_fModuleLoaded[".\\uicontrols/flagcontextmenu.js".toLowerCase()]&&(function(){Owa.UIControls.FlagContextMenu=function Owa$UIControls$FlagContextMenu(a){Owa.UIControls.FlagContextMenu.constructBase(this);this.set_SubPage(a);this._iSelectCount=1;this._fConversation=false;this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow))};Owa.UIControls.FlagContextMenu.createClass("Owa.UIControls.FlagContextMenu",Owa.UIControls.LazyLoadContextMenu);var a=Owa.UIControls.FlagContextMenu.prototype;a.initialize=function Owa$UIControls$FlagContextMenu$initialize(){Owa.UIControls.FlagContextMenu.callBase(this,"initialize");this._iDefaultFlagAction=getInt(this._get_Element().getAttribute("iFlgDft"));!this._iFlagAction&&this.set_FlagAction(getInt(this._get_Element().getAttribute("iFA")));this._getMenuItem("divFA"+new String(FA_SpDt)).removeCssClass("cmDsbld");this._oDateCombo=new Owa.UIControls.DateComboBox(this._getDescendant("divFlgD"));this._oDateCombo.set_SubPage(this.get_SubPage());this._oDateCombo.initialize();this._oDateCombo.get_DropDownList().get_OnClose().add(this._createCallback(this._onDatePickerClose));this._oDateCombo.get_OnChange().add(this._createCallback(this._onDateComboValueChanged));this._oDateCombo.get_OnShow().add(this._createCallback(this._onDatePickerPreShow))};a.dispose=function Owa$UIControls$FlagContextMenu$dispose(){Owa.UIControls.FlagContextMenu.callBase(this,"dispose");this._oDateCombo&&this._oDateCombo.dispose()};a._reset=function Owa$UIControls$FlagContextMenu$_reset(){if(this._resetting)return;this._resetting=1;try{this.get_IsShown()&&this.close();this.get_OnSelectFlag().clear();this.set_SelectCount();this.set_FlagAction();this.set_ItemId();this.set_DueDate();this.set_IsSelectedItemTask();this.set_FlagButton()}finally{this._resetting=0}};a.set_SelectCount=function Owa$UIControls$FlagContextMenu$set_SelectCount(a){this._iSelectCount=a};a.set_FlagAction=function Owa$UIControls$FlagContextMenu$set_FlagAction(a){this._iFlagAction=a};a.set_ItemId=function Owa$UIControls$FlagContextMenu$set_ItemId(a){this._sItemId=a};a.set_DueDate=function Owa$UIControls$FlagContextMenu$set_ItemDueDate(a){this._sDueDate=a};a.set_IsSelectedItemTask=function Owa$UIControls$FlagContextMenu$set_IsSelectedItemTask(a){this._fIsSelectedItemTask=a};a.set_FlagButton=function Owa$UIControls$FlagContextMenu$set_FlagButton(a){this._oFlagButton=a};a.set_IsOnConversationHeader=function Owa$UIControls$FlagContextMenu$set_IsOnConversationHeader(a){this._fConversation=a};a._onPreShow=function Owa$UIControls$FlagContextMenu$_onPreShow(){this._oFlagButton&&this._oFlagButton.set_IsPushed(true);if(this._iFlagAction==FA_Dflt)this._iFlagAction=this._iDefaultFlagAction;this.enableMenuItemByCommand(new String(FA_DtRem),this._iSelectCount==1);if(this._iSelectCount==1){this._updateFlagIconSelection();this.enableMenuItemByCommand(new String(FA_ClrFlg),Owa.UIControls.FlagContextMenu.isFlagAction(this._iFlagAction)||this._iFlagAction==FA_MrkCmpl);this._oDateCombo.set_IsEnabled(true);this._sDueDate&&this._oDateCombo.set_SelectedValue(this._sDueDate,true);this.showMenuItem("divFlgDlt",this._fIsSelectedItemTask);this.showMenuItem("divFlgClr",!this._fIsSelectedItemTask);this.showMenuItem("divFlgClrDlt",false)}else{this.set_FlagAction(0);this._updateFlagIconSelection();this.showMenuItem("divFlgClrDlt",true);this.showMenuItem("divFlgDlt",false);this.showMenuItem("divFlgClr",false)}};a._updateFlagIconSelection=function Owa$UIControls$FlagContextMenu$_updateFlagIconSelection(){if(Owa.UIControls.FlagContextMenu.isFlagAction(this._iUISelectedFlagAction)){var b=this._getDescendant("divFA"+this._iUISelectedFlagAction),a=b.getDescendantById("spnImg");a.removeCssClass("sel");this._iUISelectedFlagAction=null}if(Owa.UIControls.FlagContextMenu.isFlagAction(this._iFlagAction)){var b=this._getDescendant("divFA"+this._iFlagAction),a=b.getDescendantById("spnImg");a.addCssClass("sel");this._iUISelectedFlagAction=this._iFlagAction}};a._onSelectMenuItem=function Owa$UIControls$FlagContextMenu$_onSelectMenuItem(a){var b=a.sCommand;this._onSelect(b,null)};a._onSelect=function Owa$UIControls$FlagContextMenu$_onSelect(a,g){if(typeof a=="string"&&a.startsW("d")){var b=getInt(a.substring(1));if(b==this._iDefaultFlagAction)return;var e=new oeReq("Flg","PFA",0,cbOeh);e.add("flga",b);e.send();var d=this._getDescendant("divDFA"+this._iDefaultFlagAction),h=d.getDescendantById("spnImg").getDescendantById("imgI"),d=this._getDescendant("divDFA"+b),f=d.getDescendantById("spnImg").getDescendantById("imgI");h.swap(f);this._iDefaultFlagAction=b}else{this.set_FlagAction(getInt(a));this._dispatchEvent(c,{sCommand:a,dtDate:g})}};a._onClose=function Owa$UIControls$FlagContextMenu$_onClose(){this._oFlagButton&&this._oFlagButton.set_IsPushed(false);this._reset()};a._onDatePickerPreShow=function Owa$UIControls$FlagContextMenu$_onDatePickerPreShow(){this._suppressClose(false)};a._onDatePickerClose=function Owa$UIControls$FlagContextMenu$_onDatePickerClose(){this._setTimeout(this._enableClose,1)};a._onDateComboValueChanged=function Owa$UIControls$FlagContextMenu$_onDateComboValueChanged(){this._onSelect(FA_SpDt,this._oDateCombo._oDropDownList.get_SelectedValue());this.close()};a._createLoadHtmlContentRequest=function Owa$UIControls$FlagContextMenu$_createLoadHtmlContentRequest(b){var a=new oeReq("Flg","gtFM",0,b,GET);this._sItemId&&a.add("id",this._sItemId);return a};var b;Owa.UIControls.FlagContextMenu.get_Instance=function Owa$UIControls$FlagContextMenu$get_Instance(a){if(!b)b=Owa.UIControls.FlagContextMenu._createInstance();a&&b._reset();return b};Owa.UIControls.FlagContextMenu._createInstance=function Owa$UIControls$FlagContextMenu$_createInstance(){b=new Owa.UIControls.FlagContextMenu(Owa.Components.Application.get_RootSubPage());return b};Owa.UIControls.FlagContextMenu.isFlagAction=function Owa$UIControls$FlagContextMenu$isFlagAction(a){return a&&a<=FA_SpDt};var c="onSelectFlag";a.get_OnSelectFlag=function Owa$UIControls$FlagContextMenu$get_OnSelectFlag(){return this._getEventHandlerCollection(c)}})();g_fModuleLoaded[".\\uicontrols/flagcontextmenu.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/startduedatecomboboxpaircontroller.js".toLowerCase()]&&(function(){Owa.Components.StartDueDateComboBoxPairController=function Owa$Components$StartDueDateComboBoxPairController(a,b){Owa.Components.StartDueDateComboBoxPairController.constructBase(this);this._oStartDateComboBox=a;this._oEndDateComboBox=b;a.get_OnChange().add(this._createCallback(this._onChangeStartDate));b.get_OnChange().add(this._createCallback(this._onChangeEndDate))};Owa.Components.StartDueDateComboBoxPairController.createClass("Owa.Components.StartDueDateComboBoxPairController",Owa.Components.Control);var a=Owa.Components.StartDueDateComboBoxPairController.prototype;a._onChangeStartDate=function Owa$Components$StartDueDateComboBoxPairController$_onChangeStartDate(){var a=this._oStartDateComboBox.get_SelectedValue(),b=this._oEndDateComboBox.get_SelectedValue();if(a&&!b)this._oEndDateComboBox.set_SelectedValue(a,true);else b<a&&this._oEndDateComboBox.set_SelectedValue(a,true)};a._onChangeEndDate=function Owa$Components$StartDueDateComboBoxPairController$_onChangeEndDate(){var b=this._oStartDateComboBox.get_SelectedValue(),a=this._oEndDateComboBox.get_SelectedValue();a<b&&this._oStartDateComboBox.set_SelectedValue(a,true)}})();g_fModuleLoaded[".\\components/startduedatecomboboxpaircontroller.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/flagdialog.js".toLowerCase()]&&(function(){Owa.UIControls.FlagDialog=function Owa$UIControls$FlagDialog(a,b){Owa.UIControls.FlagDialog.constructBase(this,["divFD",a,b,[L_OK,L_Cncl],300])};Owa.UIControls.FlagDialog.createClass("Owa.UIControls.FlagDialog",Owa.UIControls.ButtonDialog);var a=Owa.UIControls.FlagDialog.prototype;a.initialize=function Owa$UIControls$FlagDialog$initialize(){this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this._oStartCombo=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgSD"));this._oEndCombo=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgDD"));this._oStartCombo.set_SubPage(this.get_SubPage());this._oEndCombo.set_SubPage(this.get_SubPage());this._oStartCombo.initialize();this._oEndCombo.initialize();var b=new Owa.Components.StartDueDateComboBoxPairController(this._oStartCombo,this._oEndCombo),a=this._getDescendant("tblFlgRD");if(a){this._oReminderDate=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgRD"));this._oReminderDate.set_SubPage(this.get_SubPage());this._oReminderDate.initialize();this._oReminderDate.get_OnChange().add(this._createCallback(this._onReminderDateChange));this._oReminderTime=new Owa.UIControls.TimeComboBox(this._getDescendant("divFlgRT"));this._oReminderTime.set_SubPage(this.get_SubPage());this._oReminderTime.initialize();this._oReminderTime.get_OnChange().add(this._createCallback(this._onReminderTimeChange));this._attachEvent(this._getDescendant("chkRM"),"click",this._updateReminderCombosState);this._updateReminderCombosState()}};a.dispose=function Owa$UIControls$FlagDialog$dispose(){this._oStartCombo.dispose();this._oEndCombo.dispose();this._oReminderDate&&this._oReminderDate.dispose();this._oReminderTime&&this._oReminderTime.dispose();Owa.UIControls.FlagDialog.callBase(this,"dispose")};a._onButtonDialogClose=function Owa$UIControls$FlagDialog$_onButtonDialogClose(k){b=null;if(k!=0)return;var a=new oeReq("Flg","dtRm",{onFlagDialogValueSet:g},cbFlagDialogValueSet);if(!f){isDf(typeof c)&&c&&a.add("fldrId",c);a.add("typ",h)}else{a.add("id",f);d&&a.add("ck",d)}var j=this._oStartCombo.get_SelectedValue();j&&a.add("sdt",j);var i=this._oEndCombo.get_SelectedValue();i&&a.add("ddt",i);var e=this._getDescendant("chkRM");e&&e.get_IsChecked()&&a.add("rem",this._oReminderTime.get_SelectedValue());a.send()};function cbFlagDialogValueSet(a){if(!cbOeh(a))return;eval(a.sBody);if(!iError)a.oCtx.onFlagDialogValueSet(iFA,sId,sCK,sIBMsg,dtDD)}a._onReminderDateChange=function Owa$UIControls$FlagDialog$_onReminderDateChange(){var a=cpyDt(this._oReminderDate.get_SelectedValue(),new Date(this._oReminderTime.get_SelectedValue()));this._oReminderTime.set_SelectedValue(a,true)};a._onReminderTimeChange=function Owa$UIControls$FlagDialog$_onReminderTimeChange(){this._oReminderDate.set_SelectedValue(this._oReminderTime.get_SelectedValue(),true)};a._updateReminderCombosState=function Owa$UIControls$FlagDialog$_updateReminderCombosState(){var a=this._getDescendant("chkRM").get_IsChecked();this._oReminderDate.set_IsEnabled(a);this._oReminderTime.set_IsEnabled(a);var b=this._getDescendant("divFlgRT").getDescendantById("txtTime");b.set_IsDisabled(!a)};var b=null,e=false,f,d,c,h,g;Owa.UIControls.FlagDialog.loadInstanceAndShow=function Owa$UIControls$FlagDialog$loadInstanceAndShow(j,a,l,k,m){if(e||b)return;f=a;d=l;c=k;h=m;g=j;var i=new oeReq("Flg","gtFD",null,cbGetFlagDialog,GET);a&&i.add("id",a);isDf(typeof a_sFldId)&&a_sFldId&&i.add("fldrId",a_sFldId);i.send();e=1};function cbGetFlagDialog(a){e=0;if(!cbOeh(a))return;eval(a.sBody);b=new Owa.UIControls.FlagDialog(sD,sDT);b.initialize();b.show()}})();g_fModuleLoaded[".\\uicontrols/flagdialog.js".toLowerCase()]=1;function CtxMnu(a,f,k,i,e,j,b,g){a.fnOnSel=f;a.fnOnHid=k;a.fnOnBfHid=j;a.fnOnShw=g;a.show=ctxMnuShw;a.hide=ctxMnuHd;a.getCMW=ctxMnuGetCMW;if(!i)a.onfocusout=ctxMnuOnFcsO;attchEvt(a,"click",ctxMnuOnClk);a.oncontextmenu=new Function("return(0)");a.onkeydown=new Function("e","cmKyDn(e, this)");a.onmouseover=new Function("e","cmMs(e, this, 1)");a.onmouseout=new Function("e","cmMs(e, this, 0)");a.oPM=i;a.sCmd=null;a._isMnu=1;for(var h=getAllDescendants(a),d=0;d<h.length;d++){var c=h[d];gtAttrN(c,"_lnk")==1&&c.getAttribute("sSmId")&&CtxMnu(wda(c.getAttribute("sSmId")),f,e,a,e,0,b,g)}a.lnks=cmLnks(a,0,b);a._fNSM=b;if(a.fScrl){a.onkeydown=ctxMnuOnKD;a.style.height=a.lnks.length>10?"21em":""}}function ctxChngImg(c,b){var a=getOneDescendant(c,"imgI");a&&Owa.Components.CssSprites.updateImage(Owa.Dom.Node.wrapDomNode(a),b)}function dispCtxMnu(a){a.getCMW=a.fnOnSel=a.fnOnHid=a.show=a.hide=a.onfocusout=null;a.oncontextmenu=a.onkeydown=a.onmouseover=a.onmouseout=null;a.getCMW=null;dtchEvt(a,"click",ctxMnuOnClk);a.oPM=null;a.sCmd=null;for(var c=getAllDescendants(a),b=0;b<c.length;b++){var d=c[b];d.getAttribute("sSmId")&&dispCtxMnu($(d.getAttribute("sSmId"))._get_DomNode())}if(a.lnks){for(var b=0;b<a.lnks.length;++b)a.lnks[b]=null;a.lnks=null}a.cachedItmColl=null}function ctxMnuShw(h,f,g){setVsblEm(this);showEm(this);this.lnks=cmLnks(this,0,this._fNSM);this.fPH=0;var b=gtStl(this,"width")!="auto",e;if(!b)e=this.getCMW();if(b&&!this.fWS||!b)for(var c=0;c<this.lnks.length;++c){var a=getOneChild(this.lnks[c],"spnT");if(!a)continue;if(b)e=this.getCMW(a.parentNode);if(this.lnks[c].getAttribute("sSmId")){var d=e-gow(a);if(d<1)d=1;a.nextSibling.style.width=d+"px"}a.style.overflowX="hidden";a.style.textOverflow="ellipsis"}this.fWS=1&&b;cmShow(this,h,f,g);setVsblEm(this,1);setFcs(this);this.fnOnShw&&this.fnOnShw(this.sCmd)}function ctxMnuGetCMW(a){var f=gtStl(this,"width")!="auto",f=0;if(f&&!a)return 0;var c=0,g=0,i=0,e=0;if(!f)for(;g<this.lnks.length;++g){var a=this.lnks[g],k=getOneDescendant(a,"spnT");if(!k)continue;var d=gtw(k);if(c<d)c=d}else{var b=getOneDescendant(a,"spnImg");if(!b){var h=getOneDescendant(a,"imgRA");if(h)b=h.parentNode}if(b){var d=gtw(b);if(e<d)e=d}var j=getOneDescendant(a,"imgRA");if(j)i=gtw(j)}if(f){var l=this.currentStyle.width.indexOf("px")>=0,m=l?parseInt(0+this.currentStyle.width,10):gsw(this);c=m-parseInt(0+this.currentStyle.borderLeftWidth,10)-parseInt(0+this.currentStyle.borderRightWidth,10)-parseInt(0+this.currentStyle.paddingLeft,10)-parseInt(0+this.currentStyle.paddingRight,10)-parseInt(0+a.currentStyle.paddingLeft,10)-parseInt(0+a.currentStyle.paddingRight,10)-e-i}return c}function ctxMnuOnClk(d){var a=cmSelIdx(this.lnks);if(0<=a){var c=this.lnks[a];if(c.getAttribute("sSmId"))return;this.sCmd=c.getAttribute("cmd");this.fPH=1;var b=0;if(this.fnOnSel)b=this.fnOnSel(this.sCmd,this.lnks[a],d);if(!b)this.hide(1,1);else this.fPH=0}}function ctxMnuOnFcsO(b){b=b?b:event;if(this._fStick)return;if(this.fSuppressHide)return;var a=b.toElement;while(a&&a.id!=this.id&&a.tagName!="BODY"){if(this.subMnu&&a.id==this.subMnu.id)break;a=a.parentNode}if(a&&a.tagName!="BODY")return;this.hide()}function ctxMnuOnKD(a){a=a?a:event;switch(getKeyCode(a)){case 40:case 38:case 36:cmKyDn(a,this);var b=cmSelIdx(this.lnks);ctxMnuScrl(this.lnks,b);break;default:cmKyDn(a,this)}canEvt()}function ctxMnuHd(b,a){if(this.fnOnBfHid&&this.fnOnBfHid())return;if(this.fPH&&!b)return;this.fPH=1;cmHdSM(this);hideEm(this);cmClrItmFx(this.lnks);this.oPM&&a&&this.oPM.hide();this.fnOnHid&&this.fnOnHid(this.sCmd)}function ctxMnuDsbl(c,a){if(!ctxMnuDsbl.oDsbl)ctxMnuDsbl.oDsbl=getStyle("cmDsbld");var b=c.style;b.color=a?ctxMnuDsbl.oDsbl.color:"";b.cursor=a?ctxMnuDsbl.oDsbl.cursor:"";c.setAttribute("_lnk",!a?1:0)}function ctxMnuScrl(f,c){var c=cmSelIdx(f);if(c>-1){var b=f[c],g=isClpd(b),a=gtScrPrnt(b,1);if(a)if(g<0)a.scrollTop=getCY(b,0,a);else if(g>0){var d=getCY(b,0,a),e=d-(goh(a)-goh(b));a.scrollTop=e>=0?e:d}}}function isClpd(a){return a.offsetParent.scrollTop>a.offsetTop?-1:a.offsetTop+goh(a)-a.offsetParent.scrollTop>goh(a.offsetParent)?1:0}function cmLnks(e,f,g){for(var d=[],c=getAllDescendants(e),b=0;b<c.length;b++){var a=c[b];if((gtAttrN(a,"_lnk")==1||f)&&Owa.Dom.Node.wrapDomNode(a).get_IsShown())(!g||gtCtxMnu(a)==e)&&d.push(a)}return d}function gtCtxMnu(b){var a=b;while(a.parentNode){if(a.parentNode._isMnu)return a.parentNode;a=a.parentNode}}function cmClrItmFx(b){for(var a=0;a<b.length;a++)cmItmFx(b[a],0)}function cmSelIdx(b){for(var a=0;a<b.length;a++){if(b[a].uniqueID)var c=wda(b[a].uniqueID);else var c=b[a];if(c==null&&b[a].id)c=wda(b[a].id);if(c._sel==1)return a}return-1}function cmGetEmByC(d,c){for(var b=cmLnks(d,1),a=0;a<b.length;a++)if(b[a].getAttribute("cmd")==c)return b[a];return 0}function cmDsblC(d,b,c){var a=cmGetEmByC(d,b);a&&ctxMnuDsbl(a,c)}function cmSelByC(c,b){var a=cmGetEmByC(c,b);a&&cmItmFx(a,1)}function cmStyle(){var a=getEm("DIV");a.style.display="none";ibe(document.body,a);g_ocmS=new ButtonStyle(a,"cmHiLite");rn(a)}function cmItmFx(b,a){!g_ocmS&&cmStyle();b.style.backgroundColor=a?g_ocmS.backgroundColor:"";b.style.borderColor=a?g_ocmS.borderColor:"";b._sel=a?1:0;if(a)try{b.focus()}catch(c){}}function cmShow(a,c,b,d){showEm(a);if(c&&!b&&!d){b=getEvtCX(c);d=getEvtCY(c);if(g_fRtl)b-=gcw(a)}if(g_fRtl)b-=gow(a);a.style.left=getVisiblePositionX(a,b)+"px";a.style.top=getVisiblePositionY(a,d)+"px";if(g_fRtl&&c)a.style.left=getVisiblePositionX(a,getEvtCX(c)-a.clientWidth)+"px"}function cmKyDn(d,c){if(c._fNoHkKey)return;d=d?d:event;var e=c.word?1:0,b=c.lnks,a=cmSelIdx(b);switch(getKeyCode(d)){case 27:c.hide();e&&posElm(c.word,1);break;case 37:e&&posElm(c.word,1);break;case 39:e&&posElm(c.word,0);break;case 40:if(a>-1){if(a<b.length-1){cmItmFx(b[a],0);cmItmFx(b[a+1],1)}}else b.length&&cmItmFx(b[0],1);break;case 38:if(a>-1)if(a>0){cmItmFx(b[a],0);cmItmFx(b[a-1],1)}break;case 13:a>-1&&Owa.Dom.Node.wrapDomNode(b[a]).click();break;case 35:a>-1&&cmItmFx(b[a],0);cmItmFx(b[b.length-1],1);break;case 36:a>-1&&cmItmFx(b[a],0);cmItmFx(b[0],1)}canEvt(d)}function posElm(a,b){if(a.fR){var c=a.duplicate();doCllps(c,b)}else mvIP(a,b,edDoc())}function cmMs(d,a,h){d=d?d:event;var b=getEvtTgt(d),r=a.lnks;canEvt(d);while(b&&b!=document){var k=gtAttrN(b,"_lnk");if(k){if(k==1){h&&cmClrItmFx(r);cmItmFx(b,h);if(!a.oSM||a.oSM&&a.oSM.id!=b.getAttribute("sSmId"))if(h&&b.getAttribute("sSmId")){cmHdSM(a);var c=wda(b.getAttribute("sSmId")),e=Owa.Dom.Node.wrapDomNode(b),l=e.get_PositionalLeft(),g=e.get_OffsetWidth(),n=e.get_PositionalTop();if(g_fRtl)g=0;var j=Owa.Dom.Node.wrapDomNode(c).getExpando("_iOffY");if(j)c.show(null,g,n+j);else c.show(null,g,n);var m=gow(c),f=0;if(g_fRtl){if(0<m+gol(c))f=1}else if(4<gow(a)-gol(c))f=1;if(f){var i=getCX(a),o=gow(wdb())-gow(a)-i,p=l-m,q=l+gow(b);splc(c,i>o?p:q)}a.oSM=c}else a.oSM&&a.oSM.id!=b.getAttribute("sSmId")&&!cntns(a.oSM,b)&&cmHdSM(a);else a.oSM&&a.oSM.id==b.getAttribute("sSmId")&&cmItmFx(b,1)}return}b=b.parentNode}}function cntns(c,a,b){while(a&&(!b&&a.id!=c.id||b&&a.uniqueID!=c.uniqueID))a=a.parentNode;return a!=null}function cmHdSM(a){if(!a.oSM)return;a.oSM.hide();a.oSM=null}function cmShwEm(g,b,f,e){for(var a,c=0;c<g.length;c++){a=g[c];if(isDf(typeof e)){var d=getOneDescendant(a,"spnImg");if(d)d.className=e?"cmPnChk":"cmIco"}if(isDf(typeof f)&&f){showEm(a);errSty(a,1);a.setAttribute("_lnk","0")}else{showEm(a,b);!b&&errSty(a,0);a.setAttribute("_lnk",b?"0":"1")}}}function getAllDescendants(a){return a.all?a.all:a.getElementsByTagName("*")}function gtAttrN(b,a){return parseInt(b.getAttribute(a))}!g_fModuleLoaded[".\\uicontrols/movepolicycontextmenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.MovePolicyContextMenu=function Owa$UIControls$MovePolicyContextMenu(a){Owa.UIControls.MovePolicyContextMenu.constructBase(this,[a]);g_oEd.attachEvent("ApplyMovePolicy",this,"_cbApplyMovePolicy");g_oEd.attachEvent("InheritMovePolicy",this,"_cbInheritMovePolicy")};Owa.UIControls.MovePolicyContextMenu.prototype.dispose=function Owa$UIControls$MovePolicyContextMenu$dispose(){this.get_SubPage()._oMovePolicyContextMenu=null;g_oEd.detachEvent("ApplyMovePolicy",this,"_cbApplyMovePolicy");g_oEd.detachEvent("InheritMovePolicy",this,"_cbInheritMovePolicy");Owa.UIControls.MovePolicyContextMenu.callBase(this,"dispose")};Owa.UIControls.MovePolicyContextMenu.get_Instance=function Owa$UIControls$MovePolicyContextMenu$get_Instance(a){a=a||Owa.UIControls.SubPage.get_Instance();if(!a._oMovePolicyContextMenu)a._oMovePolicyContextMenu=new Owa.UIControls.MovePolicyContextMenu(a);return a._oMovePolicyContextMenu};Owa.UIControls.MovePolicyContextMenu.prototype._createGetMenuReq=function Owa$UIControls$MovePolicyContextMenu$_createGetMenuReq(a){return new oeReq("MovePolicy","GetPolicyMenu",0,a,GET)};Owa.UIControls.MovePolicyContextMenu.prototype._applyPolicy=function Owa$UIControls$MovePolicyContextMenu$_applyPolicy(a){g_oPtgMgr.applyPolicy("MovePolicy",this,this._rgSelectedIds,a,this._sLocalFolderId)};Owa.UIControls.MovePolicyContextMenu.prototype._inheritPolicy=function Owa$UIControls$MovePolicyContextMenu$_inheritPolicy(){g_oPtgMgr.inheritPolicy("MovePolicy",this,this._rgSelectedIds,this._sLocalFolderId)};Owa.UIControls.MovePolicyContextMenu.prototype._cbApplyMovePolicy=function Owa$UIControls$MovePolicyContextMenu$_cbApplyMovePolicy(d,a,b,c){this._cbPolicyChanged(d,a,b,c)};Owa.UIControls.MovePolicyContextMenu.prototype._cbInheritMovePolicy=function Owa$UIControls$MovePolicyContextMenu$_cbInheritMovePolicy(c,a,b){this._cbPolicyChanged(c,a,b,"inheritPolicy")};Owa.UIControls.MovePolicyContextMenu.createClass("Owa.UIControls.MovePolicyContextMenu",Owa.UIControls.PolicyContextMenuBase)})();g_fModuleLoaded[".\\uicontrols/movepolicycontextmenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/openmailboxdialog.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var d="imgX",h="divOpnMbxUsr",e="divOpnMbxRw",g="divOpnMbxDlg",c="btnOpnMbx",f="aUserTile",b=null;Owa.UIControls.OpenMailboxDialog=function Owa$UIControls$OpenMailboxDialog(){Owa.UIControls.OpenMailboxDialog.constructBase(this)};Owa.UIControls.OpenMailboxDialog.get_Instance=function Owa$UIControls$OpenMailboxDialog$get_Instance(){return b};Owa.UIControls.OpenMailboxDialog.createInstance=function Owa$UIControls$OpenMailboxDialog$createInstance(){b=new Owa.UIControls.OpenMailboxDialog;b.set_SubPage(getNavigationPage());b.initialize();return b};Owa.UIControls.OpenMailboxDialog.hideDialog=function Owa$UIControls$OpenMailboxDialog$hideDialog(){if(!b)return;b._oDialog&&b._oDialog._get_Element().get_IsShown()&&b._closeAndHideDialog()};Owa.UIControls.OpenMailboxDialog.showDialog=function Owa$UIControls$OpenMailboxDialog$showDialog(){if(!b)b=Owa.UIControls.OpenMailboxDialog.createInstance();b.clickButton()};var a=Owa.UIControls.OpenMailboxDialog.prototype;a.initDialog=function Owa$UIControls$OpenMailboxDialog$initDialog(){this._fReady=0;this._createAndShowDialog();this._oRecipientWell.setFocus();this._setTimeout(this.isReady,1)};a.release=function Owa$UIControls$OpenMailboxDialog$release(){this._oCloseXButton.detachAllEvents();this._oCloseXButton=null;this._oOpenButton.detachAllEvents();this._oOpenButton=null;this._oDialog.dispose();this._oDialog=null;Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId)};a.clickButton=function Owa$UIControls$OpenMailboxDialog$clickButton(){if(this._fIsLoading&&!this._sRecipientWellMarkup||this._oDialog&&this._oDialog._oElement.get_IsShown())return;if(this._sRecipientWellMarkup)this.initDialog();else{this._fIsLoading=1;var a=new oeReq("RecipWell","GetOpnMbxRcp",null,this._createCallback(this._cbGetRecipientWellData));a.send()}};a.hideDialog=function Owa$UIControls$OpenMailboxDialog$prototype$hideDialog(){this._oDialog&&this._oDialog._get_Element().get_IsShown()&&this._closeAndHideDialog()};a.isReady=function Owa$UIControls$OpenMailboxDialog$isReady(){this._fReady=1;updCmp(window)};a._onKeyDown=function Owa$UIControls$OpenMailboxDialog$_onKeyDown(a){var f=a.get_Target(),b=f.get_Id(),e=a.isShiftKeyDown();switch(a.get_KeyCodeForKeyUpDown()){case 9:if(b==c){if(!e){this._oCloseXButton.focus(1);a.preventDefault()}}else if(b==d){if(e){this._oOpenButton.focus(1);a.preventDefault()}}else return;break;case 13:if(b==c){this._oOpenButton.click();a.preventDefault()}else if(b==d){this._closeAndHideDialog();a.preventDefault()}break;default:return}a.cancelBubble()};a._createAndShowDialog=function Owa$UIControls$OpenMailboxDialog$_createAndShowDialog(){this._createDialog();var a=$(f),b=this._oDialog._oElement,d=a.get_DocumentTop()+a.get_OffsetHeight(),c=a.get_DocumentLeft()+(g_fRtl?-1:a.get_OffsetWidth()-b.get_OffsetWidth()+1);this._oDialog.show(c,d)};a._createDialog=function Owa$UIControls$OpenMailboxDialog$_createDialog(){var b='<div id="'+g+'"><div class="opnMbxDlgTtl">'+Owa.Components.CssSprites.getImageMarkup("closedlg.gif",'id="'+d+'" tabindex="0"',"opnMbxClsImg",null)+this._strings.L_OpenOtherMailbox+'</div><div class="opnMbxDlgMn"><div>'+this._strings.L_SelectMailbox+"</div>"+this._sRecipientWellMarkup+'<button id="'+c+'">'+this._strings.L_OpenEllipsis+"</button></div></div>";this._oDialog=new Owa.UIControls.Dialog(h,b,0,1,0,1,0);this._oDialog.get_OnClose().add(this._createCallback(this._closeDialog));var a=this._oDialog._oElement;this._oCloseXButton=a.getDescendantById(d);this._attachEvent(this._oCloseXButton,"click",this._closeAndHideDialog);this._oOpenButton=a.getDescendantById(c);this._attachEvent(this._oOpenButton,"click",this._onClickOpenButton);this._attachEvent(a,"keydown",this._onKeyDown);this._createRecipientWellControl()};a._createRecipientWellControl=function Owa$UIControls$OpenMailboxDialog$_createRecipientWellControl(){var b=this._oDialog._oElement,a=b.getDescendantById(e);this._oRecipientWell=Owa.UIControls.SingleEditRecipientWell.create(a);this._oRecipientWell.set_SubPage(this.get_SubPage());this._oRecipientWell.set_IsADRecipientOnly();this._oRecipientWell.set_OnAutoResolveCallback(this._createCallback(this._resolveRecipientWell));this._oRecipientWell.initialize();this.oAnrOptions=getAnrOptions(true);this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([this._oRecipientWell],this.oAnrOptions)};a._resolveRecipientWell=function Owa$UIControls$OpenMailboxDialog$_resolveRecipientWell(){Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveNames))};a._onCompleteResolveNames=function Owa$UIControls$OpenMailboxDialog$_onCompleteResolveNames(){this._oRecipientWell.setFocus()};a._cbGetRecipientWellData=function Owa$UIControls$OpenMailboxDialog$_cbGetRecipientWellData(c){if(!cbOeh(c))return;var b=Owa.Dom.Document.get_Current().createElement("DIV");b=Owa.Dom.Document.get_Current().appendChild(b);b.set_InnerHtml(c.sBody);var a=b.getDescendantById("divMbxCntr");this._sRecipientWellMarkup=a.get_InnerHtml();this._strings={L_OpenEllipsis:a.getAttribute("L_OpnMbx"),L_Cancel:a.getAttribute("L_CnclMbx"),L_OpenOtherMailbox:a.getAttribute("L_OpnOtMbx"),L_SelectMailbox:a.getAttribute("L_SlctMbx"),L_ErrorDialogTitle:a.getAttribute("L_ErrMbxTtl"),L_ErrorMessage:a.getAttribute("L_ErrMbx")};b.remove(true);this._fIsLoading=0;this.clickButton()};a._onClickOpenButton=function Owa$UIControls$OpenMailboxDialog$_onClickOpenButton(){var b=this._oRecipientWell.get_Recipient();if(!b){this._oRecipientWell.setFocus(1);return}var c=this._oOpenButton.get_TextContent()==this._strings.L_OpenEllipsis;if(!c)this._closeAndHideDialog();else{var a=getRecipientType(b);if(a==RCP_RES){this._oOpenButton.set_TextContent(this._strings.L_Cancel);this._openMailbox(b)}else if(a==RCP_PND)this._resolveRecipientWell();else a==RCP_AMB&&(new OKDlg(this._strings.L_ErrorMessage,this._oDialog._oElement,this._createCallback(this._onCloseMailboxAlert),Owa.BUTTON_DIALOG_ICON.WARNING,this._strings.L_ErrorDialogTitle)).show()}};a._openMailbox=function Owa$UIControls$OpenMailboxDialog$_openMailbox(c){var a=new oeReq("RecipWell","UpdateAC"),b=[];b.push(convtToOEHStrct(c,a));a.addRgSt("Recips",b);a.send();var d=Owa.Dom.Window.get_Current();d.navigate("/owa/"+c._sa)};a._onCloseMailboxAlert=function Owa$UIControls$OpenMailboxDialog$_onCloseMailboxAlert(){this._oRecipientWell.setFocus()};a._closeAndHideDialog=function Owa$UIControls$OpenMailboxDialog$_closeAndHideDialog(){this._oDialog.hide()};a._closeDialog=function Owa$UIControls$OpenMailboxDialog$_closeDialog(){Owa.UIControls.AutoCompleteCache.hide();this.release()};Owa.UIControls.OpenMailboxDialog.createClass("Owa.UIControls.OpenMailboxDialog",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/openmailboxdialog.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");Type.createNamespace("Owa.Components.SharingMessageHelpers");!g_fModuleLoaded[".\\components/sharingmessagehelpers.js".toLowerCase()]&&(function(){var a="msgInArchive";Owa.Components.SharingMessageHelpers.HandleUserAction=function Owa$Components$SharingMessageHelpers$HandleUserAction(d,c,b,a){switch(d){case Owa.Strings.Ids.AddThisCalendar:Owa.Components.SharingMessageHelpers.SendSharingActionRequest("AddSharedCalendar",c,b,a,Owa.Components.SharingMessageHelpers._cbAddSharedCalendar);break;case Owa.Strings.Ids.ShareMyCalendar:Owa.Components.SharingMessageHelpers.SendSharingActionRequest("AllowSharingRequest",c,b,a,Owa.Components.SharingMessageHelpers._cbActionOnRequest)}};Owa.Components.SharingMessageHelpers.SendSharingActionRequest=function Owa$Components$SharingMessageHelpers$SendSharingActionRequest(c,e,d,b,f){var a=new oeReq("SharingMessage",c,b,f,POST);a.add("Id",e);a.add("CK",d);a.send()};Owa.Components.SharingMessageHelpers.processSubscribeResult=function Owa$Components$SharingMessageHelpers$processSubscribeResult(c){var k="notfound",i="toExternalADDL",h="fromOlderVersion",j="msgCorrupted",l="badUri";if(c.sErr){c.fST&&popLgn();return{fError:true,sErrorMessageInInfobar:c.sErr}}else{var d=Owa.Dom.Document.get_Current().createElement("div");d.set_InnerHtml(c.sBody);var g=d.getDescendantById("err"),e=false;if(g){var b=g.getAttribute("_msg");if(b==k)alrt(L_UnableOpnFdr,0,Owa.BUTTON_DIALOG_ICON.ERROR);else if(b==i)alrt(L_ErrorSharingToExternalADDL,0,Owa.BUTTON_DIALOG_ICON.ERROR);else if(b==h)alrt(L_ErrorOpenOlderExchangeSecondaryCalendar,0,Owa.BUTTON_DIALOG_ICON.ERROR);else if(b==j)alrt(L_ErrorSharingMessageCorrupted,0,Owa.BUTTON_DIALOG_ICON.ERROR);else if(b==l){alrt(L_ErrorBadUri,0,Owa.BUTTON_DIALOG_ICON.ERROR);e=true}else b==a&&alrt(L_ErrorSharingInArchive,0,Owa.BUTTON_DIALOG_ICON.ERROR);return{fError:true,oElement:d,fKeepDialogOpen:e}}else{var m=Owa.Utility.getRootOwaWindow();try{var f=m.getGlobalVariable("g_oEd");f&&f.fire.call(f,"ReloadNavigationTree",c)}catch(n){}return{fError:false,oElement:d,fKeepDialogOpen:e}}}};Owa.Components.SharingMessageHelpers._cbAddSharedCalendar=function Owa$Components$SharingMessageHelpers$_cbAddSharedCalendar(e){var a=e.oCtx,c=a._getDescendant("divErr"),b=Owa.Components.SharingMessageHelpers.processSubscribeResult(e);if(!b.fError){c&&hideErr(c,a);var g=b.oElement,h=g.getDescendantById("subInfo"),d=new Owa.UIControls.Infobar(a._getDescendant("divInfobar"));d.set_SubPage(a.get_SubPage());d.buildReplaceOrInsertMessageAndRefresh(htmlEnc(L_InfoCalAdded),"divInfoAddCal");var j=g.getDescendantById("ck");a._sCK=j.get_TextContent();var f=h.get_TextContent();d.buildReplaceOrInsertMessageAndRefresh(htmlEnc(f),"divInfoAddCal");var i=OKDlg(f,null,null,Owa.BUTTON_DIALOG_ICON.Information,"");i.show()}else b.sErrorMessageInInfobar&&showErrInNav(c,b.sErrorMessageInInfobar,e.sErrDbg)};Owa.Components.SharingMessageHelpers._cbActionOnRequest=function Owa$Components$SharingMessageHelpers$_cbActionOnRequest(b){var d=null,h=0,i=0,e=Owa.Dom.Document.get_Current().createElement("div");e.set_InnerHtml(b.sBody);if(b.sErr){b.fST&&popLgn();d=b.sErr;h=b.iErr}else{var c=e.getChildById("err");if(c){d=c.getAttribute("_msg");i=1;if(c._cd)h=getInt(c.getAttribute("_cd"))}}var g=b.oCtx,f=g._getDescendant("divErr");if(!d){f&&hideErr(f,g);var j=urlEnc(e.getChildById("divOp").get_TextContent());opnWin("?ae=Item&a=New&s=Draft&t=IPM.Sharing&id="+j);if(typeof a_fPrv!="undefined"&&!a_fPrv)!a_fInvOrAcptOfReq&&!a_fPrv&&Owa.Dom.Window.get_Current().close()}else d==a&&alrt(L_ErrorSharingInArchive,0,Owa.BUTTON_DIALOG_ICON.ERROR)}})();g_fModuleLoaded[".\\components/sharingmessagehelpers.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/addressbookpickerrecipientwell.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var f=["flatHvr"],d=["flatNR","dsbl"],e="addrBkBtn",c="onResize",b="onUpdateFromCache";Owa.UIControls.AddressBookPickerRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell(a,b,c){Owa.UIControls.AddressBookPickerRecipientWell.constructBase(this,[b,c]);this._set_Configuration(a)};var a=Owa.UIControls.AddressBookPickerRecipientWell.prototype;a.dispose=function Owa$UIControls$AddressBookPickerRecipientWell$dispose(){Owa.UIControls.AutoCompleteCache.hide();isAnrMenuOpen()&&g_AnrCtxMnu.close();this.fDisposed=1;Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId);Owa.UIControls.AddressBookPickerRecipientWell.callBase(this,"dispose")};a.initialize=function Owa$UIControls$AddressBookPickerRecipientWell$initialize(){Owa.UIControls.AddressBookPickerRecipientWell.callBase(this,"initialize");var a=null;if(this.oConfiguration.fOneRcp)a=Owa.UIControls.SingleEditRecipientWell.create(this._oElement,this._oParent);else a=Owa.UIControls.EditRecipientWell.create(this._oElement,this._oParent);a.set_IsADRecipientOnly(this.oConfiguration.fOnlyAD);a.set_OnAutoResolveCallback(this._createCallback(this._resolveRecipientWell));a.set_OnUpdateFromCacheCallback(this._createCallback(this._onUpdateFromCache));a.set_SubPage(this.get_SubPage());a.initialize();this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([a],this.oAnrOptions);if(this._get_PickerButton()){this._attachEvent(this._get_PickerButton(),"click",this._onClickPickerButton);this._enablePickerButton(true)}a.get_OnResize().add(this._createCallback(this._onResize))};a.processRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell$processRecipientWell(a){this._get_IsAllResolved();if(this.fAllResolved)return this.rgRecipients;else if(this.fHavePending&&!a){this._resolveRecipientWell(true);return 0}else if(this.fHaveAmbiguous)return 0};a.hasRecipients=function Owa$UIControls$AddressBookPickerRecipientWell$hasRecipients(){this._get_Recipients();return this.rgRecipients.length>0};a.setFocus=function Owa$UIControls$AddressBookPickerRecipientWell$setFocus(){this._oElement.focus(1)};a.set_IsEnabled=function Owa$UIControls$AddressBookPickerRecipientWell$set_IsEnabled(a){Owa.Components.RecipientWellManager.get_Instance().set_AreWellsEnabled(this.sConsumerId,a);this._enablePickerButton(a)};a.set_RecipientWellHtml=function Owa$UIControls$AddressBookPickerRecipientWell$set_RecipientWellHtml(b){var a=this._get_RecipientWellControl();a.set_Html(b)};a.set_ConsumerCallbackOnResolve=function Owa$UIControls$AddressBookPickerRecipientWell$set_ConsumerCallbackOnResolve(a){this._fnConsumerCallback=a};a.get_ConsumerCallbackOnResolve=function Owa$UIControls$AddressBookPickerRecipientWell$get_ConsumerCallbackOnResolve(){return this._fnConsumerCallback};a.get_OnResize=function Owa$UIControls$AddressBookPickerRecipientWell$get_OnResize(){return this._getEventHandlerCollection(c)};a.get_OnUpdateFromCache=function Owa$UIControls$AddressBookPickerRecipientWell$get_OnUpdateFromCache(){return this._getEventHandlerCollection(b)};a._set_Configuration=function Owa$UIControls$AddressBookPickerRecipientWell$_set_Configuration(a){this.oConfiguration=a;this.oAnrOptions=getAnrOptions(this.oConfiguration.fOnlyAD)};a._resolveRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell$_resolveRecipientWell(){Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveNames))};a._onCompleteResolveNames=function Owa$UIControls$AddressBookPickerRecipientWell$_onCompleteResolveNames(){var a=this.get_ConsumerCallbackOnResolve();if(a)a(this.processRecipientWell(true));else this.setFocus()};a._get_IsAllResolved=function Owa$UIControls$AddressBookPickerRecipientWell$_get_IsAllResolved(){this._get_Recipients();this.fAllResolved=false;this.fHavePending=false;this.fHaveAmbiguous=false;for(var a=0;a<this.rgRecipients.length;a++){var c=this.rgRecipients[a],b=getRecipientType(c);if(b==Owa.RecipientState.Pending)this.fHavePending=true;else if(b==Owa.RecipientState.Ambiguous)this.fHaveAmbiguous=true}if(this.rgRecipients.length)this.fAllResolved=!this.fHavePending&&!this.fHaveAmbiguous};a._get_RecipientWellControl=function Owa$UIControls$AddressBookPickerRecipientWell$_get_RecipientWellControl(){return this._oElement.getExpando("_oControl")};a._get_Recipients=function Owa$UIControls$AddressBookPickerRecipientWell$_get_Recipients(){this.rgRecipients=this._get_RecipientWellControl().get_Recipients()};a._get_PickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_get_PickerButton(){return this._oParent.getDescendantById(this.oConfiguration.sBtnId)};a._enablePickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_enablePickerButton(a){this.fBtnEnb=a;var b=this._get_PickerButton(),c=a?f:d,g=this.oConfiguration.sButtonStyle?this.oConfiguration.sButtonStyle:e;c.push(g);b.set_CssClasses(c);if(a)this._attachEvent(b,"click",this._onClickPickerButton);else this._detachEvent(b,"click",this._onClickPickerButton)};a._onResize=function Owa$UIControls$AddressBookPickerRecipientWell$_onResize(){this._dispatchEvent(c,this)};a._onUpdateFromCache=function Owa$UIControls$AddressBookPickerRecipientWell$_onUpdateFromCache(){this._dispatchEvent(b,this.processRecipientWell(true))};a._onClickPickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_onClickPickerButton(){if(!this.fBtnEnb)return;var a={};a.sTgt=this.oConfiguration.sTarget;a.sTo=this._get_RecipientWellControl().get_Html();var c=this,b=function(){c._get_RecipientWellControl().set_Html(a.sTo)};shwABDlg(a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,a,"&a="+this.oConfiguration.sAction,b)};Owa.UIControls.AddressBookPickerRecipientWell.createClass("Owa.UIControls.AddressBookPickerRecipientWell",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/addressbookpickerrecipientwell.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/openothermailboxfolder.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var k="divOpnOthMbx",l="divDlgTtl",b="GS",d="imgX",e="btn1",j="PickSelectMailbox",h="btnTo",i="divTo",c="divOpnOthMbxRw",g="addrBkBtn",f="txtICalUrl";function getSubscribeMarkupStart(){return"<div>"+L_AddCalDesp+'</div><div class="addCalOption"><div class="fltBefore"><input type="radio" id="optAddInOrgCal" checked name="addCal"></div><div style="overflow: hidden;" id="divAddInOrgCal"><label for="optAddInOrgCal">'+L_InOrgCal+'</label><div class="addCalOption">'}function getSubscribeMarkupEnd(){return'</div><div class="addCalOption"><div class="addCalLabel" id="divInOrgEgL">&nbsp;</div><div class="oh">'+L_InOrgCalEg+'</div></div></div></div><div class="addCalOption"><div class="fltBefore"><input type="radio" id="optAddWebCal" name="addCal"></div><div style="overflow: hidden;" id="divAddWebCal"><label for="optAddWebCal">'+L_WebCal+'</label><div><div class="addCalOption"><div class="addCalLabel" id="divWebCalL">'+L_CalUrl+'</div><div class="oh txtField"><input id="txtICalUrl" class="txtWell" type="text" maxlength="1024"></div></div><div class="addCalOption"><div class="addCalLabel" id="divWebCalEgL">&nbsp;</div><div class="oh">'+L_WebCalEg+"</div></div></div></div></div>"}Owa.UIControls.OpenOtherMailboxFolder=function Owa$UIControls$OpenOtherMailboxFolder(){Owa.UIControls.OpenOtherMailboxFolder.constructBase(this);this._iMod=0};var a=Owa.UIControls.OpenOtherMailboxFolder.prototype;a.initialize=function Owa$UIControls$OpenOtherMailboxFolder$initialize(){Owa.UIControls.OpenOtherMailboxFolder.callBase(this,"initialize");this._createAndShowDialog();this._oAddressBookPickerRecipientWell.setFocus();this._setTimeout(this.isReady,1)};a.dispose=function Owa$UIControls$OpenOtherMailboxFolder$dispose(){this._oAddressBookPickerRecipientWell&&this._oAddressBookPickerRecipientWell.dispose();Owa.UIControls.OpenOtherMailboxFolder.callBase(this,"dispose")};a.requestSharingCalendar=function Owa$UIControls$OpenOtherMailboxFolder$requestSharingCalendar(b){var a="?ae=Item&t=IPM.Note&a=New";if(b){a+="&to="+urlEnc(b.address);a+="&nm="+urlEnc(b.displayName);a+="&subject="+urlEnc(L_RequestSharingSubject)}else a+="&email="+urlEnc("mailto:?subject="+L_RequestSharingSubject);opnWin(a,null,null,null,null,null,null,this.get_SubPage())};a.clickButton=function Owa$UIControls$OpenOtherMailboxFolder$clickButton(a){if(this._fDispDlg||this._fIsLoading&&!this._sRecipientWellMarkup||this._oDialog&&this._oDialog._oElement.get_IsShown())return;if(isDf(typeof a))this._iMod=a;if(this._sRecipientWellMarkup)this.initialize();else{this._fIsLoading=1;var b=new oeReq("RecipWell","GetOpnMbxFldRcp",null,this._createCallback(this._cbGetRecipientWellPickerData));b.send()}};a.isReady=function Owa$UIControls$OpenOtherMailboxFolder$isReady(){this._fDispDlg=0;updCmp(window)};a._onClickInputBox=function Owa$UIControls$OpenOtherMailboxFolder$_onClickInputBox(b){var a=b.get_Target().get_Id()==c;if(a)this._oDialog._getDescendant("optAddInOrgCal").set_IsChecked(true);else this._oDialog._getDescendant("optAddWebCal").set_IsChecked(true)};a._onKeyDown=function Owa$UIControls$OpenOtherMailboxFolder$_onKeyDown(a){var f=a.get_Target(),b=f.get_Id(),c=a.isShiftKeyDown();switch(a.get_KeyCodeForKeyUpDown()){case 9:if(b==e){if(!c){this._oDialog._oElement.getDescendantById(d).focus(1);a.preventDefault()}}else if(b==d){if(c){this._oDialog._oElement.getDescendantById(e).focus(1);a.preventDefault()}}else return;break;case 13:b==d&&this._hideAndCloseDialog();break;default:return}a.cancelBubble()};a._createAndShowDialog=function Owa$UIControls$OpenOtherMailboxFolder$_createAndShowDialog(){this._createDialog();this._oDialog.show();if(this._showSubscribeEntry()){var a=["divInOrgEgL","btnTo","divWebCalL","divWebCalEgL"];Owa.Layout.setElementWidthsToLargest(a)}};a._createDialog=function Owa$UIControls$OpenOtherMailboxFolder$_createDialog(){var b=this._showSubscribeEntry()?getSubscribeMarkupStart()+this._sRecipientWellMarkup+getSubscribeMarkupEnd():this._sRecipientWellMarkup;this._oDialog=new BtnDlg(k,b,this._get_DialogTitle(),[this._buttonStrings.OK,this._buttonStrings.Cancel],420,null,this._createCallback(this._onClickDialogButton),null,0);this._oDialog._oElement.attachEvent("keydown",this._createCallback(this._onKeyDown));if(this._showSubscribeEntry()){var a=this._createCallback(this._onClickInputBox);this._oDialog._getDescendant(c).attachEvent("click",a);this._oDialog._getDescendant("txtICalUrl").attachEvent("click",a)}this._createAddressBookPickerRecipientWell()};a._createAddressBookPickerRecipientWell=function Owa$UIControls$OpenOtherMailboxFolder$_createAddressBookPickerRecipientWell(){var a=this._oDialog._oElement,b=a.getDescendantById(c),d={fOneRcp:1,fOnlyAD:1,sAction:j,sBtnId:h,sTarget:i,sButtonStyle:g};this._oAddressBookPickerRecipientWell=new Owa.UIControls.AddressBookPickerRecipientWell(d,b,a);this._oAddressBookPickerRecipientWell.set_SubPage(this.get_SubPage());this._oAddressBookPickerRecipientWell.initialize()};a._cbGetRecipientWellPickerData=function Owa$UIControls$OpenOtherMailboxFolder$_cbGetRecipientWellPickerData(c){if(!cbOeh(c))return;var b=Owa.Dom.Document.get_Current().createElement("DIV");b=Owa.Dom.Document.get_Current().appendChild(b);b.set_InnerHtml(c.sBody);var a=b.getChildById("divPayLoad");this._sRecipientWellMarkup=a.get_InnerHtml();this._titles={0:a.getAttribute("L_OpnInbx"),1:a.getAttribute("L_OpnCal"),2:a.getAttribute("L_OpnCnts"),3:a.getAttribute("L_OpnTsks")};this._buttonStrings={AB:a.getAttribute("L_Nm"),Cancel:L_Cncl,OK:L_OK};b.remove(true);this._fIsLoading=0;this.clickButton()};a._get_DialogTitle=function Owa$UIControls$OpenOtherMailboxFolder$_get_DialogTitle(){return this._titles[this._iMod]};a._onClickDialogButton=function Owa$UIControls$OpenOtherMailboxFolder$_onClickDialogButton(a){if(a==-1||a==1)this._closeDialog();else{this._doAction();return 1}return 0};a._doAction=function Owa$UIControls$OpenOtherMailboxFolder$_doAction(){var a,c=this._oDialog._getDescendant("optAddWebCal"),b=true;if(c&&c.get_IsChecked()){b=false;a=this._oDialog._getDescendant(f).get_Value()}if(b){var d=this._oAddressBookPickerRecipientWell.processRecipientWell();if(d){this._openOtherUserFolder(d[0]);this._hideAndCloseDialog()}else this._oAddressBookPickerRecipientWell.setFocus(1)}else if(a){shwPrgrsInd(L_Ld);this._subscribeToInternetCalendar(a)}else this._oDialog._getDescendant(f).focus(1)};a._set_RequestForModule=function Owa$UIControls$OpenOtherMailboxFolder$_set_RequestForModule(a){switch(this._iMod){case NM_MAIL:a.add(b,2);break;case NM_CAL:a.add(b,3);break;case NM_CTS:a.add(b,4);break;case NM_TSK:a.add(b,5)}};a._openOtherUserFolder=function Owa$UIControls$OpenOtherMailboxFolder$_openOtherUserFolder(c){if(isExpLgn()){alrt(L_UnableOpnFdr,0,Owa.BUTTON_DIALOG_ICON.ERROR);return}var a=new oeReq("NavigationNode","OpenOthersFolder",null,this._createCallback(this._cbOpenOtherUserFolder));this._set_RequestForModule(a);a.addSt("RCP",convtToOEHStrct(c,a));var b=[];b.push(convtToOEHStrct(c,a));a.addRgSt("Recips",b);a.send()};a._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherMailboxFolder$_cbOpenOtherUserFolder(c){if(!cbOeh(c))return-1;if(!c.sBody.trim())return-1;var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml(c.sBody);var b=a.getDescendantById("divNoPermission");if(b){var d=b.getAttribute("_displayName"),e=b.getAttribute("_address");this.showRequestDialog(d,e)}a.remove(true)};a._subscribeToInternetCalendar=function Owa$UIControls$OpenOtherMailboxFolder$_subscribeToInternetCalendar(b){if(isExpLgn()){alrt(L_UnableOpnFdr,0,Owa.BUTTON_DIALOG_ICON.ERROR);return}var a=new oeReq("SharingMessage","SubscribeToInternetCalendar",null,this._createCallback(this._cbSubscribeToInternetCalendar));a.add("iCalUrl",b);a.send()};a._cbSubscribeToInternetCalendar=function Owa$UIControls$OpenOtherMailboxFolder$_cbSubscribeToInternetCalendar(a){hdPrgrsInd();var b=false;if(cbOeh(a)&&a.sBody.trim()){var c=Owa.Components.SharingMessageHelpers.processSubscribeResult(a);b|=c.fKeepDialogOpen}!b&&this._hideAndCloseDialog()};a.showRequestDialog=function Owa$Controls$OpenOtherMailboxFolder$showRequestDialog(a,b){var d={displayName:a,address:b},c=L_NoPermissionAndRequest.format(htmlEnc(a)),e=new BtnDlg("divDlt",c,"",[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.WARNING,Owa.Utility.createArgumentContextDelegate(this,this._cbRequestPermission,d));e.show()};a._cbRequestPermission=function Owa$UIControls$OpenOtherMailboxFolder$_cbRequestPermission(a,b){a==0&&this.requestSharingCalendar(b)};a._hideAndCloseDialog=function Owa$UIControls$OpenOtherMailboxFolder$_hideAndCloseDialog(){this._oDialog.hide()};a._closeDialog=function Owa$UIControls$OpenOtherMailboxFolder$_closeDialog(){this._fDispDlg=1;this.dispose()};a._showSubscribeEntry=function Owa$UIControls$OpenOtherMailboxFolder$_showSubscribeEntry(){if(this._iMod!=NM_CAL)return false;var a=this._oSubPage;if(a.isSubPageFunctionExists("getCurrentViewSubPage"))a=a.invokeSubPageFunction("getCurrentViewSubPage");return a.getSubPageVariable("a_fCanSubscribe")};Owa.UIControls.OpenOtherMailboxFolder.createClass("Owa.UIControls.OpenOtherMailboxFolder",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolder.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinview.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.OpenOtherFolderInView=function Owa$UIControls$OpenOtherFolderInView(a){Owa.UIControls.OpenOtherFolderInView.constructBase(this);if(a)this.set_SubPage(a);else this.set_SubPage(Owa.Components.Application.get_RootSubPage())};var a=Owa.UIControls.OpenOtherFolderInView.prototype;a._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherFolderInView$_cbOpenOtherUserFolder(b){var e=Owa.UIControls.OpenOtherFolderInView.callBase(this,"_cbOpenOtherUserFolder",[b]);if(e==-1)return;var d=Owa.Dom.Document.get_Current().createElement("DIV");d.set_InnerHtml(b.sBody);var c=d.getDescendantById("fldrurl");if(c){var a=c.get_TextContent();a+=a.indexOf("?")>=0?"&":"?";a+=PARENT_SUBPAGE_ID_ATTR+"="+this.get_SubPage().get_SubPageController().get_UniqueId();sfWinOpn(a)}};Owa.UIControls.OpenOtherFolderInView.createClass("Owa.UIControls.OpenOtherFolderInView",Owa.UIControls.OpenOtherMailboxFolder)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinview.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinnavpane.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.OpenOtherFolderInNavPane=function Owa$UIControls$OpenOtherFolderInNavPane(a){Owa.UIControls.OpenOtherFolderInNavPane.constructBase(this);this.set_SubPage(a)};var a=Owa.UIControls.OpenOtherFolderInNavPane.prototype;a._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherFolderInNavPane$_cbOpenOtherUserFolder(a){var g=Owa.UIControls.OpenOtherFolderInNavPane.callBase(this,"_cbOpenOtherUserFolder",[a]);if(g==-1)return;if(this._iMod!=NM_MAIL)switch(this._iMod){case NM_CAL:g_oCalTr.rldFrmR(a);return;case NM_CTS:g_oCntTr.rldFrmR(a);return;case NM_TSK:g_oTskTr.rldFrmR(a);default:return}var d=gtTrRg();if(d){var b=d.get_OwnerDocument().createElement("DIV");b=d.get_OwnerDocument().appendChild(b);b.set_InnerHtml(a.sBody);var e=b.get_FirstChild(),f=g_oMMFrst.gtTr("buddy");if(f)f.root.get_ParentElement().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,e);else d.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,e);var c=new Owa.UIControls.FolderTree(e.get_FirstChild(),0);c.set_SubPage(getNavigationPage());c.onSelChng=onMailSelChng;g_oMMFrst.addTr(e.get_Id(),c);c.gtNdFrstChld(c.gtNdRt()).addGuidEntryForEws();b.remove(true)}};a._cbSubscribeToInternetCalendar=function Owa$UIControls$OpenOtherFolderInNavPane$_cbSubscribeToInternetCalendar(a){Owa.UIControls.OpenOtherFolderInNavPane.callBase(this,"_cbSubscribeToInternetCalendar",[a]);this._iMod==NM_CAL&&g_oCalTr.rldFrmR(a)};Owa.UIControls.OpenOtherFolderInNavPane.createClass("Owa.UIControls.OpenOtherFolderInNavPane",Owa.UIControls.OpenOtherMailboxFolder)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinnavpane.js".toLowerCase()]=1;var g_oDlgPrgInd,g_iPrgIndTmId,g_iPrgIndDly=1e3,g_fHKDis;function shwPrgrsInd(b,a,c){if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}g_iPrgIndTmId=setTimeout('cbShwPrgrsInd("'+b+'", '+(c?"1":"0")+")",a?a:g_iPrgIndDly)}function cbShwPrgrsInd(e,a,b,c){var d='<img src="'+getThmF("progress.gif")+'">'+e;g_oDlgPrgInd=new Dlg("divPrgrsInd",d,a,!a,null,0);g_fHKDis=true;if(b==null||c==null)g_oDlgPrgInd.show();else g_oDlgPrgInd.show(b,c)}function hdPrgrsInd(){if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}g_oDlgPrgInd&&!g_oDlgPrgInd.fDisposed&&g_oDlgPrgInd.hide();g_oDlgPrgInd=0;g_fHKDis=false}!g_fModuleLoaded[".\\uicontrols/timecombobox.js".toLowerCase()]&&(function(){Owa.UIControls.TimeComboBox=function Owa$UIControls$TimeComboBox(d,e,b,c,a){Owa.UIControls.TimeComboBox.constructBase(this,[d,e]);this._oStartTimeComboBox=b;this._iStartOffset=0;this.fHourOnly=c;this.iMiniLength=a?a:0};Owa.UIControls.TimeComboBox.prototype.initialize=function Owa$UIControls$TimeComboBox$initialize(a){this._oTextBox=this._getDescendant(Owa.Strings.Ids.TimeTextBox);Owa.UIControls.TimeComboBox.callBase(this,"initialize");this._attachEvent(this._oTextBox,"blur",this._onTextBoxUpdated);if(!a)a=this._onStartTimeChanged;this._oStartTimeComboBox&&this._oStartTimeComboBox.get_OnChange().add(this._createCallback(a))};Owa.UIControls.TimeComboBox.prototype.dispose=function Owa$UIControls$TimeComboBox$dispose(){this._oStartTimeComboBox&&this._oStartTimeComboBox.get_OnChange().remove(this._createCallback(this._onStartTimeChanged));Owa.UIControls.TimeComboBox.callBase(this,"dispose")};Owa.UIControls.TimeComboBox.prototype._onStartTimeChanged=function Owa$UIControls$TimeComboBox$prototype$_onStartTimeChanged(){var b=this._oStartTimeComboBox._oSelectedValue,a=new Date(b);a.setUTCMilliseconds(b.getUTCMilliseconds()+this._iStartOffset);var d=this._getAttribute(Owa.Strings.Attributes.EndTimeValue);if(d){var c=new Date(d);if(a>c)a=c}this._selectValue(a)};Owa.UIControls.TimeComboBox.prototype._onPreShow=function Owa$UIControls$TimeComboBox$prototype$_onPreShow(){this._fillDropDownList();this._oDropDownList.hasValue(this._oSelectedValue)&&this._oDropDownList.selectValue(this._oSelectedValue)};Owa.UIControls.TimeComboBox.prototype._onTextBoxUpdated=function Owa$UIControls$TimeComboBox$prototype$_onTextBoxUpdated(){if(this._oTextBox.get_Value()==fmtDt(this._oSelectedValue,g_sShtTmFmt))return;var a;a=parseTm(this._oTextBox.get_Value(),this._oStartTimeComboBox==null?this._oSelectedValue:this._oStartTimeComboBox._oSelectedValue,this._oStartTimeComboBox!=null?this._oSelectedValue:null);if(a==-1){this._oTextBox.set_Value(fmtDt(this._oSelectedValue,g_sShtTmFmt));this._oTextBox.focus(1)}else{var b=new Date(this._oSelectedValue);b.shrs(0,a);this._selectValue(b)}};Owa.UIControls.TimeComboBox.prototype._renderSelectedValue=function Owa$UIControls$TimeComboBox$prototype$_renderSelectedValue(){if(this._oStartTimeComboBox)this._iStartOffset=this._oSelectedValue-this._oStartTimeComboBox._oSelectedValue;this._oTextBox.set_Value(fmtDt(this._oSelectedValue,g_sShtTmFmt))};Owa.UIControls.TimeComboBox.prototype.set_IsEnabled=function Owa$UIControls$TimeComboBox$prototype$set_IsEnabled(a){Owa.UIControls.TimeComboBox.callBase(this,"set_IsEnabled",[a]);this._oTextBox.set_IsDisabled(!a)};Owa.UIControls.TimeComboBox.prototype._initializeSelection=function Owa$UIControls$TimeComboBox$prototype$_initializeSelection(){g_sShtTmFmt=this._getAttribute(Owa.Strings.Attributes.ShortTimeFormatString);parseTm.rxAmPm=new RegExp(this._getAttribute("sAmPmRx"),"gi");fmtDt.sAM=this._getAttribute("L_AM");fmtDt.sPM=this._getAttribute("L_PM");this._selectValue(new Date(this._getAttribute(Owa.Strings.Attributes.TimeValue)))};Owa.UIControls.TimeComboBox.prototype._fillDropDownList=function Owa$UIControls$TimeComboBox$prototype$_fillDropDownList(){this._oDropDownList.clearItems();if(this._oStartTimeComboBox&&this._oSelectedValue-this._oStartTimeComboBox._oSelectedValue<(24+this.iMiniLength)*60*60*1e3)for(var d=this._oStartTimeComboBox._oSelectedValue,m=d.ghrs()*60+d.gmins(),k=this._getTimeInterval(),l=this._getIntervalCount(),h=this._getAttribute(Owa.Strings.Attributes.EndTimeValue),g=h?new Date(h):null,f=0;f<l;f++){var a=this.iMiniLength+f,j=m+a*k,b=new Date(d);b.shrs(0,j);if(g&&b>g)break;var i=j;if(1440<=i)i-=1440;var c=fmtDt(b,g_sShtTmFmt),e;if(this.fHourOnly)e=a.toString();else e=(a>>1).toString(10)+(a%2?this._getAttribute("L_Dec")+"5":"");c+=a_sDur.format(e);c=htmlDec(c);this._oDropDownList.addItem(c,b)}else this._fillDropDownListSimple()};Owa.UIControls.TimeComboBox.prototype._fillDropDownListSimple=function Owa$UIControls$TimeComboBox$prototype$_fillDropDownListSimple(){for(var e=this._getTimeInterval(),f=this._getIntervalCount(),d=this._getAttribute(Owa.Strings.Attributes.EndTimeValue),c=d?new Date(d):null,b=0;b<f;++b){var g=b*e,a=new Date(this._oSelectedValue);a.shrs(0,g);if(c&&a>c)break;this._oDropDownList.addItem(fmtDt(a,g_sShtTmFmt),a)}};Owa.UIControls.TimeComboBox.prototype._getIntervalCount=function Owa$UIControls$TimeComboBox$prototype$_getTimeInterval(){return this.fHourOnly?24:48};Owa.UIControls.TimeComboBox.prototype._getTimeInterval=function Owa$UIControls$TimeComboBox$prototype$_getTimeInterval(){return this.fHourOnly?60:30};Owa.UIControls.TimeComboBox.createClass("Owa.UIControls.TimeComboBox",Owa.UIControls.ComboBox);Owa.UIControls.TimeComboBox.prototype._isEditable=function Owa$UIControls$TimeComboBox$prototype$_isEditable(){return true}})();g_fModuleLoaded[".\\uicontrols/timecombobox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/messagedataprovider.js".toLowerCase()]&&(function(){Owa.UIControls.MessageDataProvider=function $Owa$UIControls$MessageDataProvider(a){this._sHtml=a};_oPrototype=Owa.UIControls.MessageDataProvider.prototype;_oPrototype.getRawMessage=function $Owa$UIControls$MessageDataProvider$getRawMessage(){return this._sHtml};Owa.UIControls.MessageDataProvider.createClass("Owa.UIControls.MessageDataProvider",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/messagedataprovider.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/analytics.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Analytics");var d=";",c=":";Owa.Analytics.ClientPerfCounters=function Owa$Analytics$ClientPerfCounters(){this._oPerfCounters={};this._sInstanceGuid=rndm();this._oConsoleUpdateTimer=null;this._iqsTime=0;for(var b in a.Name)this._oPerfCounters[a.Name[b]]=0;this._updateConsole(b,0)};var a=Owa.Analytics.ClientPerfCounters,b=Owa.Analytics.ClientPerfCounters.prototype;a.Name={TotalMessagesInCache:"TotalMessagesInCache",TotalSizeOfMessagesInCache:"TotalSizeOfMessagesInCache",TotalMessagesPrefetched:"TotalMessagesPrefetched",TotalMessagesPrefetchedButNeverUsed:"TotalMessagesPrefetchedButNeverUsed",MessagesReadFromCache:"MessagesReadFromCache",MessagesNotFoundInCache:"MessagesNotFoundInCache",LastPreviewVisibleTime:"LastPreviewVisibleTime",LastPreviewCompleteTime:"LastPreviewCompleteTime",AveragePreviewTime:"AveragePreviewTime",OehErrors:"OehErrors",OehErrorsSuppressed:"OehErrorsSuppressed"};a._qsTag={TotalMessagesInCache:"C0",TotalSizeOfMessagesInCache:"C1",TotalMessagesPrefetched:"C2",TotalMessagesPrefetchedButNeverUsed:"C3",MessagesReadFromCache:"C4",MessagesNotFoundInCache:"C5",LastPreviewVisibleTime:"C6",LastPreviewCompleteTime:"C7",AveragePreviewTime:"C8",OehErrors:"C9",OehErrorsSuppressed:"C10"};b.increment=function Owa$Analytics$ClientPerfCounters$increment(a){this._oPerfCounters[a]++;this._updateConsole(a,this._oPerfCounters[a])};b.decrement=function Owa$Analytics$ClientPerfCounters$decrement(a){if(this._oPerfCounters[a]>=1)this._oPerfCounters[a]--;else throw new Error("Perf Counter "+a+" has a value "+this._oPerfCounters[a]+"that cannot be decremented.");this._updateConsole(a,this._oPerfCounters[a])};b.setValue=function Owa$Analytics$ClientPerfCounters$setValue(a,b){this._oPerfCounters[a]=b;this._updateConsole(a,b)};b.getQS=function Owa$Analytics$ClientPerfCounters$getQS(i){var b="",f=(new Date).getTime(),h=5*60*1e3;if(!this._iqsTime||this._iqsTime+h<f){b+="&cpc="+this._sInstanceGuid;for(var e in a.Name)b+=d+a._qsTag[e]+c+this._oPerfCounters[e];this._iqsTime=f}var g=i.length+b.length;return g>=MAX_ALLOWED_URL_LENGTH?"":b};b._updateConsole=function Owa$Analytics$ClientPerfCounters$_updateConsole(){if(!this._oConsoleUpdateTimer)this._oConsoleUpdateTimer=window.setTimeout(Owa.Utility.createDelegate(this,this._updateConsoleUI),2e3)};b._updateConsoleUI=function Owa$Analytics$ClientPerfCounters$_updateConsoleUI(){var b=rtvPrfCnsl();if(!isDf(typeof b)||!b){this._oConsoleUpdateTimer=null;return}try{for(var c in a.Name)b.updatePerfCounter(c,this._oPerfCounters[c])}catch(d){}this._oConsoleUpdateTimer=null};a.getSingletonInstance=function Owa$Analytics$ClientPerfCounters$getSingletonInstance(){if(!g_oClientPerfCounters)if(!Owa.Utility.isCurrentWindowRootOwaWindow()){var a=Owa.Utility.getRootOwaWindow();a.invokeFunction("createClientPerfCounters");g_oClientPerfCounters=a.getGlobalVariable("g_oClientPerfCounters")}else createClientPerfCounters();return g_oClientPerfCounters};a.increment=function Owa$Analytics$ClientPerfCounters$increment(b){try{return a.getSingletonInstance().increment(b)}catch(c){}};a.decrement=function Owa$Analytics$ClientPerfCounters$decrement(b){try{return a.getSingletonInstance().decrement(b)}catch(c){}};a.setValue=function Owa$Analytics$ClientPerfCounters$setValue(b,c){try{return a.getSingletonInstance().setValue(b,c)}catch(d){}};a.getQS=function Owa$Analytics$ClientPerfCounters$getQS(b){try{return a.getSingletonInstance().getQS(b)}catch(c){return""}};Owa.Analytics.ClientPerfCounters.createClass("Owa.Analytics.ClientPerfCounters");Owa.Analytics.ClientAction={};Owa.Analytics.ClientAction.Name={Search:"00",ClearSearch:"01",TypeDownSearch:"02",Filter:"03",ClearFilter:"04",ScrollSingleRow:"05",ScrollPageUp:"06",ScrollPageDown:"07",ScrollLastPage:"08",ScrollFirstPage:"09",ScrollOther:"10",Sort:"11",SwitchFolder:"12",ManualRefresh:"13",DeleteRow:"14",DeleteRowByNotification:"15",ClickRow:"16",MarkAsRead:"17"};Owa.Analytics.ClientAction.add=function Owa$Analytics$ClientAction$Add(b){var a=Owa.Utility.getRootOwaWindow().getGlobalVariable("g_sClientActionList");a.get_Length()>=10&&a.splice(0,1);a.push(b)};Owa.Analytics.ClientAction.getList=function Owa$Analytics$ClientAction$GetList(){var a=Owa.Utility.getRootOwaWindow().getGlobalVariable("g_sClientActionList");return"&calist="+a.join("")}})();g_fModuleLoaded[".\\components/analytics.js".toLowerCase()]=1;var ClientPerfCounters=Owa.Analytics.ClientPerfCounters,g_oClientPerfCounters=null;function createClientPerfCounters(){if(!g_oClientPerfCounters)g_oClientPerfCounters=new Owa.Analytics.ClientPerfCounters}var g_sClientActionList=[],ClientAction=Owa.Analytics.ClientAction;!g_fModuleLoaded[".\\library/doublylinkedlist.js".toLowerCase()]&&(function(){Type.createNamespace("Owa");Owa.DoublyLinkedList=function Owa$DoublyLinkedList(){this.oFirstNode=null;this.oLastNode=null};var a=Owa.DoublyLinkedList.prototype;a.insertAtTop=function Owa$DoublyLinkedList$insertAtTop(a){if(this.oFirstNode==null){this.oFirstNode=a;this.oLastNode=a;a.oPrevNode=null;a.oNextNode=null}else this.insertBefore(this.oFirstNode,a)};a.moveToTop=function Owa$DoublyLinkedList$moveToTop(a){this.removeFromList(a);a.oPrevNode=null;a.oNextNode=null;this.insertAtTop(a)};a.insertAtBottom=function Owa$DoublyLinkedList$insertAtBottom(a){if(this.oLastNode==null)this.insertAtTop(a);else this.insertAfter(this.oLastNode,a)};a.insertBefore=function Owa$DoublyLinkedList$insertBefore(b,a){a.oPrevNode=b.oPrevNode;a.oNextNode=b;if(b.oPrevNode==null)this.oFirstNode=a;else b.oPrevNode.oNextNode=a;b.oPrevNode=a};a.insertAfter=function Owa$DoublyLinkedList$insertAfter(b,a){a.oPrevNode=b;a.oNextNode=b.oNextNode;if(b.oNextNode==null)this.oLastNode=a;else b.oNextNode.oPrevNode=a;b.oNextNode=a};a.removeFromList=function Owa$DoublyLinkedList$removeFromList(a){if(a.oPrevNode==null)this.oFirstNode=a.oNextNode;else a.oPrevNode.oNextNode=a.oNextNode;if(a.oNextNode==null)this.oLastNode=a.oPrevNode;else a.oNextNode.oPrevNode=a.oPrevNode};a.remove=function Owa$DoublyLinkedList$remove(a){this.removeFromList(a);a.oData=null};Owa.DoublyLinkedListNode=function Owa$DoublyLinkedListNode(a){this.oData=a;this.oPrevNode=null;this.oNextNode=null}})();g_fModuleLoaded[".\\library/doublylinkedlist.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/messagecache.js".toLowerCase()]&&(function(){Type.createNamespace("Owa");Owa.MessageCache=function Owa$MessageCache(){this._iTotalSize=0;this._iTotalCount=0;this._iPruneCacheTimer=0;this._oMessageCache={};this._oPriorityList=new Owa.DoublyLinkedList};var a=Owa.MessageCache,b=Owa.MessageCache.prototype;function messageInfo(d,c,b,a){this.sId=d;this.oMessage=c;this.iLastModifiedTime=a?a:0;this.fIsNotPrefetched=b?true:false;this.fIsUsed=this.fIsNotPrefetched;this.oPriorityListNode=null}b.addMessage=function Owa$MessageCache$addMessage(a,d,c,e){if(!a)return;a=this._normalizeItemId(a);this.removeMessage(a);var b=new messageInfo(a,d,c,e);this._oMessageCache[a]=b;b.oPriorityListNode=new Owa.DoublyLinkedListNode(b);this._oPriorityList.insertAtTop(b.oPriorityListNode);ClientPerfCounters.increment(ClientPerfCounters.Name.TotalMessagesInCache);this._iTotalSize+=d.getRawMessage().length;this._iTotalCount++;ClientPerfCounters.setValue(ClientPerfCounters.Name.TotalSizeOfMessagesInCache,this._iTotalSize);if(!c){ClientPerfCounters.increment(ClientPerfCounters.Name.TotalMessagesPrefetched);ClientPerfCounters.increment(ClientPerfCounters.Name.TotalMessagesPrefetchedButNeverUsed)}if(this._iTotalCount>=a_iMaxMessagesInCache)if(this._iPruneCacheTimer==0)this._iPruneCacheTimer=window.setTimeout(Owa.Utility.createDelegate(this,this._pruneCache),100)};b.removeMessage=function Owa$MessageCache$removeMessage(a){if(!a)return;a=this._normalizeItemId(a);if(isDf(typeof this._oMessageCache[a])){this._iTotalSize-=this._oMessageCache[a].oMessage.getRawMessage().length;this._iTotalCount--;ClientPerfCounters.setValue(ClientPerfCounters.Name.TotalSizeOfMessagesInCache,this._iTotalSize);this._oPriorityList.remove(this._oMessageCache[a].oPriorityListNode);delete this._oMessageCache[a];ClientPerfCounters.decrement(ClientPerfCounters.Name.TotalMessagesInCache)}};b.getMessage=function Owa$MessageCache$getMessage(a,c){if(!a)return null;a=this._normalizeItemId(a);if(!this.isMessageValid(a,c))return null;var b=this._oMessageCache[a];this._oPriorityList.moveToTop(b.oPriorityListNode);!b.fIsUsed&&ClientPerfCounters.decrement(ClientPerfCounters.Name.TotalMessagesPrefetchedButNeverUsed);b.fIsUsed=true;return b.oMessage.getRawMessage()};b.getMessageAndUpdateCounter=function Owa$MessageCache$getMessageAndUpdateCounter(a,c){if(!a)return null;a=this._normalizeItemId(a);var b=this.getMessage(a,c);if(b)ClientPerfCounters.increment(ClientPerfCounters.Name.MessagesReadFromCache);else ClientPerfCounters.increment(ClientPerfCounters.Name.MessagesNotFoundInCache);return b};b._pruneCache=function Owa$MessageCache$_pruneCache(){var a=this._oPriorityList.oLastNode,b=this._iTotalCount/5;try{for(i=0;i<b;i++){if(a)this.removeMessage(a.oData.sId);else throw new Error("Node not found, index = "+i);a=this._oPriorityList.oLastNode}}finally{this._iPruneCacheTimer=0}};b.isMessageValid=function Owa$MessageCache$isMessageValid(a,c){if(!a)return false;a=this._normalizeItemId(a);var b=this._oMessageCache[a];return b&&b.iLastModifiedTime>=c};b._normalizeItemId=function Owa$MessageCache$_normalizeItemId(a){return a};a.getSingletonInstance=function Owa$MessageCache$getSingletonInstance(){if(!g_oMessageCache)if(!Owa.Utility.isCurrentWindowRootOwaWindow()){var a=Owa.Utility.getRootOwaWindow();a.invokeFunction("createMessageCache");g_oMessageCache=a.getGlobalVariable("g_oMessageCache")}else createMessageCache();return g_oMessageCache};a.emptyCache=function Owa$MessageCache$emptyCache(){g_oMessageCache=null;if(!Owa.Utility.isCurrentWindowRootOwaWindow()){var a=Owa.Utility.getRootOwaWindow();a.setGlobalVariable("g_oMessageCache",null)}};a.addMessage=function Owa$MessageCache$addMessage(e,d,c,b){try{return a.getSingletonInstance().addMessage(e,d,c,b)}catch(f){}};a.removeMessage=function Owa$MessageCache$removeMessage(b){try{return a.getSingletonInstance().removeMessage(b)}catch(c){}};a.getMessage=function Owa$MessageCache$getMessage(c,b){try{return a.getSingletonInstance().getMessage(c,b)}catch(d){}};a.getMessageAndUpdateCounter=function Owa$MessageCache$getMessageAndUpdateCounter(c,b){try{return a.getSingletonInstance().getMessageAndUpdateCounter(c,b)}catch(d){}};a.isMessageValid=function Owa$MessageCache$isMessageValid(c,b){try{return a.getSingletonInstance().isMessageValid(c,b)}catch(d){}};Owa.MessageCache.createClass("Owa.MessageCache")})();g_fModuleLoaded[".\\components/messagecache.js".toLowerCase()]=1;var g_oMessageCache=null;function createMessageCache(){if(!g_oMessageCache)g_oMessageCache=new Owa.MessageCache}PrefetchContext=function _PrefetchContext(f,d,b,a,c,e){this.sId=f;this.sType=d;this.fIsNotPrefetched=b;this.iLastModifiedTime=a;this.oDocumentToWrite=c;this.sUrl=e;this.iIndex=-1};var PARENT_SUBPAGE_ID_ATTR="pspid";!g_fModuleLoaded[".\\uicontrols/subpagecontrollerbase.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls.SubPageControllerBase");Owa.UIControls.SubPageControllerBase=function Owa$UIControls$SubPageControllerBase(a){this._oElement=a;Owa.UIControls.SubPageControllerBase.constructBase(this);this._fNavigationDelayed=false;this._sUrl=null};var a=Owa.UIControls.SubPageControllerBase.prototype;a._fSupportUniqueId=true;a._get_Element=function Owa$UIControls$SubPageControllerBase$prototype$_get_Element(){return this._oElement};a.initialize=function Owa$UIControls$SubPageControllerBase$prototype$initialize(){Owa.UIControls.SubPageControllerBase.callBase(this,"initialize")};a.dispose=function Owa$UIControls$SubPageControllerBase$prototype$dispose(){Owa.UIControls.SubPageControllerBase.callBase(this,"dispose")};a.setExpando=function Owa$UIControls$SubPageControllerBase$setExpando(a,b){this._get_Element().setExpando(a,b)};a.getExpando=function Owa$UIControls$SubPageControllerBase$getExpando(a){return this._get_Element().getExpando(a)};a.set_IsShown=function Owa$UIControls$SubPageControllerBase$set_IsShown(b){var a=this.get_IsShown(true);this._get_Element().set_IsShown(b);if(a!=this.get_IsShown(true))this.get_SubPage()&&this.get_SubPage().fireIsVisibleChanged(!a)};a.get_IsShown=function Owa$UIControls$SubPageControllerBase$get_IsShown(c){var b=!!this._get_Element()&&this._get_Element().get_IsShown();if(!c)return b;var a=this.get_ParentController();return a&&!a.get_IsShown(true)?false:b};a.remove=function Owa$UIControls$SubPageControllerBase$remove(b){var a=this.get_ParentController();a&&a.removeChildController(this);if(this._get_Element())if(b)this._get_Element().remove(true);else this._get_Element().set_IsShown(false)};a.get_ChildrenControllers=function Owa$UIControls$SubPageControllerBase$get_ChildrenControllers(){if(!this._rgChildrenControllers)this._rgChildrenControllers=[];return this._rgChildrenControllers};a.addChildController=function Owa$UIControls$SubPageControllerBase$addChildController(a){if(!this._rgChildrenControllers)this._rgChildrenControllers=[];for(var b=0;b<this._rgChildrenControllers.length;b++)if(a.equals(this._rgChildrenControllers[b]))return;var c=a._get_Element();c.setAttribute(PARENT_SUBPAGE_ID_ATTR,this.get_UniqueId());this._rgChildrenControllers.push(a)};a.removeChildController=function Owa$UIControls$SubPageControllerBase$removeChildController(b){if(this._rgChildrenControllers)for(var a=0;a<this._rgChildrenControllers.length;a++)if(b.equals(this._rgChildrenControllers[a])){this._rgChildrenControllers.removeAt(a);return}};a.equals=function Owa$UIControls$SubPageControllerBase$equals(c){var a=this._get_Element(),b=c._get_Element();return a&&b?a.equals(b):false};a.get_NavigationDelayed=function Owa$UIControls$SubPageControllerBase$get_NavigationDelayed(){return this._fNavigationDelayed};a.get_DelayedURL=function Owa$UIControls$SubPageControllerBase$get_DelayedURL(){return this._sUrl};a.navigate=function Owa$UIControls$SubPageControllerBase$navigate(a,b){if(!b){this._fNavigationDelayed=false;this._navigate(a)}else{this._sUrl=a;this._fNavigationDelayed=true;shwPrgrsInd(L_Ld,null,true)}};Owa.UIControls.SubPageControllerBase.createClass("Owa.UIControls.SubPageControllerBase",Owa.Components.Control)})();g_fModuleLoaded[".\\uicontrols/subpagecontrollerbase.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/iSubPageController.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components.ISubPageController");Owa.UIControls.ISubPageController=function Owa$UIControls$ISubPageController(){throw new Error("Cannot create an instance of interface");};Owa.UIControls.ISubPageController.prototype.initialize=function Owa$UIControls$ISubPageController$initialize(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.remove=function Owa$UIControls$ISubPageController$remove(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.get_LocationURL=function Owa$UIControls$ISubPageController$get_LocationURL(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.navigate=function Owa$UIControls$ISubPageController$navigate(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype._navigate=function Owa$UIControls$ISubPageController$_navigate(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.navigateWithContents=function Owa$UIControls$ISubPageController$navigateWithContents(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.getVariable=function Owa$UIControls$ISubPageController$getVariable(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.invokeFunction=function Owa$UIControls$ISubPageController$invokeFunction(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.set_IsShown=function Owa$UIControls$ISubPageController$set_IsShown(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.get_IsShown=function Owa$UIControls$ISubPageController$get_IsShown(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.getElementById=function Owa$UIControls$ISubPageController$getElementById(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.get_ParentController=function Owa$UIControls$ISubPageController$get_ParentController(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.get_OpenerController=function Owa$UIControls$ISubPageController$get_OpenerController(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.prototype.close=function Owa$UIControls$ISubPageController$close(){throw new Error("Not implemented");};Owa.UIControls.ISubPageController.createInterface("Owa.UIControls.ISubPageController")})();g_fModuleLoaded[".\\components/iSubPageController.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/iframesubpagecontroller.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls.IframeSubPageController");Owa.UIControls.IframeSubPageController=function Owa$UIControls$IframeSubPageController(a){Owa.UIControls.IframeSubPageController.constructBase(this,[a])};Owa.UIControls.IframeSubPageController.prototype.initialize=function Owa$UIControls$IframeSubPageController$initialize(){};Owa.UIControls.IframeSubPageController.prototype._getContentWindow=function Owa$UIControls$IframeSubPageController$_getContentWindow(){try{return this._get_Element().get_ContentWindow()}catch(a){return null}};Owa.UIControls.IframeSubPageController.prototype.getVariable=function Owa$UIControls$IframeSubPageController$getVariable(b){var a=this.get_SubPage();return a?a.getSubPageVariable(b):null};Owa.UIControls.IframeSubPageController.prototype.invokeFunction=function Owa$UIControls$IframeSubPageController$invokeFunction(c,d,a){var b=this.get_SubPage();return!b?void 0:!a||a.equals&&a.equals(b)?b.invokeSubPageFunction(c,d):Owa.Dom.Window.get_Current().invokeFunction(c,d,a)};Owa.UIControls.IframeSubPageController.prototype.remove=function Owa$UIControls$IframeSubPageController$remove(){var b=this.get_SubPage();b&&!b.get_IsDisposed()&&b.dispose();var a=this._get_Element(),c=a.getExpando("fRemoveElementOnDispose")==1;if(!c){a.clearAllExpandos();a.set_Id("")}this.navigate("about:blank");Owa.UIControls.IframeSubPageController.callBase(this,"remove",[c]);this.dispose()};Owa.UIControls.IframeSubPageController.prototype.dispose=function Owa$UIControls$IframeSubPageController$dispose(){this.navigate("about:blank");var a=this._get_Element();if(a){a.set_IsShown(false);a.dispose();this._oElement=null}Owa.UIControls.IframeSubPageController.callBase(this,"dispose")};Owa.UIControls.IframeSubPageController.prototype.get_SubPage=function Owa$UIControls$IframeSubPageController$get_SubPage(){var a=this._getContentWindow();if(a&&a.getGlobalVariable("g_fOwa")){var b=a.getGlobalVariable("Owa");return b&&b.Components.Application.get_RootSubPage()}else return null};Owa.UIControls.IframeSubPageController.prototype.getElementById=function Owa$UIControls$IframeSubPageController$getElementById(c){var a=this._getContentWindow();if(a){var b=a.get_Document();if(b)return b.getElementById(c)}return null};Owa.UIControls.IframeSubPageController.prototype.get_LocationURL=function Owa$UIControls$IframeSubPageController$get_LocationURL(){var b=this._getContentWindow(),a=b.get_Location().search;if(Owa.Utility.isSafari())a=getOwaVdir()+a;return a};Owa.UIControls.IframeSubPageController.prototype._navigate=function Owa$UIControls$IframeSubPageController$_navigate(b){var a=this._get_Element();if(a){a.set_IsShown(true);a.set_Source(b)}};Owa.UIControls.IframeSubPageController.prototype.navigateWithContents=function Owa$UIControls$IframeSubPageController$navigateWithContents(){throw new Error("NotImplementedException");};Owa.UIControls.IframeSubPageController.prototype.get_OpenerController=function Owa$UIControls$IframeSubPageController$get_OpenerController(){return null};Owa.UIControls.IframeSubPageController.prototype.get_ParentController=function Owa$UIControls$IframeSubPageController$get_ParentController(){var a=this._get_Element().get_OwnerDocument().get_ContainerWindow(),b=this._get_Element().getAttribute(PARENT_SUBPAGE_ID_ATTR);return b?a.invokeFunction("getControllerByUniqueId",[b]):a.getGlobalVariable("g_fOwa")?Owa.Components.SubPageControllerFactory.getControllerByWindow(a):null};Owa.UIControls.IframeSubPageController.createClass("Owa.UIControls.IframeSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/iframesubpagecontroller.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/windowsubpagecontroller.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls.WindowSubPageController");Owa.UIControls.WindowSubPageController=function Owa$UIControls$WindowSubPageController(a){if(!a)a=Owa.Dom.Window.get_Current();this._oWindow=a;Owa.UIControls.WindowSubPageController.constructBase(this,[null])};Owa.UIControls.WindowSubPageController.prototype.initialize=function Owa$UIControls$WindowSubPageController$initialize(){};Owa.UIControls.WindowSubPageController.prototype._get_Element=function Owa$UIControls$WindowSubPageController$_get_Element(){var a=this._oWindow.get_FrameElement();if(!a)a=this._oWindow.get_Document().get_Body();return a};Owa.UIControls.WindowSubPageController.prototype._get_ContentWindow=function Owa$UIControls$WindowSubPageController$_get_ContentWindow(){return this._oWindow};Owa.UIControls.WindowSubPageController.prototype.getVariable=function Owa$UIControls$WindowSubPageController$getVariable(b){var a=this.get_SubPage();return a?a.getSubPageVariable(b):null};Owa.UIControls.WindowSubPageController.prototype.invokeFunction=function Owa$UIControls$WindowSubPageController$invokeFunction(c,d,a){var b=this.get_SubPage();return!b?void 0:!a||a.equals&&a.equals(b)?b.invokeSubPageFunction(c,d):Owa.Dom.Window.get_Current().invokeFunction(c,d,a)};Owa.UIControls.WindowSubPageController.prototype.remove=function Owa$UIControls$WindowSubPageController$remove(){throw new Error("WindowSubPageController cannot be removed");};Owa.UIControls.WindowSubPageController.prototype.get_SubPage=function Owa$UIControls$WindowSubPageController$get_SubPage(){var a=this._get_ContentWindow(),b=a.getGlobalVariable("Owa");return b.Components.Application.get_RootSubPage()};Owa.UIControls.WindowSubPageController.prototype.getElementById=function Owa$UIControls$WindowSubPageController$getElementById(c){var a=this._get_ContentWindow(),b=a.get_Document();return b.getElementById(c)};Owa.UIControls.WindowSubPageController.prototype.get_LocationURL=function Owa$UIControls$WindowSubPageController$get_LocationURL(){var a=this._get_ContentWindow();return a.get_Location().search};Owa.UIControls.WindowSubPageController.prototype._navigate=function Owa$UIControls$WindowSubPageController$_navigate(b){var a=this._get_ContentWindow();a.navigate(b)};function getParentControllerIDFromUrl(g){var h={},d=g.split("?")[1];if(d)for(var c=d.split("&"),a=0;a<c.length;a++){var b=c[a].split("="),f=b[0],e=b[1];if(f==PARENT_SUBPAGE_ID_ATTR)return e}return null}Owa.UIControls.WindowSubPageController.prototype.get_OpenerController=function Owa$UIControls$WindowSubPageController$get_OpenerController(){try{var c=this._get_ContentWindow(),a=c.get_Opener();if(a){var b=getParentControllerIDFromUrl(this.get_LocationURL());return b?a.invokeFunction("getControllerByUniqueId",[b]):new Owa.UIControls.WindowSubPageController(a)}}catch(d){}return null};Owa.UIControls.WindowSubPageController.prototype.get_ParentController=function Owa$UIControls$WindowSubPageController$get_ParentController(){var c=this._get_ContentWindow(),b=c.get_FrameElement();if(b){var a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);return a&&!a.get_IsDisposed()&&a.get_ParentController()}else return null};Owa.UIControls.WindowSubPageController.prototype.close=function Owa$UIControls$WindowSubPageController$close(){var a=this._get_ContentWindow();a.close()};Owa.UIControls.WindowSubPageController.prototype.reload=function Owa$UIControls$WindowSubPageController$reload(){var a=this._get_ContentWindow();return a.get_Location().reload()};Owa.UIControls.WindowSubPageController.prototype.equals=function Owa$UIControls$WindowSubPageController$equals(c){var a=this._get_ContentWindow(),b=c._get_ContentWindow();return a&&b?a.equals(b):false};Owa.UIControls.WindowSubPageController.createClass("Owa.UIControls.WindowSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/windowsubpagecontroller.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/divsubpagecontroller.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls.DivSubPageController");Owa.UIControls.DivSubPageController=function Owa$UIControls$DivSubPageController(a){Owa.UIControls.DivSubPageController.constructBase(this,[a])};var a=Owa.UIControls.DivSubPageController.prototype;a.getVariable=function Owa$UIControls$DivSubPageController$getVariable(b){var a=this.get_SubPage();return a&&a.getSubPageVariable(b)};a.invokeFunction=function Owa$UIControls$DivSubPageController$invokeFunction(c,d,a){var b=this.get_SubPage();return!b?void 0:!a||a.equals&&a.equals(b)?b.invokeSubPageFunction(c,d):Owa.Dom.Window.get_Current().invokeFunction(c,d,a)};a.get_SubPage=function Owa$UIControls$DivSubPageController$get_SubPage(){var a=this._get_Element().getExpando("__sSubPageUniqueId");return UniqueIdHashSet.get_Instance().get(a)};a.set_SubPage=function Owa$UIControls$DivSubPageController$set_SubPage(a){this._get_Element().setExpando("__sSubPageUniqueId",a?a.get_UniqueId():null)};a.remove=function Owa$UIControls$DivSubPageController$remove(){for(var b=this.get_ChildrenControllers(),a=0;a<b.length;a++)b[a].remove();var c=this.get_SubPage();this._get_Element().setExpando("__oSubPage",null);c&&c.dispose();Owa.UIControls.DivSubPageController.callBase(this,"remove",[true]);Owa.Components.Application.removePendingController(this);this.dispose()};a.dispose=function Owa$UIControls$DivSubPageController$dispose(){var a=this._get_Element();if(a){a.dispose();this._oElement=null}Owa.UIControls.DivSubPageController.callBase(this,"dispose")};a.getElementById=function Owa$UIControls$DivSubPageController$getElementById(b){var a=this._get_Element();return a?a.getDescendantById(b):null};a.get_LocationURL=function Owa$UIControls$DivSubPageController$get_LocationURL(){var b=this._get_Element(),a=b.getAttribute("url");if(Owa.Utility.isSafari())a=getOwaVdir()+a;return a};a._navigate=function Owa$UIControls$DivSubPageController$_navigate(b){var c=this._get_Element(),a=new oeReq("","",null,this._createCallback(this.cbGetSubPageContent),POST,null,null,null,null,null,null,true);a.sUrl=b;shwPrgrsInd(L_Ld);a.send()};a.cbGetSubPageContent=function Owa$UIControls$DivSubPageController$cbGetSubPageContent(a){var b=this._get_Element();if(this.get_IsDisposed()||!b){hdPrgrsInd();return}if(!cbOeh(a)){hdPrgrsInd();b.setBoolAttribute("fError",true);return}this.navigateWithContents({sHtml:a.sBody,sUrl:a.sUrl},false)};a.navigateWithContents=function Owa$UIControls$DivSubPageController$navigateWithContents(b,d){var c=this.get_SubPage(),a=this._get_Element();if(c&&!c.get_IsDisposed()){c.dispose();this.set_SubPage(null)}a.setBoolAttribute("fError",false);a.setAttribute("url",htmlEnc(b.sUrl));a.set_InnerHtml(b.sHtml);addPerfMarker("ReadingPane.Visible.End");a.setAttribute("_PageType",a.get_FirstChild().getAttribute("_PageType"));a.get_FirstChild().remove(true);this._oElement=a;if(d)this.cbGetSubPageContentStep2(b);else this._setTimeout(this.cbGetSubPageContentStep2,1,b)};a.cbGetSubPageContentStep2=function Owa$UIControls$DivSubPageController$cbGetSubPageContentStep2(){if(this.get_IsDisposed()||!this._get_Element()){hdPrgrsInd();return}this.initialize();hdPrgrsInd()};a.get_OpenerController=function Owa$UIControls$DivSubPageController$get_OpenerController(){return null};a.get_ParentController=function Owa$UIControls$DivSubPageController$get_ParentController(){var a=this._get_Element().get_OwnerDocument().get_ContainerWindow();if(!a.getGlobalVariable("g_fOwa"))return null;var b=this._get_Element().getAttribute(PARENT_SUBPAGE_ID_ATTR);return b?a.invokeFunction("getControllerByUniqueId",[b]):Owa.Components.SubPageControllerFactory.getControllerByWindow(a)};a._createSubPage=function Owa$UIControls$DivSubPageController$_createSubPage(){if(this.get_IsDisposed()||!this._get_Element())return;var a;if(this._get_Element().getAttribute("_PageType")){var b=eval("Owa.Pages."+this._get_Element().getAttribute("_PageType"));a=new b(this._get_Element())}else a=new Owa.UIControls.SubPage(this._get_Element());this.set_SubPage(a);a.initialize();this.get_IsShown()&&this.get_SubPage().fireFirstShow();updCmp(window,null,false,true)};a.notifyScriptReady=function Owa$UIControls$DivSubPageController$notifyScriptReady(){for(var c=true,b=this.rgExternalScriptFiles,a=0;a<b.length;a++)if(!Owa.Components.Application.isScriptLoaded(b[a])){c=false;break}if(c){Owa.Components.Application.removePendingController(this);this._createSubPage()}};a.initialize=function Owa$UIControls$DivSubPageController$initialize(){if(this.get_LocationURL()=="about:blank")return;var b=this._get_Element().getChildById("divExternalScriptFiles"),a=[];b.forEachChild(function(b){a.push(b.get_InnerHtml())});this.rgExternalScriptFiles=a;Owa.Components.Application.loadExternalScript(a);Owa.Components.Application.addPendingController(this);this.notifyScriptReady()};Owa.UIControls.DivSubPageController.createClass("Owa.UIControls.DivSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/divsubpagecontroller.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/subpagecontrollerfactory.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components.SubPageControllerFactory");Owa.Components.SubPageControllerFactory.getControllerByElement=function Owa$Components$SubPageControllerFactory$getControllerByElement(a){var b=null;if(!Owa.DomUtility.isOwaWindow(a.get_OwnerDocument().get_ContainerWindow()))return null;b=a.getExpando("subPageController");if(!b){var c=a.get_TagName().toLowerCase();if(c=="div")b=new Owa.UIControls.DivSubPageController(a,a.get_ParentElement());else if(c=="iframe")b=new Owa.UIControls.IframeSubPageController(a,a.get_ParentElement());else if(c=="body")b=this.get_CurrentWindowSubPageController();else throw new Error("Don't support creating sub page controller from "+c);a.setExpando("subPageController",b)}return b};Owa.Components.SubPageControllerFactory.getControllerFromParent=function Owa$Components$SubPageControllerFactory$getControllerFromParent(a){while(a){var b;b=a.getExpando("subPageController");if(b)return b;a=a.get_ParentElement()}};Owa.Components.SubPageControllerFactory.getControllerByWindow=function Owa$Components$SubPageControllerFactory$getControllerByWindow(c){var a=null,b=c.get_Document().get_Body();if(b)a=b.getExpando("subPageController");if(!a){var d=c.getGlobalVariable("Owa");if(d){a=new d.UIControls.WindowSubPageController;b&&b.setExpando("subPageController",a)}}return a};Owa.Components.SubPageControllerFactory.createControllerByUrl=function Owa$Components$SubPageControllerFactory$createControllerByUrl(e,f,j,g,h,i,k){var a=null,c=false;if(Owa.Components.SubPageControllerFactory.isOwaSubPageRequest(f))a=Owa.Dom.Document.get_Current().createElement("div");else{if(!g){var d=e.getDescendantsByTagName("iframe");if(d&&d.get_Length()>0){a=d[0];a.set_IsShown(true)}}if(!a){a=Owa.Dom.Document.get_Current().createElement("iframe");a.initFrameBorder(k);a.initAllowTransparency(true);a.setExpando("fRemoveElementOnDispose",g?1:0);c=true}}j&&a.set_Id(j);var b=Owa.Components.SubPageControllerFactory.getControllerByElement(a);if(Owa.Utility.isSafari()){(!Owa.UIControls.IframeSubPageController.isInstance(b)||c)&&e.appendChild(a);!h&&b.navigate(f,i)}else{!h&&b.navigate(f,i);(!Owa.UIControls.IframeSubPageController.isInstance(b)||c)&&e.appendChild(a)}return b};Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController=function Owa$Components$SubPageControllerFactory$get_CurrentWindowSubPageController(){var a=Owa.Dom.Window.get_Current();return Owa.Components.SubPageControllerFactory.getControllerByWindow(a)};function parseUrl(h){for(var c={ae:"",t:""},e=h.split("?")[1],d=e.split("&"),a=0;a<d.length;a++){var b=d[a].split("="),g=b[0],f=b[1];c[g]=f}return c}var a=[{ae:"Item",t:"IPM.Note.Microsoft.Exchange.Voice.CA"},{ae:"Item",t:"IPM.Note.Microsoft.Exchange.Voice"},{ae:"Item",t:"IPM.Note.Microsoft.Exchange.Fax.CA"},{ae:"Item",t:"IPM.Note.Microsoft.Voicemail.UM.CA"},{ae:"Item",t:"IPM.Note.rpmsg.Microsoft.Voicemail.UM.CA"},{ae:"Item",t:"IPM.Note.rpmsg.Microsoft.Voicemail.UM"},{ae:"Item",t:"IPM.Note.Microsoft.Voicemail"}],b=[{ae:"Folder",t:"IPF.Note"},{ae:"Folder",t:"IPF.StickyNote"},{ae:"Item",t:"IPM.Conversation"},{ae:"Item",t:"IPM.Note"},{ae:"Item",t:"IPM.Note.Microsoft.Fax.CA"},{ae:"Item",t:"IPM.Note.Mobile.SMS"},{ae:"Item",t:"IPM.Note.Rules.ReplyTemplate.Microsoft"},{ae:"Item",t:"REPORT.IPM.Note"},{ae:"Item",t:"IPM.Recall.Report"},{ae:"Item",t:"Disabled"},{ae:"Item",t:"IPM.Note.Microsoft.Exchange.Fax.CA"}];Owa.Components.SubPageControllerFactory.isOwaSubPageRequest=function Owa$Components$SubPageControllerFactory$isOwaSubPageRequest(c){if(isDf(typeof a_rgCustomizedFormRegistry)&&matchRegistry(c,a_rgCustomizedFormRegistry))return false;else if(matchRegistry(c,a))return false;else{var d=parseUrl(c);return d.t&&isSMime(d.t)?false:matchRegistry(c,b)}};function matchRegistry(h,e){for(var g=parseUrl(h),d=0;d<e.get_Length();d++){var a=e[d];if(!a)continue;var c=true;for(var b in a){var f=g[b]||"";if(b=="t"){if(!isOfClss(f,a[b])){c=false;break}}else if(a[b].toLowerCase()!=f.toLowerCase()){c=false;break}}if(c)return true}return false}})();g_fModuleLoaded[".\\components/subpagecontrollerfactory.js".toLowerCase()]=1;function getControllerByUniqueId(a){return UniqueIdHashSet.get_Instance().get(a)}!g_fModuleLoaded[".\\uicontrols/ActionButtons.js".toLowerCase()]&&(function(){Owa.UIControls.ActionButtons=function Owa$UIControls$ActionButtons(a,e,c,d,b){Owa.UIControls.ActionButtons.constructBase(this,[a]);this._fnOnAction=e;this._rgActionTables=d;this._fHasGhostState=c;this._fMultipleSelection=false;this._fGhostState=b;this._rgDisabledActions=[];this._fPostActions=a.hasCssClass("postActions");this._initialize()};Owa.UIControls.ActionButtons.REPLY="reply";Owa.UIControls.ActionButtons.REPLY_ALL="replyall";Owa.UIControls.ActionButtons.FORWARD="forward";Owa.UIControls.ActionButtons.FORWARD_AS_ATTACH="fwia";Owa.UIControls.ActionButtons.POST_REPLY="postreply";Owa.UIControls.ActionButtons.RG_ACTIONS=[Owa.UIControls.ActionButtons.REPLY,Owa.UIControls.ActionButtons.REPLY_ALL,Owa.UIControls.ActionButtons.FORWARD,Owa.UIControls.ActionButtons.POST_REPLY];Owa.UIControls.ActionButtons.prototype.getActions=function Owa$UIControls$ActionButtons$getActions(){return Owa.UIControls.ActionButtons.RG_ACTIONS};Owa.UIControls.ActionButtons.prototype._initialize=function Owa$UIControls$ActionButtons$_initialize(){Owa.UIControls.ActionButtons.callBase(this,"initialize");this._attachEvent(this._get_Element(),"click",this._onButtonClick);if(this._fHasGhostState){this._attachEvent(this._get_Element(),"mouseover",this._onMouseOverButton);this._attachEvent(this._get_Element(),"mouseout",this._onMouseOverButton)}if(!this._rgActionTables)return;this._stateChangeHandlers=[];var a=this.getActions();for(i=0;i<a.length;i++){var d=Owa.Utility.createArgumentContextDelegate(this,this._onButtonStateChanged,a[i]);this._stateChangeHandlers[a[i]]=d;var b=false;for(j=0;j<this._rgActionTables.length;j++)if(this._rgActionTables[j]){var c=this._rgActionTables[j].getAction(a[i]);if(c){c.get_StateChangeEventHandlers().add(d);b=b||!c.get_Enabled()}}b&&this.setActionButtonState(a[i],false)}};Owa.UIControls.ActionButtons.prototype.dispose=function Owa$UIControls$ActionButtons$dispose(){if(this._rgActionTables){var a=this.getActions();for(i=0;i<a.length;i++)for(j=0;j<this._rgActionTables.length;j++)this._rgActionTables[j]&&this._rgActionTables[j].getAction(a[i]).get_StateChangeEventHandlers().remove(this._stateChangeHandlers[a[i]])}Owa.UIControls.ActionButtons.callBase(this,"dispose")};Owa.UIControls.ActionButtons.prototype._onButtonStateChanged=function Owa$UIControls$ActionButtons$_onButtonStateChanged(b,a){this.setActionButtonState(a,b.fEnabled)};Owa.UIControls.ActionButtons.prototype.setGhostState=function Owa$UIControls$ActionButtons$setGhostState(a){this._fGhostState=a;var b=this.getActions();for(i=0;i<b.length;i++)this.setActionButtonState(b[i],this.getActionButtonState(b[i]),!a);this._get_Element().getDescendantById(Owa.Strings.Ids.ReplyIcon).set_IsShown(!a);this._get_Element().getDescendantById(Owa.Strings.Ids.ForwardIcon).set_IsShown(!a)};Owa.UIControls.ActionButtons.prototype.getActionButtonState=function Owa$UIControls$ActionButtons$getActionButtonState(b){switch(b){case Owa.UIControls.ActionButtons.REPLY:sButtonId=Owa.Strings.Ids.ReplyIcon;break;case Owa.UIControls.ActionButtons.REPLY_ALL:sButtonId=Owa.Strings.Ids.ReplyAllIcon;break;case Owa.UIControls.ActionButtons.FORWARD:sButtonId=Owa.Strings.Ids.ForwardIcon;break;case Owa.UIControls.ActionButtons.POST_REPLY:sButtonId=Owa.Strings.Ids.PostReplyIcon;break;default:return}var a=this._get_Element().getDescendantById(sButtonId);return a&&!a.hasCssClass("disabled")};Owa.UIControls.ActionButtons.prototype.setActionButtonState=function Owa$UIControls$ActionButtons$setActionButtonState(f,a,g){var c,b,d=g||!this._fGhostState;a=a&&!this._rgDisabledActions[f];switch(f){case Owa.UIControls.ActionButtons.REPLY:c=Owa.Strings.Ids.ReplyIcon;if(d)b=a?Owa.Strings.Icons.ReplyActive:Owa.Strings.Icons.ReplyDisabled;else b=a?Owa.Strings.Icons.ReplyGhost:Owa.Strings.Icons.ReplyGhostDisabled;break;case Owa.UIControls.ActionButtons.REPLY_ALL:c=Owa.Strings.Ids.ReplyAllIcon;if(d)b=a?Owa.Strings.Icons.ReplyAllActive:Owa.Strings.Icons.ReplyAllDisabled;else b=a?Owa.Strings.Icons.ReplyAllGhost:Owa.Strings.Icons.ReplyAllGhostDisabled;break;case Owa.UIControls.ActionButtons.FORWARD:c=Owa.Strings.Ids.ForwardIcon;if(d)b=a?Owa.Strings.Icons.ForwardActive:Owa.Strings.Icons.ForwardDisabled;else b=a?Owa.Strings.Icons.ForwardGhost:Owa.Strings.Icons.ForwardGhostDisabled;break;case Owa.UIControls.ActionButtons.POST_REPLY:c=Owa.Strings.Ids.PostReplyIcon;if(d)b=a?Owa.Strings.Icons.PostReplyActive:Owa.Strings.Icons.PostReplyDisabled;else b=a?Owa.Strings.Icons.PostReplyGhost:Owa.Strings.Icons.PostReplyGhostDisabled;break;default:return}var e=this._get_Element().getDescendantById(c);if(e){Owa.Components.CssSprites.updateImage(e,b);if(a)e.removeCssClass("disabled");else e.addCssClass("disabled")}};Owa.UIControls.ActionButtons.prototype.setActionAlwaysDisabled=function Owa$UIControls$ActionButtons$setActionAlwaysDisabled(a){this._rgDisabledActions[a]=true;this.setActionButtonState(a,false)};Owa.UIControls.ActionButtons.prototype._onButtonClick=function Owa$UIControls$ActionButtons$_onButtonClick(d){var a=null,c=d.get_Target();switch(c.get_Id()){case Owa.Strings.Ids.ReplyIcon:a=Owa.UIControls.ActionButtons.REPLY;break;case Owa.Strings.Ids.ReplyAllIcon:a=Owa.UIControls.ActionButtons.REPLY_ALL;break;case Owa.Strings.Ids.ForwardIcon:a=Owa.UIControls.ActionButtons.FORWARD;if(this._fMultipleSelection)a=Owa.UIControls.ActionButtons.FORWARD_AS_ATTACH;break;case Owa.Strings.Ids.PostReplyIcon:a=Owa.UIControls.ActionButtons.POST_REPLY}if(a&&!c.hasCssClass("disabled")){var b={};b.sAction=a;b.oEvent=d;this._fnOnAction(b)}};Owa.UIControls.ActionButtons.prototype._onMouseOverButton=function Owa$UIControls$ActionButtons$_onMouseOverButton(b){if(!this._fGhostState){b.preventDefault();b.cancelBubble();return}var c=b.get_Target(),a=b.get_Type()=="mouseover";switch(c.get_Id()){case Owa.Strings.Ids.ReplyIcon:this.setActionButtonState(Owa.UIControls.ActionButtons.REPLY,true,a);break;case Owa.Strings.Ids.ReplyAllIcon:this.setActionButtonState(Owa.UIControls.ActionButtons.REPLY_ALL,true,a);break;case Owa.Strings.Ids.ForwardIcon:this.setActionButtonState(Owa.UIControls.ActionButtons.FORWARD,true,a);case Owa.Strings.Ids.PostReplyIcon:this.setActionButtonState(Owa.UIControls.ActionButtons.POST_REPLY,true,a)}};Owa.UIControls.ActionButtons.prototype.setMultipleSelection=function Owa$UIControls$ActionButtons$setMultipleSelection(a){this._fMultipleSelection=a};Owa.UIControls.ActionButtons.createClass("Owa.UIControls.ActionButtons",Owa.UIControls.UIControl);var a="ntjnk";Owa.UIControls.JunkMailActionButtons=function Owa$UIControls$JunkMailActionButtons(b,c,a){Owa.UIControls.JunkMailActionButtons.constructBase(this,[b,c,null,a])};Owa.UIControls.JunkMailActionButtons.createClass("Owa.UIControls.JunkMailActionButtons",Owa.UIControls.ActionButtons);Owa.UIControls.JunkMailActionButtons.prototype.getActions=function Owa$UIControls$JunkMailActionButtons$getActions(){return[a]};Owa.UIControls.JunkMailActionButtons.prototype.setActionButtonState=function Owa$UIControls$JunkMailActionButtons$setActionButtonState(d,b){b=b&&!this._rgDisabledActions[d];if(d==a){var c=this._get_Element().getDescendantById(Owa.Strings.Ids.NotJunkText);if(b)c.removeCssClass("disabled");else c.addCssClass("disabled")}};Owa.UIControls.JunkMailActionButtons.prototype._onButtonClick=function Owa$UIControls$JunkMailActionButtons$_onButtonClick(d){var c=d.get_Target();if(c.get_Id()==Owa.Strings.Ids.NotJunkText&&!c.hasCssClass("disabled")){var b={};b.sAction=a;this._fnOnAction(b)}}})();g_fModuleLoaded[".\\uicontrols/ActionButtons.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/MeetingInfoArea.js".toLowerCase()]&&(function(){Owa.UIControls.MeetingInfoArea=function Owa$UIControls$MeetingInfoArea(a,b){Owa.UIControls.MeetingInfoArea.constructBase(this,[a]);this._fInitializationDeferred=false;this._fnOnAction=b;this.initialize()};Owa.UIControls.MeetingInfoArea.prototype.get_initializationDeferred=function Owa$UIControls$MeetingInfoArea$get_initializationDeferred(){return this._fInitializationDeferred};Owa.UIControls.MeetingInfoArea.prototype.initialize=function Owa$UIControls$MeetingInfoArea$initialize(){Owa.UIControls.MeetingInfoArea.callBase(this,"initialize");if(!this._get_Element().get_IsShown()||this._get_Element().get_OffsetHeight()==0){this._fInitializationDeferred=true;return}this.initializeMeetingParts()};Owa.UIControls.MeetingInfoArea.prototype.dispose=function Owa$UIControls$MeetingInfoArea$dispose(){var a=this._get_Element().getDescendantById("divMtgCancelLink");a&&a.detachAllEvents()};Owa.UIControls.MeetingInfoArea.prototype.initializeMeetingParts=function Owa$UIControls$MeetingInfoArea$initializeMeetingParts(){var j=["openCalendarTb","mtgHeaderTb","divWhenL","divLocationL"],i=Owa.Layout.setElementWidthsToLargest(j,null,this._get_Element()),g=this._get_Element().getDescendantById("divMtgTbWhen");if(!g_fRtl)g.set_Left(i);else g.set_Right(i);var c=this._get_Element().getDescendantById("openCalendarTb");if(c){var e=c.get_FirstChild(),a=c.get_OffsetWidth()-e.get_OffsetWidth(),h=a<0?0:a/2;e.set_Margin(Owa.Style.Side.Left,h)}var b=this._get_Element().getDescendantById("mtgHeaderTb");if(b){var d=b.get_FirstChild(),a=b.get_OffsetWidth()-d.get_OffsetWidth(),h=a<0?0:a/2;d.set_Margin(Owa.Style.Side.Left,h)}var f=this._get_Element().getDescendantById("divMtgCancelLink");f&&this._attachEvent(f,"click",this._onClickHandler);this._fInitializationDeferred=false};Owa.UIControls.MeetingInfoArea.prototype.fixMeetingPartsSize=function Owa$UIControls$MeetingInfoArea$fixMeetingPartsSize(i){if(i<0)return;var f=this._get_Element().getDescendantById("divMtgInfoToolbars"),g=this._get_Element().getDescendantById("divMtgTbWhen"),a=this._get_Element().getDescendantById("divWhenL"),d=this._get_Element().getDescendantById("mpToolbar"),e=this._get_Element().getDescendantById("openCalendarTb");f.set_Width(i);if(!this._iMinToolbarsHeight)this._iMinToolbarsHeight=e?e.get_OffsetHeight():d?d.get_OffsetHeight():a.get_OffsetHeight();var c=g.get_OffsetHeight(),b=this._iMinToolbarsHeight-c,h=b<0?0:b/2;g.set_Margin(Owa.Style.Side.Top,h);a&&a.set_Margin(Owa.Style.Side.Top,h);var j=b>0?this._iMinToolbarsHeight:c+3;f.set_Height(j)};Owa.UIControls.MeetingInfoArea.prototype._onClickHandler=function Owa$UIControls$MeetingInfoArea$_onClickHandler(b){var a=b.get_Target();a.get_Id()=="divMtgCancelLink"&&this._fnOnAction(Owa.Strings.Ids.Remove)};Owa.UIControls.MeetingInfoArea.createClass("Owa.UIControls.MeetingInfoArea",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/MeetingInfoArea.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/treenode.js".toLowerCase()]&&(function(){var a=21;Owa.Components.TreeNode=function Owa$Components$TreeNode(a,b){Owa.Components.TreeNode.constructBase(this);this._oElement=a;this._tr=b};Owa.Components.TreeNode.createClass("Owa.Components.TreeNode",Owa.Components.Control);var b=Owa.Components.TreeNode.prototype;b._fClearTimeoutCallbackInDisposing=true;Owa.Components.TreeNode.prototype.equals=function Owa$Components$TreeNode$equals(a){return a&&this.inTr(a._tr)&&this.gtId()==a.gtId()};Owa.Components.TreeNode.prototype._get_Element=function Owa$Components$TreeNode$_get_Element(){return this._oElement};Owa.Components.TreeNode.prototype.get_Id=function Owa$Components$TreeNode$get_Id(){return this._oElement.get_Id()};Owa.Components.TreeNode.prototype.isRt=function Owa$Components$TreeNode$isRt(){var a=this.getContainer().get_ParentElement();if(a)return a.getExpando("isRoot")};Owa.Components.TreeNode.prototype.hdCnt=function Owa$Components$TreeNode$hdCnt(){this.getContent().set_IsShown(false)};Owa.Components.TreeNode.prototype.shwCnt=function Owa$Components$TreeNode$shwCnt(){this.getContent().set_IsShown(true)};Owa.Components.TreeNode.prototype.gtDspNm=function Owa$Components$TreeNode$gtDspNm(){return this.getContent().get_TextContent()};Owa.Components.TreeNode.prototype.stDspNm=function Owa$Components$TreeNode$stDspNm(a){this.getContent().set_TextContent(a)};Owa.Components.TreeNode.prototype.hsChld=function Owa$Components$TreeNode$hsChld(){return this._get_Element().getAttribute("_hsChld")};Owa.Components.TreeNode.prototype.getChildIndent=function Owa$Components$TreeNode$getChildIndent(){var a=this._get_Element().getIntAttribute("_chldIndnt");return a?a:0};Owa.Components.TreeNode.prototype.getIndent=function Owa$Components$TreeNode$getIndent(){var a=this._get_Element().getIntAttribute("_indnt");return a?a:0};Owa.Components.TreeNode.prototype.setIndent=function Owa$Components$TreeNode$setIndent(b){var d=this.gtEC(),c=this.getContent();if(d)if(g_fRtl)d.set_Right(b);else d.set_Left(b);if(c)if(g_fRtl)c.set_Right(b+a);else c.set_Left(b+a);this._get_Element().setIntAttribute("_indnt",b)};Owa.Components.TreeNode.prototype.gtEC=function Owa$Components$TreeNode$gtEC(){return this.gtHl().getChildById(EC)};Owa.Components.TreeNode.prototype.getContainer=function Owa$Components$TreeNode$getContainer(){return this.gtHl().get_ParentElement()};Owa.Components.TreeNode.prototype.gtHl=function Owa$Components$TreeNode$gtHl(){return this._get_Element().get_ParentElement()};Owa.Components.TreeNode.prototype.gtCC=function Owa$Components$TreeNode$gtCC(){return this.getContainer().getChildById(NODE_CHILDREN)};Owa.Components.TreeNode.prototype.gtId=function Owa$Components$TreeNode$gtId(){return this._get_Element().get_Id()};Owa.Components.TreeNode.prototype.getContent=function Owa$Components$TreeNode$getContent(){return this._get_Element().getChildById(NODE_CONTENT)};Owa.Components.TreeNode.prototype.gtImg=function Owa$Components$TreeNode$gtImg(){return this._get_Element().getChildById(NODE_ICON)};Owa.Components.TreeNode.prototype.stUTD=function Owa$Components$TreeNode$stUTD(a){this._get_Element().setAttribute("_sync",a?null:"1")};Owa.Components.TreeNode.prototype.isUTD=function Owa$Components$TreeNode$isUTD(){return!this._get_Element().getAttribute("_sync")};Owa.Components.TreeNode.prototype.canMv=function Owa$Components$TreeNode$canMv(){return 0};Owa.Components.TreeNode.prototype.canCp=function Owa$Components$TreeNode$canCp(){return 0};Owa.Components.TreeNode.prototype.canDel=function Owa$Components$TreeNode$canDel(){return 0};Owa.Components.TreeNode.prototype.canCrt=function Owa$Components$TreeNode$canCrt(){return 0};Owa.Components.TreeNode.prototype.canRnm=function Owa$Components$TreeNode$canRnm(){return 0};Owa.Components.TreeNode.prototype.inTr=function Owa$Components$TreeNode$inTr(a){return this._tr.root.equals(a.root)};Owa.Components.TreeNode.prototype.isExp=function Owa$Components$TreeNode$isExp(){return this._get_Element().getAttribute("_exp")};Owa.Components.TreeNode.prototype.getIntAttribute=function Owa$Components$TreeNode$getIntAttribute(a){return this._get_Element().getIntAttribute(a)};Owa.Components.TreeNode.prototype.setIntAttribute=function Owa$Components$TreeNode$setIntAttribute(a,b){return this._get_Element().setIntAttribute(a,b)};Owa.Components.TreeNode.prototype.isEC=function Owa$Components$TreeNode$isEC(a){return a.get_Id()==EC};Owa.Components.TreeNode.prototype._onBeforeContextMenu=function Owa$Components$TreeNode$_onBeforeContextMenu(){return true};Owa.Components.TreeNode.prototype.shwPrg=function Owa$Components$TreeNode$shwPrg(c,b){if(this._get_Element().getExpando("_prg"))return;var a={};a={};a._img=b;a._tid=this._setTimeout(this.shwPrgTO,c);this._get_Element().setExpando("_prg",a)};Owa.Components.TreeNode.prototype.shwPrgTO=function Owa$Components$TreeNode$shwPrgTO(){var d=this._get_Element(),a=d.getExpando("_prg");if(!a)return;a._tid=0;var c=a._img?this.gtImg():this.gtEC(),f=a._img?"prI":"prEC",e="<img id="+PR+' class="'+f+'" src="'+g_sTimerIco+'">';if(c){c.set_IsShown(false);c.insertAdjacentHtml("beforeBegin",e)}else d.insertAdjacentHtml("beforeBegin",e);var b=this.gtHl().getChildById(PR);if(b)if(g_fRtl)b.set_Right(this.getIndent());else b.set_Left(this.getIndent())};Owa.Components.TreeNode.prototype.hdPrg=function Owa$Components$TreeNode$hdPrg(){var a=this._get_Element().getExpando("_prg");if(!a)return;this._get_Element().setExpando("_prg",null);if(a._tid)return this._clearTimeout(a._tid);var b=this.gtHl().getDescendantById(PR);b&&b.remove(true);var c=a._img?this.gtImg():this.gtEC();c&&c.set_IsShown(true)};Owa.Components.TreeNode.prototype.tggl=function Owa$Components$TreeNode$tggl(){if(this.isExp())this.collapse();else this.expand()};Owa.Components.TreeNode.prototype.sync=function Owa$Components$TreeNode$sync(){if(this.hsChld()&&!this.isUTD()&&this._tr.getChildren){this._tr.getChildren(this);this.shwPrg(1);return 1}};Owa.Components.TreeNode.prototype.persistExp=function Owa$Components$TreeNode$persistExp(){};Owa.Components.TreeNode.prototype.expand=function Owa$Components$TreeNode$expand(){if(this.isExp()||!this.hsChld())return;var a=this.gtCC();if(!a||!a.hasChildNodes())if(this.sync())return;this._get_Element().setAttribute("_exp","1");this.upd();this._tr.fireOnResize();this.persistExp(1)};Owa.Components.TreeNode.prototype.collapse=function Owa$Components$TreeNode$collapse(){if(!this.isExp())return;this._get_Element().setAttribute("_exp",null);this.upd();this._tr.fireOnResize();this.persistExp(0)};Owa.Components.TreeNode.prototype.upd=function Owa$Components$TreeNode$upd(){var a=this.gtCC(),b=this.gtEC(),c=a&&a.hasChildNodes()?"1":null;!c&&a&&a.set_IsShown(false);this.hsChld()!=c&&this.isUTD()&&this._get_Element().setAttribute("_hsChld",c);if(this.hsChld()){if(b)b._get_DomNode().style.cursor=POINTER;if(this.isExp()){b&&Owa.Components.CssSprites.updateImage(b,g_sMinusIco);a.set_IsShown(true);this.equals(this._tr.gtNdByAls(ALP_DFT+DFT_DEL))&&this.gtHl().removeCssClass("trNdDelFol");oP=this.getContainer().get_ParentElement();if(oP&&oP.get_LastChild())oLastChd=this._tr.gtNd(oP.get_LastChild());if(this.isRt()||oLastChd&&!this.equals(oLastChd))a.getEffectivePadding(Owa.Style.Side.Bottom)<9&&a.set_Padding(Owa.Style.Side.Bottom,a.getEffectivePadding(Owa.Style.Side.Bottom)+9)}else{if(b)Owa.Components.CssSprites.updateImage(b,g_sPlusIco);else{var e=this._tr.mkECH(g_sPlusIco,this._get_Element()),d=this.getIndent();this.gtHl().insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,e);this.setIndent(d)}if(a){a.set_IsShown(false);this.equals(this._tr.gtNdByAls(ALP_DFT+DFT_DEL))&&this.gtHl().addCssClass("trNdDelFol");a.getEffectivePadding(Owa.Style.Side.Bottom)>=9&&a.set_Padding(Owa.Style.Side.Bottom,a.getEffectivePadding(Owa.Style.Side.Bottom)-9)}}}else if(b){Owa.Components.CssSprites.updateImage(b,g_sNoChildIco);b._get_DomNode().style.cursor=AUTO}};Owa.Components.TreeNode.prototype.setHighlightEffect=function Owa$Components$TreeNode$setHighlightEffect(d,a){var b=this.gtHl().getChildById(NODE_EFFECT);if(d||a){if(!b){b=this._tr.root.get_OwnerDocument().createElement(DIV);b.set_Id(NODE_EFFECT);this.gtHl().insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,b)}}else{b&&b.remove();return}if(d)b.set_CssClasses(["trNdSel",d]);else{var c=b._get_DomNode().style;c.backgroundColor=a.bgC?a.bgC:"";c.borderColor=a.bdrC?a.bdrC:"";c.borderStyle=a.bdrS?a.bdrS:"";c.borderWidth=a.bdrW?a.bdrW:"";c.color=a.c?a.c:""}};Owa.Components.TreeNode.prototype.clearHighlightEffect=function Owa$Components$TreeNode$clearHighlightEffect(){var a=this.gtHl().getChildById(NODE_EFFECT);a&&a.remove(true)};Owa.Components.TreeNode.prototype.canSel=function Owa$Components$TreeNode$canSel(){return!this._get_Element().getAttribute("_nosel")};Owa.Components.TreeNode.prototype.isSel=function Owa$Components$TreeNode$isSel(){return this._get_Element().getAttribute("_sel")};Owa.Components.TreeNode.prototype.stSel=function Owa$Components$TreeNode$stSel(a){this._get_Element().setAttribute("_sel",a?"1":null)};Owa.Components.TreeNode.prototype.stHl=function Owa$Components$TreeNode$stHl(a){if(a){this.setHighlightEffect(this._tr.getSelectionClass());this._get_Element().setAttribute("_hl","1")}else{this.clearHighlightEffect(this._tr.getSelectionClass());this._get_Element().setAttribute("_hl",null)}};Owa.Components.TreeNode.prototype.isHl=function Owa$Components$TreeNode$isHl(){return this._get_Element().getAttribute("_hl")};Owa.Components.TreeNode.prototype.stDrpHl=function Owa$Components$TreeNode$stDrpHl(a){if(a)this.setHighlightEffect(this._tr.getDragEffectClass());else this.stHl(this.isSel())};Owa.Components.TreeNode.prototype.canDrg=function Owa$Components$TreeNode$canDrg(){return 0};Owa.Components.TreeNode.prototype.onDrg=function Owa$Components$TreeNode$onDrg(){return};Owa.Components.TreeNode.prototype.drpIn=function Owa$Components$TreeNode$drpIn(){return};Owa.Components.TreeNode.prototype.canDrpExp=function Owa$Components$TreeNode$canDrpExp(){return true};Owa.Components.TreeNode.prototype.gtDrpMd=function Owa$Components$TreeNode$gtDrpMd(){return DRP_NONE};Owa.Components.TreeNode.prototype.addGuidEntryForEws=function Owa$Components$TreeNode$prototype$addGuidEntryForEws(){var a=this._oElement.getAttribute("guid");if(a&&EwsService){var b=Ews.BaseId.ParseMailboxLegacyDN(this._oElement.get_Id().slice(1));EwsService.AddGuidEntry(b,a)}}})();g_fModuleLoaded[".\\uicontrols/treenode.js".toLowerCase()]=1;var TN_FTN="folderTreeNode",TN_GH="navigationGroupHeaderNode",DIV="div",A="a",AUTO="auto",POINTER="pointer",CONTENT_OFFSET=21,TR="divTr",NODE_CHILDREN="divTrNdCC",NODE_HIGHLIGHT="divTrNdHl",NODE_EFFECT="divTrNdEff",NODE_CONTAINER="divTrNdO",EC="ec",PR="pr",NODE_ICON="imgTrNd",NODE_CONTENT="spnTrNdCnt",DRP_NONE=0,DRP_COPY=1,DRP_MOVE=2,DRP_LINK=3,DRP_IC_MSK=3,DRP_EFF_MSK=12,DRP_ABOVE=4,DRP_BELOW=8,AFLG_PRV=1,AFLG_PRT=2,AFLG_RT=16,EFF_WEBCAL=256,EFF_SHI=1024,EFF_EXB=33554432,EFF_RMH=67108864,EFF_XORG=1073741824,EFF_PUBOUT=2147483648,FRT_ALL=0,FRT_HSF=1,FRT_HGF=2,g_sPlusIco,g_sMinusIco,g_sNoChildIco,g_sTimerIco,g_rgsFIcns=[];g_rgsFIcns[T_MSG]="fldr.png";g_rgsFIcns[T_CAL]="appt.gif";g_rgsFIcns[T_CON]="contact.gif";g_rgsFIcns[T_TSK]="tsk.gif";g_rgsFIcns[T_NTS]="notes.png";g_rgsFIcns[T_JNL]="journal.gif";var GS_FVR="1",GS_CAL="3",GS_CNT="4",GS_TSK="5",EDT_INPT=1,EDT_CHK=2,ECR_ESC=0,ECR_ENTER=1,ECR_FO=2,FKID="FakeNode",FNID="spnFldrNm",AL_DEF="default",ALP_DFT="DFT.",g_iPrgIndQt,CCDT_NONE=0,CCDT_ITMC=1;(function(){var b="trDrgEff",a="trDefSel";Owa.UIControls.TreeControl=function Owa$UIControls$TreeControl(c){Owa.UIControls.TreeControl.constructBase(this,[c]);this.root=c;if(!g_sPlusIco){if(g_fRtl){g_sPlusIco="plusrtl.png";g_sMinusIco="minusrtl.png"}else{g_sPlusIco="plus.png";g_sMinusIco="minus.png"}g_sNoChildIco="clear.gif";g_sTimerIco=getThmF("pgrs-sm.gif")}this._aDict={};this._sSelelectionClass=a;this._sDragEffectClass=b;this.root.setExpando("isRoot",1);this._sErrNm=this.root.getAttribute("_errDiv");this._sHdErrNm=this.root.getAttribute("_errHd");this.initialize()};Owa.UIControls.TreeControl.createClass("Owa.UIControls.TreeControl",Owa.UIControls.UIControl);Owa.UIControls.TreeControl.prototype.initialize=function Owa$UIControls$TreeControl$initialize(){Owa.UIControls.TreeControl.callBase(this,"initialize");if(!this._sSelNdId){this._sSelNdId=null;this._sHlNdId=null;for(var b=this.root.getDescendantsByTagName(DIV),a=0;a<b.length;a++)if(b[a].getAttribute("_sel")){this.stNdSel(this.gtNd(b[a]),1);break}}else this.syncSelNHl();this._onKD&&this._attachEvent(this.root,"keydown",this._onKD);if(this._onDO){this._attachEvent(this.root,"dragenter",this._onDO);this._attachEvent(this.root,"dragover",this._onDO);Owa.Components.Storage.DragDrop.enableDNDInFireFox(this._get_Element())}this._onDrp&&this._attachEvent(this.root,"drop",this._onDrp);this._onDL&&this._attachEvent(this.root,"dragleave",this._onDL);this._onClk&&this._attachEvent(this.root,"click",this._onClk);this._onContextMenuEventHandler&&this._attachEvent(this.root,"contextmenu",this._onContextMenuEventHandler);this._onDS&&this._attachEvent(this.root,"dragstart",this._onDS);this._onSS&&this._attachEvent(this.root,"selectstart",this._onSS)};Owa.UIControls.TreeControl.prototype.dispose=function Owa$UIControls$TreeControl$dispose(){this._edting&&this.qtEdtNd();this.root.detachAllEvents();this._oElement=null;this.root=null;this._edt=null;this._drp=null;this._aDict=null;Owa.UIControls.TreeControl.callBase(this,"dispose")};Owa.UIControls.TreeControl.prototype.stAls=function Owa$UIControls$TreeControl$stAls(a,b){if(b)this._aDict[a]=b;else{this._aDict[a]=null;delete this._aDict[a]}};Owa.UIControls.TreeControl.prototype.clrAls=function Owa$UIControls$TreeControl$clrAls(){this._aDict={}};Owa.UIControls.TreeControl.prototype.get_ContextMenu=function Owa$UIControls$TreeControl$get_ContextMenu(){return this._oContextMenu};Owa.UIControls.TreeControl.prototype.set_ContextMenu=function Owa$UIControls$TreeControl$set_ContextMenu(a){this._oContextMenu=a};Owa.UIControls.TreeControl.prototype.gtNd=function Owa$UIControls$TreeControl$gtNd(a){if(!a)return;while(a&&!a.getExpando("isRoot")&&(a.get_Id()!=NODE_CONTAINER&&a.get_Id()!=NODE_HIGHLIGHT&&a.get_Id()!=NODE_CHILDREN))a=a.get_ParentElement();if(!a||a.getExpando("isRoot"))return;var c=a.get_Id(),b;if(c==NODE_CONTAINER)b=a.getChildById(NODE_HIGHLIGHT).getDescendantsByTagName(A)[0];else if(c==NODE_HIGHLIGHT)b=a.getDescendantsByTagName(A)[0];else if(c==NODE_CHILDREN)b=a.get_ParentElement().getChildById(NODE_HIGHLIGHT).getDescendantsByTagName(A)[0];if(b)return this.wrapNd(b)};Owa.UIControls.TreeControl.prototype.wrapNd=function Owa$UIControls$TreeControl$wrapNd(a){return new Owa.Components.TreeNode(a,this)};Owa.UIControls.TreeControl.prototype.gtNdById=function Owa$UIControls$TreeControl$gtNdById(b){var a=this.gtDomNdById(b);return a?this.wrapNd(a):a};Owa.UIControls.TreeControl.prototype.gtChdNdById=function Owa$UIControls$TreeControl$gtChdNdById(b,d){if(!b)return;var c=b.gtCC();if(!c)return;var a=c.getDescendantById(d);return!a?void 0:this.gtNd(a)};Owa.UIControls.TreeControl.prototype.gtNdFrstChld=function Owa$UIControls$TreeControl$gtNdFrstChld(b){var a=b.gtCC();return!a||!a.get_FirstChild()?void 0:this.gtNd(a.get_FirstChild())};Owa.UIControls.TreeControl.prototype.gtNdRt=function Owa$UIControls$TreeControl$gtNdRt(){return this.gtNd(this.root.get_FirstChild())};Owa.UIControls.TreeControl.prototype.gtDomNdById=function Owa$UIControls$TreeControl$gtDomNdById(a){if(a&&this.root)return this.root.getDescendantById(a)};Owa.UIControls.TreeControl.prototype.gtNdPrnt=function Owa$UIControls$TreeControl$gtNdPrnt(a){return a.isRt()?void 0:this.gtNd(a.getContainer().get_ParentElement())};Owa.UIControls.TreeControl.prototype.gtNdNxt=function Owa$UIControls$TreeControl$gtNdNxt(a){return this.gtNd(a.getContainer().get_NextSibling())};Owa.UIControls.TreeControl.prototype.gtNdPrv=function Owa$UIControls$TreeControl$gtNdPrv(a){return this.gtNd(a.getContainer().get_PreviousSibling())};Owa.UIControls.TreeControl.prototype.gtNdByAls=function Owa$UIControls$TreeControl$gtNdByAls(a){return this.gtNdById(this._aDict[a])};Owa.UIControls.TreeControl.prototype.isContainer=function Owa$UIControls$TreeControl$isContainer(a){return a.get_Id()==NODE_CONTAINER};Owa.UIControls.TreeControl.prototype.stKds=function Owa$UIControls$TreeControl$stKds(a,b){this.clrKds(a);this.addKds(a,b)};Owa.UIControls.TreeControl.prototype.clrKds=function Owa$UIControls$TreeControl$clrKds(a){var b=a._get_Element();a.gtCC()&&a.gtCC().remove(true);b.setAttribute("_exp",null);b.setAttribute("_hsChld",null);this.rplcNd(a.gtId(),b)};Owa.UIControls.TreeControl.prototype.rmNd=function Owa$UIControls$TreeControl$rmNd(b){var a=this.gtNdPrnt(b),c=b.getContainer();c.remove(true);if(!a)return;var c=a.gtCC();if(c.hasChildNodes()==0){b.gtId()!=FKID&&a._get_Element().setAttribute("_hsChld","0");a._get_Element().setAttribute("_exp",null)}a.upd();this.fireOnResize()};Owa.UIControls.TreeControl.prototype.rplcNd=function Owa$UIControls$TreeControl$rplcNd(g,c,b){var a=this.gtNdById(g);if(!a||!c)return;if(!Owa.Utility.isDefined(typeof b))b=a.getIndent();var e=a.getContainer(),f=this.wrapContainer(c,b);e.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,f);e.remove(true);var d=this.gtNdById(c.get_Id());d.stSel(a.isSel());d.stHl(a.isHl());this._drp&&this.drpHlNd(this._drp.oNd,this._drp.sDM);return d._get_Element()};Owa.UIControls.TreeControl.prototype.addKdPos=function Owa$UIControls$TreeControl$addKdPos(d,f,b,c,e){var a=this.root.get_OwnerDocument().createElement(DIV);a.appendChild(f);if(c)this.insrtKdsPos(c,a.getChildrenSnapshot(),b,e);else this.addKds(d,a.getChildrenSnapshot(),b)};Owa.UIControls.TreeControl.prototype.addKds=function Owa$UIControls$TreeControl$addKds(a,d,j){var c=a.gtCC();a._get_Element().setAttribute("_hsChld","1");if(!c){this.rplcNd(a.gtId(),a._get_Element());c=a.gtCC()}var i=a.getIndent()+a.getChildIndent();while(d.length>0){var b=d.shift();if(!this.isContainer(b))b=this.wrapContainer(b,i,j);var e=b.getDescendantsByTagName("A");if(e.length){var f=e[0],g=f.getAttribute("guid");if(g){var h=Ews.BaseId.ParseMailboxLegacyDN(f.get_Id().slice(1));EwsService.AddGuidEntry(h,g)}}c.appendChild(b)}a.upd();this.fireOnResize()};Owa.UIControls.TreeControl.prototype.insrtKdsPos=function Owa$UIControls$TreeControl$insrtKdsPos(f,b,h,e){var g=f.getIndent(),d=f.getContainer();while(b.length>0){var c=e?b.pop():b.shift(),a;if(this.isContainer(c))a=c;else a=this.wrapContainer(c,g,h);if(!e)d.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,a);else d.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,a)}this.fireOnResize()};Owa.UIControls.TreeControl.prototype.mkECH=function Owa$UIControls$TreeControl$mkECH(b,c,a){return Owa.Components.CssSprites.getImageMarkup(b,'id="'+EC+'" style="'+(g_fRtl?"right":"left")+":"+a+'px"')};Owa.UIControls.TreeControl.prototype.wrapContainer=function Owa$UIControls$TreeControl$wrapContainer(a,c,g){var e=a.getAttribute("_hsChld"),i=a.getAttribute("_exp")?g_sMinusIco:g_sPlusIco,h=e?this.mkECH(i,a,c):g?this.mkECH(g_sNoChildIco,a):"",f=e?'<div id="'+NODE_CHILDREN+'" style="display: none; width: 100%"></div>':"",b=this.root.get_OwnerDocument().createElement(DIV),d=a.getAttribute("_hlCls");d=d?d:"trNdHl";b.set_Id(NODE_CONTAINER);b.set_InnerHtml('<div id="'+NODE_HIGHLIGHT+'" class="'+d+'">'+h+"</div>"+f);b.get_FirstChild().appendChild(a);if(g_fRtl)a.set_Right(c+CONTENT_OFFSET);else a.set_Left(c+CONTENT_OFFSET);a.setIntAttribute("_indnt",c);return b};Owa.UIControls.TreeControl.prototype.isAncstr=function Owa$UIControls$TreeControl$isAncstr(b,c,d){if(!b||!c)return;if(d&&b.equals(c))return 1;var a=c;while(a){a=this.gtNdPrnt(a);if(a&&a.equals(b))return 1}};Owa.UIControls.TreeControl.prototype.createNewNode=function Owa$UIControls$TreeControl$createNewNode(h,d,e,g,a){a=a?a:{};var c=this.root.get_OwnerDocument().createElement(DIV),b='<a class="'+(a.bodyClassName?a.bodyClassName:"trNd")+'" hideFocus=1 href="#"';b+=' id="'+h+'"';if(a.nosel)b+=" _nosel=1";if(a.sync)b+=" _sync=1";else b+=" _sync=0";if(a.exp)b+=" _exp=1";if(a.padding)b+=" _pd="+a.padding;if(a.highlightClassName)b+=' _hlCls="'+a.highlightClassName+'"';b+=">";if(a.contentHTML)b+=a.contentHTML+"</a>";else{if(a.iconHTML)b+=a.iconHTML;b+='<span id="'+NODE_CONTENT+'"'+(a.contentClassName?' class="'+a.contentClassName+'"':"")+">"+(a.contentInnerHTML?a.contentInnerHTML:"")+"</span></a>"}c.set_InnerHtml(b);var f=this.wrapNd(Owa.Dom.Node.wrapDomNode(c._get_DomNode().childNodes[0]));if(e)this.insrtKdsPos(d,c.getChildrenSnapshot(),0,g);else this.addKds(d,c.getChildrenSnapshot());return f};Owa.UIControls.TreeControl.prototype.shwNd=function Owa$UIControls$TreeControl$shwNd(b){var a=this.gtNdPrnt(b);while(a){a.expand();a=this.gtNdPrnt(a)}var d=b._get_Element(),c=getCY(d._get_DomNode(),0,this.root._get_DomNode().offsetParent)-getCY(this.root._get_DomNode(),0,this.root._get_DomNode().offsetParent);(c<0||c>=this.root.get_OffsetHeight())&&b._get_Element()._get_DomNode().scrollIntoView()};Owa.UIControls.TreeControl.prototype.feOnBfEdt=function Owa$UIControls$TreeControl$feOnBfEdt(a){if(this.onBfEdt)return this.onBfEdt(a)};Owa.UIControls.TreeControl.prototype.crtFkNd=function Owa$UIControls$TreeControl$crtFkNd(b){var a=this.root.get_OwnerDocument().createElement(A);a.set_CssClasses(["trNd"]);a.set_Id(FKID);a.setAttribute("hideFocus","1");a.setAttribute("src","#");a.set_InnerHtml((b?b:"")+'<SPAN id="'+NODE_CONTENT+'"></SPAN>');return a};Owa.UIControls.TreeControl.prototype.gtNwNdIcnMrkup=function Owa$UIControls$TreeControl$gtNwNdIcnMrkup(){return Owa.Components.CssSprites.getImageMarkup(g_rgsFIcns[T_MSG],"id="+NODE_ICON)};Owa.UIControls.TreeControl.prototype.strtEdt=function Owa$UIControls$TreeControl$strtEdt(a){this._edting=EDT_INPT;this._fDontSyncSelection=1;if(!this._edt)this._edt={};this._edt.oCtx=a};Owa.UIControls.TreeControl.prototype.crtNwNd=function Owa$UIControls$TreeControl$crtNwNd(a,b,c,e){if(this._edting)return;this.strtEdt(b);this._edt.crtNw=1;this._edt._hsChld=a.hsChld();var d=this.crtFkNd(this.gtNwNdIcnMrkup(a,b));this.addKdPos(a,d,c,e);a.expand();this.edtNd(this.gtNdById(FKID),b,1)};Owa.UIControls.TreeControl.prototype.edtNd=function Owa$UIControls$TreeControl$edtNd(a,d,c){if(this._edting&&!c)return;this.strtEdt(d);this._edt.nd=a;if(this.feOnBfEdt())return;this.shwNd(a);var b=this.crtInp(a);this._edt.inp=b;a.gtHl().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b);b.get_FirstChild().set_Value(a.gtDspNm());b.get_FirstChild().focus(100);this.clrHl();a.hdCnt();b.get_FirstChild()._get_DomNode().select()};Owa.UIControls.TreeControl.prototype.crtInp=function Owa$UIControls$TreeControl$crtInp(f){var b=0,e=f.gtImg();if(e)b+=e.get_OffsetWidth()+e._get_EffectiveMarginWidth();var c=this.root.get_OwnerDocument().createElement("input"),a=this.root.get_OwnerDocument().createElement(DIV),d=this.root.get_OwnerDocument().createElement(DIV);c.set_CssClasses(["trEdtInp"]);a.set_CssClasses(["trEdtO"]);d.set_CssClasses(["trEdtBd"]);c.setAttribute("maxLength",this.getMaxInputLength());if(g_fRtl){d.set_Right(-2-b);a.set_Right(b+f.getIndent()+CONTENT_OFFSET)}else{d.set_Left(-2-b);a.set_Left(b+f.getIndent()+CONTENT_OFFSET)}this.onInpKD&&this._attachEvent(c,"keydown",this.onInpKD);this.onInputBlur&&this._attachEvent(c,"blur",this.onInputBlur);a.appendChild(c);a.appendChild(d);if(Owa.Utility.isFirefox())try{document.execCommand("enableObjectResizing",false,"false")}catch(g){}return a};Owa.UIControls.TreeControl.prototype.getMaxInputLength=function Owa$UIControls$TreeControl$getMaxInputLength(){return"255"};Owa.UIControls.TreeControl.prototype.onInpKD=function Owa$UIControls$TreeControl$onInpKD(a){switch(a.get_KeyCodeForKeyUpDown()){case 13:if(this._edting==EDT_CHK)return;a.cancelBubble();this.chkEdtNd(ECR_ENTER);break;case 27:a.cancelBubble();this.chkEdtNd(ECR_ESC)}};Owa.UIControls.TreeControl.prototype.onInputBlur=function Owa$UIControls$TreeControl$onInputBlur(){this._edting!=EDT_CHK&&this.chkEdtNd(ECR_FO)};Owa.UIControls.TreeControl.prototype.feOnRnNd=function Owa$UIControls$TreeControl$feOnRnNd(a,b){if(this.onRnNd)this.onRnNd(a,b)};Owa.UIControls.TreeControl.prototype.feOnNwNd=function Owa$UIControls$TreeControl$feOnNwNd(a,b){if(this.onNwNd)this.onNwNd(a,b)};Owa.UIControls.TreeControl.prototype.chkEdtNd=function Owa$UIControls$TreeControl$chkEdtNd(a){this._edting=EDT_CHK;this._edt.nd.shwPrg(1e3,this._edt.nd.gtImg()?1:0);return this._edt.crtNw?this.feOnNwNd(a,this._edt.inp.get_FirstChild().get_Value()):this.feOnRnNd(a,this._edt.inp.get_FirstChild().get_Value())};Owa.UIControls.TreeControl.prototype.reEdtNd=function Owa$UIControls$TreeControl$reEdtNd(){this._edting=EDT_INPT;try{this._edt.inp.get_FirstChild().focus(0);this._edt.nd.hdPrg()}catch(a){this.qtEdtNd()}};Owa.UIControls.TreeControl.prototype.qtEdtNd=function Owa$UIControls$TreeControl$qtEdtNd(){if(!this._edting)return;var a=this._edt.nd,b=this.gtNdPrnt(a);a.hdPrg();if(this._edt.crtNw){b._get_Element().setAttribute("_hsChld",this._edt._hsChld);this.rmNd(a)}else{this._edt.inp.get_FirstChild().detachAllEvents();this._edt.inp.remove(true);a.shwCnt()}this._edt=null;this._edting=0;this.hdErr();this.syncSelNHl();this.feOnAfEdt()};Owa.UIControls.TreeControl.prototype.feOnAfEdt=function Owa$UIControls$TreeControl$feOnAfEdt(){this.onAfEdt&&this.onAfEdt()};Owa.UIControls.TreeControl.prototype.shwErr=function Owa$UIControls$TreeControl$shwErr(a,b){var d=this.root.get_OwnerDocument().getElementById(this._sErrNm);if(b){showErrInNav(d._get_DomNode(),a);if(this._sHdErrNm){var c=this.root.get_OwnerDocument().getElementById(this._sHdErrNm);c.set_IsShown(true)}this.fireOnErrorInfobarChanged();this._edting&&this._edt.inp._get_DomNode().scrollIntoView(0)}else shwErrDlg(0,a)};Owa.UIControls.TreeControl.prototype.hdErr=function Owa$UIControls$TreeControl$hdErr(){var b=this.root.get_OwnerDocument().getElementById(this._sErrNm);hideErrInNav(b._get_DomNode());if(this._sHdErrNm){var a=this.root.get_OwnerDocument().getElementById(this._sHdErrNm);a.set_IsShown(false)}this.fireOnErrorInfobarChanged()};Owa.UIControls.TreeControl.prototype.cbOeh=function Owa$UIControls$TreeControl$cbOeh(b,c){var a=this._edting;if(!cbOehST(b)){a&&this.qtEdtNd();return}if(b.sErr){this.shwErr(b.sErr,c);a&&this.reEdtNd();return}var d=this.root.get_OwnerDocument().createElement(DIV);d.set_InnerHtml(b.sBody);var e=d.getDescendantById("err");if(e){this.shwErr(e.getAttribute("_msg"),c);a&&this.reEdtNd();return}a&&this.qtEdtNd();return 1};Owa.UIControls.TreeControl.prototype._onKD=function Owa$UIControls$TreeControl$_onKD(a){if(this._edting)return;if(a.isAltKeyDown()||a.isCtrlKeyDown()||a.get_KeyCodeForKeyUpDown()==9)return;var b=this.gtSelNd();switch(a.get_KeyCodeForKeyUpDown()){case 37:case 109:b&&b.isExp()&&b.collapse();break;case 39:case 107:b&&!b.isExp()&&b.expand();break;default:this.feOnKD(a);return}a.preventDefault()};Owa.UIControls.TreeControl.prototype.feOnKD=function Owa$UIControls$TreeControl$feOnKD(a){if(this.onKD)this.onKD(a)};Owa.UIControls.TreeControl.prototype._onClk=function Owa$UIControls$TreeControl$_onClk(a){if(this._edting)return;var c=a.get_Target(),b=this.gtNd(c);if(!b)return;if(c.get_Id()==NODE_CHILDREN)return;if(b.isEC(c)){b.tggl();a.preventDefault();a.cancelBubble();return}this.feOnClkNd(a,b);a.preventDefault();a.cancelBubble()};Owa.UIControls.TreeControl.prototype.feOnClkNd=function Owa$UIControls$TreeControl$feOnClkNd(b,a){if(this.onClkNd)this.onClkNd(b,a);if(a.canSel())this.selNd(a);else{a.tggl();b.preventDefault();b.cancelBubble()}};Owa.UIControls.TreeControl.prototype._onSS=function Owa$UIControls$TreeControl$_onSS(a){if(this._edting&&a.get_Target().equals(this._edt.inp.get_FirstChild())){a.cancelBubble();return}a.preventDefault()};Owa.UIControls.TreeControl.prototype.getSelectionClass=function Owa$UIControls$TreeControl$getSelectionClass(){return this._sSelelectionClass};Owa.UIControls.TreeControl.prototype.setSelectionClass=function Owa$UIControls$TreeControl$setSelectionClass(a){this._sSelelectionClass=a;this.rfrshHl()};Owa.UIControls.TreeControl.prototype.hsSelNd=function Owa$UIControls$TreeControl$hsSelNd(){return!!this._sSelNdId};Owa.UIControls.TreeControl.prototype.hsHlNd=function Owa$UIControls$TreeControl$hsHlNd(){return!!this._sHlNdId};Owa.UIControls.TreeControl.prototype.gtSelNd=function Owa$UIControls$TreeControl$gtSelNd(){return!this.hsSelNd()?void 0:this.gtNdById(this._sSelNdId)};Owa.UIControls.TreeControl.prototype.gtHlNd=function Owa$UIControls$TreeControl$gtHlNd(){return!this.hsHlNd()?void 0:this.gtNdById(this._sHlNdId)};Owa.UIControls.TreeControl.prototype.selNdById=function Owa$UIControls$TreeControl$selNdById(a){this.stNdSel(this.gtNdById(a),1)};Owa.UIControls.TreeControl.prototype.gtNrstNd=function Owa$UIControls$TreeControl$gtNrstNd(b){var a=this.gtNdPrv(b);while(a){if(a.canSel())return a;a=this.gtNdPrv(a)}a=this.gtNdNxt(b);while(a){if(a.canSel())return a;a=this.gtNdNxt(a)}a=this.gtNdPrnt(b);return a&&a.canSel()?a:a?this.gtNrstNd(a):void 0};Owa.UIControls.TreeControl.prototype.clrSel=function Owa$UIControls$TreeControl$clrSel(){this.stNdSel(this.gtSelNd(),0)};Owa.UIControls.TreeControl.prototype.clrHl=function Owa$UIControls$TreeControl$clrHl(){if(this._frst)this._frst.clrHl();else this._clrHl()};Owa.UIControls.TreeControl.prototype._clrHl=function Owa$UIControls$TreeControl$_clrHl(){this.stNdHl(this.gtHlNd(),0)};Owa.UIControls.TreeControl.prototype.stNdSel=function Owa$UIControls$TreeControl$stNdSel(a,c){if(a&&!a.canSel())return;var b=this.gtSelNd();if(c)if(b&&b.equals(a)&&this._fcs)this.rfrshHl();else{this.stFcs(1);b&&b.stSel(0);if(a){this._sSelNdId=a.gtId();a.stSel(1)}else this._sSelNdId=null;this.stNdHl(a,c)}else{a&&a.equals(b)&&b.stSel(0);this._sSelNdId=null;this.stNdHl(a,c)}(!b&&a||b&&!b.equals(a))&&this.feOnSelChng(b,this.gtSelNd())};Owa.UIControls.TreeControl.prototype.stFcs=function Owa$UIControls$TreeControl$stFcs(a){if(this._frst)this._frst.stFcsTr(a?this._nm:null);else this._fcs!=a&&this._stFcs(a)};Owa.UIControls.TreeControl.prototype._stFcs=function Owa$UIControls$TreeControl$_stFcs(a){this._fcs=a;!a&&this.clrSel()};Owa.UIControls.TreeControl.prototype.stNdHl=function Owa$UIControls$TreeControl$stNdHl(a,c){var b=this.gtHlNd();if(c){this.clrHl();if(a){this._sHlNdId=a.gtId();a.stHl(1)}}else a&&a.equals(b)&&b.stHl(0)};Owa.UIControls.TreeControl.prototype._onContextMenuCloseEventHandler=function Owa$UIControls$TreeControl$_onContextMenuCloseEventHandler(){!this._fDontSyncSelection&&this.syncSelNHl();var a=this.get_ContextMenu();a.get_OnClose().remove(this._createCallback(this._onContextMenuCloseEventHandler));a.get_OnSelect().remove(this._createCallback(this._onContextMenuSelectEventHandler))};Owa.UIControls.TreeControl.prototype._onContextMenuSelectEventHandler=function Owa$UIControls$TreeControl$_onContextMenuSelectEventHandler(b,a){a&&this.stNdHl(a,1);return a&&a.onContextMenuClick?a.onContextMenuClick(b):false};Owa.UIControls.TreeControl.prototype.syncSelNHl=function Owa$UIControls$TreeControl$syncSelNHl(){if(this._frst)this._frst.syncSelNHl();else this._syncSelNHl()};Owa.UIControls.TreeControl.prototype._syncSelNHl=function Owa$UIControls$TreeControl$_syncSelNHl(){var a=this.gtSelNd(),b=this.gtHlNd();if(!a){this._clrHl();return}if(a.equals(b))this._rfrshHl();else{b&&b.stHl(0);a.stHl(1);this._sHlNdId=a.gtId()}};Owa.UIControls.TreeControl.prototype.selNd=function Owa$UIControls$TreeControl$selNd(a){this.stNdSel(a,1)};Owa.UIControls.TreeControl.prototype.feOnSelChng=function Owa$UIControls$TreeControl$feOnSelChng(b,a){if(this.onSelChng)this.onSelChng(b,a)};Owa.UIControls.TreeControl.prototype.rfrshHl=function Owa$UIControls$TreeControl$rfrshHl(){if(this._frst)this._frst.rfrshHl();else this._rfrshHl()};Owa.UIControls.TreeControl.prototype._rfrshHl=function Owa$UIControls$TreeControl$_rfrshHl(){if(!this._fcs)return;var a=this.gtHlNd();a&&a.stHl(1)};Owa.UIControls.TreeControl.prototype.getDragEffectClass=function Owa$UIControls$TreeControl$getDragEffectClass(){return this._sDragEffectClass};Owa.UIControls.TreeControl.prototype._onDS=function Owa$UIControls$TreeControl$_onDS(a){if(this._edting)return;var d=a.get_Target(),b=this.gtNd(d);if(b&&b.canDrg())this.feOnDrg(a,b);else{var c=new Owa.Components.Storage.DragDrop(a);c.deny()}};Owa.UIControls.TreeControl.prototype.feOnDrg=function Owa$UIControls$TreeControl$feOnDrg(a,b){b.onDrg(a);if(this.onDrg)return this.onDrg(a,b)};Owa.UIControls.TreeControl.prototype._onDrp=function Owa$UIControls$TreeControl$_onDrp(e){if(this._edting)return;this.clrExpNdTO();var b=this._drp.oNd;this._drp.iTid&&this._clearTimeout(this._drp.iTid);if(b){var d=new Owa.Components.Storage.DragDrop(e),a=Owa.Components.Storage.StorableObject.createFromStorage(d),c=this._drp.sDM;if(a){b.drpIn(a,c);this.drpIn&&this.drpIn(b,a,c)}}this.onDLTOCB()};Owa.UIControls.TreeControl.prototype._onDL=function Owa$UIControls$TreeControl$_onDL(a){if(!this._drp)return;if(this._drp.sLstEvt=="dragenter"){this._drp.sLstEvt=null;a.cancelBubble();a.preventDefault();return}this._drp.iTid&&this._clearTimeout(this._drp.iTid);if(this._drp.oNd)this._drp.iTid=Owa.Dom.Window.get_Current().setTimeout(this._createCallback(this.onDLTOCB),50);this.clrExpNdTO();a.cancelBubble();a.preventDefault()};Owa.UIControls.TreeControl.prototype.onDLTOCB=function Owa$UIControls$TreeControl$onDLTOCB(){this.clrDrpHl();this._drp=null};Owa.UIControls.TreeControl.prototype._onDO=function Owa$UIControls$TreeControl$_onDO(e){if(isDf(typeof iAutoScr)&&iAutoScr)return;var c=new Owa.Components.Storage.DragDrop(e);if(this._edting){c.deny();return}var f=Owa.Components.Storage.StorableObject.createFromStorage(c);if(!f){c.deny();this.clrDrpHl();return}if(!this._drp)this._drp={};this._drp.sLstEvt=e.get_Type();this._drp.iTid&&this._clearTimeout(this._drp.iTid);var d=this.gtNd(e.get_Target());if(d){var a,b=d;while(b){a=b.gtDrpMd(d,e,f);if(a!=DRP_NONE)break;b=this.gtNdPrnt(b)}switch(a&DRP_IC_MSK){case DRP_COPY:c.setEffect(Owa.Components.Storage.DragDrop.Effect.Copy);break;case DRP_MOVE:c.setEffect(Owa.Components.Storage.DragDrop.Effect.Move);break;case DRP_LINK:c.setEffect(Owa.Components.Storage.DragDrop.Effect.Link);break;default:c.setEffect(Owa.Components.Storage.DragDrop.Effect.None)}if(!b||!b.equals(this._drp.oNd)||this._drp.sDM!=a)(!isFlgSt(a,DRP_BELOW)||!isFlgSt(a,DRP_ABOVE)||isFlgSt(a,DRP_ABOVE)&&!b.equals(this.gtNdNxt(this._drp.oNd))||isFlgSt(a,DRP_BELOW)&&!b.equals(this.gtNdPrv(this._drp.oNd)))&&this.drpHlNd(b,a);this._drp.sDM=a;if(d.hsChld()&&d.canDrpExp(f))this.stExpNdTO(d);else this.clrExpNdTO()}};Owa.UIControls.TreeControl.prototype.stExpNdTO=function Owa$UIControls$TreeControl$stExpNdTO(a){if(a.hsChld()&&!a.isExp()){if(this._expNdId==a.gtId())return;this._expNdTId&&this._clearTimeout(this._expNdTId);this._expNdId=a.gtId();this._expNdTId=Owa.Dom.Window.get_Current().setTimeout(this._createCallback(this.expNd),800)}};Owa.UIControls.TreeControl.prototype.clrExpNdTO=function Owa$UIControls$TreeControl$clrExpNdTO(){this._expNdTId&&this._clearTimeout(this._expNdTId);this._expNdTId=0;this._expNdId=0};Owa.UIControls.TreeControl.prototype.expNd=function Owa$UIControls$TreeControl$expNd(){var a=this.gtNdById(this._expNdId);a&&!a.isExp()&&a.expand();this._expNdId=0;this._expNdTId=0};Owa.UIControls.TreeControl.prototype.clrDrpHl=function Owa$UIControls$TreeControl$clrDrpHl(){if(!this._drp||!this._drp.oNd)return;if(this._drp.oSp){this._drp.oSp.remove(true);this._drp.oSp=null}else this._drp.oNd&&this._drp.oNd.stDrpHl(0);this._drp.sDM=DRP_NONE};Owa.UIControls.TreeControl.prototype.drpHlNd=function Owa$UIControls$TreeControl$drpHlNd(a,b){this._drp.iTid&&this._clearTimeout(this._drp.iTid);if(this._frst)this._frst.clrDrpHl();else this.clrDrpHl();if(!a||b==DRP_NONE)return;switch(b&DRP_EFF_MSK){case DRP_ABOVE:this.addDrpSpDiv(a,1);break;case DRP_BELOW:this.addDrpSpDiv(a,0);break;default:a.stDrpHl(1)}this._drp.oNd=a;this._drp.sDM=b};Owa.UIControls.TreeControl.prototype.addDrpSpDiv=function Owa$UIControls$TreeControl$addDrpSpDiv(c,d){var a=this.root.get_OwnerDocument().createElement(DIV),b=this.root.get_OwnerDocument().createElement(DIV);a.set_CssClasses(["trDrpEffO"]);b.set_CssClasses(["trDrpEffI"]);a.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,b);this._drp.oSp=a;if(d)c.getContainer().insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,a);else c.getContainer().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,a)};Owa.UIControls.TreeControl.prototype._onContextMenuEventHandler=function Owa$UIControls$TreeControl$_onContextMenuEventHandler(b){if(this._edting)return;var c=this.gtNd(b.get_Target());if(c){if(this._onBeforeContextMenu(c))return;var a=this.get_ContextMenu();if(!a)return;a.get_IsShown()&&a.close();a.get_OnClose().add(this._createCallback(this._onContextMenuCloseEventHandler));a.get_OnSelect().add(this._createCallback(this._onContextMenuSelectEventHandler,c));a.showAtEvent(b);this._fDontSyncSelection=0;this.stNdHl(c,1)}b.cancelBubble();b.preventDefault()};Owa.UIControls.TreeControl.prototype._onBeforeContextMenu=function Owa$UIControls$TreeControl$_onBeforeContextMenu(a){return a._onBeforeContextMenu()};Owa.UIControls.TreeControl.prototype.fireOnResize=function Owa$UIControls$TreeControl$fireOnResize(){this.onResize&&this.onResize()};Owa.UIControls.TreeControl.prototype.fireOnErrorInfobarChanged=function Owa$UIControls$TreeControl$fireOnErrorInfobarChanged(){this.onErrorInfobarChanged&&this.onErrorInfobarChanged()};Owa.UIControls.TreeControl.prototype.cbOperationsStarted=function Owa$UIControls$TreeControl$prototype$cbOperationsStarted(b){var a=this.gtNdByFId(b);if(!a)return;a.shwPrg(1e3,true)};Owa.UIControls.TreeControl.prototype.cbOperationsComplete=function Owa$UIControls$TreeControl$prototype$cbOperationsComplete(c){var b=this.gtNdByFId(c);if(!b)return;b.hdPrg();if(b.isSel()){var a=getViewSubPageControllerByFolderId(c);a&&a.get_NavigationDelayed()&&a.get_DelayedURL()&&a.navigate(a.get_DelayedURL())}}})();!g_fModuleLoaded[".\\uicontrols/foldertreenode.js".toLowerCase()]&&(function(){Owa.Components.FolderTreeNode=function Owa$Components$FolderTreeNode(a,b){Owa.Components.FolderTreeNode.constructBase(this,[a,b])};Owa.Components.FolderTreeNode.createClass("Owa.Components.FolderTreeNode",Owa.Components.TreeNode);Owa.Components.FolderTreeNode.prototype.gtFId=function Owa$Components$FolderTreeNode$gtFId(){return this.gtId().substr(1)};Owa.Components.FolderTreeNode.prototype.gtFT=function Owa$Components$FolderTreeNode$gtFT(){return this._get_Element().getAttribute("_ft")?getInt(this._get_Element().getAttribute("_ft")):0};Owa.Components.FolderTreeNode.prototype.isS=function Owa$Components$FolderTreeNode$isS(a){return a?this.gtFT()==a:!!this.gtFT()};Owa.Components.FolderTreeNode.prototype.gtFCC=function Owa$Components$FolderTreeNode$gtFCC(){return this._get_Element().getAttribute("_fcc")};Owa.Components.FolderTreeNode.prototype.getFolderNameElement=function Owa$Components$FolderTreeNode$getFolderNameElement(){return this.getContent().getChildById(FNID)};Owa.Components.FolderTreeNode.prototype.gtDspNm=function Owa$Components$FolderTreeNode$gtDspNm(){return this.gtFldNm()};Owa.Components.FolderTreeNode.prototype.stDspNm=function Owa$Components$FolderTreeNode$stDspNm(a){this.getFolderNameElement().set_TextContent(a);this.stFldNm(a)};Owa.Components.FolderTreeNode.prototype.gtFldNm=function Owa$Components$FolderTreeNode$gtFldNm(){return this.getFolderNameElement().getAttribute("fldrNm")};Owa.Components.FolderTreeNode.prototype.stFldNm=function Owa$Components$FolderTreeNode$stFldNm(a){this.getFolderNameElement().setAttribute("fldrNm",a)};Owa.Components.FolderTreeNode.prototype.isNC=function Owa$Components$FolderTreeNode$isNC(){return this._get_Element().getAttribute("_nc")};Owa.Components.FolderTreeNode.prototype.gtCCDT=function Owa$Components$FolderTreeNode$gtCCDT(){return this._get_Element().getAttribute("_ccdt")};Owa.Components.FolderTreeNode.prototype.isPlcy=function Owa$Components$FolderTreeNode$isPlcy(){return this._get_Element().getAttribute("_fPlcy")};Owa.Components.FolderTreeNode.prototype.gtAFlg=function Owa$Components$FolderTreeNode$gtAFlg(){return this._get_Element().getAttribute("_iAFlg")};Owa.Components.FolderTreeNode.prototype.gtEFFlg=function Owa$Components$FolderTreeNode$gtEFFlg(){return this._get_Element().getAttribute("_eff")};Owa.Components.FolderTreeNode.prototype.isOSF=function Owa$Components$FolderTreeNode$isOSF(){return this._get_Element().getAttribute("_osf")};Owa.Components.FolderTreeNode.prototype.isExternal=function Owa$Components$FolderTreeNode$isExternal(){var a=this.gtEFFlg();return a&EFF_XORG||a&EFF_WEBCAL};Owa.Components.FolderTreeNode.prototype.isWebCalendar=function Owa$Components$FolderTreeNode$isWebCalendar(){var a=this.gtEFFlg();return a&EFF_WEBCAL};Owa.Components.FolderTreeNode.prototype.isPublishedOut=function Owa$Components$FolderTreeNode$isPublishedOut(){return this.gtEFFlg()&EFF_PUBOUT};Owa.Components.FolderTreeNode.prototype.gtER=function Owa$Components$FolderTreeNode$gtER(){return this._get_Element().getAttribute("_iER")};Owa.Components.FolderTreeNode.prototype.isPFR=function Owa$Components$FolderTreeNode$isPFR(){return this._get_Element().getAttribute("_iPFR")};Owa.Components.FolderTreeNode.prototype.canCp=function Owa$Components$FolderTreeNode$canCp(){return g_oFldrMgr.gtFL(this.gtFId())==FL_PUB?!this.isPFR():!this.isExternal()&&!(this.gtEFFlg()&EFF_SHI)&&!this.isS(DFT_SFR)&&!this.isOSF()&&g_oFldrMgr.gtFL(this.gtFId())!=FL_OUM&&!(this.gtAFlg()&(AFLG_RT|AFLG_PRV|AFLG_PRT))&&!this.isS(DFT_ROT)};Owa.Components.FolderTreeNode.prototype.canMv=function Owa$Components$FolderTreeNode$canMv(){if(g_oFldrMgr.gtFL(this.gtFId())==FL_PUB)return!this.isPFR()&&hasER(this.gtER(),ER_DLT);else{var a=this.gtAFlg();return!(this.isS()||this.isExternal()||this.gtEFFlg()&(EFF_RMH|EFF_SHI)||this.isOSF()||a&AFLG_PRV||a&AFLG_PRT)}};Owa.Components.FolderTreeNode.prototype.canDel=function Owa$Components$FolderTreeNode$canDel(){if(g_oFldrMgr.gtFL(this.gtFId())==FL_PUB)return!this.isPFR()&&hasER(this.gtER(),ER_DLT);else{var c=this._tr.gtNdByAls(ALP_DFT+DFT_DEL),b=this._tr.isAncstr(c,this),a=this.gtAFlg();return!(this.isS()||this.isExternal()&&!b||this.gtEFFlg()&EFF_RMH||this.isOSF()||a&AFLG_PRV||a&AFLG_PRT)}};Owa.Components.FolderTreeNode.prototype.canRnm=function Owa$Components$FolderTreeNode$canRnm(){if(g_oFldrMgr.gtFL(this.gtFId())==FL_PUB)return!this.isPFR()&&hasER(this.gtER(),ER_MDF);else{var a=this.gtAFlg();return!(this.isS()||this.isOSF()||this.gtEFFlg()&EFF_RMH||a&AFLG_PRV||a&AFLG_PRT)}};Owa.Components.FolderTreeNode.prototype.canAcceptSubFolderType=function Owa$Components$FolderTreeNode$canAcceptSubFolderType(a){if(this.canCrt())if(g_oFldrMgr.gtFL(this.gtFId())==FL_PUB)return true;else{var b=this.gtFCC(),d=isOfClss(b,T_CAL)||isOfClss(b,T_CON)||isOfClss(b,T_TSK),c=isOfClss(a,T_CAL)||isOfClss(a,T_CON)||isOfClss(a,T_TSK);return!d||c}else return false};Owa.Components.FolderTreeNode.prototype.canCrt=function Owa$Components$FolderTreeNode$canCrt(){return g_oFldrMgr.gtFL(this.gtFId())==FL_PUB?hasER(this.gtER(),ER_CH):g_oFldrMgr.gtFL(this.gtFId())!=FL_OUM&&!this.isOSF()&&!this.isS(DFT_SFR)&&!(this.gtEFFlg()&(EFF_RMH|EFF_EXB))&&!(this.gtAFlg()&AFLG_RT)};Owa.Components.FolderTreeNode.prototype.persistExp=function Owa$Components$FolderTreeNode$persistExp(){this._tr._fPrstRt&&this.isRt()&&g_oFldrMgr.prstTrExpSt()};Owa.Components.FolderTreeNode.prototype.feUpdCnts=function Owa$Components$FolderTreeNode$feUpdCnts(){g_oEd.fire("UpdateCount",this.gtFId(),getInt(this._get_Element().getAttribute("_iTC")),getInt(this._get_Element().getAttribute("_iUC")))};Owa.Components.FolderTreeNode.prototype.updCnts=function Owa$Components$FolderTreeNode$updCnts(b,c){var h=this.getContent(),a=this.getFolderNameElement(),e=this._get_Element();if((b==-1||b==getInt(e.getAttribute("_iTC")))&&(c==-1||c==getInt(e.getAttribute("_iUC"))))return;b!=-1&&e.setAttribute("_iTC",""+b);c!=-1&&e.setAttribute("_iUC",""+c);if(this.gtCCDT()!=CCDT_NONE){var g=this.gtCCDT()==CCDT_ITMC,f=g?b:c;if(f==-1)return;if(f){a.removeCssClass("fnufw");a.addCssClass("fufw")}else{a.removeCssClass("fufw");a.addCssClass("fnufw")}var d=a.get_OuterHtml();if(f){d+='<span id="'+(g?"spnC":"spnUC")+'">';d+=g_sDE+(g?"[":"(")+"<span id=spnCV>"+f+"</span>"+(g?"]":")")+g_sDE;d+="</span>"}h.set_InnerHtml(d)}};Owa.Components.FolderTreeNode.prototype.onDrg=function Owa$Components$FolderTreeNode$onDrg(d){var c=new Owa.Components.Storage.DragDrop(d),b=Owa.Components.Storage.StorableObject.create(Owa.Components.DraggableObjects.Type.Folder),a=b.get_RootElement();a.set_IsOutlookSearchFolder(this.isOSF());a.set_FolderId(this.gtFId());a.set_IsRemote(this._tr.getRemoteArchiveFlag());b.set_DenyCopy(!this.canCp());b.set_DenyMove(!this.canMv());var e=this._tr.gtNdByAls(ALP_DFT+DFT_DEL),f=this._tr.gtNdByAls(ALP_DFT+DFT_JNK);a.set_IsInDeletedItems(this._tr.isAncstr(e,this));a.set_IsInJunkItems(this._tr.isAncstr(f,this));a.set_FolderType(this.gtFT().toString());a.set_FolderContainerClass(this.gtFCC());b.save(c)};Owa.Components.FolderTreeNode.prototype.canDrg=function Owa$Components$FolderTreeNode$canDrg(){return!(g_oFldrMgr.gtFL(this.gtFId())==FL_OUM||this.isS(DFT_SFR)||this.gtAFlg()&AFLG_RT)};Owa.Components.FolderTreeNode.prototype.canDrpExp=function Owa$Components$FolderTreeNode$canDrpExp(a){return a.get_TypeName()!=Owa.Components.DraggableObjects.Type.Folder&&a.get_TypeName()!=Owa.Components.DraggableObjects.Type.Items&&a.get_TypeName()!=Owa.Components.DraggableObjects.Type.Conversations||this.isS(DFT_SFR)||this.isOSF()?false:a.get_TypeName()==Owa.Components.DraggableObjects.Type.Folder&&g_oFldrMgr.gtFL(this.gtFId())==FL_OUM?false:a.get_TypeName()==Owa.Components.DraggableObjects.Type.Folder?true:isValidDropFolder(a,this.gtFCC())};Owa.Components.FolderTreeNode.prototype.gtDrpMd=function Owa$Components$FolderTreeNode$gtDrpMd(p,i,d){if(!this.equals(p))return DRP_NONE;if(this.isS(DFT_TDS)||this.isS(DFT_SFR)||this.isOSF()||this.gtAFlg()&AFLG_RT)return DRP_NONE;var j=!d.get_DenyCopy(),h=!d.get_DenyMove(),l=i.isCtrlKeyDown(),m=i.isShiftKeyDown();if(!j&&!h)return DRP_NONE;var b=d.get_TypeName(),a=d.get_RootElement();if(b===Owa.Components.DraggableObjects.Type.Folder||b===Owa.Components.DraggableObjects.Type.Items||b===Owa.Components.DraggableObjects.Type.Conversations){var g=g_oFldrMgr.gtFL(a.get_FolderId()),f=g_oFldrMgr.gtFL(this.gtFId()),k=g==FL_MBX&&f==FL_MBX,n=(g==FL_MBX||g==FL_AMB)&&(f==FL_MBX||f==FL_AMB),c=k||n?l:!m;if(c&&!j)return DRP_NONE;if(!c&&!h)return DRP_NONE}switch(b){case Owa.Components.DraggableObjects.Type.Items:case Owa.Components.DraggableObjects.Type.Conversations:if(g_oFldrMgr.gtFL(this.gtFId())==FL_OUM&&this.isRt())return DRP_NONE;var o=this.gtFId()==a.get_FolderId()&&!a.get_IsCrossFolder();return o&&!c?DRP_NONE:!isValidDropFolder(d,this.gtFCC())?DRP_NONE:!this._hasDrpER(b)?DRP_NONE:c?DRP_COPY:DRP_MOVE;case Owa.Components.DraggableObjects.Type.Folder:if(a.get_IsOutlookSearchFolder()||!this.canAcceptSubFolderType(a.get_FolderContainerClass()))return DRP_NONE;var e=this._tr.gtNdByFId(a.get_FolderId());return e&&this._tr.isAncstr(e,this,1)?DRP_NONE:e&&!c&&this.equals(this._tr.gtNdPrnt(e))?DRP_NONE:!this._hasDrpER(b)?DRP_NONE:c?DRP_COPY:DRP_MOVE;case Owa.Components.DraggableObjects.Type.NavigationNode:return this.isS(DFT_DEL)&&h?DRP_MOVE:DRP_NONE;default:return DRP_NONE}};Owa.Components.FolderTreeNode.prototype._hasDrpER=function Owa$Components$FolderTreeNode$_hasDrpER(a){var b=this.gtER();return b&&(a==Owa.Components.DraggableObjects.Type.Folder&&!hasER(b,ER_CH)||(a==Owa.Components.DraggableObjects.Type.Items||a==Owa.Components.DraggableObjects.Type.Conversations)&&!hasER(b,ER_CC))?0:1};Owa.Components.FolderTreeNode.prototype.drpIn=function Owa$Components$FolderTreeNode$drpIn(c,g){var d=this.gtFId(),b=c.get_RootElement();switch(c.get_TypeName()){case Owa.Components.DraggableObjects.Type.Folder:var a=b.get_FolderId(),h=this._tr.gtNdByAls(ALP_DFT+DFT_DEL),l=this._tr.gtNdByFId(a),k=this._tr.gtNdByFId(d),j=this._tr.isAncstr(h,l,1),i=this._tr.isAncstr(h,k,1);g_oFldrMgr.cpMvFld(this._tr,a,j,d,i,(g&DRP_IC_MSK)==DRP_COPY?1:0,!this.isUTD(),this._tr.gtFrt());break;case Owa.Components.DraggableObjects.Type.Items:case Owa.Components.DraggableObjects.Type.Conversations:var e;if(Owa.Utility.isDefined(typeof getLstVw))e=getNavigationPage().getLstVw(a);if(checkLimit(c,e))return;var f=[];b.foreach_Item(function(a){f.push(a.get_ItemId())});g_oFldrMgr.cpMvItms(wt(),this._tr.get_SubPage(),b.get_FolderId(),f,d,(g&DRP_IC_MSK)==DRP_COPY?1:0);break;case Owa.Components.DraggableObjects.Type.NavigationNode:var a=b.get_FolderId();g_oNvNdMgr.rmvFrmFvr(this._tr,a)}};Owa.Components.FolderTreeNode.prototype._onBeforeContextMenu=function Owa$Components$FolderTreeNode$_onBeforeContextMenu(){var b=g_oFldrMgr.gtFL(this.gtFId()),a;if(b==FL_PUB){var a=getPublicFolderTreeMenu();this._preparePublicFolderMenu(a)}else{if(this.isS(DFT_SFR)||this.gtAFlg()&AFLG_RT)return true;var a=getFolderTreeMenu();this._prepareFolderMenu(a)}this._tr.set_ContextMenu(a)};Owa.Components.FolderTreeNode.prototype._prepareFolderMenu=function Owa$Components$FolderTreeNode$_prepareFolderMenu(a){var e=a.getAllMenuItemIds();a.showMenuItems(e,false);var d=g_oFldrMgr.gtFL(this.gtFId())==FL_OUM;if(d&&this.isS(DFT_ROT)){a.showMenuItems(["divOUM","divRSF"],true);a.enableMenuItems(["divOUM","divRSF"],true);return}var c=["divO","divON","divMvF","divCpF","divD","divRnm","divMAR","divCF"];a.showMenuItems(c,true);a.enableMenuItems(c,true);var b=this.gtFId();if(g_oNvNdMgr.isInFvr(b)){a.showMenuItem("divRmFvr",true);a.enableMenuItem("divRmFvr",true)}else if(g_oNvNdMgr.canAddToFvr(this.gtFId(),this.gtFCC(),this.gtFT(),this._tr.isAncstr(this._tr.gtNdByAls(ALP_DFT+DFT_DEL),this),this._tr.getRemoteArchiveFlag())){a.showMenuItem("divFvr",true);a.enableMenuItem("divFvr",true)}else a.enableMenuItem("divFvr",false);if(g_oFldrMgr.isMyFId(b))if(this.isS(DFT_ROT)&&isFtEnab(FT_DLGACC)){a.showMenuItem("divOUM",true);if(isExpLgn())a.enableMenuItem("divOUM",false);else a.enableMenuItem("divOUM",true)}if(g_oFldrMgr.isMyFId(b)||g_oFldrMgr.gtFL(b)==FL_AMB)if(a._getDescendant("divDelPtg")&&!this.isS(DFT_ROT)){a.showMenuItem("divDelPtg",true);a.enableMenuItem("divDelPtg",true);Owa.UIControls.DeletePolicyContextMenu.get_Instance(this._tr.get_SubPage()).set_SelectedIds(new Array(b))}if(g_oFldrMgr.isMyFId(b))if(a._getDescendant("divMvPtg")&&!this.isS(DFT_ROT)&&!this.isS(DFT_JNK)){var g=this._tr.gtNdByAls(ALP_DFT+DFT_JNK);if(!this._tr.isAncstr(g,this)){a.showMenuItem("divMvPtg",true);a.enableMenuItem("divMvPtg",true);Owa.UIControls.MovePolicyContextMenu.get_Instance(this._tr.get_SubPage()).set_SelectedIds(new Array(b))}}!this.canCrt()&&a.enableMenuItem("divCF",false);var f=this._tr.gtNdByAls(ALP_DFT+DFT_DEL);if(this._tr.isAncstr(f,this)){a.showMenuItem("divRs",true);a.enableMenuItem("divRs",true)}!this.canDel()&&a.enableMenuItem("divD",false);!this.canRnm()&&a.enableMenuItem("divRnm",false);if(this.isS(DFT_DEL)){a.showMenuItem("divED",true);a.enableMenuItem("divED",true);if(isFtEnab(FT_DUMPSTER)){a.showMenuItem("divRD",true);a.enableMenuItem("divRD",true)}}else if(this.isS(DFT_JNK)){a.showMenuItem("divEJ",true);a.enableMenuItem("divEJ",true)}else if(this.isOSF()||this.isS(DFT_RSS)||d)a.enableMenuItem("divEF",false);else{a.showMenuItem("divEF",true);a.enableMenuItem("divEF",true)}!this.canMv()&&a.enableMenuItem("divMvF",false);!this.canCp()&&a.enableMenuItem("divCpF",false)};Owa.Components.FolderTreeNode.prototype._preparePublicFolderMenu=function Owa$Components$FolderTreeNode$_preparePublicFolderMenu(a){var c=a.getAllMenuItemIds();a.showMenuItems(c,true);a.enableMenuItems(c,true);!this.canCrt()&&a.enableMenuItem("divCPF",false);!this.canDel()&&a.enableMenuItem("divDPF",false);!this.canRnm()&&a.enableMenuItem("divRnmPF",false);!this.canMv()&&a.enableMenuItem("divMvPF",false);!this.canCp()&&a.enableMenuItem("divCpPF",false);var b=this.gtFCC();!isOfClss(b,T_MSG)&&a.enableMenuItem("divEPF",false);(isOfClss(b,T_CAL)||isOfClss(b,T_CON)||isOfClss(b,T_TSK))&&a.showMenuItem("divMPFR",false)};Owa.Components.FolderTreeNode.prototype.onContextMenuClick=function Owa$Components$FolderTreeNode$onContextMenuClick(c){var b=this._tr;switch(c.sCommand){case"openotherfolder":opnShrDlg();break;case"markread":g_oFldrMgr.mkAllRd(this._tr,this.gtFId());break;case"emptydeleted":case"emptyfldr":case"emptyjunk":this.emptyFld();break;case"recoverdeleted":this._tr.get_ContextMenu().close();var d="?ae=Dialog&t=RecoverDeletedItems&id="+urlEnc(this.gtFId());opnWin(d,520,620,1,null,null,null,this._tr.get_SubPage());break;case"open":if(a_iNM==NM_CAL)b.feOnOpnCal(this.gtFId());else b.selNdById(this.gtId());break;case"opennew":opnNew(this.gtFId(),this.gtFCC(),b.gtSelELCNdFId?b.gtSelELCNdFId():null);break;case"delete":var h=g_oFldrMgr.gtFL(this.gtFId())==FL_PUB?1:0,g=this._tr.isAncstr(this._tr.gtNdByAls(ALP_DFT+DFT_DEL),this);this.delFld(h,g);break;case"rename":b.nwFld(this,0);break;case"createfolder":b.nwFld(this,1);break;case"move":case"movefolder":var a=Owa.UIControls.FolderPickerDialog.get_Default();a.set_IsShowPublicFolder(true);a.set_ButtonCaptions([L_Mv]);a.set_Title(L_MvToFld);a.set_SourceTreeNode(this);a.set_IsShowArchiveFolder(this.gtFCC()==T_MSG);a.onCheckCustomButtons=updateFolderPickerCopyMoveFolderButton;a.onButtonClick=this._createCallback(this.cbFolderPickerDialogButtonClick,a);a.show();break;case"copy":case"copyfolder":var a=Owa.UIControls.FolderPickerDialog.get_Default();a.set_IsShowPublicFolder(true);a.set_ButtonCaptions([L_Cp]);a.set_Title(L_CpToFld);a.set_SourceTreeNode(this);a.set_IsShowArchiveFolder(this.gtFCC()==T_MSG);a.onCheckCustomButtons=updateFolderPickerCopyMoveFolderButton;a.onButtonClick=this._createCallback(this.cbFolderPickerDialogButtonClick,a);a.show();break;case"removefromview":g_oNvNdMgr.rmvOUM(this._tr,this.gtFId());break;case"restore":if(g_oFldrMgr.gtFL(this.gtFId())==FL_AMB){var f=this._tr.gtNdByAls(ALP_DFT+DFT_ROT);g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),1,f.gtFId(),0,0,0,this._tr.gtFrt())}else if(isOfClss(this.gtFCC(),T_CAL))g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),1,this._tr.gtDfCalId(),0,0,0,FRT_ALL);else if(isOfClss(this.gtFCC(),T_CON))g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),1,this._tr.gtDfCntId(),0,0,0,FRT_ALL);else if(isOfClss(this.gtFCC(),T_TSK))g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),1,this._tr.gtDfTskId(),0,0,0,FRT_ALL);else{var e=this._tr.gtNdByAls(ALP_DFT+DFT_IBX);g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),1,e.gtFId(),0,0,0,FRT_ALL)}break;case"createMailFld":b.nwFld(this,1,T_MSG);break;case"createCalFld":b.nwFld(this,1,T_CAL);break;case"createCntFld":b.nwFld(this,1,T_CON);break;case"createTskFld":b.nwFld(this,1,T_TSK);break;case"createNtsFld":b.nwFld(this,1,T_NTS);break;case"addfavorite":g_oNvNdMgr.addFvr(this._tr,this.gtFId());break;case"removefromfavorite":g_oNvNdMgr.rmvFrmFvr(this._tr,this.gtFId())}};Owa.Components.FolderTreeNode.prototype.cbFolderPickerDialogButtonClick=function Owa$Components$FolderTreeNode$cbFolderPickerDialogButtonClick(g,e){var a=e._get_TreeControl(),b=a.gtSelNd().gtFId(),c=a.isAncstr(a.gtNdByAls(ALP_DFT+DFT_DEL),a.gtSelNd(),1),i=e.get_ButtonCaptions(g)==L_Cp,d=this._tr.gtNdByFId(b),f=this._tr.isAncstr(this._tr.gtNdByAls(ALP_DFT+DFT_DEL),this._tr.gtNdByFId(this.gtFId()),1),h=d&&!d.isUTD();g_oFldrMgr.cpMvFld(this._tr,this.gtFId(),f,b,c,i,h,c||isPFId(b)?FRT_HSF:FRT_HGF)};Owa.Components.FolderTreeNode.prototype.emptyFld=function Owa$Components$FolderTreeNode$emptyFld(){var a,b;if(g_oFldrMgr.gtFL(this.gtFId())==FL_PUB){a=L_PrEmpPF;b=L_EmptDltFdrTtl}else if(this.isS(DFT_DEL)){a=L_WrnEmpt;b=L_EmptFdrTtl}else if(this.isS(DFT_JNK)){a=L_WrnEmptJnk;b=L_EmptJnk}else{a=L_WrnEmptFldr;b=L_EmptDltFdrTtl}this._tr._fDontSyncSelection=1;var c=new BtnDlg("divDlt",htmlEnc(a),b,[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this.onEmptyFdr));c.show()};Owa.Components.FolderTreeNode.prototype.onEmptyFdr=function Owa$Components$FolderTreeNode$onEmptyFdr(a){addPerfMarker("FolderTreeNode.OnEmptyFdr.Start");a==0&&g_oFldrMgr.emptyFld(this._tr,this.gtFId());this._tr.syncSelNHl()};Owa.Components.FolderTreeNode.prototype.delFld=function Owa$Components$FolderTreeNode$delFld(a,c){var b;a=c?1:a;b=a?L_PrDelFldrPrp:L_WrnDlFl;this._tr._fDontSyncSelection=1;var d=new BtnDlg("divDlt",htmlEnc(b),L_WrnDlFlTtl,[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this.cbOnDelFld,[a,c]));d.show();return};Owa.Components.FolderTreeNode.prototype.cbOnDelFld=function Owa$Components$FolderTreeNode$cbOnDelFld(d,a){var c=a[0],b=a[1];d==0&&g_oFldrMgr.delFld(this._tr,this.gtFId(),b,c);this._tr.syncSelNHl()};Owa.Components.FolderTreeNode.prototype.isDummy=function Owa$Components$FolderTreeNode$isDummy(){return this._get_Element().getAttribute("_dummy")};Owa.Components.FolderTreeNode.prototype.stDummy=function Owa$Components$FolderTreeNode$stDummy(a){this._get_Element().setAttribute("_dummy",a)}})();g_fModuleLoaded[".\\uicontrols/foldertreenode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/foldertree.js".toLowerCase()]&&(function(){var a=0;Owa.UIControls.FolderTree=function Owa$UIControls$FolderTree(c,d,b){this._fOS=d;Owa.UIControls.FolderTree.constructBase(this,[c]);this._fPrstRt=b?1:0;if(!a)a=g_rgsFIcns[T_MSG]};Owa.UIControls.FolderTree.createClass("Owa.UIControls.FolderTree",Owa.UIControls.TreeControl);Owa.UIControls.FolderTree.prototype.initialize=function Owa$UIControls$FolderTree$initialize(){this.root.setExpando("_frt",this.root.getAttribute("_frt")?getInt(this.root.getAttribute("_frt")):0);if(!this._fOS){var a=this.gtNd(this.root.get_FirstChild()),c=a._get_Element();if(g_oFldrMgr.isMyFId(a.gtFId())){this.gtAndShwMbxUsg&&this._attachEvent(c,"mouseover",this.gtAndShwMbxUsg);this.hdMbxUsg&&this._attachEvent(c,"mouseout",this.hdMbxUsg)}}else{this._onDrp=null;this._onDO=null;this._onDL=null;this._onDS=null;this._onContextMenuEventHandler=null}var b=this.crtAls(this.gtNdRt());if(b)this._sSelNdId=b.gtId();Owa.UIControls.FolderTree.callBase(this,"initialize");g_oEd.attachEvent("RenameFolder",this,"cbOnRnFld");g_oEd.attachEvent("NewFolder",this,"cbOnNwFld");g_oEd.attachEvent("MoveFolder",this,"cbOnCpMvFld");g_oEd.attachEvent("CopyFolder",this,"cbOnCpMvFld");g_oEd.attachEvent("DeleteFolder",this,"cbOnDelFld");g_oEd.attachEvent("EmptyFolderStarted",this,"cbEmptyFolderStarted");g_oEd.attachEvent("EmptyFolder",this,"cbOnEmptyFld");g_oEd.attachEvent("UpdateCount",this,"cbOnUpdCnt");g_oEd.attachEvent("RemoveFromView",this,"cbOnRmvOUM");g_oEd.attachEvent("RemoveNavigation",this,"cbOnRmvNvNd");g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbOperationsStarted");g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbOperationsComplete");this._fOS&&this.clrSel()};Owa.UIControls.FolderTree.prototype.dispose=function Owa$UIControls$FolderTree$dispose(){var b=this.gtNd(this.root.get_FirstChild());if(b){var a=b._get_Element();if(a){this.gtAndShwMbxUsg&&this._detachEvent(a,"mouseover",this.gtAndShwMbxUsg);this.hdMbxUsg&&this._detachEvent(a,"mouseout",this.hdMbxUsg)}}g_oEd.detachEvent("RenameFolder",this,"cbOnRnFld");g_oEd.detachEvent("NewFolder",this,"cbOnNwFld");g_oEd.detachEvent("MoveFolder",this,"cbOnCpMvFld");g_oEd.detachEvent("CopyFolder",this,"cbOnCpMvFld");g_oEd.detachEvent("DeleteFolder",this,"cbOnDelFld");g_oEd.detachEvent("EmptyFolderStarted",this,"cbEmptyFolderStarted");g_oEd.detachEvent("EmptyFolder",this,"cbOnEmptyFld");g_oEd.detachEvent("UpdateCount",this,"cbOnUpdCnt");g_oEd.detachEvent("RemoveFromView",this,"cbOnRmvOUM");g_oEd.detachEvent("RemoveNavigation",this,"cbOnRmvNvNd");g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbOperationsStarted");g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbOperationsComplete");Owa.UIControls.FolderTree.callBase(this,"dispose")};Owa.UIControls.FolderTree.prototype.crtAls=function Owa$UIControls$FolderTree$crtAls(b){var a=this.gtNdFrstChld(b),c;b.gtFT&&b.gtFT()&&this.stAls(ALP_DFT+b.gtFT(),b.gtId());if(b.isSel())c=b;while(a){if(!c&&a.isSel())c=a;if(a.hsChld()&&a.isUTD())if(!c)c=this.crtAls(a);else this.crtAls(a);else a.gtFT&&a.gtFT()&&this.stAls(ALP_DFT+a.gtFT(),a.gtId());a=this.gtNdNxt(a)}return c};Owa.UIControls.FolderTree.prototype.gtDfCalId=function Owa$UIControls$FolderTree$gtDfCalId(){return this.root.getAttribute("_DfCal")};Owa.UIControls.FolderTree.prototype.gtDfCntId=function Owa$UIControls$FolderTree$gtDfCntId(){return this.root.getAttribute("_DfCnt")};Owa.UIControls.FolderTree.prototype.gtDfTskId=function Owa$UIControls$FolderTree$gtDfTskId(){return this.root.getAttribute("_DfTsk")};Owa.UIControls.FolderTree.prototype.getRemoteArchiveFlag=function Owa$UIControls$FolderTree$getRemoteArchiveFlag(){return this.root.getAttribute("_IsRemote")?1:0};Owa.UIControls.FolderTree.prototype.gtNdByFId=function Owa$UIControls$FolderTree$gtNdByFId(a){return this.gtNdById(padF(a))};Owa.UIControls.FolderTree.prototype.gtSelELCNdFId=function Owa$UIControls$FolderTree$gtSelELCNdFId(){var a=this.gtSelNd();while(a){if(a.isRt())return;if(a.isS()&&a.isPlcy()||a.gtAFlg())break;a=this.gtNdPrnt(a)}return a?a.gtFId():null};Owa.UIControls.FolderTree.prototype.gtFrt=function Owa$UIControls$FolderTree$gtFrt(){return this.root.getExpando("_frt")};Owa.UIControls.FolderTree.prototype.isCmptblFrt=function Owa$UIControls$FolderTree$isCmptblFrt(c,a,b){return this.isAncstr(this.gtNdByAls(ALP_DFT+DFT_DEL),c,1)?(a&~FRT_HGF)==(b&~FRT_HGF):a==b};Owa.UIControls.FolderTree.prototype.replaceDummyId=function Owa$UIControls$FolderTree$replaceDummyId(c,d,b){if(c.gtId()!=d){c._get_Element().set_Id(d);c.stDummy(null);if(b&&typeof g_oMMFrst!="undefined"){var a=null;if(b.sBody){a=this.root.get_OwnerDocument().createElement(DIV);a.set_InnerHtml(b.sBody)}else if(b.getDescendantById)a=b;a&&g_oMMFrst.gtTr("favorite").rldFrmE(a)}}};Owa.UIControls.FolderTree.prototype.gtArchiveRootNode=function Owa$UIControls$FolderTree$gtArchiveRootNode(){var a=this.gtNdFrstChld(this.gtNdRt()),c=null,b;while(a){b=a.gtFId().split(Owa.Utility.OwaPrefixes.SeparatorChar);if(b[0]==Owa.Utility.OwaPrefixes.ArchiveMailboxObjectPrefix){c=a;break}a=this.gtNdNxt(a)}return c};Owa.UIControls.FolderTree.prototype.wrapNd=function Owa$UIControls$FolderTree$wrapNd(a){return a.getAttribute("_t")==TN_FTN?new Owa.Components.FolderTreeNode(a,this):Owa.UIControls.FolderTree.callBase(this,"wrapNd",arguments)};Owa.UIControls.FolderTree.prototype.onKD=function Owa$UIControls$FolderTree$onKD(b){switch(b.get_KeyCodeForKeyUpDown()){case 46:var a=this.gtSelNd(),c=g_oFldrMgr.gtFL(a.gtFId())==FL_PUB?1:b.isShiftKeyDown();a&&a.canDel()&&a.delFld(c,0)}};Owa.UIControls.FolderTree.prototype.getChildren=function Owa$UIControls$FolderTree$getChildren(a){this.expOeh(a)};Owa.UIControls.FolderTree.prototype.feUpdChldCnt=function Owa$UIControls$FolderTree$feUpdChldCnt(b){for(var a=this.gtNdFrstChld(b);a;a=this.gtNdNxt(a))a.feUpdCnts()};Owa.UIControls.FolderTree.prototype.expOeh=function Owa$UIControls$FolderTree$expOeh(a){var d={sId:a.gtId()},c=this.gtFrt(),e=this.gtNdByAls(ALP_DFT+DFT_DEL),b=new oeReq("Tree","Expand",d,this._createCallback(this.cbExpOeh),GET);b.add("id",a.gtFId());if(this.isAncstr(e,a,1))c&=~FRT_HGF;b.add("rdt",c);b.send()};Owa.UIControls.FolderTree.prototype.cbExpOeh=function Owa$UIControls$FolderTree$cbExpOeh(c){var a=this.gtNdById(c.oCtx.sId);a.hdPrg();if(!this.cbOeh(c))return;var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(c.sBody);var d=b.getDescendantById("tn").getAttribute("ufid");d&&this.replaceDummyId(a,d,c);this.stKds(a,b.getDescendantById("tn").getChildrenSnapshot());a.stUTD(1);a.expand();this.feUpdChldCnt(a);var f=b.getDescendantById("tn").getAttribute("archiveroot");if(f){this.clrAls();var e=this.crtAls(this.gtNdRt());if(e)this._sSelNdId=e.gtId();var g=b.getDescendantById("tn").getAttribute("isremote");g&&this.root.setAttribute("_IsRemote","1")}};Owa.UIControls.FolderTree.prototype.cbOnRmvNvNd=function Owa$UIControls$FolderTree$cbOnRmvNvNd(f){if(f.isErr())return;var b=this.gtNdByAls(ALP_DFT+DFT_DEL);if(b&&b.isUTD()){var a=this.root.get_OwnerDocument().createElement(DIV);a.set_InnerHtml(f.sBody);a=a.getDescendantById("tn");if(a){var c=[],d=a.getChildrenSnapshot();while(d.length>0){var e=d.shift(),g=e.getAttribute("id").substr(1);g_oFldrMgr.gtFL(b.gtFId())==g_oFldrMgr.gtFL(g)&&c.push(e)}c.length>0&&this.addKds(b,c)}}};Owa.UIControls.FolderTree.prototype.cbOnDelFld=function Owa$UIControls$FolderTree$cbOnDelFld(d,i,j,l,k){var g=i==this;if(g&&!this.cbOeh(d))return;if(d.isErr())return;var b=this.gtNdByFId(j),a=this.gtNdByAls(ALP_DFT+DFT_DEL),h=this.gtSelNd(),e=b?this.isAncstr(b,h,1):0,c;if(e)c=this.gtNrstNd(b);b&&this.rmNd(b);if(!k&&a&&b)if(a.isUTD()){var f=this.root.get_OwnerDocument().createElement(DIV);f.set_InnerHtml(d.sBody);this.addKds(a,f.getDescendantById("tn").getChildrenSnapshot())}else{this.clrKds(a);a.stUTD(0);a._get_Element().setAttribute("_hsChld","1");a.upd()}if(e)if(!c)if(this._frst)this._frst.selDfN();else this.clrSel();else this.selNd(c)};Owa.UIControls.FolderTree.prototype.cbOnRmvOUM=function Owa$UIControls$FolderTree$cbOnRmvOUM(e,c){var b=c==this;if(!b)return;if(!this.cbOeh(e))return;this._frst&&this._frst.rmTr(this._nm);var d=this.gtNdRt(),a=this.gtNdFrstChld(d);a&&removeFolderView(a.gtFId());this.root.get_ParentElement().remove(true);this.dispose()};Owa.UIControls.FolderTree.prototype.cbOnCpMvFld=function Owa$UIControls$FolderTree$cbOnCpMvFld(e,o,l,u,k,t,j,p,q){var n=o==this;if(n&&!this.cbOeh(e))return;if(e.isErr())return;var c=this.gtNdByFId(l),a=this.gtNdByFId(k);if(!c&&!a)return;var g=this.gtSelNd(),h=this.hsSelNd()&&this.isAncstr(c,g,1),d;if(h)if(j)d=g;else d=this.gtNrstNd(c);!j&&c&&this.rmNd(c);if(a){if(a.isUTD()||p&&this.isCmptblFrt(a,this.gtFrt(),q)){var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(e.sBody);b=b.getDescendantById("tn");var i=b.getAttribute("ufid");i&&this.replaceDummyId(a,i,e);if(a.isUTD()){var f;b.forEachChild(function(a){if(a.getAttribute("_NF")){a.setAttribute("_NF",null);f=a.get_Id();return 1}});if(f){b.set_InnerHtml(b.getDescendantById(f).get_OuterHtml());if(a.isS(DFT_ROT)&&this.gtFrt()&FRT_HGF){if(g_oFldrMgr.isMyFId(a.gtFId())){var s=this.gtNdByAls(ALP_DFT+DFT_DEL);this.insrtKdsPos(s,b.getChildrenSnapshot(),0,1)}else if(g_oFldrMgr.gtFL(a.gtFId())==FL_AMB){var r=this.gtNdFrstChld(a);this.insrtKdsPos(r,b.getChildrenSnapshot(),0,0)}}else this.addKds(a,b.getChildrenSnapshot())}}else{var m=a.isExp();this.clrKds(a);this.addKds(a,b.getChildrenSnapshot());if(m)a.expand();else a.collapse();a.stUTD(1)}}a.expand();this.feUpdChldCnt(a)}if(h){if(!d&&this._frst)return this._frst.selDfN();if(d){this.selNd(d);this.syncSelNHl()}}};Owa.UIControls.FolderTree.prototype.cbOnUpdCnt=function Owa$UIControls$FolderTree$cbOnUpdCnt(b,c,d){var a=this.gtNdByFId(b);if(!a)return;a.updCnts(c,d)};Owa.UIControls.FolderTree.prototype.cbEmptyFolderStarted=function Owa$UIControls$FolderTree$cbEmptyFolderStarted(b){var a=this.gtNdByFId(b);if(!a)return;if(a.isS(DFT_DEL)||a.isS(DFT_JNK)){this.isAncstr(a,this.gtSelNd())&&this.selNd(this.gtNdByAls(ALP_DFT+DFT_IBX));this.clrKds(a)}};Owa.UIControls.FolderTree.prototype.cbOnEmptyFld=function Owa$UIControls$FolderTree$cbOnEmptyFld(f,e,b){var a=this.gtNdByFId(b);if(!a)return;if(a_sLstFID==b){var d=this.get_SubPage().getLstVw(b);d&&d.rfrsh&&d.rfrsh()}else{var c;if(a.isS(DFT_DEL)||a.isS(DFT_JNK))c=getViewSubPageControllerByFolderId(b);c&&c.remove()}(a.isS(DFT_DEL)||a.isS(DFT_JNK))&&getMailboxUsage()};Owa.UIControls.FolderTree.prototype.nwFld=function Owa$UIControls$FolderTree$nwFld(a,c,f){var b={sCC:f};if(!c)return this.edtNd(a,b);else if(!(a.isS(DFT_ROT)&&this.gtFrt()&FRT_HGF)||g_oFldrMgr.gtFL(a.gtFId())==FL_AMB)return this.crtNwNd(a,b,0,this.gtNdFrstChld(a));else{var d=this.gtNdByAls(ALP_DFT+DFT_DEL),e=this.gtNdNxt(d);this.crtNwNd(a,b,0,e)}};Owa.UIControls.FolderTree.prototype.onRnNd=function Owa$UIControls$FolderTree$onRnNd(b,c){var a=this._edt.nd;if(b!=ECR_ESC)g_oFldrMgr.rnmFld(this,a.gtFId(),c);else this.qtEdtNd()};Owa.UIControls.FolderTree.prototype.cbOnRnFld=function Owa$UIControls$FolderTree$cbOnRnFld(b,e,f){var d=e==this;if(d&&this._edting&&!this.cbOeh(b,true))return;if(b.isErr())return;var c=this.gtNdByFId(f);if(c){var a=this.root.get_OwnerDocument().createElement(DIV);a.set_InnerHtml(b.sBody);var a=a.getDescendantById("tn");a&&c.stDspNm(a.get_TextContent())}};Owa.UIControls.FolderTree.prototype.onNwNd=function Owa$UIControls$FolderTree$onNwNd(e,f){var b=this._edt.nd,a=this.gtNdPrnt(b);if(e!=ECR_ESC){var d=this.gtNdByAls(ALP_DFT+DFT_DEL),c=this.isAncstr(d,b,1);g_oFldrMgr.nwFld(this,a.gtFId(),c,this._edt.oCtx.sCC?this._edt.oCtx.sCC:a.gtFCC(),f,a.isUTD()?0:1,c?FRT_ALL:this.gtFrt())}else this.qtEdtNd()};Owa.UIControls.FolderTree.prototype.cbOnNwFld=function Owa$UIControls$FolderTree$cbOnNwFld(d,i,j,q,p,o,k,l){var e=i==this;if(e&&this._edting&&!this.cbOeh(d,true))return;if(d.isErr())return;var a=this.gtNdByFId(j);if(!a)return;if(a.isUTD()||k&&this.isCmptblFrt(a,this.gtFrt(),l)){var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(d.sBody);b=b.getDescendantById("tn");var g=b.getAttribute("ufid");g&&this.replaceDummyId(a,g,d);var c;(e||a.isUTD())&&b.forEachChild(function(a){if(a.getAttribute("_NF")){a.setAttribute("_NF",null);c=a.get_Id();return 1}});if(a.isUTD()&&c){b.set_InnerHtml(b.getDescendantById(c).get_OuterHtml());if(a.isS(DFT_ROT)&&g_oFldrMgr.isMyFId(a.gtFId())&&this.gtFrt()&FRT_HGF){var m=this.gtNdByAls(ALP_DFT+DFT_DEL);this.insrtKdsPos(m,b.getChildrenSnapshot(),0,1)}else{var f=this.gtNdFrstChld(a);if(f)this.insrtKdsPos(f,b.getChildrenSnapshot());else this.addKds(a,b.getChildrenSnapshot())}}else{var h=a.isExp();this.clrKds(a);this.addKds(a,b.getChildrenSnapshot());if(h)a.expand();else a.collapse();a.stUTD(1)}this.feUpdChldCnt(a)}if(e){a.expand();var n=this.gtNdById(c);this.feOnNwFld(n)}};Owa.UIControls.FolderTree.prototype.feOnNwFld=function Owa$UIControls$FolderTree$feOnNwFld(a){if(this.onNwFld)this.onNwFld(a)};Owa.UIControls.FolderTree.prototype.gtNwNdIcnMrkup=function Owa$UIControls$FolderTree$gtNwNdIcnMrkup(d,c){var e=d.gtImg(),b;if(e)b=e.get_OuterHtml();if(isOfClss(d.gtFCC(),T_MSG))b=Owa.Components.CssSprites.getImageMarkup(a,'id="'+NODE_ICON+'"');if(c.sCC){var f=c.sCC;b=Owa.Components.CssSprites.getImageMarkup(g_rgsFIcns[f]?g_rgsFIcns[f]:g_rgsFIcns[T_MSG],'id="'+NODE_ICON+'"')}return b};Owa.UIControls.FolderTree.prototype.gtAndShwMbxUsg=function Owa$UIControls$FolderTree$gtAndShwMbxUsg(a){g_iPrgIndQt=Owa.Dom.Window.get_Current().setTimeout(this._createCallback(this.cbGtAndShwMbxUsg,[a.get_ClientX(),a.get_ClientY()]),1e3)};Owa.UIControls.FolderTree.prototype.cbGtAndShwMbxUsg=function Owa$UIControls$FolderTree$cbGtAndShwMbxUsg(d,a){var b=a[0],c=a[1];g_iPrgIndQt!=0&&getMailboxUsage(1,b,c)};Owa.UIControls.FolderTree.prototype.hdMbxUsg=function Owa$UIControls$FolderTree$hdMbxUsg(){if(g_iPrgIndQt){this._clearTimeout(g_iPrgIndQt);g_iPrgIndQt=0}hideMailboxUsage()}})();g_fModuleLoaded[".\\uicontrols/foldertree.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/navigationheadertreenode.js".toLowerCase()]&&(function(){Owa.Components.NavigationHeaderTreeNode=function Owa$Components$NavigationHeaderTreeNode(a,b){Owa.Components.NavigationHeaderTreeNode.constructBase(this,[a,b])};Owa.Components.NavigationHeaderTreeNode.createClass("Owa.Components.NavigationHeaderTreeNode",Owa.Components.TreeNode);Owa.Components.NavigationHeaderTreeNode.prototype.gtNId=function Owa$Components$NavigationHeaderTreeNode$gtNId(){return this.gtId().substr(1)};Owa.Components.NavigationHeaderTreeNode.prototype.gtDrpMd=function Owa$Components$NavigationHeaderTreeNode$gtDrpMd(c,j,e){var a=e.get_RootElement();switch(e.get_TypeName()){case Owa.Components.DraggableObjects.Type.NavigationHeader:var b=a.get_NavigationNodeId();if(this.gtNId()==b)return DRP_NONE;var h=j.get_ClientY(),g=this.getContainer().get_DocumentTop()+this.getContainer().get_OffsetHeight()/2;if(h>g){var c=this._tr.gtNdNxt(this);if(!c||c.gtNId()!=b)return DRP_BELOW|DRP_MOVE}else{var d=this._tr.gtNdPrv(this);if(!d||d.gtNId()!=b)return DRP_ABOVE|DRP_MOVE}return DRP_NONE;case Owa.Components.DraggableObjects.Type.NavigationNode:var b=a.get_NavigationNodeId();if(!c.equals(this))return DRP_NONE;var f=this._tr.gtNdById(padF(b));if(!f)return DRP_NONE;var d=this._tr.gtNdPrnt(f);return d.gtNId()==this.gtNId()?DRP_NONE:DRP_MOVE;case Owa.Components.DraggableObjects.Type.Folder:var i=g_oNvNdMgr.canAddToFvr(a.get_FolderId(),a.get_FolderContainerClass(),a.get_FolderType(),a.get_IsInDeletedItems(),a.get_IsRemote());return!i||!this.equals(c)||this._tr.gtGS()!=GS_FVR?DRP_NONE:DRP_COPY;default:return DRP_NONE}};Owa.Components.NavigationHeaderTreeNode.prototype.drpIn=function Owa$Components$NavigationHeaderTreeNode$drpIn(c,d){var b=c.get_RootElement();switch(c.get_TypeName()){case Owa.Components.DraggableObjects.Type.NavigationNode:var a=this._tr.gtNdById(padF(b.get_NavigationNodeId()));a&&this._tr.mv(a,this,1);return;case Owa.Components.DraggableObjects.Type.NavigationHeader:var a=this._tr.gtNdById(padF(b.get_NavigationNodeId()));a&&this._tr.mv(a,this,(d&DRP_EFF_MSK)==DRP_ABOVE?0:1);return;case Owa.Components.DraggableObjects.Type.Folder:if(this._tr.gtGS()!=GS_FVR)return;g_oNvNdMgr.addFvr(this._tr,b.get_FolderId());return;default:return Owa.Components.NavigationHeaderTreeNode.callBase(this,"drpIn",arguments)}};Owa.Components.NavigationHeaderTreeNode.prototype.canDrg=function Owa$Components$NavigationHeaderTreeNode$canDrg(){return 1};Owa.Components.NavigationHeaderTreeNode.prototype.onDrg=function Owa$Components$NavigationHeaderTreeNode$onDrg(d){var c=new Owa.Components.Storage.DragDrop(d),b=Owa.Components.Storage.StorableObject.create(Owa.Components.DraggableObjects.Type.NavigationHeader),a=b.get_RootElement();a.set_NavigationNodeId(this.gtNId());a.set_GroupSection(this._tr.gtGS());b.save(c)};Owa.Components.NavigationHeaderTreeNode.prototype.canDrpExp=function Owa$Components$NavigationHeaderTreeNode$canDrpExp(){return this.hsChld()};Owa.Components.NavigationHeaderTreeNode.prototype.persistExp=function Owa$Components$NavigationHeaderTreeNode$persistExp(b){if(this._tr.gtGS()==GS_FVR)g_oFldrMgr.prstTrExpSt();else{var a=new oeReq("NavigationNode","PersistExpand",null,null,POST);a.add("GS",this._tr.gtGS());a.add("srcNId",this.gtNId());a.add("exp",b?1:0);a.send()}};Owa.Components.NavigationHeaderTreeNode.prototype._onBeforeContextMenu=function Owa$Components$NavigationHeaderTreeNode$_onBeforeContextMenu(){if(this._tr.gtGS()==GS_FVR)return true;var a=getNavigationTreeMenu();if(!a)return true;for(var d={_divNG:true,_divRnmGp:true,_divDelGp:true,_divMvUp:true,_divMvDn:true},e=a.getAllMenuItemIds(),c=0;c<e.length;c++){var b=e[c];a.showMenuItem(b,d[b]);d[b]&&a.enableMenuItem(b,true)}!this._tr.gtNdPrv(this)&&a.enableMenuItem("_divMvUp",false);!this._tr.gtNdNxt(this)&&a.enableMenuItem("_divMvDn",false);switch(this._tr.gtGS()){case GS_CAL:a.showMenuItems(["_divNCal","_divOUCal"],true);a.enableMenuItems(["_divNCal","_divOUCal"],true);isExpLgn()&&a.enableMenuItem("_divOUCal",false);break;case GS_CNT:a.showMenuItems(["_divNCnt"],true);a.enableMenuItems(["_divNCnt"],true);break;case GS_TSK:a.showMenuItems(["_divNTsk"],true);a.enableMenuItems(["_divNTsk"],true)}this._tr.set_ContextMenu(a)};Owa.Components.NavigationHeaderTreeNode.prototype.onContextMenuClick=function Owa$Components$NavigationHeaderTreeNode$onContextMenuClick(b){var a=this._tr;switch(b.sCommand){case"openotherfolder":opnShrDlg();break;case"newgroup":a.crtNwGp();break;case"new":a.crtNw(this);break;case"rename":a.rnmGp(this);break;case"delete":a.rmv(this,L_WrnRmGp,L_RmGpTtl);break;case"moveup":case"movedown":a.upDn(this,b.sCommand=="moveup")}}})();g_fModuleLoaded[".\\uicontrols/navigationheadertreenode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/navigationfoldertreenode.js".toLowerCase()]&&(function(){Owa.Components.NavigationFolderTreeNode=function Owa$Components$NavigationFolderTreeNode(a,b){Owa.Components.NavigationFolderTreeNode.constructBase(this,[a,b])};Owa.Components.NavigationFolderTreeNode.createClass("Owa.Components.NavigationFolderTreeNode",Owa.Components.FolderTreeNode);Owa.Components.NavigationFolderTreeNode.prototype.hsChld=function Owa$Components$NavigationFolderTreeNode$hsChld(){return 0};Owa.Components.NavigationFolderTreeNode.prototype.gtImgCk=function Owa$Components$NavigationFolderTreeNode$gtImgCk(){return this._get_Element().getChildById("imgCk")};Owa.Components.NavigationFolderTreeNode.prototype.stCk=function Owa$Components$NavigationFolderTreeNode$stCk(a){this._get_Element().setExpando("_fCk",a);Owa.Components.CssSprites.updateImage(this.gtImgCk(),a?"chk-chkd.gif":"chk-unchk.gif")};Owa.Components.NavigationFolderTreeNode.prototype.isChkd=function Owa$Components$NavigationFolderTreeNode$isChkd(){return this._get_Element().getExpando("_fCk")};Owa.Components.NavigationFolderTreeNode.prototype.hdCnt=function Owa$Components$NavigationFolderTreeNode$hdCnt(){this._tr.gtGS()==GS_CAL&&this.gtImgCk().set_IsShown(false);this.getContent().set_IsShown(false)};Owa.Components.NavigationFolderTreeNode.prototype.shwCnt=function Owa$Components$NavigationFolderTreeNode$shwCnt(){this._tr.gtGS()==GS_CAL&&this.gtImgCk().set_IsShown(true);this.getContent().set_IsShown(true)};Owa.Components.NavigationFolderTreeNode.prototype.gtNId=function Owa$Components$NavigationFolderTreeNode$gtNId(){return this.gtId().substr(1)};Owa.Components.NavigationFolderTreeNode.prototype.canDel=function Owa$Components$NavigationFolderTreeNode$canDel(){var a=g_oFldrMgr.gtFL(this.gtFId());return a==FL_OUM||a==FL_GS?0:Owa.Components.NavigationFolderTreeNode.callBase(this,"canDel",arguments)};Owa.Components.NavigationFolderTreeNode.prototype.canRnm=function Owa$Components$NavigationFolderTreeNode$canRnm(){return this._get_Element().getAttribute("_fltr")?1:Owa.Components.NavigationFolderTreeNode.callBase(this,"canRnm",arguments)};Owa.Components.NavigationFolderTreeNode.prototype.canMv=function Owa$Components$NavigationFolderTreeNode$canMv(){var a=g_oFldrMgr.gtFL(this.gtFId());return a==FL_OUM||a==FL_GS?0:Owa.Components.NavigationFolderTreeNode.callBase(this,"canMv",arguments)};Owa.Components.NavigationFolderTreeNode.prototype.canCp=function Owa$Components$NavigationFolderTreeNode$canCp(){return this.isS(DFT_TDS)||g_oFldrMgr.gtFL(this.gtFId())==FL_GS?0:Owa.Components.NavigationFolderTreeNode.callBase(this,"canCp",arguments)};Owa.Components.NavigationFolderTreeNode.prototype.gtFId=function Owa$Components$NavigationFolderTreeNode$gtFId(){return this._get_Element().getAttribute("_fid")};Owa.Components.NavigationFolderTreeNode.prototype.setDisplayColor=function Owa$Components$NavigationFolderTreeNode$setDisplayColor(a){if(this._tr.gtGS()!=GS_CAL)return;this.setHighlightEffect("nbcal"+a)};Owa.Components.NavigationFolderTreeNode.prototype.saveColor=function Owa$Components$NavigationFolderTreeNode$saveColor(b){if(this._tr.gtGS()!=GS_CAL)return;this._get_Element().setIntAttribute("_iSavedColor",b);var a=new oeReq("CalendarView","SetCalendarColor",0,cbSetColor);a.add("fId",this.gtFId());a.add("Idx",b);a.send()};Owa.Components.NavigationFolderTreeNode.prototype.getSavedColor=function Owa$Components$NavigationFolderTreeNode$getSavedColor(){if(this._tr.gtGS()==GS_CAL){var a=this._get_Element().getIntAttribute("_iSavedColor");if(a>0)return a}return-1};Owa.Components.NavigationFolderTreeNode.prototype.stHl=function Owa$Components$NavigationFolderTreeNode$stHl(){if(this._tr.gtGS()==GS_CAL)return;Owa.Components.NavigationFolderTreeNode.callBase(this,"stHl",arguments)};Owa.Components.NavigationFolderTreeNode.prototype.canDrg=function Owa$Components$NavigationFolderTreeNode$canDrg(){return 1};Owa.Components.NavigationFolderTreeNode.prototype.onDrg=function Owa$Components$NavigationFolderTreeNode$onDrg(d){var c=new Owa.Components.Storage.DragDrop(d),b=Owa.Components.Storage.StorableObject.create(Owa.Components.DraggableObjects.Type.NavigationNode),a=b.get_RootElement();a.set_NavigationNodeId(this.gtNId());a.set_GroupSection(this._tr.gtGS());a.set_FolderId(this.gtFId());b.save(c)};Owa.Components.NavigationFolderTreeNode.prototype.gtDrpMd=function Owa$Components$NavigationFolderTreeNode$gtDrpMd(d,h,c){var b,a=c.get_RootElement();switch(c.get_TypeName()){case Owa.Components.DraggableObjects.Type.Items:case Owa.Components.DraggableObjects.Type.Conversations:return Owa.Components.NavigationFolderTreeNode.callBase(this,"gtDrpMd",arguments);case Owa.Components.DraggableObjects.Type.Folder:if(!g_oNvNdMgr.canAddToFvr(a.get_FolderId(),a.get_FolderContainerClass(),a.get_FolderType(),a.get_IsInDeletedItems(),a.get_IsRemote())||this._tr.gtGS()!=GS_FVR)return DRP_NONE;b=DRP_COPY;break;case Owa.Components.DraggableObjects.Type.NavigationNode:if(a.get_NavigationNodeId()==this.gtNId())return DRP_NONE;if(a.get_GroupSection()!=this._tr.gtGS())return DRP_NONE;b=DRP_MOVE;break;default:return DRP_NONE}var g=h.get_ClientY(),f=this.getContainer().get_DocumentTop()+this.getContainer().get_OffsetHeight()/2;if(g>f){var d=this._tr.gtNdNxt(this);if(!d||d.gtFId()!=a.get_FolderId())return DRP_BELOW|b}else{var e=this._tr.gtNdPrv(this);if(!e||e.gtFId()!=a.get_FolderId())return DRP_ABOVE|b}return DRP_NONE};Owa.Components.NavigationFolderTreeNode.prototype.drpIn=function Owa$Components$NavigationFolderTreeNode$drpIn(a,d){var c=a.get_RootElement();switch(a.get_TypeName()){case Owa.Components.DraggableObjects.Type.NavigationNode:var b=this._tr.gtNdById(padF(c.get_NavigationNodeId()));b&&this._tr.mv(b,this,(d&DRP_EFF_MSK)==DRP_ABOVE?0:1);return;default:return Owa.Components.NavigationFolderTreeNode.callBase(this,"drpIn",arguments)}};Owa.Components.NavigationFolderTreeNode.prototype.canDrpExp=function Owa$Components$NavigationFolderTreeNode$canDrpExp(){return false};Owa.Components.NavigationFolderTreeNode.prototype._onBeforeContextMenu=function Owa$Components$NavigationFolderTreeNode$_onBeforeContextMenu(){var a=getNavigationTreeMenu();if(!a)return true;for(var c=this._tr.gtGS(),i={_divO:true,_divON:true,_divDel:true,_divRnm:true,_divMvUp:true,_divMvDn:true,_divRFV:c!=GS_CAL,_divDonotShowCal:c==GS_CAL},j=a.getAllMenuItemIds(),f=0;f<j.length;f++){var d=j[f];a.showMenuItem(d,i[d]);i[d]&&a.enableMenuItem(d,true)}var h=g_oFldrMgr.isMyFId(this.gtFId());if(h){if(!this.isExternal()){a.showMenuItem("_divRFV",false);a.showMenuItem("_divDonotShowCal",false)}}else a.enableMenuItem("_divDel",false);if(c==GS_CAL){a.showMenuItem("_divShare",true);a.showMenuItem("_divShCal",true);a.showMenuItem("_divChShPm",true);a.showMenuItem("_divChPbPm",true);a.showMenuItem("_divPbCal",!this.isPublishedOut());a.showMenuItem("_divSndLnkCal",this.isPublishedOut());var e=h&&!this.isExternal(),g=getCurrentViewSubPage().getSubPageVariable("a_fCanPublish");a.enableMenuItems(["_divShCal","_divChShPm"],e);a.enableMenuItems(["_divPbCal","_divSndLnkCal"],e&&g);a.enableMenuItem("_divChPbPm",this.isPublishedOut()&&e&&g);a.enableMenuItem("_divShowUrl",this.isWebCalendar())}var b;switch(c){case GS_CAL:a.showMenuItem("_divPCC",true);b="Cal";break;case GS_CNT:b="Cnt";break;case GS_TSK:b="Tsk"}!this._tr.gtNdPrv(this)&&a.enableMenuItem("_divMvUp",false);!this._tr.gtNdNxt(this)&&a.enableMenuItem("_divMvDn",false);a.showMenuItem("_divN"+b,true);a.enableMenuItem("_divN"+b,true);a.showMenuItem("_divM"+b,true);a.showMenuItem("_divC"+b,true);a.showMenuItem("_divRnm",true);a.showMenuItem("_divDel",true);if(this.canMv())a.enableMenuItem("_divM"+b,true);else a.enableMenuItem("_divM"+b,false);if(this.canCp())a.enableMenuItem("_divC"+b,true);else a.enableMenuItem("_divC"+b,false);if(this.canRnm())a.enableMenuItem("_divRnm",true);else a.enableMenuItem("_divRnm",false);if(this.canDel())a.enableMenuItem("_divDel",true);else a.enableMenuItem("_divDel",false);this._tr.set_ContextMenu(a)};Owa.Components.NavigationFolderTreeNode.prototype.onContextMenuClick=function Owa$Components$NavigationFolderTreeNode$onContextMenuClick(c){var a=this._tr;switch(c.sCommand){case"new":a.crtNw(this._tr.gtNdPrnt(this));break;case"rename":a.rnm(this);break;case"delete":if(a.gtGS()==GS_FVR)return Owa.Components.NavigationFolderTreeNode.callBase(this,"onContextMenuClick",arguments);a.rmv(this,L_WrnDlFl,L_WrnDlFlTtl);break;case"moveup":case"movedown":a.upDn(this,c.sCommand=="moveup");break;case"removefromview":case"donotshowthiscalendar":if(this.isExternal()&&a.gtGS()==GS_CAL)g_oFldrMgr.delFld(a,this.gtFId(),0,1);else g_oNvNdMgr.rmv(a,this.gtNId(),a.gtGS());break;case"pickColor":var b=parseInt(c.oMenuItem.sColorValue);if(this.getSavedColor()!=b){if(this.isChkd()){this.setDisplayColor(b);var i=g_oCalTr.gtNdByAls(AL_DEF);i.equals(this)&&b<0&&this.setHighlightEffect(DEFAULT_CALENDAR_CLASS)}this.saveColor(b);var h=this.gtFId();updateColorInCalendarView(b,null,h)}return true;case"sharecal":newItm("IPM.Sharing",null,"&fldId="+Owa.Encoder.urlEncode(this.gtFId()),null,null,this._tr.get_SubPage());break;case"pubcal":openEcpChangeCalendarPublishPermissionWin(this.gtFId());break;case"sndlnkcal":newItm("IPM.Sharing",null,"&fldId="+Owa.Encoder.urlEncode(this.gtFId())+"&publish=1",null,null,this._tr.get_SubPage());break;case"changesharingpremissions":openEcpChangeCalendarSharingPermissionWin(this.gtFId());break;case"showurl":if(this.isWebCalendar()){var e=this._get_Element().getAttribute("sWebCalUrl");if(!e){var d={};d.sLastFolderId=a_sLstFID;var f=new oeReq("NavigationNode","GetWebCalendarUrl",d,this._createCallback(this._cbGetWebCalendarUrl),POST);f.add("Id",this.gtFId());f.send()}else{var g=getViewSubPageControllerByFolderId(a_sLstFID);g.invokeFunction("showWebCalendarUrl",[e,this.gtFldNm()])}}break;default:return Owa.Components.NavigationFolderTreeNode.callBase(this,"onContextMenuClick",arguments)}};Owa.Components.NavigationFolderTreeNode.prototype._cbGetWebCalendarUrl=function Owa$Components$NavigationFolderTreeNode$_cbGetWebCalendarUrl(a){if(a.sErr){if(a.fST)popLgn();else shwErrDlg(0,a.sErr);return}if(a.sBody){this._get_Element().setAttribute("sWebCalUrl",a.sBody);var b=getViewSubPageControllerByFolderId(a.oCtx.sLastFolderId);b.invokeFunction("showWebCalendarUrl",[a.sBody,this.gtFldNm()])}}})();g_fModuleLoaded[".\\uicontrols/navigationfoldertreenode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/navigationtree.js".toLowerCase()]&&(function(){Owa.UIControls.NavigationTree=function Owa$UIControls$NavigationTree(a,b){this._fD=b;Owa.UIControls.NavigationTree.constructBase(this,[a])};Owa.UIControls.NavigationTree.createClass("Owa.UIControls.NavigationTree",Owa.UIControls.TreeControl);Owa.UIControls.NavigationTree.prototype.initialize=function Owa$UIControls$NavigationTree$initialize(){this._iGS=this.root.getAttribute("_iGS");var a=this.crtNFDict();if(a)this._sSelNdId=a.gtId();if(this._fD){this._onDrp=null;this._onDO=null;this._onDL=null;this._onDS=null;this._onContextMenuEventHandler=null}g_oEd.attachEvent("RemoveNavigation",this,"cbRmvNvNd");g_oEd.attachEvent("NewFolder",this,"cbOnFldrOeh");g_oEd.attachEvent("MoveFolder",this,"cbOnFldrOeh");g_oEd.attachEvent("CopyFolder",this,"cbOnFldrOeh");g_oEd.attachEvent("ReloadNavigationTree",this,"cbOnFldrOeh");if(this.gtGS()!=GS_FVR){g_oEd.attachEvent("DeleteFolder",this,"cbOnFldrOeh");g_oEd.attachEvent("NewNavigation",this,"cbOnNwNv");g_oEd.attachEvent("RenameNavigation",this,"cbOnRnmNv")}g_oEd.attachEvent("EmptyFolder",this,"cbOnFldrOeh");Owa.UIControls.NavigationTree.callBase(this,"initialize")};Owa.UIControls.NavigationTree.prototype.dispose=function Owa$UIControls$NavigationTree$dispose(){g_oEd.detachEvent("RemoveNavigation",this,"cbRmvNvNd");g_oEd.detachEvent("NewFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("MoveFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("CopyFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("DeleteFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("EmptyFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("NewNavigation",this,"cbOnNwNv");g_oEd.detachEvent("RenameNavigation",this,"cbOnRnmNv");Owa.UIControls.NavigationTree.callBase(this,"dispose")};Owa.UIControls.NavigationTree.prototype.gtNdByFId=function Owa$UIControls$NavigationTree$gtNdByFId(b){var a=this._NFDict[padF(b)];if(a)return this.gtNdById(a.id)};Owa.UIControls.NavigationTree.prototype.stDfNd=function Owa$UIControls$NavigationTree$stDfNd(){var a;switch(this.gtGS()){case GS_CAL:a=this.gtNdByAls(ALP_DFT+DFT_CAL);break;case GS_CNT:a=this.gtNdByAls(ALP_DFT+DFT_CNT);break;case GS_TSK:a=this.gtNdByAls(ALP_DFT+DFT_TDS)}a&&this.stAls(AL_DEF,a.gtId())};Owa.UIControls.NavigationTree.prototype.gtGS=function Owa$UIControls$NavigationTree$gtGS(){return this._iGS};Owa.UIControls.NavigationTree.prototype.wrapNd=function Owa$UIControls$NavigationTree$wrapNd(a){switch(a.getAttribute("_t")){case TN_FTN:return new Owa.Components.NavigationFolderTreeNode(a,this);case TN_GH:return new Owa.Components.NavigationHeaderTreeNode(a,this);default:return Owa.UIControls.NavigationTree.callBase(this,"wrapNd",arguments)}};Owa.UIControls.NavigationTree.prototype.gtRgFId=function Owa$UIControls$NavigationTree$gtRgFId(){return this._rgFId};Owa.UIControls.NavigationTree.prototype.gtSelFId=function Owa$UIControls$NavigationTree$gtSelFId(){return this._sSelFId};Owa.UIControls.NavigationTree.prototype.forEachNd=function Owa$UIControls$NavigationTree$forEachNd(c){var d=this.gtNdRt(),a=this.gtNdFrstChld(d);while(a){var b=this.gtNdFrstChld(a);while(b){c.call(this,a,b);b=this.gtNdNxt(b)}a=this.gtNdNxt(a)}};Owa.UIControls.NavigationTree.prototype.crtNFDict=function Owa$UIControls$NavigationTree$crtNFDict(){if(!this._NFDict)this._NFDict={};this._rgFId=[];this._sSelFId=0;g_oNvNdMgr.stNFDict(this.gtGS(),this._NFDict);var a;this.clrAls();this.forEachNd(function(d,b){this.gtGS()==GS_FVR&&b.feUpdCnts();if(b.isSel()){a=b;this._sSelFId=b.gtFId()}b.isS()&&this.stAls(ALP_DFT+b.gtFT(),b.gtId());if(this._NFDict[padF(b.gtFId())]){var c=this.crtNFRec(b,d);c._next=this._NFDict[padF(b.gtFId())];this._NFDict[padF(b.gtFId())]=c}else this._NFDict[padF(b.gtFId())]=this.crtNFRec(b,d);this._rgFId.push(b.gtFId())});this.stDfNd();return a};Owa.UIControls.NavigationTree.prototype.crtNFRec=function Owa$UIControls$NavigationTree$crtNFRec(a,b){return{id:a.gtId(),nid:a.gtNId(),pid:b.gtId(),pnid:b.gtNId()}};Owa.UIControls.NavigationTree.prototype.onKD=function Owa$UIControls$NavigationTree$onKD(b){switch(b.get_KeyCodeForKeyUpDown()){case 46:var a=this.gtSelNd();a&&a.canDel()&&this.rmv(a,L_WrnDlFl,L_WrnDlFlTtl)}};Owa.UIControls.NavigationTree.prototype.rldFrmR=function Owa$UIControls$NavigationTree$rldFrmR(d){if(d.sBody){var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(d.sBody);var c=b.getDescendantById("ntn");if(c){var a=c.getDescendantById(this.root.get_ParentElement().get_Id());a&&this.rld(a)}}};Owa.UIControls.NavigationTree.prototype.rldFrmE=function Owa$UIControls$NavigationTree$rldFrmE(c){var b=c.getDescendantById("ntn");if(b){var a=b.getDescendantById(this.root.get_ParentElement().get_Id());a&&this.rld(a)}};Owa.UIControls.NavigationTree.prototype.cbRmvNvNd=function Owa$UIControls$NavigationTree$cbRmvNvNd(b,c,e){var d=c==this;if(d&&!this.cbOeh(b))return;if(b.isErr())return;var a=this.gtNdById(padF(e));a instanceof Owa.Components.NavigationFolderTreeNode&&g_oFldrMgr.gtFL(a.gtFId())==FL_OUM&&removeFolderView(a.gtFId());this.cbOnFldrOeh(b,c)};Owa.UIControls.NavigationTree.prototype.cbOnFldrOeh=function Owa$UIControls$NavigationTree$cbOnFldrOeh(a,b){this.rldFrmR(a);b==this&&a.CheckErrors()};Owa.UIControls.NavigationTree.prototype.rld=function Owa$UIControls$NavigationTree$rld(k){var g={},n=this.gtNdRt(),a=this.gtNdFrstChld(n),m=this.gtSelNd(),i,b=m,h=this.hsSelNd(),c=h?b.gtId():"";while(a){g[a.gtId()]=a.hsChld()?!a.isExp():0;a=this.gtNdNxt(a)}var f=k.get_FirstChild().get_FirstChild();if(h){while(c&&!f.getDescendantById(c)){i=b;b=this.gtNrstNd(b);c=b?b.gtId():null;this.rmNd(i)}if(!c||!f.getDescendantById(c))c=null}var e=this.root.get_FirstChild();if(e){e.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,k.get_FirstChild().get_FirstChild());e.remove(true)}else this.root.appendChild(f);for(var l in g){a=this.gtNdById(l);if(a)if(g[l])a.collapse();else a.expand()}this._NFDict=null;var d=this.crtNFDict(),j=this.gtNdByAls(AL_DEF);b=this.gtNdById(c);if(this._fcs)if(d)this.stNdSel(d,1);else{d=this.gtSelNd();if(d)this.stNdSel(d,1);else if(b)this.stNdSel(b,1);else if(j)this.stNdSel(j,1);else this._frst&&this._frst.selDfN();!this.gtSelNd()&&this.stNdSel()}this._notifyShareCalendarMenu();this.feOnAfRld();this.fireOnResize()};Owa.UIControls.NavigationTree.prototype.feOnAfRld=function Owa$UIControls$NavigationTree$feOnAfRld(){if(this.onAfRld)return this.onAfRld()};Owa.UIControls.NavigationTree.prototype.feOnOpnCal=function Owa$UIControls$NavigationTree$feOnOpnCal(a){if(this.onOpnCal)this.onOpnCal(a)};Owa.UIControls.NavigationTree.prototype.rmv=function Owa$UIControls$NavigationTree$rmv(c,a,b){this._fDontSyncSelection=1;var d=new BtnDlg("divDlt",htmlEnc(a),b,[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this.cbRmv,c));d.show()};Owa.UIControls.NavigationTree.prototype.cbRmv=function Owa$UIControls$NavigationTree$cbRmv(b,a){b==0&&g_oNvNdMgr.rmv(this,a.gtNId(),this.gtGS());this.syncSelNHl()};Owa.UIControls.NavigationTree.prototype.upDn=function Owa$UIControls$NavigationTree$upDn(a,b){var c=b?this.gtNdPrv(a):this.gtNdNxt(a);this.mv(a,c,!b)};Owa.UIControls.NavigationTree.prototype.mv=function Owa$UIControls$NavigationTree$mv(b,c,d){var a=new oeReq("NavigationNode","Move",null,this._createCallback(this.cbMv),POST);a.add("srcNId",b.gtNId());a.add("tgtid",c.gtNId());b.constructor==c.constructor&&a.add("mt",d?2:1);a.add("GS",this.gtGS());a.send()};Owa.UIControls.NavigationTree.prototype.cbMv=function Owa$UIControls$NavigationTree$cbMv(a){this.rldFrmR(a);this.cbOeh(a)};Owa.UIControls.NavigationTree.prototype.crtNw=function Owa$UIControls$NavigationTree$crtNw(a){this.crtNwNd(a,{isGp:0})};Owa.UIControls.NavigationTree.prototype.crtNwGp=function Owa$UIControls$NavigationTree$crtNwGp(b){var a;if(b)a=this.gtNdNxt(b);this.crtNwNd(this.gtNdRt(),{isGp:1,posId:a?a.gtId():null},1,a)};Owa.UIControls.NavigationTree.prototype.gtNwNdIcnMrkup=function Owa$UIControls$NavigationTree$gtNwNdIcnMrkup(b,a){if(!a.isGp)switch(this.gtGS()){case GS_CAL:return Owa.Components.CssSprites.getImageMarkup(g_rgsFIcns[T_CAL],'id="'+NODE_ICON+'"');case GS_CNT:return Owa.Components.CssSprites.getImageMarkup(g_rgsFIcns[T_CON],'id="'+NODE_ICON+'"');case GS_TSK:return Owa.Components.CssSprites.getImageMarkup(g_rgsFIcns[T_TSK],'id="'+NODE_ICON+'"')}};Owa.UIControls.NavigationTree.prototype.onNwNd=function Owa$UIControls$NavigationTree$onNwNd(c,a){if(c!=ECR_ESC)if(this._edt.oCtx.isGp)g_oNvNdMgr.nw(this,this.gtGS(),null,a,{posId:this._edt.oCtx.posId});else{var b=this.gtNdPrnt(this._edt.nd);g_oNvNdMgr.nw(this,this.gtGS(),b.gtNId(),a)}else this.qtEdtNd()};Owa.UIControls.NavigationTree.prototype.cbOnNwNv=function Owa$UIControls$NavigationTree$cbOnNwNv(b,f,g,e){if(f!=this)return;if(!this.cbOeh(b,true))return;if(b.isErr())return;var c=e?this.gtNdById(padF(e)):this.gtNdRt(),d=b.oCtx?this.gtNdById(b.oCtx.posId):null;if(c){var a=this.root.get_OwnerDocument().createElement(DIV);a.set_InnerHtml(b.sBody);a=a.getDescendantById("ntn");if(d)this.insrtKdsPos(d,a.getChildrenSnapshot());else this.addKds(c,a.getChildrenSnapshot());c.expand()}this._notifyShareCalendarMenu();this.crtNFDict()};Owa.UIControls.NavigationTree.prototype.rnm=function Owa$UIControls$NavigationTree$rnm(a){this.edtNd(a,{isGp:0})};Owa.UIControls.NavigationTree.prototype.rnmGp=function Owa$UIControls$NavigationTree$rnmGp(a){this.edtNd(a,{isGp:1})};Owa.UIControls.NavigationTree.prototype.onRnNd=function Owa$UIControls$NavigationTree$onRnNd(d,c){var b=this._edt.nd;if(d!=ECR_ESC)if(this._edt.oCtx.isGp)g_oNvNdMgr.rnm(this,this.gtGS(),b.gtNId(),c);else{var a=b.gtFId();if(this.gtGS()==GS_FVR&&(g_oFldrMgr.isMyFId(a)||g_oFldrMgr.gtFL(a)==FL_AMB))g_oFldrMgr.rnmFld(this,a,c);else g_oNvNdMgr.rnm(this,this.gtGS(),b.gtNId(),c)}else this.qtEdtNd()};Owa.UIControls.NavigationTree.prototype.cbOnRnmNv=function Owa$UIControls$NavigationTree$cbOnRnmNv(c,d,f,e){if(d!=this)return;if(!this.cbOeh(c,true))return;if(c.isErr())return;var a=this.gtNdById(padF(e));if(a){var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(c.sBody);a.stDspNm(b.getDescendantById("ntn").get_TextContent());Owa.Components.FolderTreeNode.isInstance(a)&&a.stFldNm(b.getDescendantById("tn").get_TextContent())}};Owa.UIControls.NavigationTree.prototype._notifyShareCalendarMenu=function Owa$UIControls$NavigationTree$_notifyShareCalendarMenu(){this.gtGS()==GS_CAL&&updateCalendarFolders()}})();g_fModuleLoaded[".\\uicontrols/navigationtree.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/favoritefoldertreenode.js".toLowerCase()]&&(function(){Owa.Components.FavoriteFolderTreeNode=function Owa$Components$FavoriteFolderTreeNode(a,b){Owa.Components.FavoriteFolderTreeNode.constructBase(this,[a,b])};Owa.Components.FavoriteFolderTreeNode.createClass("Owa.Components.FavoriteFolderTreeNode",Owa.Components.NavigationFolderTreeNode);Owa.Components.FavoriteFolderTreeNode.prototype._onBeforeContextMenu=function Owa$Components$FavoriteFolderTreeNode$_onBeforeContextMenu(){var a=getFolderTreeMenu();this._prepareFolderMenu(a);var b=["divRmFvr","divMvUp","divMvDn"];a.showMenuItems(b,true);a.enableMenuItems(b,true);a.showMenuItem("divCF",false);!this._tr.gtNdNxt(this)&&a.enableMenuItem("divMvDn",false);!this._tr.gtNdPrv(this)&&a.enableMenuItem("divMvUp",false);this._tr.set_ContextMenu(a)};Owa.Components.FavoriteFolderTreeNode.prototype.onContextMenuClick=function Owa$Components$FavoriteFolderTreeNode$onContextMenuClick(b){var a=this._tr;switch(b.sCommand){case"removefromfavorite":g_oNvNdMgr.rmv(a,this.gtNId(),a.gtGS());break;case"moveup":case"movedown":a.upDn(this,b.sCommand=="moveup");break;default:return Owa.Components.FavoriteFolderTreeNode.callBase(this,"onContextMenuClick",arguments)}};Owa.Components.FavoriteFolderTreeNode.prototype.drpIn=function Owa$Components$FavoriteFolderTreeNode$drpIn(a,c){var b=a.get_RootElement();switch(a.get_TypeName()){case Owa.Components.DraggableObjects.Type.Folder:if(g_oNvNdMgr.isInFvr(b.get_FolderId()))return;g_oNvNdMgr.addFvr(this._tr,b.get_FolderId(),this.gtNId(),(c&DRP_EFF_MSK)==DRP_ABOVE?0:1);return;default:Owa.Components.FavoriteFolderTreeNode.callBase(this,"drpIn",arguments)}};Owa.Components.FavoriteFolderTreeNode.prototype.delFld=function Owa$Components$FavoriteFolderTreeNode$delFld(b){if(!b){this._tr._fDontSyncSelection=1;var a=L_WrnDlFlInFvr+'<div style="overflow-y:hidden; height: 4px"></div>&nbsp;&nbsp;<input type=radio id=dlFldrInFavRd0 name=cmfDltInFvr checked>&nbsp;<label for=dlFldrInFavRd0>'+L_RdDlt+"</label><br>&nbsp;&nbsp;<input type=radio id=dlFldrInFavRd1 name=cmfDltInFvr>&nbsp;<label for=dlFldrInFavRd1>"+L_RdRmvFrmFvr+"</label>",c=new BtnDlg("divDlt",a,L_WrnDlFlTtl,[L_OK,L_Cncl],null,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this.cbOnDelFldNP));c.show();return}else Owa.Components.FavoriteFolderTreeNode.callBase(this,"delFld",arguments)};Owa.Components.FavoriteFolderTreeNode.prototype.cbOnDelFldNP=function Owa$Components$FavoriteFolderTreeNode$cbOnDelFldNP(a){if(a==0)if(chkd(wtda("dlFldrInFavRd0")))Owa.Components.FavoriteFolderTreeNode.callBase(this,"cbOnDelFld",[0,0,0]);else g_oNvNdMgr.rmv(this._tr,this.gtNId(),this._tr.gtGS());this._tr.syncSelNHl()}})();g_fModuleLoaded[".\\uicontrols/favoritefoldertreenode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/favoritetree.js".toLowerCase()]&&(function(){Owa.UIControls.FavoriteTree=function Owa$UIControls$FavoriteTree(a){Owa.UIControls.FavoriteTree.constructBase(this,[a])};Owa.UIControls.FavoriteTree.createClass("Owa.UIControls.FavoriteTree",Owa.UIControls.NavigationTree);Owa.UIControls.FavoriteTree.prototype.initialize=function Owa$UIControls$FavoriteTree$initialize(){Owa.UIControls.FavoriteTree.callBase(this,"initialize");g_oEd.attachEvent("UpdateCount",this,"cbOnUpdCnt");g_oEd.attachEvent("AddToFavorites",this,"cbAddToFvr");g_oEd.attachEvent("AddFilterToFavorites",this,"cbOnFldrOeh");g_oEd.attachEvent("DeleteFolder",this,"cbOnFldrOeh");g_oEd.attachEvent("RenameFolder",this,"cbOnRnFld");g_oEd.attachEvent("RenameNavigation",this,"cbOnRnFltr");g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbOperationsStarted");g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbOperationsComplete")};Owa.UIControls.FavoriteTree.prototype.dispose=function Owa$UIControls$FavoriteTree$dispose(){g_oEd.detachEvent("UpdateCount",this,"cbOnUpdCnt");g_oEd.detachEvent("AddToFavorites",this,"cbAddToFvr");g_oEd.detachEvent("DeleteFolder",this,"cbOnFldrOeh");g_oEd.detachEvent("RenameFolder",this,"cbOnRnFld");g_oEd.detachEvent("RenameNavigation",this,"cbOnRnFltr");g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbOperationsStarted");g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbOperationsComplete");Owa.UIControls.FavoriteTree.callBase(this,"dispose")};Owa.UIControls.FavoriteTree.prototype.wrapNd=function Owa$UIControls$FavoriteTree$wrapNd(a){switch(a.getAttribute("_t")){case TN_FTN:return new Owa.Components.FavoriteFolderTreeNode(a,this);default:return Owa.UIControls.FavoriteTree.callBase(this,"wrapNd",arguments)}};Owa.UIControls.FavoriteTree.prototype.onKD=function Owa$UIControls$FavoriteTree$onKD(b){switch(b.get_KeyCodeForKeyUpDown()){case 46:var a=this.gtSelNd();a&&a.canDel()&&a.delFld(b.isShiftKeyDown(),0)}};Owa.UIControls.FavoriteTree.prototype.onRnNd=function Owa$UIControls$FavoriteTree$onRnNd(b,c){var a=this._edt.nd;if(b!=ECR_ESC&&a._get_Element().getAttribute("_fltr")){g_oNvNdMgr.rnm(this,this.gtGS(),a.gtNId(),c);return}Owa.UIControls.FavoriteTree.callBase(this,"onRnNd",[b,c])};Owa.UIControls.FavoriteTree.prototype.cbOnRnFltr=function Owa$UIControls$FavoriteTree$cbOnRnFltr(a,e,g,f){var d=e==this;if(d&&!this.cbOeh(a,true))return;if(a.isErr())return;var b=this.gtNdById(padF(f));if(b){var c=this.root.get_OwnerDocument().createElement(DIV);c.set_InnerHtml(a.sBody);b.stDspNm(c.getDescendantById("ntn").get_TextContent())}};Owa.UIControls.FavoriteTree.prototype.cbOnRnFld=function Owa$UIControls$FavoriteTree$cbOnRnFld(c,e,f){var d=e==this;if(d&&!this.cbOeh(c,true))return;if(c.isErr())return;var a=this.gtNdByFId(f);if(a){var b=this.root.get_OwnerDocument().createElement(DIV);b.set_InnerHtml(c.sBody);a.stDspNm(b.getDescendantById("ntn").get_TextContent());Owa.Components.FolderTreeNode.isInstance(a)&&a.stFldNm(b.getDescendantById("tn").get_TextContent())}};Owa.UIControls.FavoriteTree.prototype.cbOnUpdCnt=function Owa$UIControls$FavoriteTree$cbOnUpdCnt(b,c,d){var a=this.gtNdByFId(b);if(!a)return;a.updCnts(c,d)};Owa.UIControls.FavoriteTree.prototype.gtSelELCNdFId=function Owa$UIControls$FavoriteTree$gtSelELCNdFId(){var a=this.gtSelNd();return a?a._get_Element().getAttribute("_sPlcyFId"):0};Owa.UIControls.FavoriteTree.prototype.cbAddToFvr=function Owa$UIControls$FavoriteTree$cbAddToFvr(a){this.rldFrmR(a);this.cbOeh(a)}})();g_fModuleLoaded[".\\uicontrols/favoritetree.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/buddylisttreenode.js".toLowerCase()]&&(function(){Owa.Components.BuddyListTreeNode=function Owa$Components$BuddyListTreeNode(a,b){Owa.Components.BuddyListTreeNode.constructBase(this,[a,b])};Owa.Components.BuddyListTreeNode.createClass("Owa.Components.BuddyListTreeNode",Owa.Components.TreeNode);Owa.Components.BuddyListTreeNode.prototype.persistExp=function Owa$Components$BuddyListTreeNode$persistExp(){if(this.isRt())g_oFldrMgr.prstTrExpSt();else{var f=gtIMMgr().bdyLst,e=f.GetGroups(),b=[],a;for(var c in e){a=g_oBddyLst.gtNdById(c);a&&a.isExp()&&b.push(c)}var d={};d.rgGrpIds=b;sndIMReq(IM_PSTEXP,null,0,d)}};Owa.Components.BuddyListTreeNode.prototype.canDrg=function Owa$Components$BuddyListTreeNode$canDrg(){return this._get_Element().getAttribute("sUri")?true:false};Owa.Components.BuddyListTreeNode.prototype.canDrpExp=function Owa$Components$BuddyListTreeNode$canDrpExp(){return false};Owa.Components.BuddyListTreeNode.prototype.onDrg=function Owa$Components$BuddyListTreeNode$onDrg(d){var c=new Owa.Components.Storage.DragDrop(d),a=Owa.Components.Storage.StorableObject.create(Owa.Components.DraggableObjects.Type.Buddy),b=a.get_RootElement();b.set_GroupId(this._get_Element().getAttribute("sGroupId"));b.set_BuddyId(this._get_Element().getAttribute("sUri"));a.save(c)};Owa.Components.BuddyListTreeNode.prototype.gtDrpMd=function Owa$Components$BuddyListTreeNode$gtDrpMd(g,e,b){var f=b.get_TypeName();if(f!=Owa.Components.DraggableObjects.Type.Buddy)return DRP_NONE;var d=gtIMMgr().bdyLst,a=d.GetGroup(this.get_Id());if(a&&!a.IsOtherContactsGroup()){var c=b.get_RootElement();return a.IsMember(c.get_BuddyId())?DRP_NONE:e.isCtrlKeyDown()&&!a.IsOtherContactsGroup()?DRP_COPY:DRP_MOVE}return DRP_NONE};Owa.Components.BuddyListTreeNode.prototype.drpIn=function Owa$Components$BuddyListTreeNode$drpIn(e,f){var a=this.get_Id(),c=e.get_RootElement(),b=c.get_BuddyId(),d=c.get_GroupId();switch(f){case DRP_COPY:copyToGroupRequest(b,a);break;case DRP_MOVE:if(isOCSPrv()&&d==gtIMMgr().bdyLst.sOtherContactsID)copyToGroupRequest(b,a);else moveToGroupRequest(b,d,a)}};Owa.Components.BuddyListTreeNode.prototype._onBeforeContextMenu=function Owa$Components$BuddyListTreeNode$_onBeforeContextMenu(){if(g_iIM_SI)return true;if(this.isRt()){this._prepContextMenu();return}var a=gtIMMgr().bdyLst,e=this._get_Element().getAttribute("sUri"),b=a.GetGroup(this.get_Id()),c=a.GtBdy(e);if(b){this._prepContextMenu(b);return}else if(c){var d=a.GetGroup(this._get_Element().getAttribute("sGroupId"));this._prepContextMenu(b,c,d);return}return true};Owa.Components.BuddyListTreeNode.prototype._prepContextMenu=function Owa$Components$BuddyListTreeNode$_prepContextMenu(f,h,k){var c="",i=false,b=false,d=false,e=false,g=isMSNPrv();if(f){c=f.groupName;b=true;e=f.IsOtherContactsGroup()||f.IsFavoritesGroup()}else if(h){c=h.dn;i=k.IsOtherContactsGroup();d=gtIMMgr().IsBlkd(h.uri)}else{c=this.gtDspNm();b=true;e=true}var a=this._tr.get_ContextMenu(),j=a._get_Element().getDescendantById("spnHdr");j.set_TextContent(c);j.set_Title(c);a.enableMenuItem("divBtmChat",!b);a.enableMenuItem("divBtmRmvBase",!b);a.showMenuItem("divBtmBlock",g&&(b||!d));a.enableMenuItem("divBtmBlock",!b&&!d);a.showMenuItem("divBtmUnblock",g&&!b&&d);a.enableMenuItem("divBtmUnblock",!b&&d);a.showMenuItem("divBtmRmvGroup",!b&&!i);a.enableMenuItem("divBtmRenameGroup",b&&!e);a.enableMenuItem("divBtmRemoveGroup",b&&!e);a.showMenuItem("divBtmNewContact",g);a.showMenuItem("divBtmNewOcsContact",!g)};Owa.Components.BuddyListTreeNode.prototype.onContextMenuClick=function Owa$Controls$BuddyListTreeNode$prototype$onContextMenuClick(a){switch(a.sCommand){case"chat":nwChtFrmRcp(this._getRecipientSpan());break;case"block":blkBdyReq(this._getRecipientSpan());break;case"unblock":blkBdyReq(this._getRecipientSpan(),1);break;case"removeFromGroup":rmFrmGrpReq(this._tr.get_SubPage(),this._getRecipientSpan());break;case"removeFromList":rmBdyLstReq(this._tr.get_SubPage(),this._getRecipientSpan());break;case"renameGroup":this._tr.get_ContextMenu().close();this._tr.newGroup(this,0);break;case"removeGroup":removeGroupRequest(this.get_Id());break;case"newGroup":this._tr.get_ContextMenu().close();this._tr.newGroup(this,1);break;case"newContact":this._tr.get_ContextMenu().close();this._tr.addBddyRequest();break;case"newOcsContact":this._tr.get_ContextMenu().close();this._tr.addBddyFrmAb(this._getGroupId())}};Owa.Components.BuddyListTreeNode.prototype._getGroupId=function Owa$Controls$BuddyListTreeNode$prototype$_getGroupId(){if(this.isRt())return null;var a=this._get_Element().getAttribute("sGroupId");if(!a)a=this.get_Id();return a};Owa.Components.BuddyListTreeNode.prototype._getRecipientSpan=function Owa$Controls$BuddyListTreeNode$prototype$_getRecipientSpan(){return this._get_Element().get_FirstChild().get_FirstChild().get_FirstChild()._get_DomNode()}})();g_fModuleLoaded[".\\uicontrols/buddylisttreenode.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/buddylisttree.js".toLowerCase()]&&(function(){var a="addBddy",b="bddyRt",d="grpLB",c="divIB",n="LegacyUser",f="divRmtSgnOut",i="divSgnOutTME",h="divSgnOutNTW",e="divCfgIss",g="divSgnOutMNL",j="divMsnTOU",k="divMigtInProg",l="divPrivChng",m=4,o="60";Owa.UIControls.BuddyListTree=function Owa$UIControls$BuddyListTree(a){Owa.UIControls.BuddyListTree.constructBase(this,[a]);this.fRendering=0};Owa.UIControls.BuddyListTree.createClass("Owa.UIControls.BuddyListTree",Owa.UIControls.TreeControl);Owa.UIControls.BuddyListTree.prototype.initialize=function Owa$UIControls$BuddyListTree$initialize(){Owa.UIControls.BuddyListTree.callBase(this,"initialize");this._cbOnDblClk=this._attachEvent(this.root,"dblclick",this.onDblClk);this.startRendering()};Owa.UIControls.BuddyListTree.prototype.dispose=function Owa$UIControls$BuddyListTree$dispose(){if(!this._disped){this.onDblClk&&this._detachEvent(this.root,"dblclick",this.onDblClk);this._oContextMenu&&this._oContextMenu.dispose();Owa.UIControls.BuddyListTree.callBase(this,"dispose")}};Owa.UIControls.BuddyListTree.prototype.wrapNd=function Owa$UIControls$BuddyListTree$wrapNd(a){return new Owa.Components.BuddyListTreeNode(a,this)};Owa.UIControls.BuddyListTree.prototype._onClk=function Owa$UIControls$BuddyListTree$_onClk(b){var c=this.gtNd(b.get_Target());if(!c)return;if(c.gtId()==a){var d=gtIMType();if(d==IM_TYPE_OCS)this.addBddyFrmAb();else d==IM_TYPE_MSN&&this.addBddyRequest();b.preventDefault();b.cancelBubble();return}else if(this.shdCanEvt(c.gtId())){b.preventDefault();b.cancelBubble();return}Owa.UIControls.BuddyListTree.callBase(this,"_onClk",[b,1])};Owa.UIControls.BuddyListTree.prototype.addBddyRequest=function Owa$UIControls$BuddyListTree$addBddyRequest(){var a={};a.sTgt=TO;a.sTo="";shwMdlDlg("AddContact",400,250,a)};Owa.UIControls.BuddyListTree.prototype.addBddyFrmAb=function Owa$UIControls$BuddyListTree$addBddyFrmAb(c){var a={};a.sTgt=TO;a.sTo="";a.fResolve=1;var b=this,d=function(){var f=getEm(DIV,god(b.root._get_DomNode()));f.innerHTML=a.sTo;var d=f.getElementsByTagName("span").spnR;if(!isDf(typeof d))return;if(!d.length)addBdyLstReq(b.get_SubPage(),d,null,null,c);else for(var e=0;e<d.length;e++)addBdyLstReq(b.get_SubPage(),d[e],null,null,c)};shwABDlg(a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,a,"&a=PickBuddy",d)};Owa.UIControls.BuddyListTree.prototype.onDblClk=function Owa$UIControls$BuddyListTree$onDblClk(e){var b=this.gtNd(e.get_Target());if(!b||b.hsChld())return;var c=b.gtId();if(c==a||c==d||c==FKID||b._get_Element().get_FirstChild().get_Id()=="dvInf")return;if(this.shdCanEvt(c)){canEvt(e);return}var f=b._get_Element().get_FirstChild().get_FirstChild().get_FirstChild(),g=gtIMMgr().LdExstChtSsn(f.getAttribute("_uri"));if(g)return;nwChtFrmRcp(f._get_DomNode())};Owa.UIControls.BuddyListTree.prototype.OthrCnctGrpExists=function Owa$UIControls$BuddyListTree$OthrCnctGrpExists(){var a=this.gtNdById(gtIMMgr().bdyLst.sOtherContactsID);return a?1:0};Owa.UIControls.BuddyListTree.prototype._addGrpToTr=function Owa$UIControls$BuddyListTree$_addGrpToTr(e,c,j,h){var g=gtIMMgr().bdyLst,b=this.gtNdById(g.sOtherContactsID);if(!b)b=this.gtNdById(a);var f=this.createNewNode(c,b,1,0,{nosel:1,exp:h,padding:m});f.stDspNm(e);var i=this.createNewNode(d,f,0,0,{nosel:1,exp:0,padding:m,contentClassName:"noCnts"});i.stDspNm(L_GrpLbl);if(this._edting&&this._edt.oCtx)e.trim()==this._edt.oCtx.originalValue&&this.qtEdtNd();gtIMMgr().bdyLst.GetGroup(c).SetGroupRenderingStatus(true)};Owa.UIControls.BuddyListTree.prototype.renameGroup=function Owa$UIControls$BuddyListTree$renameGroup(c,a){var b=this.gtNdById(c);if(b){b.stDspNm(a);if(this._edting&&this._edt.oCtx)a.trim()==this._edt.oCtx.originalValue&&this.qtEdtNd()}};Owa.UIControls.BuddyListTree.prototype.newGroup=function Owa$UIControls$BuddyListTree$newGroup(e,f){var d={};if(!f)this.edtNd(e,d);else{var c=gtIMMgr().bdyLst;this.crtNwNd(this.gtNdById(b),d,0,c.sOtherContactsID!=null?this.gtNdById(c.sOtherContactsID):this.gtNdById(a))}};Owa.UIControls.BuddyListTree.prototype.onNwNd=function Owa$UIControls$BuddyListTree$onNwNd(c,a){if(c!=ECR_ESC){var b=Owa.IM.BdyGrp.ValidateGroupName(a,true);if(b){this.shwErr(b,true);this.reEdtNd()}else{this._edt.oCtx.originalValue=a.trim();createGroupRequest(a)}}else this.qtEdtNd()};Owa.UIControls.BuddyListTree.prototype.onRnNd=function Owa$UIControls$BuddyListTree$onRnNd(e,a){var d=this._edt.nd;if(e!=ECR_ESC){if(d._get_Element().get_TextContent()==a.trim()){this.qtEdtNd();return}var c=Owa.IM.BdyGrp.ValidateGroupName(a,false);if(c){this.shwErr(c,true);this.reEdtNd()}else{var b=gtIMMgr();if(b){this._edt.oCtx.originalValue=a.trim();renameGroupRequest(b.bdyLst.GetGroup(d.get_Id()),a)}}}else this.qtEdtNd()};Owa.UIControls.BuddyListTree.prototype.gtNwNdIcnMrkup=function Owa$UIControls$BuddyListTree$gtNwNdIcnMrkup(){return null};Owa.UIControls.BuddyListTree.prototype.getMaxInputLength=function Owa$UIControls$BuddyListTree$getMaxInputLength(){return o};Owa.UIControls.BuddyListTree.prototype.removeGroup=function Owa$UIControls$BuddyListTree$removeGroup(b){var a=this.gtNdById(b);a&&this.rmNd(a)};Owa.UIControls.BuddyListTree.prototype.renderAddBddyLnk=function Owa$UIControls$BuddyListTree$renderAddBddyLnk(){var c=this.createNewNode(a,this.gtNdById(b),0,0,{nosel:1,contentClassName:"bddyLk"});c.stDspNm(L_AddBddsElps);c.gtHl().set_Padding(Owa.Style.Side.Top,4)};Owa.UIControls.BuddyListTree.prototype.startRendering=function Owa$UIControls$BuddyListTree$startRendering(){!this.fRendering&&!g_fSigningIn&&gtIMMgr().fReceivedBuddyList&&!this.gtNdById(a)&&this.renderAddBddyLnk();this.fRendering=1;window.setTimeout(function(){g_oBddyLst&&g_oBddyLst._render()},0)};Owa.UIControls.BuddyListTree.prototype._render=function Owa$UIControls$BuddyListTree$_render(){var e=gtIMMgr();if(e){var f,a,g,b,c,h,j=(new Date).getTime(),d=e.bdyLst,i=d.GetGroups();for(f in i){a=d.GetGroup(f);if(a){!a.GetGroupRenderingStatus()&&this._addGrpToTr(a.groupName,a.groupID,a.groupFlags,a.groupExpand);g=a.GetMembers();for(b in g)if(a.IsMember(b)&&!a.GetBuddyRenderingStatus(b)){c=d.GtBdy(b);if(c){h=e.gtPrsnc(b);this._addBddyToGrp(c.dn,b,f,h,c.iType);if((new Date).getTime()-j>125){this.startRendering();return}}}}}}!g_fSigningIn&&gtIMMgr().fReceivedBuddyList&&this.shwPrgInd(1);this.fRendering=0};Owa.UIControls.BuddyListTree.prototype.hdChldNodes=function Owa$UIControls$BuddyListTree$hdChldNodes(){var c=this.gtNdRt().gtCC();if(c)for(var b=c.getChildrenSnapshot(),a=0;a<b.length;a++)b[a].set_IsShown(false)};Owa.UIControls.BuddyListTree.prototype._addBddyToGrp=function Owa$UIControls$BuddyListTree$_addBddyToGrp(k,b,a,l,m){var f=this.gtNdById(a);if(f==null)return;var j=this.gtChdNdById(f,d);if(j){var i=j.getContainer();i.get_IsShown()&&i.set_IsShown(false)}var g=f.gtCC()._get_DomNode().childNodes,c=this._findInsertPosition(g,k,1,g.length-1),e=this.createNewNode(a+Owa.IM.IMUtils.CleanUri(b),c==null?this.gtNdById(a):c,c==null?0:1,0,{nosel:1});e._get_Element().setAttribute("sGroupId",a);e._get_Element().setAttribute("sUri",b);var h=createOwaRcpSpan(k,Owa.IM.IMUtils.NrmSipUri(b),RT_SMTP,"",AO_O,0,"",0,b,"",1,1,1,a,m);renderJB(h.get_FirstChild(),0,1,l);e.getContent().appendChild(h);gtIMMgr().bdyLst.GetGroup(a).SetBuddyRenderingStatus(b,true)};Owa.UIControls.BuddyListTree.prototype.rmvBddyFrmGrp=function Owa$UIControls$BuddyListTree$rmvBddyFrmGrp(a,c){var f=this.gtNdById(a+Owa.IM.IMUtils.CleanUri(c));f&&this.rmNd(f);var b=gtIMMgr().bdyLst.GetGroup(a);if(b.GtLen()==0){var e=this.gtChdNdById(this.gtNdById(a),d);if(e){var g=e.getContainer();g.set_IsShown(true)}}b.SetBuddyRenderingStatus(c,false)};Owa.UIControls.BuddyListTree.prototype.updateGrpPrsc=function Owa$UIControls$BuddyListTree$updateGrpPrsc(f,b,k,h){var a=this.gtNdById(f+Owa.IM.IMUtils.CleanUri(k));if(a){if(isDf(typeof h)){var j=a._get_Element().getDescendantsByTagName("img")[0];j&&setJBPrsnc(j,h)}var g=a._get_Element().getDescendantById("bdyNm");if(b&&b!=""&&b!=g.get_TextContent()){var d=this.gtNdById(f);if(d){var e=d.gtCC()._get_DomNode().childNodes,c=this._findInsertPosition(e,b,1,e.length-1);if(c!=a)if(c==null)this.addKds(d,[a.getContainer()]);else this.insrtKdsPos(c,[a.getContainer()],0,0)}g.set_TextContent(b);var i=a._get_Element().get_FirstChild().get_FirstChild().get_FirstChild();i.setAttribute("_dn",b);i.setAttribute("title",b+"\n"+imns.IMUtils.NrmSipUri(k))}}};Owa.UIControls.BuddyListTree.prototype.shwIMUnavl=function Owa$UIControls$BuddyListTree$shwIMUnavl(b){var a=c,d=isDf(typeof b)?b:0;switch(d){case IM_FAIL_SESSION_SIGN_OUT:a=f;break;case IM_FAIL_CLIENT_SIGN_OUT:a=g;break;case IM_FAIL_CLIENT_LIMIT:a=i;break;case IM_FAIL_MSN_TERMS_OF_USE_NOT_SIGNED:a=j;this.gtNdRt().collapse();break;case IM_FAIL_ADDRESS_NOT_AVAILABLE:case IM_FAIL_EXTERNAL_AUTHENTICATION_DISABLED:case IM_FAIL_EXTERNAL_IDENTITY_UNKNOWN:case IM_FAIL_CREATE_ENDPOINT:a=e;break;case IM_FAIL_SERVER_TIMEOUT:a=h;break;case IM_FAIL_MIGRATION_IN_PROGRESS:a=k;break;case IM_FAIL_MIGRATION_NEEDED:case IM_FAIL_POLICY_CHANGED:a=l}this.shwNdById(a)};Owa.UIControls.BuddyListTree.prototype.shwIMUnsupported=function Owa$UIControls$BuddyListTree$shwIMUnsupported(){this.shwNdById(c,1)};Owa.UIControls.BuddyListTree.prototype.shwPrgInd=function Owa$UIControls$BuddyListTree$shwPrgInd(d){if(!d){!this.gtNdById(a)&&this.renderAddBddyLnk();this.hdChldNodes();var c=this.gtNdRt().gtCC();if(c){c.set_IsShown(false);this.fireOnResize()}this.gtNdById(b).shwPrg(0)}else{if(this.gtNdRt().isExp()){var c=this.gtNdRt().gtCC();if(c){c.set_IsShown(true);this.fireOnResize()}}this.gtNdById(b).hdPrg()}};Owa.UIControls.BuddyListTree.prototype.shwNdById=function Owa$UIControls$BuddyListTree$shwNdById(c,b){this.hdChldNodes();this.shwPrgInd(1);var a=this.gtNdById(c);if(!a)if(isDf(typeof b)&&b)this.createInfoNode(n);else this.createInfoNode(c);else a.getContainer().set_IsShown(true)};Owa.UIControls.BuddyListTree.prototype.shwAddBddyLnk=function Owa$UIControls$BuddyListTree$shwAddBddyLnk(){var b=this.gtNdById(a);if(!b){this.renderAddBddyLnk();b=this.gtNdById(a)}!b.getContainer().get_IsShown()&&b.getContainer().set_IsShown(true)};Owa.UIControls.BuddyListTree.prototype.insertInfoNode=function Owa$UIControls$BuddyListTree$insertInfoNode(c,b,a){return this.createNewNode(c,b,0,0,{nosel:1,contentHTML:a,highlightClassName:"bddyInfoNdHl",bodyClassName:"bddyInfoNd"})};Owa.UIControls.BuddyListTree.prototype.createInfoNode=function Owa$UIControls$BuddyListTree$createInfoNode(m){var a;switch(m){case c:a='<DIV id="dvInf" class="errBx">'+L_IMNtAvl+"</div>";break;case n:a='<DIV id="dvInf" class="errBx">'+L_IMLegacyUser+"</div>";break;case f:a='<div id="dvInf" class="errBx">'+L_ErrRmtSo+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clkSgnIn()">'+L_sgnInAgn+"</span></div>";break;case i:a='<div id="dvInf" class="errBx">'+L_ErrManyEndpoints+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clkSgnIn()">'+L_sgnInAgn+"</span></div>";break;case g:a='<div id="dvInf" class="errBx">'+L_SignedOutOfIM+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clkSgnIn(1)">'+L_SignIn+"</span></div>";break;case j:a='<div id="dvInf" class="errBx">'+L_ErrorTermsOfUseNotSigned+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clickTOU()">'+L_ErrorTermsOfUseLink+"</span></div>";break;case e:a='<DIV id="dvInf" class="errBx">'+L_IMInvConf+"</div>";break;case h:a='<div id="dvInf" class="errBx">'+L_IMNetPblm+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clkSgnIn()">'+L_sgnInAgn+"</span></div>";break;case k:a='<div id="dvInf" class="errBx">'+L_IMPrivacyMigrationInProgress+'&nbsp;<span id=spnSgnInAgn onclick="g_oBddyLst.clkSgnIn()">'+L_sgnInAgn+"</span></div>";break;case l:a='<div id="dvInf" class="errBx">'+L_IMPrivacyMigrationNeeded+'&nbsp;<span id=spnLearnMore onclick="g_oBddyLst.clkLearnMore()">'+L_learnMore+"</span></div>"}var d=this.insertInfoNode(m,this.gtNdById(b),a);d._get_Element()._get_DomNode().removeAttribute("href");d._get_Element().set_Right(0);d._get_Element().set_Left(0)};Owa.UIControls.BuddyListTree.prototype.shdCanEvt=function Owa$UIControls$BuddyListTree$shdCanEvt(a){return a==c||a==f||a==i||a==g||a==j||a==h||a==e?true:false};Owa.UIControls.BuddyListTree.prototype.clkSgnIn=function Owa$UIControls$BuddyListTree$clkSgnIn(a){ImSIR(0,1,a,1);this.shwPrgInd()};Owa.UIControls.BuddyListTree.prototype.clkLearnMore=function Owa$UIControls$BuddyListTree$clkLearnMore(){opnWin(a_sIMPrivacyModeTransitionUrl,null,null,null,null,null,null,null,1)};Owa.UIControls.BuddyListTree.prototype._findInsertPosition=function Owa$UIControls$BuddyListTree$_findInsertPosition(d,f,a,b){if(d==null||a>b)return null;while(1)if(a>=b){var c=Owa.Dom.Node.wrapDomNode(d[b]);return c&&c.get_TextContent().localeCompare(f)>0?this.gtNd(c):null}else{var e=Math.floor(a+(b-a)/2),c=Owa.Dom.Node.wrapDomNode(d[e]);if(c&&c.get_TextContent().localeCompare(f)>0)b=e;else a=e+1}};Owa.UIControls.BuddyListTree.prototype.clickTOU=function Owa$UIControls$BuddyListTree$clickTOU(){var c=Owa.Dom.Document.get_Current(),b=Owa.Dom.Document.get_Current().createElement("form");b.setAttribute("method","post");var a=c.createElement("input");a.setAttribute("type","hidden");a.setAttribute("name","InstantMessage_TOU");a.setAttribute("value","1");b.appendChild(a);c.appendChild(b);b._get_DomNode().submit()};Owa.UIControls.TreeControl.prototype.get_ContextMenu=function Owa$UIControls$TreeControl$get_ContextMenu(){if(!this._oContextMenu)this._oContextMenu=Owa.UIControls.ContextMenu.create($("divBtm"),null,getNavigationPage());return this._oContextMenu}})();g_fModuleLoaded[".\\uicontrols/buddylisttree.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/FolderPickerDialog.js".toLowerCase()]&&(function(){var a={Unload:0,Loading:1,Loaded:2,Showing:3};Owa.UIControls.FolderPickerDialog=function Owa$UIControls$FolderPickerDialog(){Owa.UIControls.FolderPickerDialog.constructBase(this);this._sId=g_sFPDId+Owa.UIControls.FolderPickerDialog._iIndex;Owa.UIControls.FolderPickerDialog._iIndex++;this._attachEvent(Owa.Dom.Window.get_Current(),"unload",this._dispose);g_oEd.attachEvent("RenameFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("NewFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("MoveFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("CopyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("DeleteFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("EmptyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("RemoveNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("RenameNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("NewNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("UpdateCount",this,"_cbClearHtmlCacheAfterCountChanged")};Owa.UIControls.FolderPickerDialog.createClass("Owa.UIControls.FolderPickerDialog",Owa.UIControls.UIControl);Owa.UIControls.FolderPickerDialog._iIndex=0;Owa.UIControls.FolderPickerDialog.prototype._iDefaultButtonIndex=0;Owa.UIControls.FolderPickerDialog.prototype._sState=a.Unload;Owa.UIControls.FolderPickerDialog.prototype._iTreeHeight=300;Owa.UIControls.FolderPickerDialog.prototype._iTreeWidth=260;Owa.UIControls.FolderPickerDialog.prototype._fIsShowPublicFolder=true;Owa.UIControls.FolderPickerDialog.prototype._sTitle="";Owa.UIControls.FolderPickerDialog.prototype._fIsShowArchiveFolder=true;Owa.UIControls.FolderPickerDialog.get_Default=function Owa$UIControls$FolderPickerDialog$get_Default(){if(!Owa.Dom.Window.get_Current().equals(Owa.Utility.getIFrameParentOwaWindow())){var a=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable("Owa");return a.UIControls.FolderPickerDialog.get_Default()}if(!this._oDefault)this._oDefault=new Owa.UIControls.FolderPickerDialog;return this._oDefault};Owa.UIControls.FolderPickerDialog.prototype._get_State=function Owa$UIControls$FolderPickerDialog$_get_State(){return this._sState};Owa.UIControls.FolderPickerDialog.prototype._set_State=function Owa$UIControls$FolderPickerDialog$_set_State(a){this._sState=a};Owa.UIControls.FolderPickerDialog.prototype.set_Title=function Owa$UIControls$FolderPickerDialog$set_Title(b){if(this._get_State()==a.Showing)throw new Error("Can't change title when folder picker dialog is showing");this._sTitle=b};Owa.UIControls.FolderPickerDialog.prototype.set_TreeHtml=function Owa$UIControls$FolderPickerDialog$set_TreeHtml(b){if(this._get_State()==a.Showing)throw new Error("Can't change tree html when folder picker dialog is showing");this._sCustomTreeHtml=b};Owa.UIControls.FolderPickerDialog.prototype.set_SourceTreeNode=function Owa$UIControls$FolderPickerDialog$set_SourceTreeNode(b){if(this._get_State()==a.Showing)throw new Error("Can't set the source tree node when folder picker dialog is showing");this._oSourceTreeNode=b};Owa.UIControls.FolderPickerDialog.prototype.get_SourceTreeNode=function Owa$UIControls$FolderPickerDialog$get_SourceTreeNode(){return this._oSourceTreeNode};Owa.UIControls.FolderPickerDialog.prototype.get_Title=function Owa$UIControls$FolderPickerDialog$get_Title(){return this._sTitle};Owa.UIControls.FolderPickerDialog.prototype.set_IsShowPublicFolder=function Owa$UIControls$FolderPickerDialog$set_IsShowPublicFolder(b){if(this._get_State()==a.Showing)throw new Error("Can't change title when folder picker dialog is showing");if(this._fIsShowPublicFolder!=b){this._fIsShowPublicFolder=b;this._set_State(a.Unload)}};Owa.UIControls.FolderPickerDialog.prototype.set_IsShowArchiveFolder=function Owa$UIControls$FolderPickerDialog$set_IsShowPublicFolder(b){if(this._get_State()==a.Showing)throw new Error("Can't change folder display when folder picker dialog is showing");this._fIsShowArchiveFolder=b};Owa.UIControls.FolderPickerDialog.prototype.set_TreeWidth=function Owa$UIControls$FolderPickerDialog$set_TreeWidth(a){this._iTreeWidth=a};Owa.UIControls.FolderPickerDialog.prototype.get_TreeWidth=function Owa$UIControls$FolderPickerDialog$get_TreeWidth(){return this._iTreeWidth};Owa.UIControls.FolderPickerDialog.prototype.set_TreeHeight=function Owa$UIControls$FolderPickerDialog$set_TreeHeight(a){this._iTreeHeight=a};Owa.UIControls.FolderPickerDialog.prototype.get_TreeHeight=function Owa$UIControls$FolderPickerDialog$get_TreeHeight(){return this._iTreeHeight};Owa.UIControls.FolderPickerDialog.prototype.set_ButtonCaptions=function Owa$UIControls$FolderPickerDialog$set_ButtonCaptions(b){if(this._get_State()==a.Showing)throw new Error("Can't change button when folder picker dialog is showing");this._rgButtonCaption=b};Owa.UIControls.FolderPickerDialog.prototype.get_ButtonCaptions=function Owa$UIControls$FolderPickerDialog$get_ButtonCaptions(){return this._rgButtonCaption};Owa.UIControls.FolderPickerDialog.prototype.set_DefaultButtonIndex=function Owa$UIControls$FolderPickerDialog$set_DefaultButtonIndex(a){this._iDefaultButtonIndex=a};Owa.UIControls.FolderPickerDialog.prototype.get_DefaultButtonIndex=function Owa$UIControls$FolderPickerDialog$get_DefaultButtonIndex(){return this._iDefaultButtonIndex};Owa.UIControls.FolderPickerDialog.prototype.getButton=function Owa$UIControls$FolderPickerDialog$getButton(a){return!a?null:this._get_ButtonDialog().getButton(a)};Owa.UIControls.FolderPickerDialog.prototype.get_DefaultButton=function Owa$UIControls$FolderPickerDialog$get_DefaultButton(){return this.getButton(this.get_ButtonCaptions()[this.get_DefaultButtonIndex()])};Owa.UIControls.FolderPickerDialog.prototype.show=function Owa$UIControls$FolderPickerDialog$show(){if(this._get_State()==a.Showing)throw new Error("Dialog already showed");if(this._get_State()==a.Unload){this._load();return}if(this._get_State()==a.Loading)return;this._show()};Owa.UIControls.FolderPickerDialog.prototype._show=function Owa$UIControls$FolderPickerDialog$_show(){this._createButtonDialog();var b=this._get_TreeControl()._get_Element().get_ParentElement(),c=this._get_TreeControl().gtArchiveRootNode();c&&c.getContainer().set_IsShown(this._fIsShowArchiveFolder);this._get_ButtonDialog().show();b.get_ParentElement().get_ParentElement().get_ParentElement().set_Width(this._iTreeWidth);b.get_ParentElement().get_ParentElement().get_ParentElement().set_Height(this._iTreeHeight);this._set_State(a.Showing)};Owa.UIControls.FolderPickerDialog.prototype._load=function Owa$UIControls$FolderPickerDialog$_load(){if(this._sCustomTreeHtml){this._sHtml=this._sCustomTreeHtml;this._set_State(a.Loaded);this._show()}else{var b=new oeReq("Navigation","GetFolderPickerTree",null,this._createCallback(this._cbLoad));b.add("pTr",this._fIsShowPublicFolder?1:0);b.send();this._set_State(a.Loading)}};Owa.UIControls.FolderPickerDialog.prototype._cbLoad=function Owa$UIControls$FolderPickerDialog$_cbLoad(b){if(!cbOeh(b)){this._set_State(a.Unload);return}this._sHtml=b.sBody;this._set_State(a.Loaded);this._show()};Owa.UIControls.FolderPickerDialog.prototype._createButtonDialog=function Owa$UIControls$FolderPickerDialog$_createButtonDialog(){var f=52,c=this.get_ButtonCaptions();c=c.slice();c.unshift(L_CrtNewFldElps);this._oButtonDialog=new BtnDlg(this._sId,this._sHtml,this.get_Title(),c,this._iTreeWidth+f,null,this._createCallback(this._cbOnButtonClick));this._oDialogElement=$(this._sId);var e=this._oDialogElement.getDescendantById("fptree").get_FirstChild(),d=e.get_ParentElement(),b=new Owa.UIControls.FolderTree(e,1);this._oTree&&unmakeTreeScrollArea(this._oTree);this._oTree=b;b.clrSel();d.get_ParentElement().get_ParentElement().get_ParentElement().set_Width(this._iTreeWidth);d.get_ParentElement().get_ParentElement().get_ParentElement().set_Height(this._iTreeHeight);makeTreeScrollArea(b);b.onSelChng=Owa.Utility.createDelegate(this,this._cbOnTreeSelectionChange);b.onAfEdt=Owa.Utility.createDelegate(this,this._cbOnTreeAfterEdit);b.onNwFld=Owa.Utility.createDelegate(this,this._cbOnTreeNewFolder);this._attachEvent(b.root,"dblclick",this._cbOnTreeDoublcClick);this.enableAllDialogButton(false);this._set_State(a.Loaded)};Owa.UIControls.FolderPickerDialog.prototype._dispose=function Owa$UIControls$FolderPickerDialog$_dispose(){var b=this._get_TreeControl();this._get_State()==a.Showing&&this._detachEvent(b.root,"dblclick",this._cbOnTreeDoublcClick);g_oEd.detachEvent("RenameFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("NewFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("MoveFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("CopyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("DeleteFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("EmptyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RemoveFromView",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RemoveNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RenameNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("NewNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("UpdateCount",this,"_cbClearHtmlCacheAfterCountChanged")};Owa.UIControls.FolderPickerDialog.prototype._get_TreeControl=function Owa$UIControls$FolderPickerDialog$_get_TreeControl(){return this._oTree};Owa.UIControls.FolderPickerDialog.prototype._get_ButtonDialog=function Owa$UIControls$FolderPickerDialog$_get_ButtonDialog(){return this._oButtonDialog};Owa.UIControls.FolderPickerDialog.prototype.enableButton=function Owa$UIControls$FolderPickerDialog$enableButton(a,b){this._oButtonDialog.enableButton(a,b)};Owa.UIControls.FolderPickerDialog.prototype.enableAllDialogButton=function Owa$UIControls$FolderPickerDialog$enableAllDialogButton(c){for(var b=this.get_ButtonCaptions(),a=0;a<b.length;a++)this._oButtonDialog.enableButton(b[a],c);this._oButtonDialog.enableButton(L_CrtNewFldElps,c)};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeNewFolder=function Owa$UIControls$FolderPickerDialog$_cbOnTreeNewFolder(a){this._get_TreeControl().selNd(a);this.enableAllDialogButton(true);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbOnButtonClick=function Owa$UIControls$FolderPickerDialog$_cbOnButtonClick(c){var b=false,d=this._get_TreeControl();if(-1==c)d._edting&&d.qtEdtNd();else if(0==c){d.nwFld(d.gtSelNd(),1,null);this.enableAllDialogButton(false);b=true}else b=this._onButtonClick(c-1);if(!b||-1==c){if(this._onBeforeClose())b=true;if(!b||-1==c){this._sHtml=this._oDialogElement.getDescendantById("divFPTrR").get_OuterHtml();this._get_TreeControl().dispose();this._oTree=null;this._set_State(a.Loaded)}}return b};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeDoublcClick=function Owa$UIControls$FolderPickerDialog$_cbOnTreeDoublcClick(){if(!this._get_TreeControl()._edting){var a=this.get_DefaultButton();a&&a.click()}};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeSelectionChange=function Owa$UIControls$FolderPickerDialog$_cbOnTreeSelectionChange(b,a){this.enableAllDialogButton(true);this.enableButton(L_CrtNewFldElps,a?a.canCrt():false);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeAfterEdit=function Owa$UIControls$FolderPickerDialog$_cbOnTreeAfterEdit(){var a=this._get_TreeControl().gtSelNd();this.enableAllDialogButton(true);this.enableButton(L_CrtNewFldElps,a?a.canCrt():false);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbClearHtmlCacheAfterOEH=function Owa$UIControls$FolderPickerDialog$_cbClearHtmlCacheAfterOEH(b){if(b.CheckErrors(true))return;this._get_State()==a.Loaded&&this._set_State(a.Unload)};Owa.UIControls.FolderPickerDialog.prototype._cbClearHtmlCacheAfterCountChanged=function Owa$UIControls$FolderPickerDialog$_cbClearHtmlCacheAfterCountChanged(){this._get_State()==a.Loaded&&this._set_State(a.Unload)};Owa.UIControls.FolderPickerDialog.prototype._onButtonClick=function Owa$UIControls$FolderPickerDialog$_onButtonClick(){if(this.onButtonClick)return this.onButtonClick.apply(this,arguments)};Owa.UIControls.FolderPickerDialog.prototype._onBeforeClose=function Owa$UIControls$FolderPickerDialog$_onBeforeClose(){if(this.onBeforeClose)return this.onBeforeClose.apply(this,arguments)};Owa.UIControls.FolderPickerDialog.prototype._onCheckCustomButtons=function Owa$UIControls$FolderPickerDialog$_onCheckCustomButtons(){if(this.onCheckCustomButtons)return this.onCheckCustomButtons.apply(this,arguments)}})();g_fModuleLoaded[".\\uicontrols/FolderPickerDialog.js".toLowerCase()]=1;function calculateScrollBarOnTreeResize(){var a=getTreeRegion(this);Owa.DomUtility.calculateVerticalScrollBar(a)}function errorInfobarSizeChangedInTree(){var a=$(this._sErrNm),d=a.getAncestorById("divInfobar"),b=0;if(d)b=d.get_OffsetHeight();else if(a)b=a.get_OffsetHeight();var c=getTreeRegion(this);if(!a||!a.get_IsShown())b=0;c.set_Top(b);Owa.DomUtility.calculateVerticalScrollBar(c)}function getTreeRegion(a){return a.root.get_ParentElement().get_ParentElement().get_ParentElement()}function makeTreeScrollArea(b){var a=getTreeRegion(b),c=Owa.Utility.createContextDelegate(a,Owa.DomUtility.calculateVerticalScrollBar,a);Owa.Dom.Window.get_Current().attachEvent("resize",c);b.onResize=calculateScrollBarOnTreeResize;b.onErrorInfobarChanged=errorInfobarSizeChangedInTree;Owa.DomUtility.calculateVerticalScrollBar(a)}function unmakeTreeScrollArea(a){var b=getTreeRegion(a),c=Owa.Utility.createContextDelegate(b,Owa.DomUtility.calculateVerticalScrollBar,b);Owa.Dom.Window.get_Current().detachEvent("resize",c);a.onResize=null;a.onErrorInfobarChanged=null}g_oEd.attachEvent("RenameFolder",null,"cbFolderChanged");g_oEd.attachEvent("NewFolder",null,"cbNavigationNodeChanged");g_oEd.attachEvent("MoveFolder",null,"cbNavigationNodeChanged");g_oEd.attachEvent("CopyFolder",null,"cbNavigationNodeChanged");g_oEd.attachEvent("UpdateCount",null,"cbFolderUpdateCount");g_oEd.attachEvent("DeleteFolder",null,"cbFolderChanged");g_oEd.attachEvent("EmptyFolder",null,"cbFolderChanged");g_oEd.attachEvent("RemoveFromView",null,"cbFolderChanged");g_oEd.attachEvent("RemoveNavigation",null,"cbFolderChanged");g_oEd.attachEvent("RenameNavigation",null,"cbNavigationNodeChanged");g_oEd.attachEvent("NewNavigation",null,"cbNavigationNodeChanged");function cbFolderChanged(a){if(a.CheckErrors(true))return;updCMM();cchFpdTrH(0,null);cchFpdTrH(1,null)}function cbNavigationNodeChanged(a){if(a.isErr())return;cchFpdTrH(0,null);cchFpdTrH(1,null)}function cbFolderUpdateCount(){cchFpdTrH(0,null);cchFpdTrH(1,null)}function shwFPDlg(a,d,e){if(!isDf(typeof a.fP))a.fP=1;if(!isDf(typeof a.iHTr))a.iHTr=300;if(shwFPDlg.fLd)return;var b={};b.oArg=a;b.cbOnClickButton=d;b.oFpdCtx=e;var c=new oeReq("Navigation","GetFolderPickerTree",b,cbDownloadFolderPickerTree);c.add("pTr",a.fP);c.send();shwFPDlg.fLd=1}shwFPDlg.fLd=0;function cbDownloadFolderPickerTree(b){shwFPDlg.fLd=0;if(!cbOeh(b))return;var a=b.oCtx,a=new FolderPickerDialog(b.sBody,a.oArg,a.cbOnClickButton,a.oFpdCtx);a.show()}if(!isDf(typeof wt()._rgFpdTrH))wt()._rgFpdTrH=[];function cchFpdTrH(a,b){wt()._rgFpdTrH[a?0:1]=b}var g_sFPDId="divFPD";function FolderPickerDialog(i,b,h,j){var g=260,f=40,k=[L_CrtNewFldElps,b.sBtn],c={};c.idxNewBtn=0;c.onClickButton=h;c.oFpdCtx=j;var a=new BtnDlg(g_sFPDId,i,b.sTtl,k,g+f,null,fpdOnCls,null,0,0,null,null,c);a.sBtn=b.sBtn;a.fP=b.fP;a.iMgn=f;a.gtTr=fpdGtTr;a.fnBDShow=a.show;a.show=fpdShw;a.fnOnBfCls=b.cbOnBfCls;var d=a.gtTr(),e=d.parentNode;a.tree=new Owa.UIControls.FolderTree(Owa.Dom.Node.wrapDomNode(d),1);e.parentNode.parentNode.parentNode.style.height=b.iHTr+"px";e.parentNode.parentNode.parentNode.style.width=g+"px";makeTreeScrollArea(a.tree);a.tree.onSelChng=fpdTrOnSelNd;a.tree.onAfEdt=fpdTrOnAfEdt;a.tree.onNwFld=fpdSelNwFld;a.tree.onBfEdt=fpdTrOnBfEdt;d.ondblclick=fpdTrOnDblClk;enbFpdBtns(0);b.cbOnCrt&&b.cbOnCrt(a);return a}function fpdSelNwFld(a){this.selNd(a)}function fpdOnCls(e,d){var b,c=getFpd(),a=c.tree;if(-1==e)b=a._edting;else if(!a.hsSelNd())b=1;else if(d.idxNewBtn==e){a.nwFld(a.gtSelNd(),1,null);b=1}else if(d.onClickButton){var f=a.isAncstr(a.gtNdByAls(ALP_DFT+DFT_DEL),a.gtSelNd(),1)?1:0;b=d.onClickButton([a.gtSelNd().gtFId(),f,a.gtSelNd().gtDspNm(),a.gtSelNd().gtFCC(),d.oFpdCtx])}if(!b){var g=c.gtTr().parentNode.parentNode.outerHTML;cchFpdTrH(c.fP,g.replace(/\r\n/g,""));c.fnOnBfCls&&c.fnOnBfCls();a.dispose()}return b}function fpdTrOnDblClk(b){if(!b)b=getEvt(this);var e=getEvtTgt(b),a=getFpd(),d=a.tree,c=d.gtNd(Owa.Dom.Node.wrapDomNode(e));c&&a.getBtn(a.sBtn).click()}function enbFpdBtns(a){if(!wtda(g_sFPDId))return;wtda(g_sFPDId).oDlg.enableButton(L_CrtNewFldElps,a);wtda(g_sFPDId).oDlg.enableButton(getFpd().sBtn,a)}function fpdGtTr(){return getOneDescendant(wtda(this.sId),TR)}function fpdShw(){this.fnBDShow();var a=this.gtTr().parentNode;a&&spw(a.parentNode.parentNode.parentNode,gow(wtda(this.sId))-this.iMgn)}function fpdTrOnSelNd(b,a){if(!wtda(g_sFPDId))return;wtda(g_sFPDId).oDlg.enableButton(L_CrtNewFldElps,a?a.canCrt():0);wtda(g_sFPDId).oDlg.enableButton(getFpd().sBtn,a?a.canHvChld():0)}function fpdTrOnAfEdt(){fpdTrOnSelNd.call(this,null,this.gtSelNd())}function fpdTrOnBfEdt(){enbFpdBtns(0)}function getFpd(){return wtda(g_sFPDId).oDlg}var g_iLastServerActivityTime=(new Date).valueOf(),MAX_SERVER_ACTIVITY_DELAY=4*60*1e3;function onUserActivity(){var a=(new Date).valueOf();if(a-g_iLastServerActivityTime>MAX_SERVER_ACTIVITY_DELAY){refreshLastServerActivityTime(a);Owa.Dom.Window.get_Current().setTimeout(sendKeepAliveRequest,1)}}function refreshLastServerActivityTime(a){Owa.Utility.getRootOwaWindow().setGlobalVariable("g_iLastServerActivityTime",a);g_iLastServerActivityTime=a}function sendKeepAliveRequest(){var a=new Owa.Dom.AjaxRequest("keepalive.owa","GET",null,null,0);a.send()}Owa.Dom.EventTarget.set_OnBeforeDispatchEvent(onUserActivity);var QT_NRM=1,QT_AW=2,QT_EXCD=3,APV_APP="Approve",APV_REJ="Reject",APV_EDT="ApvEd",APV_SND="ApvSnd",CBS_OTH=1,CBS_32BIE7=2,CBS_64BIE7=3,CBS_VLD=CBS_32BIE7,MR_DELAYED=0,MR_SELCHANGE=1,MR_NEVER=2;if(!Owa)var Owa={};if(!Owa.Clipboard)Owa.Clipboard={};var Font=function $Font$(a,c,b,d){if(!isDf(typeof a)||!a)this.sFace=0;else this.sFace=a;if(!isDf(typeof c)||!c)this.sClr=0;else this.sClr=c;if(!isDf(typeof b)||!b)this.iStl=0;else this.iStl=b;if(!isDf(typeof d)||!d)this.sCS=0;else this.sCS=d};Font.prototype.ToChtFrmt=function Font$ToChtFrmt(){return"X-MMS-IM-Format: FN="+this.sFace+"; EF=; CO="+this.sClr+"; CS=1; PF=00%13%10%13%10"};Font.prototype.PrsChtFnt=function Font$PrsChtFnt(a){if(!a||!a.trim().length)return;if(a.indexOf("X-MMS-IM-Format")==-1)return;a=a.replace("\n\r\n\r","").trim();a=a.replace("X-MMS-IM-Format:","").trim();for(var g=a.split(";"),f=0;f<g.length;++f){var d=g[f].split("=");if(d.length<2)continue;var e=d[0].trim(),b=d[1].trim();if(e=="FN"){b=b.replace(/%20/g," ");if(!this.sFace)this.sFace=b}else if(e=="EF"){var c=0;if(b.indexOf("B")!=-1)c=c|1;if(b.indexOf("I")!=-1)c=c|2;if(b.indexOf("U")!=-1)c=c|4;this.iStl=c}else if(e=="CO"){this.sClr="#"+this.RvrsRGB(b.toUpperCase());if(this.sClr=="#FFFFFF")this.sClr="#000000"}}};Font.prototype.RvrsRGB=function Font$RvrsRGB(a){var b=a.length;if(b<6){a="000000"+a;a=a.substr(b,6)}return a.substr(4,2)+a.substr(2,2)+a.substr(0,2)};Owa.Dom.AjaxRequest.get_OnRequestCreated().add(cllctPrfDt);Owa.Dom.AjaxRequest.get_OnResponseReceived().add(strCbTmr);Owa.Dom.AjaxRequest.get_OnCallbackCompleted().add(fnshCllctDt);function strCbTmr(a){if(a.oPrfDt)a.oPrfDt.oCbTmr=new Date}function fnshCllctDt(a){try{if(a.oPrfDt){var b=rtvPrfCnsl(window);if(b&&b.g_clctOeh){var d=new Date,c=Math.ceil(d.valueOf()-a.oPrfDt.oStrtDt.valueOf());b.chngTblInnerHtml(a.oPrfDt.Id,b.CL_EXCTM,c+"&nbsp;ms",1);c=Math.ceil(d.valueOf()-a.oPrfDt.oCbTmr.valueOf());b.chngTblInnerHtml(a.oPrfDt.Id,b.CL_CLT_LTC,c+"&nbsp;ms",1);b.fnshRq(a.oPrfDt.Id,a.oPrfDt)}}}catch(e){}}function rtvPrfCnsl(){var a=gtMstr();if(a&&isDf(typeof a.g_oPrfCnsl))return a.g_oPrfCnsl}function cllctPrfDt(a){if(!Owa.Utility.isIE())return;if(a.oCtx&&a.oCtx.fIgnoredForPerfConsole)return;try{var b=rtvPrfCnsl(window);if(b&&b.g_clctOeh){var d="cl"+b.g_iRqCnt,e=new PrfDt(a.sUrl,a,d);try{var c=b.dtFrmSrv(a.sUrl,d,e)}catch(f){}e.Id=c;try{a.setRequestHeader("X-OWA-PerfConsoleRowId",c)}catch(f){}}}catch(f){}}function PrfDt(b,a,c){this.sUrl=b;this.oAjaxRequest=a;a.oPrfDt=this;this.Id=c;this.oStrtDt=new Date;return this}function isSilverlightInstalled(d){var c=false,a=null;try{var b=null;if(Owa.Utility.isIE())b=new ActiveXObject("AgControl.AgControl");else if(navigator.plugins["Silverlight Plug-In"]){var a=Owa.Dom.Document.get_Current().createElement("DIV");a=Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml('<embed type="application/x-silverlight" width="1" height="1" />');b=a._get_DomNode().firstChild}c=b.IsVersionSupported(d);b=null}catch(e){}a&&a.remove(true);return c}function spltVer(d){for(var c=[],b=d.split("."),a=0;a<b.length;a++)c.push(getInt(b[a]));return c}function getBool(a){return parseInt(a,10)==1}function getWCX(e){var b=getCX(e),d=god(e).parentWindow;if(!isWP())while(1)try{var a=d.frameElement,c=a.document.parentWindow;if(!c.g_fOwa)break;b+=getCX(a);d=c}catch(f){break}return b}function setMaxHeight(a,b){if("max-height"in a.style&&a.style.maxHeight>b)return;a.style.maxHeight=b+"px"}function items(d,e){var a;if(e)a=getDescendants(e,d);else if(this==window)a=wda(d);else a=getDescendants(this,d);var c=[];if(a)if(a.length==null)c[0]=a;else for(var b=0;b<a.length;++b)c[b]=a[b];return c}(function(){Owa.Controls.Popup=function Owa$Controls$Popup(b,c,d,e,a){Owa.Controls.Popup.baseClass.call(this,b);this.iZ=a?a:100;this.fIsOpen=0;this.oContainer=god(b).body;this.fnOnDataBind=c;this.fnOnPreShow=d;this.fnOnClose=e};Owa.Utility.inherit(Owa.Controls.Popup,Owa.Controls.Control);Owa.Controls.Popup.prototype.init=function Owa$Controls$Popup$init(){attchEvt(window,"resize",this.crtCb("close"));this.oTextBox=getEm("input");this.oTextBox.type="text";this.oTextBox.className="offscreen";ibe(god(this.getEl()).body,this.oTextBox);this._cbOnBlurTextBox=this.addEvent(this.oTextBox,"blur","onBlurTextBox");this._cbOnMouseDown=this.addEvent(this.getEl(),"mousedown","onMouseDown");this._cbOnSelectStart=this.addEvent(this.getEl(),"selectstart","onSelectStart");this._cbClick=this.addEvent(this.getEl(),"click","forwardEvent");this._cbKeyDown=this.addEvent(this.oTextBox,"keydown","forwardEvent");makeBodyPositioned(this.getEl())};Owa.Controls.Popup.prototype.dispose=function Owa$Controls$Popup$dispose(){this.removeEvent(this.getEl(),"mousedown","_cbOnMouseDown");this.removeEvent(this.getEl(),"selectstart","_cbOnSelectStart");this.removeEvent(this.getEl(),"click","_cbClick");this.removeEvent(this.oTextBox,"blur","_cbOnBlurTextBox");this.removeEvent(this.oTextBox,"keydown","_cbKeyDown");rn(this.oTextBox);this.oTextBox=0;this.oContainer=0;this.getEl().oOriginalParent=null};Owa.Controls.Popup.prototype.showRelative=function Owa$Controls$Popup$showRelative(c,d,b){var a=getRelativePosition(this.getEl());this.show(a.iX+c,a.iY+d,b)};Owa.Controls.Popup.prototype.show=function Owa$Controls$Popup$show(b,c,a){this.fnOnDataBind&&this.fnOnDataBind(this);this.iX=b;this.iY=c;this.fUR=a;this.stTmout("tShow",1)};Owa.Controls.Popup.prototype.tShow=function Owa$Controls$Popup$tShow(){var a=this.getEl();showEm(a);this.fIsOpen=1;this.fnOnPreShow&&this.fnOnPreShow(this);a.style.zIndex=this.iZ;spl(a,getVisiblePositionX(a,this.iX));spt(a,getVisiblePositionY(a,this.iY));this.enableClose()};Owa.Controls.Popup.prototype.close=function Owa$Controls$Popup$close(){if(this.fIsOpen){var a=this.getEl();hideEm(a);this.fIsOpen=0;this.fnOnClose&&this.fnOnClose(this)}};Owa.Controls.Popup.prototype.suppressClose=function Owa$Controls$Popup$suppressClose(){this.fSuppressClose=1};Owa.Controls.Popup.prototype.enableClose=function Owa$Controls$Popup$enableClose(){this.fSuppressClose=0;this.oTextBox.style.top=god(this.oTextBox).body.scrollTop+"px";this.oTextBox.style.left=god(this.oTextBox).body.scrollLeft+"px";this.oTextBox.focus();this.oTextBox.style.top="";this.oTextBox.style.left=""};Owa.Controls.Popup.prototype.onBlurTextBox=function Owa$Controls$Popup$onBlurTextBox(){this.fIsOpen&&!this.fSuppressClose&&this.close();this.fIsOpen&&this.stTmout("enableClose",1)};Owa.Controls.Popup.prototype.onMouseDown=function Owa$Controls$Popup$onMouseDown(a){this.suppressClose();this.forwardEvent(a);cnclBbl(a)};Owa.Controls.Popup.prototype.onSelectStart=function Owa$Controls$Popup$onSelectStart(a){prvntDft(a);cnclBbl(a)};Owa.Controls.Popup.prototype.forwardEvent=function Owa$Controls$Popup$forwardEvent(a){var b="on"+a.type;this[b]&&this[b](a)}})();function Cmb(a,c,b){a.oPU=c;a.divCmbDd=getOneDescendant(a,"divCmbDd");a.divCmbDd.oCmb=a;a.enbl=cmbEnbl;a.shw=cmbShw;a.hide=cmbHid;a.fnOnShwCmb=b;a.onmousedown=onMDCmb;a.divCmbDd.onkeydown=onKDCmb;a.enbl(a.getAttribute("fEnbld")=="1")}function dispCmb(a){a.hide=a.enbl=a.shw=a.onmousedown=null;if(a.divCmbDd)a.divCmbDd.onkeydown=a.divCmbDd.oCmb=null;a.divCmbDd=a.oPU=null}function cmbEnbl(a){if(a){this.style.color="";this.divCmbDd.style.filter="";this.divCmbDd.tabIndex=0;this.setAttribute("fEnbld","1")}else{this.divCmbDd.style.filter="alpha(opacity=50)";this.divCmbDd.tabIndex=-1;this.style.color="#808080";this.setAttribute("fEnbld","0")}}function onKDCmb(a){a=a?a:getEvt(this);getKeyCode(a)==9&&this.oCmb.oDP&&this.oCmb.close();if(getKeyCode(a)!=13)return;this.oCmb.shw()}function onMDCmb(a){a=a?a:getEvt(this);if(this.getAttribute("fEnbld")=="0")return;var b=getEvtTgt(a);if(b.id!="divCmbDd"&&!this.fd||!isLBDwn(a))return;this.shw()}function cmbHid(){this.oPU.close()}function cmbShw(){if(this.oPU.fIsOpen)this.oPU.close();else{this.fnOnShwCmb&&this.fnOnShwCmb();this.oPU.showRelative(0,goh(this)+2,0)}}function DpCmb(a,b,c,d){var f=Owa.Dom.Node.wrapDomNode(a),e=getOneDescendant(a,a.id+"DP");a.oDP=new Owa.UIControls.DatePicker(Owa.Dom.Node.wrapDomNode(e),dpCmbOnChg,null,true);a.oDP.dpCmb=a;a.dt=a.oDP.getSelDts();a.setV=dpCmbSetV;a.close=dpCmbCls;fmtDt.rgAbrDN=eval(a.oDP.getAttribute("rgAbrDN"));fmtDt.rgAbrMN=eval(a.oDP.getAttribute("rgAbrMN"));fmtDt.rgFulDN=eval(a.oDP._getAttribute("rgFulDN"));fmtDt.rgFulMN=eval(a.oDP._getAttribute("rgFulMN"));a.oDPPU=new Owa.Controls.Popup(getOneDescendant(a,"divDP"),dpCmbOnShw,0,d,150);a.oDPPU.init();a.oDPPU.onkeydown=function(b){onKDDP.call(a,b)};a.oDPPU.oDPCmb=a;Cmb(a,a.oDPPU,c);a.oDP.cmbOnChg=b}function dispDPCmb(a){if(a.oDP)a.oDP.dpCmb=null;a.oDP=null;a.dt=a.setV=a.close=null;dispCmb(a);a.oDPPU&&a.oDPPU.dispose()}function onKDDP(a){getKeyCode(a)==9&&this.hide()}function dpCmbOnShw(b){var a=b.oDPCmb;a.dt&&a.oDP.setSDs(new Array(a.dt))}function dpCmbCls(){showEms(wda("divMnthLst"),1);this.hide()}function dpCmbSetV(a){var b;if(!a)b=this.L_None;else b=fmtDt(a,this.getAttribute("sWkdDtFmt"));getOneDescendant(this,"spanCmbSel").innerText=b;this.dt=a}function dpCmbOnChg(a){a.dpCmb.hide();var b=a.getSelDts();a.dpCmb.setV(b);a.cmbOnChg&&a.cmbOnChg(b)}function canItmRpl(a){return!isOfClss(a,IT_CNT)&&!isOfClss(a,IT_PDL)&&!isOfClss(a,IT_TSK)}function canItemBeTracked(b){var a=b.lc();return a==IT_MSG.lc()||a==IT_MTC.lc()||a==IT_MTR.lc()||a==IT_MT_RSP_POS.lc()||a==IT_MT_RSP_TNT.lc()||a==IT_MT_RSP_NEG.lc()||a==IT_APV_RPLY_APP.lc()||a==IT_APV_RPLY_RJT.lc()||a==IT_TSK_REQ.lc()||a==IT_TSK_REQ_ACC.lc()||a==IT_TSK_REQ_DEC.lc()||a==IT_TSK_REQ_UPD.lc()||a==IT_MSG_SECURE.lc()||a==IT_MSG_SIGNED.lc()||a==IT_MSG_MULTIPART_SIGNED.lc()||isOfClss(b,IT_MSG)&&isSMime(b)}function addCls(a,b){if(cntnCls(a,b))return;if(a.className.length)a.className+=" "+b;else a.className=b}function rmvCls(c,d){var a=c.className,b=new RegExp("(^|\\s)"+d+"(\\s|$)");while(a.match(b))a=a.replace(b," ");c.className=a.trim()}function cntnCls(c,b){var d=c.className,a=new RegExp("(^|\\s)"+b+"(\\s|$)");return d.match(a)?1:0}function getVMAtt(c,e,d){var a=window.location,b=a.protocol+"//"+a.host+a.pathname;if(e)b+="attachment.ashx?attach=1&id="+c+"&MSWMExt="+d;else b+=c;return b}function delWoSCDlg(){return new BtnDlg("divDelCnfm",htmlEnc(L_CDMWOSC),null,[L_Yes,L_Cncl],null,null,onClsDMWoSC)}function delRcrWoSCDlg(){return new BtnDlg("divDelRcrWoSC",htmlEnc(L_PRDMWOSC),L_DRM,[L_DO,L_DS,L_Cncl],null,null,onClsDRWoSC)}function delRcrDlg(c,a){return new BtnDlg("divDelRcr",htmlEnc(a?L_PRDRA:L_DRP),c,a?[L_DO,L_DS,L_Cncl]:[L_DO,L_DS],null,null,onClsDR)}function SendDeclineResponseContext(a,b){this._sCId=a;this._sCK=b}SendDeclineResponseContext.prototype.get_CId=function SendDeclineResponseContext$prototype$get_CId(){return this._sCId};SendDeclineResponseContext.prototype.get_CK=function SendDeclineResponseContext$prototype$get_CK(){return this._sCK};function sndRspDlg(b,c){var d=new SendDeclineResponseContext(b,c),a=new BtnDlg("divCnfDel",htmlEnc(L_RspDelM),L_RspDelT,[L_Yes,L_No,L_Cncl],null,null,onClsSR,null,null,null,null,null,d);a.sCId=b;a.sCK=c;return a}function gtMtRspUrl(b,c){var a;switch(c){case R_TNT:a="IPM.Schedule.Meeting.Resp.Tent";break;case R_ACC:a="IPM.Schedule.Meeting.Resp.Pos";break;case R_DEC:a="IPM.Schedule.Meeting.Resp.Neg"}return"?ae=Item&a=New&s=Draft&t="+a+"&id="+b}function onClkEISnd(){var c=getEvtTgt(event);if(c._fSent)return;var d=c._sErrDbg;if(!d)return;var e=items("exceptionType"),b=null;if(0<e.length)b=e[0].innerText;else b="no exception";var a=new oeReq("Error","SendReport",null,cbEISnd);a.add("s","Error Report: "+b);a.add("b",d);a.oCtx=c;a.send()}function cbEISnd(a){if(a.sErr)shwErrDlg(a);else{var b=a.oCtx;b.title=b._msgSent;b._fSent=1}}function onClkEICpy(){var a=getEvtTgt(event);a._sErrDbg&&setData(a._sErrDbg)}function wrnOof(){var a=new BtnDlg("oofDlg",htmlEnc(L_OofOn),L_Oof,[L_Yes,L_No],270,Owa.BUTTON_DIALOG_ICON.OOF,cbWrnOof);a.show()}function cbWrnOof(b){if(b==0){var a=new oeReq("Options","DsblOof",0,cbDsblOof);a.send()}}function cbDsblOof(a){if(a.sErr)if(a.fST)rplLgn();else shwErrDlg(0,L_ErrOof)}function Slct(a,c,d,b,e){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();a.oPU=new Owa.Controls.Popup(getOneDescendant(a,"divCmbList"),slctOnDB,slctOnPreShw,0,e);a.oPU.init();a.oPU.oSlct=a;setMaxHeight(a.oPU.getEl(),150);a.clr=slctClr;a.add=slctAdd;a.getV=slctGetV;a.setV=slctSetV;a.fnOnShw=d;a.fnOnChg=c;a.oPU.onkeydown=function(b){onKDSlct.call(a,b)};a.oPU.onclick=function(b){onClkSlct.call(a,b)};a.oPU.onmousedown=function(b){onMDSlct.call(a,b)};a.fIUpdCmb=b;a.pg=slctPg;a.sel=slctSelItm;a.oSel=null;if(a.getAttribute("oV")!=null)a.setV(a.getAttribute("oV"));else a.oSel=a.oPU.getEl().firstChild;Cmb(a,a.oPU)}function dispSlct(a){if(Owa.Dom.Node.isInstance(a))a=a._get_DomNode();a.clr=a.add=a.getV=a.setV=null;a.oPU&&a.oPU.dispose&&a.oPU.dispose();dispCmb(a);a.fnOnShw=a.fnOnChg=null;a.pg=a.sel=null}function slctGetV(){return this.oSel?this.oSel.getAttribute("oV"):null}function slctSetV(a){var e=this.oPU.getEl();if(a===null){this.sel(null,this.oPU.fIsOpen,1);return 1}for(var d=e.childNodes,c=0;c<d.length;++c){var b=d[c];if(b.nodeType!=1)continue;if(b.getAttribute("oV")==a||a&&a.getDate&&b.getAttribute("oV")-a==0){this.sel(b,this.oPU.fIsOpen,1);return 1}}return 0}function slctSelItm(a,g,e){var b=1;if(this.oSel){b=!a||a.getAttribute("oV").valueOf()!=this.oSel.getAttribute("oV").valueOf();rmvCls(this.oSel,"cmbSel")}else b=a!=null;this.oSel=a;var c=a?a.innerHTML:"",f=a?a.oV:null;if(b){if(!this.fIUpdCmb){var d=getOneDescendant(this,"spanCmbSel");d.innerHTML=c}!e&&this.fnOnChg&&this.fnOnChg(f,this,c)}if(a){this.oSel.className+=" cmbSel";scrollIntoView(this.oSel,this.oPU.getEl())}}function slctClr(){this.oPU.getEl().innerHTML="";this.oSel=null}function slctAdd(b,c){var a=getEm("DIV",god(this));a.noWrap=1;a.tabIndex=0;a.oV=b;a.innerHTML='<span class="listItm">'+c+"</span>";ibe(this.oPU.getEl(),a)}function slctOnDB(a){a.oSlct.fnOnShw&&a.oSlct.fnOnShw(a.oSlct);sph(a.getEl(),150)}function slctOnPreShw(b){var a=b.getEl();a.style.width="";var d=gow(b.oSlct)-5,c=gow(a);if(c<d)c=d;spw(a,c+5);if(a.scrollHeight<=a.clientHeight)a.style.height="";b.oSlct.oSel&&b.oSlct.sel(b.oSlct.oSel,1)}function onMDSlct(){var a=$("divSpl");if(isSpC()&&isDisp(a.getExpando("oSpellCheckerComboBox")))a.getExpando("oSpellCheckerComboBox").oSpSel=crtSelTxR()}function onKDSlct(c){var a=null,b=0;switch(getKeyCode(c)){case 9:b=1;break;case 40:a=this.oSel.nextSibling;break;case 38:a=this.oSel.previousSibling;break;case 13:b=1;a=this.oSel;break;case 36:a=this.oPU.getEl().firstChild;break;case 35:a=this.oPU.getEl().lastChild;break;case 34:a=this.pg(DOWN);break;case 33:a=this.pg(UP);break;default:return}b&&this.hide();if(a==null||!isDisp(a))return;this.sel(a,!b);canEvt(c)}function slctGetLItm(a){while(a.oV==null)a=a.parentNode;return a}function slctPg(g){for(var c=this.oPU.getEl(),e=c.children.length,f=c.scrollHeight/e,d=c.offsetHeight/f,a=this.oSel,b=a;0<d&&b;--d){a=b;if(g==UP)b=a.previousSibling;else b=a.nextSibling}return a}function onClkSlct(a){cnclBbl(a);var b=getEvtTgt(a);if(b==this.oPU.getEl())return;this.hide();this.sel(slctGetLItm(b),0)}var TM_S=0,TM_E=1,TM_R=2,g_sShtTmFmt;function TmSlct(b,f,c,d){var a=b._get_DomNode();Slct(a,tmSlctOnSlct,tmSlctOnShw,1);a.setT=tmSlctSetT;a.isVld=tmSlctOnFcsO;a.fnOnChgTm=f;a.udUI=tmSlctUI;a.dt=new Date(b.getAttribute("sTm"));g_sShtTmFmt=b.getAttribute("sStf");parseTm.rxAmPm=new RegExp(a.sAmPmRx,"gi");fmtDt.sAM=b.getAttribute("L_AM");fmtDt.sPM=b.getAttribute("L_PM");rndrTLst.L_Dec=b.getAttribute("L_Dec");rndrTLst.L_InvldTm=b.getAttribute("L_InvldTm");if(c==TM_E)a.oS=d;else if(c==TM_S)a.oE=d;a.iT=c;var e=getOneDescendant(a,"txtTime");e.onfocusout=function(){tmSlctOnFcsO.call(a)}}function dispTmSlct(a){dispSlct(a);a.setT=null;a.isVld=null;a.fnOnChgTm=null;a.udUI=null;a.dt=null;a.oSE=null;a.oE=null;a.oS=null;var b=getOneDescendant(a,"txtTime");b.onfocusout=null;g_sShtTmFmt=a.sStf=null;parseTm.rxAmPm=null;fmtDt.sAM=a.L_AM=null;fmtDt.sPM=a.L_PM=null;rndrTLst.L_Dec=a.L_Dec=null;rndrTLst.L_InvldTm=a.L_InvldTm=null}function tmSlctSetT(f,e,d){var b=this.dt;this.dt=f;this.udUI();if(this.iT==TM_S){var c=this.oE.dt-b;if(0<=c){var a=new Date(this.dt);a.setUTCMilliseconds(a.getUTCMilliseconds()+c);this.oE.setT(a,0,1)}}var g=!cmpDt(b,this.dt);!e&&g&&this.fnOnChgTm&&this.fnOnChgTm(d)}function tmSlctOnShw(a){rndrTLst(a,a.dt,a.iT==TM_E?a.oS.dt:null);var c=30<=a.dt.gmins()?30:0,b=new Date(a.dt);b.smins(c);a.setV(b)}function tmSlctOnSlct(b,a){a.setT(b)}function tmSlctOnFcsO(){var a=this,b=getOneDescendant(a,"txtTime");if(b.value==fmtDt(a.dt,g_sShtTmFmt))return 1;var c;c=parseTm(b.value,a.iT==TM_E?a.oS.dt:null,a.iT==TM_E?a.dt:null);if(c==-1){alert(a.L_InvldTm);a.udUI();setFcs(b);return 0}else{var d=new Date(a.dt);d.shrs(0,c);a.setT(d);return 1}}function tmSlctUI(){var a=getOneDescendant(this,"txtTime");a.value=fmtDt(this.dt,g_sShtTmFmt)}function rndrTLst(c,d,a){if(!a)rndrATLst(c,d);else if(d-a<24*60*60*1e3){c.clr();for(var i=a.ghrs()*60+a.gmins(),b=0;b<48;b++){var g=i+b*30,e=new Date(a);e.shrs(0,g);var f=g;if(1440<=f)f-=1440;var h=fmtDt(e,g_sShtTmFmt),j=(b>>1).toString(10)+(b%2?rndrTLst.L_Dec+"5":"");h+=a_sDur.format(j);c.add(e,h)}}else rndrATLst(c,d)}rndrTLst.L_Dec;function cbMvItm(b){g_fJnkRq=0;if(b.sErr){b.fST&&popLgn();shwErrDlg(b)}else{var d=b.oCtx,e=d.oCallerSubPage,a,c;try{a=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController();if(d.fCls){a=a.get_ParentController();c=Owa.PageHierarchy.getVirtualListViewFromSubPageController(a)}else{var f=Owa.PageHierarchy.getVirtualListViewFromSubPageController(a);if(f&&d.iActn==ACTN_ADDBSL){a=a.get_ParentController();c=f}else if(isFolderViewSubPageObject(e))c=e.get_VirtualListView()}a=a.get_ParentController();a.invokeFunction("stDrty",[d.sDstFId])}catch(g){}rfrshLst(c,b)}}function rfrshLst(b,a){if(b&&a){b.updCnts(a);b.rmvRws(a.oCtx.rgIds);a.oCtx.fCls&&window.close()}}function shwPont(j,h,i,d,f,k,g,c){var a={};a.oCtx=g;a.cb=k;a.iPT=j;var e="<div><div>"+h+"</div><div>&nbsp;</div><div><input type=checkbox id=chkPont><span>&nbsp;</span><label for=chkPont>"+L_DntShw+"</label></div></div>",b=new BtnDlg(c?c:"divPont",e,i,d,390,f,cbShwPont,0,0,0,0,0,a);b.show();return b}function cbShwPont(b,a){if(b==-1)return;if(wtda("chkPont").checked){var c=new oeReq("Options","DisablePont");c.add("pt",a.iPT);c.send();if(isDf(typeof a_iEnblPnt))a_iEnblPnt&=~a.iPT}a.cb&&a.cb(b,a.oCtx)}function shwDelRcrTskDlg(e,d,f){var a={};a.cb=e;a.oC=f;var c="<div>"+htmlEnc(L_TskRcrs).format(d)+"</div><div><input id=rdoDO type=radio name=rdoDRT checked><label for=rdoDO>"+L_DelOcc+"</label></div><div><input id=rdoDA type=radio name=rdoDRT><label for=rdoDA>"+L_DelAOcc+"</label></div>",b=new BtnDlg("divDRT"+rndm(),c,L_DelRT,[L_OK,L_Cncl],367,null,cbShwDelRcrTskDlg,0,0,0,0,0,a);b.show();return b}function cbShwDelRcrTskDlg(b,a){if(b==-1)return;a.cb(b,wtda("rdoDO").checked,a.oC)}function updQB(d,b,c){var a=d.getDescendantById("elcQuotaUsed");if(b<=0){a.set_Width(0,Owa.Style.Unit.Percent);a.set_IsShown(0)}else{a.set_Width(b>100?100:b,Owa.Style.Unit.Percent);a.set_IsShown(1)}switch(c){case QT_NRM:a.set_CssClasses(["elcQtNorm"]);break;case QT_AW:a.set_CssClasses(["elcQtWarn"]);break;case QT_EXCD:a.set_CssClasses(["elcQtExc"])}}var g_sRFId="",g_fDltDrft=0,g_fFcsLV=1,g_rgFntSz=[0,8,10,12,14,18,24,36];function opnAtt(a,e,h,b){if(a.className=="dsbl"){canEvt(e);return}var d=getInt(a.getAttribute("_level"));if(isNaN(d)||d<1||d>3){canEvt(e);return}if(d==1&&getBool(a.parentNode.getAttribute("_isRW"))){alert(L_AttWrnLevOne);canEvt(e)}if(d==2){if(h)alert(L_IrmCopyRestrictedConv);else alert(L_AttWrnLevTwo);canEvt(e)}else if(d==3){var c=a.getAttribute("_qs"),f=getInt(a.getAttribute("_idx")),g=getBool(a.getAttribute("_emb")),i=Owa.Dom.Node.wrapDomNode(a);b=b||Owa.Components.SubPageControllerFactory.getControllerFromParent(i).get_SubPage();if(c&&c.indexOf("t="+IT_CNT)>=0)openItm(gtAttUrl(a,null,b),0,0,RF_W,RF_H,b);else if(c&&c.indexOf("t="+IT_PDL)>=0)openItm(gtAttUrl(a,null,b),0,0,null,null,b);else if(!isNaN(f)&&!g){var j=getBool(a.parentNode.getAttribute("_isRW"));if(j||!g_oMmBdy.IEIsProtectedModeProcess)alert(L_AttWrnSaveToDisk);else setSelfLocationWithoutPrompt(g_oMmBdy.attachments.item(f).href)}else if(!isNaN(f)&&g)opnMmEmbItm(f);else if(Owa.Utility.isIE()||c&&(c.indexOf("ae=Item")>=0||c.indexOf("ae=PreFormAction")>=0))opnWin(gtAttUrl(a,null,b)+gtMmPar(),0,0,0,"_blank");else setSelfLocationWithoutPrompt(gtAttUrl(a,null,b)+gtMmPar());canEvt(e)}}function gtAttUrl(f,j,c){c=c||Owa.UIControls.SubPage.get_Instance();var b=c.getSubPageVariable("a_rgsIds"),e=typeof b!="undefined",a,g=f.getAttribute("_qs");if(g)a="?"+g+"&";else if(j)a="";else a="attachment.ashx?attach=1&";var h=f.getAttribute("_sId");if(h)a+="id="+urlEnc(h);else a+="id="+urlEnc(e?b[0]:c.get_ItemId());if(e)for(var d=1;d<b.length;d++)a+="&attid"+(d-1)+"="+urlEnc(b[d]);var i=e?b.length:1;a+="&attid"+(i-1)+"="+urlEnc(f.getAttribute("_attid"));a+="&attcnt="+i;return a}function selAtt(b){var a;onKeyDownAw.oLastAttSpn=b;a=createTextRange(document);a.moveToElementText(b._get_DomNode());a.moveStart(1);a.select();b.focus()}function onKeyDownAw(b){var a=b.get_Target(),c=a.get_ParentElement(),e=b.get_KeyCodeForKeyUpDown(),d=false;if(Owa.Utility.isSafari()){if(onKeyDownAw.oLastAttSpn){a=onKeyDownAw.oLastAttSpn;c=a.get_ParentElement();d=c.getBoolAttribute("_isRW")}}else d=c.getBoolAttribute("_isRW");if(a.get_Id()!="spnAtmt")return;switch(e){case 46:case 8:if(d){dltAtt(a);canEvt(b)}break;case 13:opnAtt(a._get_DomNode(),b);canEvt(b)}onKeyDownAw.oLastAttSpn=null}function getAttachmentSpan(a){if(a.get_TagName()=="IMG")a=a.get_ParentElement();if(a.get_Id()=="lnkAtmt")a=a.get_ParentElement();return a.get_Id()=="spnAtmt"?a:null}function onClickAw(b,c,d){var e=b.get_Target(),a=getAttachmentSpan(e);if(!a)return;if(getBool(a.get_ParentElement().getAttribute("_isRW")))selAtt(a);else opnAtt(a._get_DomNode(),b,c,d);canEvt(b)}function onAwBlur(a){var b=a.get_Target();onKeyDownAw.oLastAttSpn=null}function onDblClickAw(a){var c=a.get_Target(),b=getAttachmentSpan(c);if(!b)return;if(b.getAttribute("_ignoredblclick")=="1")return;opnAtt(b._get_DomNode(),a);canEvt(a)}function dltAtt(a){var b;if(Owa.Components.OehRequest.hasPendingRequests())return;if(a.get_Id()!="spnAtmt")return;var c=Owa.UIControls.SubPage.get_Instance();if(g_oMmBdy)dltSmAtt(a._get_DomNode());else if(c!=null&&c._sl_oAttMgr!=null)c._sl_oAttMgr.DeleteAttachment(a.getAttribute("_attid"));else{var d={};d.attachWellNode=a._get_DomNode().parentNode;b=new oeReq("Attachments","Delete",d,cbRefreshAttachmentWell);b.add("Id",a_sId);b.add("CK",a_sCK);b.add("AttId",a.getAttribute("_attid"));b.send()}}function RefreshAttachmentWell(c,d){if(isNoE(a_sId))return;var a={};a.fCannotConnectToEws=c;a.fDoNotSetDirty=d;var b=new oeReq("Attachments","RefreshWell",a,cbRefreshAttachmentWell);b.add("Id",a_sId);b.send()}function cbRefreshAttachmentWell(a){if(a.fST){popLgn();return}if(a.sErr)alert(a.sErr);else{a.oCtx!=null&&typeof a.oCtx.fCannotConnectToEws!="undefined"&&a.oCtx.fCannotConnectToEws&&shwErrDlg(null,L_ErrCannotConnectToEwsRetry);var b=Owa.Dom.Document.get_Current().createElement("DIV");b=Owa.Dom.Document.get_Current().appendChild(b);b.set_InnerHtml(a.sBody);var g=b.getDescendantById("attWD"),f=b.getDescendantById("iBData");a_sCK=b.getDescendantById("ck").get_TextContent();var d=Owa.UIControls.SubPage.get_Instance();if(g){var c;if(a.oCtx!=null&&typeof a.oCtx.attachWellNode!="undefined"&&a.oCtx.attachWellNode!=null)c=Owa.Dom.Node.wrapDomNode(a.oCtx.attachWellNode);else c=d._getDescendant("divAtch");c.set_InnerHtml(g.get_InnerHtml());d._initAttachmentDeleteLinks(c)}if(f){var e=f.getDescendantById("divIDA");if(e)replaceOrInsertInfobarMessageElement(e);else checkRemoveInfobarMessage("divIDA")}updateInfobarForUnprotectableAttachments();b.remove(true);d.resizeAttachmentWell();a.oCtx!=null&&!a.oCtx.fDoNotSetDirty&&drty()}}function isRichTextEditorSupported(){return isDf(typeof a_fRichTextEditorSupported)&&a_fRichTextEditorSupported}function initEditMarkup(c,a,b){if(b||Owa.Utility.isSafari()||Owa.Utility.isFirefox())if(Owa.Utility.isIE())a.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,"<P>&nbsp;</P>");else a.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,"<BR>")}function wrapHtmlBodyWithDefaultFont(d,b,c){var a=d.createElement("div");applyCssToDomNode(a._get_DomNode(),c);a.set_InnerHtml(b.get_InnerHtml());b.set_InnerHtml(a.get_OuterHtml())}function applyCssToDomNode(a,b){if(Owa.Utility.isIE())a.style.setAttribute("cssText",b);else a.setAttribute("style",b)}function addSignature(d,o){if(!a_sSigHtml&&!a_sSigTxt)return;var g=isRepFw();if(Owa.Utility.isIE()||o){var h=edDoc(1),e=h.get_Body(),b=h.createElement("DIV"),n=e.get_FirstChild(),p=d&&!g?"<p id=spc1>&nbsp;</p><p id=spc2>&nbsp;</p>":"<p id=spc1>&nbsp;</p>",q=Owa.Utility.isIE()?p:"<br>";b.set_InnerHtml(q+(o?a_sSigHtml:htmlEnc(a_sSigTxt)));for(var m=b.getDescendantsByTagName("STYLE"),l=0;l<m.length;l++)m[l].remove(true);if(!n)b=h.appendChild(b);else if(d)b=n.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,b);else if(g){var t=Owa.UIControls.SubPage.get_Instance(),v=t.getComposeEditor();v.insertMarkupAtCursor(b.get_OuterHtml())}else b=e.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b);if(Owa.Utility.isIE()){var j=e.getDescendantById("spc1"),k=e.getDescendantById("spc2");if(j){j.set_InnerHtml("");j.set_Id("")}if(k){k.set_InnerHtml("");k.set_Id("")}}!d&&setFcsBdy()}else{var f=$("txtBdy"),i="\n"+a_sSigTxt,s=f.get_Value(),a=f._oDomNode;if(g){var c=a.selectionStart,r=a.value.substring(0,c),u=a.value.substring(c,a.value.length);f.set_Value(r+i+u);if(!d){a.selectionStart=c+i.length;a.selectionEnd=c;a.focus()}}else{f.set_Value(s+i);if(!d){var c=a.selectionStart;a.selectionStart=c;a.selectionEnd=c;a.focus()}}}}function addSignatureToNewMessage(){var a=!(isDf(typeof a_fTxt)&&a_fTxt);if(!isDf(typeof a_fSig)||!a_fSig||isExpDft()||!a&&isRepFw())return;addSignature(true,a)}function addSignatureToExistingMessage(){var a=isHtml();addSignature(false,a);drty()}function wrtBdy(a,b){a.open();a.write(b);a.close()}function initializeIFrameBodyEditorHotkeys(b){var a=Owa.UIControls.SubPage.get_Instance();a._oIFrameBodyActionTable=new Owa.Components.ClientActionTable;a._oIFrameBodyActionTable.addAsAction("bold",[onEditorEnhancedAction]).addAsAction("italic",[onEditorEnhancedAction]).addAsAction("underline",[onEditorEnhancedAction]).addAsAction("createlink",[onEditorEnhancedAction]).addAsAction("cut",[onEditorDefaultAction]).addAsAction("copy",[onEditorDefaultAction]).addAsAction("paste",[onEditorDefaultAction]).addAsAction("undo",[onEditorDefaultAction]).addAsAction("redo",[onEditorDefaultAction]).addAsAction("selectall",[onEditorDefaultAction]).addAsAction("indent",[onEditorEnhancedAction]).addAsAction("outdent",[onEditorEnhancedAction]);a._oIFrameBodyHotkeyManager=new Owa.Components.HotKeyManagerDom(a._oIFrameBodyActionTable,b,Owa.UIControls.SubPage.get_Instance().get_HotKeyManager());a._oIFrameBodyHotkeyManager.addHotKey(L_HkB,"bold").addHotKey(L_HkI,"italic").addHotKey(L_HkU,"underline").addHotKey(L_HkLnk,"createlink").addHotKey(L_HkCut,"cut").addHotKey(L_HkCpy,"copy").addHotKey(L_HkUndo,"undo").addHotKey(L_HkRedo,"redo").addHotKey(L_HkSel,"selectall")}function onEditorDefaultAction(b,a){if(a.fIsHotkey)return true;else{Owa.ExecCommand.execute(edDoc(0),a.sActionName);return false}}function onEditorEnhancedAction(b,a){(!Owa.Utility.isFirefox()||a.sActionName.toLowerCase()!="createlink")&&isHtml()&&Owa.ExecCommand.execute(edDoc(0),a.sActionName)}function initTxtBdy(c,d){var a=$(d);if(a){a.attachEvent("keydown",onKDTxt);if(!chkMime()){var b={};b.oCallerSubPage=c;a.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,b));a.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,b));initDE(c._getDescendant(d))}}}function isFormatBarInitialized(a){return a&&a.getExpando("formatBar")}function procIA(a,h){if(!wda("divAtch"))return;a=a?a:edEvt();if(!a)a=getEvt(this);var f=Owa.Dom.Event.isInstance(a)?a:new Owa.Dom.Event(a),g=f.get_Type()=="paste",e=g?new Owa.Components.Storage.Clipboard:new Owa.Components.Storage.DragDrop(f),b=Owa.Components.Storage.StorableObject.createFromStorage(e);if(!b)return 1;if(!canAttach(b)){g&&e.set_Data("");canEvt(a);return}canEvt(a);var d=h.oCallerSubPage,c=d.getSubPageVariable("a_iT");sndIAReq(d,b,isDf(typeof c)&&c>=a_IT_MSG?c:a_IT_MSG,cbIA)}var g_fIA=0;function sndIAReq(b,h,k,j){var e=h.get_RootElement(),f=b||Owa.UIControls.SubPage.get_Instance();if(f!=null&&(f._sl_fProcessingAttachments||f._fAutoSavingItem))return;if(typeof g_fIA!="undefined"&&g_fIA)return;else g_fIA=1;var c=0;if(isNavigationPageObject(b))c=b.getLstVw(e.get_FolderId());else if(isFolderViewSubPageObject(b))c=b.get_VirtualListView();if(c&&checkLimit(h,c))return;var i={};i.oCallerSubPage=b;var a=new oeReq("Attachments","AttachItems",i,j);a.set_ProcessXhrStatusZeroAsError();!(typeof a_sId=="undefined")&&a_sId&&a.add("Id",a_sId);!(typeof a_sCK=="undefined")&&a_sCK&&a.add("CK",a_sCK);a.add("IT",k);var g=[];e.foreach_Item(function(a){g.push(a.get_ItemId())});g.length&&a.addRg("ExIds",g);var d=[];e.foreach_Conversation(function(c){var b=new oeSt(a,"CnvInf");b.add("CT",c.get_Topic());b.add("TS",c.get_TimeStamp());d.push(b)});d.length&&a.addRgSt("Cnvs",d);a.send();shwPrgrsInd(L_Ld)}function cbIA(b){if(typeof g_fIA!="undefined")g_fIA=0;hdPrgrsInd();if(b.fST){popLgn();return}if(b.sErr)alert(b.sErr);else{var a=Owa.Dom.Document.get_Current().createElement("div");a.set_IsShown(false);Owa.Dom.Document.get_Current().appendChild(a);a.set_InnerHtml(b.sBody);var b={};if(a.getDescendantById("itemId"))b.sId=a.getDescendantById("itemId").get_TextContent();var d=a.getDescendantById("attSz"),e=parseInt(d.get_TextContent(),10);Owa.UIControls.SubPage.get_Instance().setSubPageVariable("a_sl_iTotalAttachmentSize",e);var f=a.getDescendantById("ck");b.sCK=f.get_TextContent();b.sAtts=a.getDescendantById("attItms").get_InnerHtml();b.sIbd=a.getDescendantById("attIB").get_InnerHtml();procAttRsp(b);a.remove(true);var c=Owa.UIControls.SubPage.get_Instance();c!=null&&c._sl_oAttMgr!=null&&c._sl_oAttMgr.OnAttachmentWellUpdatedByServer()}}function cbFwIA(b){if(typeof g_fIA!="undefined")g_fIA=0;hdPrgrsInd();if(b.fST){popLgn();return}if(b.sErr)alert(b.sErr);else{if(typeof a_iDltDrft!="undefined")g_fDltDrft=a_iDltDrft;else g_fDltDrft=1;var a=Owa.Dom.Document.get_Current().createElement("DIV");a.set_InnerHtml(b.sBody);if(a.getDescendantById("itemId")){var g=a.getDescendantById("itemId").get_TextContent(),c=b.oCtx,f=c?c.oCallerSubPage:Owa.UIControls.SubPage.get_Instance();openItm("?ae=Item&t=IPM.Note&a=New&id="+urlEnc(g),null,null,null,null,f)}else alrt(L_ErrFwIA);if(a.getDescendantById("attIB")){var d=Owa.Dom.Document.get_Current().createElement("DIV");d.set_InnerHtml(a.getDescendantById("attIB").get_InnerHtml());var e=d.getDescendantById("divDAErr");e&&alrt(e.get_TextContent(),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}}}function onPste(){var b=gtWrd();b&&unmrkW(b);var a=edEvt();if(a&&getEvtType(a)!="paste")return;if(isHtml())return 1;var c=window.clipboardData.getData("Text");setData(c);return 1}function apBdyStl(a,e,c){c=c||Owa.UIControls.SubPage.get_Instance();applyParagraphStylesToDocument(a,e);var d=insertSS(a,"owaTempEditStyle");if(!a.get_Body().getBoolAttribute("ocsi")){c.getSubPageVariable("a_fPrintRestricted")==1&&applyNoPrintStylesToDocument(a);var b=getStyle("scrlbrs");d.addRule("BODY","scrollbar-base-color:"+b.scrollbarBaseColor+";scrollbar-highlight-color:"+b.scrollbarHighlightColor+";scrollbar-darkshadow-color:"+b.scrollbarDarkShadowColor+";scrollbar-track-color:"+b.scrollbarTrackColor+";scrollbar-arrow-color:"+b.scrollbarArrowColor);isSpC()&&d.addRule("SPAN#misspelled","BACKGROUND: url('"+(g_oMmBdy?g_oMmBdy.squiggleUrl:getRsrcF("squiggly.gif"))+"') repeat-x 50% bottom;padding-bottom:1;");a.get_Body().setIntAttribute("ocsi",1)}}function rmvBdyStl(a){var b=a.get_Body();if(b.getBoolAttribute("ocsi")){var c=getSS(a,"owaTempEditStyle");c&&c.remove();removeNoPrintStylesFromDocument(a);b.setIntAttribute("ocsi",0)}}function isExpDft(){return isDf(typeof a_iNit)&&a_iNit==RF_EXPDFT}function isImpDft(){return isDf(typeof a_iNit)&&a_iNit==RF_IMPDFT}function atLnk(g,a,c){if(a==2||a==3){var b=new Owa.Dom.Event(g),f=b.get_Target(),d=Owa.Components.SubPageControllerFactory.getControllerFromParent(f),e=d.get_SubPage();onClickAw(b,c,e)}}function RepositionContactsBody(a){a=a||Owa.UIControls.SubPage.get_Instance();if(a._getDescendant("divCnts")&&a._getDescendant("divCntsHdr")){var b=a._getDescendant("divCntsHdr").get_OffsetHeight();if(b){a._getDescendant("divCnts")._get_DomNode().style.position=Owa.Style.Positioning.Absolute;a._getDescendant("divCnts").set_Top(b);a._getDescendant("divCnts").set_Bottom("0")}}}function _resizeBodiesInternal(){clsEdCtxMs();var b=this._getDescendant("divHdrMessage");if(b){this._adjustMessageBody();return}var a=this._getDescendant("divHdr"),c=this._getDescendant("divBdy");this.getSubPageVariable("a_fEdtCal")&&this._getDescendant("divCalFormTabBody").fillHeight(null,this._getDescendant("divCalFormHdr"),null);if(a){c.fillHeight(null,a,null);this.getSubPageVariable("a_fTxt")&&rszBdy(this._getDescendant("txtBdy"),this.get_SubPage())}}function _adjustMessageBody(){var g=this._getDescendant("divHdrMessage").get_OffsetHeight(),d=this._getDescendant("divBdy");if(!d)d=this._getDescendant("mimeEdit");var l=d.get_Top();l!=g&&d.set_Top(g);var a=this._getDescendant("txtBdy"),m=a&&a.get_IsShown();if(this.getSubPageVariable("a_fTxt")&&m){var f=d.get_OffsetWidth(),e=d.get_OffsetHeight(),j=a.getEffectivePadding(Owa.Style.Side.Left),i=a.getEffectivePadding(Owa.Style.Side.Right),k=a.getEffectivePadding(Owa.Style.Side.Top),h=a.getEffectivePadding(Owa.Style.Side.Bottom),b=0,c=0;if(Owa.Utility.isIE()){b=e-(k+h);c=f-(j+i)}else{b=e-(k+h)/2;c=f-(j+i)/2}c=c<0?0:c;b=b<0?0:b;c!=a.get_Width()&&a.set_Width(c);b!=a.get_Height()&&a.set_Height(b)}}function rszBdy(a,d){clsEdCtxMs();d=d||Owa.UIControls.SubPage.get_Instance();if(d._getDescendant("divHdrMessage"))return;var e=a.get_ParentElement(),b=e.get_ClientHeight(),c=e.get_ClientWidth(),h=a.getEffectivePadding(Owa.Style.Side.Left),g=a.getEffectivePadding(Owa.Style.Side.Right),i=a.getEffectivePadding(Owa.Style.Side.Top),f=a.getEffectivePadding(Owa.Style.Side.Bottom);c-=h+g;b-=i+f;if(c<0)c=0;if(b<0)b=0;a.set_Width(c);a.set_Height(b)}function onKDTxt(a){var b=a.get_KeyCodeForKeyUpDown();Owa.KeyCodes.isDirtyingKey(b)&&drty()}function shwFmtBr(a){var c=$("divFmtBr"),d=Owa.UIControls.SubPage.get_Instance().getComposeEditor();!a&&d.deactivateFormatBar();c.set_IsShownAroundIEBug(a);var b=$("divBdy");if(a)b.removeCssClass("brd");else b.addCssClass("brd")}function onChgHtmlTxt(){var g=$("divCmbFrmt").getExpando("oComboBox"),h=isHtml(),b=Owa.Dom.Node.wrapDomNode(edDoc().body);drty();var a=Owa.UIControls.SubPage.get_Instance();if(!h)if(b.get_TextContent()==""||confirm(L_WrnFmtLss)){a._promoteInlineAttachments();checkRemoveInfobarMessage("divIbImg");if(!Owa.Utility.isIE()){var f=$("txtBdy"),c=b.get_InnerHtml();c=c.replace(/<BR>/gi,"\n<BR>");if(Owa.Utility.isSafari())c=c.replace(/<DIV([^>]*)>/gi,"\n<DIV>");b.set_InnerHtml(c);f.set_Value(b.get_TextContent());hideEm($("ifBdy"));showEm(f)}else{var d=a.getComposeEditor();if(d){d._removeStyleSheetRulesFromEditor();edDoc(1).get_Body().setIntAttribute("ocsi",0);apBdyStl(edDoc(1),0)}b.set_TextContent(getTxtBdy())}shwFmtBr(0)}else g.set_SelectedValue("0",1);else{var e=getTxtBdy();if(Owa.Utility.isIE())b.set_TextContent(e);else{e=htmlEnc(e);b.set_InnerHtml(e.replace(/\n/g,"<BR>"));showEm($("ifBdy"));hideEm($("txtBdy"))}shwFmtBr(1);var d=a.getComposeEditor();if(d){d._removeStyleSheetRulesFromEditor();edDoc(1).get_Body().setIntAttribute("ocsi",0);apBdyStl(edDoc(1),0)}}!(a.getSubPageVariable("a_fEdtCal")&&a.getSubPageVariable("g_sTb")!=a.getSubPageVariable("TB_APPT"))&&disableInsertImageButton(!isHtml());a.safeResizeBodies();g_sLstSpTx=SP_RESET}function getTxtBdy(){return Owa.Utility.isIE()?edDoc(1).get_Body().get_TextContent():$("txtBdy").get_Value()}function removeMetaCharsetTag(d){for(var b=d.getDescendantsByTagName("meta"),a=0;a<b.length;a++){var c=b[a];if(c.getAttribute("charset")!=null){c.remove(true);break}}}function getHtmlBdy(d){var a=edDoc(1);removeMetaCharsetTag(a.get_DocumentElement());rmvBdyStl(a);var b=Owa.UIControls.SubPage.get_Instance().getComposeEditor();if(isSpC())if(clrSpUI(1))g_sLstSpTx=SP_RESET;var c=b.getHtml(1,0);apBdyStl(a);b._applyDefaultFonts();!d&&setFcsBdy();return c}function processHtmlBdyforSmime(d,c,e){var a=edDoc(1);removeMetaCharsetTag(a.get_DocumentElement());rmvBdyStl(a);if(isSpC())if(clrSpUI(1))g_sLstSpTx=SP_RESET;var b=Owa.UIControls.SubPage.get_Instance().getComposeEditor();b.conditionHtmlForSmime(e);d();apBdyStl(a);b._applyDefaultFonts();!c&&setFcsBdy()}(function(){Owa.Clipboard.getData=function Owa$Clipboard$getData(){if(window.clipboardData)return window.clipboardData.getData("Text");else try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);if(!c)return false;var b=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!b)return false;b.addDataFlavor("text/unicode");c.getData(b,c.kGlobalClipboard);var a={},e={},d="";b.getTransferData("text/unicode",a,e);if(a)a=a.value.QueryInterface(Components.interfaces.nsISupportsString);if(a)d=a.data.substring(0,e.value/2);return d}catch(g){return false}};Owa.Clipboard.setData=function Owa$Clipboard$setData(f,b){if(window.clipboardData)window.clipboardData.setData("Text",b);else try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!c)return false;c.data=b;var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!a)return false;a.addDataFlavor("text/unicode");a.setTransferData("text/unicode",c,b.length*2);var d=Components.interfaces.nsIClipboard,e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(d);if(!e)return false;e.setData(a,null,d.kGlobalClipboard)}catch(g){return false}}})();function shwAttchDlg(c){var a=Owa.UIControls.SubPage.get_Instance();if(a!=null&&a._sl_oAttMgr!=null){if(Owa.Components.OehRequest.hasPendingRequests())return;a._sl_oAttMgr.LaunchOpenFileDialog(c);return}var b={};b.sId=a_sId;b.sCK=a_sCK;var d=null;b.iT=a.getSubPageVariable("a_iT");b.fSlDisabled=a._sl_disabled;if(a.getSubPageVariable("a_fHasInlineImages"))b.sHtmlBdy=a.getComposeEditor().getHtml(1,1);if(c)d="&a=InsertImage";if(typeof a_sFldId!="undefined")b.sFldId=a_sFldId;var e=function(a){procAttRsp(a,c);addPerfMarker("ShwAttchDlg.End")};shwMdlDlg("AttachFileHost",450,285,b,d,e)}function procAttRsp(a,f){if(a!=null){if(a.sId!=null){if(typeof a_iDltDrft!="undefined")g_fDltDrft=a_iDltDrft;else g_fDltDrft=1;a_sId=a.sId}if(!g_fDltDrft&&(a_sCK==null||a_sCK!=a.sCK)){var e=gtPrntLV();if(e!=null){var c=e.get_SubPage();c!=null&&c.get_ItemIdInReadingPane!=null&&a_sId==c.get_ItemIdInReadingPane()&&rfVwAftEdt()}}if(a.sCK)a_sCK=a.sCK;var b=Owa.UIControls.SubPage.get_Instance(),d=b._get_Element().getDescendantById("divAtch");d.get_InnerHtml()!=a.sAtts&&g_fDltDrft&&drty();if(!f&&isDf(typeof a.sAtts)){d.set_InnerHtml(a.sAtts);b._initAttachmentDeleteLinks(d);b.resizeAttachmentWell()&&b.safeResizeWells()}else if(isDf(typeof a.sAttLinks)){var g=eval(a.sAttLinks),h=Owa.UIControls.SubPage.get_Instance().getComposeEditor();h._renderInlineImageLinks(g);Owa.UIControls.SubPage.get_Instance().setSubPageVariable("a_fHasInlineImages",true)}var i=a.sIbd;processAttachmentErrorInfobars(i);b.resizeBodyOffset();updateInfobarForUnprotectableAttachments()}}function processAttachmentErrorInfobars(d){if(d){var a=Owa.Dom.Document.get_Current().createElement("div");a.set_InnerHtml(d);var c=a.getDescendantById("divIDA");c&&replaceOrInsertInfobarMessageElement(c);var b=a.getDescendantById("divDAErr");if(b)replaceOrInsertInfobarMessageElement(b);else checkRemoveInfobarMessage("divDAErr");updateInfobarForUnprotectableAttachments();var e=Owa.UIControls.SubPage.get_Instance();e.resizeBodyOffset&&e.resizeBodyOffset();a=0;updateInfobarForUnprotectableAttachments()}else{checkRemoveInfobarMessage("divIDA");checkRemoveInfobarMessage("divDAErr")}}function updateInfobarForUnprotectableAttachments(){var f=$("divAtch");if(isDf(typeof a_fIsIrmProtected)&&a_fIsIrmProtected==0)checkRemoveInfobarMessage("attNtPtbl");else{for(var b=true,d=f.getAllDescendantsById("spnAtmt"),c,a=0;a<d.length;a++)if(d[a].getAttribute("_protectable")=="0"){var e=d[a].getAttribute("_attname");if(b)c=e;else c+=", "+e;b=false}if(isDf(typeof L_AttNtPtbl)&&!b)replaceOrInsertInfobarMessage(L_AttNtPtbl+c+".","attNtPtbl");else checkRemoveInfobarMessage("attNtPtbl")}}function setStckBtn(b,c){var a=wda(b);a&&a._pushed=="1"^c&&a.click()}function getImp(){var a=Owa.Components.ToolbarCollection.get_Current().getButton("imphigh"),b=Owa.Components.ToolbarCollection.get_Current().getButton("implow");return a.get_IsPushed()?I_HI:b.get_IsPushed()?I_LO:I_N}function setImp(c){var a=Owa.Components.ToolbarCollection.get_Current().getButton("imphigh"),b=Owa.Components.ToolbarCollection.get_Current().getButton("implow"),d=a.get_IsPushed(),e=b.get_IsPushed();if(!d&&c==I_HI)a.click();else if(!e&&c==I_LO)b.click();else if(c==I_N){d&&a.click();e&&b.click()}}function replaceOrInsertInfobarMessage(d,b,c){var a=new Owa.UIControls.Infobar($("divInfobar"));return a.buildReplaceOrInsertMessageAndRefresh(d,b,c)}function replaceOrInsertInfobarMessageInCurrentInfobar(a,d,b,c){return a.buildReplaceOrInsertMessageAndRefresh(d,b,c)}function replaceOrInsertInfobarMessageElement(b,a){a=a||Owa.UIControls.SubPage.get_Instance();if(!a._oInfobar)a._oInfobar=a.addResource(new Owa.UIControls.Infobar(a._getDescendant("divInfobar")));a._oInfobar.replaceOrInsertMessage(b);a._oInfobar.set_IsShown(1);a.safeResizeBodies()}function checkRemoveInfobarMessage(b,a){a=a||Owa.UIControls.SubPage.get_Instance();if(!a._oInfobar)a._oInfobar=a.addResource(new Owa.UIControls.Infobar(a._getDescendant("divInfobar")));a._oInfobar.checkRemoveMessageAndRefresh(b)}function getUrl(e,a,d,g,k,i,h,j,f){var c="Item";if(isCal(e)&&(!a||a.lc()=="open"||a.lc()=="reply"||a.lc()=="replyall"||a.lc()=="forward")){c="PreFormAction";if(!a)a="Open"}c=getApplicationElementForItem(c,a,e,isJnkFld(f),g);var b="?ae="+c+"&t="+e+"&"+getIdQS(f);if(d&&d!="")b+="&s="+d;if(a&&a!="")b+="&a="+a;if(g)b+="&ph=0";if(k)b+="&cb=0";if(j)b+="&rr=1";if(g_fDltDrft){g_fDltDrft=0;if(!i)b+="&exdltdrft=1"}b+=h?h:"";return b}function opnPrntFrm(b){var a=getUrl(b,"Print",0,isFhshEnb(),isWBEnb());opnWin(a,0,0,0,0,1)}function isWBEnb(){return crtUrlCntn("&cb=")}function isFhshEnb(){return crtUrlCntn("&ph=")}function crtUrlCntn(a){return location.href.lc().indexOf(a.lc())!=-1}function getItmSt(){return isRepFw()?"":"Draft"}function getItm(c,e,d){try{var a=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController(),b=Owa.PageHierarchy.getVirtualListViewFromSubPageController(a);b.selNPRw(c,e,d)}catch(f){window.close()}}function getAc(){return a_iNit==RF_RPLY?"Reply":a_iNit==RF_FWD?"Forward":a_iNit==RF_PSTRPLY?"PostReply":"Open"}function getIdQS(a){a=a||Owa.UIControls.SubPage.get_Instance();var b="id=";if(a.getSubPageVariable("a_sId"))b+=urlEnc(a.getSubPageVariable("a_sId"));else{var c=a.getSubPageVariable("a_rgsIds");b+=urlEnc(c[0]);for(var d=1;d<c.length;d++)b+="&attid"+(d-1)+"="+urlEnc(c[d]);b+="&attcnt="+(c.length-1)}return b}function shwCnfrmPrDelDlg(a){(new BtnDlg("divDelPmpt",htmlEnc(L_PrDelPrp),"",[L_OK,L_Cncl],400,Owa.BUTTON_DIALOG_ICON.QUESTION,cbCnfrmPrDelDlg,0,0,0,0,0,a)).show()}function cbCnfrmPrDelDlg(b,a){if(b)return;a(1)}function savRMsg(g,h,i,f,a){a=a||Owa.UIControls.SubPage.get_Instance();var d=new oeReq(g,"Save",null,null,POST,null,1);d.add("Id",a.get_ItemId());d.add("CK",a.get_ChangeKey());d.add(h,i);var b=d.send();if(b.fST){popLgn();return}var e=a._getDescendant("divErr");if(b.sErr){b.fST&&popLgn();showErr(e._get_DomNode(),b.sErr,b.sErrDbg,null,a);return 0}else{hideErr(e,a);var c=Owa.Dom.Document.get_Current().createElement("DIV");c=Owa.Dom.Document.get_Current().appendChild(c);c.set_InnerHtml(b.sBody);a.set_ChangeKey(c.getDescendantById("ck").get_TextContent());!f&&rfMailVw(f,1,a);c.remove(true);return 1}}function rfVwAftEdt(b,a){a=a||Owa.UIControls.SubPage.get_Instance();b=b||false;var c=Owa.Pages.ReadFormSubPage.isInstance(a)&&a.get_IsPreview(),d=gtPrntLV(c,a);if(d)rfMailVw(c,!b,a);else rfCalVw(c,a_sId)}var g_fIgnoreNotification=false;function ignoreNotificationOnce(){g_fIgnoreNotification=true}function cancelIgnoreNotificationOnce(a,b){if(g_fIgnoreNotification)g_fIgnoreNotification=false;else!b&&a.throttledRefresh()}var THROTTLED_REFRESH_DURATION=1e3,THROTTLED_REFRESH_DURATION_LONGER=5e3,THROTTLED_REFRESH_DURATION_FOR_EXTERNAL_CALENDAR=3e4;function throttledRefresh(f,g,i,h){var a=this;if(a==window)a=Owa.UIControls.SubPage.get_Instance();if(!a.isSubPageFunctionExists("refresh"))return;if(f&&g_fIgnoreNotification){g_fIgnoreNotification=false;a.invokeSubPageFunction("clearDirtyFlagOnView");return}var b,c;if(g){b="g_iThrottledRefreshPendingForExternalCalendar";c=THROTTLED_REFRESH_DURATION_FOR_EXTERNAL_CALENDAR}else{b="g_iThrottledRefreshPending";var e=isFolderViewSubPageObject(a)?a.get_VirtualListView():null;if(e&&e.isCnvVw&&e.isCnvVw())c=THROTTLED_REFRESH_DURATION_LONGER;else c=THROTTLED_REFRESH_DURATION}if(!a.getSubPageVariable(b)){var d={};d.sSelId=i;d.fForceRefresh=h;d.fIsFromNotification=f;a.setSubPageVariable(b,a._setTimeout(cbThrottledRefreshTimeout,c,d))}}function cbThrottledRefreshTimeout(a){var b=a.sSelId,c=a.fForceRefresh;this.setSubPageVariable("g_iThrottledRefreshPending",0);this.setSubPageVariable("g_iThrottledRefreshPendingForExternalCalendar",0);if(isDf(typeof Owa.Pages.CalendarViewPage)&&Owa.Pages.CalendarViewPage.isInstance(this))this.invokeSubPageFunction("refresh",[b,null,null,null,a.fIsFromNotification]);else this.invokeSubPageFunction("refresh",[b,c])}function cancelPendingThrottledRefresh(a){if(!a)a=Owa.UIControls.SubPage.get_Instance();if(a.getSubPageVariable("g_iThrottledRefreshPending")){clearTimeout(a.getSubPageVariable("g_iThrottledRefreshPending"));a.setSubPageVariable("g_iThrottledRefreshPending",0)}}function removeItemFromView(c){var b=isPrvFrm(),a=gtPrntLV(b);if(a)a.rmvRws(new Array(c));else!a&&rfCalVw(b)}function rfMailVw(d,e,b){b=b||Owa.UIControls.SubPage.get_Instance();var a=gtPrntLV(d,b);if(a&&(!a.getEl||!a.getEl().fDL)){if(a.isCnvVw&&a.isCnvVw()){var c=b.get_SubPageController().get_OpenerController();try{if(d)c.get_ParentController().invokeFunction("refreshConversationRP");else c.invokeFunction("refreshConversationRP")}catch(f){}}else a.get_SubPage().udRP(true);(!e||isWP()||!a.isPushNotificationEnabled())&&a.rfrsh(0)}}function gtPrntLV(f,c){var a=null;c=c||Owa.UIControls.SubPage.get_Instance();try{var d=c.get_SubPageController(),e=d.get_ParentController(),b=d.get_OpenerController();if(f){a=Owa.PageHierarchy.getVirtualListViewFromSubPageController(e);if(!a)a=Owa.PageHierarchy.getVirtualListViewFromSubPageController(b.get_ParentController())}else if(b)a=Owa.PageHierarchy.getVirtualListViewFromSubPageController(b)}catch(g){}return a}function rfCalVw(c,d){try{var a=Owa.Components.SubPageControllerFactory.getControllerByWindow(Owa.Dom.Window.get_Current()),b=c?a.get_ParentController():a.get_OpenerController();b.invokeFunction("throttledRefresh",[false,false,d])}catch(e){}}function setRPRefreshDelayFlag(){var a=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();if(a)try{a.invokeFunction("setRPRefreshDelayFlag")}catch(b){}}function isPrvFrm(){return isDf(typeof a_fPrv)&&a_fPrv}function updIdCkForFR(a){if(!a.divCustom)return;if(!a_sId&&a.divCustom.getAttribute("itemId"))a_sId=a.divCustom.getAttribute("itemId");if(a.divCustom.getAttribute("ck"))a_sCK=a.divCustom.getAttribute("ck")}function showReadingPane(b,d,a){var c=a?a._getDescendant(b):$(b);Owa.Components.SubPageControllerFactory.getControllerByElement(c).set_IsShown(d)}function shwCMMnu(b,g,f){var d=Owa.Components.ToolbarCollection.get(b).getButton("move"),e=d.get_MenuReferencePosition(g_fRtl),a=Owa.UIControls.CopyMoveContextMenu.get_Instance(),c=-1;if(b.get_VirtualListView)c=b.get_VirtualListView().iT;else if(b.sTypeName=="ReadMessagePage")c=0;a.set_CopyItemVisible(!f);a.set_CopyMoveButton(d);a.set_OnTargetFolderSelected(g);a.set_ViewType(c);a.show(e.iX,e.iY)}var L_Dys,L_Dy,L_Hrs,L_Hr,L_Mins,RNGT_NE=0,RNGT_NM=1,RNGT_ED=2,RT_N=1,RT_D=2,RT_W=4,RT_M=8,RT_Y=16,RT_DEWD=256,RT_MTH=512,RT_YTH=1024,RT_RGD=2048,RT_RGW=4096,RT_RGM=8192,RT_RGY=16384,RT_MSK=255,g_iRDW=690,g_fLRC;function rcr(){return a_iRT!=RT_N}function addRcrSt(a,k,h,f,g,j,i,e,c,d,b){a.add("RcrT",k);a.add("RcrI",h);a.add("RcrDys",f);a.add("RcrDy",g);a.add("RcrO",j);a.add("RcrM",i);a.add("RcrRngT",e);a.add("RcrRngS",c);a.add("RcrRngO",d);a.add("RcrRngE",b);return a}function opnWRDV(a){var c=Owa.Dom.Node.wrapDomNode(a),b=Owa.Components.SubPageControllerFactory.getControllerFromParent(c),d=b.get_SubPage();openItm("WebReadyView.aspx?t=att&"+gtAttUrl(a.parentNode.parentNode,1,d))}function clnUp(){var a=new oeReq("EditMessage","CleanupDelete",0,null,POST,null,1);a.add("Id",a_sId);a.add("CK",a_sCK);a.send();a.fST&&popLgn()}var ECPRULEEDITORWIDTH=700,ECPRULEEDITORHEIGHT=420;function opnEcpNewRul(b,d){var c=getEcpVdir()+"/RulesEditor/NewInboxRule.aspx?";c+=d;var a=b.getSubPageVariable("g_EcpRuleEditorWindowInstance");if(a&&!a.is_Closed()){try{a.navigate(c)}catch(e){}a._domWindow.focus()}else b.setSubPageVariable("g_EcpRuleEditorWindowInstance",new Owa.Dom.Window(opnWin(c,ECPRULEEDITORWIDTH,ECPRULEEDITORHEIGHT,1,null,null,null,b)))}function setFcsBdy(b,a){a=a||Owa.UIControls.SubPage.get_Instance();if(Owa.Utility.isIE()||isHtml())a._setTimeout(function(){this._getDescendant("ifBdy").get_ContentWindow()._domWindow.focus()},100);else if(b){var c=createTextRange();c.moveTextAreaCursorToStartOrEnd(a._getDescendant("txtBdy"),1)}else a._getDescendant("txtBdy").focus(1)}function setFcsLstV(){if(g_fFcsLV)try{var a=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();Owa.PageHierarchy.getVirtualListViewFromSubPageController(a).makeFocused()}catch(b){}}function cntFrmNewMsg(c,b){var a=new oeReq("ABCA","MsgToPeople",null,cbCntFrmNewMsg);a.addRg("id",new Array(c));a.add("it",b);a.send()}function cbCntFrmNewMsg(a){if(!onCntFrmOehErr(a))return;openItm(a.sBody)}function cntFrmDel(b){var c=Owa.UIControls.SubPage.get_Instance(),a=c.getSubPageVariable("a_fInDelItms")||a_fP;if(a)(new BtnDlg("divDelPmpt",htmlEnc(b?b:L_PrDelPrp),"",[L_OK,L_Cncl],400,Owa.BUTTON_DIALOG_ICON.QUESTION,cbCntFrmDelPmpt,0,0,0,0,0,a)).show();else cbCntFrmDelPmpt(0,a)}function cbCntFrmDelPmpt(b,c){if(b)return;var a=new oeReq("EditContactItem",c?"PermanentDelete":"Delete",null,cbCntFrmDel);a.add("Id",a_sId);a.send()}function cbCntFrmDel(b){if(!onCntFrmOehErr(b))return;var a=isPrvFrm();Owa.UIControls.SubPage.get_Instance().refreshVirtualListView(true);if(!a){clrDrty();isDf(typeof clrDrtyBdy)&&clrDrtyBdy();window.close()}}function onCntFrmOehErr(a){var b=!!wda("divErr");b&&hideErr(wda("divErr"));if(a.fST)popLgn();else if(a.sErr)if(b)showErr(wda("divErr"),a.sErr,a.sErrDbg);else shwErrDlg(a);else return 1;return 0}function isRcntCtrl(a){return isDf(typeof a_sLV)?cmpVer(a,a_sLV)>=0:1}function cmpVer(d,e){for(var b=spltVer(d),c=spltVer(e),a=0;a<b.length&&a<c.length;a++)if(b[a]!=c[a])return b[a]-c[a];return b.length-c.length}var MM_NtInst=1,MM_MstUpd=2,MM_OOD=4,MM_MstRcnt=8,MM_CIsSSL=16,g_fMmSt=-1,g_oMmBdy=0;function gtMmSt(a){if(g_fMmSt>=0&&!a)return g_fMmSt;if(chkMime())if(isRcntCtrl(gtMmCtrlVer()))g_fMmSt=MM_MstRcnt;else if(isDf(typeof a_fMstUpd)&&a_fMstUpd)g_fMmSt=MM_MstUpd;else g_fMmSt=MM_OOD;else g_fMmSt=MM_NtInst;if(isSSL())g_fMmSt|=MM_CIsSSL;return g_fMmSt}function initMmCtl(){if(!chkMime()||isDf(typeof a_sLV)&&(isFlgSt(gtMmSt(1),MM_NtInst)||isFlgSt(gtMmSt(1),MM_MstUpd)))return;g_oMmBdy=wda("mimeEdit");try{if(!g_oMmBdy||!g_oMmBdy.DOM)g_oMmBdy=0}catch(a){g_oMmBdy=0}}var CTS_LD=1,CTS_SV=2,CTS_SE=3,CTS_SD=4;function showSMErr(c,f,e,a,b,d){var g=mapETS(f,e,a);showErr(c,g,b,d)}function getEvErr(){var a=event.getAttribute("result");return a==null?0:a}function getEvExtErr(){var a=event.getAttribute("extendedResult");return a==null?0:a}function hres(a){return a==0?0:a+4294967295+1}function mapETS(c,b,a){switch(c){case 2148323063:return L_UnsupSig;case 2148077575:return a&1?L_BadSig:a&2?L_NoSigCert:a&256?L_CExp:L_InvldSig;case 3:return L_CSubNotMat;case 2148098052:return L_CSigFail;case 2148139609:return L_MmSzErr;case 2148204809:case 2148204813:return L_CUntruRoot;case 2148204810:return L_CChFail;case 2148204816:return L_CWrUsgFSig;case 2148204801:return L_CExp;case 2148204802:return L_CPerNesErr;case 2148204806:return L_CPurErr;case 2148098073:return L_CBaConErr;case 2148204803:return L_CWrRole;case 2148204815:return L_CNoCNMat;case 2148081680:return L_CCryRev;case 2148081683:case 2148204814:case 2148081682:return L_CRevFail;case 2148204812:return L_CRev;case 2147943623:switch(b){case CTS_LD:return L_ErrDecyp;case CTS_SE:case CTS_SD:return L_NoSmtCdOnSign;default:return""}case 2148323056:return L_ErrDecyp;case 2148532334:return L_SCCancel;case 2148532254:case 2148532253:switch(b){case CTS_LD:return L_NoSmtCdSrvOnDecyp;case CTS_SE:case CTS_SD:return L_NoSmtCdSrvOnSign;default:return""}case 2148077570:return CTS_SE==b?0==(a&1)?0==(a&2)?L_EMisEncAlgSav:L_EMisEncAlgSavFE:0==(a&4)?L_EMisSigAlgSav:L_EMisSigAlgSavFS:CTS_SD==b?0==(a&1)?0==(a&2)?L_EMisEncAlgSnd:L_EMisEncAlgSndFE:0==(a&4)?L_EMisSigAlgSnd:L_EMisSigAlgSndFS:CTS_SV==b?L_SgAlgUnsup:L_EMisAlgLd;case 2148532270:return L_NoSmtCdOnSign;case 0:return"";default:switch(b){case CTS_LD:return L_UkLdErr.replace("{0}",c.toString(16));case CTS_SV:return L_UkSvErr.replace("{0}",c.toString(16));case CTS_SE:return L_UkSaErr.replace("{0}",c.toString(16));case CTS_SD:return L_UkSdErr.replace("{0}",c.toString(16));default:return""}}}function ldMsgMm(c,b){if(g_oMmBdy){var a=new oeReq("","",b,cbLdMsgMm,GET);a.sUrl="?ae=Item&a=GetMime&"+c;a.send();shwMLPrgrsInd(L_SMLd,1)}}var g_sMimeBlob=null;function cbLdMsgMm(a){if(!cbOeh(a))return hdPrgrsInd();if(g_oMmBdy){g_sMimeBlob=a.oXmlHttp.responseBody;g_oMmBdy.decodeMime(g_sMimeBlob);a.oCtx&&a.oCtx()}hdPrgrsInd()}function shMmBdy(e){var b=edDoc(1),a=b.get_Body(),c=Owa.UIControls.SubPage.get_Instance(),g=Owa.Utility.createWindowResizeHandler(Owa.Dom.Window.get_Current(),c._createCallback(c.safeResizeBodies));a.setBoolAttribute("ocsi",false);if(e)c._initializeIFrameBodyEditor(b,a,g);else c._initializeIFrameBodyReader(b,a,g);if($("divEcm")&&!Owa.Utility.isGreaterThanIE9UsingTrident()){a.attachEvent("contextmenu",onCMEd);b.get_ContainerWindow().attachEvent("scroll",onEdWScr)}if(e&&isRichTextEditorSupported()){a.attachEvent("paste",onPste);if(isSpC()){a.attachEvent("cut",onPste);a.attachEvent("dragstart",onPste);a.attachEvent("dragend",onPste)}}var f=$("divFmtBr");if(e&&f&&isFormatBarInitialized(f)){var d=c.getComposeEditor();d._oEditor=b;b.setExpando("formatBar",d);d._attachContentWindowEvents();d._applyEditorStyles()}a.attachEvent("dragover",new Function("return(false)"));showEm(g_oMmBdy)}function gtSgnErCt(a){switch(a){case 0:return 0;case 2148081683:case 2148204814:case 2148204801:return 1;case 2148098052:case 2148204809:case 2148204813:case 2148204810:case 2148204816:case 2148204802:case 2148204806:case 2148098073:case 2148204803:case 2148204815:case 2148081680:case 2148204812:return 2;default:return 2}}function shwMLPrgrsInd(b,a){if(g_oDlgPrgInd)return;if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}if(!isDf(typeof a_fPrv)||a_fPrv==0)g_iPrgIndTmId=setTimeout('cbShwPrgrsInd("'+b+'", 1)',a?a:g_iPrgIndDly);else{var c=wt(),d=window.screenLeft-c.screenLeft+document.body.clientWidth/3,e=window.screenTop-c.screenTop+document.body.clientHeight/3;g_iPrgIndTmId=setTimeout('cbShwPrgrsInd("'+b+'", 1, '+d+", "+e+")",a?a:g_iPrgIndDly)}}function dltSmAtt(c){g_oMmBdy.attachments.remove(c._idx);var a=getAIs(g_oMmBdy.attachments,g_oAP,g_oMI,AWT_RW,a_fEnIL);a&&rdAttWl(a,AWT_RW,g_oMI,g_oAP,wda("divAtch"),true);drty();var b=Owa.UIControls.SubPage.get_Instance();b.resizeAttachmentWell();updateInfobarForUnprotectableAttachments()}function opnShrDlgInVw(b,c){try{if(isStPg()){window.parent.opnShrDlg();return}}catch(d){}var a;switch(c){case BID_OPNCAL:a=NM_CAL;break;case BID_OPNCNT:a=NM_CTS;break;case BID_OPNTSK:a=NM_TSK}(new Owa.UIControls.OpenOtherFolderInView(b)).clickButton(a)}function openSharingCalendarRequestForm(){(new Owa.UIControls.OpenOtherFolderInView).requestSharingCalendar()}function hideOpenMailboxDialog(){try{if(isStPg()){window.parent.hideOpenMailboxDialog();return}}catch(a){}}function getCalClrSS(e,d){for(var b=e.styleSheets,c,a=0;a<b.length;a++)if(b[a].href.indexOf(d)>=0){c=b[a];break}return c}function applyCalStyle(d,f){var a=getInt(f);if(a<0)return;var g=a<10?"0"+a:""+a,c="calclr"+g,e=c+".css",b=getCalClrSS(d.get_Document()._get_DomDocument(),c);if(!b)b=d.get_Document().importStyleSheet(getRsrcF(e))}if(document.implementation&&document.implementation.createDocument&&!Owa.Utility.isIE()){Document.prototype.createNode=function Document$createNode(c,a,b){switch(c){case 1:return b==""?this.createElement(a):this.createElementNS(b,a);case 2:return this.createAttribute(a);case 3:return this.createTextNode("");case 11:return this.createDocumentFragment();default:throw"Node type not supported";}};if(document.implementation.hasFeature("XPath","3.0")){Document.prototype.selectNodes=function Document$selectNodes(f,b){if(!b)b=this;for(var e=this.createNSResolver(this.documentElement),d=this.evaluate(f,b,e,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),c=[],a=0;a<d.snapshotLength;a++)c[a]=d.snapshotItem(a);return c};Element.prototype.selectNodes=function Element$selectNodes(a){if(this.ownerDocument.selectNodes)return this.ownerDocument.selectNodes(a,this)};Document.prototype.selectSingleNode=function Document$selectSingleNode(c,a){if(!a)a=this;var b=this.selectNodes(c,a);return b.length>0?b[0]:null};Element.prototype.selectSingleNode=function Element$selectSingleNode(a){if(this.ownerDocument.selectSingleNode)return this.ownerDocument.selectSingleNode(a,this)}}Document.prototype.preserveWhiteSpace=1;if(Node.prototype.__defineGetter__){Node.prototype.__defineGetter__("xml",_Node_getXML);Node.prototype.__defineGetter__("text",_Node_getText);Node.prototype.__defineSetter__("text",_Node_setText)}else{Object.defineProperty(Node.prototype,"xml",{"get":function(){return _Node_getXML()}});Object.defineProperty(Node.prototype,"text",{"get":function(){return _Node_getText()},"set":function(a){_Node_setText(a)}})}}function _Node_getXML(){var a=new XMLSerializer;return a.serializeToString(this)}function _Node_getText(){return this.textContent}function _Node_setText(a){this.textContent=a}function fillHeight(b,c){var a=god(b).body.offsetHeight-b.offsetTop;if(c!=null)a=a-c.offsetHeight;if(a<0)a=0;b.style.height=a+"px"}function positionRelative(a){if(!a.oOriginalParent)return;var b=getRelativePosition(a);a.style.left=b.iX+"px";a.style.top=b.iY+"px"}function getRelativePosition(a){var c=getCX(a.oOriginalParent)+a.iOriginalX-getCX(a.parentNode),d=getCY(a.oOriginalParent)+a.iOriginalY-getCY(a.parentNode);if(a.parentNode!=a.ownerDocument.body){var b=Owa.Dom.Node.wrapDomNode(a.parentNode);c+=b.get_ScrollLeft();d+=b.get_ScrollTop()}return new Point(c,d)}function makeBodyPositioned(a){var c=null;if(Owa.Dom.Node.isInstance(a)){c=a;a=a._get_DomNode()}else if(a)c=Owa.Dom.Node.wrapDomNode(a);if(!a||a.iOriginalX)return;a.oOriginalParent=a.parentNode;a.iOriginalX=a.offsetLeft;a.iOriginalY=a.offsetTop;a.style.zIndex=a.parentNode.style.zIndex+100;a.style.zIndex=a.parentNode.runtimeStyle?a.parentNode.runtimeStyle.zIndex+100:window.getComputedStyle(a.parentNode,"").getPropertyValue("z-index");var b=c.get_ParentElement();while(b)if(Owa.Dom.Element.isInstance(b)&&(b.get_OverflowX()==Owa.Style.Overflow.Scroll||b.get_OverflowX()==Owa.Style.Overflow.Auto||b.get_OverflowY()==Owa.Style.Overflow.Scroll||b.get_OverflowY()==Owa.Style.Overflow.Auto))break;else{b=b.get_ParentElement();if(b&&b.get_TagName().toLowerCase()=="body")break}if(b)b.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,c);else god(a).body.appendChild(a);positionRelative(a)}function renderBposHeaderLinks(c){if(c!=null){var b=$("divBrandLinkArea");if(b!=null){if(b._get_DomNode().getElementsByTagName("a").length>0)return;var f=Owa.Dom.Document.get_Current();for(var d in c){var a=f.createElement("a"),e=c[d];if(e!=""){a.set_CssClasses(["brandBarLink"]);a.setAttribute("href",e)}else a.set_CssClasses(["brandBarLink","brandBarDisabledLink"]);a.set_TextContent(d);b.appendChild(a)}}}}function initCalInforbarDashImage(){var b=$("imgDash"),a=$("divCalendarInfobarMessage");a&&b&&b.set_Margin(Owa.Style.Side.Top,(a.get_OffsetHeight()-b.get_OffsetHeight())/2-a._getEffectivePadding(Owa.Style.Side.Top,true))}isDf(typeof stJS)&&stJS("uglobal.js")^#Is      YDeYDe>+Y   B    :https://mail.logica.com/owa/14.3.319.2/scripts/premium/uglobal.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAVPMIIFSzCCBDOgAwIBAgIQC9oUlvTJTE7TC0j08zttrDANBgkqhkiG9w0BAQsFADBwMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNzdXJhbmNlIFNlcnZlciBDQTAeFw0xNzA4MTgwMDAwMDBaFw0xODEwMDExMjAwMDBaMF4xCzAJBgNVBAYTAkdCMRAwDgYDVQQHEwdSZWFkaW5nMRcwFQYDVQQKEw5Mb2dpY2EgTGltaXRlZDENMAsGA1UECxMERUlJUzEVMBMGA1UEAwwMKi5sb2dpY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzuYMsuU3piAX99KZg+15ZU9OKmiMfNCWme5/Iz8Agp2MxYMF4mLUcfss1x5fB0mMY+KvwAyfSyor56jR7dy3NKMreZRH1Q/YeFQW5MMs7paDof2KI5PtBspIXbQag6WYYtW10v/lkd+as+VD6jyhfU6+osD9HrbIK5dxToF6mfJqk/ky8nwphaA2FHoRKTdAMiQh9RS5IYKDzeaoPxLy+M+qvME3urniOQqd9Od7sqG4ml+wqS7+xB7UAl+ochD4A/rwewdhccwt91RNkn1E4j1RaZ6FYcuszvBcYih+m1wcQn/ACTrAAWV+ziST2h7LfUmEtMPVQ4swHYI8diuPfQIDAQABo4IB8TCCAe0wHwYDVR0jBBgwFoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKinxbIi/V/Ey/fqtiPTDEcBOGc5MCMGA1UdEQQcMBqCDCoubG9naWNhLmNvbYIKbG9naWNhLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwTAYDVR0gBEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwgYMGCCsGAQUFBwEBBHcwdTAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEySGlnaEFzc3VyYW5jZVNlcnZlckNBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQBQjp60tISk4788ERXDdQQKXRiEr75a1DYfG2ouVr/8OYlwgS5AwIEapDT7vqli2n3LbeeVgzUz2cZm9Bc/WjyYmSRlZtFYoSn6muFvYOjr0v5aiJXyFdz03emn93quN95xu4MnDmqoBsxEvyOHgO7TXhnpmO/aF9jA01L7SLfZI5TvVaOGQ2vAU6h5cOdXp18nuJGk+o1274scCkBK60dJwRaUtz7zMp2vr3FpOfvLqpkzBkUC8Iv0sXVfPgZFINyMTDW14QAbzWSsbr3EQEJ7ioAqjEBsScJjGFk5V+GDpyz3z9nLjoM/fWKl7sS5Z9VaztyzpEvomyQsd6sZPdubAC8AAwAAAAABAQAA request-method GET response-head HTTP/1.1 200 OK
Content-Length: 984109
Date: Thu, 07 Sep 2017 11:14:32 GMT
Content-Type: application/x-javascript
Etag: "059939a59d21:0"
Accept-Ranges: bytes
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:42 GMT
X-Powered-By: ASP.NET
 original-response-headers Connection: Keep-Alive
Content-Length: 984109
Date: Thu, 07 Sep 2017 11:14:32 GMT
Content-Type: application/x-javascript
Etag: "059939a59d21:0"
Accept-Ranges: bytes
Set-Cookie: CAS_LB_Service=R3418549887; path=/
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:42 GMT
X-Powered-By: ASP.NET
 uncompressed-len 0  -