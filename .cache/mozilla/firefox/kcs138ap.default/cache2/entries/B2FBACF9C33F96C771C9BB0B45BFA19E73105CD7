var g_fModuleLoaded={};!g_fModuleLoaded[".\\uicontrols/itempart.js".toLowerCase()]&&(function(){var D=Owa.Dom.Node,f=Owa.Dom.Document,C=Owa.Dom.Window,x=1,y=2,t=4,e=16,g=x|y,A=10,v=20,s=2,m=3,u=4,B=8,w="ReadConversation",n="ReadMessage",l="__OWA_FLT000__".toLowerCase(),h="__OWA_DEFERIMG000__".toLowerCase(),d=15,a=0,q=100,o=10,k=2,i=500,c=0,b=100,r=100,p=50,j=10,z=500;Owa.UIControls.ItemPart=function Owa$UIControls$ItemPart(b,a){Owa.UIControls.ItemPart.constructBase(this,[b,a]);this._sItmId=this._getAttribute("sItmId");this._fLocal=this._getIntAttribute("fLocal");this._sCK=this._getAttribute("sCK");this._sT=this._getAttribute("sT");this._fExp=this._getIntAttribute("fExp");this.sFId=this._getAttribute("sFId");this._sPId=this._getAttribute("sPId");this.fR=this._getIntAttribute("fR");this.iImgFlt=this._getIntAttribute("iImgFlt");this.fSup=this._getIntAttribute("fSup");this.fOlk=this._getIntAttribute("fOlk");this.fReadRcp=this._getIntAttribute("fReadRcp");this.fDraft=this._getIntAttribute("fDraft");this.fPhishing=this._getIntAttribute("fPhsh");this._fInJunkFolder=this._getIntAttribute("fJnk");this.fMeetingRequest=this._getIntAttribute("fMR");this.fResponseRequested=this._getIntAttribute("fRR");this._iInternetMId=this._getIntAttribute("iInternetMId");this._fInArchiveMailbox=this._getIntAttribute("fArchive");this.fReplyRestricted=this._getIntAttribute("fRplR");this.fReplyAllRestricted=this._getIntAttribute("fRAR");this.fForwardRestricted=this._getIntAttribute("fFR");this.fCopyRestricted=this._getIntAttribute("fCR");this.fPrintRestricted=this._getIntAttribute("fPR");this.fRemoveRestriction=this._getIntAttribute("fRmR");this._fSel=false;this._fPendingAlignWellTitles=false;this._fExpansionInitialized=false};Owa.UIControls.ItemPart.create=function Owa$UIControls$ItemPart$create(a,b){var c=a.getAttribute("sT");return c==Owa.Strings.ObjectClass.MeetingRequest||c==Owa.Strings.ObjectClass.MeetingCancellation?new Owa.UIControls.MeetingItemPart(a,b):c.startsWith(Owa.Strings.ObjectClass.MeetingResponsePrefix)?new Owa.UIControls.MeetingResponseItemPart(a,b):c==Owa.Strings.ObjectClass.SharingMessage?new Owa.UIControls.SharingItemPart(a,b):new Owa.UIControls.ItemPart(a,b)};Owa.UIControls.ItemPart.prototype.initialize=function Owa$UIControls$ItemPart$initialize(){Owa.UIControls.ItemPart.callBase(this,"initialize");if(this.get_IsExpanded()){this.initializeExpansion();this._fEverCollapsed=false}else{this.initHdr(this._get_Element().getChildById("divClps"));this._fEverCollapsed=true}this._attachEvent(this._get_Element().getChildById("imgEC"),"click",this.onClkEC);this._attachEvent(this._get_Element().getChildById("divClps"),"click",this.onClkClps);this._attachEvent(this._get_Element().getChildById("divClps"),"contextmenu",this.onContextMenu);this._attachEvent(this._getDescendant("divClps"),"mouseover",this.onItemHover);this._attachEvent(this._getDescendant("divClps"),"mouseout",this.onItemHover);this._attachEvent(this._getDescendant("imgEC"),"mouseover",this.onItemHover);this._attachEvent(this._getDescendant("imgEC"),"mouseout",this.onItemHover)};Owa.UIControls.ItemPart.prototype.initHdr=function Owa$UIControls$ItemPart$initHdr(a){var b=a.getDescendantById("divInfIc"),g=v*b._get_DomNode().childNodes.length;b.set_Width(g);var d=a.getDescendantById("divSm");if(d){if(!g_fRtl){var o=b.get_Right()+g+5;d.set_Right(o)}else{var n=b.get_Left()+g+5;d.set_Left(n)}if(this.fDraft){var i=a.getDescendantById("divSn");if(i){if(!this._get_Parent()._iSpanItemNotSentWidth)this._get_Parent()._iSpanItemNotSentWidth=a.getDescendantById("spnItemNotSent").get_OffsetWidth();if(!g_fRtl){var n=i.get_Left()+this._get_Parent()._iSpanItemNotSentWidth+20;d.set_Left(n)}else{var o=i.get_Right()+this._get_Parent()._iSpanItemNotSentWidth+20;d.set_Right(o)}}}if(Owa.Utility.isSafari()&&!Owa.Utility.isChrome()){d.set_Top(2);a.getDescendantById("divSn").set_Padding(Owa.Style.Side.Top,4);b.set_Top(1);a.getDescendantById("divDt").set_Padding(Owa.Style.Side.Top,6)}}var k=a.getDescendantById("spnActions"),j=a.getDescendantById("divExpHdr");if(k&&j){if(!this._get_Parent()._iActionsW){var h=f.get_Current().createElement("span");h.set_TextContent(k.get_TextContent());j.appendChild(h);this._get_Parent()._iActionsW=h._get_DomNode().offsetWidth;h.remove(true)}var m=this._get_Parent()._iActionsW+12,p=a.getDescendantById("divActions");p.set_Width(m);var c=m+20,e=a.getDescendantById("divActionIcons");if(e){if(!g_fRtl)e.set_Right(c);else e.set_Left(c);c+=e.get_Width()+14}var b=a.getDescendantById("divInfIc");if(b){if(!g_fRtl)b.set_Right(c);else b.set_Left(c);c+=g}var l=a.getDescendantById("divSn");if(!g_fRtl)l.set_Right(c);else l.set_Left(c)}};Owa.UIControls.ItemPart.prototype.dispose=function Owa$UIControls$ItemPart$dispose(){if(!this.get_IsDisposed()){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}this._fExpansionInitialized&&this.disposeExpansion();this._get_Element().getChildById("imgEC").dispose();this._get_Element().getChildById("divClps").dispose();this.oPrv=0;this.oNxt=0;Owa.UIControls.ItemPart.callBase(this,"dispose")}};Owa.UIControls.ItemPart.prototype.initializeExpansion=function Owa$UIControls$ItemPart$initializeExpansion(){this.initPrsnc();var f=this._get_Element().getChildById("divExp"),d=this._getDescendant("divExpHdr");this._attachEvent(f,"click",this.onClkExp);this._attachEvent(f,"contextmenu",this.onContextClick);this._attachEvent(d,"dblclick",this.onDblClkExp);this._attachEvent(d,"mouseover",this.onItemHover);this._attachEvent(d,"mouseout",this.onItemHover);this._attachEvent(this._getDescendant("divActions"),"click",this.onContextClick);this._initializeActionButtons();var j=this._getDescendant("divBrTxt"),b=this._getDescendant("divBrTxtOnExpansion");if(j&&b){var g=j.get_InnerHtml();g&&b.set_InnerHtml(g)}if(b){var i=b.getDescendantById("spnBrSn");i&&this._attachEvent(i,"click",this.onClkBr)}var c=new Owa.UIControls.Infobar(this._getDescendant("divInfobar"));c.set_SubPage(this.get_SubPage());if(this.fOlk)replaceOrInsertInfobarMessageInCurrentInfobar(c,this._get_Parent().L_OpnInOlk,"divOpnOlk");else if(!this.fSup){var l=replaceOrInsertInfobarMessageInCurrentInfobar(c,this._get_Parent().L_TypeNotSup,"divNotSup");a=l.getDescendantById("aIbNotSup");this._attachEvent(a,"click",this.openItemPart)}if(this.fReadRcp){var k=replaceOrInsertInfobarMessageInCurrentInfobar(c,this._get_Parent().L_ReadRcp,"divReadRcp");a=k.getDescendantById("aIbReadRcp");this._attachEvent(a,"click",this.onReadRcp)}this.loadDeferredImages();this.initImgFlt();if(this.fPhishing){var a=this._getDescendant("aIbBlk");a&&this._attachEvent(a,"click",this._onClickDisablePhishing)}if(this.fRemoveRestriction){var a=this._getDescendant("aIbRR");a&&this._attachEvent(a,"click",this._onClickRemoveRestriction)}var h=this._getDescendant("divPrtBk");h&&h.removeCssClass("divPrtBkSel");this.initHdr(f);this._get_Parent().fixPrts(e);this._fExpansionInitialized=true};Owa.UIControls.ItemPart.prototype._initializeActionButtons=function Owa$UIControls$ItemPart$_initializeActionButtons(){var a=this._getDescendant("divActionIcons");if(!a)return;this._oActionButtons=new Owa.UIControls.ActionButtons(a,Owa.Utility.createArgumentContextDelegate(this,this.onActionButtonsClick),true,null,!this.get_IsSelected());this.fReplyRestricted&&this._oActionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.REPLY);this.fReplyAllRestricted&&this._oActionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.REPLY_ALL);this.fForwardRestricted&&this._oActionButtons.setActionAlwaysDisabled(Owa.UIControls.ActionButtons.FORWARD)};Owa.UIControls.ItemPart.prototype.onActionButtonsClick=function Owa$UIControls$ItemPart$prototype$onActionButtonsClick(a){this._get_Parent().onClkItemPart(this,a.oEvent);this._get_Parent().onActionButtonsClick(a.sAction);a.oEvent.preventDefault();a.oEvent.cancelBubble();return};Owa.UIControls.ItemPart.prototype.get_ActionButtons=function Owa$UIControls$ItemPart$get_ActionButtons(){return this._oActionButtons};Owa.UIControls.ItemPart.prototype.disposeExpansion=function Owa$UIControls$ItemPart$disposeExpansion(){this._get_Element().getChildById("divExp").dispose();this._getDescendant("divExpHdr").dispose();this._oActionButtons&&this._oActionButtons.dispose();var c=this._getDescendant("divBrTxtOnExpansion");if(c){var b=c.getDescendantById("spnBrSn");b&&b.dispose()}if(!this.fSup){var a=this._getDescendant("aIbNotSup");a&&a.dispose()}if(this.fReadRcp){var a=this._getDescendant("aIbReadRcp");a&&a.dispose()}this._getDescendant("divActions").dispose();var a=this._getDescendant("aIbBlk");a&&a.dispose()};Owa.UIControls.ItemPart.prototype.initPrsnc=function Owa$UIControls$ItemPart$initPrsnc(){if(!g_fIsIMEnab)return;var d=this._get_Element().getChildById("divExp"),c=d.getDescendantById("spnFrom");c&&updRSpnPrsnc(c,this.get_SubPage());for(var b=[TO,CC,BCC],a=0;a<b.length;a++){var e=d.getDescendantById(b[a]);e&&updRwPrsnc(e,this.get_SubPage())}};Owa.UIControls.ItemPart.prototype.loadDeferredImages=function Owa$UIControls$ItemPart$loadDeferredImages(){for(var f=this._get_Element().getDescendantById("divBdy"),g=false,e=f.getDescendantsByTagName("IMG"),b=0;b<e.length;b++){var c=e[b],a=c.getAttribute("src");if(!a)continue;var d=a.toLowerCase().indexOf(h);d>=0&&c.setAttribute("src",a.substring(d+h.length))}};Owa.UIControls.ItemPart.prototype.initImgFlt=function Owa$UIControls$ItemPart$initImgFlt(){for(var j=this._get_Element().getDescendantById("divBdy"),e=false,g=j.getDescendantsByTagName("IMG"),d=0;d<g.length;d++){var a=g[d],c=a.getAttribute("src");if(!c)continue;var f=c.toLowerCase().indexOf(l);if(f>=0){a.setAttribute("_src",c.substring(f+l.length));if(this.iImgFlt==m){a.setAttribute("src",a.getAttribute("_src"));a.set_BorderWidth(Owa.Style.Side.Top,0);a.set_BorderWidth(Owa.Style.Side.Bottom,0);a.set_BorderWidth(Owa.Style.Side.Left,0);a.set_BorderWidth(Owa.Style.Side.Right,0)}else{a.setAttribute("src",getRsrcF("clear1x1.gif"));e=true}}}var b=new Owa.UIControls.Infobar(this._getDescendant("divInfobar"));b.set_SubPage(this.get_SubPage());if(e)if(this.iImgFlt==u){var h=replaceOrInsertInfobarMessageInCurrentInfobar(b,this._get_Parent().L_ImgFltBlock,"divImgFlt"),i=h.getDescendantById("aIbBlk");this._attachEvent(i,"click",this.onClkImgFlt)}else this.iImgFlt==s&&replaceOrInsertInfobarMessageInCurrentInfobar(b,this._get_Parent().L_ImgFltCompBlock,"divImgFlt")};Owa.UIControls.ItemPart.prototype.fixPrtSz=function Owa$UIControls$ItemPart$fixPrtSz(){var b=this._get_Parent()._getDescendant("divItmPrts").get_ClientWidth(),a=30;this._get_Element().set_Width(g_fRtl?b-a:null);if(!this.get_IsExpanded())return;var j=this._get_Element().getChildById("divExp"),g=j.getChildById("divExpHdr"),h=j.getChildById("divRws"),d=this._getDescendant("divWellAttach"),c=this._getDescendant("divWellCategories"),f=this._getDescendant("divInfobar"),e=this._getDescendant("divExpSubHdr");g&&g.set_Width(null);h&&h.set_Width(null);d&&d.set_Width(null);c&&c.set_Width(null);f&&f.set_Width(null);e&&e.set_Width(null);var i=this._get_Element().getChildById("divExp").getChildById("divBdy");if(i.get_ScrollWidth()>i.get_ClientWidth()){this._get_Element().set_Width(i.get_ScrollWidth()+20);g&&g.set_Width(b-13-a);h&&h.set_Width(b+2-a);d&&d.set_Width(b+2-a);c&&c.set_Width(b+2-a);f&&f.set_Width(b-13-a);e&&e.set_Width(b-10-a)}};Owa.UIControls.ItemPart.prototype.onReadRcp=function Owa$UIControls$ItemPart$onReadRcp(){var a=new oeReq("ReadMessage","SRR",0,Owa.Utility.createDelegate(this,this.cbReadRcp));a.add("Id",this.get_Id());a.send()};Owa.UIControls.ItemPart.prototype.cbReadRcp=function Owa$UIControls$ItemPart$cbReadRcp(a){if(this.get_IsDisposed())return;if(!cbOeh(a)){shwErrDlg(a);return}var b=this._getDescendant("aIbReadRcp");if(b){b.detachAllEvents();this.fReadRcp=false}var c=this._get_Element().getDescendantById("divReadRcp");c.set_InnerHtml(a.sBody)};Owa.UIControls.ItemPart.prototype._onClickDisablePhishing=function Owa$UIControls$ItemPart$prototype$_onClickDisablePhishing(){var a=new oeReq(n,"Save",0,Owa.Utility.createDelegate(this,this.cbDisablePhishing),POST);a.add("Id",this.get_Id());a.add("CK",this._sCK);this.fPhishing&&a.add("StLnkEnbl",1);a.send()};Owa.UIControls.ItemPart.prototype._onClickRemoveRestriction=function Owa$UIControls$ItemPart$prototype$_onClickRemoveRestriction(){var a=new oeReq("ReadMessage","RMR",0,Owa.Utility.createDelegate(this,this.cbRemoveRestriction));a.add("Id",this.get_Id());a.send()};Owa.UIControls.ItemPart.prototype.cbRemoveRestriction=function Owa$UIControls$ItemPart$cbRemoveRestriction(a){if(!cbOeh(a)){shwErrDlg(a);return}this._get_Parent().rfrsh()};Owa.UIControls.ItemPart.prototype.onClkImgFlt=function Owa$UIControls$ItemPart$onClkImgFlt(){if(this.get_IsDisposed())return;var b=new oeReq(n,"Save",0,Owa.Utility.createDelegate(this,this.cbImgFlt),POST);b.add("Id",this.get_Id());b.add("CK",this._sCK);b.add("AlWbBcn",1);this.fPhishing&&b.add("StLnkEnbl",1);b.send();this.iImgFlt=m;for(var i=this._get_Element().getDescendantById("divBdy"),f=i.getDescendantsByTagName("IMG"),d=0;d<f.length;d++){var a=f[d];if(a.getAttribute("src")){a.setAttribute("src",a.getAttribute("_src"));a.set_BorderWidth(Owa.Style.Side.Top,0);a.set_BorderWidth(Owa.Style.Side.Bottom,0);a.set_BorderWidth(Owa.Style.Side.Left,0);a.set_BorderWidth(Owa.Style.Side.Right,0)}}var c=new Owa.UIControls.Infobar(this._getDescendant("divInfobar")),h=c.getMessageById("divImgFlt");c.set_SubPage(this.get_SubPage());c.removeMessage(h);this.get_SubPage().safeResizeBodies();this._get_Parent().fixPrts(g|e);Owa.MessageCache.removeMessage(this._get_Parent().sCnvId)};Owa.UIControls.ItemPart.prototype.cbDisablePhishing=function Owa$UIControls$ItemPart$cbDisablePhishing(a){if(!cbOeh(a)){shwErrDlg(a);return}this._get_Parent().rfrsh()};Owa.UIControls.ItemPart.prototype.cbImgFlt=function Owa$UIControls$ItemPart$cbImgFlt(b){if(!cbOeh(b)){shwErrDlg(b);return}var a=f.get_Current().createElement("div");f.get_Current().appendChild(a);a.set_InnerHtml(b.sBody);var c=a.getChildById("ck");this._sCK=c.get_TextContent();a.remove(true)};Owa.UIControls.ItemPart.prototype._onBeforeUnload=function Owa$UIControls$ItemPart$prototype$_onBeforeUnload(){};Owa.UIControls.ItemPart.prototype.onClkBr=function Owa$UIControls$ItemPart$onClkBr(){var a=new Array(this.get_ParentId());this._get_Parent().setSel(a,0,1);this._get_Parent().scrTo(this.get_ParentId())};Owa.UIControls.ItemPart.prototype.onClkEC=function Owa$UIControls$ItemPart$onClkEC(b){var a=this.get_IsExpanded();if(this.get_IsSelected()){this.exp(a);this._get_Parent().onTouchItemPart(this)}else{this._get_Parent().onClkItemPart(this,b);this.exp(a)}};Owa.UIControls.ItemPart.prototype.onClkClps=function Owa$UIControls$ItemPart$onClkClps(a){this._get_Parent().onClkItemPart(this,a)};Owa.UIControls.ItemPart.prototype.onDblClkExp=function Owa$UIControls$ItemPart$onDblClkExp(a){if(this._oDblClkTimer){this._clearTimeout(this._oDblClkTimer);this._oDblClkTimer=null;this.openItemPart()}a.preventDefault();a.cancelBubble()};Owa.UIControls.ItemPart.prototype._onClkExpHdrCb=function Owa$UIControls$ItemPart$_onClkExpHdrCb(){this.get_IsSelected()&&this.exp(true)};Owa.UIControls.ItemPart.prototype.onClkExp=function Owa$UIControls$ItemPart$onClkExp(d){var c=d.get_Target(),a=Owa.Strings.Ids,b=false;while(c!=null&&c.get_Id()!=a.ItemPartExpansion){switch(c.get_Id()){case a.AttachmentLink:case a.BranchText:b=true;break;case a.FromSpan:case a.RecipientSpan:case a.ReplyIcon:case a.ReplyAllIcon:case a.ForwardIcon:b=this.get_IsSelected();break;case a.ItemPartExpansionHeader:if(this.get_IsSelected()){this._oDblClkTimer&&this._clearTimeout(this._oDblClkTimer);this._oDblClkTimer=this._setTimeout(this._onClkExpHdrCb,300);b=true}break;case a.ItemPartDraftSpan:case a.ItemPartItemNotSentSpan:this.openItemPart();b=this.get_IsSelected()}if(b){d.preventDefault();d.cancelBubble();return}c=c.get_ParentElement()}this._get_Parent().onClkItemPart(this,d)};Owa.UIControls.ItemPart.prototype._isPartOfItemHoverTargets=function Owa$UIControls$ItemPart$_isPartOfItemHoverTargets(b){if(!b)return false;var a;if(this.get_IsExpanded())a=this._getDescendant("divExpHdr");else a=this._getDescendant("divClps");var c=this._getDescendant("imgEC");return b.equals(a)||b.equals(c)||a.contains(b)};Owa.UIControls.ItemPart.prototype._doBackgroundFading=function Owa$UIControls$ItemPart$_doBackgroundFading(d){var g=(new Date).getTime()-d.iStartTime>i,a,e=false;if(this.fBkgdFadingOut){a=d.iCurOpacity-j;if(g||a<c)a=c;e=a>c}else{a=d.iCurOpacity+j;if(g||a>b)a=b;e=a<b}try{d.oSelHdr.set_Opacity(a)}catch(l){e=false}d.iCurOpacity=a;if(e)this._oBkgdFadingTimer=this._setTimeout(this._doBackgroundFading,p,d);else{this._oBkgdFadingTimer=null;if(this.fBkgdFadingOut){var f;if(this.get_IsExpanded()){var k=this._getDescendant("divExp");f=k.getChildById("divPrtBk")}else var h=this._getDescendant("divClps"),f=h.getChildById("divPrtBk");f&&f.removeCssClass("divPrtBkSel")}this.fBkgdFadingOut=!this.fBkgdFadingOut}};Owa.UIControls.ItemPart.prototype._doIconsAnimation=function Owa$UIControls$ItemPart$_doIconsAnimation(b){var f=(new Date).getTime()-b.iStartTime>i;if(b.fStartingAnimation){b.oReplyIcon.set_IsShown(true);b.oForwardIcon.set_IsShown(true);b.fStartingAnimation=false}var c,e=false;if(this.fIconsFadingOut){c=b.iCurPosition+k;if(f||c>d)c=d;e=c<d}else{c=b.iCurPosition-k;if(f||c<a)c=a;e=c>a}if(!g_fRtl){b.oReplyIcon.set_Left(c);b.oForwardIcon.set_Right(c)}else{b.oReplyIcon.set_Right(c);b.oForwardIcon.set_Left(c)}b.iCurPosition=c;if(e)this._oIconsAnimationTimer=this._setTimeout(this._doIconsAnimation,o,b);else{this._oIconsAnimationTimer=null;if(this.fIconsFadingOut){var g=this._getDescendant("divExp"),j=g.getDescendantById(Owa.Strings.Ids.ReplyIcon);j.set_IsShown(false);var h=g.getDescendantById(Owa.Strings.Ids.ForwardIcon);h.set_IsShown(false)}this.fIconsFadingOut=!this.fIconsFadingOut}};Owa.UIControls.ItemPart.prototype.onItemHover=function Owa$UIControls$ItemPart$onItemHover(a){if(this._shouldProcessHoverEvent(a)){var b=a.get_Type();this._startBackgroundFadingAnimation(b);this.get_IsExpanded()&&this._startIconsSlidingAnimation(b)}a.preventDefault();a.cancelBubble();return};Owa.UIControls.ItemPart.prototype._startBackgroundFadingAnimation=function Owa$UIControls$ItemPart$prototype$_startBackgroundFadingAnimation(f){var e;if(this.get_IsExpanded())e=this._getDescendant("divExp");else e=this._getDescendant("divClps");var d=e.getChildById("divPrtBk");if(d){this.fBkgdFadingOut=f=="mouseout";if(!this._oBkgdFadingTimer){if(!this.fBkgdFadingOut){d.addCssClass("divPrtBkSel");try{d.set_Opacity(c)}catch(g){return}}var a={};a.oSelHdr=d;a.iCurOpacity=this.fBkgdFadingOut?b:c;a.iStartTime=(new Date).getTime();this._oBkgdFadingTimer=this._setTimeout(this._doBackgroundFading,r,a)}}};Owa.UIControls.ItemPart.prototype._startIconsSlidingAnimation=function Owa$UIControls$ItemPart$prototype$_startIconsSlidingAnimation(h){var e=this._getDescendant("divActionIcons");if(e){this.fIconsFadingOut=h=="mouseout";if(!this._oIconsAnimationTimer){var c=this._getDescendant("divExp"),g=c.getDescendantById(Owa.Strings.Ids.ReplyIcon),f=c.getDescendantById(Owa.Strings.Ids.ForwardIcon),b={};b.oReplyIcon=g;b.oForwardIcon=f;b.fStartingAnimation=!this.fIconsFadingOut;b.iCurPosition=this.fIconsFadingOut?a:d;b.iStartTime=(new Date).getTime();this._oIconsAnimationTimer=this._setTimeout(this._doIconsAnimation,q,b)}}};Owa.UIControls.ItemPart.prototype._shouldProcessHoverEvent=function Owa$UIControls$ItemPart$prototype$_shouldProcessHoverEvent(a){if(this.get_IsSelected())return false;var b;if(a.get_Type()=="mouseout")b=a.get_ToElementForMouseOut();else if(a.get_Type()=="mouseover")b=a.get_FromElementForMouseOver();return!this._isPartOfItemHoverTargets(b)};Owa.UIControls.ItemPart.prototype.onContextClick=function Owa$UIControls$ItemPart$prototype$onContextClick(b){var a=b.get_Target(),d=Owa.Strings.Ids;while(a!=null&&a.get_Id()!=d.ItemPartExpansion){switch(a.get_Id()){case d.AttachmentLink:var c=a.get_ParentElement();if(c!=null){var e=c.getAttribute("_url");if(e)a.setAttribute("href",e);else!c.getAttribute("_idx")&&a.setAttribute("href",gtAttUrl(c,null,this.get_SubPage()))}return;case d.ItemPartExpansionHeader:this.onContextMenu(b);return;case d.ItemPartActionsButton:b._oDivAct=a;this.onContextMenu(b);canEvt(b);return}a=a.get_ParentElement()}};Owa.UIControls.ItemPart.prototype.onContextMenu=function Owa$UIControls$ItemPart$prototype$onContextMenu(a){a.preventDefault();if(!this._fSel)this._get_Parent().onClkItemPart(this,a,true);else{!this.oPrv&&this.showSelectionBkgd();this.exp()}this._get_Parent().onContextMenu(a)};Owa.UIControls.ItemPart.prototype.openItemPart=function Owa$UIControls$ItemPart$openItemPart(d){var b="Open",a=this.get_ItemType(),e=getApplicationElementForItem("Item",b,a),c="?ae="+e+"&a="+b+"&t="+urlEnc(a)+"&id="+urlEnc(this.get_Id());if(this.fDraft)c+="&s=Draft";openItm(c,null,null,null,null,this.get_SubPage());d&&canEvt(d)};Owa.UIControls.ItemPart.prototype.sel=function Owa$UIControls$ItemPart$sel(b,i){!this.get_IsInitialized()&&this.initialize();var k=this._getDescendant("divClps"),c=this._getDescendant("divExp");if(this._oBkgdFadingTimer){this._clearTimeout(this._oBkgdFadingTimer);this._oBkgdFadingTimer=null}if(c){if(this._oIconsAnimationTimer){this._clearTimeout(this._oIconsAnimationTimer);this._oIconsAnimationTimer=null}var f=c.getDescendantById(Owa.Strings.Ids.ReplyIcon),d=c.getDescendantById(Owa.Strings.Ids.ForwardIcon);if(f)if(!g_fRtl)f.set_Left(a);else f.set_Right(a);if(d)if(!g_fRtl)d.set_Right(a);else d.set_Left(a);var h=!b,j=!this.oPrv;if(h&&j)h=!i;this._showSelectionBkgd(c,h)}this._showSelectionBkgd(k,!b);this.showSelUI(b);this.moveToLayer(b?1:2);this._get_Parent().fixPrts(g|e);this._fSel=!b;this.get_ActionButtons()&&this.get_ActionButtons().setMultipleSelection(false)};Owa.UIControls.ItemPart.prototype._showSelectionBkgd=function Owa$UIControls$ItemPart$_showSelectionBkgd(d,c){var a=d.getChildById("divPrtBk");if(a){try{a.set_Opacity(b)}catch(e){}if(c)a.addCssClass("divPrtBkSel");else a.removeCssClass("divPrtBkSel")}};Owa.UIControls.ItemPart.prototype.showSelectionBkgd=function Owa$UIControls$ItemPart$showSelectionBkgd(a){var c=this._getDescendant("divExp");c&&this._showSelectionBkgd(c,!a);var b=this._getDescendant("divClps");b&&this._showSelectionBkgd(b,!a)};Owa.UIControls.ItemPart.prototype.moveToLayer=function Owa$UIControls$ItemPart$moveToLayer(b){this._get_Element().addCssClass("cnvLayer"+b);for(var a=0;a<3;a++)a!=b&&this._get_Element().removeCssClass("cnvLayer"+a)};Owa.UIControls.ItemPart.prototype.exp=function Owa$UIControls$ItemPart$exp(a){if(!a&&this.get_IsExpanded())return;this._get_Parent().get_IsRefreshing()&&this._get_Parent().fceRptRf();if(!a&&!this._get_Element().getChildById("divExp")){this.gtExp();return}var c=this._getDescendant("divExp");c&&c.set_IsShown(!a);this._get_Element().getChildById("divClps").set_IsShown(a);if(a&&!this._fEverCollapsed){this.initHdr(this._get_Element().getChildById("divClps"));this._fEverCollapsed=true}var b=this._get_Element().getChildById("imgEC");Owa.Components.CssSprites.updateImage(b,a?g_fRtl?Owa.Strings.Icons.CollapsedRtl:Owa.Strings.Icons.Collapsed:g_fRtl?Owa.Strings.Icons.ExpandedRtl:Owa.Strings.Icons.Expanded);b.set_Top(a?0:8);this._fExp=!a;this._get_Parent().fixPrts(g|t|e);this._get_Parent().onExpandCollapseItemPart()};Owa.UIControls.ItemPart.prototype.gtExp=function Owa$UIControls$ItemPart$gtExp(){if(this.fGtExp)return;this.fGtExp=1;this._get_Parent().cnclPrts(g);var a=new oeReq(w,"ExpIP",0,Owa.Utility.createDelegate(this,this.cbGtExp),POST);a.add("CnvId",this._get_Parent().sCnvId);a.addRg("IPId",[this.get_Id()]);a.send();this.iExpPrgTmr=this.stTmout("shwExpPrg",2e3,true)};Owa.UIControls.ItemPart.prototype.cbGtExp=function Owa$UIControls$ItemPart$cbGtExp(b){if(this.get_IsDisposed())return;if(!cbOeh(b)){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}this.shwExpPrg(false);return}var a=f.get_Current().createElement("div");a.set_InnerHtml(b.sBody);var c=a.getDescendantById("divExp");this.insertExpandedPart(c);this._setTimeout(updFrmPrsnc,IM_PRTM_FRM,this.get_SubPage());this.fGtExp=0};Owa.UIControls.ItemPart.prototype.insertExpandedPart=function Owa$UIControls$ItemPart$insertExpandedPart(b){if(b.getIntAttribute("itemNotFound")){var a=this._get_Parent();a.rmvIPs([this.get_Id()],true);a.rfrsh()}else{this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b);this.stTmout("fnshGtExp",1)}};Owa.UIControls.ItemPart.prototype.fnshGtExp=function Owa$UIControls$ItemPart$fnshGtExp(){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}if(this.get_IsDisposed())return;this.shwExpPrg(false);this.initializeExpansion();this.exp();this.sel(!this.get_IsSelected());this.fEnsureInView&&this._get_Parent().ensureInView(this.get_Id())};Owa.UIControls.ItemPart.prototype.shwExpPrg=function Owa$UIControls$ItemPart$shwExpPrg(a){this._get_Element().getChildById("imgEC").set_IsShown(!a);this._get_Element().getChildById("imgPrg").set_IsShown(a)};Owa.UIControls.ItemPart.prototype.stRS=function Owa$UIControls$ItemPart$stRS(a){this.fR=!!a;var b=this._get_Element();if(a)b.removeCssClass("itmPrtUr");else b.addCssClass("itmPrtUr")};Owa.UIControls.ItemPart.prototype.showSelUI=function Owa$UIControls$ItemPart$showSelUI(a){var b=this._get_Element().getChildById("divExp");if(!b)return;var c=b.getChildById("divSelDisplay");if(a)c.addCssClass("unselected");else c.removeCssClass("unselected");!a&&this.alignWellTitles();var d=b.getChildById("divExpHdr"),e=d.getChildById("divActions");e.set_IsShown(!a);this._oActionButtons&&this._oActionButtons.setGhostState(a)};Owa.UIControls.ItemPart.prototype._get_IsShown=function Owa$UIControls$ItemPart$_get_IsShown(){return this.get_SubPage().get_IsShown(true)};Owa.UIControls.ItemPart.prototype.onShowHide=function Owa$UIControls$ItemPart$onShowHide(a){if(a&&this._fPendingAlignWellTitles){this._fPendingAlignWellTitles=false;this.alignWellTitles()}};Owa.UIControls.ItemPart.prototype.alignWellTitles=function Owa$UIControls$ItemPart$prototype$alignWellTitles(){if(!this._get_IsShown()){this._fPendingAlignWellTitles=true;return}if(!this._wellsAligned){for(var c=["divToL","divCcL","divBccL","divCategoriesL","divAttachL"],d=0,a=0;a<c.length;++a){var b=this._getDescendant(c[a]);if(b)d=Math.max(d,b.get_OffsetWidth())}for(var a=0;a<c.length;++a){var b=this._getDescendant(c[a]);b&&b.set_Width(d)}this._wellsAligned=true}};Owa.UIControls.ItemPart.prototype.getSender=function Owa$UIControls$ItemPart$prototype$getSender(){return this._get_Element().getDescendantById("spnFrom")};Owa.UIControls.ItemPart.prototype.get_ParentItemPart=function Owa$UIControls$ItemPart$prototype$get_ParentItemPart(){return this.get_ParentId()!=null?this._get_Parent().oItemParts[this.get_ParentId()]:null};Owa.UIControls.ItemPart.prototype.get_IsSelected=function Owa$UIControls$ItemPart$prototype$get_IsSelected(){return this._fSel};Owa.UIControls.ItemPart.prototype.get_IsLocal=function Owa$UIControls$ItemPart$prototype$get_IsLocal(){return this._fLocal};Owa.UIControls.ItemPart.prototype.get_IsExpanded=function Owa$UIControls$ItemPart$prototype$get_IsExpanded(){return this._fExp};Owa.UIControls.ItemPart.prototype.get_HasExpansionData=function Owa$UIControls$ItemPart$get_HasExpansionData(){return this.fGtExp||this._get_Element().getChildById("divExp")};Owa.UIControls.ItemPart.prototype.get_Id=function Owa$UIControls$ItemPart$prototype$get_Id(){return this._sItmId};Owa.UIControls.ItemPart.prototype.get_ChangeKey=function Owa$UIControls$ItemPart$prototype$get_ChangeKey(){return this._sCK};Owa.UIControls.ItemPart.prototype.get_ParentId=function Owa$UIControls$ItemPart$prototype$get_ParentId(){return this._sPId};Owa.UIControls.ItemPart.prototype.set_ParentId=function Owa$UIControls$ItemPart$prototype$set_ParentId(a){this._sPId=a};Owa.UIControls.ItemPart.prototype.get_InternetMId=function Owa$UIControls$ItemPart$prototype$get_InternetMId(){return this._iInternetMId};Owa.UIControls.ItemPart.prototype.get_ItemType=function Owa$UIControls$ItemPart$prototype$get_ItemType(){return this._sT};Owa.UIControls.ItemPart.prototype.get_IsInJunkFolder=function Owa$UIControls$ItemPart$prototype$get_IsInJunkFolder(){return this._fInJunkFolder};Owa.UIControls.ItemPart.prototype.get_IsInArchiveMailbox=function Owa$UIControls$ItemPart$prototype$get_IsInArchiveMailbox(){return this._fInArchiveMailbox};Owa.UIControls.ItemPart.createClass("Owa.UIControls.ItemPart",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/itempart.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");Type.createNamespace("Owa.Components.MeetingHelpers");!g_fModuleLoaded[".\\components/meetinghelpers.js".toLowerCase()]&&(function(){Owa.Components.MeetingHelpers.Operations={SaveInvitation:OP_SAV,SaveCalendarItem:64,EditResponseFromCalendar:128,EditResponseFromInvite:256,SendResponse:512,DontSendResponse:1024,SaveCancellation:2048,SaveResponse:4096};Owa.Components.MeetingHelpers.ItemTypes={MeetingMessage:10,MeetingRequest:11,MeetingResponse:12,MeetingCancellation:13};Owa.Components.MeetingHelpers.getResponseAction=function Owa$Components$MeetingHelpers$getResponseAction(a){while(a){var b=a.get_Id();if(b=="tblacceptMnu")return R_ACC;if(b=="tbltentativeMnu")return R_TNT;if(b=="tbldeclineMnu")return R_DEC;a=a.get_ParentElement()}};Owa.Components.MeetingHelpers.showCalendar=function(d,c,a){var b="?ae=Folder&t=IPF.Appointment&d="+urlEnc(d.toIsoString())+"&sid="+urlEnc(c)+"&srp=0";if(isDf(typeof a)&&a!=null&&a!="")b+="&id="+urlEnc(a);opnWin(b)};Owa.Components.MeetingHelpers.onClickAppointment=function(a){a=Owa.Dom.Node.wrapDomNode(a);var d=a.get_Id(),c=a.getAttribute("gid"),b=a.getAttribute("fid");openItm("?ae=PreFormAction&a=Open&t=IPM.Appointment&id="+urlEnc(d)+(c?"&gid="+urlEnc(c):"")+(b?"&fid="+urlEnc(b):""))}})();g_fModuleLoaded[".\\components/meetinghelpers.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/meetingitempart.js".toLowerCase()]&&(function(){var a=Owa.Components.MeetingHelpers;Owa.UIControls.MeetingItemPart=function Owa$UIControls$MeetingItemPart(c,b){Owa.UIControls.MeetingItemPart.constructBase(this,[c,b]);this._oToolbars=null;this._oActionTable=null;this._oActionTable=new Owa.Components.ClientActionTable;this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Accept));this._oActionTable.getAction(Owa.Strings.Ids.Accept).get_ActionEventHandlers().add(this._createCallback(this._onAccept));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Tentative));this._oActionTable.getAction(Owa.Strings.Ids.Tentative).get_ActionEventHandlers().add(this._createCallback(this._onTentative));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Decline));this._oActionTable.getAction(Owa.Strings.Ids.Decline).get_ActionEventHandlers().add(this._createCallback(this._onDecline));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Remove));this._oActionTable.getAction(Owa.Strings.Ids.Remove).get_ActionEventHandlers().add(this._createCallback(this._onRemove));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.ShowCalendar));this._oActionTable.getAction(Owa.Strings.Ids.ShowCalendar).get_ActionEventHandlers().add(this._createCallback(this._onShowCalendar));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.EditResponse));this._oActionTable.getAction(Owa.Strings.Ids.EditResponse).get_ActionEventHandlers().add(this._createCallback(this._onEditResponse));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.SendResponse));this._oActionTable.getAction(Owa.Strings.Ids.SendResponse).get_ActionEventHandlers().add(this._createCallback(this._onSendResponse));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.NoResponse));this._oActionTable.getAction(Owa.Strings.Ids.NoResponse).get_ActionEventHandlers().add(this._createCallback(this._onNoResponse));this._iItemType=this.get_ItemType()==Owa.Strings.ObjectClass.MeetingRequest?a.ItemTypes.MeetingRequest:a.ItemTypes.MeetingCancellation;this._dtST=null};Owa.UIControls.MeetingItemPart.prototype.initializeExpansion=function Owa$UIControls$MeetingItemPart$initializeExpansion(){Owa.UIControls.MeetingItemPart.callBase(this,"initializeExpansion");this._oToolbars=[];for(var c=[this._getDescendant("mpToolbar"),this._getDescendant("openCalendarTb")],a=0;a<c.length;a++)if(c[a]){this._oToolbars[a]=new Owa.UIControls.Toolbar(c[a],this);this._oToolbars[a].set_SubPage(this.get_SubPage());this._oToolbars[a].initialize(this._oActionTable)}this._oMeetingInfoArea=new Owa.UIControls.MeetingInfoArea(this._getDescendant("divMtgInfo"),Owa.Utility.createArgumentContextDelegate(this,this._onMeetingInfoAreaClick));var b=this._getDescendant("divExp");this._dtST=eval(b.getAttribute("dtST"));this._sCK=b.getAttribute("sCK");this._pCFId=b.getAttribute("pCFId");this._fOlderVersion=b.getAttribute("fOlderVersion");if(this.fPhishing||this.sFId==this._get_Parent()._sDeletedItemsId||this._fOlderVersion){this._oActionTable.getAction("accept").disable();this._oActionTable.getAction("tentative").disable();this._oActionTable.getAction("decline").disable()}};Owa.UIControls.MeetingItemPart.prototype._onMeetingInfoAreaClick=function Owa$UIControls$MeetingItemPart$_onMeetingInfoAreaClick(a){a==Owa.Strings.Ids.Remove&&this._onRemove()};Owa.UIControls.MeetingItemPart.prototype.disposeExpansion=function Owa$UIControls$MeetingItemPart$disposeExpansion(){for(var a=0;a<this._oToolbars.length;a++)this._oToolbars[a].dispose();this._oToolbars=null;this._oMeetingInfoArea&&this._oMeetingInfoArea.dispose();Owa.UIControls.MeetingItemPart.callBase(this,"disposeExpansion")};Owa.UIControls.MeetingItemPart.prototype.fixPrtSz=function Owa$UIControls$MeetingItemPart$fixPrtSz(){Owa.UIControls.MeetingItemPart.callBase(this,"fixPrtSz");if(this._oMeetingInfoArea){var a=this._get_Element().getChildById("divExp").get_ClientWidth();this._oMeetingInfoArea.fixMeetingPartsSize(a-10)}};Owa.UIControls.MeetingItemPart.prototype._onAccept=function Owa$UIControls$MeetingItemPart$prototype$_onAccept(){this._processAction(a.Operations.DontSendResponse,"NoResponse",R_ACC)};Owa.UIControls.MeetingItemPart.prototype._onDecline=function Owa$UIControls$MeetingItemPart$prototype$_onDecline(){this._processAction(a.Operations.DontSendResponse,"NoResponse",R_DEC)};Owa.UIControls.MeetingItemPart.prototype._onTentative=function Owa$UIControls$MeetingItemPart$prototype$_onTentative(){this._processAction(a.Operations.DontSendResponse,"NoResponse",R_TNT)};Owa.UIControls.MeetingItemPart.prototype._onRemove=function Owa$UIControls$MeetingItemPart$prototype$_onRemove(){var a=new oeReq("EditMeetingInvite","RemCal",0,this._createCallback(this._onProcessItemResponse));a.add("Id",this.get_Id());a.send()};Owa.UIControls.MeetingItemPart.prototype._onShowCalendar=function Owa$UIControls$MeetingItemPart$prototype$_onShowCalendar(){a.showCalendar(this._dtST,this.get_Id(),this._pCFId)};Owa.UIControls.MeetingItemPart.prototype._onEditResponse=function Owa$UIControls$MeetingItemPart$prototype$_onEditResponse(c){shwPrgrsInd(L_Ld);var b=a.getResponseAction(c);this._processAction(a.Operations.EditResponseFromInvite,"EditResponseInvite",b)};Owa.UIControls.MeetingItemPart.prototype._onNoResponse=function Owa$UIControls$MeetingItemPart$prototype$_onNoResponse(c){shwPrgrsInd(L_Ld);var b=a.getResponseAction(c);this._processAction(a.Operations.DontSendResponse,"NoResponse",b)};Owa.UIControls.MeetingItemPart.prototype._onSendResponse=function Owa$UIControls$MeetingItemPart$prototype$_onSendResponse(c){var b=a.getResponseAction(c);shwPrgrsInd(L_Ld);this._processAction(a.Operations.SendResponse,"SendResponse",b)};Owa.UIControls.MeetingItemPart.prototype._processAction=function Owa$UIControls$MeetingItemPart$prototype$_processAction(d,e,b){if(Owa.Components.OehRequest.hasPendingRequests())return;var c={};c.iOp=d;c.iR=b;var a=new oeReq("EditMeetingInvite",e,c,this._createCallback(this._onProcessItemResponse));a.set_ProcessXhrStatusZeroAsError();a.add("Id",this.get_Id());a.add("CK",this.get_ChangeKey());if(b){a.add("ItemType",this._iItemType);a.add("Rsp",b)}a.send()};Owa.UIControls.MeetingItemPart.prototype._onProcessItemResponse=function cbProcItm(b){var j=b.oCtx,i=j.iOp,m=j.iR,e=null,h=0,k=0,c=Owa.Dom.Document.get_Current().createElement("div");c.set_InnerHtml(b.sBody);i==a.Operations.EditResponseFromInvite&&hdPrgrsInd();if(b.sErr){b.fST&&popLgn();e=b.sErr;h=b.iErr}else{var d=c.getChildById("err");if(d){e=d.getAttribute("_msg");k=1;if(d._cd)h=getInt(d.getAttribute("_cd"))}}if(!e){var f=c.getChildById("ck");if(f)this._sCK=f.get_TextContent();switch(i){case a.Operations.EditResponseFromInvite:var l=urlEnc(c.getChildById("divOp").get_TextContent()),g=gtMtRspUrl(l,m);if(this.get_Id())g+="&mid="+urlEnc(this.get_Id());opnWin(g)}!this.get_IsDisposed()&&this._get_Parent().rfrsh(2e3,true)}else{hdPrgrsInd();shwErrDlg(b)}};Owa.UIControls.MeetingItemPart.prototype.exp=function Owa$UIControls$MeetingItemPart$exp(a){Owa.UIControls.MeetingItemPart.callBase(this,"exp",[a]);!a&&this._oMeetingInfoArea&&this._oMeetingInfoArea.get_initializationDeferred()&&this._oMeetingInfoArea.initializeMeetingParts()};Owa.UIControls.MeetingItemPart.createClass("Owa.UIControls.MeetingItemPart",Owa.UIControls.ItemPart);Owa.UIControls.MeetingResponseItemPart=function Owa$UIControls$MeetingResponseItemPart(b,a){Owa.UIControls.MeetingResponseItemPart.constructBase(this,[b,a])};Owa.UIControls.MeetingResponseItemPart.prototype.initializeExpansion=function Owa$UIControls$MeetingResponseItemPart$initializeExpansion(){Owa.UIControls.MeetingResponseItemPart.callBase(this,"initializeExpansion");this._oMeetingInfoArea=new Owa.UIControls.MeetingInfoArea(this._getDescendant("divMtgInfo"))};Owa.UIControls.MeetingResponseItemPart.prototype.disposeExpansion=function Owa$UIControls$MeetingResponseItemPart$disposeExpansion(){this._oMeetingInfoArea&&this._oMeetingInfoArea.dispose();Owa.UIControls.MeetingResponseItemPart.callBase(this,"disposeExpansion")};Owa.UIControls.MeetingResponseItemPart.prototype.exp=function Owa$UIControls$MeetingResponseItemPart$exp(a){Owa.UIControls.MeetingResponseItemPart.callBase(this,"exp",[a]);!a&&this._oMeetingInfoArea&&this._oMeetingInfoArea.get_initializationDeferred()&&this._oMeetingInfoArea.initializeMeetingParts()};Owa.UIControls.MeetingResponseItemPart.prototype.fixPrtSz=function Owa$UIControls$MeetingResponseItemPart$fixPrtSz(){Owa.UIControls.MeetingResponseItemPart.callBase(this,"fixPrtSz");if(this._oMeetingInfoArea){var a=this._get_Element().getChildById("divExp").get_ClientWidth();this._oMeetingInfoArea.fixMeetingPartsSize(a-10)}};Owa.UIControls.MeetingResponseItemPart.createClass("Owa.UIControls.MeetingResponseItemPart",Owa.UIControls.ItemPart)})();g_fModuleLoaded[".\\uicontrols/meetingitempart.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/SharingItemPart.js".toLowerCase()]&&(function(){var a=Owa.Components.SharingMessageHelpers;Owa.UIControls.SharingItemPart=function Owa$UIControls$SharingItemPart(b,a){Owa.UIControls.SharingItemPart.constructBase(this,[b,a]);this._oToolbar=null;this._oActionTable=new Owa.Components.ClientActionTable;this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.ShareMyCalendar));this._oActionTable.getAction(Owa.Strings.Ids.ShareMyCalendar).get_ActionEventHandlers().add(this._createCallback(this._onAccept));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.AddThisCalendar));this._oActionTable.getAction(Owa.Strings.Ids.AddThisCalendar).get_ActionEventHandlers().add(this._createCallback(this._onAddThisCalendar));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.ViewThisCalendar));this._oActionTable.getAction(Owa.Strings.Ids.ViewThisCalendar).get_ActionEventHandlers().add(this._createCallback(this._onViewThisCalendar))};Owa.UIControls.SharingItemPart.prototype.initializeExpansion=function Owa$UIControls$SharingItemPart$initializeExpansion(){Owa.UIControls.SharingItemPart.callBase(this,"initializeExpansion");var b=this._getDescendant("divShareToolbar");if(b){this._oToolbar=new Owa.UIControls.Toolbar(b,this);this._oToolbar.set_SubPage(this.get_SubPage());this._oToolbar.initialize(this._oActionTable)}if(this._getDescendant("divViewAddrL")){var d=["divViewAddrL","divSubscribeAddrL"];Owa.Layout.setElementWidthsToLargest(d,this)}if(this._oToolbar){var e=this._get_Element().getChildById("divExp"),c=e.getAttribute("sBrowseUrl");if(c){var a=this._oToolbar.getChildButton("viewcal");a&&a._get_ButtonElement().setAttribute("title",c)}}};Owa.UIControls.SharingItemPart.prototype.disposeExpansion=function Owa$UIControls$SharingItemPart$disposeExpansion(){if(this._oToolbar!=null){this._oToolbar.dispose();this._oToolbar=null}Owa.UIControls.SharingItemPart.callBase(this,"disposeExpansion")};Owa.UIControls.SharingItemPart.prototype._onAccept=function Owa$UIControls$SharingItemPart$prototype$_onAccept(){Owa.Components.SharingMessageHelpers.HandleUserAction(Owa.Strings.Ids.ShareMyCalendar,this.get_Id(),this.get_ChangeKey(),this)};Owa.UIControls.SharingItemPart.prototype._onAddThisCalendar=function Owa$UIControls$SharingItemPart$prototype$_onAddThisCalendar(){Owa.Components.SharingMessageHelpers.HandleUserAction(Owa.Strings.Ids.AddThisCalendar,this.get_Id(),this.get_ChangeKey(),this)};Owa.UIControls.SharingItemPart.prototype._onViewThisCalendar=function Owa$UIControls$SharingItemPart$prototype$_onViewThisCalendar(){var a=this._get_Element().getChildById("divExp"),b=a.getAttribute("sRedirectBrowseUrl");opnWin(b,null,null,null,null,true,null,null,true,null,null,true,true)};Owa.UIControls.SharingItemPart.createClass("Owa.UIControls.SharingItemPart",Owa.UIControls.ItemPart)})();g_fModuleLoaded[".\\uicontrols/SharingItemPart.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/conversationsreadingpane.js".toLowerCase()]&&(function(){var v=Owa.Dom.Node,n=Owa.Dom.Document,u=Owa.Dom.Window,j=1,d=2,f=4,c=16,i=j|d,g=25,h=4,t=100,p=4,o="ReadConversation",e="onSelectionChanged",s="onMarkAsRead",b="onConversationOutOfScope",k="onConversationRefreshed",l="onExpandCollapse",a="conversationTooLongPart",r=1e3,q=1e3,m=300;Owa.UIControls.ConversationReadingPane=function Owa$UIControls$ConversationReadingPane(d,c,e){Owa.UIControls.ConversationReadingPane.constructBase(this,[d,c]);this.set_SubPage(e);this.sCnvId=this._getAttribute("sCnvId");this.iMR=this._getIntAttribute("iMR");this.iMRDly=this._getIntAttribute("iMRDly");this.fMSR=0;this._iMaxItmPrts=this._getIntAttribute("iMaxItemPrts");this._iSort=this._getIntAttribute("iSort");this._fDeletedItemsHidden=this._getIntAttribute("fHideDelItems");this._sDeletedItemsId=this._getAttribute("sDeletedItemsId");this._fIsConversationIgnored=this._getIntAttribute("fIsConversationIgnored");this._oMarkedAsUnread={};this._fItemRemoved=false;this._fFlags=0;this._fCopyRestrictedConv=false;this._fPrintRestrictedConv=false;this._fSuppressOnExpandCollapse=false;this._rgToInitialize=[];this.L_ImgFltBlock=this._getAttribute("L_ImgFltBlock");this.L_ImgFltCompBlock=this._getAttribute("L_ImgFltCompBlock");this.L_TypeNotSup=this._getAttribute("L_TypeNotSup");this.L_OpnInOlk=this._getAttribute("L_OpnInOlk");this.L_ReadRcp=this._getAttribute("L_ReadRcp");this.L_Draft=this._getAttribute("L_Draft");this._iGlobalMessageCount=this._getIntAttribute("iGC");this._iCurrentFolderMessageCount=this._getIntAttribute("iC");this.oItemParts={};this.oSel={};this._rgSelIds=[];this.sScrMkr=0;this.fMkrScr=1;this._fPndRf=0;this.fRptRf=0;this.fIgnScr=0;this._fContextActionProcessing=false;this._fContextMenuEnabled=false;this._oDoNotRefreshTimer=null;this._fDoNotRefresh=false;this._iRefreshTimerExpiresAtTicks=0;this._oRefreshTimer=null;this._fForce_TimerRefresh=false;this._iUdUC_TimerRefresh=-1;this._iUdTC_TimerRefresh=-1;this._iUdUC_TimerRefresh=-1;var b=this.get_SubPage().get_SubPageController(),a=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b.get_ParentController());if(a)this._oLVActionTable=a.get_ActionTable()};Owa.UIControls.ConversationReadingPane.prototype.initialize=function Owa$UIControls$ConversationReadingPane$initialize(){Owa.UIControls.ConversationReadingPane.callBase(this,"initialize");this._insertCnvTooLongPart();var g=this._getDescendant("divItmPrtsScr"),e=this._initializeItemParts();if(this._fCopyRestrictedConv){this._attachEvent(this._oElement,"copy",canEvt);this._attachEvent(this._oElement,"dragstart",canEvt);this._attachEvent(this._oElement,"selectstart",canEvt);this._attachEvent(this._oElement,"contextmenu",canEvt)}if(this._fPrintRestrictedConv){var h=this._getDescendant("divItmPrtsNoPrnt");this._getDescendant("divItmPrts").addCssClass("noPrint");h.addCssClass("noScreen");h.removeCssClass("hiddenMsg")}this.fixPrts(i|c);if(e){this.setSel([e],0,0,1);this.scrTo(e,1)}this._attachEvent(g,"selectstart",this.onSS);this._attachEvent(g,"scroll",this.onScr);this._attachEvent(g,"mousewheel",this._stpScrAnm);this.get_SubPage().get_SizeChanged().add(this._createCallback(this.onRsz));if(this._oLVActionTable){this._rgStateChangeHandlers=[];for(var b=Owa.UIControls.ActionButtons.RG_ACTIONS,a=0;a<b.length;a++){var k=Owa.Utility.createArgumentContextDelegate(this,this._onActionButtonStateChanged,b[a]);this._rgStateChangeHandlers[b[a]]=k;var d=this._oLVActionTable.getAction(b[a]);if(d){d.get_StateChangeEventHandlers().add(k);if(!d.get_Enabled())for(var j=this.get_ActionButtons(),f=0;f<j.length;f++)j[f].setActionButtonState(b[a],false)}}}};Owa.UIControls.ConversationReadingPane.prototype.dispose=function Owa$UIControls$ConversationReadingPane$dispose(){if(!this.get_IsDisposed()){this._fContextMenuOpened&&this.get_ContextMenu().close();this.onBeforeUnload();this._disposeItemParts();this._getDescendant("divItmPrtsScr").dispose();this._oRefreshTimer&&this._clearTimeout(this._oRefreshTimer);Owa.UIControls.ConversationReadingPane.callBase(this,"dispose");if(this._oLVActionTable&&this._rgStateChangeHandlers)for(var b=Owa.UIControls.ActionButtons.RG_ACTIONS,a=0;a<b.length;a++){var c=this._oLVActionTable.getAction(b[a]);c&&c.get_StateChangeEventHandlers().remove(this._rgStateChangeHandlers[b[a]])}}};Owa.UIControls.ConversationReadingPane.prototype.get_ContextMenu=function Owa$UIControls$ConversationReadingPane$get_ContextMenu(){var a=this.get_SubPage().get_SubPageController().get_ParentController(),b=a.get_SubPage(),c=b.get_VirtualListView();return c.get_ContextMenu()};Owa.UIControls.ConversationReadingPane.prototype.onShowHide=function Owa$UIControls$ConversationReadingPane$onShowHide(a){for(var b in this.oItemParts)this.oItemParts[b].onShowHide(a)};Owa.UIControls.ConversationReadingPane.prototype._initializeItemParts=function Owa$UIControls$ConversationReadingPane$_initializeItemParts(){this._fItemRemoved=false;this._fCopyRestrictedConv=false;this._fPrintRestrictedConv=false;for(var c=0,b,d,e=0;true;e++){var f=this._getDescendant("divIP"+e);if(!f)break;var a=Owa.UIControls.ItemPart.create(f,this);a.set_SubPage(this.get_SubPage());this._rgToInitialize.push(a);if(a.fCopyRestricted)this._fCopyRestrictedConv=true;if(a.fPrintRestricted)this._fPrintRestrictedConv=true;if(!b&&a.get_IsExpanded())if(!a.fDraft)b=a.get_Id();else if(!d)d=a.get_Id();this.oItemParts[a.get_Id()]=a;if(c){a.oPrv=c;c.oNxt=a}c=a}if(!b)b=d;this._initializeItemPartBatch();return b};Owa.UIControls.ConversationReadingPane.prototype._initializeItemPartBatch=function Owa$UIControls$ConversationReadingPane$_initializeItemPartBatch(){var b=10;while(b&&this._rgToInitialize.get_Length()){var a=this._rgToInitialize.shift();!a.get_IsInitialized()&&a.initialize();b--}this._rgToInitialize.get_Length()&&this._setTimeout(this._initializeItemPartBatch,1)};Owa.UIControls.ConversationReadingPane.prototype._disposeItemParts=function Owa$UIControls$ConversationReadingPane$_disposeItemParts(){this._rgToInitialize=[];for(var a in this.oItemParts){var b=this.oItemParts[a];b&&b.dispose();delete this.oItemParts[a]}};Owa.UIControls.ConversationReadingPane.prototype.stOnMkRd=function Owa$UIControls$ConversationReadingPane$stOnMkRd(a){this.onMkRd=a};Owa.UIControls.ConversationReadingPane.prototype._get_ItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_ItemPartsCount(){return this._iMaxItmPrts>this._iGlobalMessageCount?this._iGlobalMessageCount:this._iMaxItmPrts};Owa.UIControls.ConversationReadingPane.prototype._get_LocalItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_LocalItemPartsCount(){var a=0;for(var b in this.oItemParts)if(this.oItemParts[b].get_IsLocal())a++;return a};Owa.UIControls.ConversationReadingPane.prototype._get_LocalUnreadItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_LocalUnreadItemPartsCount(){var a=0;for(var b in this.oItemParts)if(this.oItemParts[b].get_IsLocal()&&!this.oItemParts[b].fR)a++;return a};Owa.UIControls.ConversationReadingPane.prototype.get_Id=function Owa$UIControls$ConversationReadingPane$get_Id(){return this.sCnvId};Owa.UIControls.ConversationReadingPane.prototype.get_ActionButtons=function Owa$UIControls$ConversationReadingPane$get_ActionButtons(){for(var b=[],e=this.gtSel(),a=0;a<e.length;a++){var d=this.oItemParts[e[a]],c=d?d.get_ActionButtons():null;if(c)b[a]=c}return b};Owa.UIControls.ConversationReadingPane.prototype.get_IsContextActionProcessing=function Owa$UIControls$ConversationReadingPane$prototype$get_IsContextActionProcessing(){return this._fContextActionProcessing};Owa.UIControls.ConversationReadingPane.prototype.get_IsRefreshing=function Owa$UIControls$ConversationReadingPane$get_IsRefreshing(){return this._fPndRf};Owa.UIControls.ConversationReadingPane.prototype.get_OnSelectionChanged=function Owa$UIControls$ConversationReadingPane$prototype$get_OnSelectionChanged(){return this._getEventHandlerCollection(e)};Owa.UIControls.ConversationReadingPane.prototype.get_OnMarkAsRead=function Owa$UIControls$ConversationReadingPane$prototype$get_OnMarkAsRead(){return this._getEventHandlerCollection(s)};Owa.UIControls.ConversationReadingPane.prototype.get_OnConversationOutOfScope=function Owa$UIControls$ConversationReadingPane$prototype$get_OnConversationOutOfScope(){return this._getEventHandlerCollection(b)};Owa.UIControls.ConversationReadingPane.prototype.get_OnConversationRefreshed=function Owa$UIControls$ConversationReadingPane$prototype$get_OnConversationRefreshed(){return this._getEventHandlerCollection(k)};Owa.UIControls.ConversationReadingPane.prototype.get_OnExpandCollapse=function Owa$UIControls$ConversationReadingPane$prototype$get_OnExpandCollapse(){return this._getEventHandlerCollection(l)};Owa.UIControls.ConversationReadingPane.prototype.get_ContextMenuEnabled=function Owa$UIControls$ConversationReadingPane$prototype$get_ContextMenuEnabled(){return this._fContextMenuEnabled};Owa.UIControls.ConversationReadingPane.prototype.set_ContextMenuEnabled=function Owa$UIControls$ConversationReadingPane$prototype$set_ContextMenuEnabled(a){this._fContextMenuEnabled=a};Owa.UIControls.ConversationReadingPane.prototype.get_IsNewestOnTop=function Owa$UIControls$ConversationReadingPane$prototype$get_IsNewestOnTop(){return(this._iSort&p)>0};Owa.UIControls.ConversationReadingPane.prototype.get_IsConversationIgnored=function Owa$UIControls$ConversationReadingPane$prototype$get_IsConversationIgnored(){return this._fIsConversationIgnored};Owa.UIControls.ConversationReadingPane.prototype._onContextMenuClick=function Owa$UIControls$ConversationReadingPane$prototype$_onContextMenuClick(a){var b=a.sCommand,c=a.oMenuItem;this._fContextActionProcessing=true;switch(b){case"MvToF":this._showMoveCopyDialog(false);break;case"CpToF":this._showMoveCopyDialog(true);break;case"openMessage":this.openSelectedItemParts();break;default:if(this.onContextAction)this.onContextAction(b,c)}this._fContextActionProcessing=false};Owa.UIControls.ConversationReadingPane.prototype.onContextMenu=function Owa$UIControls$ConversationReadingPane$prototype$onContextMenu(a){if(this.get_ContextMenuEnabled()){this._fixContextMenuButtons();this._initializeCM();if(a._oDivAct&&!g_fRtl)this.get_ContextMenu().showUnder(a._oDivAct,0,true);else this.get_ContextMenu().showAtEvent(a);this._fContextMenuOpened=true}};Owa.UIControls.ConversationReadingPane.prototype._onCloseCM=function Owa$UIControls$ConversationReadingPane$prototype$_onCloseCM(){var a=this.get_ContextMenu();a._clearEventCollections();a.changeShowerSubPage(null);this._fContextMenuOpened=false};Owa.UIControls.ConversationReadingPane.prototype._initializeCM=function Owa$UIControls$ConversationReadingPane$prototype$_initializeCM(){var a=this.get_ContextMenu();a._clearEventCollections();a.changeShowerSubPage(this.get_SubPage());a.get_OnSelect().add(this._createCallback(this._onContextMenuClick));a.get_OnClose().add(this._createCallback(this._onCloseCM))};Owa.UIControls.ConversationReadingPane.prototype.onActionButtonsClick=function Owa$UIControls$ConversationReadingPane$prototype$onActionButtonsClick(a){if(this.onContextAction)this.onContextAction(a)};Owa.UIControls.ConversationReadingPane.prototype.openSelectedItemParts=function Owa$UIControls$ConversationReadingPane$prototype$openSelectedItemParts(){for(var b=this.gtSel(),a=0;a<b.length;a++)this.oItemParts[b[a]].openItemPart()};Owa.UIControls.ConversationReadingPane.prototype.onScr=function Owa$UIControls$ConversationReadingPane$onScr(){if(this.fIgnScr)return;if(this.iScrTmr){this._clearTimeout(this.iScrTmr);this.iScrTmr=0}this.iScrTmr=this._setTimeout(this._stActScr,1e3)};Owa.UIControls.ConversationReadingPane.prototype.onRsz=function Owa$UIControls$ConversationReadingPane$onRsz(){this.fixPrts(d|c)};Owa.UIControls.ConversationReadingPane.prototype.onSS=function Owa$UIControls$ConversationReadingPane$onSS(a){(isShftKD(a)||isCtrlKD(a))&&canEvt(a)};Owa.UIControls.ConversationReadingPane.prototype.onClkItemPart=function Owa$UIControls$ConversationReadingPane$onClkItemPart(a,d,g){if(d.isShiftKeyDown()){var c=this._rgSelIds.length==0?null:this._rgSelIds[0];!d.isCtrlKeyDown()&&this._clrSel();if(!c||c==a.get_Id())this._selIP(a.get_Id());else{var b=a,f=this.oItemParts[c],h=f._get_Element().get_PositionalTop()-b._get_Element().get_PositionalTop();while(1){this._selIP(b.get_Id());if(b==f)break;b=h>0?b.oNxt:b.oPrv}}}else if(d.isCtrlKeyDown()){var i=!!this.oSel[a.get_Id()];this._selIP(a.get_Id(),i)}else this.setSel([a.get_Id()],g||a.get_IsSelected());this._dispatchEvent(e)};Owa.UIControls.ConversationReadingPane.prototype.onTouchItemPart=function Owa$UIControls$ConversationReadingPane$onTouchItemPart(a){this.sScrMkr=a.get_Id();this.fMkrScr=0};Owa.UIControls.ConversationReadingPane.prototype.onExpandCollapseItemPart=function Owa$UIControls$ConversationReadingPane$onExpandCollapseItemPart(){this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype.onBeforeUnload=function Owa$UIControls$ConversationReadingPane$prototype$onBeforeUnload(){for(var b in this.oItemParts){var a=this.oItemParts[b];a._onBeforeUnload()}};Owa.UIControls.ConversationReadingPane.prototype.isDeletedItem=function(b){var a=this.oItemParts[b];return a&&a.sFId==this._sDeletedItemsId};Owa.UIControls.ConversationReadingPane.prototype.isJunkItem=function(b){var a=this.oItemParts[b];return a&&a.get_IsInJunkFolder()};Owa.UIControls.ConversationReadingPane.prototype.setSel=function Owa$UIControls$ConversationReadingPane$setSel(a,j,i,h){for(var f={},g=0;g<a.length;g++)f[a[g]]=1;for(var b in this.oSel)!f[b]&&this._selIP(b,1,0,h);for(var b in f){var d=this.oItemParts[b];if(d)if(!this.oSel[b])this._selIP(b,0,0,h);else!d.oPrv&&d.showSelectionBkgd()}if(a.length>0&&this.oItemParts[a[0]]){var c=this.oItemParts[a[0]];if(c.get_IsExpanded()&&!j)this.ensureInView(c.get_Id());else c.fEnsureInView=1;c.exp()}i&&this._dispatchEvent(e)};Owa.UIControls.ConversationReadingPane.prototype.gtSel=function Owa$UIControls$ConversationReadingPane$gtSel(){for(var b=[],a=0;a<this._rgSelIds.length;++a)b.add(this._rgSelIds[a]);return b};Owa.UIControls.ConversationReadingPane.prototype.stRSAll=function Owa$UIControls$ConversationReadingPane$stRSAll(d,a){var c=[];for(var b in this.oItemParts){if(a&&a==this.oItemParts[b].sFId)continue;c.push(b)}this.stRS(c,d)};Owa.UIControls.ConversationReadingPane.prototype.stRS=function Owa$UIControls$ConversationReadingPane$stRS(b,c){for(var a=0;a<b.length;a++){var d=this.oItemParts[b[a]];d&&d.stRS(c);if(!c)this._oMarkedAsUnread[b[a]]=1;else delete this._oMarkedAsUnread[b[a]]}this._startDoNotRefreshTimer()};Owa.UIControls.ConversationReadingPane.prototype.ensureInView=function Owa$UIControls$ConversationReadingPane$ensureInView(a){this._setTimeout(this._ensureInViewEx,1,a)};Owa.UIControls.ConversationReadingPane.prototype.scrTo=function Owa$UIControls$ConversationReadingPane$scrTo(p,n,o){var f=this.oItemParts[p],m=this._getDescendant("divItmPrts");if(!f)return;this._stpScrAnm();var i=this._getDescendant("divItmPrtsScr"),l=i.get_ScrollTop(),d=i.get_ClientHeight(),c=f._get_Element().get_PositionalTop(),e=f._get_Element().get_OffsetHeight(),r=l+d,q=c+e,a;if(c>0)c+=m.get_PositionalTop();if(o)if(e>d)a=c-g;else a=c-(d-e)+g;else a=c-g;var j=i.get_ScrollHeight()-d;if(a>j)a=j;var k=l;if(k==a)return;if(n)this._getDescendant("divItmPrtsScr").set_ScrollTop(a);else{var b={};b.iCP=k;b.iEP=a;b.iV=h;b.iD=b.iEP>b.iCP?1:-1;b.iTmr=this._setInterval(this._scrAnm,t);this.oScrAnm=b;this.fIgnScr=1;this._scrAnm()}};Owa.UIControls.ConversationReadingPane.prototype.fceRptRf=function Owa$UIControls$ConversationReadingPane$fceRptRf(){this.fRptRf=1};Owa.UIControls.ConversationReadingPane.prototype.rfrsh=function Owa$UIControls$ConversationReadingPane$rfrsh(a,f,c,d,e,b){if(this._fDoNotRefresh)return;if(!a||a<m)a=m;this._updateRefreshTimer(a,f,c,d,e,b)};Owa.UIControls.ConversationReadingPane.prototype.cnclPrts=function Owa$UIControls$ConversationReadingPane$cnclPrts(a){this._fFlags&=~a};Owa.UIControls.ConversationReadingPane.prototype.fixPrts=function Owa$UIControls$ConversationReadingPane$fixPrts(a){this._fFlags|=a&(i|f);if(a&c)this._setTimeout(this._fixPrtsEx,1);else this._fixPrtsEx()};Owa.UIControls.ConversationReadingPane.prototype.rmvIPs=function Owa$UIControls$ConversationReadingPane$rmvIPs(c,i){for(var d={},b=0;b<c.length;b++){var a=this.oItemParts[c[b]];if(!a)continue;var j=a.get_ParentId(),g=false;if(!this.isDeletedItem(c[b])&&!this._fDeletedItemsHidden&&!i){this._fItemRemoved=true;g=true}if(a.get_IsSelected())if(a.oNxt)d[a.oNxt.get_Id()]=a.oNxt;else if(a.oPrv)d[a.oPrv.get_Id()]=a.oPrv;if(g)a.exp(1);else{this._selIP(c[b],1,1);if(a.oPrv)a.oPrv.oNxt=a.oNxt;if(a.oNxt)a.oNxt.oPrv=a.oPrv;for(var h in this.oItemParts)this.oItemParts[h].get_ParentId()==c[b]&&this.oItemParts[h].set_ParentId(j);a.set_RemoveElementInDisposing(true);a.dispose();delete this.oItemParts[c[b]];this._iGlobalMessageCount--}if(d[c[b]])delete d[c[b]]}var e=this.oItemParts[f];for(var k in d){e=d[k];break}var f=null;while(e){if(d[e.get_Id()])f=e.get_Id();e=this.oItemParts[e.get_Id()].oNxt}f&&this.setSel([f],0,1)};Owa.UIControls.ConversationReadingPane.prototype.get_GlobalMessageCount=function Owa$UIControls$ConversationReadingPane$prototype$get_GlobalMessageCount(){return this._iGlobalMessageCount};Owa.UIControls.ConversationReadingPane.prototype.expandAll=function Owa$UIControls$ConversationReadingPane$expandAll(){var b=[];for(var c in this.oItemParts)!this.oItemParts[c].get_HasExpansionData()&&b.push(c);if(b.length){var a=new oeReq(o,"ExpIP",0,this._createCallback(this._cbExpandAll));a.add("CnvId",this.sCnvId);a.addRg("IPId",b);a.send()}else this._internalExpandAll()};Owa.UIControls.ConversationReadingPane.prototype.collapseAll=function Owa$UIControls$ConversationReadingPane$collapseAll(){this._fSuppressOnExpandCollapse=true;for(var b in this.oItemParts){var a=this.oItemParts[b];a.get_IsExpanded()&&a.exp(1)}this._fSuppressOnExpandCollapse=false;this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype.get_ItemsExpandedCollapsedState=function Owa$UIControls$ConversationReadingPane$get_ItemsExpandedCollapsedState(){var a={};a.AllItemPartsExpanded=true;a.AllItemPartsCollapsed=true;for(var c in this.oItemParts){var b=this.oItemParts[c].get_IsExpanded();a.AllItemPartsExpanded&=b;a.AllItemPartsCollapsed&=!b}return a};Owa.UIControls.ConversationReadingPane.prototype._startDoNotRefreshTimer=function Owa$UIControls$ConversationReadingPane$prototype$_startDoNotRefreshTimer(){this._oDoNotRefreshTimer&&this._clearTimeout(this._oDoNotRefreshTimer);this._fDoNotRefresh=true;this._oDoNotRefreshTimer=this._setTimeout(function(){this._fDoNotRefresh=false;this._oDoNotRefreshTimer=null},r,null)};Owa.UIControls.ConversationReadingPane.prototype._updateRefreshTimer=function Owa$UIControls$ConversationReadingPane$prototype$_updateRefreshTimer(b,g,c,d,e,f){this._fForce_TimerRefresh=g?true:this._fForce_TimerRefresh;this._iUdGC_TimerRefresh=c?c:this._iUdGC_TimerRefresh;this._iUdTC_TimerRefresh=d?d:this._iUdTC_TimerRefresh;this._iUdUC_TimerRefresh=e?e:this._iUdUC_TimerRefresh;var a=(new Date).valueOf()+b;if(a>this._iRefreshTimerExpiresAtTicks){this._oRefreshTimer&&this._clearTimeout(this._oRefreshTimer);this._iRefreshTimerExpiresAtTicks=a;this._oRefreshTimer=this._setTimeout(function Owa$UIControls$ConversationReadingPane$prototype$_updateRefreshTimer$Callback(){this._iRefreshTimerExpiresAtTicks=0;this._oRefreshTimer=null;if(!this.get_IsDisposed()){this._refreshReadingPane(this._fForce_TimerRefresh,this._iUdGC_TimerRefresh,this._iUdTC_TimerRefresh,this._iUdUC_TimerRefresh,f);this._fForce_TimerRefresh=false;this._iUdGC_TimerRefresh=-1;this._iUdTC_TimerRefresh=-1;this._iUdUC_TimerRefresh=-1}},b,null)}};Owa.UIControls.ConversationReadingPane.prototype._removeFromSelection=function Owa$UIControls$ConversationReadingPane$prototype$_removeFromSelection(a){delete this.oSel[a];this._rgSelIds.remove(a)};Owa.UIControls.ConversationReadingPane.prototype._addToSelection=function Owa$UIControls$ConversationReadingPane$prototype$_addToSelection(a,b){this.oSel[a]=b;this._rgSelIds.add(a)};Owa.UIControls.ConversationReadingPane.prototype._fixContextMenuButtons=function Owa$UIControls$ConversationReadingPane$prototype$_fixContextMenuButtons(){var c=this.gtSel(),b=c[0];if(!b)return;var a=this.get_ContextMenu();a.showMenuItems(["divOpnMsg","divSOpnMsg"],true);var o=this.get_IsNewestOnTop();a.showMenuItems(["divNewOnTop"],!o);a.showMenuItems(["divOldOnTop"],o);var r=this.get_ItemsExpandedCollapsedState();a.showMenuItems(["divExpAll","divColAll"],true);a.enableMenuItems(["divExpAll"],!r.AllItemPartsExpanded);a.enableMenuItems(["divColAll"],!r.AllItemPartsCollapsed);var e=true;if(c.length>1){var j=["divR","divRA","divPR","divF","divMIA","divMIT","divMID","divS1","divS2"];a._getDescendant("divCR")&&j.push("divCR");a._getDescendant("divCht")&&j.push("divCht");a.showMenuItems(["divMR","divMU"],1);a.showMenuItems(j,0);isJnkEnbl()&&a.showMenuItems(["divJnk","divS5"],0);e=false}else{var s=this.oItemParts[b].fR,k=this.oItemParts[b].fPhishing,g=this.oItemParts[b].get_ItemType()==IT_PST,q=canItmRpl(this.oItemParts[b].get_ItemType());a.showMenuItem("divMU",s);a.showMenuItem("divMR",!s);a.showMenuItem("divIgnCnv",!this._fIsConversationIgnored);a.showMenuItem("divCanIgnCnv",this._fIsConversationIgnored);if(this.oItemParts[b].get_IsInJunkFolder()||k){a.showMenuItems(["divR","divRA","divPR","divF"],0);a._getDescendant("divCht")&&a.showMenuItem("divCht",0);a.showMenuItems(["divMIA","divMIT","divMID"],0)}else{if(q){a.showMenuItem("divR",1);if(a._getDescendant("divCht")){a.showMenuItem("divCht",1);gtMstr()&&gtMstr().g_iIM_SI&&a.showMenuItem("divCht",0)}a.showMenuItem("divRA",!g);a.showMenuItem("divPR",g);a.enableMenuItem("divPR",g)}else{a.showMenuItems(["divR","divRA","divPR"],0);a._getDescendant("divCht")&&a.showMenuItem("divCht",0)}var t=this.oItemParts[b].fMeetingRequest&&this.oItemParts[b].fResponseRequested&&!this.isDeletedItem(b)&&!k,l=["divMIA","divMIT","divMID","divS2"];a.showMenuItems(l,t);a.enableMenuItems(l,!this.oItemParts[b]._fOlderVersion);a.showMenuItems(["divF","divS1"],1)}a.enableMenuItems(["divMIA","divMIT","divMID"],!this.oItemParts[b].get_IsInArchiveMailbox());if(a._getDescendant("divCR")){a.showMenuItem("divCR",q);a.enableMenuItem("divCR",!isWP()&&!g)}if(isJnkEnbl()){a.showMenuItems(["divJnk","divS5"],true);if(this.oItemParts[b].get_IsInJunkFolder())if(k)a.showMenuItems(["divNtJnk","divS11"],0);else a.showMenuItems(["divNtJnk","divS11"],1);else a.showMenuItems(["divNtJnk","divS11"],0)}if(this.oItemParts[b].fDraft=="1"||!this.oItemParts[b]._sT||!canItemBeTracked(this.oItemParts[b]._sT))e=false}if(a._getDescendant("divDelPtg")){a.showMenuItem("divDelPtg",1);Owa.UIControls.DeletePolicyContextMenu.get_Instance(this.get_SubPage()).set_SelectedIds(c)}if(a._getDescendant("divMvPtg")){var b=c[0];if(this.oItemParts[b].get_IsInJunkFolder()||!g_oFldrMgr.isMyFId(this.oItemParts[b].sFId))a.showMenuItem("divMvPtg",0);else{a.showMenuItem("divMvPtg",1);Owa.UIControls.MovePolicyContextMenu.get_Instance(this.get_SubPage()).set_SelectedIds(c)}}isSWP()&&a.showMenuItems(["divS6","divMvToF","divCpToF"],0);for(var h=0,d=0;d<c.length&&!h;d++)h|=this.oItemParts[c[d]].get_ItemType()==IT_APV_RQ;a.showMenuItems(["divFIA","divS3"],!h);h&&a.showMenuItems(["divF"],0);var f=0;if(isFtEnab(FT_CAL))for(var d=0;d<c.length&&!f;d++)f|=isOfClss(this.oItemParts[c[d]].get_ItemType(),IT_SHR);for(var n=0,m=0,i=0,d=0;d<c.length;d++){n|=this.oItemParts[c[d]].fReplyRestricted;m|=this.oItemParts[c[d]].fReplyAllRestricted;i|=this.oItemParts[c[d]].fForwardRestricted}a.enableMenuItem("divF",!f&&!i);a.enableMenuItem("divFIA",!f&&!i);a.enableMenuItem("divR",!n);a.enableMenuItem("divRA",!m);if(g_oFldrMgr.gtFL(this.oItemParts[b].sFId)==FL_AMB)e=false;a._getDescendant("divOpDlvRp")&&a.enableMenuItems(["divSODL","divOpDlvRp"],e);var p=this._getDescendant("divCustomSep");if(!p)return;p.set_IsShown(false);a.showMenuItems(a.get_CustomMenuIds(),false)};Owa.UIControls.ConversationReadingPane.prototype._stActScr=function Owa$UIControls$ConversationReadingPane$_stActScr(){this.iScrTmr=0;this.fMkrScr=1};Owa.UIControls.ConversationReadingPane.prototype._gtScrdTo=function Owa$UIControls$ConversationReadingPane$_gtScrdTo(){for(var b=this._getDescendant("divItmPrtsScr"),d=b.get_ScrollTop()+b.get_ClientHeight()/3,c=0;c<this._get_ItemPartsCount();c++){var a=b.getDescendantById("divIP"+c);if(!a)continue;var e=a.get_PositionalTop(),f=a.get_OffsetHeight()+e;if(e<=d&&f>=d){this.sScrMkr=a.getAttribute("sItmId");break}}};Owa.UIControls.ConversationReadingPane.prototype._clrSel=function Owa$UIControls$ConversationReadingPane$_clrSel(b){for(var a in this.oSel)a!=b&&this._selIP(a,1)};Owa.UIControls.ConversationReadingPane.prototype._selIP=function Owa$UIControls$ConversationReadingPane$_selIP(a,c,e,d){var b=this.oItemParts[a];if(c)this._removeFromSelection(a);else this._addToSelection(a,b);this.sScrMkr=a;this.fMkrScr=0;!b.fGtExp&&b.sel(c,d)};Owa.UIControls.ConversationReadingPane.prototype._ensureInViewEx=function Owa$UIControls$ConversationReadingPane$_ensureInViewEx(k){var a=this.oItemParts[k];if(!a)return;var f=this._getDescendant("divItmPrtsScr"),e=f.get_ScrollTop(),j=f.get_ClientHeight(),d=a._get_Element().get_PositionalTop(),h=a._get_Element().get_OffsetHeight(),i=e+j,g=d+h,c=d<e,b=g>i;if(c==b)return;else if(b)this.scrTo(a.get_Id(),false,true);else c&&this.scrTo(a.get_Id())};Owa.UIControls.ConversationReadingPane.prototype._scrAnm=function Owa$UIControls$ConversationReadingPane$_scrAnm(){var a=this.oScrAnm,b=Math.floor(Math.abs(a.iEP-a.iCP)/2);if(b>a.iV*2)b=a.iV*2;if(b<h)b=h;a.iCP+=a.iD*b;if((a.iCP-a.iEP)*a.iD>=0)a.iCP=a.iEP;this._getDescendant("divItmPrtsScr").set_ScrollTop(a.iCP);a.iV=b;a.iCP==a.iEP&&this._stpScrAnm()};Owa.UIControls.ConversationReadingPane.prototype._stpScrAnm=function Owa$UIControls$ConversationReadingPane$_stpScrAnm(){if(this.oScrAnm){this._clearInterval(this.oScrAnm.iTmr);this.oScrAnm=0}this.fIgnScr=0};Owa.UIControls.ConversationReadingPane.prototype._refreshReadingPane=function Owa$UIControls$ConversationReadingPane$_refreshReadingPane(j,d,f,g,k){this.onBeforeUnload();if(!j&&d==0&&this._get_ItemPartsCount()==0){this._dispatchEvent(b,this.get_Id());return}if(!j&&(d<0||d==this._get_ItemPartsCount())&&(f<0||f==this._get_LocalItemPartsCount())&&(g<0||g==this._get_LocalUnreadItemPartsCount())&&!this._fItemRemoved)return;if(this._fPndRf)return;this._fPndRf=1;var i={};i.fNotFound=k;var c=new oeReq(o,"Rfrsh",i,Owa.Utility.createDelegate(this,this._cbRfrsh),POST,0,0,1);c.add("CnvId",this.sCnvId);var h=[],e=[];for(var a in this.oItemParts)if(this.oItemParts[a].get_IsExpanded()){h.push(a);this.oItemParts[a].get_InternetMId()&&e.push(this.oItemParts[a].get_InternetMId())}c.addRg("ExpIds",h);c.addRg("ExpInternetMIds",e);c.send()};Owa.UIControls.ConversationReadingPane.prototype._cbRfrsh=function Owa$UIControls$ConversationReadingPane$_cbRfrsh(a){if(this.get_IsDisposed())return;this._fPndRf=0;if(this.fRptRf){this.fRptRf=0;this.rfrsh(0,1);return}if(!cbOehST(a)||a.sErr){if(a.sErr==L_ErrorItemNotFound){if(a.oCtx&&a.oCtx.fNotFound)return;this.rfrsh(q,1,0,0,0,true)}else shwErrDlg(a);return}this._initRfrsh(a);this._dispatchEvent(k,this.get_Id())};Owa.UIControls.ConversationReadingPane.prototype._initRfrsh=function Owa$UIControls$ConversationReadingPane$_initRfrsh(A){var j=n.get_Current().createElement("div");j.set_IsShown(false);j.set_InnerHtml(A.sBody);var d=j.getChildById("divRfrsh");if(!d)return;if(d.getAttribute("iGC")){this._iGlobalMessageCount=d.getIntAttribute("iGC");this._iCurrentFolderMessageCount=d.getIntAttribute("iC");this._iSort=d.getIntAttribute("iSort")}if(this._iCurrentFolderMessageCount==0){this._dispatchEvent(b,this.get_Id());return}this.fMkrScr&&this._gtScrdTo();var k=this._getDescendant("divItmPrts"),s=this._getDescendant("divItmPrtsScr"),a=this.oItemParts[this.sScrMkr],e=0,u=0;if(a){while(!e&&a){for(var w=0;true;w++){var m=d.getDescendantById("divIP"+w);if(!m)break;var y=m.getAttribute("sItmId"),r=m.getIntAttribute("iInternetMId");if(y.startsWith(a.get_Id())||r&&r==a.get_InternetMId()){e=a.get_Id();break}}if(!e)a=a.oNxt}if(e){var z=a._get_Element();u=z.get_PositionalTop()-s.get_ScrollTop()}}for(var h=this.gtSel(),q=[],v=[],f=0;f<h.length;++f){v[h[f]]=1;if(this.oItemParts[h[f]].get_InternetMId())q[this.oItemParts[h[f]].get_InternetMId()]=1}this.oSel={};this._rgSelIds=[];this._disposeItemParts();this._removeCnvTooLongPart();k.set_InnerHtml(d.get_InnerHtml());var p=this._fCopyRestrictedConv,o=this._fPrintRestrictedConv;this.oItemParts={};this._insertCnvTooLongPart();this._initializeItemParts();if(this._fCopyRestrictedConv&&!p){this._attachEvent(this._oElement,"copy",canEvt);this._attachEvent(this._oElement,"dragstart",canEvt);this._attachEvent(this._oElement,"selectstart",canEvt);this._attachEvent(this._oElement,"contextmenu",canEvt)}else if(!this._fCopyRestrictedConv&&p){this._detachEvent(this._oElement,"copy",canEvt);this._detachEvent(this._oElement,"dragstart",canEvt);this._detachEvent(this._oElement,"selectstart",canEvt);this._detachEvent(this._oElement,"contextmenu",canEvt)}if(this._fPrintRestrictedConv&&!o){var g=this._getDescendant("divItmPrtsNoPrnt");k.addCssClass("noPrint");g.addCssClass("noScreen");g.removeCssClass("hiddenMsg")}else if(!this._fPrintRestrictedConv&&o){var g=this._getDescendant("divItmPrtsNoPrnt");g.addCssClass("hiddenMsg");g.removeCssClass("noScreen");k.removeCssClass("noPrint")}for(var l in this.oItemParts)(v[l]||q[this.oItemParts[l].get_InternetMId()])&&this._selIP(l,0,0,1);if(e){var t=this.oItemParts[e];if(t){var x=t._get_Element();s.set_ScrollTop(Math.max(x.get_PositionalTop()-u,0))}}j.remove(true);this.fixPrts(i|c);this._iCurrentFolderMessageCount==0&&this._dispatchEvent(b,this.get_Id())};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsEx=function Owa$UIControls$ConversationReadingPane$_fixPrtsEx(){if(this.get_IsDisposed())return;var a=this._fFlags;a&d&&this._fixPrtsSz(a&f);a&j&&this._fixPrtsBrd()};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsBrd=function Owa$UIControls$ConversationReadingPane$_fixPrtsBrd(){var e=0;for(var d in this.oItemParts){e++;var a=this.oItemParts[d];if(!a.get_IsSelected())var b=a._get_Element().get_PreviousSibling(),c=b&&(b.get_Id()=="divBrGap"||b.get_Id()=="divBrTxt")&&b.get_IsShown(),f=!a.oPrv&&!a.get_IsExpanded()||a.oPrv&&a.oPrv.get_IsSelected()&&!c}this._fFlags&=~j};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsSz=function Owa$UIControls$ConversationReadingPane$_fixPrtsSz(c){var b=this._getDescendant("divItmPrts").get_ClientWidth();if(!c&&b==this._iCW)return;this._iCW=b;if(b==0)return;for(var e in this.oItemParts){var g=this.oItemParts[e];g.fixPrtSz()}this._getDescendant(a)&&this._getDescendant(a).set_Width(this._getDescendant("divItmPrts").get_ClientWidth());this._fFlags&=~(d|f)};Owa.UIControls.ConversationReadingPane.prototype._insertCnvTooLongPart=function(){if(this._iGlobalMessageCount>this._iMaxItmPrts){var b="<div>"+Owa.Components.CssSprites.getImageMarkup("pipe-stop-l.png")+"</div>",d="<div>"+L_ConversationTooLongLine1+"</div>",e="<div>"+L_ConversationTooLongLine2+"</div>",c=null;if((this._iSort&p)>0){c="<div id='"+a+"' style='padding-bottom:30px;'>"+b+"<br/>"+b+"<br/>"+b+"<br/>"+d+e+"</div>";this._getDescendant("divItmPrts").insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,c)}else{c="<div id='"+a+"'>"+d+e+"<br/>"+b+"<br/>"+b+"<br/>"+b+"</div>";this._getDescendant("divItmPrts").insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,c)}}};Owa.UIControls.ConversationReadingPane.prototype._removeCnvTooLongPart=function(){var b=this._getDescendant(a);b&&b.remove(true)};Owa.UIControls.ConversationReadingPane.prototype._showMoveCopyDialog=function Owa$UIControls$ConversationReadingPane$_showMoveCopyDialog(b){var a=Owa.UIControls.FolderPickerDialog.get_Default();a.set_IsShowPublicFolder(true);a.set_ButtonCaptions([b?L_Cp:L_Mv]);a.set_Title(b?L_CpToFld:L_MvToFld);a.set_IsShowArchiveFolder(true);a.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;a.onButtonClick=cbCopyMoveItem;cbCopyMoveItem.fnCallback=Owa.Utility.createDelegate(this,this._cbMoveCopy);a.show()};Owa.UIControls.ConversationReadingPane.prototype._cbMoveCopy=function Owa$UIControls$ConversationReadingPane$_cbMoveCopy(e,h,f,g){for(var c=this.gtSel(),b=false,a=0;a<c.length;a++){if(!isMoveAllow(f,this.oItemParts[c[a]].get_ItemType())){alrt(L_MvUnmtchTyp);return}if(!b&&this.isDeletedItem(c[a]))b=true}var d=b?this._sDeletedItemsId:null;g_oFldrMgr.cpMvItms(wt(),this.get_SubPage(),d,this.gtSel(),e,g)};Owa.UIControls.ConversationReadingPane.prototype._cbExpandAll=function Owa$UIControls$ConversationReadingPane$_cbExpandAll(b){if(!cbOeh(b))return;var a=n.get_Current().createElement("div");a.set_InnerHtml(b.sBody);this._internalExpandAll(a)};Owa.UIControls.ConversationReadingPane.prototype._internalExpandAll=function Owa$UIControls$ConversationReadingPane$_internalExpandAll(b){this._fSuppressOnExpandCollapse=true;for(var c in this.oItemParts){var a=this.oItemParts[c];if(a.get_IsExpanded())continue;if(b&&b.getChildById(c)){var d=b.getChildById(c).getChildById("divExp");a.insertExpandedPart(d)}else a.exp()}this._fSuppressOnExpandCollapse=false;this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype._fireExpandCollapse=function Owa$UIControls$ConversationReadingPane$_fireExpandCollapse(){if(this._fSuppressOnExpandCollapse)return;this._dispatchEvent(l)};Owa.UIControls.ConversationReadingPane.prototype._onActionButtonStateChanged=function Owa$UIControls$ConversationReadingPane$_onActionButtonStateChanged(c,b){for(var d in this.oItemParts){var a=this.oItemParts[d].get_ActionButtons();a&&a._onButtonStateChanged(c,b)}};Owa.UIControls.ConversationReadingPane.createClass("Owa.UIControls.ConversationReadingPane",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/conversationsreadingpane.js".toLowerCase()]=1;!g_fModuleLoaded["freadcnv.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Pages");Owa.Pages.ReadConversationPage=function Owa$Pages$ReadConversationPage(a){Owa.Pages.ReadConversationPage.constructBase(this,[a])};var a=Owa.Pages.ReadConversationPage.prototype;a._fSupportHostedInSubPage=true;a.initialize=function Owa$Pages$ReadConversationPage$initialize(){Owa.Pages.ReadConversationPage.callBase(this,"initialize");var a=new Owa.UIControls.ConversationReadingPane(this._getDescendant("divConversationBody"),null,this.get_SubPage());this.get_SubPageController().setExpando("oRdCnv",a);this._oConversationReadingPane=a;a.initialize();var b=this.get_SubPageController().get_ParentController();if(b){this._cancelBubbleEvent(this._get_Element(),"selectstart");b.invokeFunction("onLoadReadingPane")}if(g_fRtl&&Owa.Utility.isIE()){var c=this._getDescendant("divItmPrtsScr");if(c)c._oDomNode.style.zoom="1.0"}this._setTimeout(updFrmPrsnc,IM_PRTM_FRM,this.get_SubPage());addPerfMarker("ReadConversation.Init.End")};a.dispose=function Owa$Pages$ReadConversationPage$dispose(){if(Owa.Utility.isDefined(typeof this._oConversationReadingPane)&&this._oConversationReadingPane){this._oConversationReadingPane.dispose();this._oConversationReadingPane=null}dispRwPrsnc(this.get_SubPage());this._utRecipientWellPresence=null;this._utQueryPresence=null;this.get_SubPageController().setExpando("oRdCnv",null);Owa.Pages.ReadConversationPage.callBase(this,"dispose")};a._initializeHotkeys=function Owa$Components$ReadConversationPage$_initializeHotkeys(){Owa.Pages.ReadConversationPage.callBase(this,"_initializeHotkeys");if(this._oHotKeyManager){this._oHotKeyManager.addHotKey(L_HkDlt,BID_DL);this._oHotKeyManager.addHotKey(Owa.KeyCodes.DELETE.toString(),BID_DL,true);this._oHotKeyManager.addHotKey("SHIFT+"+Owa.KeyCodes.DELETE,BID_PDLT,true);if(Owa.Utility.isMac()){this._oHotKeyManager.addHotKey(Owa.KeyCodes.BACK_SPACE.toString(),BID_DL,true);this._oHotKeyManager.addHotKey("SHIFT+"+Owa.KeyCodes.BACK_SPACE,BID_PDLT,true)}}};a._onNewItem=function Owa$Pages$ReadConversationPage$_onNewItem(){newMail(false,this)};a._onUserAction=function Owa$Pages$ReadConversationPage$_onUserAction(a,d){switch(a){case BID_PDLT:case BID_DL:var b=this.get_SubPageController().get_ParentController();if(b){var c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b);c&&c._onUserAction(a)}break;default:Owa.Pages.ReadConversationPage.callBase(this,"_onUserAction",[a,d])}};a.onResize=function Owa$Pages$ReadConversationPage$onResize(){this._fPendingResizeBodies=false;this._resizeBodiesInternal()};a.safeResizeBodies=function Owa$Pages$ReadConversationPage$safeResizeBodies(){if(this.get_IsShown(true))this._resizeBodiesInternal();else this._fPendingResizeBodies=true};a.onIsVisibleChanged=function Owa$Pages$ReadConversationPage$onIsVisibleChanged(a){Owa.Pages.FormSubPage.callBase(this,"onIsVisibleChanged",[a]);if(a){if(this._fPendingResizeBodies){this._fPendingResizeBodies=false;this._resizeBodiesInternal()}this._oConversationReadingPane.onShowHide(a)}};a.get_utRecipientWellPresence=function Owa$Pages$ReadConversationPage$get_utRecipientWellPresence(a){if(!this._utRecipientWellPresence&&a)this._utRecipientWellPresence=new Owa.IM.UriTable;return this._utRecipientWellPresence};a.get_utQueryPresence=function Owa$Pages$ReadConversationPage$get_utQueryPresence(a){if(!this._utQueryPresence&&a)this._utQueryPresence=new Owa.IM.UriTable;return this._utQueryPresence};a._resizeBodiesInternal=_resizeBodiesInternal;a._adjustMessageBody=_adjustMessageBody;a.pushFrmPrsnc=function Owa$Pages$ReadConversationPage$pushFrmPrsnc(a){pushFrmPrsnc(a,this.get_SubPage())};Owa.Pages.ReadConversationPage.createClass("Owa.Pages.ReadConversationPage",Owa.UIControls.SubPage)})();g_fModuleLoaded["freadcnv.js".toLowerCase()]=1;stJS("freadcnv.js")4z      YDeYDe>+Y   C    :https://mail.logica.com/owa/14.3.319.2/scripts/premium/freadcnv.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAVPMIIFSzCCBDOgAwIBAgIQC9oUlvTJTE7TC0j08zttrDANBgkqhkiG9w0BAQsFADBwMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNzdXJhbmNlIFNlcnZlciBDQTAeFw0xNzA4MTgwMDAwMDBaFw0xODEwMDExMjAwMDBaMF4xCzAJBgNVBAYTAkdCMRAwDgYDVQQHEwdSZWFkaW5nMRcwFQYDVQQKEw5Mb2dpY2EgTGltaXRlZDENMAsGA1UECxMERUlJUzEVMBMGA1UEAwwMKi5sb2dpY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzuYMsuU3piAX99KZg+15ZU9OKmiMfNCWme5/Iz8Agp2MxYMF4mLUcfss1x5fB0mMY+KvwAyfSyor56jR7dy3NKMreZRH1Q/YeFQW5MMs7paDof2KI5PtBspIXbQag6WYYtW10v/lkd+as+VD6jyhfU6+osD9HrbIK5dxToF6mfJqk/ky8nwphaA2FHoRKTdAMiQh9RS5IYKDzeaoPxLy+M+qvME3urniOQqd9Od7sqG4ml+wqS7+xB7UAl+ochD4A/rwewdhccwt91RNkn1E4j1RaZ6FYcuszvBcYih+m1wcQn/ACTrAAWV+ziST2h7LfUmEtMPVQ4swHYI8diuPfQIDAQABo4IB8TCCAe0wHwYDVR0jBBgwFoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKinxbIi/V/Ey/fqtiPTDEcBOGc5MCMGA1UdEQQcMBqCDCoubG9naWNhLmNvbYIKbG9naWNhLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwTAYDVR0gBEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwgYMGCCsGAQUFBwEBBHcwdTAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEySGlnaEFzc3VyYW5jZVNlcnZlckNBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQBQjp60tISk4788ERXDdQQKXRiEr75a1DYfG2ouVr/8OYlwgS5AwIEapDT7vqli2n3LbeeVgzUz2cZm9Bc/WjyYmSRlZtFYoSn6muFvYOjr0v5aiJXyFdz03emn93quN95xu4MnDmqoBsxEvyOHgO7TXhnpmO/aF9jA01L7SLfZI5TvVaOGQ2vAU6h5cOdXp18nuJGk+o1274scCkBK60dJwRaUtz7zMp2vr3FpOfvLqpkzBkUC8Iv0sXVfPgZFINyMTDW14QAbzWSsbr3EQEJ7ioAqjEBsScJjGFk5V+GDpyz3z9nLjoM/fWKl7sS5Z9VaztyzpEvomyQsd6sZPdubAC8AAwAAAAABAQAA request-method GET response-head HTTP/1.1 200 OK
Content-Length: 79550
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "04c95dae33ce1:0"
Accept-Ranges: bytes
Cache-Control: public,max-age=2592000
Last-Modified: Tue, 05 Feb 2013 21:00:40 GMT
X-Powered-By: ASP.NET
 original-response-headers Connection: Keep-Alive
Content-Length: 79550
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "04c95dae33ce1:0"
Accept-Ranges: bytes
Set-Cookie: CAS_LB_Service=R3418549887; path=/
Cache-Control: public,max-age=2592000
Last-Modified: Tue, 05 Feb 2013 21:00:40 GMT
X-Powered-By: ASP.NET
 uncompressed-len 0  6