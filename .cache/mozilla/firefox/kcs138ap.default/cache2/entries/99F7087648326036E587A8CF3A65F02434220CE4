if(typeof a_fAB=="undefined"){var g_fModuleLoaded={};!g_fModuleLoaded[".\\components/forest.js".toLowerCase()]&&(function(){Owa.Components.ForestControl=function Owa$Components$ForestControl(){Owa.Components.ForestControl.constructBase(this);this.initialize()};Owa.Components.ForestControl.createClass("Owa.Components.ForestControl",Owa.Components.Control);var a=Owa.Components.ForestControl.prototype;Owa.Components.ForestControl.prototype.initialize=function Owa$Components$ForestControl$initialize(){this._tr={};this._dfTr=0;this._dfId=0;this._fcsTr=0;Owa.Components.ForestControl.callBase(this,"initialize")};Owa.Components.ForestControl.prototype.dispose=function Owa$Components$ForestControl$dispose(){this.each(function(){this.dispose()});this._tr={};Owa.Components.ForestControl.callBase(this,"dispose")};a.addTr=function Owa$Components$ForestControl$addTr(b,a){this._tr[b]=a;a._frst=this;a._nm=b;if(a.hsSelNd()&&!this.gtFcsTr())this.stFcsTr(b);else a._stFcs(0)};a.rmTr=function Owa$Components$ForestControl$rmTr(b){var a=this.gtTr(b);if(!a)return;this.gtFcsTr()==a&&this.selDfN();delete this._tr[b]};a.svDfN=function Owa$Components$ForestControl$svDfN(){this._dfTr=this._fcsTr;this._dfId=this.gtFcsTr().gtSelNd().gtId()};a.stFcsTr=function Owa$Components$ForestControl$stFcsTr(b){var a=this.gtFcsTr();if(a&&a._nm==b)return;a&&a._stFcs(0);this._fcsTr=b;a=this.gtFcsTr();a&&a._stFcs(1)};a.gtFcsTr=function Owa$Components$ForestControl$gtFcsTr(){if(this._fcsTr)return this.gtTr(this._fcsTr)};a.gtTr=function Owa$Components$ForestControl$gtTr(a){return this._tr[a]};a.selDfN=function Owa$Components$ForestControl$selDfN(){var a=this.gtTr(this._dfTr);a&&a.selNdById(this._dfId)};a.each=function Owa$Components$ForestControl$each(a){for(var b in this._tr)a.call(this._tr[b])};a.clrHl=function Owa$Components$ForestControl$clrHl(){this.each(function(){this._clrHl()})};a.clrDrpHl=function Owa$Components$ForestControl$clrDrpHl(){this.each(function(){this.clrDrpHl()})};a.rfrshHl=function Owa$Components$ForestControl$rfrshHl(){this.each(function(){this._rfrshHl()})};a.syncSelNHl=function Owa$Components$ForestControl$syncSelNHl(){this.each(function(){this._syncSelNHl()})};a.qtEdtNd=function Owa$Components$ForestControl$qtEdtNd(){this.each(function(){this.qtEdtNd()})}})();g_fModuleLoaded[".\\components/forest.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/breadcrumbs.js".toLowerCase()]&&(function(){Owa.UIControls.Breadcrumbs=function Owa$UIControls$Breadcrumbs(a,b){Owa.UIControls.Breadcrumbs.constructBase(this,[a,b]);this._sMetadataString=null;this._iCount=0;this._iModule=this._getIntAttribute("iModule");this._attachEvent(this._getDescendant("spnMdNm"),"click",this._onClickModule);this._attachEvent(this._getDescendant("lnkShwELC"),"click",this._onClickShowELC)};Owa.UIControls.Breadcrumbs.prototype.set_Module=function Owa$UIControls$Breadcrumbs$set_Module(a){this._iModule=a;this._getDescendant("spnMdNm").set_TextContent(getModuleLink(a).get_TextContent().trim());this._updateFolderNameVisibility()};Owa.UIControls.Breadcrumbs.prototype.set_FolderName=function Owa$UIControls$Breadcrumbs$set_FolderName(a){this._getDescendant("spnFldNm").set_TextContent(a);this._updateFolderNameVisibility()};Owa.UIControls.Breadcrumbs.prototype.set_Metadata=function Owa$UIControls$Breadcrumbs$set_Metadata(a){this._sMetadataString=a;this._getDescendant("spnData").set_TextContent(a.format(this._iCount))};Owa.UIControls.Breadcrumbs.prototype.set_Count=function Owa$UIControls$Breadcrumbs$set_Count(a){this._iCount=a;this._sMetadataString&&this._getDescendant("spnData").set_TextContent(this._sMetadataString.format(a))};Owa.UIControls.Breadcrumbs.prototype.set_Width=function Owa$UIControls$Breadcrumbs$set_Width(a){a-=this._get_Element()._getEffectivePadding(Owa.Style.Side.Left);a-=this._get_Element()._getEffectivePadding(Owa.Style.Side.Right);if(a<0)a=0;this._get_Element().set_Width(a)};Owa.UIControls.Breadcrumbs.prototype.showProgress=function Owa$UIControls$Breadcrumbs$showProgress(){this._getDescendant("spnPrg").set_IsShown(true);this._getDescendant("spnFldNm").set_IsShown(false);this._getDescendant("spnData").set_IsShown(false);this._getDescendant("spnSpc").set_IsShown(false)};Owa.UIControls.Breadcrumbs.prototype.hideProgress=function Owa$UIControls$Breadcrumbs$hideProgress(){this._getDescendant("spnPrg").set_IsShown(false);this._getDescendant("spnData").set_IsShown(true);this._updateFolderNameVisibility()};Owa.UIControls.Breadcrumbs.prototype.showElcLink=function Owa$UIControls$Breadcrumbs$showElcLink(){this._getDescendant("lnkShwELC").set_IsShown(true)};Owa.UIControls.Breadcrumbs.prototype.hideElcLink=function Owa$UIControls$Breadcrumbs$hideElcLink(){this._getDescendant("lnkShwELC").set_IsShown(false)};Owa.UIControls.Breadcrumbs.prototype._updateFolderNameVisibility=function Owa$UIControls$Breadcrumbs$_updateFolderNameVisibility(){oFolderNameSpan=this._getDescendant("spnFldNm");var a=oFolderNameSpan.get_TextContent()!=this._getDescendant("spnMdNm").get_TextContent();oFolderNameSpan.set_IsShown(a);this._getDescendant("spnSpc").set_IsShown(a)};Owa.UIControls.Breadcrumbs.prototype._onClickModule=function Owa$UIControls$Breadcrumbs$_onClickModule(){switch(this._iModule){case NM_CAL:var a;if(isDf(typeof g_oCalTr)){var d=g_oCalTr.gtNdByAls(AL_DEF);a=d.gtFId()}else a=a_sLstFID;var c=getViewSubPageControllerByFolderId(a);c.invokeFunction("goToToday");break;case NM_CTS:g_oCntTr.selNd(g_oCntTr.gtNdByAls(AL_DEF));break;case NM_TSK:g_oTskTr.selNd(g_oTskTr.gtNdByAls(AL_DEF));updTskFlt();break;case NM_MAIL:var b=g_oMMFrst.gtTr("mail");b.selNd(b.gtNdByFId(a_sInbx));break;case NM_PF:g_oPblcFldrTree.selNd(g_oPblcFldrTree.gtNdByFId(a_sPFrt))}};Owa.UIControls.Breadcrumbs.prototype._onClickShowELC=function Owa$UIControls$Breadcrumbs$_onClickShowELC(){getCurrentViewSubPage().shwELCCmnt(true);this.hideElcLink()};function getModuleLink(b){var a=null;switch(b){case NM_CAL:a="lnkCal";break;case NM_CTS:a="lnkCtcts";break;case NM_TSK:a="lnkTsks";break;case NM_DOC:a="lnkDocs";break;case NM_PF:a="lnkPFs";break;default:a="lnkInbx"}return $(a)}Owa.UIControls.Breadcrumbs.createClass("Owa.UIControls.Breadcrumbs",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/breadcrumbs.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/NotificationDialog.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var a={},b=0;Owa.UIControls.NotificationDialog=function Owa$UIControls$NotificationDialog(b,a,e,c){Owa.UIControls.NotificationDialog.constructBase(this,[b.get_Id(),0,1,0,0,1,1]);this._isOpened=0;this._sSelectionClass="divNotificationsItemSelected";this._sDisabledClass="aNotificationsButtonDisabled";this._oContent=$(a+"Data");this._oBody=$(a+"DlgBdy");this._oTopBorderLeft=$(a+"DlgTopBorderLeft");this._oTopBorderRight=$(a+"DlgTopBorderRight");this._fAllowMultiSelect=0;this._fSelectFirstItemOnShow=1;this._fSetFocus=0;this._sTitlebarButtonId=c;this._rgButtons=e;this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"dblclick",this._onDoubleClick);this._attachEvent(this._get_Element(),"contextmenu",new Function("return (0)"));var d=new Owa.Components.ClientActionTable(Owa.Utility.createDelegate(this,this._onAction));this._oHotKeyManager=new Owa.Components.HotKeyManagerPage(d,Owa.Components.Application.get_RootSubPage());this._oHotKeyManager.addHotKey(L_HkSel,"selectall").addHotKey("esc","hide").addHotKey("tab","tab").addHotKey("shift+tab","shifttab").addHotKey("enter","enter").addHotKey("down","down").addHotKey("up","up").addHotKey("end","end").addHotKey("home","home");this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnShow().add(this._createCallback(this._onShow))};Owa.UIControls.NotificationDialog.getDialog=function Owa$UIControls$NotificationDialog$getDialog(b){return!a?null:a[b]};Owa.UIControls.NotificationDialog.addDialog=function Owa$UIControls$NotificationDialog$addDialog(c,d){if(a[c]==null){a[c]=d;b++}return a[c]};Owa.UIControls.NotificationDialog.hideAllDialogs=function Owa$UIControls$NotificationDialog$hideAllDialogs(){var b=Owa.Utility.getRootOwaWindow(),c=Owa.Dom.Window.get_Current();if(!c.equals(b))b._domWindow.Owa&&b._domWindow.Owa.UIControls&&b._domWindow.Owa.UIControls.NotificationDialog&&b._domWindow.Owa.UIControls.NotificationDialog.hideAllDialogs();else for(var d in a)a[d].hide()};Owa.UIControls.NotificationDialog.anyDialogsOpen=function Owa$UIControls$NotificationDialog$anyDialogsOpen(){for(var b in a)if(a[b].isOpened())return true;return false};Owa.UIControls.NotificationDialog.disposeAll=function Owa$UIControls$NotificationDialog$disposeAll(){for(var b in a)a[b].dispose()};Owa.UIControls.NotificationDialog.prototype.dispose=function Owa$UIControls$NotificationDialog$dispose(){if(!this._disped){this._get_Element().detachAllEvents();this._detachEvent(this._get_Element().get_OwnerDocument(),"keydown",this._onKeyDown);this._rgButtons=null;this._disped=1;removeDialogFromList(this.get_Id());this._oHotKeyManager.dispose();Owa.UIControls.NotificationDialog.callBase(this,"dispose")}};Owa.UIControls.NotificationDialog.prototype.isOpened=function Owa$UIControls$NotificationDialog$isOpened(){return this._isOpened};Owa.UIControls.NotificationDialog.prototype.selectFirstItem=function Owa$UIControls$NotificationDialog$selectFirstItem(b){var a=this.getItems();if(!a.length)return;this.unselectAllItems();this.selectItem(a[0],1,b)};Owa.UIControls.NotificationDialog.prototype.getItemById=function Owa$UIControls$NotificationDialog$getItemById(b){var a=null;this._oContent.forEachChild(function(c){if(c.getAttribute("_lnk")=="1"&&c.get_IsShown()&&b==c.get_Id())a=c});return a};Owa.UIControls.NotificationDialog.prototype.getItems=function Owa$UIControls$NotificationDialog$getItems(b){var a=[];this._oContent.forEachChild(function(c){c.getAttribute("_lnk")=="1"&&(b||c.get_IsShown())&&a.push(c)});return a};Owa.UIControls.NotificationDialog.prototype.getSelectedItem=function Owa$UIControls$NotificationDialog$getSelectedItem(){for(var b=this.getItems(),c=[],a=0;a<b.length;a++)b[a].getExpando("_sel")&&c.push(b[a]);return c};Owa.UIControls.NotificationDialog.prototype.unselectAllItems=function Owa$UIControls$NotificationDialog$unselectAllItems(){for(var b=this.getItems(),a=0;a<b.length;a++)this.selectItem(b[a],0)};Owa.UIControls.NotificationDialog.prototype.selectItem=function Owa$UIControls$NotificationDialog$selectItem(a,b,d){if(b)a.addCssClass(this._sSelectionClass);else a.removeCssClass(this._sSelectionClass);a.setExpando("_sel",b);var c=this.getSelectedItem();this._enableButtons(c.length);b&&d&&a.focus();return c};Owa.UIControls.NotificationDialog.prototype.removeItems=function Owa$UIControls$NotificationDialog$removeItems(b){for(var c=b.length,a=0;a<c;++a)b[a].remove(true);this.updateTitlebarButton()};Owa.UIControls.NotificationDialog.prototype.hide=function Owa$UIControls$NotificationDialog$hide(){if(this.isOpened()){this._oHotKeyManager.set_Enabled(false);Owa.UIControls.NotificationDialog.callBase(this,"hide")}};Owa.UIControls.NotificationDialog.prototype.show=function Owa$UIControls$NotificationDialog$show(b){if(!this.getItems().length||this.isOpened())return;Owa.UIControls.NotificationDialog.hideAllDialogs();this._prepareToShowDialog(b);!this._get_Element().get_IsShown()&&this._get_Element().set_IsShown(true);var a=this._getTitlebarButton(),c=getPopupXPositionForShowUnder(a,this._get_Element()),d=a.get_DocumentTop()+a.get_OffsetHeight()+1;adjustTopBordersAroundButton(this,a,this._oTopBorderLeft,this._oTopBorderRight);this._oHotKeyManager.set_Enabled(true);Owa.UIControls.NotificationDialog.callBase(this,"show",[c,d])};Owa.UIControls.NotificationDialog.prototype.toggleDialog=function Owa$UIControls$NotificationDialog$toggleDialog(){if(this.isOpened())this.hide();else{this._fSetFocus=1;this.show()}};Owa.UIControls.NotificationDialog.prototype.setItemsHtml=function Owa$UIControls$NotificationDialog$setItemsHtml(a){this._oContent.set_InnerHtml(a)};Owa.UIControls.NotificationDialog.prototype.updateTitlebarButton=function Owa$UIControls$NotificationDialog$updateTitlebarButton(d){var b=this._getTitlebarButton();if(!b)return;var a=this.getItems().length,c=b.get_IsShown();b.getDescendantById("spnRmT").set_TextContent(a.toString());if(!a&&c||d)showNotificationButton(this._sTitlebarButtonId,false);else if(a){c&&showNotificationButton(this._sTitlebarButtonId,false);showNotificationButton(this._sTitlebarButtonId,true)}};Owa.UIControls.NotificationDialog.prototype._onMouseDown=function Owa$UIControls$NotificationDialog$_onMouseDown(b){var a=this._findItem(b.get_Target());if(!a)return;if(b.isCtrlKeyDown()&&this._fAllowMultiSelect)if(a.getExpando("_sel"))this.selectItem(a,0);else this.selectItem(a,1);else{this.unselectAllItems();this.selectItem(a,1,1)}};Owa.UIControls.NotificationDialog.prototype._onClick=function Owa$UIControls$NotificationDialog$_onClick(a){var b=a.get_Target();if(b.getExpando("_disabled"))return;var d=b.get_Id(),c=this.getSelectedItem();this._handleButtonPress(d,c);a.preventDefault();a.cancelBubble()};Owa.UIControls.NotificationDialog.prototype._onDoubleClick=function Owa$UIControls$NotificationDialog$_onDoubleClick(){};Owa.UIControls.NotificationDialog.prototype._onAction=function Owa$UIControls$NotificationDialog$_onAction(k,j){var a=this.getItems(),b=-1,e=false;if(!this.isOpened())return;for(var c=0;c<a.length&&b<0;c++)if(a[c].getExpando("_sel"))b=c;var d=b!=-1,h=j;switch(k){case"selectall":this._selectAll();break;case"hide":this.hide();break;case"shifttab":e=true;case"tab":if(!this._rgButtons||this._rgButtons.length==0)return;for(var f=0,i=false,c=0;c<this._rgButtons.length;c++)if(h.get_Id()==this._rgButtons[c].get_Id()){f=c;i=true;break}if(i)if(f==this._rgButtons.length-1&&!e||f==0&&e)if(d)a[b].focus();else this.selectItem(a[0],1,1);else{var g=f+(e?-1:1);g>=0&&g<this._rgButtons.length&&this._rgButtons[g].focus()}break;case"enter":if(h.get_TagName().toLowerCase()=="button")return;if(this._onEnterPressed(h))return;break;case"down":if(b==a.length-1)break;if(d){this.selectItem(a[b],0);this.selectItem(a[b+1],1,1)}else this.selectItem(a[0],1);break;case"up":if(d&&b!=0){this.selectItem(a[b],0);this.selectItem(a[b-1],1,1)}break;case"end":if(b==a.length-1)break;d&&this.selectItem(a[b],0);this.selectItem(a[a.length-1],1,1);break;case"home":if(b<=0)break;d&&this.selectItem(a[b],0);this.selectItem(a[0],1,1)}};Owa.UIControls.NotificationDialog.prototype._selectAll=function Owa$UIControls$NotificationDialog$_selectAll(){if(this._fAllowMultiSelect){this.unselectAllItems();for(var b=this.getItems(),a=0;a<b.length;a++)this.selectItem(b[a],1)}};Owa.UIControls.NotificationDialog.prototype._findItem=function Owa$UIControls$NotificationDialog$_findItem(a){if(!this._oContent.contains(a))return 0;while(a&&a instanceof Owa.Dom.Element){if(a.getAttribute("_lnk")=="1")return a;a=a.get_ParentElement()}return 0};Owa.UIControls.NotificationDialog.prototype._enableButtons=function Owa$UIControls$NotificationDialog$_enableButtons(c){for(var b=0;b<this._rgButtons.length;b++){var a=this._rgButtons[b];if(a.getAttribute("preventDisable")&&a.getIntAttribute("preventDisable"))continue;if(c>0){a.removeCssClass(this._sDisabledClass);a.setExpando("_disabled",false)}else{a.addCssClass(this._sDisabledClass);a.setExpando("_disabled",true)}}};Owa.UIControls.NotificationDialog.prototype._handleButtonPress=function Owa$UIControls$NotificationDialog$_handleButtonPress(){};Owa.UIControls.NotificationDialog.prototype._prepareToShowDialog=function Owa$UIControls$NotificationDialog$_prepareToShowDialog(){var b=getViewSubPageControllerByFolderId(a_sLstFID);if(!b)return;var d=b.getVariable("Owa"),c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b),a=c?c.get_FilterContextMenu():null;if(!a)return;if(a.get_FromMenu()&&a.get_FromMenu().fIsOpen){a.get_FromMenu()._suppressClose();this._fRestoreFocusToFilterMenu=true}else if(a.fIsOpen){a._suppressClose();this._fRestoreFocusToFilterMenu=true}};Owa.UIControls.NotificationDialog.prototype._onEnterPressed=function Owa$UIControls$NotificationDialog$_onEnterPressed(){};Owa.UIControls.NotificationDialog.prototype._getTitlebarButton=function Owa$UIControls$NotificationDialog$_getTitlebarButton(){return $(this._sTitlebarButtonId)};Owa.UIControls.NotificationDialog.prototype._onClose=function Owa$UIControls$NotificationDialog$_onClose(){this._isOpened=0;applyNotificationButtonStyle(0,this._sTitlebarButtonId);if(this._fRestoreFocusToFilterMenu){var b=getViewSubPageControllerByFolderId(a_sLstFID);if(!b)return;var c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b),a=c?c.get_FilterContextMenu():null;if(a.get_FromMenu()&&a.get_FromMenu().fIsOpen)a.get_FromMenu()._enableClose();else a.fIsOpen&&a._enableClose();this._fRestoreFocusToFilterMenu=false}};Owa.UIControls.NotificationDialog.prototype._onShow=function Owa$UIControls$NotificationDialog$_onShow(){applyNotificationButtonStyle(1,this._sTitlebarButtonId);this._fSelectFirstItemOnShow&&this.selectFirstItem(0);if(this._fSetFocus){var a=this.getSelectedItem();a.length>0&&a[0].focus()}this._isOpened=1;this._fSetFocus=0};function removeDialogFromList(c){if(a[c]!=null){a[c]=null;b--}if(b==0)a={}}Owa.UIControls.NotificationDialog.createClass("Owa.UIControls.NotificationDialog",Owa.UIControls.Dialog)})();g_fModuleLoaded[".\\uicontrols/NotificationDialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/buddydialog.js".toLowerCase()]&&(function(){var a="divBddyDlg";Owa.UIControls.BuddyDialog=function Owa$UIControls$BuddyDialog(a){Owa.UIControls.BuddyDialog.constructBase(this,[a,"divBddy",[$("divBtnAcceptall"),$("divBtnDecline"),$("divBtnAccept")],Owa.Strings.Ids.BuddyRequestNotificationButtonId]);this._fSelectFirstItemOnShow=0};Owa.UIControls.BuddyDialog.getDialog=function Owa$UIControls$BuddyDialog$getDialog(){var b=Owa.UIControls.NotificationDialog.getDialog(a);if(b==null){var c=$(a);if(!c)return null;b=Owa.UIControls.NotificationDialog.addDialog(a,new Owa.UIControls.BuddyDialog(c))}return b};Owa.UIControls.BuddyDialog.prototype.updateTitlebarButton=function Owa$UIControls$BuddyDialog$updateTitlebarButton(a){Owa.UIControls.BuddyDialog.callBase(this,"updateTitlebarButton",[a])};Owa.UIControls.BuddyDialog.prototype.addBuddies=function Owa$UIControls$BuddyDialog$addBuddies(a){if(!a||!a.length)return;var d=gtIMType()==IM_TYPE_OCS,e="";if(!d)e=this._oContent.get_InnerHtml();var f=this.getSelectedItem(),c=null;if(f&&f.length>0)c=f[0].get_Id();for(var g=false,h=gtIMMgr(),b=0;b<a.length;b++){if(h&&h.IsBdy(a[b][0])){d&&decline(a[b][0],a[b][1]);continue}if(c&&(!d||a[b][0]==c))g=true;var i=this.getItemById(a[b][0]);if(i&&!d)continue;e+=this._constructItemHtml(a[b])}this._oContent.set_InnerHtml(e);this.updateTitlebarButton();if(g)this.selectItem(this.getItemById(c),1,1);else this.selectFirstItem(1);!this.isOpened()&&this.show(0)};Owa.UIControls.BuddyDialog.prototype.removeBuddy=function Owa$UIControls$BuddyDialog$removeBuddy(a){if(!isDf(typeof a))return;if(a==""){this._oContent.set_InnerHtml("");this.hide();this.updateTitlebarButton(true);return}var b=this.getItemById(a);if(!b)return;var c=this._getNextSelected(a);this.removeItems([b]);this.updateTitlebarButton();if(!c)this.hide();else this.selectItem(c,1,1)};Owa.UIControls.BuddyDialog.prototype._handleButtonPress=function Owa$UIControls$BuddyDialog$_handleButtonPress(d,a){switch(d){case"divBtnAcceptall":for(var c=this.getItems(),b=0;b<c.length;b++)accept(c[b].get_Id(),c[b].getAttribute("_type"));break;case"divBtnDecline":decline(a[0].get_Id(),a[0].getAttribute("_type"));break;case"divBtnAccept":accept(a[0].get_Id(),a[0].getAttribute("_type"))}};Owa.UIControls.BuddyDialog.prototype._getNextSelected=function Owa$UIControls$BuddyDialog$_getNextSelected(c){var a=this.getItems();if(a.length==1)return 0;for(var b=0;b<a.length;b++)if(a[b].get_Id()==c)return b==a.length-1?a[0]:a[b+1];return 0};Owa.UIControls.BuddyDialog.prototype._constructItemHtml=function Owa$UIControls$BuddyDialog$_constructItemHtml(a){var c="";if(a&&!isSlfUri(a[0])){var i=a[0],j=Owa.IM.IMUtils.NrmSipUri(i),k=parseInt(a[1]),m=a[2],l=a[3],f=a[4],b=a[5],e=a[6],g=isOCSPrv()?"oc.png":"lvlogo.png";switch(k){case Owa.IM.BUDDY_TYPE.WindowsLive:g="lvlogo.png";break;case Owa.IM.BUDDY_TYPE.OfficeCommunicator:g="oc.png";break;case Owa.IM.BUDDY_TYPE.Yahoo:g="yahoo.png"}c='<DIV class="divNotificationsItem" _sel="0" _lnk="1" tabIndex="0" id="'+i+'" _type="'+k+'">'+Owa.Components.CssSprites.getImageMarkup(g,'id="imgNtfyEnt"',"",null)+'<DIV id="c1" class="divNotificationsColumn1">';if(isMSNPrv())c+='<DIV id="c1Row1" class="divNotificationsColumn1Row1">'+htmlEnc(i)+'</DIV><DIV class="divNotificationsColumn1Row2 divNotificationsColumn1Row2ChatContent">'+m+"</DIV>";else{var n=l+'<span class="spanNotificationSep"></span><a href="#" onclick="opnNwMsg(\''+jsEnc(htmlEnc(j))+"', '"+l+'\')" class="aNotificationsEmailLink">'+htmlEnc(j)+"</a>",d="",h="";if((f===undefined||f=="")&&(b===undefined||b=="")&&(e===undefined||e==""))d=L_NoInformation;else{if(f!==undefined&&f!=""){d=f;if(b!==undefined&&b!="")d+=", "+b}else if(b!==undefined&&b!="")d=b;if(e!==undefined&&e!="")h=e}c+='<DIV id="c1Row1" class="divNotificationsColumn1Row1">'+n+'</DIV><DIV id="c1Row2" class="divNotificationsColumn1Row2">'+d+"</DIV>";if(h!="")c+='<DIV id="c1Row3" class="divNotificationsColumn1Row3">'+h+"</DIV>"}c+="</DIV></DIV>"}return c};function processBuddyInvitation(b,h,g){var c=new Owa.IM.Bdy(b,b,null,b);if(!isDf(typeof c)||!c)return;var e=gtRcpIM(c);if(!e){noIMInfoErr();return}var a={};a.sUri=e;a.prm1=e;a.iType=h;if(g==IM_ACPT)if(gtIMMgr()){var f=gtIMMgr().bdyLst,d=f.GetGroup(f.sOtherContactsID);if(d){a.sGroupID=imns.IMUtils.NrmGrpID(d.groupID);a.sGroupName=d.groupName}}sndIMReq(g,cbBuddyInviteRequest,0,a)}function accept(a,b){if(!isDf(typeof a)||!a||a=="")return;processBuddyInvitation(a,b,IM_ACPT)}function decline(a,b){if(!isDf(typeof a)||!a||a=="")return;processBuddyInvitation(a,b,IM_DCL)}Owa.UIControls.BuddyDialog.createClass("Owa.UIControls.BuddyDialog",Owa.UIControls.NotificationDialog)})();g_fModuleLoaded[".\\uicontrols/buddydialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/colorpickercontextmenu.js".toLowerCase()]&&(function(){var a="pickColor";Owa.UIControls.ColorPickerContextMenu=function Owa$UIControls$ColorPickerContextMenu(b,a,g,i,h,c,f,d,e){this.oColorPicker=new Owa.UIControls.ColorPicker(b,a,"",i,h,c,[L_MrClrs,L_None],f,d,e);a&&a.appendChild(this.oColorPicker._get_Element());Owa.UIControls.ColorPickerContextMenu.constructBase(this,[a,g]);this.set_SubPage(b);this.oColorPicker.get_OnColorSelected().add(this._createCallback(this._onPickInternal))};Owa.UIControls.ColorPickerContextMenu.create=function Owa$UIControls$ColorPickerContextMenu$create(g,f,h,j,i,b,e,c,d){var a=new Owa.UIControls.ColorPickerContextMenu(g,f,h,j,i,b,e,c,d);a.initialize();return a};Owa.UIControls.ColorPickerContextMenu.prototype.dispose=function Owa$UIControls$ColorPickerContextMenu$dispose(){this.oColorPicker.dispose();Owa.UIControls.ColorPickerContextMenu.callBase(this,"dispose")};Owa.UIControls.ColorPickerContextMenu.prototype._onPickInternal=function Owa$UIControls$ColorPickerContextMenu$_onPickInternal(b){this._fireOnSelect({sCommand:a,oMenuItem:b})};Owa.UIControls.ColorPickerContextMenu.createClass("Owa.UIControls.ColorPickerContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/colorpickercontextmenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/optionscontextmenu.js".toLowerCase()]&&(function(){var B="lnkOptions",z="divOptsMnuTopBorderLeft",x="divOptsMnuTopBorderRight",l="leftarrow",f="rightarrow",A="ThmPreview",C="ThmPreviews",h="divThemes",j="Themes",u="selThm",o="ThemeProgress",k="pickerDsbl",q=1e3,n=4,r=15,v=3e5,w=1e3,y="imgLiveLogo",s="lightUrl",t="darkUrl",e,d,g,m,p=0,b,c;Owa.UIControls.OptionsContextMenu=function Owa$UIControls$OptionsContextMenu(){Owa.UIControls.OptionsContextMenu.constructBase(this);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem))};Owa.UIControls.OptionsContextMenu.createClass("Owa.UIControls.OptionsContextMenu",Owa.UIControls.LazyLoadContextMenu);var a=Owa.UIControls.OptionsContextMenu.prototype,i;Owa.UIControls.OptionsContextMenu.get_Instance=function Owa$UIControls$OptionsContextMenu$get_Instance(){if(!i)i=Owa.UIControls.OptionsContextMenu._createInstance();return i};Owa.UIControls.OptionsContextMenu._createInstance=function Owa$UIControls$OptionsContextMenu$_createInstance(){i=new Owa.UIControls.OptionsContextMenu;return i};a.initialize=function Owa$UIControls$OptionsContextMenu$initialize(){Owa.UIControls.OptionsContextMenu.callBase(this,"initialize");if(isFtEnab(FT_THM)){e=0;d=this._getDescendant(j).get_Width();g=this._getDescendant(h).get_Width();m=-(g-d);c=[];var i=this._getDescendant(l),a=this._getDescendant(f);if(g>d)if(Owa.Dom.Document.get_Current().get_IsRtl()){this._attachEvent(i,"click",this._scroll);a.addCssClass("cmDsbld")}else{i.addCssClass("cmDsbld");this._attachEvent(a,"click",this._scroll)}else{i.set_Visibility(Owa.Style.Visibility.Hidden);a.set_Visibility(Owa.Style.Visibility.Hidden)}b=this._get_Element().getAllDescendantsById(A);for(var k=0;k<b.length;k++)this._attachEvent(b[k],"click",this._onSelectTheme)}this.get_OnPreShow().add(this._createCallback(this._onPreShow))};a._onPreShow=function Owa$UIControls$OptionsContextMenu$_onPreShow(){var c=$(B),a=this._getDescendant(z),b=this._getDescendant(x);adjustTopBordersAroundButton(this,c,a,b)};a.dispose=function Owa$UIControls$OptionsContextMenu$dispose(){this._get_Element().detachAllEvents();Owa.UIControls.OptionsContextMenu.callBase(this,"dispose")};a._onSelectMenuItem=function Owa$UIControls$OptionsContextMenu$_onSelectMenuItem(a){var b=a.sCommand;this._onSelect(b)};a._onSelect=function Owa$UIControls$OptionsContextMenu$_onSelect(a){switch(a){case"navToOptions":navOpts("Main");break;case"navToOptOOF":navOpts("OOF");break;case"navToOptPwd":navOpts("Pwd");break;case"navToOptRules":navOpts("Rules")}};a._scroll=function Owa$UIControls$OptionsContextMenu$_scroll(j){if(!this._oScrollTimer){var a={};a.fDirection=j.get_CurrentTarget().get_Id();var b=Owa.Dom.Document.get_Current().get_IsRtl();a.fIsRtl=b;var g=0-n,i=n;a.iIncrement=a.fDirection==f?b?i:g:b?g:i;a.iCurPos=b?this._getDescendant(h).get_Right():this._getDescendant(h).get_Left();var e=a.iCurPos+d,c=a.iCurPos-d;e=e>p?p:e;c=c<m?m:c;a.iEndPos=a.fDirection==f?b?e:c:b?c:e;a.iStartTime=(new Date).getTime();this._doScrollAnimation(a)}};a._doScrollAnimation=function Owa$UIControls$OptionsContextMenu$_doScrollAnimation(a){var d=(new Date).getTime()-a.iStartTime>q,c=this._getDescendant(h),b=a.iCurPos+a.iIncrement,e=a.fDirection==f?a.fIsRtl?b<a.iEndPos:b>a.iEndPos:a.fIsRtl?b>a.iEndPos:b<a.iEndPos;if(e&&!d){if(a.fIsRtl)c.set_Right(b);else c.set_Left(b);a.iCurPos=b;this._oScrollTimer=this._setTimeout(this._doScrollAnimation,r,a)}else{if(a.fIsRtl)c.set_Right(a.iEndPos);else c.set_Left(a.iEndPos);this._oScrollTimer=null;this._updateArrowStates()}};a._updateArrowStates=function Owa$UIControls$OptionsContextMenu$_updateArrowStates(){var c=this._getDescendant(h),e=Owa.Dom.Document.get_Current().get_IsRtl(),b=e?this._getDescendant(f):this._getDescendant(l),a=e?this._getDescendant(l):this._getDescendant(f),i=e?c.get_Right()==0:c.get_Left()==0;if(i){b.addCssClass("cmDsbld");this._detachEvent(b,"click",this._scroll)}else if(b.hasCssClass("cmDsbld")){b.removeCssClass("cmDsbld");this._attachEvent(b,"click",this._scroll)}var j=e?d>=g+c.get_Right():d>=g+c.get_Left();if(j){a.addCssClass("cmDsbld");this._detachEvent(a,"click",this._scroll)}else if(a.hasCssClass("cmDsbld")){a.removeCssClass("cmDsbld");this._attachEvent(a,"click",this._scroll)}};a._onSelectTheme=function Owa$UIControls$OptionsContextMenu$_onSelectTheme(b){var a=b.get_CurrentTarget();if(!e&&!a.hasCssClass(u)&&!this._oScrollTimer){e=1;this._iProgressTimer=this._setTimeout(this._showProgress,w);this._saveTheme(a.getAttribute("oV"),a.getAttribute("oP"),a.getAttribute("oB"))}};a._showProgress=function Owa$UIControls$OptionsContextMenu$_showProgress(){this._get_Element().getDescendantById(o).set_IsShown(1);this._get_Element().getDescendantById(j).addCssClass(k)};a._hideProgress=function Owa$UIControls$OptionsContextMenu$_hideProgress(){if(this._iProgressTimer){this._clearTimeout(this._iProgressTimer);this._iProgressTimer=0}var a=this._get_Element().getDescendantById(j);this._get_Element().getDescendantById(o).set_IsShown(0);a.hasCssClass(k)&&this._get_Element().getDescendantById(j).removeCssClass(k)};a._saveTheme=function Owa$UIControls$OptionsContextMenu$_saveTheme(c,e,d){var b=new oeReq("Options","SaveThmOpts",0,this._createCallback(this._cbSaveTheme),POST),a={};a.thmId=c;a.thmPath=e;a.brandPath=d;b.oCtx=a;b.add("thmId",c);b.send()};a._cbSaveTheme=function Owa$UIControls$OptionsContextMenu$_cbSaveTheme(a){var h;if(a.sErr){a.fST&&popLgn();e=0;this._hideProgress()}else if(a.oCtx){for(var g=null,c=0;c<b.length;c++)if(b[c].hasCssClass("selThm")){b[c].removeCssClass("selThm");g=b[c].getAttribute("oV")}else b[c].getAttribute("oV")==a.oCtx.thmId&&b[c].addCssClass("selThm");if(typeof a_sDcThemeId!="undefined"&&a_sDcThemeId!=null){var d=$(y);if(d!=null){var f=null;if(g==a_sDcThemeId&&a.oCtx.thmId!=a_sDcThemeId)f=d.getAttribute(t);else if(g!=a_sDcThemeId&&a.oCtx.thmId==a_sDcThemeId)f=d.getAttribute(s);f!=null&&d.setAttribute("src",f)}}this._loadTheme(a.oCtx.thmId,a.oCtx.thmPath,a.oCtx.brandPath)}else{e=0;this._hideProgress()}};a._loadTheme=function Owa$UIControls$OptionsContextMenu$_loadTheme(c,b,a){this._addImageToPrefetch("csssprites.png",b,c,a);this._addImageToPrefetch("csssprites2.png",b,c,a)};a._addImageToPrefetch=function Owa$UIControls$OptionsContextMenu$_addImageToPrefetch(e,f,h,g){var d=Owa.Dom.Document.get_Current(),i=d.get_Body(),a={};a.oImage=b;a.sFileName=e;a.sThmPath=f;a.sThmId=h;a.sBrandPath=g;var b=d.createElement("img");b.attachEvent("load",Owa.Utility.createArgumentContextDelegate(this,this._cbPrefetch,a));b.attachEvent("error",Owa.Utility.createArgumentContextDelegate(this,this._cbPrefetch,a));b.set_IsShown(false);i.appendChild(b);c.push(a);b.setAttribute("src",f.concat(e))};a._prefetchComplete=function Owa$UIControls$OptionsContextMenu$_prefetchComplete(b,d){if(b.get_CurrentTarget){var e=b.get_CurrentTarget();e.remove()}for(var a=0;a<c.length;a++)if(c[a].sFileName==d.sFileName&&c[a].sThmPath==d.sThmPath){c.splice(a,1);break}return c.length};a._cbPrefetch=function Owa$UIControls$OptionsContextMenu$_cbPrefetch(b,a){if(this._prefetchComplete(b,a))return;tryUpdCC(CC_THM,a.sThmId);Owa.MessageCache.emptyCache();Owa.PageHierarchy.getOwaTopWindow().invokeFunction("updateTheme",[a.sThmPath,a.sThmId,a.sBrandPath]);e=0;this._hideProgress();this._iCleanupTimer&&this._clearTimeout(this._iCleanupTimer);this._iCleanupTimer=this._setTimeout(this._cssCleanUp,v,a)};a._cssCleanUp=function Owa$UIControls$OptionsContextMenu$_cssCleanUp(a){Owa.PageHierarchy.getOwaTopWindow().invokeFunction("cleanThemeStyleSheets",[a.sThmPath,a.sBrandPath]);this._iCleanupTimer=0};a._createLoadHtmlContentRequest=function Owa$UIControls$OptionsContextMenu$_createLoadHtmlContentRequest(a){return new oeReq("Options","GetOptsMnu",0,a,GET)}})();g_fModuleLoaded[".\\uicontrols/optionscontextmenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/remindersnoozetimecombobox.js".toLowerCase()]&&(function(){Owa.UIControls.ReminderSnoozeTimeComboBox=function Owa$UIControls$ReminderSnoozeTimeComboBox(a,b){Owa.UIControls.ReminderSnoozeTimeComboBox.constructBase(this,[a,b])};Owa.UIControls.ReminderSnoozeTimeComboBox.prototype.updateSnoozeTime=function Owa$UIControls$ReminderSnoozeTimeComboBox$prototype$updateSnoozeTime(a){var b=null;if(a>=0)b=a>5?"-5":"0";for(var d=0;d<this._oDropDownList.getItemCount();d++){var c=getInt(this._oDropDownList.getValueByIndex(d)),e=this._oDropDownList.getDomItemByIndex(d);if(c<=0)e.set_IsShown(a+c>0||a==0&&c==0);else if(b==null)b=c.toString()}this._selectValue(b)};Owa.UIControls.ReminderSnoozeTimeComboBox.createClass("Owa.UIControls.ReminderSnoozeTimeComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/remindersnoozetimecombobox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/reminderdialog.js".toLowerCase()]&&(function(){var a="divRmdDlg",b=6e4,h=0,f=1,g=2,i=3,e="reminderNow",d="reminderPastdue",c="reminderOverdue";Owa.UIControls.ReminderDialog=function Owa$UIControls$ReminderDialog(a){Owa.UIControls.ReminderDialog.constructBase(this,[a,"divRmd",[$("divBtnDismissall"),$("divBtnDismiss"),$("divBtnOpenReminder"),$("divBtnSnooze")],Owa.Strings.Ids.ReminderNotificationButtonId]);this._oRmdSnzDD=new Owa.UIControls.ReminderSnoozeTimeComboBox($("divRmdSnzDD"),null);this._oRmdSnzDD.set_SubPage(this.get_SubPage());this._oRmdSnzDD.initialize();this.dtLastReminderTime=0;this.iTimeDifference=0;this.fSoundEnabled=getInt(this._getAttribute("fSoundEnabled"));this.iTimeOffset=this._getAttribute("iTimeOffset");this._dtNextReminderTime=0;this._oNextReminderItem=0;this._dtLastRefreshTime=0;this._rgTimeUnits=this._getAttribute("rgTU").split(",");this._iReminderTimer=0;this._iReminderDueInTimer=0;this._sNow=this._getAttribute("sNow");this._fAllowMultiSelect=1;this._sOverdueString=this._getAttribute("sOverdue");this.get_OnShow().add(this._createCallback(this._adjustWidth))};Owa.UIControls.ReminderDialog.getDialog=function Owa$UIControls$ReminderDialog$getDialog(){var b=Owa.UIControls.NotificationDialog.getDialog(a);if(b==null){var c=$(a);if(!c)return null;b=Owa.UIControls.NotificationDialog.addDialog(a,new Owa.UIControls.ReminderDialog(c))}return b};Owa.UIControls.ReminderDialog.prototype.dispose=function Owa$UIControls$ReminderDialog$dispose(){Owa.UIControls.ReminderDialog.callBase(this,"dispose");if(!this._disped||this._disped<=1){this._clearTimer();this._clearDueInTimer();this._oRmdSnzDD.dispose();this._disped++}};Owa.UIControls.ReminderDialog.prototype.setItemsHtml=function Owa$UIControls$ReminderDialog$setItemsHtml(b){Owa.UIControls.ReminderDialog.callBase(this,"setItemsHtml",[b]);var a=this;this._oContent.forEachChild(function(b){a._updateReminderItemDueIn(b)})};Owa.UIControls.ReminderDialog.prototype.get_Key=function Owa$UIControls$ReminderDialog$get_Key(){for(var d=this.getItems(true),b=[],c=0;c<d.length;c++){var a=d[c];if(a.get_IsShown()){b.push(a.get_Id());b.push(a.getAttribute("subj"));b.push(a.getAttribute("loc"));b.push(a.getAttribute("due"))}}return b};Owa.UIControls.ReminderDialog.prototype.get_LastKey=function Owa$UIControls$ReminderDialog$get_LastKey(){return this._rgKeys};Owa.UIControls.ReminderDialog.prototype.show=function Owa$UIControls$ReminderDialog$show(){this._rgKeys=this.get_Key();Owa.UIControls.ReminderDialog.callBase(this,"show",arguments)};Owa.UIControls.ReminderDialog.prototype.removeItems=function Owa$UIControls$ReminderDialog$removeItems(c,f,e){if(!f)f=OP_DIS;for(var h=c.length-1,a=0;a<c.length;++a){if(a==h){var b=this.getItems();this.nxtSelId=null;if(b.length>1)for(var d=0;d<b.length;d++)if(b[d].get_Id()==c[a].get_Id())this.nxtSelId=d==b.length-1?b[d-1].get_Id():b[d+1].get_Id()}var g=e&&e[a].fD;this._removeReminderItem(c[a],f,g);if(e&&!g){c[a].setAttribute("ck",e[a].ck);c[a].setAttribute("r",e[a].r)}}this.setReminderTimer();this.updateTitlebarButton()};Owa.UIControls.ReminderDialog.prototype.selectItem=function Owa$UIControls$ReminderDialog$selectItem(d,c,b){var a=Owa.UIControls.ReminderDialog.callBase(this,"selectItem",[d,c,b]);this._oRmdSnzDD.updateSnoozeTime(this.getMaxSnoozeTime());this._oRmdSnzDD.set_IsEnabled(a.length>0)};Owa.UIControls.ReminderDialog.prototype.showError=function Owa$UIControls$ReminderDialog$showError(a){this._getDescendant("divRmdErrTxt").set_TextContent(a);this._getDescendant("divRmdErr").set_IsShown(!!a)};Owa.UIControls.ReminderDialog.prototype.setReminderTimer=function Owa$UIControls$ReminderDialog$setReminderTimer(){this._clearTimer();this._updateReminderItemsRNT()};Owa.UIControls.ReminderDialog.prototype.getUTCDifference=function Owa$UIControls$ReminderDialog$getUTCDifference(){return getUTCDifference(this.iTimeOffset,this.iTimeDifference)};Owa.UIControls.ReminderDialog.prototype.getMaxSnoozeTime=function Owa$UIControls$ReminderDialog$getMaxSnoozeTime(){var c=this.getSelectedItem(),e=this.getUTCDifference(),a=0,d=0;if(c.length==1){var f=c[0];a=new Date(f.getAttribute("t"));if(a>e&&isCal(f.getAttribute("c")))d=1}return d?Math.round((a-e)/b):-1};Owa.UIControls.ReminderDialog.prototype.refresh=function Owa$UIControls$ReminderDialog$refresh(e){var a=this.getItems();if(!a.length)return;var c=this.getUTCDifference(),d=c-this._dtLastRefreshTime;if(d>=2e4||e){for(var b=0;b<a.length;b++)this._updateReminderItemDueIn(a[b]);this._dtLastRefreshTime=c}};Owa.UIControls.ReminderDialog.prototype._onDoubleClick=function Owa$UIControls$ReminderDialog$_onDoubleClick(b){var a=this._findItem(b.get_Target());if(!a)return;this._openReminderItems(new Array(a))};Owa.UIControls.ReminderDialog.prototype._adjustWidth=function Owa$UIControls$ReminderDialog$_adjustWidth(){var a=this._getDescendant("divBtnDismissall").get_ClientWidth()+this._getDescendant("divBtnDismiss").get_ClientWidth()+this._getDescendant("divBtnOpenReminder").get_ClientWidth(),c=86;a+=c;if(a>this._get_Element().get_Width()){this._get_Element().set_Width(a);var b=this._getTitlebarButton(),d=getPopupXPositionForShowUnder(b,this._get_Element()),e=b.get_DocumentTop()+b.get_OffsetHeight()+1;this._get_Element().set_Left(d);this._get_Element().set_Top(e)}};Owa.UIControls.ReminderDialog.prototype._handleButtonPress=function Owa$UIControls$ReminderDialog$_handleButtonPress(b,a){switch(b){case"divBtnSnooze":procRm(OP_SNZ,"Snooze",a,this.dtLastReminderTime,this._oRmdSnzDD.get_SelectedValue());break;case"divBtnDismiss":procRm(OP_DIS,"Dismiss",a,this.dtLastReminderTime);break;case"divBtnDismissall":procRm(OP_DIS,"Dismiss",this.getItems());break;case"divBtnOpenReminder":this._openReminderItems(a)}};Owa.UIControls.ReminderDialog.prototype._prepareToShowDialog=function Owa$UIControls$ReminderDialog$_prepareToShowDialog(a){this.refresh(a);this._setDueInReminderTimer();Owa.UIControls.ReminderDialog.callBase(this,"_prepareToShowDialog")};Owa.UIControls.ReminderDialog.prototype._onEnterPressed=function Owa$UIControls$ReminderDialog$_onEnterPressed(b){if(b.getAncestorById("divRmdSnzDD",a))return true;this._openReminderItems(this.getSelectedItem())};Owa.UIControls.ReminderDialog.prototype._removeReminderItem=function Owa$UIControls$ReminderDialog$_removeReminderItem(a,b,c){this._oNextReminderItem==a&&this._clearTimer();if(b==OP_DIS||c)a.remove(true);else{a.set_IsShown(false);this.selectItem(a,0)}};Owa.UIControls.ReminderDialog.prototype._clearDueInTimer=function Owa$UIControls$ReminderDialog$_clearDueInTimer(){if(this._iReminderDueInTimer){this._clearInterval(this._iReminderDueInTimer);this._iReminderDueInTimer=0}};Owa.UIControls.ReminderDialog.prototype._clearTimer=function Owa$UIControls$ReminderDialog$_clearTimer(){if(this._iReminderTimer){this._clearTimeout(this._iReminderTimer);this._iReminderTimer=0}};Owa.UIControls.ReminderDialog.prototype._setDueInReminderTimer=function Owa$UIControls$ReminderDialog$_setDueInReminderTimer(){this._clearDueInTimer();this._iReminderDueInTimer=this._setInterval(this._updateReminderItemsDueIn,3e4)};Owa.UIControls.ReminderDialog.prototype._updateReminderItemsDueIn=function Owa$UIControls$ReminderDialog$_updateReminderItemsDueIn(){this.isOpened()&&this.refresh()};Owa.UIControls.ReminderDialog.prototype._updateReminderItemsRNT=function Owa$UIControls$ReminderDialog$_updateReminderItemsRNT(){for(var f=this.getItems(true),c=this.getUTCDifference(),h=4501,b=0,d=0;d<f.length;d++){var a=f[d],e=new Date(a.getAttribute("r")),g=new Date(a.getAttribute("t"));if(e.getYear()==h)continue;if(c<e){b=a;a.setExpando("_sel",0);a.set_IsShown(false)}else if(!a.get_IsShown())if(c<g&&!a.getExpando("fired"))this._showActiveReminder(a);else a.set_IsShown(true)}if(b){this._dtNextReminderTime=new Date(b.getAttribute("r"));this._iReminderTimer=this._setTimeout(this._fireReminders,this._dtNextReminderTime-c)}this.updateTitlebarButton();this._oNextReminderItem=b};Owa.UIControls.ReminderDialog.prototype._fireReminders=function Owa$UIControls$ReminderDialog$_fireReminders(){this._iReminderTimer=0;this._showActiveReminder(this._oNextReminderItem);this.setReminderTimer()};Owa.UIControls.ReminderDialog.prototype._showActiveReminder=function Owa$UIControls$ReminderDialog$_showActiveReminder(a){this.selectItem(a,1,1);this._updateReminderItemDueIn(a);a.set_IsShown(true);this.updateTitlebarButton();!this.isOpened()&&this.show(1);this.fSoundEnabled&&plySnd();a.setExpando("fired")};Owa.UIControls.ReminderDialog.prototype._updateReminderItemDueIn=function Owa$UIControls$ReminderDialog$_updateReminderItemDueIn(a){var b=this._getReminderItemDueIn(a),q=b[0],p=b[1],k=b[2],j=b[3],l=b[4],n=a.getChildById("c2").getChildById("c2Time"),m=a.getChildById("c2").getChildById("c2Text"),i=a.getChildById("c3").getChildById("c3Time"),o=a.getChildById("c3").getChildById("c3Text");a.removeCssClass(d);a.removeCssClass(c);i.removeCssClass(e);switch(l){case h:i.addCssClass(e);k=this._sNow;break;case f:a.addCssClass(c);j+="<br>"+this._sOverdueString;break;case g:a.addCssClass(d);j+="<br>"+this._sOverdueString}n.set_InnerHtml(q);m.set_InnerHtml(p);i.set_InnerHtml(k);o.set_InnerHtml(j)};Owa.UIControls.ReminderDialog.prototype._getReminderItemDueIn=function Owa$UIControls$ReminderDialog$_getReminderItemDueIn(n){var r=this.getUTCDifference(),q=new Date(n.getAttribute("t")),p=n.getAttribute("d"),j=i,c=(q-r)/b;if(0<c)c=Math.floor(c);else{c=-c;if(c<=p)j=f;else j=g;c=Math.ceil(c)}if(c==0)return["","","","",h];else{var a=new Array(4);a[3]=a[2]=a[1]=0;a[0]=Math.floor(c/(7*24*60));if(2>a[0]){a[1]=Math.floor(c/(24*60))%7;if(2>a[1]&&0==a[0]){a[2]=Math.floor(c/60)%24;if(8>=a[2]&&0==a[1])a[3]=Math.floor(c)%60}}for(var m="",l="",e="",k="",s="",o=0,d=0;d<4;d++,o+=3)if(0!=a[d]){var u=new RegExp(this._getAttribute("re1"),"gi"),v=new RegExp(this._getAttribute("re2"),"gi"),t=u.test(a[d])?0:v.test(a[d])?1:2,s=this._rgTimeUnits[o+t];if(e!=""){m=e;l=k}e=""+a[d];k=s}}return[m,l,e,k,j]};Owa.UIControls.ReminderDialog.prototype._openReminderItems=function Owa$UIControls$ReminderDialog$_openReminderItems(b){for(var a=0;a<b.length;a++){var d="Item",f=b[a].getAttribute("c");if(isCal(f))d="PreFormAction";var c="?ae="+d;c+="&a=Open";c+="&t="+urlEnc(f);var e=getReminderItemId(b[a]);if(b[a].getAttribute("oid"))e=b[a].getAttribute("oid");c+="&id="+urlEnc(e);openItm(c,null,null,null,null,this.get_SubPage())}};Owa.UIControls.ReminderDialog.prototype._onClose=function Owa$UIControls$ReminderDialog$_onClose(){Owa.UIControls.ReminderDialog.callBase(this,"_onClose");this._clearDueInTimer();this._oRmdSnzDD.hideDropDown()};Owa.UIControls.ReminderDialog.createClass("Owa.UIControls.ReminderDialog",Owa.UIControls.NotificationDialog)})();g_fModuleLoaded[".\\uicontrols/reminderdialog.js".toLowerCase()]=1}!g_fModuleLoaded[".\\components/datePickerManager.js".toLowerCase()]&&(function(){var b="onNavigateMonth";Type.createNamespace("Owa.Components");Owa.Components.DatePickerManager=function Owa$Components$DatePickerManager(){this.fPublicFolder=this.fMV=this.oPfDp=this.oDp=this.oPfMp=this.oMp=0;Owa.Components.DatePickerManager.constructBase(this);this._errorCallback=this._createCallback(this._onError)};var a=Owa.Components.DatePickerManager.prototype;a.setPickers=function Owa$Components$DatePickerManager$setPickers(f,e,b,a){this.fPublicFolder=a;var c=this._initDatePicker(f,b),d=this._initMonthPicker(e,b);if(a){this.oPfDp&&this.oPfDp.dispose();this.oPfMp&&this.oPfMp.dispose();this.oPfDp=c;this.oPfMp=d}else{this.oDp&&this.oDp.dispose();this.oMp&&this.oMp.dispose();this.oDp=c;this.oMp=d}};a.getDp=function Owa$Components$DatePickerManager$getDp(){return this.fPublicFolder?this.oPfDp:this.oDp};a.getMp=function Owa$Components$DatePickerManager$getMp(){return this.fPublicFolder?this.oPfMp:this.oMp};a.getSelDts=function Owa$Components$DatePickerManager$getSelDts(){var a=this.fMV?this.getMp():this.getDp();return a.getSelDts()};a.setVT=function Owa$Components$DatePickerManager$setVT(a,d,e){this.fMV=a==DP_MTH;this.fPublicFolder=d;this.iMode=this.getDp().iMode=a;if(!e)return;var b=this.getDp(),c=this.getMp();if(!b||!c)return;b.shw(this.fMV);c.shw(!this.fMV)};a.selDs=function Owa$Components$DatePickerManager$selDs(a){this.getDp()&&this.getDp().setSDs(a)};a.selM=function Owa$Components$DatePickerManager$selM(a){this.getMp()&&this.getMp().selYM(a.gyr(),a.gmo()+1,1)};a.dispose=function Owa$Components$DatePickerManager$dispose(){this.get_OnNavigateMonth().clear();if(this.oPfDp){this.oPfDp.dispose();this.oPfDp=null}if(this.oPfMp){this.oPfMp.dispose();this.oPfMp=null}if(this.oDp){this.oDp.dispose();this.oDp=null}if(this.oMp){this.oMp.dispose();this.oMp=null}};a.getFreeBusy=function Owa$Components$DatePickerManager$getFreeBusy(b,a){getFB(a?a:this.getDp(),b,this._errorCallback)};a.get_OnNavigateMonth=function Owa$Components$DatePickerManager$get_OnNavigateMonth(){return this._getEventHandlerCollection(b)};a._initDatePicker=function Owa$Components$DatePickerManager$_initDatePicker(d,c){var a=new Owa.UIControls.DatePicker($(d),this._createCallback(this._onSelectedDateChange));a.set_SubPage(c);a.onErr=this._errorCallback;a.get_OnAfterMonthNavigate().add(this._createCallback(this._onNavigateMonth));var b=getViewSubPageController();if(b&&!b.invokeFunction("isAnonymousAccess"))if(!a.fFBLd){this.getFreeBusy([a_sLstFID],a);a.fFBLd=1}return a};a._initMonthPicker=function Owa$Components$DatePickerManager$_initMonthPicker(c,b){var a=new Owa.UIControls.MonthPicker($(c),this._createCallback(this._onSelectedDateChange));a.set_SubPage(b);return a};a._onNavigateMonth=function Owa$Components$DatePickerManager$_onNavigateMonth(){this._dispatchEvent(b,[this.getDp()])};a._onError=function Owa$Components$DatePickerManager$_onError(a){var b=this.fPublicFolder?$("divErrPfDp"):$("divErrDP");if(a.sErr)showErrInNav(b,a.sErr,a.sErrDbg);else hideErrInNav(b)};a._onSelectedDateChange=function Owa$Components$DatePickerManager$_onSelectedDateChange(){var c=this.getSelDts(),b=this.iMode==this.getDp().iMode;this.iMode=this.getDp().iMode;var a=getViewSubPageController();a&&a.invokeFunction("setVw",[c,this.iMode,0,0,0,b])};function getViewSubPageController(){var a=$("divMainView").getChildById("b"+a_sLstFID);return a?Owa.Components.SubPageControllerFactory.getControllerByElement(a):null}Owa.Components.DatePickerManager.createClass("Owa.Components.DatePickerManager",Owa.Components.Control)})();g_fModuleLoaded[".\\components/datePickerManager.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/CalendarContextMenu.js".toLowerCase()]&&(function(){var a="divCalPkr",b=-2;Owa.UIControls.CalendarContextMenu=function Owa$UIControls$CalendarContextMenu(a,b){Owa.UIControls.CalendarContextMenu.constructBase(this,[a,b])};Owa.UIControls.CalendarContextMenu.create=function Owa$UIControls$CalendarContextMenu$create(b,d,c){var a=new Owa.UIControls.CalendarContextMenu(b,d);a.set_SubPage(c);a.initialize();return a};Owa.UIControls.CalendarContextMenu.prototype._createSubmenu=function Owa$UIControls$CalendarContextMenu$_createSubmenu(c){return c.get_Id()==a?Owa.UIControls.ColorPickerContextMenu.create(this.get_SubPage(),c,this,5,3,getColorPropertyForContextMenu,b,true,null):Owa.UIControls.CalendarContextMenu.callBase(this,"_createSubmenu",[c])};function getColorPropertyForContextMenu(f,e,g,d){var c=$(a).getIntAttribute("_colorIndexStart"),b=f*d+e+c;return{sClass:"cal"+b,sValue:b}}Owa.UIControls.CalendarContextMenu.createClass("Owa.UIControls.CalendarContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/CalendarContextMenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/NewItemAlertDialog.js".toLowerCase()]&&(function(){var a=null,b=0,e="idNewItmDlg",d="divTstMnuTopBorderLeft",c="divTstMnuTopBorderRight";Owa.UIControls.NewItemAlertDialog=function Owa$UIControls$NewItemAlertDialog(g,i,h,k,f,b){var j='<div class="alertPopupShading"></div><div id="'+d+'" class="alertDialogTopBorder"></div><div id="'+c+'" class="alertDialogTopBorder"></div><div class="nwItmFrstLn">'+k+'<span class="nwItmTxtFrm">'+i+'</span></div><div class="nwItmScndLn"><span class="nwItmTxtSbj">'+h+"</span></div>";Owa.UIControls.NewItemAlertDialog.constructBase(this,[e,j,1,0]);this._fSuppressCloseCallback=0;this._fnOnClose=f;this._fnOnClick=b;this._oNavigationButton=$(g);this._attachEvent(this._get_Element(),"click",this._onClick);this.get_OnClose().add(this._createCallback(this._onClose));a=this};Owa.UIControls.NewItemAlertDialog.hideDialog=function Owa$UIControls$NewItemAlertDialog$hideDialog(b){if(a){a._fSuppressCloseCallback=b?1:0;a.hide()}};Owa.UIControls.NewItemAlertDialog.isType=function Owa$UIControls$NewItemAlertDialog$isType(b){return a&&a._oNavigationButton&&a._oNavigationButton.get_Id()==b?true:false};Owa.UIControls.NewItemAlertDialog.clearTimer=function Owa$UIControls$NewItemAlertDialog$clearTimer(){if(b){window.clearTimeout(b);b=0}};Owa.UIControls.NewItemAlertDialog.setTimer=function Owa$UIControls$NewItemAlertDialog$setTimer(c,a){b=window.setTimeout(c,a)};Owa.UIControls.NewItemAlertDialog.prototype.show=function Owa$UIControls$NewItemAlertDialog$show(){var e=getPopupXPositionForShowUnder(this._oNavigationButton,this._get_Element()),f=this._oNavigationButton.get_DocumentTop()+this._oNavigationButton.get_OffsetHeight()+1,a=this._getDescendant(d),b=this._getDescendant(c);adjustTopBordersAroundButton(this,this._oNavigationButton,a,b);Owa.UIControls.NewItemAlertDialog.callBase(this,"show",[e,f]);applyNotificationButtonStyle(1,this._oNavigationButton.get_Id())};Owa.UIControls.NewItemAlertDialog.prototype._onClick=function Owa$UIControls$NewItemAlertDialog$_onClick(){this._fnOnClick(this._oNavigationButton.get_Id());this.hide()};Owa.UIControls.NewItemAlertDialog.prototype._onClose=function Owa$UIControls$NewItemAlertDialog$_onClose(){applyNotificationButtonStyle(0,this._oNavigationButton.get_Id());!this._fSuppressCloseCallback&&this._fnOnClose();a=null};Owa.UIControls.NewItemAlertDialog.createClass("Owa.UIControls.NewItemAlertDialog",Owa.UIControls.Dialog)})();g_fModuleLoaded[".\\uicontrols/NewItemAlertDialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\components/Bounce.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components");var e=15,a=0,f=1,h=-9,d=2,g=2,c=4e3;Owa.Components.Bounce=function Owa$Components$Bounce(a){Owa.Components.Bounce.constructBase(this);this.oElement=a};var b=Owa.Components.Bounce.prototype;b.start=function Owa$Components$Bounce$start(){if(g_fRtl&&Owa.Utility.isIE())return;if(this.oIntervalTimer)return;if(this.oWindowTimer){this._clearTimeout(this.oWindowTimer);this.oWindowTimer=0}this.fRestart=true;this.iOriginalTop=this.oElement.get_Top();this.iOffset=0;this.iDirection=a;this.iUPPER_BOUND=h;this.iTotalTimes=0;this.oIntervalTimer=this._setInterval(this._move,e)};b.stop=function Owa$Components$Bounce$stop(){if(this.oWindowTimer){this._clearTimeout(this.oWindowTimer);this.oWindowTimer=0}this.fRestart=false};b._move=function Owa$Components$Bounce$_move(){if(this.iDirection==a){this.iOffset--;if(this.iOffset==this.iUPPER_BOUND){this.iUPPER_BOUND+=d;this.iDirection=f}}else{this.iOffset++;if(this.iOffset==0){this.iDirection=a;this.iTotalTimes++}}this.oElement.set_Top(this.iOriginalTop+this.iOffset);if(this.iTotalTimes>g){this._clearInterval(this.oIntervalTimer);this.oIntervalTimer=0;if(this.fRestart)this.oWindowTimer=this._setTimeout(this.start,c)}};Owa.Components.Bounce.createClass("Owa.Components.Bounce",Owa.Components.Control)})();g_fModuleLoaded[".\\components/Bounce.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/ActiveChatsDialog.js".toLowerCase()]&&(function(){var a="divActChtsDlg",b="cht";Owa.UIControls.ActiveChatsDialog=function Owa$UIControls$ActiveChatsDialog(a){Owa.UIControls.ActiveChatsDialog.constructBase(this,[a,"divActChts",new Array($("divBtnOpen")),Owa.Strings.Ids.ActiveChatsNotificationButtonId]);this._fSelectFirstItemOnShow=0;this._oChatReadState={};this._iNumberOfUnreadChats=0;this._oBounce=new Owa.Components.Bounce($(Owa.Strings.Ids.ActiveChatsNotificationButtonId).getChildById("spnRmT"))};Owa.UIControls.ActiveChatsDialog.getDialog=function Owa$UIControls$ActiveChatsDialog$getDialog(){var b=Owa.UIControls.NotificationDialog.getDialog(a);if(b==null){var c=$(a);if(!c)return null;b=Owa.UIControls.NotificationDialog.addDialog(a,new Owa.UIControls.ActiveChatsDialog(c))}return b};Owa.UIControls.ActiveChatsDialog.prototype.updateTitlebarButton=function Owa$UIControls$ActiveChatsDialog$updateTitlebarButton(a){Owa.UIControls.ActiveChatsDialog.callBase(this,"updateTitlebarButton",[a])};Owa.UIControls.ActiveChatsDialog.prototype.addChat=function Owa$UIControls$ActiveChatsDialog$addChat(d,c,b,a){if(a==null)a="";var e=this._constructItemHtml(d,c,b,a);this._oContent.set_InnerHtml(e+this._oContent.get_InnerHtml());this.updateTitlebarButton();this.selectFirstItem(0)};Owa.UIControls.ActiveChatsDialog.prototype.removeChat=function Owa$UIControls$ActiveChatsDialog$removeChat(a,e){if(a==null||a=="")return;var b=this.getItemById(formalizeChatId(a));if(!b)return;this.removeItems([b]);this.updateTitlebarButton();var c=this.getItems().length,d=this.getSelectedItem();c>0&&d&&d.length==0&&this.selectFirstItem(0);!e&&c==0&&this.hide()};Owa.UIControls.ActiveChatsDialog.prototype.updateChat=function Owa$UIControls$ActiveChatsDialog$updateChat(e,c,b,a){var d=this.getItemById(formalizeChatId(e));if(!d)return;var f=d.getAttribute("_type");if(c==null||c=="")c=e;if(!b||b=="")b=d.getChildById("c1").getChildById("c1Row1").get_TextContent();if(!a||a=="")a=d.getChildById("c1").getChildById("c1Row2").get_TextContent();this.removeChat(e,true);this.addChat(c,b,f,a)};Owa.UIControls.ActiveChatsDialog.prototype.updateParticipants=function Owa$UIControls$ActiveChatsDialog$updateParticipants(c,a){var b=this.getItemById(formalizeChatId(c));if(!b||a=="")return;b.getChildById("c1").getChildById("c1Row1").set_TextContent(a)};Owa.UIControls.ActiveChatsDialog.prototype.markReadState=function Owa$UIControls$ActiveChatsDialog$markReadState(a,d){var c=this.getItemById(formalizeChatId(a));if(!c)return;var b=this._oChatReadState[a];this._oChatReadState[a]=d;var e=c.getChildById("c1").getChildById("c1Row1");if(d){if(b===false&&this._iNumberOfUnreadChats>0)this._iNumberOfUnreadChats--;this._iNumberOfUnreadChats==0&&this.bounce(false);e.set_FontWeight(Owa.Style.FontWeight.Normal)}else{if(b===true)this._iNumberOfUnreadChats++;e.set_FontWeight(Owa.Style.FontWeight.Bold);this.bounce(true)}};Owa.UIControls.ActiveChatsDialog.prototype.bounce=function Owa$UIControls$ActiveChatsDialog$bounce(a){if(this.isOpened())return;if(a)this._oBounce.start();else this._oBounce.stop()};Owa.UIControls.ActiveChatsDialog.prototype.show=function Owa$UIControls$ActiveChatsDialog$show(){if(!this.isOpened()){this.bounce(false);Owa.UIControls.ActiveChatsDialog.callBase(this,"show",[0])}};Owa.UIControls.ActiveChatsDialog.prototype._onDoubleClick=function Owa$UIControls$ActiveChatsDialog$_onDoubleClick(b){var a=this._findItem(b.get_Target());if(!a)return;this._openWindow(normalizeChatId(a.get_Id()))};Owa.UIControls.ActiveChatsDialog.prototype._openWindow=function Owa$UIControls$ActiveChatsDialog$_openWindow(b){var a=gtIMMgr().GtChtSsn(b);if(a)a.OpenWindow();else this.removeChat(b)};Owa.UIControls.ActiveChatsDialog.prototype._handleButtonPress=function Owa$UIControls$ActiveChatsDialog$_handleButtonPress(b,a){switch(b){case"divBtnOpen":a&&a.length!=0&&this._openWindow(normalizeChatId(a[0].get_Id()))}};Owa.UIControls.ActiveChatsDialog.prototype._constructItemHtml=function Owa$UIControls$ActiveChatsDialog$_constructItemHtml(h,g,c,e){var d="",a=isOCSPrv()?"oc.png":"lvlogo.png",f=parseInt(c);switch(f){case Owa.IM.BUDDY_TYPE.WindowsLive:a="lvlogo.png";break;case Owa.IM.BUDDY_TYPE.OfficeCommunicator:a="oc.png";break;case Owa.IM.BUDDY_TYPE.Yahoo:a="yahoo.png"}var b=htmlEnc(e);d='<DIV class="divNotificationsItem" _sel="0" _lnk="1" tabIndex="0" id="'+formalizeChatId(h)+'" _type="'+c+'">'+Owa.Components.CssSprites.getImageMarkup(a,'id="imgNtfyEnt"',"",null)+'<DIV id="c1" class="divNotificationsColumn1"><DIV id="c1Row1" class="divNotificationsColumn1Row1">'+htmlEnc(g)+'</DIV><DIV id="c1Row2" class="divNotificationsColumn1Row2 divNotificationsColumn1Row2ChatContent" title="'+b+'">'+b+"</DIV></DIV></DIV>";return d};function formalizeChatId(a){return Owa.IM.IMUtils.FormalizeString(b,a)}function normalizeChatId(a){return Owa.IM.IMUtils.NormalizeString(b,a)}Owa.UIControls.ActiveChatsDialog.createClass("Owa.UIControls.ActiveChatsDialog",Owa.UIControls.NotificationDialog)})();g_fModuleLoaded[".\\uicontrols/ActiveChatsDialog.js".toLowerCase()]=1;var CACHE_MAX=8,g_oPrfCnsl=null,AE_F="Folder",AE_AL="AddressList",TR="divTr",CLR_NONE=-2,ID_DFTDOCM="ifDftDcMId",g_rgsLFids=[],g_sLstPFT=0,g_fShwNMBtn=0,g_fShwNVMBtn=0,g_fShwNFBtn=0,g_fShwPndGtErr=0,g_fShwPllErr=0,g_sMId="",g_sVMId="",g_sFId="",g_fAB=false,g_iPllInt=0,g_iPllPrdMs=0,g_oRmPllTmOut=0,g_iRmPllPrdMs=0,g_fNwMl=0,g_fNwVMl=0,g_fNwFx=0,M_MAIL="Mail",M_CAL="Calendar",M_CTS="Contacts",M_TSK="Tasks",M_DOC="Documents",M_PF="PublicFolders",g_rgActM=[],OP_DIS=0,OP_SNZ=1,EXPND_HAS_RPLC="_fHasReplicaOfSameVrsn",g_oHelpMenu=null,g_oLinksMenu=null,g_oPresenceMenu=null,g_oDatePickerManger=new Owa.Components.DatePickerManager,g_sExpIco,g_sClpsIco,g_oOpnLocDlg=null,g_fPLvLd=0,g_oPblcFldrTree=null,g_oMMFrst,g_oCalTr,g_oCntTr,g_oTskTr,g_oFolderTreeMenu,g_oPublicFolderTreeMenu,g_oNavigationTreeMenu,DEFAULT_CALENDAR_CLASS="trDefCalNd",g_rgTreeRegion=[],g_oNE=0,g_rgLiveHeaderContextMenus;!g_fModuleLoaded[".\\components/navigationUtility.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Pages");Owa.Pages.NavigationPage=function Owa$Pages$NavigationPage(a){if(isAB())this._fSupportHostSubPages=false;Owa.Pages.NavigationPage.constructBase(this,[a]);this._fIsStartPage=isDf(typeof a_fStPg)&&a_fStPg;this._fCloseOnEsc=!this._fIsStartPage};var a=Owa.Pages.NavigationPage.prototype;a._fSupportHostSubPages=true;a.initialize=function Owa$Pages$NavigationPage$initialize(){Owa.Pages.NavigationPage.callBase(this,"initialize");var d=new Cky("HoldingPhaseIIForTest");!d.IsLdd()&&this._setTimeout(loadPhaseIISprite,1);g_fAB=isAB();if(!g_fAB)this._oBreadcrumbs=new Owa.UIControls.Breadcrumbs($("divBreadcrumbs"));var f=[],g=this.get_SubPageController().get_UniqueId();$("divMainView").forEachChild(function(b){var a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().addChildController(a);a.initialize()});var e=Owa.Dom.Document.get_Current();e.attachEvent("selectstart",onSLSUnav);g_oEd.attachEvent("MarkAllAsRead",null,"cbOnMkAllRd");g_oEd.attachEvent("CopyItems",null,"cbCpMvItms");g_oEd.attachEvent("MoveItems",null,"cbCpMvItms");g_oEd.attachEvent("RenameNavigation",null,"onRenameNavigation");g_oEd.attachEvent("RenameFolder",null,"onRenameFolder");g_iLgn=2;g_sExpIco="expnd.gif";g_sClpsIco="cllps.gif";this._attachEvent($("divNavHostBody"),"mousedown",navigationResizeStart);Owa.Components.ToolbarCollection.get(this.get_SubPage()).addToolbars(["divAlertBar"],this.get_ActionTable());if(!g_fAB){g_rgsLFids[NM_MAIL]=a_sInbx;g_rgsLFids[NM_CTS]=a_sCtcts;g_rgsLFids[NM_TSK]=a_sTsks;g_rgsLFids[NM_PF]=a_sPFrt}g_fAB&&initAB();switch(a_iNM){case NM_CAL:onNavCal();break;case NM_MAIL:onNavMail();break;case NM_AB:case NM_CTS:onNavCnt();break;case NM_TSK:onNavTsk();break;case NM_PF:onNavPF()}chgAbLvSt(1);if(g_fAB)return;if(Owa.Utility.isDefined(typeof a_rgLiveHeaderMenuLinks)&&a_rgLiveHeaderMenuLinks.length>0)for(var a=0;a<a_rgLiveHeaderMenuLinks.length;a++){var c=$(a_rgLiveHeaderMenuLinks[a]);c&&c.attachEvent("click",openLiveHeaderMenu)}var b=$(TO);if(b)this.oFindSomeoneControl=Owa.UIControls.FindSomeone.create(getNavigationPage(),b);initIMSP();a_isMstr&&window.setTimeout(updSrvRcpCch,RCP_CCH_TM);window.setTimeout(setBrandbarPosition,1);window.setTimeout(positionMailboxQuotaBar,1);a_fPullNotif&&window.setTimeout(stPollN,3e4);a_fPushNotif&&window.setTimeout(stPollN,3e4);isDf(typeof a_oPndGt)&&window.setTimeout(stPndGt,1);this.layoutAlertBar();if(Owa.PageHierarchy.isInStartPage()){Owa.Dom.Window.get_Current().setTimeout(initCC,500);restartMapiNotificationsResetTimer()}Owa.Dom.Window.get_Current().setTimeout(detectPLT1,1);addPerfMarker("StartPage.Start",a_dtStartPageTimestamp);addPerfMarker("Navigation.Init.End")};var b=null,c=false;loadPhaseIISprite=function _loadPhaseIISprite(){c=false;var d=Owa.Dom.Document.get_Current(),e=d.get_Body(),a=d.createElement("img");b=a;a.attachEvent("load",cbLoadPhaseIISprite);a.set_IsShown(false);e.appendChild(b);a.setAttribute("src",getThmF("csssprites2.png"))};function cbLoadPhaseIISprite(){if(!c){var a=Owa.Dom.Document.get_Current();a.importStyleSheet(getThmF("csssprites2.css"))}b.remove();b=null}a.dispose=function Owa$Pages$NavigationPage$dispose(){expireMasterWindowCookies();g_oDatePickerManger.dispose();for(var a=0;a<g_rgTreeRegion.length;a++){var b=g_rgTreeRegion[a];b.detachAllEvents();b.clearAllExpandos()}Owa.Components.ToolbarCollection.get(this.get_SubPage()).dispose();if(isDf(typeof dspAB)){dspAB();var c=$("divDirLst");c&&initSNDL(c,1)}else{Owa.UIControls.NotificationDialog.disposeAll();this._oBreadcrumbs.dispose()}g_oFolderTreeMenu&&g_oFolderTreeMenu.dispose();g_oPublicFolderTreeMenu&&g_oPublicFolderTreeMenu.dispose();g_oNavigationTreeMenu&&g_oNavigationTreeMenu.dispose();if(Owa.Utility.isDefined(typeof a_rgLiveHeaderMenuLinks)&&a_rgLiveHeaderMenuLinks.length>0)for(var a=0;a<a_rgLiveHeaderMenuLinks.length;a++){var d=$(a_rgLiveHeaderMenuLinks[a]);d&&d.detachAllEvents()}this.oFindSomeoneControl&&this.oFindSomeoneControl.dispose();hideOpenMailboxDialog();isDf(typeof a_isMstr)&&a_isMstr&&gtIMMgr()&&gtIMMgr().GtChtSsnCnt()>0&&gtIMMgr().DsblAllChtsSsns(true);try{isDf(typeof a_isMstr)&&a_isMstr&&g_oPrfCnsl&&g_oPrfCnsl.disable&&g_oPrfCnsl.disable()}catch(f){}if(g_CC&&g_CC.oMailTipsRequesters)for(var e in g_CC.oMailTipsRequesters)g_CC.oMailTipsRequesters[e].set_MainPageRefreshed();window.oR=null;Owa.Pages.NavigationPage.callBase(this,"dispose")};a.onResize=function Owa$Pages$NavigationPage$onResize(){Owa.Pages.NavigationPage.callBase(this,"onResize");setNavigationDragHeight()};a._initializeHotkeys=function Owa$Components$NavigationPage$_initializeHotkeys(){Owa.Pages.NavigationPage.callBase(this,"_initializeHotkeys");this.addHk(L_HkNew,"new")};a.onResize=function Owa$Pages$NavigationPage$onResize(){Owa.Pages.NavigationPage.callBase(this,"onResize");this.layoutAlertBar()};a.onBeforeUnload=function Owa$Pages$NavigationPage$onBeforeUnload(){isDf(typeof a_oPndGt)&&a_oPndGt!=""&&a_oPndGt.disp();Owa.Pages.NavigationPage.callBase(this,"onBeforeUnload")};a._onUserAction=function Owa$Pages$NavigationPage$_onUserAction(b,a){switch(b){case"checknames":var c=a.get_Id();if(c==TO)this.oFindSomeoneControl.checkNames();else c=="divOpnMbxRw"&&showOpenMailboxDialog();break;case"lnkMySite":sfWinOpn(a.getAttribute("sMySiteUrl"));break;case"lnkOptions":showOptionsMenu();break;case"lnkAddrBk":addrBk();break;case Owa.Strings.Ids.HelpButtonId:if(!g_oHelpMenu){g_oHelpMenu=Owa.UIControls.ContextMenu.create($("divHelpContextMenu"),null,this.get_SubPage());g_oHelpMenu.get_OnSelect().add(onHelpCMLnk);g_oHelpMenu.get_OnClose().add(onHelpCMHid);!a_sPrivacyUrl&&g_oHelpMenu.showMenuItem("divHelpCMPrcy",false);!a_sCommunityUrl&&g_oHelpMenu.showMenuItem("divHelpCMCommunity",false);g_oHelpMenu.get_OnPreShow().add(onHelpPreShow)}g_oHelpMenu.showUnder($(Owa.Strings.Ids.HelpButtonId),1,true);applyNotificationButtonStyle(1,Owa.Strings.Ids.HelpButtonId);break;case"lnkRm":Owa.UIControls.ReminderDialog.getDialog().toggleDialog();break;case"lnkBr":Owa.UIControls.BuddyDialog.getDialog().toggleDialog();break;case"lnkNwCht":Owa.IM.IMUtils.ClickNewChatToast();break;case"lnkAc":Owa.UIControls.ActiveChatsDialog.getDialog().toggleDialog();break;case"lnkNwVMl":case"lnkNwFx":case"lnkNwMl":doDsplyVw(b);return;case"lnkNE":shwNEI();break;case"openlocdl":opnLoc();break;case"opendl":nav(NM_DOC,T_DOC,a.length?a[0]:wda("divDfm").docLib.uri);break;case"opennewdl":sfWinOpn(DLF_URI+urlEnc(a.length?a[0]:wda("divDfm").docLib.uri));break;case"deletedl":delLib();break;case"renamedl":edtLib();break;default:Owa.Pages.NavigationPage.callBase(this,"_onUserAction",[b,a])}};a._onNewItem=function Owa$Pages$NavigationPage$_onNewItem(){var a;try{var b=getViewSubPageControllerByFolderId(a_sLstFID);a=b.get_SubPage()}catch(c){}a&&a._onNewItem()};a.getNewMessageId=function Owa$Pages$NavigationPage$getNewMessageId(){return g_fNwMl?g_sMId:g_fNwVMl?g_sVMId:g_fNwFx?g_sFId:void 0};a.getLstVw=function Owa$Pages$NavigationPage$getLstVw(b){var a=getViewSubPageControllerByFolderId(b);return Owa.PageHierarchy.getVirtualListViewFromSubPageController(a)};a.get_Breadcrumbs=function Owa$Pages$NavigationPage$get_Breadcrumbs(){return this._oBreadcrumbs};a.layoutAlertBar=function Owa$Pages$NavigationPage$layoutAlertBar(){if(!g_fAB){$("divAlertBar").set_Width(getAlertBarWidth());this.get_Breadcrumbs().set_Width($("divAlertBarContainer").get_ClientWidth()-getAlertBarWidth())}};Owa.Pages.NavigationPage.createClass("Owa.Pages.NavigationPage",Owa.UIControls.SubPage)})();g_fModuleLoaded[".\\components/navigationUtility.js".toLowerCase()]=1;function getNavigationPage(){return Owa.Components.Application.get_RootSubPage()}function chgAbLvSt(a){if(isPkr()){g_fPLvLd=a;disPkrBtns(!a)}}function isAbPLvLd(){return g_fPLvLd==1}function getFolderTreeMenu(){if(!g_oFolderTreeMenu)g_oFolderTreeMenu=Owa.UIControls.ContextMenu.create($("divFtm"),null,getNavigationPage());return g_oFolderTreeMenu}function getPublicFolderTreeMenu(){if(!g_oPublicFolderTreeMenu)g_oPublicFolderTreeMenu=Owa.UIControls.ContextMenu.create($("divPFtm"),null,getNavigationPage());return g_oPublicFolderTreeMenu}function getNavigationTreeMenu(){if(!g_oNavigationTreeMenu)g_oNavigationTreeMenu=Owa.UIControls.CalendarContextMenu.create($("divNmCm"),null,getNavigationPage());return g_oNavigationTreeMenu}function onHelpPreShow(){adjustTopBordersAroundButton(g_oHelpMenu,$(Owa.Strings.Ids.HelpButtonId),g_oHelpMenu._get_Element().getDescendantById("divHelpMnuTopBorderLeft"),g_oHelpMenu._get_Element().getDescendantById("divHelpMnuTopBorderRight"))}function onHelpCMLnk(a){switch(a.sCommand){case"openHelp":opnHlp();break;case"openWhatsNew":opnHlp(a_sWhatsNewUrl);break;case"openPerfConsole":dbgCnsl();break;case"openSupport":opnHlp(a_sSupportUrl);break;case"openAbout":opnWin("?ae=Options&t=About",null,null,null,null,null,null,getNavigationPage());break;case"openPrivacyStatement":opnWin(a_sPrivacyUrl,null,null,null,null,null,null,getNavigationPage());break;case"openCommunitySite":opnWin(a_sCommunityUrl,null,null,null,null,null,null,getNavigationPage())}}function showOptionsMenu(){applyNotificationButtonStyle(1,Owa.Strings.Ids.OptionsButtonId);var a=Owa.UIControls.OptionsContextMenu.get_Instance(true);a.showUnder($(Owa.Strings.Ids.OptionsButtonId),1,true);a.get_OnClose().add(onOptCMHid)}function onSelectLiveHeaderMenuLink(a){if(!a.oMenuItem)return;var b=a.oMenuItem.getAttribute("_sUrl");if(!b)return;var c=a.oMenuItem.getAttribute("_openInNewWin");if(Owa.Utility.isDefined(typeof c)&&c)Owa.Dom.Window.get_Current().open(b);else Owa.Dom.Window.get_Current().navigate(b)}function initializeLiveHeaderMenu(){if(g_rgLiveHeaderContextMenus)return;g_rgLiveHeaderContextMenus=[];if(Owa.Utility.isDefined(typeof a_rgLiveHeaderMenuLinks)&&a_rgLiveHeaderMenuLinks.length>0)for(var a=0;a<a_rgLiveHeaderMenuLinks.length;a++){var c=$(a_rgLiveHeaderMenuLinks[a]);if(c){var e=c.getAttribute("_menuId"),d=$(e);if(d){var b=Owa.UIControls.ContextMenu.create(d,null,getNavigationPage());b.get_OnSelect().add(onSelectLiveHeaderMenuLink);g_rgLiveHeaderContextMenus[a_rgLiveHeaderMenuLinks[a]]=b}}}}function openLiveHeaderMenu(c){initializeLiveHeaderMenu();var a=c.get_Target();if(!a.get_Id())a=a.get_ParentElement();var b=g_rgLiveHeaderContextMenus[a.get_Id()];b&&b.showUnder(a,0,false)}function onHelpCMHid(){applyNotificationButtonStyle(0,Owa.Strings.Ids.HelpButtonId)}function onOptCMHid(){applyNotificationButtonStyle(0,Owa.Strings.Ids.OptionsButtonId)}function positionMailboxQuotaBar(){if(g_fAB)return;hideMailboxUsage();var c=$("divMbxQt"),a=$("divMbxQtRg"),b=a_iNM==NM_MAIL&&getInt(c.getAttribute("_fDsp"));a.set_IsShown(b);$("divSecNv").set_Top(b?a.get_OffsetHeight():0)}function setBrandbarPosition(){var i=$("divBrandOrgLogo"),h=$("imgLiveLogo"),a=$("divBrandLogo"),g=$("divBrandBar");if(i&&h)a.set_Width(i.get_OffsetWidth());else if(h)a.set_Width(h.get_OffsetWidth());else{var e=$("divBrandOrgName"),d=$("divBrandOrgLive"),c=0;if(g_fRtl)c=a.get_DocumentLeft()+a.get_OffsetWidth()-Math.min(e.get_DocumentLeft(),d.get_DocumentLeft());else c=Math.max(e.get_DocumentLeft()+e.get_OffsetWidth(),d.get_DocumentLeft()+d.get_OffsetWidth())-a.get_DocumentLeft();a.set_Width(c)}var b=$("divBrandLinkArea"),f=$("divLogOff"),m=0,k=g_fRtl?f.get_DocumentLeft()+f.get_OffsetWidth():a.get_DocumentLeft()+a.get_OffsetWidth(),j=g_fRtl?g.get_OffsetWidth()-a.get_DocumentLeft():g.get_OffsetWidth()-f.get_DocumentLeft();if(b){b.set_IsShown(true);b.set_Right(null);var m=b.get_OffsetWidth();b.set_Left(k);b.set_Right(j)}var l=k+m+j;g.set_MinWidth(l)}var g_fNRS=false,g_iNXS,g_iNYS,g_iNXMin,g_iNXMax,g_oNDivDrag,g_iNDivOffset;function navigationResizeStart(a){var c=a.get_Target();if(g_fNRS||!c||c.get_Id()!="imgNvDrag"||!a.isLeftButtonDown())return;a.preventDefault();a.cancelBubble();var b=$("divNavHostBody");g_fNRS=true;g_iNXS=a.get_ClientX();g_iNYS=a.get_ClientY();g_oNDivDrag=c;var e=g_oNDivDrag.get_ParentElement();g_oNDivDrag.replaceCssClass("nvDragging","hidden");g_oNDivDrag.replaceCssClass("dividerImgDragging","dividerImgNotDragging");e.replaceCssClass("nvDragging","hidden");g_iNDivOffset=g_oNDivDrag.get_Left()-g_iNXS;g_iNXMin=g_iMinVWW;g_iNXMax=b.get_OffsetWidth()-g_iMinRPW;var d=Owa.Dom.Document.get_Current().createElement("div");d.set_Id("divNvDragMask");b.appendChild(d);b.attachEvent("mouseup",navigationResizeEnd);b.attachEvent("mousemove",navigationResizeMove)}function navigationResizeEnd(){if(!g_fNRS)return;g_fNRS=false;var d=g_oNDivDrag.get_Left()-g_iNDivOffset-g_iNXS;if(g_fRtl)d*=-1;setNavigationPaneWidth($("divNvPn").get_OffsetWidth()+d,1);var b=$("divNavHostBody");b.getDescendantById("divNvDragMask").remove(true);g_oNDivDrag.set_Left(0);var e=g_oNDivDrag.get_ParentElement();g_oNDivDrag.replaceCssClass("hidden","nvDragging");g_oNDivDrag.replaceCssClass("dividerImgNotDragging","dividerImgDragging");e.replaceCssClass("hidden","nvDragging");g_oNDivDrag=null;b.detachEvent("mouseup",navigationResizeEnd);b.detachEvent("mousemove",navigationResizeMove);var a=getViewSubPageControllerByFolderId(a_sLstFID),c=a&&a.get_SubPage();c&&Owa.UIControls.DivSubPageController.isInstance(a)&&c.fireSizeChanged()}function navigationResizeMove(b){if(!g_fNRS||!b.isLeftButtonDown())return navigationResizeEnd(b);var a=b.get_ClientX();if(a<g_iNXMin)a=g_iNXMin;else if(a>g_iNXMax)a=g_iNXMax;g_oNDivDrag.set_Left(a+g_iNDivOffset);return false}function cbOnMkAllRd(d,e,a){if(!cbOeh(d))return;var b={};b.sFId=a;var c=getNavigationPage().getLstVw(b.sFId);if(c)c.mkAllRd();else updCnt(a,-1,0)}function shwOthrSPErr(){Owa.Components.Application.failWithWarning(htmlEnc(L_ErrNoOthrIns).format("<br><br>","<br>"))}function removeFolderView(a){var b=getViewSubPageControllerByFolderId(a);if(b)try{b.remove()}catch(c){}if(a==a_sInbx)return;if(g_oFldrMgr.gtFL(a)==FL_PUB)return;cancelFolderSubscription(a)}function getPresenceMenu(){if(!g_oPresenceMenu&&g_fIsIMEnab){var a=$("divIMmnu");if(a){g_oPresenceMenu=Owa.UIControls.ContextMenu.create(a);g_oPresenceMenu.get_OnSelect().add(OnPrsncCmClk)}}return g_oPresenceMenu}function initIMSP(){var a=gtMstr();if(a!=window)a_isMstr=0;if(g_fIsIMEnab){if(Owa.IM&&a_isMstr)g_IMMgr=new Owa.IM.IMMgr;Owa.IM.IMUtils.SetMenuSISO(true)}}function initSNDL(a,d){initSNL(a,d);var e=!!$("divAllAL");if(d){if(e){a.getDescendantById("divABMore").detachEvent("click",clkABMoreLess);a.getDescendantById("divABLess").detachEvent("click",clkABMoreLess)}Owa.Dom.Window.get_Current().detachEvent("resize",Owa.Utility.createContextDelegate($("divDirLst"),Owa.DomUtility.calculateVerticalScrollBar,$("divDirLst")))}else{if(e){a.getDescendantById("divABMore").attachEvent("click",clkABMoreLess);a.getDescendantById("divABLess").attachEvent("click",clkABMoreLess)}Owa.Dom.Window.get_Current().attachEvent("resize",Owa.Utility.createContextDelegate($("divDirLst"),Owa.DomUtility.calculateVerticalScrollBar,$("divDirLst")));Owa.DomUtility.calculateVerticalScrollBar($("divDirLst"))}if(!d)for(var c=a.getAllDescendantsById("divEnt"),b=0;b<c.length;b++)getInt(c[b].getAttribute("_sel"))&&snlSelEnt(a,c[b])}function isPkr(){return isDf(typeof g_fABpkr)&&g_fABpkr}function onClkABFld(c,d){if(g_oCntTr){var b=g_oCntTr.gtSelNd();b&&g_oCntTr.stNdSel(b,0)}var a=nvCtx();a.fAB=1;a.sAe=AE_AL;if(isPaaPkr())a.sMa="PickPaa";else if(isMblPkr())a.sMa="PickMobile";else a.sMa=isPkr()?"Pick":null;nav(NM_AB,d,c,a)}function clkABMoreLess(d){var a=d.get_Target();while(a&&a.getAttribute("_fMrLs")!="1")a=a.get_ParentElement();var b=a.get_Id()=="divABMore";$("divABMore").set_IsShown(!b);$("divABLess").set_IsShown(b);var c=$("divAllAL");if(b&&c.hasChildNodes()){c.set_IsShown(true);Owa.DomUtility.calculateVerticalScrollBar($("divDirLst"))}else if(!b){c.set_IsShown(false);Owa.DomUtility.calculateVerticalScrollBar($("divDirLst"))}else(new oeReq("DB","AllAddressList",null,cbGetAllAddressList)).send()}function cbGetAllAddressList(a){if(a.sErr){if(a.fST)popLgn();else shwErrDlg(a);return}if(a.sBody){var b=$("divAllAL");b.set_InnerHtml(a.sBody);b.set_IsShown(true);prepSNLEnts($("divDirLst"))}Owa.DomUtility.calculateVerticalScrollBar($("divDirLst"))}function cntCtx(b){var a=nvCtx();if(g_fAB)a.sMs="AddressBook"+(isPkr()?"Picker":"Browse");if(isPaaPkr())a.sMa="PAA";else if(isMblPkr())a.sMa="Mobile";a.fP=a.fR=1;a.fAB=g_fAB;a.sFltr=b;return a}function onNavCnt(){if(!g_oCntTr){var b=$("cntTr");if(b){var a=b.get_ParentElement().get_ParentElement();g_oCntTr=new Owa.UIControls.NavigationTree(b.get_FirstChild());g_oCntTr.set_SubPage(getNavigationPage());g_oCntTr.onSelChng=onCntSelChng;g_oCntTr.onClkNd=clearSearchOnClickTreeNode;g_oCntTr.setSelectionClass("NMTrSel");makeTreeScrollArea(g_oCntTr);a.attachEvent("dragenter",trStrtAutoScr);a.attachEvent("dragover",trStrtAutoScr);a.attachEvent("mouseout",endAutoScr);a.setExpando("oTgtTr",g_oCntTr);g_rgTreeRegion.push(a);initSNFlt($("divCntFlt"))}}!g_fAB&&g_oCntTr.selNd(g_oCntTr.gtNdByAls(AL_DEF))}function onCntSelChng(e,d){if(!d)return;var a=$("divDirLst");a&&snlUnsel(a);var c=d.gtFId();g_rgsLFids[NM_CTS]=c;var b=$("divCntFlt");nav(NM_CTS,T_CON,c,cntCtx(b?b.getExpando("iCurFlt"):0))}function onClkCntF(d){var a=getNavigationPage().getLstVw(a_sLstFID);if(!a)return;var c=$(d);if(NM_PF==a_iNM){a.stFltr(c.getExpando("iCurFlt"));if(a.rfrsh)a.rfrsh();else a.setExpando("fNdRfrsh",1)}else{var b=$("divDirLst");b&&snlUnsel(b);!g_oCntTr.hsSelNd()&&g_oCntTr.selNd(g_oCntTr.gtNdByAls(AL_DEF));nav(NM_CTS,T_CON,g_oCntTr.gtSelNd().gtFId(),cntCtx(c.getExpando("iCurFlt")))}}var g_oBddyLst=null;function gtTrRg(){return $("mailtree").get_ParentElement()}function onNavMail(){if(g_oMMFrst)return;g_oMMFrst=new Owa.Components.ForestControl;var b=gtTrRg();b.forEachChild(function(c){var b=c.get_FirstChild();if(b&&b.getAttribute("fTR"))switch(c.get_Id()){case"mailtree":var a=new Owa.UIControls.FolderTree(b,0,1);a.set_SubPage(getNavigationPage());a.onSelChng=onMailSelChng;a.onClkNd=clearSearchOnClickTreeNode;g_oMMFrst.addTr("mail",a);makeTreeScrollArea(a);break;case"favTr":var a=new Owa.UIControls.FavoriteTree(b);a.set_SubPage(getNavigationPage());a.onSelChng=onMailSelChng;a.onClkNd=clearSearchOnClickTreeNode;g_oMMFrst.addTr("favorite",a);makeTreeScrollArea(a);break;case"archivetree":var a=new Owa.UIControls.FolderTree(b,0);a.set_SubPage(getNavigationPage());a.onSelChng=onMailSelChng;a.onClkNd=clearSearchOnClickTreeNode;g_oMMFrst.addTr("archive",a);makeTreeScrollArea(a);break;case"buddytree":g_oBddyLst=new Owa.UIControls.BuddyListTree(b);g_oBddyLst.set_SubPage(getNavigationPage());g_oMMFrst.addTr("buddy",g_oBddyLst);makeTreeScrollArea(g_oBddyLst);break;default:var a=new Owa.UIControls.FolderTree(b,0);a.set_SubPage(getNavigationPage());a.onSelChng=onMailSelChng;a.onClkNd=clearSearchOnClickTreeNode;g_oMMFrst.addTr(c.get_Id(),a);makeTreeScrollArea(a)}});var c=$("divFtm");c&&Owa.Dom.Document.get_Current().get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,c);var a=b.get_ParentElement();a.attachEvent("dragenter",trStrtAutoScr);a.attachEvent("dragover",trStrtAutoScr);a.attachEvent("mouseout",endAutoScr);a.setExpando("oTgtTr",g_oMMFrst);g_rgTreeRegion.push(b.get_ParentElement());g_oMMFrst.svDfN()}var AUTOSCR_RNG=16,iAutoScr=0;function trStrtAutoScr(b){var a=b.get_CurrentTarget(),d=b.get_ClientY()-a.get_DocumentTop(),c;if(d<AUTOSCR_RNG&&a.get_ScrollTop()>0)c=-1;else if(d>a.get_OffsetHeight()-AUTOSCR_RNG&&a.get_ScrollTop()<a.get_ScrollHeight()-a.get_OffsetHeight())c=1;iAutoScr=c;if(c&&a.get_OffsetHeight()!=a.get_ScrollHeight()){if(autoScr._iAutoScrTId)if(autoScr._AutoScrS==c)return;else window.clearTimeout(autoScr._iAutoScrTId);autoScr._iAutoScrTId=Owa.Dom.Window.get_Current().setTimeout(autoScr,50);autoScr._oT=a;autoScr._AutoScrS=c}if(b._oEvent.dataTransfer)b._oEvent.dataTransfer.dropEffect=b._oEvent.dataTransfer.dropEffect;b.preventDefault();b.cancelBubble()}function autoScr(){var a=autoScr._oT.getExpando("oTgtTr");a&&a.clrDrpHl();autoScr._oT.set_ScrollTop(autoScr._oT.get_ScrollTop()+20*autoScr._AutoScrS);delete autoScr._AutoScrS;delete autoScr._iAutoScrTId}function endAutoScr(){iAutoScr=0}function onSLSUnav(a){var b=a.get_Target();if(b&&isInpt(b))return;a.preventDefault();a.cancelBubble()}function clearSearchOnClickTreeNode(e,d){if(d.equals(this.gtSelNd())){var a=getViewSubPageControllerByFolderId(d.gtFId());if(a){var c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(a),b=c?c.get_SearchControl():null;b&&b.clearSearch()}}}function onMailSelChng(g,b){if(!b)return;addPerfMarker("onMailSelChng.Start");ClientAction.add(ClientAction.Name.SwitchFolder);var c=nvCtx(),a=b.gtFId(),d=b._tr.gtSelELCNdFId?b._tr.gtSelELCNdFId():null,e=b.gtFCC();c.fP=a==g_rgsLFids[NM_MAIL]||a==a_sCal||a==g_rgsLFids[NM_CTS]||a==g_rgsLFids[NM_TSK];c.fR=isDrty(a)||a==a_sLstFID;var f=NM_MAIL;if(d&&d!=a)c.sELCId=d;else c.sELCId=null;c.fNC=b.isNC();nav(f,e,a,c)}function onPFSelChng(h,c){if(!c)return;var b=nvCtx(),a=c.gtFId(),d=c._tr.gtSelELCNdFId?c._tr.gtSelELCNdFId():null,e=c.gtFCC();b.fP=a==g_rgsLFids[NM_MAIL]||a==a_sCal||a==g_rgsLFids[NM_CTS]||a==g_rgsLFids[NM_TSK];b.fR=isDrty(a)||a==a_sLstFID;var g=NM_PF;if(isOfClss(e,T_CAL))b.fNoTdy=1;else if(isOfClss(e,T_CON)){var f=$("divPFCntFlt");b.sFltr=f?f.getExpando("iCurFlt"):0;b.fR=1}if(d&&d!=a)b.sELCId=d;else b.sELCId=null;nav(g,e,a,b)}function getCalVw(b){var a=getViewSubPageControllerByFolderId(b);return a?a.getVariable("g_oView"):null}g_oEd.attachEvent("DeleteFolder",null,"cbDelFldr");g_oEd.attachEvent("MoveFolder",null,"cbMoveFolder");function cbDelFldr(b,c,a){if(b.isErr())return;removeFolderView(a)}function cbMoveFolder(c,f,a,e,b){if(c.isErr())return;g_oFldrMgr.gtFL(a)!=g_oFldrMgr.gtFL(b)&&removeFolderView(a)}function getViewSubPageControllerByFolderId(b){var a=getFolderViewElementByFolderId(b);return a?Owa.Components.SubPageControllerFactory.getControllerByElement(a):null}function getFolderViewElementByFolderId(a){return $("divMainView").getChildById("b"+a)}function stDrty(b,c){var a=getFolderViewElementByFolderId(b);a&&a.setExpando("_drty",!c)}function isDrty(b,c){var a=getFolderViewElementByFolderId(b);return a?a.getExpando("_drty")||a.getExpando("_nc")&&!c:0}function updCnt(a,b,c){g_oEd.fire("UpdateCount",a,b,c)}function setPllInt(a){if(a!=g_iPllPrdMs){if(g_iPllInt){window.clearInterval(g_iPllInt);g_iPllInt=0}g_iPllPrdMs=a;g_iPllInt=window.setInterval(pollN,a)}}function setRmPllInt(a){if(a!=g_iRmPllPrdMs){if(g_oRmPllTmOut){window.clearInterval(g_oRmPllTmOut);g_oRmPllTmOut=0}g_iRmPllPrdMs=a;g_oRmPllTmOut=window.setInterval(rmpollN,a)}}function stPndGt(){a_oPndGt=new pndGt}function stPollN(){if(isFtEnab(FT_NOTIF)){if(a_fPullNotif){pollN();setPllInt(a_iNtInt)}if(a_fPushNotif){rmpollN();setRmPllInt(a_iRmInt)}}}function detectPLT1(){var c="forms/premium/plt1.aspx",b=Owa.Dom.Document.get_Current(),a=b.createElement("img");a.setAttribute("src",c);a.set_IsShown(false);b.appendChild(a)}function pollN(){var b=new oeReq("Notify","Poll",null,cbPoll,null,null,0,1),a=Owa.UIControls.ReminderDialog.getDialog();a&&a.dtLastReminderTime&&b.add("LRT",new Date(a.dtLastReminderTime));b.send()}function rmpollN(){var b=new oeReq("Notify","ReminderPoll",true,cbPoll,null,null,0,1),a=Owa.UIControls.ReminderDialog.getDialog();a&&a.dtLastReminderTime&&b.add("LRT",new Date(a.dtLastReminderTime));b.send()}function cbPoll(a,b){try{b=false;if(a.oCtx==true)b=true;if(a.sErr)if(a.fST)rplLgn();else shwNE(1,a,b);else{shwNE(0,0,b);if(a.sBody!=""){eval(a.sBody);if(isDrty(a_sLstFID,1)){var c=getViewSubPageControllerByFolderId(a_sLstFID);c&&c.invokeFunction("refresh",[null,null,null,null,true])}window.oR=a;return true}}}catch(d){if(!Owa.BrowserErrorHandler.isAccessDeny(d.message))throw d;}}function rmNotfy(m,i,h,l,g){var a=Owa.UIControls.ReminderDialog.getDialog();if(!a)return;a.iTimeOffset=m;if(i){a.iTimeDifference=0;a.dtLastReminderTime=h;var j=a.getUTCDifference(),k=new Date(h);a.iTimeDifference=k-j;a.setItemsHtml(l)}if(g)a.showError(g);else a.showError("");a.setReminderTimer();a.updateTitlebarButton();if(!a.getItems().length){a.isOpened()&&a.hide();return}if(a.isOpened()){var c=null;if(a.nxtSelId)c=a.getItemById(a.nxtSelId);if(!c)c=a.getItems()[0];a.unselectAllItems();a.selectItem(c,1,1)}if(i){var b=a.get_LastKey(),f=a.get_Key(),e=b&&b.length==f.length;if(e)for(var d=0;d<b.length;d++)if(b[d]!=f[d]){e=false;break}if(!e){!a.isOpened()&&a.show(1);a.fSoundEnabled&&plySnd()}}}function shwNM(a){g_fShwNMBtn=a;showNotificationButton(Owa.Strings.Ids.NewMailNotificationButtonId,a)}function shwNVM(a){g_fShwNVMBtn=a;showNotificationButton(Owa.Strings.Ids.NewVoiceMailNotificationButtonId,a)}function shwNF(a){g_fShwNFBtn=a;showNotificationButton(Owa.Strings.Ids.NewFaxNotificationButtonId,a)}function shwNE(c,b,d){try{var a=getViewSubPageControllerByFolderId(a_sLstFID);if(d)g_fShwPndGtErr=c;else g_fShwPllErr=c;if(a){(b!=0||!(g_fShwPndGtErr||g_fShwPllErr))&&a.invokeFunction("setNEI",[b]);showNotificationButton(Owa.Strings.Ids.ErrorNotificationButtonId,g_fShwPndGtErr||g_fShwPllErr)}}catch(e){}}function shwNwItmDlg(c,e,a,d){var f=$(a);if(f){Owa.UIControls.NewItemAlertDialog.hideDialog(1);Owa.UIControls.NewItemAlertDialog.clearTimer();if(!Owa.UIControls.NotificationDialog.anyDialogsOpen()){var b=new Owa.UIControls.NewItemAlertDialog(a,c,e,d,hideInbxNB,dsplyVw);b.show();Owa.UIControls.NewItemAlertDialog.setTimer("Owa.UIControls.NewItemAlertDialog.hideDialog();",5e3)}else Owa.UIControls.NewItemAlertDialog.setTimer("hideInbxNB();",5e3);window.setTimeout("updCmp('"+window+"')",5001)}}function hideInbxNB(){if(!g_fAB&&a_sLstFID==a_sInbx){g_fShwNMBtn==1&&shwNM(0);g_fShwNVMBtn==1&&shwNVM(0);g_fShwNFBtn==1&&shwNF(0)}}function dsplyVw(a){setTimeout('doDsplyVw("'+a+'")',1)}function doDsplyVw(f){var a;g_fNwMl=0;g_fNwVMl=0;g_fNwFx=0;switch(f){case Owa.Strings.Ids.NewMailNotificationButtonId:shwNM(0);if(g_sMId)a=g_sMId;g_fNwMl=1;break;case Owa.Strings.Ids.NewVoiceMailNotificationButtonId:shwNVM(0);if(g_sVMId)a=g_sVMId;g_fNwVMl=1;break;case Owa.Strings.Ids.NewFaxNotificationButtonId:shwNF(0);if(g_sFId)a=g_sFId;g_fNwFx=1}if(a_sLstFID==a_sInbx){var e=getNavigationPage().getLstVw(a_sLstFID),d=getViewSubPageControllerByFolderId(a_sLstFID);d&&d.get_SubPage().get_SearchControl().clearSearch();if(a)e.seekRw(a);else e.rfrsh()}else{var c=nvCtx();c.fR=isDrty(a_sInbx);c.mId=a;c.cb=onNavMail;nav(NM_MAIL,T_MSG,a_sInbx,c)}var b=getSNTr(NM_MAIL);if(b){b.selNd(null);b.selNd(b.gtNdByAls(ALP_DFT+DFT_IBX))}}function getPopupXPositionForShowUnder(b,c){var a=b.get_DocumentLeft();if(!g_fRtl)a=Math.max(a+b.get_OffsetWidth()-c.get_OffsetWidth(),0);return a}function adjustTopBordersAroundButton(a,b,h,g){var f=getPopupXPositionForShowUnder(b,a._get_Element()),j=a._get_Element().get_OffsetWidth(),i=b.get_OffsetWidth(),e=b.get_DocumentLeft(),d=a._get_Element().getEffectiveBorderWidth(Owa.Style.Side.Left),c=1;h.set_Right(Math.max(f+j-e-d-c,0));g.set_Left(Math.max(e+i-f-d-c,0))}function plySnd(){if(!plySnd.sWavUrl){plySnd.sWavUrl=getThmF("notify.wav");plySnd.sMp3Url=getThmF("notify.mp3")}if(Owa.Utility.isIE()){if(!plySnd.oSoundElement){plySnd.oSoundElement=Owa.Dom.Document.get_Current().createElement("BGSOUND");plySnd.oSoundElement.setAttribute("loop","1");Owa.Dom.Document.get_Current().get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,plySnd.oSoundElement)}plySnd.oSoundElement.setAttribute("src",plySnd.sWavUrl)}else if(Owa.Utility.isMac()&&(Owa.Utility.isSafari()&&!Owa.Utility.isChrome()&&Owa.Utility.get_SafariVersion()<5&&Owa.Utility.get_SafariVersion()>=0))$("divSoundContainer").set_InnerHtml('<EMBED src="'+plySnd.sWavUrl+'" height="0px" width="0px"></EMBED>');else if(!plySnd.fNotSupportAudio)if(!plySnd.oSoundElement){var a=document.createElement("AUDIO");if(a.canPlayType){plySnd.fNotSupportAudio=false;if(a.canPlayType("audio/wav"))$("divSoundContainer").set_InnerHtml('<AUDIO src="'+plySnd.sWavUrl+'" autoplay="true"></AUDIO>');else if(a.canPlayType("audio/mpeg"))$("divSoundContainer").set_InnerHtml('<AUDIO src="'+plySnd.sMp3Url+'" autoplay="true"></AUDIO>');else plySnd.fNotSupportAudio=true;if(!plySnd.fNotSupportAudio)plySnd.oSoundElement=$("divSoundContainer").get_FirstChild()}else plySnd.fNotSupportAudio=true}else plySnd.oSoundElement._oDomNode.play()}function navMail(b){var a=nvCtx();a.fP=1;a.fR=isDrty(g_rgsLFids[NM_MAIL]);a.cb=onNavMail;a.sId=g_rgsLFids[NM_MAIL];if(b)return a;nav(NM_MAIL,T_MSG,g_rgsLFids[NM_MAIL],a)}function navCal(){var a=nvCtx();a.fP=1;a.fR=isDrty(a_sCal);a.cb=onNavCal;nav(NM_CAL,T_CAL,a_sCal,a)}function navCtcts(){var a=nvCtx();a.fP=1;a.fR=isDrty(a_sCtcts);a.cb=onNavCnt;var b=$("divCntFlt");a.sFltr=b?b.getExpando("iCurFlt"):0;nav(NM_CTS,T_CON,a_sCtcts,a)}function navTsks(){var a=nvCtx();a.fP=1;a.fR=isDrty(a_sTsks);a.cb=onNavTsk;nav(NM_TSK,T_TSK,a_sTsks,a)}function navDocs(){var a=nvCtx();a.cb=cbNavDocs;nav(NM_DOC,T_DOC,g_rgsLFids[NM_DOC]?g_rgsLFids[NM_DOC]:ID_DFTDOCM,a)}function cbNavDocs(){ibe(document.body,wda("divDfm"))}function navPFs(){if(""==a_sPFrt){var b=new oeReq("Tree","GetRootPublicFolderId",0,cbGetPFRtId);b.send();return}else if(0==g_rgsLFids[NM_PF])g_rgsLFids[NM_PF]=a_sPFrt;var a=nvCtx();a.fP=1;a.fR=isDrty(g_rgsLFids[NM_PF]);a.cb=onNavPF;nav(NM_PF,g_sLstPFT?g_sLstPFT:T_MSG,g_rgsLFids[NM_PF],a)}function cbGetPFRtId(a){if(!cbOeh(a))return;a_sPFrt=a.sBody;navPFs()}function navOpts(a){if(g_fIsIMEnab&&gtIMMgr().GtChtSsnCnt()>0){var b=new BtnDlg("divNavOpts",htmlEnc(L_ErrNavAway),L_Opts,[L_OK,L_Cncl],400,Owa.BUTTON_DIALOG_ICON.WARNING,onNavOpts,null,null,null,null,null,a);b.show()}else onNavOpts(0,a)}function onNavOpts(c,b){if(c!=0)return;var a=getEcpVdir()+"?rfr=owa";switch(b){case"OOF":a+="&p=Organize/AutomaticReplies.slab";break;case"Pwd":a+="&p=PersonalSettings/Password.aspx";break;case"Rules":a+="&p=RulesEditor/InboxRules.slab";break;case"Mail":a+="&p=Customize/Messaging.aspx"}Owa.Dom.Window.get_Current().navigate(a)}function nvCtx(){this.sAe=AE_F;this.fP=this.fR=this.mId=this.fNoTdy=this.oC=this.fAB=this.sMa=this.sMs=this.sFltr=this.cb=this.sPrntFdrUri=this.iClr=null;return this}function gtActMd(){if(g_rgActM.length==0)g_rgActM[0]=a_iNM;var a=[];a[0]=a_iNM;for(var b=0;b<g_rgActM.length;b++)if(g_rgActM[b]!=a_iNM)a[a.length]=g_rgActM[b];return a}function nav(a,k,e,c){if(!c)c=nvCtx();var d=c.fAB;!d&&selectNavigationButton(a);var h=getFolderViewElementByFolderId(a_sLstFID);h&&setFolderViewStatus(h,false);try{var g=getViewSubPageControllerByFolderId(a_sLstFID);g&&g.invokeFunction("unselect")}catch(l){}if(!d){getNavigationPage().get_Breadcrumbs().set_Module(a);getNavigationPage().get_Breadcrumbs().hideElcLink();getNavigationPage().get_Breadcrumbs().hideProgress();var j=$("divSecNv");if(j&&a_iNM!=a){j.forEachChild(function(a){a.set_IsShown(false)});var b=null;switch(a_iNM){case NM_MAIL:b=g_oMMFrst;break;case NM_CAL:b=g_oCalTr;break;case NM_CTS:b=g_oCntTr;break;case NM_TSK:b=g_oTskTr;break;case NM_PF:b=g_oPblcFldrTree}b&&b.qtEdtNd()}}loadView(k,e,c,d);!d&&(a==NM_PF||a_iNM!=a)&&loadSecNv(a,e,c.cb);if(a!=NM_CAL)g_rgsLFids[a]=e;a_iNM!=NM_CAL&&Owa.Controls.FolderManager.getOwaStoreObjectIdPrefix(a_sLstFID)==FL_OUM&&stDrty(a_sLstFID);a_sLstFID=e;a_iNM=a;for(var i=1,f=0;f<g_rgActM.length;f++)if(g_rgActM[f]==a_iNM)i=0;if(i)g_rgActM[g_rgActM.length]=a_iNM;if(a==NM_PF)g_sLstPFT=k;positionMailboxQuotaBar()}function clearNwMB(){g_fShwNMBtn=0;g_fShwNVMBtn=0;g_fShwNFBtn=0;showNotificationButton(Owa.Strings.Ids.NewMailNotificationButtonId,false);showNotificationButton(Owa.Strings.Ids.NewVoiceMailNotificationButtonId,false);showNotificationButton(Owa.Strings.Ids.NewFaxNotificationButtonId,false)}function loadView(g,e,a,n){var d="?ae="+a.sAe+"&t=",l=a.sMa?"&a="+a.sMa:"",m=a.sMs?"&s="+a.sMs:"";hideInbxNB();var b=getFolderViewElementByFolderId(e);if(b&&b.get_TagName().toLowerCase()=="iframe"){var o=b.get_ContentWindow();try{var p=o.get_Document()}catch(q){b.remove(true);b=0}}if(b&&b.getBoolAttribute("fError")){b.remove(true);b=0}if(b){var c=Owa.Components.SubPageControllerFactory.getControllerByElement(b);c&&c.get_NavigationDelayed()&&c.get_DelayedURL()&&c.navigate(c.get_DelayedURL(),Owa.PendingOperationsManager.hasPendingOperations(e));if(g==T_CAL&&a.iClr)try{updateColorInCalendarView(a.iClr,c)}catch(q){}setFolderViewStatus(b,true);!n&&hideOpenMailboxDialog();try{c.invokeFunction("select",[a])}catch(q){}addPerfMarker("LoadView.End")}else{addPerfMarker("LoadView.NoCache");var k=$("divMainView"),j=0,h=null;k.forEachChild(function(a){j++;if(!getInt(a.getAttribute("_cF"))&&h==null)h=a});if(j>=CACHE_MAX&&h){var f=h.get_Id();if(f&&f.charAt(0)=="b")f=f.substring(1);f!=a_sInbx&&cancelFolderSubscription(f);var c=Owa.Components.SubPageControllerFactory.getControllerByElement(h);c.remove()}chgAbLvSt(0);d+=urlEnc(g)+l+m;if(a.sFltr)d+="&fltr="+a.sFltr;if(a.sPrntFdrUri)d+=a.sPrntFdrUri;if(e)d+=(g!=T_DOC?"&id=":"&URL=")+urlEnc(e);if(g==T_DOC&&a.oC)d+=a.oC;if(a.sELCId&&isAllwdELCClss(g))d+="&elcId="+urlEnc(a.sELCId);if(g==T_CAL&&a.iClr)d+="&clr="+a.iClr;var c=Owa.Components.SubPageControllerFactory.createControllerByUrl(k,d,"",true,false,Owa.PendingOperationsManager.hasPendingOperations(e)?true:false),i=c._get_Element();i.set_Id("b"+e);i.set_CssClasses(["mainView"]);i.setAttribute("_cF",a.fP?"1":"0");i.setExpando("_drty",0);i.setExpando("_nc",a.fNC);Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().addChildController(c)}}function getSNTr(a){switch(a){case NM_MAIL:return g_oMMFrst?g_oMMFrst.gtTr("mail"):null;case NM_PF:return g_oPblcFldrTree;case NM_CTS:return g_oCntTr;case NM_CAL:return g_oCalTr;case NM_TSK:return g_oTskTr}}function loadSecNv(a,i,h){var e=getMN(a),d=$("divSecNv"),g=d.getDescendantById(e);if(g){g.set_IsShown(true);var b=getSNTr(a),f=b?b.root.get_ParentElement().get_ParentElement().get_ParentElement():null;if(a==NM_PF)shwPFFlt();else(a==NM_CAL||a==NM_CTS||a==NM_TSK)&&b.selNd(b.gtNdByAls(AL_DEF));f&&Owa.DomUtility.calculateVerticalScrollBar(f)}else if(!d.getExpando("_prg"+e)){d.setExpando("_prg"+e,1);var c={};c.iM=a;c.sId=i;c.fnOnNav=h;var j=sv("GetSecondaryNavigation","m",a,c,cbReqSecNv,1);j.send()}}function cbReqSecNv(a){if(a.sErr)if(a.fST)rplLgn();else shwErrDlg(a);else{var b=a.oCtx;updSecNv(b.iM,b.sId,a.sBody,b.fnOnNav)}var c=getMN(a.oCtx.iM);$("divSecNv").setExpando("_prg"+c,0)}function updSecNv(c,f,d,b){var e=getMN(c),a=Owa.Dom.Document.get_Current().createElement("DIV");$("divSecNv").appendChild(a);a.set_Id(e);a.addCssClass("secNvPaneCont");a.set_InnerHtml(d);a_iNM!=c&&a.set_IsShown(false);b&&b()}function getMN(b){var a=[];a[NM_MAIL]=M_MAIL;a[NM_CAL]=M_CAL;a[NM_CTS]=M_CTS;a[NM_TSK]=M_TSK;a[NM_AB]="";a[NM_DOC]=M_DOC;a[NM_PF]=M_PF;return a[b]}function tglNvMnu(){var b=$("divNbMax"),e=$("divNbMin"),c=getSNTr(a_iNM),a=b.get_IsShown();e.set_IsShown(a);b.set_IsShown(!a);$("divSecNv").set_Bottom($("divNbR").get_OffsetHeight());if(c){var d=c.root.get_ParentElement().get_ParentElement().get_ParentElement();Owa.DomUtility.calculateVerticalScrollBar(d)}sv("PersistQuickLinksBar","q",a?1:0,null,cbSv).send()}function selectNavigationButton(d){var a=[];a[NM_MAIL]="Inbx";a[NM_CAL]="Cal";a[NM_CTS]="Ctcts";a[NM_TSK]="Tsks";a[NM_DOC]="Docs";a[NM_PF]="PFs";var c="nbHiLt",b="nbNoHiLt",f=$("lnk"+a[a_iNM]),e=$("lnkQl"+a[a_iNM]),h=$("lnk"+a[d]),g=$("lnkQl"+a[d]);f.hasCssClass(c)&&f.replaceCssClass(b,c);e.hasCssClass(c)&&e.replaceCssClass(b,c);h.hasCssClass(b)&&h.replaceCssClass(c,b);g.hasCssClass(b)&&g.replaceCssClass(c,b)}function sv(f,g,d,e,c,b){var a=new oeReq("Navigation",f,e,c,b?GET:POST);a.add(g,d);return a}function cbSv(a){a.fST&&rplLgn()}function setNavigationPaneWidth(a,f){var e=$("divNavHostBody").get_OffsetWidth()-g_iMinRPW;if(a>e)a=e;if(a<g_iMinVWW)a=g_iMinVWW;if(f&&a_iNW!=a){a_iNW=a;!g_fAB&&sv("PersistWidth","w",a,null,cbSv).send()}$("divNvPn").set_Width(a);var c=$("divNvDrag"),b=$("divMainViewPane");if(g_fRtl){c.set_Right(a-1);b.set_Right(a)}else{c.set_Left(a-1);b.set_Left(a)}var d=getSNTr(a_iNM);d&&errorInfobarSizeChangedInTree.call(d);positionMailboxQuotaBar()}function onNavCal(){if(!g_oCalTr){var c=$("calTr");if(c){var a=c.get_ParentElement().get_ParentElement();g_oCalTr=new Owa.UIControls.NavigationTree(c.get_FirstChild());g_oCalTr.set_SubPage(getNavigationPage());g_oCalTr.onClkNd=onCalClkNd;g_oCalTr.onAfRld=onCalAfRld;g_oCalTr.onOpnCal=onOpnCal;makeTreeScrollArea(g_oCalTr);a.attachEvent("dragenter",trStrtAutoScr);a.attachEvent("dragover",trStrtAutoScr);a.attachEvent("mouseout",endAutoScr);a.setExpando("oTgtTr",g_oCalTr);g_rgTreeRegion.push(a)}}var b=g_oCalTr.gtNdByAls(AL_DEF),d=b.getSavedColor();if(d<0)b.setHighlightEffect(DEFAULT_CALENDAR_CLASS);else b.setDisplayColor(d);b.stCk(1);g_oDatePickerManger.setPickers("dp","divMp",getNavigationPage(),false);g_oDatePickerManger.get_OnNavigateMonth().add(fnOnNavMonth)}function fnOnNavMonth(){var a;if(!g_oDatePickerManger.fPublicFolder){a=[];g_oCalTr.forEachNd(function(c,b){b.isChkd()&&a.push(b.gtFId())})}else a=[a_sLstFID];g_oDatePickerManger.getFreeBusy(a)}function getDatePickerManager(){return g_oDatePickerManger}function onOpnCal(b){if(a_iNM==NM_CAL){var a=getViewSubPageControllerByFolderId(g_oCalTr.gtNdByAls(AL_DEF).gtFId());if(a){var c=g_oCalTr.gtNdByFId(b);if(c){updateCalendarTree([],[]);c.stCk(1)}a.invokeFunction("rfshVw",[this.gtRgFId(),b,1])}}}function onCalAfRld(){if(a_iNM==NM_CAL){var b=getViewSubPageControllerByFolderId(g_oCalTr.gtNdByAls(AL_DEF).gtFId());if(b)for(var c=b.invokeFunction("rfshVw",[this.gtRgFId(),this.gtSelFId(),0]),a=0;a<c.length;a++){var d=g_oCalTr.gtNdByFId(c[a]);d&&d.stCk(1)}}}function onCalClkNd(e,a){if(!a||!(a instanceof Owa.Components.NavigationFolderTreeNode))return;var d=a.gtFId(),c=a.getSavedColor(),b=getViewSubPageControllerByFolderId(g_oCalTr.gtNdByAls(AL_DEF).gtFId());b.invokeFunction("tglCal",[d,c,g_oCalTr.gtRgFId()])}function updateCalendarTree(a,b){if(!isDf(typeof g_oCalTr)||g_oCalTr==null)return;var c=g_oCalTr.gtNdByAls(AL_DEF);g_oCalTr.forEachNd(function(g,d){if(d instanceof Owa.Components.NavigationFolderTreeNode){for(var f=d.gtFId(),e=0;e<a.length;e++)if(a[e]==f){d.stCk(1);if(d.equals(c)&&b[e]<0)d.setHighlightEffect(DEFAULT_CALENDAR_CLASS);else d.setDisplayColor(b[e]);break}if(e==a.length){d.stCk(0);d.setDisplayColor(CLR_NONE)}}})}function rfrshCal(){var c=wda("divMainView");if(!c)return;for(var d=0;d<c.children.length;d++){var b=c.children[d];if(b){var a=b.contentWindow;if(a)try{if(isDf(typeof a.a_fCal)&&a.a_fCal)if(isDisp(b))a.refresh();else stDrty(b.id.substring(1),1)}catch(e){}}}}function SNLStl(b,c){b.className=c;var a=gtStl(b);this.backgroundColor=a.backgroundColor;this.borderColor=a.borderTopColor}function reloadCalendarNavigationTree(){var a=new oeReq("Navigation","ReloadCalendarNavigationTree",0,cbReloadCalendarNavigationTree,GET);a.send()}function cbReloadCalendarNavigationTree(a){if(a.isErr())return;g_oEd.fire("ReloadNavigationTree",a)}function onNavTsk(){if(!g_oTskTr){var b=$("tskTr");if(b){var a=b.get_ParentElement().get_ParentElement();g_oTskTr=new Owa.UIControls.NavigationTree(b.get_FirstChild());g_oTskTr.set_SubPage(getNavigationPage());g_oTskTr.onSelChng=onTskSelChng;g_oTskTr.onClkNd=clearSearchOnClickTreeNode;g_oTskTr.setSelectionClass("NMTrSel");makeTreeScrollArea(g_oTskTr);a.attachEvent("dragenter",trStrtAutoScr);a.attachEvent("dragover",trStrtAutoScr);a.attachEvent("mouseout",endAutoScr);a.setExpando("oTgtTr",g_oTskTr);g_rgTreeRegion.push(a)}}initSNFlt($("divTskFlt"));g_oTskTr.selNd(g_oTskTr.gtNdByAls(AL_DEF));updTskFlt()}function onTskSelChng(d,b){if(!b)return;var c=b.gtFId(),a=nvCtx();a.fP=a.fR=1;nav(NM_TSK,T_TSK,c,a);updTskFlt()}function updTskFlt(a){a=a?a:a_sLstFID;var b=getNavigationPage().getLstVw(a);if(!b)return;snFltSet(isPFId(a)?$("divPFTskFlt"):$("divTskFlt"),b.gtFltr())}function onClkTskFlt(b){var a=getNavigationPage().getLstVw(a_sLstFID);if(!a||!a.rfrsh)return;a.stFltr($(b).getExpando("iCurFlt"));a.rfrsh()}function refreshTaskViewIfNeed(c){if(a_iNM!=NM_TSK)return;var a=getViewSubPageControllerByFolderId(a_sLstFID);if(a&&!a.equals(c)){a.get_SubPage().udRP(true);var b=Owa.PageHierarchy.getVirtualListViewFromSubPageController(a);b&&b.rfrsh()}}function onNavPF(){if(!g_oPblcFldrTree){var b=$("publictree");if(b){var a=b.get_ParentElement().get_ParentElement();g_oPblcFldrTree=new Owa.UIControls.FolderTree(b.get_FirstChild(),0);g_oPblcFldrTree.set_SubPage(getNavigationPage());g_oPblcFldrTree.onSelChng=onPFSelChng;makeTreeScrollArea(g_oPblcFldrTree);a.attachEvent("dragenter",trStrtAutoScr);a.attachEvent("dragover",trStrtAutoScr);a.attachEvent("mouseout",endAutoScr);a.get_ParentElement().setExpando("oTgtTr",g_oPblcFldrTree);g_rgTreeRegion.push(a)}var c=$("divPFtm");c&&Owa.Dom.Document.get_Current().get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,c);shwPFFlt()}}function onRenameNavigation(g,i,b,h){if(g.isErr())return;var a;if(b==GS_CNT)a=g_oCntTr;else if(b==GS_TSK)a=g_oTskTr;else if(b==GS_CAL)a=g_oCalTr;else if(b==GS_FVR&&g_oMMFrst)a=g_oMMFrst.gtTr("favorite");if(!a)return;var c=a.gtNdById(padF(h));if(b==GS_FVR){if(!(c instanceof Owa.Components.FavoriteFolderTreeNode))return}else if(!(c instanceof Owa.Components.NavigationFolderTreeNode))return;var d=getViewSubPageControllerByFolderId(b==GS_CAL?a.gtNdByAls(AL_DEF).gtFId():c.gtFId());if(!d)return;var e=Owa.Dom.Document.get_Current().createElement("div");e.set_InnerHtml(g.sBody);var f=e.getDescendantById("ntn").get_TextContent();if(b==GS_CAL)d.invokeFunction("rnmCal",[c.gtFId(),f]);else d.invokeFunction("renameFolderName",[f])}function onRenameFolder(c,e,d){if(c.isErr())return;var a=getViewSubPageControllerByFolderId(d);if(!a)return;var b=Owa.Dom.Document.get_Current().createElement("div");b.set_InnerHtml(c.sBody);a.invokeFunction("renameFolderName",[b.getDescendantById("tn").get_TextContent()])}var g_rgfFltLd=[];function shwPFFlt(){var a=g_oPblcFldrTree.gtSelNd().gtFCC(),g=g_oPblcFldrTree.gtSelNd().gtId(),b=g_oPblcFldrTree.gtSelNd().gtFId(),f=g_oPblcFldrTree.gtSelNd().getIntAttribute(EXPND_HAS_RPLC);if(isNaN(f)){var d={};d.sT=a;d.sFId=b;var c=new oeReq("Tree","GetPublicFolderReplicaType",d,cbGetPfRt);c.add("id",b);c.send();return}var g=getPfFltId(a);if(g==0||!f){shwPFFDiv(1);return}var d=$(g);if(d){shwPFFDiv(0,a);isOfClss(a,T_TSK)&&updTskFlt(b)}else{var e={};e.sT=a;e.sFId=b;var c=sv("GetPFFilter","t",a,e,cbGetPFFlt,1);isOfClss(a,T_CAL)&&c.add("fId",b);c.send()}}function cbGetPfRt(a){if(a.isErr())return;eval(a.sBody);if(g_oPblcFldrTree){g_oPblcFldrTree.gtNdByFId(a.oCtx.sFId).setIntAttribute(EXPND_HAS_RPLC,iHasRplc);shwPFFlt()}}function cbGetPFFlt(b){if(!cbOeh(b)){shwPFFDiv(1);return}var a=b.oCtx.sT;if(!g_rgfFltLd[a]){var c=$("divPFFlt");c.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,b.sBody);g_rgfFltLd[a]=1;var d=c.get_LastChild();if(isOfClss(a,T_CON)||isOfClss(a,T_TSK))initSNFlt(d);else if(isOfClss(a,T_CAL)){g_oDatePickerManger.setPickers("divPfDp","divPfMp",getNavigationPage(),true);g_oDatePickerManger.get_OnNavigateMonth().add(fnOnNavMonth)}d.set_IsShown(false);shwPFFlt()}}function shwPFFDiv(a,c,d){!a&&shwPFFDiv(1,0,1);var b=$("divPFFlt");b.set_IsShown(!a);b.forEachChild(function(a){a.set_IsShownAroundIEBug(false)});c&&b.getChildById(getPfFltId(c)).set_IsShown(!a);!d&&setPFTreeTop(a)}function setPFTreeTop(b){var a=$("divSecNv").getDescendantById(getMN(NM_PF));a.getDescendantById("divPFTrR").set_Top(b?0:a.getDescendantById("divPFFlt").get_OffsetHeight())}function getPfFltId(a){return isOfClss(a,T_CON)?"divPFCntFlt":isOfClss(a,T_TSK)?"divPFTskFlt":isOfClss(a,T_CAL)?"divPFCalFlt":0}function opnNew(d,e,b,c){var a="";if(Owa.Utility.isSafari())a=getOwaVdir();a+="?ae=Folder&t="+urlEnc(e)+"&id="+urlEnc(d);if(b&&b!=d&&isAllwdELCClss(e))a+="&elcId="+urlEnc(b);if(c)a+="&clr="+c;a+="&"+PARENT_SUBPAGE_ID_ATTR+"="+getNavigationPage().get_SubPageController().get_UniqueId();sfWinOpn(a)}function showOpenMailboxDialog(){Owa.UIControls.OpenMailboxDialog.showDialog()}function hideOpenMailboxDialog(){Owa.UIControls.OpenMailboxDialog.hideDialog()}function OnPrsncCmClk(b){switch(b.sCommand){case"opnMbx":showOpenMailboxDialog();break;case"signinim":ImSIR(0,1,1,1);break;case"signoutim":var a={};sndIMReq(IM_SO,null,null,a);break;default:var a={};a.sC=b.sCommand;if(b.sCommand!="reset")a.prsnc=gtPrsncValFrmNm(b.sCommand);a.feOnErr=onPrsncChngErr;sndIMReq(IM_CPR,cbPrsncChngd,null,a)}}function cbPrsncChngd(b,a){if(b.sC=="reset")if(isDf(typeof a)&&a)gtPrsncIdFrmVal(a);else return;else stSlfPrsnc(gtPrsncIdFrmVal(b.prsnc))}function onPrsncChngErr(){alrt(L_ErrIMPr,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_ErrIMPrTtl)}function opnLoc(){g_oOpnLocDlg=new OpnLocDlg(onOpnLocCls);var b=$("divOpnLocDlg"),a=$("divOpnLoc"),c=a.get_DocumentTop()+a.get_OffsetHeight()+1;g_oOpnLocDlg.show(g_fRtl?a.get_DocumentLeft()+a.get_OffsetWidth()-b.get_OffsetWidth():a.get_DocumentLeft(),c);wda("inpOpnLoc").select();b.attachEvent("keydown",kdOpnLoc);a.addCssClass("opnLocHightlight")}function onOpnLocCls(){$("divOpnLoc").removeCssClass("opnLocHightlight")}function OpnLocDlg(c){var a=wda("divOpnLoc"),d='<div id="divOpnLocDlg"><div class="opnLocDlgTtl">'+Owa.Components.CssSprites.getImageMarkup("closedlg.gif",'onclick="g_oOpnLocDlg.hide();"',"opnLocClsImg",null)+a.getAttribute("L_OpnLoc")+'</div><div class="opnLocMnRg"><div class="opnLocMn"><div>'+a.getAttribute("L_OpnLocDesc")+'</div><input type="text" id="inpOpnLoc"></div><div class="opnLocBtnRg"><div id="divOpnLocPrg"><img class="opnLocPrgImg" src="'+getThmF("pgrs-sm.gif")+'"><div class="opnLocPrgTxt">'+a.getAttribute("L_Opning")+'</div></div><button id="btnOpnLoc" onclick="clkOpnLoc()" onmouseover="btnOnMsOvrBtn(this)" onmouseout="btnOnMsOutBtn(this)">'+a.getAttribute("L_Opn")+"</button></div></div></div>",b=new Dlg("divOpnDocLib",d,0,1,0,0);b.get_OnClose().add(c);return b}function clkOpnLoc(){var a=wda("inpOpnLoc"),c=a.value.trim();a.value=c;if(c.length==0){setFcs(a);return}var d=$("btnOpnLoc"),e=wda("divOpnLoc"),b=d.get_TextContent()==e.getAttribute("L_Opn");wda("divOpnLocPrg").style.visibility=b?"visible":"";a.disabled=b;d.set_TextContent(e.getAttribute(b?"L_Cncl":"L_Opn"));if(!b)a.select();else clsLnk(c)}function clsLnk(b){var a=new oeReq("DocumentLibrary","ClassifyLink",b,cbClsLnk);a.add("uri",b);a.send()}function cbClsLnk(c){var g=$("btnOpnLoc"),d=wda("divOpnLoc");if(!wda("divOpnLocDlg")||g.get_TextContent()==d.getAttribute("L_Opn"))return;if(c.sErr){if(c.fST)rplLgn();else{clkOpnLoc();alrt(L_InvUri)}return}var a=Owa.Dom.Document.get_Current().createElement("DIV");a.set_InnerHtml(c.sBody);var b=a.getDescendantById("err");if(b){clkOpnLoc();var h=wda("divOpnDocLib"),i=new BtnDlg("idOkDlg",htmlEnc(b.getAttribute("_msg")),b.getAttribute("_ttl"),[d.getAttribute("L_OK")],null,parseInt(b.getAttribute("_icn")),opnDlgOnCls,h);i.show();return}var f=a.getDescendantById("uri").get_TextContent(),e=parseInt(a.getChildById("uf").get_TextContent()),k=a.getDescendantById("oid").get_TextContent(),j=a.getDescendantById("divFwr").get_TextContent();if(j==1)opnWebRFrm(f,e);else opnDocItm(f,e,k);g_oOpnLocDlg.hide()}function opnDlgOnCls(){wda("inpOpnLoc").select()}function kdOpnLoc(a){switch(a.get_KeyCodeForKeyUpDown()){case 13:clkOpnLoc();break;case 27:g_oOpnLocDlg.hide()}a.cancelBubble()}function edtLib(){var d=wda("divDfm"),e=d.docLib,c=getDocLibSpn(e),a=document.createElement("INPUT");a.type="text";a.value=c.innerText;a.onkeydown=onKDLib;a.maxLength=255;a.className="docFavDNEdt";iae(c,a);hideEm(c);var b={};b.spn=c;b.txt=a;b.docLib=d.docLib;a.oC=b;a.select();a.onfocusout=renLib;a.oncontextmenu=canEvt;a.onclick=canEvt}function onKDLib(c){var a=c||event,b=getEvtTgt(a);if(getKeyCode(a)==13)b.blur();else getKeyCode(a)==27&&rstrLib(b.oC);cnclBbl(event)}function renLib(b){if(!b)b=event;var d=getEvtTgt(b).value,a=getEvtTgt(b).oC;if(d.length==0||d==a.spn.innerText){rstrLib(a);return}var c=new oeReq("DocumentLibrary","RenFav",a,cbRenLib);c.add("uri",a.docLib.uri);c.add("dn",d);c.send()}function cbRenLib(b){if(b.sErr){b.fST&&rplLgn();return}var a=b.oCtx;a.spn.innerText=a.txt.value;var c=a.docLib.title;a.docLib.title=a.txt.value+"\n"+c.substring(c.indexOf("\n")+1);rstrLib(a)}function rstrLib(a){rn(a.txt);showEm(a.spn);a.docLib.style.backgroundColor=""}function delLib(){var a=wda("divDfm"),b=new oeReq("DocumentLibrary","DelFav",a.docLib,cbDelLib);b.add("uri",a.docLib.uri);b.send()}function cbDelLib(a){if(a.sErr){a.fST&&rplLgn();return}rn(a.oCtx)}function isDispOF(){return isDisp(wda("divFavFldrs"))}function tglDocBlk(){var a=$("divFavFldrs");if(a.get_IsShown()){a.set_IsShown(false);Owa.Components.CssSprites.updateImage($("imgFavFldrs"),g_sExpIco);svDocBlkSt(0)}else if(!a.hasChildNodes())(new oeReq("DocumentLibrary","GetFavFldrs",0,cbGetBlk)).send();else{a.set_IsShown(true);Owa.Components.CssSprites.updateImage($("imgFavFldrs"),g_sClpsIco);svDocBlkSt(1)}}function cbGetBlk(a){if(a.sErr)a.fST&&rplLgn();else{var b=wda("divFavFldrs");showEm(b);Owa.Components.CssSprites.updateImage($("imgFavFldrs"),g_sClpsIco);b.innerHTML=a.sBody}}function svDocBlkSt(b){var a=new oeReq("DocumentLibrary","PersistFavFldrs",null,cbSv);a.add("fV",b);a.send()}function shwDocMnu(e,b){var a=wda("divDfm"),c=wda("divDfmD"),d=wda("divDfmR");!a.show&&CtxMnu(a,getNavigationPage().get_ActionHandler());showEms([c,d],!b);c.setAttribute("_lnk",b?1:0);d.setAttribute("_lnk",b?1:0);a.docLib=e;a.show(event)}function getDocLibSpn(a){return getOneDescendant(a,"spnDocFavDN")}function procRm(g,h,d,e,f){var b={};b.iOp=g;b.rgS=d;var a=new oeReq("RemindersEventHandler",h,b,cbProcRm);f&&a.add("Snt",f);e&&a.add("LRT",new Date(e));var c=rmGetRemindersInfo(a,d);if(!c||!c.length)return;a.addRgSt("Rm",c);a.send()}function cbProcRm(b){if(b.sErr)if(b.fST)popLgn();else shwErrDlg(b);else{var d=b.oCtx,c=d.iOp,f=d.rgS,a=Owa.UIControls.ReminderDialog.getDialog();a.removeItems(f,c,c==OP_SNZ?eval(b.sBody):null);if(a.getItems().length<1&&a.isOpened())a.hide();else if(a.isOpened()){var e=a.getItems()[0];if(a.nxtSelId)e=a.getItemById(a.nxtSelId);a.selectItem(e,1,1)}}}function rmToStrc(b,c){var a=new oeSt(c,"rmInfo");a.add("id",b.id);a.add("ck",b.ck);return a}function getReminderItemId(a){return a.get_Id().substring(1)}function RmInfo(a){this.id=getReminderItemId(a);this.ck=a.getAttribute("ck")}function rmGetRemindersInfo(e,b){for(var c=[],a=0;a<b.length;a++){var f=b[a],d=new RmInfo(f);c.push(rmToStrc(d,e))}return c}function Rrsp(b,a,c){this.ck=b;this.r=a;this.fD=c?1:0}function showNotificationButton(b,a){a&&resetAlertBarWidth();$(b).set_IsShown(a);getNavigationPage().layoutAlertBar()}function setNavigationDragHeight(){var b=$("divNavDivide"),a=$("divMainPage");b&&a&&b.set_Height(a.get_ClientHeight(),Owa.Style.Unit.Pixels)}function resetAlertBarWidth(){$("divAlertBar").set_Width($("divAlertBarContainer").get_ClientWidth())}function getAlertBarWidth(){var a=0;if(!g_fAB){var d=$(Owa.Strings.Ids.HelpButtonId),b=$("divAlertMeasure"),c=$("divAlertBarContainer");if(b.get_DocumentTop()<d.get_DocumentTop()+d.get_OffsetHeight()){if(g_fRtl)a=b.get_DocumentLeft()+b.get_OffsetWidth();else a=c.get_ClientWidth()-b.get_DocumentLeft();a+=1}else a=c.get_ClientWidth()}return a>0?a:0}function applyNotificationButtonStyle(b,a){if(!a)return;Owa.Components.ToolbarCollection.get(getNavigationPage()).set_IsButtonPushed(a,b)}function initSNL(a,b){prepSNLEnts(a,b);a.setExpando("oSelItm",null)}function prepSNLEnts(c,d){for(var b=c.getAllDescendantsById("divEnt"),a=0;a<b.length;a++)if(d){b[a].detachEvent("mouseover",onMOvrSNL);b[a].detachEvent("mouseout",onMOutSNL);b[a].detachEvent("click",onClkSNL)}else{if(b[a].getExpando("_init"))continue;b[a].attachEvent("mouseover",onMOvrSNL);b[a].attachEvent("mouseout",onMOutSNL);b[a].attachEvent("click",onClkSNL);b[a].setAttribute("title",b[a].get_TextContent());b[a].setExpando("_init",1)}}function snlSelEnt(c,a){var b=c.getExpando("oSelItm");if(b&&b.equals(a))return;b!=null&&b.replaceCssClass("snlDef","snlSel");a.removeCssClass("snlHvr");a.removeCssClass("snlDef");a.addCssClass("snlSel");c.setExpando("oSelItm",a)}function snlUnsel(b){var a=b.getExpando("oSelItm");a&&a.replaceCssClass("snlDef","snlSel");b.setExpando("oSelItm",null)}function onMOvrSNL(d){var a=gtSNLEnt(d.get_Target()),c=gtSNL(a),b=c.getExpando("oSelItm");(!b||!b.equals(a))&&a.replaceCssClass("snlHvr","snlDef")}function onMOutSNL(d){var a=gtSNLEnt(d.get_Target());if(a.hasCssClass("snlHvr")){var c=gtSNL(a),b=c.getExpando("oSelItm");(!b||!b.equals(a))&&a.replaceCssClass("snlDef","snlHvr")}}function onClkSNL(c){var a=gtSNLEnt(c.get_Target()),b=gtSNL(a);snlSelEnt(b,a);eval(a.getAttribute("_onclick"))}function gtSNLEnt(a){while(a&&a.get_Id()!="divEnt")a=a.get_ParentElement();return a}function gtSNL(a){while(a&&!getInt(a.getAttribute("fSNL")))a=a.get_ParentElement();return a}function initSNFlt(b){b.setExpando("iCurFlt",0);for(var d=b.getAllDescendantsById("divSecNvFltItm"),c=0;c<d.length;c++){var a=d[c];a.get_FirstChild().get_FirstChild().get_IsChecked()&&b.setExpando("iCurFlt",getInt(a.getAttribute("_iF")));a.attachEvent("click",onClkSNFlt)}}function snFltSet(b,e){for(var d=b.getAllDescendantsById("divSecNvFltItm"),a=0;a<d.length;a++){var c=d[a];if(getInt(c.getAttribute("_iF"))==e){c.get_FirstChild().get_FirstChild().set_IsChecked(true);b.setExpando("iCurFlt",e);break}}}function onClkSNFlt(c){var a=c.get_Target();while(a&&a.get_Id()!="divSecNvFltItm")a=a.get_ParentElement();var b=gtSNFlt(a);a.get_FirstChild().get_FirstChild().set_IsChecked(true);b.setExpando("iCurFlt",getInt(a.getAttribute("_iF")));eval(b.getAttribute("_onclick"))}function gtSNFlt(a){while(a&&!getInt(a.getAttribute("fSNFlt")))a=a.get_ParentElement();return a}function opnShrDlg(){(new Owa.UIControls.OpenOtherFolderInNavPane(getNavigationPage())).clickButton(a_iNM)}function updateColorInCalendarView(c,a,b){if(!a)a=getViewSubPageControllerByFolderId(g_oCalTr.gtNdByAls(AL_DEF).gtFId());if(b)try{a.invokeFunction("refClrByFId",[b,c])}catch(d){}}function cbSetColor(a){if(a.sErr){if(a.fST)popLgn();else shwErrDlg(0,a.sErr);return}}var g_fQtFlg=0;function getMailboxUsage(b,d,e){var c=$("divMbxQt");if(!getInt(c.getAttribute("_fDsp"))&&!b)return;if(g_fQtFlg==0){g_fQtFlg=1;var a={};a.fShw=b?1:0;a.iX=d;a.iY=e;(new oeReq("Tree","GetMailboxUsage",a,cbGetMailboxUsage,POST)).send()}}function cbGetMailboxUsage(a){if(a.isErr()){a.fST&&popLgn();shwErrDlg(a)}else updateMailboxUsage(a.sBody,a.oCtx.fShw,a.oCtx.iX,a.oCtx.iY);g_fQtFlg=0}function updateMailboxUsage(e,f,c,h){hideMailboxUsage();var a=$("divMbxQt"),b=$("divMbxQtRg"),d=$("divNavHostBody");if(a!=null){b.set_InnerHtml(e);a=b.getDescendantById("divMbxQt");if(getInt(a.getAttribute("_fDsp")))b.set_IsShown(true);else if(f){var g=180;a.remove(true);b.set_IsShown(false);a.addCssClass("floatMbxQt");if(g_fRtl)c=c-g;a.set_Left(c);a.set_Top(h);d.appendChild(a)}}}function hideMailboxUsage(){var a=$("divMbxQt"),b=$("divMbxQtRg");if(a)if(!getInt(a.getAttribute("_fDsp"))){a.remove(true);a.removeCssClass("floatMbxQt");b.appendChild(a);a.set_Left(0);a.set_Top(0)}}function opnPrsncMnu(){var a=getPresenceMenu();Owa.IM.IMUtils.SetMenuSISOBeforeShow(a);a.showUnder($("aUserTile"),-5,true)}function isAllwdELCClss(a){return a.startsW(T_MSG)||a==T_NTS}var RCP_CCH_TM=6e4*60*10;function updSrvRcpCch(){var a=new oeReq("RecipWell","SvCchBE",null,null,POST,null,false,true);a.send();window.setTimeout(updSrvRcpCch,RCP_CCH_TM)}function setFolderViewStatus(b,c){var a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);a.set_IsShown(c)}function getCurrentViewSubPage(){var b=getFolderViewElementByFolderId(a_sLstFID),a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);return a.get_SubPage()}function getWCY(e){var b=getCY(e),d=god(e).parentWindow;if(!isWP())while(1)try{var a=d.frameElement,c=a.document.parentWindow;if(!c.g_fOwa)break;b+=getCY(a);d=c}catch(f){break}return b}function logOff(){try{location="logoff.owa"}catch(a){}}function dbgCnsl(){var a=0;try{if(g_oPrfCnsl&&g_oPrfCnsl.dbgWinDsptch){g_oPrfCnsl.dbgWinDsptch("");a=1}}catch(c){}if(a){var b=new OKDlg(L_Err2PrfCnsOpnd,null,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_PrfCns);b.show()}else g_oPrfCnsl=opnWin("?ae=Dialog&t=PerfConsole",a_iPCW,a_iPCH,1,null,null,null,getNavigationPage())}function setNEI(a){g_oNE=a}function shwNEI(){g_oNE&&shwErrDlg(g_oNE)}function excPrfCnsl(b){var a=0;try{if(g_oPrfCnsl&&g_oPrfCnsl.g_clctOeh&&g_oPrfCnsl.dbgWinDsptch){a=1;g_oPrfCnsl.dbgWinDsptch(b)}}catch(c){if(a)throw c;}}if(typeof a_fAB=="undefined"){Type.createNamespace("Owa.IM");(function(){var b=200,a=10;Owa.IM.MAX_CHT_SSNS=20;Owa.IM.SUPPORTED_USER=1;Owa.IM.BUDDY_TYPE={None:0,WindowsLive:1,OfficeCommunicator:2,Yahoo:32};Owa.IM.GROUP_FLAGS={None:0,Favorites:1,OtherContacts:2};Owa.IM.IMMgr=function Owa$IM$IMMgr(){if(isDf(typeof a_isMstr)&&a_isMstr){this.bdyLst=new Owa.IM.BdyLst;this.othrsLst=new Owa.IM.OthrsLst;this.pxyLst=new Owa.IM.ProxyList;this.blkLst=new Owa.IM.BlkLst;this.intChtSsns={};this.intChtSsnCnt=0;this.chtSsns={};this.chtSsnCnt=0}};Owa.IM.IMMgr.prototype.gtPrsnc=function Owa$IM$IMMgr$gtPrsnc(a){var c=gtDfltPrsnc();if(!isDf(typeof a)||!a)return c;if(isSlfUri(a))return gtSlfPrsnc();if(this.IsBlkd(a))return IM_PR_BLKD;var b=this.bdyLst.IsBdy(a);return b?this.bdyLst.GtPrsnc(a):this.othrsLst.GtPrsnc(a)};Owa.IM.IMMgr.prototype.gtDN=function Owa$IM$IMMgr$gtDN(a){return this.bdyLst.IsBdy(a)?this.bdyLst.GtBdy(a).dn:this.othrsLst.IsPrsnt(a)?this.othrsLst.GtBdy(a).dn:0};Owa.IM.IMMgr.prototype.gtPrsncArr=function Owa$IM$IMMgr$gtPrsncArr(a){if(!a||a.length<=0)return;for(var b=0;b<a.length;b++){var c=a[b].sUri;if(c)a[b].prsnc=this.gtPrsnc(c)}};Owa.IM.IMMgr.prototype.pshUkwnPrsnc=function Owa$IM$IMMgr$pshUkwnPrsnc(){var f=[],b=gtDfltPrsnc(),d,a,e=this.bdyLst._utBuddyList;for(d in e.Keys()){var c=e.Get(d);if(c){a={};a.prsnc=b;a.fNm=gtIMFFrmId(b);a.sDN=c.dn;a.sUri=d;f.push(a);c.prsnc=b}}e=this.othrsLst._utOthersList;for(d in e.Keys()){var c=e.Get(d);if(c){a={};a.prsnc=b;a.fNm=gtIMFFrmId(b);a.sDN=c.dn;a.sUri=d;f.push(a);c.prsnc=b}}pushPrsnc(f);stSlfPrsnc(b)};Owa.IM.IMMgr.prototype.IsBdy=function Owa$IM$IMMgr$IsBdy(a){return!isDf(typeof a)||!a?0:this.bdyLst.IsBdy(a)};Owa.IM.IMMgr.prototype.StStlUri=function Owa$IM$IMMgr$StStlUri(b,a){if(!isDf(typeof b)||!b)return;if(!isDf(typeof a)||!a)return;if(isSameUri(b,a))return;if(a)this.bdyLst._utStaleUris.Set(a,b);else this.bdyLst._utStaleUris=new Owa.IM.UriTable};Owa.IM.IMMgr.prototype.GtStlUri=function Owa$IM$IMMgr$GtStlUri(a){return this.bdyLst._utStaleUris.Get(a)};Owa.IM.IMMgr.prototype.IsBlkd=function Owa$IM$IMMgr$IsBlkd(a){return!isDf(typeof a)||!a?0:this.blkLst.Contains(a)};Owa.IM.IMMgr.prototype.SetBlkd=function Owa$IM$IMMgr$SetBlkd(a){if(!isDf(typeof a)||!a)return;this.blkLst.SetBlkd(a)};Owa.IM.IMMgr.prototype.SetUnblkd=function Owa$IM$IMMgr$SetUnblkd(a){if(!isDf(typeof a)||!a)return;this.blkLst.SetUnblkd(a)};Owa.IM.IMMgr.prototype.SubPrsnc=function Owa$IM$IMMgr$SubPrsnc(e){if(isMSNPrv())return;if(!e||!isDf(typeof e.length)||e.length<1)return;if(!Owa.IM.SUPPORTED_USER)return;var f=b-(this.bdyLst.GtLen()+this.othrsLst.GtLen()),g=e.length,h=a,d=g;if(f>h){if(g>f)d=f}else if(g>h)d=h;var c;if(f<d)c=this.othrsLst.Decay(1,1,d-f);if(!c&&d>0)c={};for(var j=[],i=0;i<d;i++){var k=e[i];if(this.gtPrsnc(k)!=gtDfltPrsnc())continue;j.push(k)}if(c){c.sUrisSub=j.join(",");sndIMReq(IM_SC,this.othrsLst.cbDecay,null,c)}};Owa.IM.IMMgr.prototype.QryPrsnc=function Owa$IM$IMMgr$QryPrsnc(a){if(!a||!isDf(typeof a.length)||a.length<1)return;if(!Owa.IM.SUPPORTED_USER)return;var b={};b.sQryUris=a.join(",");sndIMReq(IM_QP,0,0,b)};Owa.IM.IMMgr.prototype.NwChtSsnMw=function Owa$IM$IMMgr$NwChtSsnMw(b,d,f,c,e){if(this.GtChtSsnCnt()>=Owa.IM.MAX_CHT_SSNS){this.ErrMaxChats();return}if(isDf(typeof b)&&(b||b==="")&&isDf(typeof d)&&d)this.NwChtSsnMsg(b,d);else if(isDf(typeof c)&&c&&isDf(typeof f)&&f){var a={};a.sMsgId=c;a.feOnErr=failStrtCht;if(isDf(typeof e))a.gtNrmSub=e;sndIMReq(IM_ITMINFO,this.cbProcMsgInfo,0,a)}};Owa.IM.IMMgr.prototype.cbProcMsgInfo=function Owa$IM$IMMgr$cbProcMsgInfo(c,a){if(isDf(typeof a)&&a){var b=eval("("+a+")");gtIMMgr().NwChtSsnMsg(b._sub,new Recip(b._dn,"",0,0,RT_SMTP,AO_O,0,0,0,b._uri))}};Owa.IM.IMMgr.prototype.NwChtSsnMsg=function Owa$IM$IMMgr$NwChtSsnMsg(e,c){var b=gtRcpIM(c);b=this.pxyLst.GetBuddyPrimaryUri(b);var g=gtRcpDn(c);if(!b){noIMInfoErr();return}else if(isSlfUri(b)){slfChtErr();return}var h=this.LdExstChtSsn(b,e);if(h)return;var f=rndm(),a={};a.iNtry=Owa.IM.CHT_MSG;a.fNN=0;a.iS=Owa.IM.CHT_SSN_ST_INIT;a.sChtId=f;a.iInt=1;if(Owa.Utility.isDefined(typeof c.getAttribute))a.oRcp=crtRecipObjectFromDomObject(c);else a.oRcp=c;var d=this.bdyLst.GtBdy(b);if(d){a.oRcp._dn=d.dn;a.oRcp._uri=d.uri;a.oRcp._type=d.iType}else{if(a.oRcp._dn=="")a.oRcp._dn=g;a.oRcp._uri=b}if(e&&e!=""){a.sSub=g+" - "+e;a.fUseExistingTitle=1}this._addChatSession(f,a)};Owa.IM.IMMgr.prototype._addChatSession=function Owa$IM$IMMgr$_addChatSession(b,a){var c=new Owa.IM.ChtSsn(b,a);if(a.iInt){this.intChtSsns[b]=c;this.intChtSsnCnt++}else{this.chtSsns[b]=c;this.chtSsnCnt++}var d=a.oRcp._dn;if(a.rgoRcp&&a.rgoRcp.length&&isSlfUri(a.oRcp._uri))d=a.rgoRcp[a.rgoRcp.length-1]._dn;Owa.UIControls.ActiveChatsDialog.getDialog().addChat(b,d,a.oRcp._type,a.sMsg);c.OpenWindow()};Owa.IM.IMMgr.prototype.NwChtSsnRcp=function Owa$IM$IMMgr$NwChtSsnRcp(a){if(this.GtChtSsnCnt()>=Owa.IM.MAX_CHT_SSNS){this.ErrMaxChats();return}if(!a)return;var e=0,c=gtRcpIM(a);c=this.pxyLst.GetBuddyPrimaryUri(c);c=c.lc();c=Owa.IM.IMUtils.FrmSipUri(c);if(!c){noIMInfoErr();return}var g=gtRcpDn(a),h=Owa.Utility.isDefined(typeof a.getAttribute);if(h&&a.getAttribute("_sipTrsp"))e=1;var j=g,i=this.LdExstChtSsn(c,j);if(i)return;var f=rndm(),b={};b.iNtry=Owa.IM.CHT_RCP;if(Owa.Utility.isDefined(typeof a.getAttribute))b.oRcp=crtRecipObjectFromDomObject(a);else b.oRcp=new Recip(a._dn,a._em,a._sa,a._al,a._rt,a._ao,a._id,a._rf,a._ei,a._uri,"",a._type);if(!!b.oRcp._lgDn)b.oRcp._em=b.oRcp._lgDn;var d=this.bdyLst.GtBdy(c);if(d){b.oRcp._dn=d.dn;b.oRcp._uri=d.uri;b.oRcp._type=d.iType}else{if(b.oRcp._dn=="")b.oRcp._dn=g;b.oRcp._uri=c}b.fNN=1;b.iS=Owa.IM.CHT_SSN_ST_INIT;b.sChtId=f;b.iInt=1;if(e)b.sLDN=a.getAttribute("_em");this._addChatSession(f,b)};Owa.IM.IMMgr.prototype.NwChtSsnIn=function Owa$IM$IMMgr$NwChtSsnIn(f,g,d,m,i,h,e,n,l){if(!f||!d)return;if(this.GtChtSsnCnt()>=Owa.IM.MAX_CHT_SSNS){this.ErrMaxChats();return}var b=this.GtChtSsn(f);if(b&&!b.iInt){b.InMsg(d,i,h);return}if(!g)g=m;if(isSlfUri(d))for(var j=0;j<e.length;j++){var c=e[j];if(c&&c._uri&&!isSlfUri(c._uri)){g=gtRcpDn(c);break}}var k=0;if(!l&&(!b||!b.fIsConf))if(isMSNPrv()&&isSlfUri(d)){var c;if(e.length>0)c=e[0];if(c&&c._uri)if(e.length<2)b=this.LdExstChtSsn(c._uri,g,1,f);k=1}else if(e.length<2)b=this.LdExstChtSsn(d,g,1,f);if(b){this.MkChtSsnAct(b.sChtId,f);b.InMsg(d,i,h);return}var a={};a.iNtry=Owa.IM.CHT_IN;a.iS=Owa.IM.CHT_SSN_ST_INIT;a.sChtId=f;a.sSub=g;a.oRcp=new Recip(m,imns.IMUtils.NrmSipUri(d),"",0,RT_SMTP,AO_O,0,0,0,d,"",n);a.fNN=k;a.sMsg=i;a.sFrmt=h;a.rgoRcp=e;a.iInt=0;a.fIsConf=l?1:0;a.fNotUserActivity=1;this._addChatSession(f,a)};Owa.IM.IMMgr.prototype.IsIntCht=function Owa$IM$IMMgr$IsIntCht(b){if(!isDf(typeof b)||!b)return 1;var a=this.intChtSsns[b];if(isDf(typeof a)&&a&&a.iInt)return 1;else{a=this.chtSsns[b];return isDf(typeof a)&&a?0:-1}};Owa.IM.IMMgr.prototype.MkChtSsnAct=function Owa$IM$IMMgr$MkChtSsnAct(c,b){if(this.chtSsns[b])return;var a=this.intChtSsns[c];if(!a)return;a.sChtId=b;a.iInt=0;this.chtSsns[b]=a;this.chtSsnCnt++;this.intChtSsns[c]=0;this.intChtSsnCnt--;if(a.oContext){a.oContext.sChtId=b;a.oContext.iInt=0}if(a.oChtWin){a.oChtWin.sChtId=b;a.oChtWin.iInt=0}Owa.UIControls.ActiveChatsDialog.getDialog().updateChat(c,a.sChtId)};Owa.IM.IMMgr.prototype.ReplaceChtId=function Owa$IM$IMMgr$ReplaceChtId(a,b){var c=a.sChtId;a.sChtId=b;this.chtSsns[b]=a;this.chtSsns[c]=0;if(a.oContext)a.oContext.sChtId=b;if(a.oChtWin)a.oChtWin.sChtId=b;Owa.UIControls.ActiveChatsDialog.getDialog().updateChat(c,a.sChtId)};Owa.IM.IMMgr.prototype.MkChtSsnIdle=function Owa$IM$IMMgr$MkChtSsnIdle(c,e){var b=c,a=this.chtSsns[c];if(!a)return;if(e)b=rndm();a.sChtId=b;a.iInt=1;this.intChtSsns[b]=a;this.intChtSsnCnt++;this.chtSsns[c]=0;this.chtSsnCnt--;if(a.oContext){a.oContext.sChtId=b;a.oContext.iInt=1}try{if(a.oChtWin){a.oChtWin.iInt=1;a.oChtWin.sChtId=b;a.oChtWin.UpdActBarLstMsg()}}catch(f){}if(c!=b){var d=Owa.UIControls.ActiveChatsDialog.getDialog();d&&d.updateChat(c,b)}};Owa.IM.IMMgr.prototype.GtChtSsn=function Owa$IM$IMMgr$GtChtSsn(b){if(!isDf(typeof b)||!b)return 0;var a=0;a=this.intChtSsns[b];if(!isDf(typeof a)||!a)a=this.chtSsns[b];return!isDf(typeof a)?0:a};Owa.IM.IMMgr.prototype.LdExstChtSsn=function Owa$IM$IMMgr$LdExstChtSsn(d,b,e,c){var a=this.FndExstChtSsn(d,e,c);if(a&&(a.iSsnState==Owa.IM.CHT_SSN_ST_RDY||a.iSsnState==Owa.IM.CHT_SSN_ST_INIT)){if(b&&a.sSub!=b){a.UpdSub(b);try{a.oChtWin.UpdHdr(b)}catch(f){gtIMMgr().EndChtSsn(a.sChtId);return 0}}if(a.iSsnState==Owa.IM.CHT_SSN_ST_RDY)try{a.FocusWindow()}catch(f){gtIMMgr().EndChtSsn(a.sChtId);return 0}return a}};Owa.IM.IMMgr.prototype.FndExstChtSsn=function Owa$IM$IMMgr$FndExstChtSsn(c,e,d){if(!isDf(typeof c)||!c)return 0;var a,b;for(b in this.intChtSsns){a=this.intChtSsns[b];if(a&&!a.fIsConf&&this.AssmChtSsn(a,c,e,d))return a}for(b in this.chtSsns){a=this.chtSsns[b];if(a&&!a.fIsConf&&this.AssmChtSsn(a,c,e,d))return a}return 0};Owa.IM.IMMgr.prototype.AssmChtSsn=function Owa$IM$IMMgr$AssmChtSsn(a,c,k,l){var m=0;if(!isDf(typeof c)||!c||!isDf(typeof a)||!a)return 0;var f=a._utParticipants,g=f.Count(),b=0;if(g==0&&a.rgoMsgCch&&a.rgoMsgCch.length){for(var h=a.rgoMsgCch,d=new Owa.IM.UriTable,e=0;e<h.length;e++){var j=h[e];if(j.iMsgTp==Owa.IM.CHT_ADD_PCP){var i=j.o;d.Set(i._uri,i)}}if(d.Count()==1)b=d.Get(c)}else if(g==1)b=f.Get(c);if(!isDf(typeof k)&&!k)return b?1:0;if(b){!a.iInt&&this.ReplaceChtId(a,l);return 1}return 0};Owa.IM.IMMgr.prototype.GtChtSsnCnt=function Owa$IM$IMMgr$GtChtSsnCnt(){return this.intChtSsnCnt+this.chtSsnCnt};Owa.IM.IMMgr.prototype.UpdChtTtl=function Owa$IM$IMMgr$UpdChtTtl(c,b,e,f){if(!c)return;var a=this.GtChtSsn(c);if(a){if(e&&f&&a._utParticipants){var d=a._utParticipants.Get(e);if(d)d._dn=f}if(!b)b=a.CalcTtl();a.UpdSub(b);a.oChtWin&&a.oChtWin.UpdHdr(b);Owa.UIControls.ActiveChatsDialog.getDialog().updateParticipants(c,a.CalcAllDisplayNames())}};Owa.IM.IMMgr.prototype.EndChtSsn=function Owa$IM$IMMgr$EndChtSsn(a){if(!isDf(typeof a)||!a)return;var e=this.IsIntCht(a);if(e==-1)return;if(e){var b=this.intChtSsns[a];b.End();delete b;this.intChtSsns[a]=0;this.intChtSsnCnt--}else{var b=this.chtSsns[a],g=b._utParticipants,f,d=0;for(f in g.Keys())if(gtIMMgr().IsBlkd(f))d=1;var c={};c.sChtId=a;c.fDisc=d;sndIMReq(IM_ECS,0,0,c);b.End();delete b;this.chtSsns[a]=0;this.chtSsnCnt--}Owa.UIControls.ActiveChatsDialog.getDialog().removeChat(a)};Owa.IM.IMMgr.prototype.EnableAllChatSessions=function Owa$IM$IMMgr$EnableAllChatSessions(){var b,a;for(b in this.chtSsns){a=this.chtSsns[b];a&&a.oChtWin&&!a.fIsConf&&a.oChtWin.Enable()}for(b in this.intChtSsns){a=this.intChtSsns[b];a&&a.oChtWin&&!a.fIsConf&&a.oChtWin.Enable()}};Owa.IM.IMMgr.prototype.DsblAllChtsSsns=function Owa$IM$IMMgr$DsblAllChtsSsns(c){var b,a;for(b in this.intChtSsns){a=this.intChtSsns[b];a&&a.oChtWin&&a.oChtWin.Disable()}for(b in this.chtSsns){a=this.chtSsns[b];if(a){a.oChtWin&&a.oChtWin.Disable();!c&&gtIMMgr().MkChtSsnIdle(a.sChtId,true)}}};Owa.IM.IMMgr.prototype.removeAllBuddies=function Owa$IM$IMMgr$removeAllBuddies(){if(g_oBddyLst&&this.bdyLst){var a=this.bdyLst.GetGroups();for(var b in a)g_oBddyLst.removeGroup(b);this.bdyLst.sOtherContactsID=null;g_oBddyLst._edting&&g_oBddyLst.qtEdtNd()}this.bdyLst=new Owa.IM.BdyLst};Owa.IM.IMMgr.prototype.ErrMaxChats=function Owa$IM$IMMgr$ErrMaxChats(a){if(!isDf(typeof a)||!a)alrt(L_MaxChat.replace(/\{0\}/,Owa.IM.MAX_CHT_SSNS));else alrt(L_MaxIncomingChat.replace(/\{0\}/,Owa.IM.MAX_CHT_SSNS))};Owa.IM.IMMgr.prototype.Chk=function Owa$IM$IMMgr$Chk(){return 1};Owa.IM.IMMgr.prototype.BlinkChatWindow=function Owa$IM$IMMgr$BlinkChatWindow(a,c){if(!a)return;a.Blnk(c);var b=Owa.UIControls.ActiveChatsDialog.getDialog();b&&b.markReadState(a.sChtId,c)};Owa.IM.IMMgr.prototype.Disp=function Owa$IM$IMMgr$Disp(){this.bdyLst=this.othrsLst=this.blkLst=this.intChtSsns=this.intChtSsnCnt=this.chtSsns=this.chtSsnCnt=null}})();(function(){Owa.IM.CHT_SSN_ST_NONE=0;Owa.IM.CHT_SSN_ST_INIT=1;Owa.IM.CHT_SSN_ST_RDY=3;Owa.IM.CHT_SSN_ST_CLSNG=4;Owa.IM.CHT_WIN_ST_NONE=0;Owa.IM.CHT_WIN_ST_OPNNG=1;Owa.IM.CHT_WIN_ST_RDY=2;Owa.IM.CHT_WIN_ST_CLSNG=3;Owa.IM.CHT_MSG=0;Owa.IM.CHT_RCP=1;Owa.IM.CHT_IN=4;Owa.IM.CHT_MSG_NRM=0;Owa.IM.CHT_ADD_PCP=2;Owa.IM.CHT_RMV_PCP=3;Owa.IM.ACT_NONE=0;Owa.IM.ACT_TYPNG=1;Owa.IM.ACT_STPTYPNG=2;Owa.IM.ACT_TWOTYPNG=3;Owa.IM.ACT_UJOINDCHT=4;Owa.IM.ACT_LSTMSG=5;Owa.IM.ACT_EXTUSR=6;Owa.IM.ACT_LSTACTBR=7;Owa.IM.ACT_CHTSUB=8;Owa.IM.ACT_OJOINDCHT=9;Owa.IM.ACT_OLFTCHT=10;Owa.IM.ACT_FAILINV=11;Owa.IM.ACT_FAILMSGDLV=12;Owa.IM.ACT_FAILMSGDLVSRVRPLCY=13;Owa.IM.ACT_EVERYONELEFT=14;Owa.IM.ACT_LSTACTMSG=15;Owa.IM.CHT_TYPNG_TMR=3e3;Owa.IM.CHT_MSN_TYPNG_TMR=7e3;Owa.IM.CHT_FLSH_TMR=1e3;Owa.IM.CHT_FLSH_MAX=10;Owa.IM.ChtSsn=function Owa$IM$ChtSsn(c,a){this.iSsnState=a.iS;this.sChtId=a.sChtId;this.iInt=a.iInt;this.fUseExistingTitle=a.fUseExistingTitle;if(a.sLDN)this.sLDN=a.sLDN;if(!this.fUseExistingTitle){var b=new Owa.IM.UriTable;b.Set(a.oRcp._uri,a.oRcp);this.sSub=this.CalcTtl(b)}else this.sSub=isDf(typeof a.sSub)&&a.sSub?a.sSub:"";a.sSub=this.sSub;this.fIsConf=isDf(typeof a.fIsConf)?a.fIsConf:0;this.rgoMsgCch=[];this._utParticipants=new Owa.IM.UriTable;a.oRcp&&!isSlfUri(a.oRcp._uri)&&this.AddRcp(a.oRcp,a.fNN);this.iWinState=Owa.IM.CHT_WIN_ST_NONE;this.fIsPopOut=1;this.oContext=a};Owa.IM.ChtSsn.prototype.OpenWindow=function Owa$IM$ChtSsn$OpenWindow(d){if(this.oChtWin&&!d)this.FocusWindow();else if(!this.domWin){var e=this.oContext&&this.oContext.fNotUserActivity?"?UA=0&ae=Dialog&t=ChatWindow":"?ae=Dialog&t=ChatWindow",b=gtMstr(),a=Owa.Utility.isIE();if(a&&b&&b.g_winMgr){var c=b.g_winMgr.GetActiveWindow();if(c&&c.location.href.indexOf("t=ChatWindow")>=0)a=false}this.oChtWin=0;this.domWin=opnWin(e+gtCCUrl(),470,376,0,this.sChtId,0,1,Owa.Components.Application.get_RootSubPage(),null,a,1)}(!this.domWin||this.domWin&&this.domWin.closed)&&Owa.UIControls.ActiveChatsDialog.getDialog().show()};Owa.IM.ChtSsn.prototype.FocusWindow=function Owa$IM$ChtSsn$FocusWindow(){try{if(this.domWin){Owa.Utility.isChrome()&&this.domWin.blur();this.domWin.focus();this.oChtWin&&this.oChtWin.Focus()}}catch(a){}};Owa.IM.ChtSsn.prototype.UpdWinState=function Owa$IM$ChtSsn$UpdWinState(a,b){this.iWinState=b;this.oChtWin=a};Owa.IM.ChtSsn.prototype.CalcAllDisplayNames=function Owa$IM$ChtSsn$CalcAllDisplayNames(c){var b="",a,e;if(c)a=c;else a=this._utParticipants;for(e in a.Keys()){var d=a.Get(e);if(!d)continue;if(b)b+=", ";b+=d._dn}return b};Owa.IM.ChtSsn.prototype.CalcTtl=function Owa$IM$ChtSsn$CalcTtl(a){return!this.fUseExistingTitle?this.CalcAllDisplayNames(a):this.sSub};Owa.IM.ChtSsn.prototype.InMsg=function Owa$IM$ChtSsn$InMsg(a,c,f,d){if(!d){this.OpenWindow(true);Owa.UIControls.ActiveChatsDialog.getDialog().updateChat(this.sChtId,null,null,c)}if(!this.ChtWinRdy()&&(!isDf(typeof d)||!d)){this.AddMsgToCch(Owa.IM.CHT_MSG_NRM,a,c,f);return}var g=this._utParticipants.Get(a),b;if(!g)if(isMSNPrv()){if(isSlfUri(a))b=gtDN()}else return;else b=g._dn;if(!b)b=a;try{this.oChtWin.InMsg(a,b,c,f);if(this.domWin&&!this.domWin._fIsWinFocused){var e=gtIMMgr();e&&e.BlinkChatWindow(this.oChtWin,false)}}catch(h){}};Owa.IM.ChtSsn.prototype.InActMsg=function Owa$IM$ChtSsn$InActMsg(b,c,a,d,e,g,f){if(!this.ChtWinRdy())return;if(!isDf(typeof a)||!a)a=this.GtPrNm(c);if(b<Owa.IM.ACT_LSTACTBR)try{this.oChtWin.InActBarMsg(b,c,a)}catch(h){}else if(b>Owa.IM.ACT_LSTACTBR)try{this.oChtWin.InActMsg(b,a,d,e,g,f)}catch(h){}};Owa.IM.ChtSsn.prototype.GtPrNm=function Owa$IM$ChtSsn$GtPrNm(b){if(!isDf(typeof b)||!b)return"";var a=this._utParticipants.Get(b);return!a||!isDf(typeof a._dn)||!a._dn?Owa.IM.IMUtils.NrmSipUri(b):a._dn};Owa.IM.ChtSsn.prototype.ChtWinRdy=function Owa$IM$ChtSsn$ChtWinRdy(){return this.oChtWin&&this.iWinState==Owa.IM.CHT_WIN_ST_RDY?1:0};Owa.IM.ChtSsn.prototype.AddMsgToCch=function Owa$IM$ChtSsn$AddMsgToCch(b,e,d,c){var a={};a.iMsgTp=b;a.sUri=e;a.sMsg=d;a.sFrmt=c;this.rgoMsgCch.push(a)};Owa.IM.ChtSsn.prototype.AddRcpAddMsgToCch=function Owa$IM$ChtSsn$AddRcpAddMsgToCch(d,c,b){var a={};a.iMsgTp=Owa.IM.CHT_ADD_PCP;a.o=d;a.fNN=c;a.fWin=b;this.rgoMsgCch.push(a)};Owa.IM.ChtSsn.prototype.AddRcpRmMsgToCch=function Owa$IM$ChtSsn$AddRcpRmMsgToCch(b){if(b){var a={};a.iMsgTp=Owa.IM.CHT_RMV_PCP;a.sUri=b;this.rgoMsgCch.push(a)}};Owa.IM.ChtSsn.prototype.FlshMsgCch=function Owa$IM$ChtSsn$FlshMsgCch(){for(var b=0;b<this.rgoMsgCch.length;b++){var a=this.rgoMsgCch[b];if(a.iMsgTp==Owa.IM.CHT_MSG_NRM)this.InMsg(a.sUri,a.sMsg,a.sFrmt,1);else if(a.iMsgTp==Owa.IM.CHT_ADD_PCP)this.AddRcp(a.o,a.fNN,a.fWin);else a.iMsgTp==Owa.IM.CHT_RMV_PCP&&this.RmRcp(a.sUri)}this.rgoMsgCch=[]};Owa.IM.ChtSsn.prototype.UpdSub=function Owa$IM$ChtSsn$UpdSub(a){if(isDf(typeof a)&&a)this.sSub=a};Owa.IM.ChtSsn.prototype.AddRcp=function Owa$IM$ChtSsn$AddRcp(a,d,c){if(!this.ChtWinRdy()){this.AddRcpAddMsgToCch(a,d,c);return 1}if(!a||!isDf(typeof a._uri)||!a._uri||this._utParticipants.Get(a._uri))return 0;var b;if(isDf(typeof d)&&d)b=a;else b=new Recip(a._dn,a._em,a._sa,a._al,a._rt,a._ao,a._id,a._rf,a._ei,a._uri,"",a._type);if(isDf(typeof c)&&c&&this.ChtWinRdy()){this.oChtWin.AddRcp(b);this.InActMsg(imns.ACT_OJOINDCHT,b._uri,b._dn);gtIMMgr().gtPrsnc(b._uri)==gtDfltPrsnc()&&gtIMMgr().SubPrsnc([b._uri])}this._utParticipants.Set(a._uri,b);if(this._utParticipants.Count()>1)this.fIsConf=1;this.lstMsgUri=0;return 1};Owa.IM.ChtSsn.prototype.IsRcp=function Owa$IM$ChtSsn$IsRcp(a){return!isDf(typeof a)||!a?0:!this._utParticipants.Get(a)?0:1};Owa.IM.ChtSsn.prototype.UpdRcpSip=function Owa$IM$ChtSsn$UpdRcpSip(b,c){if(!isDf(typeof c)||!c)return;if(!isDf(typeof b)||!b)return;var a=this._utParticipants.Get(b);if(a){a._uri=c;this.oChtWin.AddRcp(a);this.oChtWin.RmRcp(b);gtIMMgr().gtPrsnc(a._uri)==gtDfltPrsnc()&&gtIMMgr().SubPrsnc([a._uri]);this._utParticipants.Remove(b,true);this._utParticipants.Set(a._uri,a)}};Owa.IM.ChtSsn.prototype.RmRcp=function Owa$IM$ChtSsn$RmRcp(a){if(!a)return 0;if(!this.ChtWinRdy()){this.AddRcpRmMsgToCch(a);return 1}if(!this.fIsConf&&this._utParticipants.Count()<2)return 0;if(this.IsRcp(a)&&this.ChtWinRdy()){this.oChtWin.RmRcp(a);var b="",c=this._utParticipants.Get(a);if(c)b=c.dn;this.InActMsg(imns.ACT_OLFTCHT,a,b);this._utParticipants.Remove(a,true)}else if(this.fIsConf&&isSlfUri(a)){var b=gtDN();this.InActMsg(imns.ACT_OLFTCHT,a,b);this.oChtWin.Disable()}if(this.fIsConf&&this._utParticipants.Count()==0){this.InActMsg(imns.ACT_EVERYONELEFT);this.oChtWin.Disable()}this.lstMsgUri=0;return 1};Owa.IM.ChtSsn.prototype.End=function Owa$IM$ChtSsn$End(){this.iSsnState=Owa.IM.CHT_SSN_ST_CLSNG;this.Disp();this.iSsnState=Owa.IM.CHT_SSN_ST_NONE};Owa.IM.ChtSsn.prototype.Disp=function Owa$IM$ChtSsn$Disp(){this.iSsnState=this.sChtId=this.sSub=this.iInt=this.rgoMsgCch=this._utParticipants=this.iWinState=this.fIsPopOut=this.domWin=this.oChtWin=null}})();(function(){Owa.IM.ChtWin=function Owa$IM$ChtWin(b,a,c){this.fIsPopOut=b;this.oDocumentElement=a;this.sChtId=c};Owa.IM.ChtWin.prototype.Load=function Owa$IM$ChtWin$Load(){this.sDN=gtDN();this.sUri=gtUri();this.rw=$(TO);this.rdArea=this.oDocumentElement.getDescendantById("rdArea");this.rdArea.attachEvent("keydown",SlctRdArea);this.txtBox=new Owa.IM.CmpArea(this.oDocumentElement.getDescendantById("txtBox"),this);this.lstInMsgTime=0;this.lstMsgUri=0;this.fLMA=0;this.oFlshTmr=0;this.iFlshCnt=0;this._utTypingList=new Owa.IM.UriTable;this.chtSsn=0;try{this.chtSsn=gtIMMgr().GtChtSsn(this.sChtId);this.chtSsn&&this.chtSsn.UpdWinState(this,Owa.IM.CHT_WIN_ST_RDY)}catch(a){}};Owa.IM.ChtWin.prototype.PostOnLoad=function Owa$IM$ChtWin$PostOnLoad(a){if(!a)return;switch(a.iNtry){case Owa.IM.CHT_MSG:case Owa.IM.CHT_RCP:if(isDf(typeof a.oRcp)&&a.oRcp){if(!isDf(typeof a.oRcp._uri)||!a.oRcp._uri)return;this.AddRcp(a.oRcp);this.chtSsn&&this.chtSsn.AddRcp(a.oRcp)}break;case Owa.IM.CHT_IN:if(isDf(typeof a.oRcp)&&a.oRcp&&!isSlfUri(a.oRcp._uri)){this.AddRcp(a.oRcp);this.chtSsn&&this.chtSsn.AddRcp(a.oRcp)}if(isDf(typeof a.rgoRcp)&&a.rgoRcp&&a.rgoRcp.length>0)for(var d=a.rgoRcp,b,c=0;c<d.length;c++){b=d[c];if(!isDf(typeof b._uri)||!b._uri)continue;if(isDf(typeof a.oRcp._uri)&&a.oRcp._uri)if(isSameUri(b._uri,a.oRcp._uri))continue;this.AddRcp(b);this.chtSsn&&this.chtSsn.AddRcp(b,1)}isDf(typeof a.sMsg)&&a.sMsg&&this.InMsg(a.oRcp._uri,a.oRcp._dn,a.sMsg,a.sFrmt)}this.chtSsn.FlshMsgCch&&this.chtSsn.FlshMsgCch();try{gtIMMgr().UpdChtTtl(this.chtSsn.sChtId)}catch(e){}this.txtBox.SetFocus();this.chtSsn.iSsnState=Owa.IM.CHT_SSN_ST_RDY};Owa.IM.ChtWin.prototype.RmRcp=function Owa$IM$ChtWin$RmRcp(a){removeRcpForIM(this.rw,a)};Owa.IM.ChtWin.prototype.AddRcp=function Owa$IM$ChtWin$AddRcp(a){a&&addRcpForIM(this.rw,a._dn,a._em,a._rt,a._sa,a._ao,a._rf,a._id,a._ei,a._uri);isDf(typeof onChatWinResize)&&onChatWinResize()};Owa.IM.ChtWin.prototype.ShwABCht=function Owa$IM$ChtWin$ShwABCht(){var a={},b=wda("divTo");a.sTo=b.innerHTML;a.sTgt="divTo";var c=function(){setRwHtml(b,a.sTo);revtRSpn()};shwABDlg(a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,a,"&a=PickParticipants",c)};Owa.IM.ChtWin.prototype.UpdHdr=function Owa$IM$ChtWin$UpdHdr(a){this.UpdTtl(a)};Owa.IM.ChtWin.prototype.UpdTtl=function Owa$IM$ChtWin$UpdTtl(a){if(!isDf(typeof a||!a))return;this.sTtl=a;if(isDf(typeof window.a_fChtWin)&&window.a_fChtWin)document.title=a;this.sFlshTtl=L_NwMsgs+" - "+this.sTtl};Owa.IM.ChtWin.prototype.InMsg=function Owa$IM$ChtWin$InMsg(d,f,c,b,a){var a=new Date,e=this.InsRdMsg(d,f,c,b,a);if(e)this.lstInMsgTime=a;this.UpdActBarLstMsg()};Owa.IM.ChtWin.prototype.InActBarMsg=function Owa$IM$ChtWin$InActBarMsg(b,a,c){if(b>=Owa.IM.ACT_LSTACTBR)return;switch(b){case Owa.IM.ACT_TYPNG:!this._utTypingList.Get(a)&&this._utTypingList.Set(a,c);this.ProcTypngMsg();break;case Owa.IM.ACT_STPTYPNG:this._utTypingList.Get(a)&&this._utTypingList.Remove(a);this.ProcTypngMsg();break;default:this.UpdActBar(b,c)}};Owa.IM.ChtWin.prototype.ProcTypngMsg=function Owa$IM$ChtWin$ProcTypngMsg(){var a=this._utTypingList.Count();if(a==0)this.UpdActBarLstMsg();else if(a==1)for(var c in this._utTypingList.Keys()){var b=this._utTypingList.Get(c);b&&this.UpdActBar(imns.ACT_TYPNG,b);break}else a>1&&this.UpdActBar(imns.ACT_TWOTYPNG)};Owa.IM.ChtWin.prototype.InActMsg=function Owa$IM$ChtWin$InActMsg(h,l,n,i,d,k){if(h<=Owa.IM.ACT_LSTACTBR||h>=Owa.IM.ACT_LSTACTMSG)return;var b,a,c="",g=1,j=0;switch(h){case Owa.IM.ACT_CHTSUB:b="chat-arw.gif";if(!isDf(typeof i)||!i)i="";a=htmlEnc(L_ChtSubLnk.replace(/\{0\}/,i));if(isDf(typeof d)&&d)a+="<A class='oLnk' id='aLnk' _lnk='"+htmlEnc(d)+"'>"+htmlEnc(" "+L_ChtSubClk)+"</A>";j=1;g=0;break;case Owa.IM.ACT_OJOINDCHT:b="joinchat.gif";a=htmlEnc(l+" "+L_OJoindCht);c="color:#006633;";break;case Owa.IM.ACT_OLFTCHT:b="leftchat.gif";a=htmlEnc(l+" "+L_OLftCht);c="color:#8b0000;";break;case Owa.IM.ACT_FAILINV:b="failinv.gif";a=htmlEnc(L_FailInv.replace(/\{0\}/,l));c="color:#8b0000;";break;case Owa.IM.ACT_EVERYONELEFT:b="leftchat.gif";a=htmlEnc(L_AllParticipantsLeft);c="color:#8b0000;";break;case Owa.IM.ACT_FAILMSGDLV:case Owa.IM.ACT_FAILMSGDLVSRVRPLCY:b="leftchat.gif";if(h==Owa.IM.ACT_FAILMSGDLV)a=htmlEnc(L_FailDeliv);else a=htmlEnc(L_FailDelivSrvrPlcy);c="color:#8b0000;";if(isDf(typeof d)&&d)a+="<A class='oLnk' id='aLnk' _lnk='"+htmlEnc(d)+"'>"+htmlEnc(" "+L_FailDelivClk)+"</A>";j=0;if(isDf(typeof k)&&k)a+=htmlEnc(" "+k)}var m=(this.fLMA||!g?"":"<div style='border-top:1px solid #999999;width:50;font-size:20%;'>&nbsp;</div>")+"<table><tr><td valign=top class='chtArrw'>"+Owa.Components.CssSprites.getImageMarkup(b,"","imgCht",null)+"</td><td id='tdChtMsg' class='chtMsg' style='"+c+"'>"+a+"</td></tr></table>"+(g?"<div style='margin:5px 0px 0px 0px;border-top:1px solid #999999;width:50;font-size:0%;'>&nbsp;</div>":""),f=Owa.Dom.Document.get_Current().createElement("div");this.rdArea.appendChild(f);f.set_InnerHtml(m);f.set_Margin(Owa.Style.Side.Top,7);f.set_Margin(Owa.Style.Side.Bottom,4);if(j){var e=f.getDescendantById("aLnk");e&&e.attachEvent("click",function(){isDf(typeof e._lnk)&&e._lnk&&opnWin(e._lnk)})}if(g)this.fLMA=1;this.ScToBtm()};Owa.IM.ChtWin.prototype.OutGoingMsg=function Owa$IM$ChtWin$OutGoingMsg(b,a){this.InsRdMsg(this.sUri,this.sDN,b,a)};Owa.IM.ChtWin.prototype.UpdActBar=function Owa$IM$ChtWin$UpdActBar(c,a){if(!isDf(typeof this.oTypng)||!this.oTypng)this.oTypng=$("divTypng");if(!isDf(typeof this.oJoin)||!this.oJoin)this.oJoin=$("divJoin");if(!isDf(typeof this.oLstMsg)||!this.oLstMsg)this.oLstMsg=$("divLstMsg");switch(c){case Owa.IM.ACT_NONE:this.oJoin.set_IsShown(false);this.oLstMsg.set_IsShown(false);this.oTypng.set_IsShown(false);break;case Owa.IM.ACT_TYPNG:if(!isDf(typeof a)||!a||a=="")return;this.oJoin.set_IsShown(false);this.oLstMsg.set_IsShown(false);this.oTypng.getChildById("typInd").set_TextContent(a+" "+L_IsTypng);this.oTypng.set_IsShown(true);break;case Owa.IM.ACT_TWOTYPNG:this.oJoin.set_IsShown(false);this.oLstMsg.set_IsShown(false);this.oTypng.getChildById("typInd").set_TextContent(L_TwoTypng);this.oTypng.set_IsShown(true);break;case Owa.IM.ACT_UJOINDCHT:this.oTypng.set_IsShown(false);this.oLstMsg.set_IsShown(false);this.oJoin.getChildById("joinInd").set_TextContent(L_UJoindCht);this.oJoin.set_IsShown(true);break;case Owa.IM.ACT_LSTMSG:this.oJoin.set_IsShown(false);this.oTypng.set_IsShown(false);var b=this.lstInMsgTime;if(!b){this.oLstMsg.set_IsShown(false);return}var d=fmtDt(b,a_sFlWkdDtFmt,1),e=L_On+" ",f=fmtDt(b,a_sShtTmFmt,1);this.oLstMsg.getChildById("lstMsgInd").set_TextContent(L_LstMsg.replace(/\{0\}/,e).replace(/\{1\}/,d).replace(/\{2\}/,f));this.oLstMsg.set_IsShown(true);break;case Owa.IM.ACT_EXTUSR:break;default:return}};Owa.IM.ChtWin.prototype.UpdActBarLstMsg=function Owa$IM$ChtWin$UpdActBarLstMsg(){if(this.lstInMsgTime)this.UpdActBar(imns.ACT_LSTMSG);else this.ClrActBar()};Owa.IM.ChtWin.prototype.ClrActBar=function Owa$IM$ChtWin$ClrActBar(){this.UpdActBar(imns.ACT_NONE)};Owa.IM.ChtWin.prototype.InsRdMsg=function Owa$IM$ChtWin$InsRdMsg(c,b,a,d,e){if(!isDf(typeof b)||!b)return 0;if(!isDf(typeof a)||!a)return 0;this.lstMsgUri!=c&&this.InsRdMsgHdr(c,b,e);this.InsRdMsgCnt(a,d);this.ScToBtm();this.fLMA=0;return 1};Owa.IM.ChtWin.prototype.InsRdMsgHdr=function Owa$IM$ChtWin$InsRdMsgHdr(d,e,a){if(!isDf(typeof a)||!a)a=new Date;var f=fmtDt(a,a_sShtTmFmt,1),c=htmlEnc(e)+" "+g_sDE+'<span class="chtRdTime">'+f+"</span>"+g_sDE+":",b=Owa.Dom.Document.get_Current().createElement("div");this.rdArea.appendChild(b);b.set_InnerHtml(c);b.addCssClass("chtRdHdr");this.lstMsgUri=d};Owa.IM.ChtWin.prototype.InsRdMsgCnt=function Owa$IM$ChtWin$InsRdMsgCnt(c){var f=15;if(c&&!Owa.Utility.isIE()){for(var a=c.split(" "),b=0;b<a.length;b++)if(a[b]&&a[b].length>f){var e=f,g=0,d="";while(e<a[b].length){if(d.length>0)d+="<wbr>";d+=this.htmlEnc(a[b].substring(g,e));g=e;e+=f}d+="<wbr>"+this.htmlEnc(a[b].substring(g));a[b]=d}else a[b]=this.htmlEnc(a[b]);c=a.join(" ")}else c=this.htmlEnc(c);var i='<table class="chtTable"><tr><td class="chtTableColumn1" valign=top>'+Owa.Components.CssSprites.getImageMarkup("chat-arw.gif","","imgCht",null)+"</td><td id='tdChtMsg' class='chtMsg'><pre style=\"margin: 0px; word-wrap: break-word;\">"+c+"</pre></td></tr></table>",h=Owa.Dom.Document.get_Current().createElement("div");this.rdArea.appendChild(h);h.set_InnerHtml(i)};Owa.IM.ChtWin.prototype.htmlEnc=function Owa$IM$ChtWin$htmlEnc(a){a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp(">","g"),"&gt;");return a};Owa.IM.ChtWin.prototype.ScToBtm=function Owa$IM$ChtWin$ScToBtm(){this.rdArea.set_ScrollTop(this.rdArea.get_ScrollHeight())};Owa.IM.ChtWin.prototype.Blnk=function Owa$IM$ChtWin$Blnk(a){if(this.fIsPopOut)if(isDf(typeof a)&&a){this.fBlinking=false;if(this.oFlshTmr){window.clearInterval(this.oFlshTmr);this.oFlshTmr=0;this.iFlshCnt=0}document.title=this.sTtl}else{this.fBlinking=true;this.sFlshTtl=L_NwMsgs+" - "+this.sTtl;if(!this.oFlshTmr)this.oFlshTmr=window.setInterval(FlshTtl,Owa.IM.CHT_FLSH_TMR)}};Owa.IM.ChtWin.prototype.FlshTtl=function Owa$IM$ChtWin$FlshTtl(){if(this.iFlshCnt>=Owa.IM.CHT_FLSH_MAX*2){window.clearInterval(this.oFlshTmr);this.oFlshTmr=0;this.iFlshCnt=0;document.title=this.sFlshTtl}else{document.title=document.title==this.sTtl?this.sFlshTtl:this.sTtl;this.iFlshCnt++}};Owa.IM.ChtWin.prototype.Focus=function Owa$IM$ChtWin$Focus(){this.txtBox.SetFocus()};Owa.IM.ChtWin.prototype.Disable=function Owa$IM$ChtWin$Disable(){showErr($("divErr"),L_ErrChtInct);this.txtBox.Disable();this.UpdActBarLstMsg();onChatWinResize()};Owa.IM.ChtWin.prototype.Enable=function Owa$IM$ChtWin$Disable(){hideErr($("divErr"));this.txtBox.Enable();onChatWinResize()};Owa.IM.ChtWin.prototype.Unload=function Owa$IM$ChtWin$Unload(){this.iWinState=Owa.IM.CHT_WIN_ST_CLSNG;try{gtIMMgr().EndChtSsn(this.sChtId)}catch(a){}this.Disp()};Owa.IM.ChtWin.prototype.Disp=function Owa$IM$ChtWin$Disp(){this.rdArea.detachAllEvents();this.sDN=this.rw=this.rdArea=this.txtBox=this.lstInMsgTime=this.lstMsgUri=this.fLMA=this._utTypingList=this.chtSsn=null}})();(function(){Owa.IM.CmpArea=function Owa$IM$CmpArea(c,b){this.oInput=c;this.oInput.set_Value("");this.chtWin=b;var a=this;this.oInput.attachEvent("input",function(){a.OnInput(a)});this.oInput.attachEvent("propertychange",function(b){a.OnPropertyChange(a,b)});this.oInput.attachEvent("keyup",function(){a.OnInput(a)});this.oInput.attachEvent("keydown",function(b){a.OnKeyDown(a,b)});this.oInput.attachEvent("click",function(){a.OnClick(a)});this.oInput.attachEvent("dragstart",function(){a.OnDragStart(a)});this.oInput.attachEvent("dragend",function(){a.OnDragEnd(a)});this.oTypngTmr=0;this.fStillTypng=0;this.font=new Font("Tahoma","000000")};Owa.IM.CmpArea.prototype.OnKeyDown=function Owa$IM$CmpArea$OnKeyDown(c,a){if(g_oChtWin&&g_oChtWin.fBlinking){var b=gtIMMgr();b&&b.BlinkChatWindow(g_oChtWin,true)}if(a.get_KeyCodeForKeyUpDown()==13&&!a.isShiftKeyDown()){c.SndMsg();a.preventDefault()}};Owa.IM.CmpArea.prototype.OnClick=function Owa$IM$CmpArea$OnClick(){if(g_oChtWin&&g_oChtWin.fBlinking){var a=gtIMMgr();a&&a.BlinkChatWindow(g_oChtWin,true)}};Owa.IM.CmpArea.prototype.OnPropertyChange=function Owa$IM$CmpArea$OnPropertyChange(a,b){b._oEvent.propertyName=="value"&&a.OnInput(a)};Owa.IM.CmpArea.prototype.OnInput=function Owa$IM$CmpArea$OnInput(a){a.fStillTypng=1;if(a.oInput.get_Value())if(a.oTypngTmr==0){a.SndTypng(0);a.fStillTypng=0;a.oTypngTmr=window.setInterval(ChkTypngState,Owa.IM.CHT_TYPNG_TMR)}!a.dragging&&vldtTxt(a.oInput,800)};Owa.IM.CmpArea.prototype.ChkTypngState=function Owa$IM$CmpArea$ChkTypngState(){if(!this.fStillTypng){gtIMType()==IM_TYPE_OCS&&this.SndTypng(1);window.clearInterval(this.oTypngTmr);this.oTypngTmr=0}this.fStillTypng=0};Owa.IM.CmpArea.prototype.SndMsg=function Owa$IM$CmpArea$SndMsg(){try{this.oInput.focus();var a=this.oInput.get_Value();if(!a)return;this.SndChtMsg(a,this.font.ToChtFrmt());this.oInput.set_Value("");window.clearInterval(this.oTypngTmr);this.oTypngTmr=0;this.fStillTypng=0;this.oInput.focus()}catch(b){}};Owa.IM.CmpArea.prototype.SndChtMsg=function Owa$IM$CmpArea$SndChtMsg(j,h){var a={},k=this.chtWin.sChtId,c=0;try{c=gtIMMgr().IsIntCht(k)}catch(l){}var b=this.chtWin.chtSsn._utParticipants;if(b){var d,f=[],g=[];for(d in b.Keys()){var e=b.Get(d);if(e){f.push(d);g.push(e._type)}}a.rgoRcp=f;a.rType=g;a.chtSsn=this.chtWin.chtSsn}if(!c)a.sChtId=this.chtWin.sChtId;a.sMsg=j;a.sFrmt=h;a.oChtWin=this.chtWin;a.feOnErr=failChtMsgDlv;var i=this.chtWin.chtSsn.sLDN;if(i)a.sLDn=i;if(c)sndIMReq(IM_SNCM,this.cbSndNewChtMsg,0,a);else sndIMReq(IM_SCM,this.cbSndChtMsg,0,a);this.chtWin.OutGoingMsg(j,h)};Owa.IM.CmpArea.prototype.cbSndNewChtMsg=function Owa$IM$CmpArea$cbSndNewChtMsg(e,h){var b=e.oChtWin,a;if(h!=""){var c=eval("("+h+")");if(c._sip){var f=e.rgoRcp[0];!isSameUri(f,c._sip)&&e.chtSsn.UpdRcpSip(f,c._sip)}if(b.chtSsn.sLDN)b.chtSsn.sLDN=null;a=c._cid}else a=-1;var d=b.sChtId;if(a>=0){var g=1;try{g=gtIMMgr().IsIntCht(d)}catch(j){}if(g){try{gtIMMgr().MkChtSsnAct(d,a)}catch(j){}b.sChtId=a;b.iInt=0}}else if(a==-1){var i=gtIMMgr().GtChtSsn(d);i.InActMsg(Owa.IM.ACT_FAILMSGDLV)}};Owa.IM.CmpArea.prototype.cbSndChtMsg=function Owa$IM$CmpArea$cbSndChtMsg(f,d){var b=f.oChtWin,a;if(d!=""){var g=eval("("+d+")");a=g._cid}else a=-1;var c=b.sChtId;if(a>=0){if(a!=c){var e=gtIMMgr().GtChtSsn(c);try{gtIMMgr().ReplaceChtId(e,a)}catch(h){}}}else a==-1&&b.InActMsg(Owa.IM.ACT_FAILMSGDLV)};Owa.IM.CmpArea.prototype.SndTypng=function Owa$IM$CmpArea$SndTypng(c){var a={};a.sChtId=this.chtWin.sChtId;var b=1;try{b=gtIMMgr().IsIntCht(a.sChtId)}catch(d){}!b&&sndIMReq(c?IM_NTPC:IM_NTP,0,0,a)};Owa.IM.CmpArea.prototype.OnDragStart=function Owa$IM$CmpArea$OnDragStart(a){a.dragging=1};Owa.IM.CmpArea.prototype.OnDragEnd=function Owa$IM$CmpArea$OnDragEnd(a){a.dragging=0};Owa.IM.CmpArea.prototype.Disable=function Owa$IM$CmpArea$Disable(){this.disabled=1;this.oInput&&this.oInput.set_IsDisabled(1)};Owa.IM.CmpArea.prototype.Enable=function Owa$IM$CmpArea$Enable(){this.disabled=0;this.oInput&&this.oInput.set_IsDisabled(0)};Owa.IM.CmpArea.prototype.SetFocus=function Owa$IM$CmpArea$SetFocus(){try{this.oInput&&!this.oInput.get_IsDisabled()&&this.oInput.focus()}catch(a){}};Owa.IM.CmpArea.prototype.Disp=function Owa$IM$CmpArea$Disp(){this.oInput.detachAllEvents();this.oTypngTmr=this.fStillTypng=this.font=this.chtWin=this.oInput=null}})();(function(){Owa.IM.Bdy=function Owa$IM$Bdy(g,f,a,d,e,b,c){this.dn=g;this.uri=f.lc();this.prsnc=a;this.iNumGroups=0;this.eml=d;this.prvdr=gtIMType();this.sGid=e;this.iType=b;this.fTag=c};Owa.IM.Bdy.prototype.GetBuddyGroups=function Owa$IM$Bdy$GetBuddyGroups(){var c=[],b=gtIMMgr().bdyLst,f=b.GetGroups(),d=false;for(var e in f){var a=b.GetGroup(e);if(a&&a.IsMember(this.uri)){if(e==b.sOtherContactsID)d=true;c.push(a)}}if(isOCSPrv()&&!d){a=b.GetGroup(b.sOtherContactsID);a&&c.push(a)}return c}})();(function(){Owa.IM.BdyGrp=function Owa$IM$BdyGrp(d,a,c,b){this.groupID=a;this.groupName=d;this.groupFlags=c;this.groupExpand=b;this._rendered=false;this._utMembers=new Owa.IM.UriTable;this._utRenderedStatus=new Owa.IM.UriTable};Owa.IM.BdyGrp.ValidateGroupName=function Owa$IM$BdyGrp$ValidateGroupName(a,c){var a=a.trim().lc();if(a=="")return c?L_ErrIMGrpSpNew:L_ErrIMGrpSpRen;var b=gtIMMgr();return!b?void 0:b.bdyLst.IsDuplicateGroup(a)?L_ErrIMGE:void 0};Owa.IM.BdyGrp.prototype.IsMember=function Owa$IM$BdyGrp$IsMember(a){return this._utMembers.Get(a)?true:false};Owa.IM.BdyGrp.prototype.IsOtherContactsGroup=function Owa$IM$BdyGrp$IsOtherContactsGroup(){return(this.groupFlags&Owa.IM.GROUP_FLAGS.OtherContacts)!=0};Owa.IM.BdyGrp.prototype.IsFavoritesGroup=function Owa$IM$BdyGrp$IsFavoritesGroup(){return(this.groupFlags&Owa.IM.GROUP_FLAGS.Favorites)!=0};Owa.IM.BdyGrp.prototype.RenameGroup=function Owa$IM$BdyGrp$RenameGroup(a){this.groupName=a;g_oBddyLst&&g_oBddyLst.renameGroup(this.groupID,a)};Owa.IM.BdyGrp.prototype.AddBuddyToGroup=function Owa$IM$BdyGrp$AddBuddyToGroup(g,a){if(!a)return;if(this.IsMember(a))return;var b=gtIMMgr();if(b){var d=b.bdyLst.GtBdy(a);if(d){this._utMembers.Set(a,a);d.iNumGroups++;if(!this.IsOtherContactsGroup()){var c=b.bdyLst.GetGroup(b.bdyLst.sOtherContactsID);c&&c.IsMember(a)&&c.RemoveBuddyFromGroup(a)}g_oBddyLst&&!g_oBddyLst.fRendering&&g_oBddyLst.startRendering()}}};Owa.IM.BdyGrp.prototype.RemoveBuddyFromGroup=function Owa$IM$BdyGrp$RemoveBuddyFromGroup(b){if(!b)return 0;var c=0,d=gtIMMgr();if(d){var a=d.bdyLst.GtBdy(b);if(a)c=a.iNumGroups}if(this.IsMember(b)){this._utMembers.Remove(b);if(a){a.iNumGroups--;c=a.iNumGroups}g_oBddyLst&&g_oBddyLst.rmvBddyFrmGrp(this.groupID,b)}return c};Owa.IM.BdyGrp.prototype.GtLen=function Owa$IM$BdyGrp$GtLen(){return this._utMembers.Count()};Owa.IM.BdyGrp.prototype.GetMembers=function Owa$IM$BdyGrp$GetMembers(){return this._utMembers.Keys()};Owa.IM.BdyGrp.prototype.GetBuddyRenderingStatus=function Owa$IM$BdyGrp$GetBuddyRenderingStatus(a){return this._utRenderedStatus.Get(a)?true:false};Owa.IM.BdyGrp.prototype.GetGroupRenderingStatus=function Owa$IM$BdyGrp$GetGroupRenderingStatus(){return this._rendered};Owa.IM.BdyGrp.prototype.SetBuddyRenderingStatus=function Owa$IM$BdyGrp$SetBuddyRenderingStatus(b,a){this._utRenderedStatus.Set(b,a)};Owa.IM.BdyGrp.prototype.SetGroupRenderingStatus=function Owa$IM$BdyGrp$SetGroupRenderingStatus(a){this._rendered=a}})();(function(){Owa.IM.BdyLst=function Owa$IM$BdyLst(){this._grpLst={};this._utBuddyList=new Owa.IM.UriTable;this._utStaleUris=new Owa.IM.UriTable;this._grpLstLen=0;this.sOtherContactsID=null};Owa.IM.BdyLst.prototype.AddGrp=function Owa$IM$BdyLst$AddGrp(c,a,d,e){var b=this.GetGroup(a);if(b){b.groupName!=c&&b.RenameGroup(c);return}if((d&Owa.IM.GROUP_FLAGS.OtherContacts)!=0)this.sOtherContactsID=a;this._grpLst[a]=new Owa.IM.BdyGrp(c,a,d,e);this._grpLstLen++;g_oBddyLst&&!g_oBddyLst.fRendering&&g_oBddyLst.startRendering()};Owa.IM.BdyLst.prototype.AddBdy=function Owa$IM$BdyLst$AddBdy(a,g,h,e,f){if(isSlfUri(a))return null;var b=this.GtBdy(a);if(b)return b;var d=gtDfltPrsnc();if(gtIMMgr().IsBlkd(a))d=IM_PR_BLKD;b=new Owa.IM.Bdy(h,a,d,null,g,e,f);this._utBuddyList.Set(a,b);var c=gtIMMgr().othrsLst;if(c.IsPrsnt(a)){this.UpdPrsnc(a,c.GtPrsnc(a),c.GtBdy(a).dn);c.RmBdy(a)}return b};Owa.IM.BdyLst.prototype.GetGroupLen=function Owa$IM$BdyLst$GetGroupLen(){return this._grpLstLen};Owa.IM.BdyLst.prototype.GetGroups=function Owa$IM$BdyLst$GetGroups(){return this._grpLst};Owa.IM.BdyLst.prototype.RmBdy=function Owa$IM$BdyLst$RmBdy(a){var d=this._utBuddyList.Get(a);if(d){this._utBuddyList.Remove(a);if(this._grpLstLen>0){var b=this._grpLst;for(var c in b)this.IsGroup(c)&&b[c].RemoveBuddyFromGroup(a)}}return d};Owa.IM.BdyLst.prototype.RemoveGroup=function Owa$IM$BdyLst$RemoveGroup(a){if(!a)return;var c=this.GetGroup(a);if(c){if(c.GtLen()>0)for(var d in c.GetMembers()){var b=this.GtBdy(d);if(b){var f=b.iNumGroups;c.RemoveBuddyFromGroup(d);if(f==1){var e=this.GetGroup(this.sOtherContactsID);e&&e.AddBuddyToGroup(b.dn,d,b.prsnc)}}}this._grpLst[a]=0;this._grpLstLen--;g_oBddyLst&&g_oBddyLst.removeGroup(a)}};Owa.IM.BdyLst.prototype.IsBdy=function Owa$IM$BdyLst$IsBdy(a){return this.GtBdy(a)?1:0};Owa.IM.BdyLst.prototype.GtBdy=function Owa$IM$BdyLst$GtBdy(a){a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);return this._utBuddyList.Get(a)};Owa.IM.BdyLst.prototype.IsGroup=function Owa$IM$BdyLst$IsGroup(a){return!isDf(typeof a)||!a?0:this._grpLst[a]?1:0};Owa.IM.BdyLst.prototype.IsDuplicateGroup=function Owa$IM$BdyLst$IsDuplicateGroup(a){if(isOCSPrv()&&a=="~")return true;for(var c in this._grpLst){var b=this._grpLst[c];if(b&&a==b.groupName.lc())return true}return false};Owa.IM.BdyLst.prototype.GetGroup=function Owa$IM$BdyLst$GetGroup(a){return!a?0:this._grpLst[a]};Owa.IM.BdyLst.prototype.GtLen=function Owa$IM$BdyLst$GtLen(){return this._utBuddyList.Count()};Owa.IM.BdyLst.prototype.UpdPrsnc=function Owa$IM$BdyLst$UpdPrsnc(e,a,b){if(a>IM_PR_UNKNWN)a=gtPrsncIdFrmVal(a);var c=this.GtBdy(e);if(c){c.prsnc=a;if(isDf(typeof b)&&b&&b!="")c.dn=b;if(g_oBddyLst){var f=this._grpLst;for(var d in f)this.IsGroup(d)&&g_oBddyLst.updateGrpPrsc(d,b,e,a)}}};Owa.IM.BdyLst.prototype.GetBuddyType=function Owa$IM$BdyLst$GetBuddyType(b){var a=this.GtBdy(b);return!a||!a.iType?Owa.IM.BUDDY_TYPE.None:a.iType};Owa.IM.BdyLst.prototype.GtPrsnc=function Owa$IM$BdyLst$GtPrsnc(b){if(!b)return gtDfltPrsnc();if(gtIMMgr().IsBlkd(b))return IM_PR_BLKD;var a=this.GtBdy(b);return a==null?gtDfltPrsnc():a.prsnc>IM_PR_UNKNWN||a.prsnc<IM_PR_AV?gtDfltPrsnc():a.prsnc}})();(function(){Owa.IM.OthrsLst=function Owa$IM$OthrsLst(){this._utOthersList=new Owa.IM.UriTable};Owa.IM.OthrsLst.prototype.AddBdy=function Owa$IM$OthrsLst$AddBdy(f,a,c){if(!a||!a[0])return;var b=a[0],e=a[1];if(c<IM_PR_AV||c>IM_PR_UNKNWN)return;if(this.IsPrsnt(b)||isSlfUri(b))return;var d=new Owa.IM.Bdy(f,b,c,null,e),g=new Date;d.time=g.getTime();d.dcying=0;this._utOthersList.Set(b,d)};Owa.IM.OthrsLst.prototype.MvBdyFrmBdyLst=function Owa$IM$OthrsLst$MvBdyFrmBdyLst(a,b){if(!a)return;var c=new Date;a.time=c.getTime();a.dcying=0;this._utOthersList.Set(b,a)};Owa.IM.OthrsLst.prototype.RmBdy=function Owa$IM$OthrsLst$RmBdy(b,d){if(!b)return;var c=this._utOthersList.Get(b);if(!c)return;var a=1;if(isDf(typeof d)&&d)if(c.dcying)a=1;else a=0;a&&this._utOthersList.Remove(b,true)};Owa.IM.OthrsLst.prototype.IsPrsnt=function Owa$IM$OthrsLst$IsPrsnt(a){return this._utOthersList.Get(a)?1:0};Owa.IM.OthrsLst.prototype.GtLen=function Owa$IM$OthrsLst$GtLen(){return this._utOthersList.Count()};Owa.IM.OthrsLst.prototype.UpdPrsnc=function Owa$IM$OthrsLst$UpdPrsnc(c,b,a,e){if(b>IM_PR_UNKNWN)b=gtPrsncIdFrmVal(b);var d=this._utOthersList.Get(c);if(d){d.prsnc=b;if(isDf(typeof a)&&a&&a!="")d.dn=a}else if(!isDf(typeof e)||!e){if(!isDf(typeof a)||!a||a=="")a=Owa.IM.IMUtils.NrmSipUri(c);this.AddBdy(a,[c],b,IM_TYPE_OCS)}};Owa.IM.OthrsLst.prototype.Decay=function Owa$IM$OthrsLst$Decay(j,i,c){var b="",f=this._utOthersList,h=IM_TYPE_OCS,e=0,l=new Date,g=l.getTime();if(!j)g-=10*60*1e3;else if(isDf(typeof c)&&c==0)return 0;var a;for(var k in f.Keys()){a=f.Get(k);if(a&&a.time<g){b+=a.uri;h=a.prvdr;b+=",";a.dcying=1;e++;if(isDf(typeof c)&&e>=c)break}}if(e>0){var d={};d.sUrisUnsub=b.substr(0,b.length-1);if(!i)sndIMReq(IM_SC,this.cbDecay,null,d);else return d}return 0};Owa.IM.OthrsLst.prototype.cbDecay=function Owa$IM$OthrsLst$cbDecay(a){if(!a)return;if(isDf(typeof a.sUrisUnsub)&&a.sUrisUnsub)for(var c=a.sUrisUnsub.split(","),b=0;b<c.length;b++)gtIMMgr().othrsLst.RmBdy(c[b],1)};Owa.IM.OthrsLst.prototype.GtBdy=function Owa$IM$OthrsLst$GtBdy(a){return this._utOthersList.Get(a)};Owa.IM.OthrsLst.prototype.GtPrsnc=function Owa$IM$OthrsLst$GtPrsnc(b){if(!b)return gtDfltPrsnc();if(gtIMMgr().IsBlkd(b))return IM_PR_BLKD;var a=this._utOthersList.Get(b);if(!a)return gtDfltPrsnc();if(a.prsnc>IM_PR_UNKNWN||a.prsnc<IM_PR_AV)return gtDfltPrsnc();var c=new Date;a.time=c.getTime();return a.prsnc}})();(function(){Owa.IM.BlkLst=function Owa$IM$BlkLst(){this._utBlockedList=new Owa.IM.UriTable};Owa.IM.BlkLst.prototype.SetBlkd=function Owa$IM$BlkLst$SetBlkd(a){if(!isDf(typeof a)||!a)return;a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);this._utBlockedList.Set(a,1)};Owa.IM.BlkLst.prototype.SetUnblkd=function Owa$IM$BlkLst$SetUnblkd(a){if(!isDf(typeof a)||!a)return;a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);this._utBlockedList.Remove(a,true,true)};Owa.IM.BlkLst.prototype.Contains=function Owa$IM$BlkLst$Contains(a){a=gtIMMgr().pxyLst.GetBuddyPrimaryUri(a);return this._utBlockedList.Get(a)}})();(function(){Owa.IM.ProxyList=function Owa$IM$ProxyList(){this._utPxyLst=new Owa.IM.UriTable};Owa.IM.ProxyList.prototype.AddProxies=function Owa$IM$ProxyList$AddProxies(b,a){if(!isDf(typeof b)||!b)return;a.unshift(b);for(var c=0;c<a.length;c++){var d=a[c];this._utPxyLst.Set(d,a)}};Owa.IM.ProxyList.prototype.RemoveProxies=function Owa$IM$ProxyList$RemoveProxies(b){if(!isDf(typeof b)||!b)return;var a=this._utPxyLst.Get(b);if(a&&a.length)for(var c=0;c<a.length;c++){var d=a[c];this._utPxyLst.Get(d)&&this._utPxyLst.Remove(d,true)}};Owa.IM.ProxyList.prototype.GetProxies=function Owa$IM$ProxyList$GetProxies(a){return this._utPxyLst.Get(a)};Owa.IM.ProxyList.prototype.GetBuddyPrimaryUri=function Owa$IM$ProxyList$GetBuddyPrimaryUri(c){var b=this.GetProxies(c),a;if(b&&b.length)a=b[0];if(!a)a=c;return Owa.IM.IMUtils.CleanUri(a)}})();function ChkTypngState(){this.g_oChtWin.txtBox.ChkTypngState()}function FlshTtl(){this.g_oChtWin.FlshTtl()}function SlctRdArea(b){var c=b.get_Target()._get_DomNode();if(b.isCtrlKeyDown()&&b.get_KeyCodeForKeyUpDown()==65){var a=c.document.body.createTextRange();a.moveToElementText(c);var d="character";a.moveStart(d,-1);a.moveEnd(d,1);a.text&&a.select();canEvt(b)}}function APS(k){if(!gtIMMgr())return;gtIMMgr().fReceivedBuddyList=true;g_iIM_SI&&gtMstr()&&!gtMstr().g_fSigningIn&&enblIM();var c={},o={};if(!k||!k.length)return;var e=gtIMMgr().bdyLst,u=gtIMMgr().othrsLst,g=k[0];if(g)for(var b=0;b<g.length;b++){e.AddGrp(g[b][0],g[b][1],g[b][2],g[b][3]);if(c)c[g[b][1]]={}}var h,n,r,j,p,q,d,v,a,m=k[1];if(m)for(var b=0;b<m.length;b++){h=m[b];n=h[0].lc();r=h[1];j=h[2];p=h[3];d=h[4];q=h[5];if(!j||j=="")j=imns.IMUtils.NrmSipUri(n);var f=e.AddBdy(n,r,j,p,q);if(!f)continue;if(!d||d.length==0)d=[e.sOtherContactsID];for(var l=0;l<d.length;l++){if(d[l]==e.sOtherContactsID&&d.length>1)continue;a=e.GetGroup(d[l]);if(a){if(c){if(!c[a.groupID])c[a.groupID]={};c[a.groupID][f.uri]=true;o[f.uri]=true}a.AddBuddyToGroup(f.dn,f.uri,f.prsnc,f.iType)}}}if(c){var s=[];for(sGroupId in e.GetGroups()){a=e.GetGroup(sGroupId);if(a)for(var i in a.GetMembers()){i=Owa.IM.IMUtils.FrmSipUri(i);if(c[sGroupId]&&c[sGroupId][i])continue;if(o[i]){var t=a.RemoveBuddyFromGroup(i);t<=0&&s.push(i)}}}}}function PXY(a){if(!gtIMMgr())return;if(!a||!a.length)return;for(var f=gtIMMgr().pxyLst,b,g,e=[],d=0;d<a.length;d++){b=a[d][0];var c={};c.sUri=b;c.prsnc=gtIMMgr().gtPrsnc(b);c.sDN=gtIMMgr().gtDN(b);e.push(c);f.AddProxies(b,a[d][1])}e.length>0&&pushPrsnc(e)}function SI(e){if(gtMstr()&&gtMstr().g_fSignedIn)return;if(e){g_fSigningIn=1;g_oBddyLst&&g_oBddyLst.shwPrgInd()}else{g_fSigningIn=0;if(!gtIMMgr())return;g_oBddyLst&&gtIMMgr().fReceivedBuddyList&&!g_oBddyLst.fRendering&&g_oBddyLst.shwPrgInd(1);g_oBddyLst&&g_oBddyLst.shwAddBddyLnk();stSlfPrsnc(IM_PR_AV);enblIM();if(isMSNPrv()){var c={},b=[],a,d=gtIMMgr().bdyLst._utBuddyList;for(a in d.Keys()){a=Owa.IM.IMUtils.CleanUri(a);b.push(a)}c.rgsUris=b;sndIMReq(IM_PXY,null,null,c)}}}function RC(b){if(!b||!b.length)return;if(!gtIMMgr())return;for(var c=0;c<b.length;c++){var a=b[c];a=imns.IMUtils.FrmSipUri(a);if(a&&gtIMMgr().bdyLst.IsBdy(a)){var d=gtIMMgr().bdyLst.RmBdy(a);d&&gtIMMgr().othrsLst.MvBdyFrmBdyLst(d,a);gtIMMgr().pxyLst.RemoveProxies(a)}}}function RCG(e){if(!e||!e.length)return;if(!gtIMMgr())return;for(var c,g=0;g<e.length;g++){c=e[g];if(c&&c.length<2)continue;var d=c[0];if(d&&gtIMMgr().bdyLst.IsGroup(d)){var b=c[1],a=gtIMMgr().bdyLst;if(b&&a.IsBdy(b)){var f=a.GtBdy(b),h=f.iNumGroups;if(h>1)a.GetGroup(d).RemoveBuddyFromGroup(b);else if(h==1&&d!=a.sOtherContactsID){a.GetGroup(d).RemoveBuddyFromGroup(b);a.GetGroup(a.sOtherContactsID).AddBuddyToGroup(f.dn,b,f.prsnc)}}}}}function RG(a){if(!a||!a.length)return;if(!gtIMMgr())return;for(var b=0;b<a.length;b++)gtIMMgr().bdyLst.RemoveGroup(a[b])}function GPC(c,b){if(!gtIMMgr())return;var a=gtIMMgr().bdyLst.GetGroup(c);a&&a.RenameGroup(b)}function QPC(a){PC(a,1)}function PC(f,k){if(!f||!f.length)return;if(!gtIMMgr())return;for(var j=[],g,a,b,c,d,e,i,h=0;h<f.length;h++){g=f[h];a=g[0];if(!a||!isDf(typeof a)||a=="")continue;b=g[2];a=imns.IMUtils.FrmSipUri(a);a=a.lc();c=gtPrsncIdFrmVal(g[1]);d=gtIMMgr().bdyLst.GtBdy(a);if(d)i=true;else d=gtIMMgr().othrsLst.GtBdy(a);if(d){if(d.prsnc==c&&(!b||b==""||b==d.dn))continue;if(gtIMMgr().IsBlkd(a)){d.prsnc=c;continue}if(!b||b=="")b=d.dn}if(i)gtIMMgr().bdyLst.UpdPrsnc(a,c,b);else if(isDf(typeof k))gtIMMgr().othrsLst.UpdPrsnc(a,c,b,k);else gtIMMgr().othrsLst.UpdPrsnc(a,c,b,0);e={};e.prsnc=c;e.fNm=gtIMFFrmId(c);e.sUri=a;if(b&&b!="")e.sDN=b;j.push(e)}pushPrsnc(j)}function IMUP(a){if(!isDf(typeof a))return;stSlfPrsnc(gtPrsncIdFrmVal(a),1)}function MCht(){if(!gtIMMgr())return;gtIMMgr().ErrMaxChats(1)}function PCF(){stSlfPrsnc(gtSlfPrsnc(1));alrt(L_ErrIMPr,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function ACF(b){if(isDf(typeof a_fOrgP)||isDf(typeof a_fDir)&&a_fDir){var a=Owa.Components.ToolbarCollection.get(Owa.Components.Application.get_RootSubPage());a.set_IsButtonShown(BID_RMBLST,false);a.set_IsButtonShown(BID_ABLST,true);a.set_IsButtonDisabled(BID_ABLST,false)}alrt(L_ErrAblst.replace(/\{0\}/,Owa.IM.IMUtils.NrmSipUri(b)),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_ErrAblstTtl)}function RCS(){}function RCF(a){if(isDf(typeof a_fOrgP)||isDf(typeof a_fDir)&&a_fDir){var b=Owa.Components.ToolbarCollection.get(Owa.Components.Application.get_RootSubPage());Owa.Components.ToolbarCollection.get_Current().set_IsButtonShown(BID_RMBLST,true);Owa.Components.ToolbarCollection.get_Current().set_IsButtonShown(BID_ABLST,false)}if(gtIMMgr())try{gtIMMgr().StStlUri(a)}catch(c){}alrt(L_ErrRmblst.replace(/\{0\}/,Owa.IM.IMUtils.NrmSipUri(a)),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_ErrRmblstTtl)}function MSCF(){}var g_oSiTmr=null,IM_SIGN_IN_RETRY_INTERVAL=1.2e5,IM_MIGRATION_IN_PROGRESS_RETRY_INTERVAL=1.2e5,IM_MIGRATION_IN_PROGRESS_INITIAL_RETRY_INTERVAL=1e4,IM_REMOTE_SIGNOUT=1002,IM_DISC=1003,IM_UNKN_ERR=1004,IM_DISC_TOOMANYENDPOINTS=1006,IM_FAIL_ADDRESS_NOT_AVAILABLE=2e3,IM_FAIL_EXTERNAL_AUTHENTICATION_DISABLED=2001,IM_FAIL_EXTERNAL_IDENTITY_UNKNOWN=2002,IM_FAIL_MSN_TERMS_OF_USE_NOT_SIGNED=2003,IM_FAIL_OVER_MAX_PAYLOAD_SIZE=2004,IM_FAIL_CREATE_ENDPOINT=2005,IM_FAIL_SERVER_TIMEOUT=3e3,IM_FAIL_SIGN_IN_FAILURE=3001,IM_FAIL_SIGN_IN_DISCONNECTED=3002,IM_FAIL_SESSION_DISCONNECTED=3003,IM_FAIL_SESSION_SIGN_OUT=3004,IM_FAIL_SERVICE_SHUTDOWN=3005,IM_FAIL_REINITIALIZE_OWA=3006,IM_FAIL_MIGRATION_IN_PROGRESS=3008,IM_FAIL_MIGRATION_NEEDED=3009,IM_FAIL_POLICY_CHANGED=3010,IM_FAIL_CLIENT_SIGN_OUT=4e3,IM_FAIL_CLIENT_LIMIT=4001,IM_FAIL_BEGIN_SIGN_IN_ERROR=5e3,IM_FAIL_SIGN_IN_ERROR=5001;function UN(e,d){isDf(typeof g_oBddyLst)&&g_oBddyLst&&g_oBddyLst.shwIMUnavl(e);var c=0;dsblIM();var a=0,b=IM_SIGN_IN_RETRY_INTERVAL;switch(e){case IM_FAIL_ADDRESS_NOT_AVAILABLE:case IM_FAIL_EXTERNAL_AUTHENTICATION_DISABLED:case IM_FAIL_EXTERNAL_IDENTITY_UNKNOWN:case IM_FAIL_MSN_TERMS_OF_USE_NOT_SIGNED:case IM_FAIL_CREATE_ENDPOINT:Owa.IM.IMUtils.SetMenuSISO(true);c=1;break;case IM_FAIL_SESSION_SIGN_OUT:case IM_FAIL_CLIENT_SIGN_OUT:case IM_FAIL_CLIENT_LIMIT:case IM_FAIL_MIGRATION_NEEDED:case IM_FAIL_POLICY_CHANGED:c=1;break;case IM_FAIL_SERVER_TIMEOUT:case IM_FAIL_REINITIALIZE_OWA:case IM_FAIL_OVER_MAX_PAYLOAD_SIZE:a=IM_SIGN_IN_RETRY_INTERVAL;b=0;break;case IM_FAIL_SIGN_IN_FAILURE:case IM_FAIL_BEGIN_SIGN_IN_ERROR:case IM_FAIL_SIGN_IN_ERROR:a=IM_SIGN_IN_RETRY_INTERVAL;b=a;break;case IM_FAIL_SIGN_IN_DISCONNECTED:case IM_FAIL_SESSION_DISCONNECTED:case IM_FAIL_SERVICE_SHUTDOWN:a=isDf(typeof d)&&d>0?d*1e3:IM_SIGN_IN_RETRY_INTERVAL;b=a;break;case IM_FAIL_MIGRATION_IN_PROGRESS:a=IM_MIGRATION_IN_PROGRESS_RETRY_INTERVAL;b=IM_MIGRATION_IN_PROGRESS_INITIAL_RETRY_INTERVAL}if(c&&g_oSiTmr){clearTimeout(g_oSiTmr);g_oSiTmr=null}if(a&&!g_oSiTmr)g_oSiTmr=setTimeout("ImSIR("+a+", 0);",b)}function UNC(){isDf(typeof g_oBddyLst)&&g_oBddyLst&&g_oBddyLst.shwIMUnsupported();dsblIM();Owa.IM.SUPPORTED_USER=0}function dsblIM(){if(!gtIMMgr())return;gtIMMgr().DsblAllChtsSsns();g_iIM_SI=1;gtIMMgr().fReceivedBuddyList=false;gtIMMgr().pshUkwnPrsnc();if(gtMstr()){gtMstr().g_fSignedIn=0;gtMstr().g_fSigningIn=0}Owa.IM.IMUtils.SetMenuSISO();gtIMMgr().removeAllBuddies();var a=Owa.UIControls.BuddyDialog.getDialog();if(a){a.hide();a.updateTitlebarButton(true)}var b=Owa.UIControls.ActiveChatsDialog.getDialog();b.hide();b.updateTitlebarButton(true);Owa.IM.IMUtils.HideNewChatToast();enbIMBtns(getNavigationPage(),0,0,1)}function enblIM(){if(!gtIMMgr())return;gtIMMgr().EnableAllChatSessions();g_iIM_SI=0;stSlfPrsnc(gtSlfPrsnc(1));if(gtMstr())gtMstr().g_fSignedIn=1;Owa.IM.IMUtils.SetMenuSISO();Owa.UIControls.ActiveChatsDialog.getDialog().updateTitlebarButton();enbIMBtns(getNavigationPage(),1,0,1)}function ImSIR(a,d,f,e){var b={};b.fMnlSI=f;b.fUserInitiated=e;if(g_oSiTmr){clearTimeout(g_oSiTmr);g_oSiTmr=null}if(g_iIM_SI){sndIMReq(IM_SI,null,null,b);if(!isDf(typeof d)||!d){var c=isDf(typeof a)&&a>0?a:IM_SIGN_IN_RETRY_INTERVAL;g_oSiTmr=setTimeout("ImSIR("+c+", 0);",c)}}}function EIM(a){if(!isDf(typeof a)||!a)return;if(!gtIMMgr())return;Owa.IM.IMUtils.HideNewChatToast(a);gtIMMgr().MkChtSsnIdle(a)}function IM(a,c,b,e){if(!isDf(typeof a)||!a||!isDf(typeof c)||!c||!isDf(typeof b)||!b)return;if(!gtIMMgr())return;var d=gtIMMgr().GtChtSsn(a);if(!d||gtIMMgr().IsIntCht(a)){NIM(a,c,b,e);return}d.InMsg(c,b,e)}function TST(c,d,e,a,b){Owa.IM.IMUtils.ShowNewChatToast(c,d,e,a,b)}function NIM(c,a,d,h,g,f,e){if(!c||!a||!isDf(typeof d))return;if(!gtIMMgr())return;var b=gtIMMgr().gtDN(a);if(!b)b=imns.IMUtils.NrmSipUri(a);NwIM(c,g,a,b,d,[],"",f,e)}function NwIM(c,g,h,i,f,a,e,d,b){window.setTimeout(function(){NwIM_2(c,g,h,i,f,a,e,d,b)},0)}function NwIM_2(i,l,m,n,k,b,j,d,h){if(!gtIMMgr())return;var f=[];if(!isDf(typeof d))d=Owa.IM.BUDDY_TYPE.None;if(isDf(typeof b)&&b&&b.length>0)for(var g,a,c,e=0;e<b.length;e++){g=b[e];a=g[0];if(isSlfUri(a))continue;c=gtIMMgr().gtDN(a);if(!c)c=imns.IMUtils.NrmSipUri(a);f.push(new Recip(c,imns.IMUtils.NrmSipUri(a),"",0,RT_SMTP,AO_O,0,0,0,a,"",d))}gtIMMgr().NwChtSsnIn(i,l,m,n,k,j,f,d,h)}function RE(a){alrt(a,0,Owa.BUTTON_DIALOG_ICON.ERROR,L_ErrTtl)}function REMB(a){alrt(a,0,Owa.BUTTON_DIALOG_ICON.ERROR,L_ErrTtl);GBL()}function REGE(a,b){if(g_oBddyLst){!b&&a&&g_oBddyLst.shwErr(a,true);if(g_oBddyLst._edting)if(!b)g_oBddyLst.reEdtNd();else g_oBddyLst.qtEdtNd()}else RE(a)}function IMA(b,c,d){if(!isDf(typeof b)||!b||!isDf(typeof c)||!c)return;if(!gtIMMgr())return;var a=gtIMMgr().GtChtSsn(b);if(!a)return;if(isMSNPrv()&&c==imns.ACT_TYPNG){clearTimeout(a.iTypngTimeout);a.iTypngTimeout=setTimeout('IMA("'+b+'", '+imns.ACT_STPTYPNG+', "'+d+'");',imns.CHT_MSN_TYPNG_TMR)}a.InActMsg(c,d)}function CLSC(b){if(!isDf(typeof b)||!b)return;if(!gtIMMgr())return;var a=gtIMMgr().GtChtSsn(b);a&&a.domWin&&a.domWin.close()}function ACC(c,a,d){if(!isDf(typeof c)||!c||!isDf(typeof a)||!a||a=="")return;if(!gtIMMgr())return;var b=gtIMMgr().GtChtSsn(c);if(!b){NIM(c,a,"","","",null,0);b=gtIMMgr().GtChtSsn(c);if(!b)return}if(b.IsRcp(a))return;if(!isDf(typeof d)||!d){d=gtIMMgr().gtDN(a);if(!d)d=imns.IMUtils.NrmSipUri(a)}var f=new Recip(d,imns.IMUtils.NrmSipUri(a),"",0,RT_SMTP,AO_O,0,0,0,a),e=b.AddRcp(f,0,1);if(e){try{gtIMMgr().UpdChtTtl(c,b.CalcTtl())}catch(g){}b.OpenWindow(true)}}function RCC(a,b){if(!isDf(typeof a)||!a||!isDf(typeof b)||!b||b=="")return;if(!gtIMMgr())return;var c=gtIMMgr().GtChtSsn(a);if(!c||gtIMMgr().IsIntCht(a))return;var d=c.RmRcp(b);if(d)try{gtIMMgr().UpdChtTtl(a,c.CalcTtl())}catch(e){}}function PCL(a){if(!a||!a.length)return;if(!gtIMMgr())return;var b=Owa.UIControls.BuddyDialog.getDialog();if(!b)return;b.addBuddies(a)}function CRL(b){if(!gtIMMgr())return;var a=Owa.UIControls.BuddyDialog.getDialog();if(!a)return;a.removeBuddy(b)}function BCL(c,h){if(!c||!c.length)return;if(!gtIMMgr())return;for(var e=[],f=0;f<c.length;f++){var a=c[f],b;if(!a||a=="")continue;a=imns.IMUtils.FrmSipUri(a);var i=gtIMMgr().gtDN(a);if(isDf(typeof h)&&h){gtIMMgr().SetBlkd(a);b=IM_PR_BLKD}else{gtIMMgr().SetUnblkd(a);if(gtIMMgr().IsBdy(a)){b=gtIMMgr().gtPrsnc(a);if(b==IM_PR_BLKD)b=gtDfltPrsnc()}else b=gtDfltPrsnc()}if(g_oBddyLst){var j=gtIMMgr().bdyLst._grpLst;for(var g in j)gtIMMgr().bdyLst.IsGroup(g)&&g_oBddyLst.updateGrpPrsc(g,i,a,b)}var d={};d.sUri=a;d.prsnc=b;d.sDN=i;e.push(d)}e.length>0&&pushPrsnc(e)}function MB(c,b,a){if(!gtIMMgr())return;if(!c||!gtIMMgr().bdyLst.IsGroup(c))return;if(!b||!gtIMMgr().bdyLst.IsGroup(b))return;if(!a||!gtIMMgr().bdyLst.IsBdy(a))return;var e=gtIMMgr().bdyLst.GtBdy(a),d=gtIMMgr().bdyLst.GetGroup(c),f=gtIMMgr().bdyLst.GetGroup(b);if(!d.IsMember(a))return;f.AddBuddyToGroup(e.dn,a,e.prsnc);d.RemoveBuddyFromGroup(a)}function CB(b,a){if(!gtIMMgr())return;if(!b||!gtIMMgr().bdyLst.IsGroup(b))return;if(!a||!gtIMMgr().bdyLst.IsBdy(a))return;var c=gtIMMgr().bdyLst.GtBdy(a),d=gtIMMgr().bdyLst.GetGroup(b);d.AddBuddyToGroup(c.dn,a,c.prsnc)}function GBL(){var a={};sndIMReq(IM_GBL,null,null,a)}function vldtTxt(b,d){var a=b.get_Value().length;if(a>d){a=d;while(a){var c=parseInt(b.get_Value().charCodeAt(a-1));if(c!=10&&c!=13)break;--a}b.set_Value(b.get_Value().substr(0,a))}}var processMailTipsResponse;!g_fModuleLoaded[".\\components/MailTipsResponder.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components.MailTipsResponder");var b="iClientCacheEntryExpiryInHours",c=2,d=6,a=Owa.Components.MailTipsResponder;processMailTipsResponse=a.processServerResponse=function Owa$Components$MailTipsResponder$processServerResponse(e,b){if(!g_CC)return;var c=0;do{b&&tryUpdCC(CC_MTCFG,b,REF);tryUpdCC(CC_MTC,e,REF);if(isDf(typeof g_CC.oMailTipsCache)&&isDf(typeof g_CC.oMailTipsConfig)&&g_CC.oMailTipsCache)a.pushDataToForms(g_CC.oMailTipsCache,g_CC.oMailTipsConfig);else c++}while((!isDf(typeof g_CC.oMailTipsCache)||!isDf(typeof g_CC.oMailTipsConfig))&&c<d)};a.updateClientCache=function Owa$Components$MailTipsResponder$updateClientCache(d,h){var e=new Date,f=new Date(e);if(g_CC&&g_CC.oMailTipsConfig&&g_CC.oMailTipsConfig[b])f.setHours(e.getHours()+g_CC.oMailTipsConfig[b]);else f.setHours(e.getHours()+c);for(var g in d){d[g].oUpdateTime=e;d[g].oExpiry=f}a.mergeCache(d,h)};a.mergeCache=function Owa$Components$MailTipsResponder$mergeCache(d,c){if(d)for(var b in d){if(!c[b])c[b]={};a.copyProperties(d[b],c[b]);delete c[b].fIsPending}};a.copyProperties=function Owa$Components$MailTipsResponder$copyProperties(e,b){for(var c in e){var a=e[c];if(a&&"object"==typeof a){if("oExpiry"==c)b.oExpiry=new Date(Date.parse(a));else if("oUpdateTime"==c)b.oUpdateTime=new Date(Date.parse(a));else if("oRestricted"==c){if(!b.oRestricted)b.oRestricted={};for(var d in a)if(d)b.oRestricted[d.toLowerCase()]=a[d];else b.oRestricted[d]=a[d]}}else b[c]=a}};a.pushDataToForms=function Owa$Components$MailTipsResponder$pushDataToForms(c,b){if(!g_CC)return;for(var d in g_CC.oMailTipsRequesters){var a=g_CC.oMailTipsRequesters[d];try{a&&a.processServerUpdate(c,b)}catch(e){}}}})();g_fModuleLoaded[".\\components/MailTipsResponder.js".toLowerCase()]=1;var MAPI_NOTIFICATION_RESTART_TIMER=15*60*1e3,g_iMapiNotificationResetTimerMultiple=1,g_oMapiNotificationResetTimer=null;function cancelFolderSubscription(b){var a=new oeReq("Notify","DeleteCA",null,null,null,null,0,1);a.add("sId",b);a.send()}function stMapiDrty(a,b){stMapiDrtyInternal(a,b);g_winMgr&&g_winMgr.SetMapiDrty(a,b);restartMapiNotificationsResetTimer()}function searchNotification(c){var b=getViewSubPageControllerByFolderId(a_sLstFID);if(b){var a=getNavigationPage().getLstVw(a_sLstFID);if(a&&a.isFltrd()){a.processSearchNotification();return true}else stMapiDrtyInternal(c,false)}restartMapiNotificationsResetTimer()}function stMapiDrtyInternal(d,l){var i=$("divMainView"),c=false,a,g=false;if(i){i.forEachChild(function(i){a=i.get_Id();if(a){if(a.charAt(0)=="b")a=a.substring(1);var f=GetPrvFid(a,0,a.length),h=GetPrvFid(d,0,d.length);if(FEqPrvId(h,f)==true){c=true;return true}else{var b=getNavigationPage().getLstVw(a);if(b&&isDf(typeof b.sDataFolderId)&&b.sDataFolderId){f=GetPrvFid(b.sDataFolderId,0,b.sDataFolderId.length);if(FEqPrvId(h,f)==true){c=true;return true}}var b=getCalVw(a);if(b&&b.rgCalendar){for(var e=0;e<b.rgCalendar.length;e++)if(b.rgCalendar[e].sPromotedFolderId){f=GetPrvFid(b.rgCalendar[e].sPromotedFolderId,0,b.rgCalendar[e].sPromotedFolderId.length);if(FEqPrvId(h,f)==true){c=true;g=b.rgCalendar[e].isExternal();break}}if(c)return true}}}});c&&stDrty(a,l)}else{var h=Owa.Components.Application.get_RootSubPage(),b=isFolderViewSubPageObject(h)?h.get_VirtualListView():null;if(b&&b.isDumpsterVw()&&isDf(typeof b.sDataFolderId)&&b.sDataFolderId){var j=GetPrvFid(b.sDataFolderId,0,b.sDataFolderId.length),k=GetPrvFid(d,0,d.length);if(FEqPrvId(k,j)==true){b.rfrsh(1);return true}}}if(isDrty(a_sLstFID,1)){var f=getViewSubPageControllerByFolderId(a_sLstFID);if(f){var e=getNavigationPage().getLstVw(a_sLstFID);if(e&&e.isFltrd())e.rfrsh(1);else f.invokeFunction("throttledRefresh",[true,g])}}}function folderChangeNotification(a,c){if(a!=a_sLstFID){stDrty(a);return}var b=getNavigationPage().getLstVw(a_sLstFID);b&&b.processRowNotification(c);restartMapiNotificationsResetTimer()}function updMapiCnt(b,d,e){g_oEd.fire("UpdateCount",b,d,e);var a=getNavigationPage().getLstVw(a_sLstFID);if(a&&a.iT==0&&!a.isFltrd()&&(!a.gtFltr()&&b==a_sLstFID||a.gtFltr()&&a.sDataFolderId&&b==a.sDataFolderId)){var c=getViewSubPageControllerByFolderId(a_sLstFID);c&&c.invokeFunction("updateFolderItemCounts",[null,{iTotalCount:d,iUnreadCount:e}])}restartMapiNotificationsResetTimer()}function stMapiRfrshAll(c,d){var b=$("divMainView");b&&b.forEachChild(function(b){var a=b.get_Id();if(a){if(a.charAt(0)=="b")a=a.substring(1);stDrty(a)}});if(isDrty(a_sLstFID,1)){var a=getViewSubPageControllerByFolderId(a_sLstFID);a&&a.invokeFunction("throttledRefresh",[true,false,null,d])}!c&&restartMapiNotificationsResetTimer()}function GetPrvFid(e,a,c){if(c<=4)return null;var b=e.slice(a,a+4);if(b=="PSF."){a+=4;c-=4}else if(b=="PSI.")return null;else if(b=="CID."||b=="ACI.")return null;else if(b=="OUM."||b=="AMB."){a+=4;c-=4;for(var d=0;d<c;d++)if(e.charAt(a+d)==".")break;c=d}var f=Owa.Encoder.fromBase64String(e.slice(a,c+a));return f}function FEqPrvId(d,e){var a,c=false;if(d==null||e==null)return c;a=d.length;if(a<=1||a!=e.length)return c;a--;for(var b=0;b<a;b++)if(d[b]!=e[b])break;if(b==a)c=true;return c}function resetMapiNotifications(){stMapiRfrshAll(true);restartMapiNotificationsResetTimer(++g_iMapiNotificationResetTimerMultiple)}function restartMapiNotificationsResetTimer(a){if(!a){a=1;g_iMapiNotificationResetTimerMultiple=1}if(g_oMapiNotificationResetTimer){Owa.Dom.Window.get_Current().clearTimeout(g_oMapiNotificationResetTimer);g_oMapiNotificationResetTimer=null}g_oMapiNotificationResetTimer=Owa.Dom.Window.get_Current().setTimeout(resetMapiNotifications,MAPI_NOTIFICATION_RESTART_TIMER*a)}var processIrmLicenseResponse;!g_fModuleLoaded[".\\components/IrmLicensingManager.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Components.IrmLicensingManager");var e=500,f=10,b=1e3,d="divIrmReqSpinner",c="sReqCorrelator",a=Owa.Components.IrmLicensingManager;processIrmLicenseResponses=a.processIrmLicenseResponses=function Owa$Components$IrmLicensingManager$processIrmLicenseResponses(b){if(!b||0==b.length)return;if(!a_sLstFID)return;var c=getViewSubPageControllerByFolderId(a_sLstFID);if(!c)return;var g=Owa.PageHierarchy.getVirtualListViewFromSubPageController(c);if(!g)return;var d=g.get_SubPage();if(d){var h=function(){a.refreshRPIfShowingItems(d,b,f)};Owa.Dom.Window.get_Current().setTimeout(h,e)}};a.refreshRPIfShowingItems=function Owa$Components$IrmLicensingManager$refreshRPIfShowingItems(e,g,h){if(!e.isReadingPaneOn())return;var o=e.get_VirtualListView();if(o.isCnvVw&&o.isCnvVw()){var i=e.gtCnvRP();if(!i||!i.oItemParts){if(h>0){var x=function(){a.refreshRPIfShowingItems(e,g,h-1)};Owa.Dom.Window.get_Current().setTimeout(x,b)}return}for(var k=true,j=0;j<g.length;j++){var f=g[j],u=f.sMessageId,r=i.oItemParts[u];if(!r){k=false;continue}var n=r._get_Element().getDescendantById("divBdy");if(!n){k=false;continue}var l=n.getDescendantById(d);if(!l||l.getAttribute(c)!=f.sReqCorrelator){k=false;continue}if(f.fSuccess){e.refreshConversationRP(true);return}else n.set_InnerHtml(f.sErrorBody)}if(!k&&h>0){var v=function(){a.refreshRPIfShowingItems(e,g,h-1)};Owa.Dom.Window.get_Current().setTimeout(v,b)}}else{for(var t=e.get_ItemIdInReadingPane(),j=0;j<g.length;j++){var f=g[j];if(f.sMessageId!=t)continue;var i=null;try{i=e._getDescendant("ifRP")}catch(y){}if(!i)return;var p=Owa.Components.SubPageControllerFactory.getControllerByElement(i);if(!p)continue;var q=p.get_SubPage();if(!q)continue;var s=q._getDescendant("ifBdy");if(!s)continue;var m=s.get_ContentDocument();if(!m)continue;var l=m.getElementById(d);if(!l||l.getAttribute(c)!=f.sReqCorrelator)continue;if(f.fSuccess){o.rfrsh(0);e.udRP(true);return}else{wrtBdy(m,"<html><body>"+f.sErrorBody+"</body></html>");return}}if(h>0){var w=function(){a.refreshRPIfShowingItems(e,g,h-1)};Owa.Dom.Window.get_Current().setTimeout(w,b)}}}})();g_fModuleLoaded[".\\components/IrmLicensingManager.js".toLowerCase()]=1;Type.createNamespace("Owa.Utility");var g_iReInitRetryCount=0;!g_fModuleLoaded[".\\components/reinitializeowa.js".toLowerCase()]&&(function(){var a=3;Owa.Utility.ReInitializeOWA=function $Owa$Utility$ReInitializeOWA(){if(g_iReInitRetryCount<a){g_iReInitRetryCount++;var b=new Owa.Dom.AjaxRequest("?reInit=1",GET,null,Owa.Utility.cbReInitializeOWA,false);b.send()}};Owa.Utility.cbReInitializeOWA=function $Owa$Utility$cbReInitializeOWA(b){var a=b.oXmlHttp;if(a.status!=200||a.responseText.indexOf('id="errorAspx"')!=-1)return;stMapiRfrshAll(false,true);g_fIsIMEnab&&gtMstr()&&gtMstr().g_fSignedIn&&UN(IM_FAIL_REINITIALIZE_OWA);g_iReInitRetryCount=0}})();g_fModuleLoaded[".\\components/reinitializeowa.js".toLowerCase()]=1}stJS("startpage.js")K      YDeYDe>+Y   D    :https://mail.logica.com/owa/14.3.319.2/scripts/premium/startpage.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAVPMIIFSzCCBDOgAwIBAgIQC9oUlvTJTE7TC0j08zttrDANBgkqhkiG9w0BAQsFADBwMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNzdXJhbmNlIFNlcnZlciBDQTAeFw0xNzA4MTgwMDAwMDBaFw0xODEwMDExMjAwMDBaMF4xCzAJBgNVBAYTAkdCMRAwDgYDVQQHEwdSZWFkaW5nMRcwFQYDVQQKEw5Mb2dpY2EgTGltaXRlZDENMAsGA1UECxMERUlJUzEVMBMGA1UEAwwMKi5sb2dpY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzuYMsuU3piAX99KZg+15ZU9OKmiMfNCWme5/Iz8Agp2MxYMF4mLUcfss1x5fB0mMY+KvwAyfSyor56jR7dy3NKMreZRH1Q/YeFQW5MMs7paDof2KI5PtBspIXbQag6WYYtW10v/lkd+as+VD6jyhfU6+osD9HrbIK5dxToF6mfJqk/ky8nwphaA2FHoRKTdAMiQh9RS5IYKDzeaoPxLy+M+qvME3urniOQqd9Od7sqG4ml+wqS7+xB7UAl+ochD4A/rwewdhccwt91RNkn1E4j1RaZ6FYcuszvBcYih+m1wcQn/ACTrAAWV+ziST2h7LfUmEtMPVQ4swHYI8diuPfQIDAQABo4IB8TCCAe0wHwYDVR0jBBgwFoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKinxbIi/V/Ey/fqtiPTDEcBOGc5MCMGA1UdEQQcMBqCDCoubG9naWNhLmNvbYIKbG9naWNhLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwTAYDVR0gBEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwgYMGCCsGAQUFBwEBBHcwdTAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEySGlnaEFzc3VyYW5jZVNlcnZlckNBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQBQjp60tISk4788ERXDdQQKXRiEr75a1DYfG2ouVr/8OYlwgS5AwIEapDT7vqli2n3LbeeVgzUz2cZm9Bc/WjyYmSRlZtFYoSn6muFvYOjr0v5aiJXyFdz03emn93quN95xu4MnDmqoBsxEvyOHgO7TXhnpmO/aF9jA01L7SLfZI5TvVaOGQ2vAU6h5cOdXp18nuJGk+o1274scCkBK60dJwRaUtz7zMp2vr3FpOfvLqpkzBkUC8Iv0sXVfPgZFINyMTDW14QAbzWSsbr3EQEJ7ioAqjEBsScJjGFk5V+GDpyz3z9nLjoM/fWKl7sS5Z9VaztyzpEvomyQsd6sZPdubAC8AAwAAAAABAQAA request-method GET response-head HTTP/1.1 200 OK
Content-Length: 177379
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "059939a59d21:0"
Accept-Ranges: bytes
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:42 GMT
X-Powered-By: ASP.NET
 original-response-headers Connection: Keep-Alive
Content-Length: 177379
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "059939a59d21:0"
Accept-Ranges: bytes
Set-Cookie: CAS_LB_Service=R3418549887; path=/
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:42 GMT
X-Powered-By: ASP.NET
 uncompressed-len 0  