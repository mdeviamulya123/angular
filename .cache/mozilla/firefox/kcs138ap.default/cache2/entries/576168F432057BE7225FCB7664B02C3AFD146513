var g_fModuleLoaded={};Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/pipes.js".toLowerCase()]&&(function(){var a=function PipeNode(a,d,c,b){this._oItemPart=d;this._stopElement=c;this._childConnectorElement=b;this._stopElement.set_IsShown(false);a.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._stopElement);if(this._childConnectorElement){this._childConnectorElement.set_IsShown(false);a.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._childConnectorElement)}};a.prototype.get_StopElement=function PipeNode$prototype$get_StopElement(){return this._stopElement};a.prototype.get_ChildConnectorElement=function PipeNode$prototype$get_ChildConnectorElement(){return this._childConnectorElement};a.prototype.get_ItemPart=function PipeNode$prototype$get_ItemPart(){return this._oItemPart};a.prototype.dispose=function PipeNode$prototype$dispose(){this._stopElement&&this._stopElement.remove(true);this._childConnectorElement&&this._childConnectorElement.remove(true)};Owa.Components.Pipes=function Owa$Components$Pipes(a){this._oParentElement=a;this._rgPipeStops=[];this._initPipeComponents()};Owa.Components.Pipes.prototype.dispose=function Owa$Components$Pipes$prototype$dispose(){this.clearPipes();this.oPipeEnd.remove(true);this.oPpA.remove(true);this.oPsA.remove(true);this.oBkg.remove(true);this.oPipeEnd=null;this.oPpA=null;this.oPsA=null;this.oBkg=null};Owa.Components.Pipes.prototype.drawPipes=function Owa$Components$Pipes$prototype$drawPipes(b){this.clearPipes();this._rgPipeStops.add(new a(this._oParentElement,b,this.oPipeEnd.clone(true),null));b=b.get_ParentItemPart();while(b!=null){this._rgPipeStops.add(new a(this._oParentElement,b,this.oPsA.clone(true),this.oPpA.clone(true)));b=b.get_ParentItemPart()}this._oBkg=this.oBkg.clone(true);this._oParentElement.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._oBkg);this.updatePipes()};Owa.Components.Pipes.prototype.updatePipes=function Owa$Components$Pipes$prototype$updatePipes(){if(this._rgPipeStops.get_Length()<2)return;for(var d=this._rgPipeStops[0].get_StopElement(),k=(d.get_Height()-1)/2,c=(this._rgPipeStops[1].get_StopElement().get_Height()-1)/2,b=[],a=0;a<this._rgPipeStops.get_Length();++a)b.add(this._rgPipeStops[a].get_ItemPart().get_PipeConnectorTop());if(b[0]==b[1])return;var e=b[0]-c,j=e;d.set_Top(b[0]-k);d.set_IsShown(true);for(var a=1;a<this._rgPipeStops.get_Length();++a){d=this._rgPipeStops[a].get_StopElement();var g=this._rgPipeStops[a].get_ChildConnectorElement(),f=b[a]-c;d.set_Top(f);d.set_IsShown(true);g.set_IsShown(true);if(f<e)e=f;if(f>j)j=f;var i=a==1?k:c,h=0;if(b[a]<b[a-1]){g.set_Top(b[a]+c);h=b[a-1]-b[a]-(i+c)}else{g.set_Top(b[a-1]+i);h=b[a]-b[a-1]-(i+c)}g.set_Height(h>0?h:0)}this._oBkg.set_Top(e);this._oBkg.set_Height(j-e)};Owa.Components.Pipes.prototype.clearPipes=function Owa$Components$Pipes$prototype$clearPipes(){for(var a=0;a<this._rgPipeStops.get_Length();++a)this._rgPipeStops[a].dispose();this._rgPipeStops=[];this._oBkg&&this._oBkg.remove(true)};Owa.Components.Pipes.prototype._initPipeComponents=function Owa$Components$Pipes$prototype$_initPipeComponents(){var b=Owa.Strings.CssClass.LeftPipe,c=Owa.Strings.CssClass.LeftStopSmall,d=Owa.Strings.CssClass.LeftChildStopSmall;if(g_fRtl){b=Owa.Strings.CssClass.RightPipe;c=Owa.Strings.CssClass.RightStopSmall;d=Owa.Strings.CssClass.RightChildStopSmall}var e=Owa.Components.CssSprites.getImageElement("pipe-stop-s.png"),a=Owa.Dom.Document.get_Current().createElement("IMG");a._get_DomNode().src=getRsrcF("clear1x1.gif");this.oBkg=a.clone();this.oBkg.addCssClass(Owa.Strings.CssClass.PipeBackground);this.oPipeEnd=Owa.Components.CssSprites.getImageElement("pipe-end.png");this.oPipeEnd.addCssClass("pipeEnd");this.oPsA=e.clone();this.oPsA.addCssClass(Owa.Strings.CssClass.AncestorStopSmall);this.oPsA.addCssClass(c);this.oPpA=a.clone();this.oPpA.addCssClass(Owa.Strings.CssClass.AncestorPipe);this.oPpA.addCssClass(b)}})();g_fModuleLoaded[".\\components/pipes.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/MediaPlayer.js".toLowerCase()]&&(function(){var b=null,c=false;Owa.UIControls.MediaPlayer=function Owa$UIControls$MediaPlayer(){Owa.UIControls.MediaPlayer.constructBase(this);try{var a=Owa.Dom.Document.get_Current().createElement("OBJECT"),b=a._get_DomNode();a.set_Id("oMediaPlayer");a.set_IsShown(false);b.classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6";Owa.Dom.Document.get_Current().appendChild(a);if(b.controls){b.attachEvent("error",this._createCallback(this._onMediaPlayerError));b.attachEvent("playstatechange",this._createCallback(this._checkMediaPlayerState));this._initializeDomElement(a)}else{a.remove(true);c=true}this._oController=null}catch(d){c=true}};var a=Owa.UIControls.MediaPlayer.prototype;Owa.UIControls.MediaPlayer.get_Instance=function Owa$UIControls$MediaPlayer$get_Instance(){if(!b&&!c){b=new Owa.UIControls.MediaPlayer;Owa.Components.Application.get_RootSubPage().addResource(b)}if(c){b=null;return null}return b};a.get_Controller=function Owa$UIControls$MediaPlayer$get_Controller(){return this._oController};a.set_Controller=function Owa$UIControls$MediaPlayer$set_Controller(a){if(this._oController==a)return;this.isPlaying()&&this.stop();var b={};b.oOldController=this._oController;b.oNewController=a;this.reset();this._oController=a};a.reset=function Owa$UIControls$MediaPlayer$reset(){this.isPlaying()&&this.stop();this._oController=null;this.get_OnError().clear();this.get_OnStop().clear();this.get_OnComplete().clear()};a._get_MediaPlayer=function Owa$UIControls$MediaPlayer$_get_MediaPlayer(){return this._get_Element()._get_DomNode()};a._onMediaPlayerError=function Owa$UIControls$MediaPlayer$_onMediaPlayerError(){var a=this._get_MediaPlayer(),b=a.Error.errorCount;b>0&&this._dispatchEvent(f)};a._checkMediaPlayerState=function Owa$UIControls$MediaPlayer$_checkMediaPlayerState(){var b=this._get_MediaPlayer(),a=null;try{a=b.playState}catch(c){}switch(a){case 1:this._dispatchEvent(d);break;case 8:this._dispatchEvent(e)}};a.isPlaying=function Owa$UIControls$MediaPlayer$isPlaying(){var a=this._get_MediaPlayer();return a.playState==3||a.playState==6};a.play=function Owa$UIControls$MediaPlayer$play(b){var a=this._get_MediaPlayer();a.URL=b};a.stop=function Owa$UIControls$MediaPlayer$stop(){try{this._get_MediaPlayer().controls.stop();this._dispatchEvent(d)}catch(a){}};var e="OnComplete",d="OnStop",f="OnError";a.get_OnComplete=function Owa$UIControls$MediaPlayer$get_OnComplete(){return this._getEventHandlerCollection(e)};a.get_OnStop=function Owa$UIControls$MediaPlayer$get_OnStop(){return this._getEventHandlerCollection(d)};a.get_OnError=function Owa$UIControls$MediaPlayer$get_OnError(){return this._getEventHandlerCollection(f)};Owa.UIControls.MediaPlayer.createClass("Owa.UIControls.MediaPlayer",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/MediaPlayer.js".toLowerCase()]=1;(function(){var B=Owa.UIControls,c=Owa.Utility,h=Owa.Dom.Document,lb=Owa.Dom.Node,g="vr",j="sr",b="ver",Kb="divVLVIL",Jb="divList",a="divViewport",s="divScrollbar",yb="divScrollRegion",p="divHeaders",vb="divCat",U="divCatGroup",Db="divFlg",R="divPrgBg",S="divPrgrs",i="divChnk",zb="vlvChnk",T="divFltrBg",Eb="divNI",t="fNoRws",r="data",o="iTC",n="iUC",D="iTIC",V="sDataFId",F="fCV",C="fFUR",sb="sLstMdfyTm",J="sel",w="vlvExpSel",q="vlvFamSel",kb="vlvHvr",fb="rwHvr",l=50,Ab=99,Gb=100,Cb=4,ab=40,Y=15,W=14,Z=13,X=17,wb=20,tb=1.3e6,u=1100,Hb=1e3,Lb=200,xb=1e3,A=1,z=2,hb=3,ib=4,m=0,v=1,H=2,I=3,jb=2,Qb=37,Sb=38,Pb=39,Ib=40,cb=64,P=512,Fb=10,db="ldFrsh",E="ldAdj",nb="srt",gb="tdSrch",mb="ldSk",pb="pP",ob="nP",ub="rowNotification",eb="3",Bb="4",bb="5",k={};k[pb]=k[ob]=k[E]=k[ub]=0;k[db]=1;k[gb]=k[mb]=2;k[nb]=3;var d={ConversationLastDeliveryTime:82,ConversationMVFrom:87,ConversationMVTo:94,ConversationTopic:84,ConversationHasAttach:86,ConversationImportance:88,ConversationSize:90,ConversationFlagStaus:91,ConversationMessageClasses:83},f={Date:7,SentDate:8,From:1,To:2,Subject:3,HasAttachment:5,Importance:6,Size:9,FlagDueDate:67,FlagStartDate:68,Type:0},O="CID",K="ACI",G="imgChk",M="?ae=Item&a=Preview&t=";RowPosition=function _RowPosition(b,a){if(!b)b=0;if(!a)a=0;this.iRow=b;this.iSubRow=a};RowPosition.prototype.equals=function RowPosition$prototype$equals(a){return a!=null?a.iRow==this.iRow&&a.iSubRow==this.iSubRow:false};RowInfo=function _RowInfo(a,e,c,d,b,h,f,g){this.oRow=a;this.oRowPosition=e;this.iViewPortOffset=c;this.iChunkOffset=d;this.sSectionHeaderText=b;this.sId=a.get_Id();this.sRowId=h;this.sInstanceKey=f;this.iCacheIndex=g};Owa.UIControls.VLV=function Owa$UIControls$VLV(d,a){Owa.UIControls.VLV.constructBase(this,[a]);this.set_SubPage(d);this.iT=a.getIntAttribute("iT");this.sEvtNS=a.getAttribute("sEvtNS");this.sSid=a.getAttribute("sSid");this.sDataFolderId=null;this.fML=a.getIntAttribute("fML");this.iSC=a.getIntAttribute("iSC");this.iSO=a.getIntAttribute("iSO");this.iWP=getInt(a.getAttribute("iWP"));this.iTC=a.getIntAttribute(o);this.iTIC=a.getIntAttribute(D);this.fROLv=!!getInt(a.getAttribute("fROLv"));this.iNsDir=a.getIntAttribute("iNsDir");this.oCurRowPosition=new RowPosition(0,0);this.iScrollTimer=0;this.oScrollRowPosition=null;this.fPndLd=0;this.rgPndLd=[];this.iH=a.get_ClientHeight();this.oSel={};this.sSelA=0;this.sNextSelA=0;this.sLstSel=0;this.iPrgT=0;this.fIgnScr=0;this.fTD=getInt(a.getAttribute("fTD"));this.sTD="";this.iTDTmr=0;this.iScrTp=this._getDescendant(s).get_ScrollTop();this._iTypicalRowHeight=-1;this._iGHHeight=0;this._rgRowInfos=null;this._oIdToRow=null;this._oInstanceKeyToRow=null;this._rgHeaderRows=null;this._oPreviewUpdateTimer=null;this._iStoredViewportPosition=-1;this._rgRowNotification=[];this._oRowNotificationQueueTimer=null;this._fnOnShow=null;this._fnOnAsyncOperationsComplete=null;this.fSrchInProg=0;this._oSearchRefreshTimer=null;this._fRestartSearchRefreshTimer=false;this._iLastLoadActionTime=0;this._fPendingOperations=false;this._fScrolledFromTouch=false;this._iTouchStartLocation=0;this._iScrollTopTmp=-1;this._fFromTouchEvent=false;var b=getInt(a.getAttribute("iFltr"));this.iFltr=b?b:0;var c=a.getAttribute("sPbPrps");if(c.length)this.rgPbPrps=c.split(";");this.fSrch=0;this._oMessagePrefetchTimer=null;this._fPerformedFirstTimeMessagePrefetch=false;this._rgsMessagePrefetchList=[];this._rgsMessagePrefetchHash={};this._iMessagePrefetchBatchSize=0;this._iMessagePrefetchCompleteCount=0;this._fRestartPrefetchOnshow=false};Owa.UIControls.VLV.createClass("Owa.UIControls.VLV",Owa.UIControls.UIControl);var Rb=B.VLV.prototype;Owa.UIControls.VLV.prototype.initialize=function Owa$UIControls$VLV$initialize(){Owa.UIControls.VLV.callBase(this,"initialize");var c=this._getDescendant(a),g=this._getDescendant(s),e=this._get_Element(),d=this._getDescendant(p);this.initChnk(c.get_FirstChild());this._fixScrollbarWidth();this.updScr();var b=this;this._attachEvent(g,"scroll",function(a){b.onScr(a)});this._attachEvent(e,"mousewheel",function(a){b.onMWhl(a)});this._attachEvent(c,"contextmenu",function(a){b.onCMVP(a)});this._attachEvent(d,"contextmenu",function(a){b.onCMHdr(a)});this._attachEvent(c,"click",function(a){b.onClkVP(a)});this._attachEvent(d,"click",function(a){b.onClkHdr(a)});this._attachEvent(c,"dblclick",function(a){b.onDblClkVP(a)});this._attachEvent(c,"mousedown",function(a){b.onMD(a)});this._attachEvent(c,"mouseup",function(a){b.onMU(a)});this._attachEvent(c,"mousemove",function(a){b.onMouseMove(a)});this._attachEvent(c,"mouseout",function(a){b.onMouseOver(a)});this._attachEvent(c,"mouseover",function(a){b.onMouseOver(a)});this._attachEvent(c,"dragstart",function(a){b.onDS(a)});this._attachEvent(c,"drag",function(a){b.onDrag(a)});this._attachEvent(e,"resize",function(a){b.onRsz(a)});Owa.Components.Storage.DragDrop.enableDNDInFireFox(c);var i=h.get_Current();this._attachEvent(i,"keypress",function(a){b.onKP(a)});if(window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0){this._attachEvent(c,"MSPointerDown",function(a){b.onTouchDown(a)});this._attachEvent(c,"MSPointerMove",function(a){b.onTouchMove(a)});this._attachEvent(c,"MSPointerUp",function(a){b.onTouchUp(a)})}this.get_SubPage().get_KeyDownPage().add(this._createCallback(this.onKD));var f=this.gtRws();if(f.get_Length()>0){if(this.isReadingPaneOn())addPerfMarker("ReadingPane.Exists");else addPerfMarker("ReadingPane.NotExists");this.selSngl(f.get_Item(0))}else addPerfMarker("ReadingPane.NotExists");this._iPreloadTimer=this._setTimeout(this.prld,xb);g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbAsyncOperationsStarted");g_oEd.attachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbAsyncOperationsComplete");g_oEd.attachEvent("EmptyFolderStarted",this,"cbEmptyFolder")};Owa.UIControls.VLV.prototype.dispose=function Owa$UIControls$VLV$dispose(){this.onErr=null;this.onNav=null;this.onBRfrsh=null;this.onSelChg=null;this.onRmvRws=null;this.isReadingPaneOn=null;this.stGtSF=null;this.onFetchRP=null;g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsStartedEventName,this,"cbAsyncOperationsStarted");g_oEd.detachEvent(Owa.PendingOperationsManager.OperationsCompleteEventName,this,"cbAsyncOperationsComplete");g_oEd.detachEvent("EmptyFolderStarted",this,"cbEmptyFolder");this._getDescendant(p).dispose();this._getDescendant(a).dispose();this._getDescendant(s).dispose();this._oCMDiv=null;this._oABMDiv=null;Owa.UIControls.VLV.callBase(this,"dispose")};Owa.UIControls.VLV.prototype.stOnErr=function Owa$UIControls$VLV$stOnErr(a){this.onErr=a};Owa.UIControls.VLV.prototype.stOnNav=function Owa$UIControls$VLV$stOnNav(a){this.onNav=a};Owa.UIControls.VLV.prototype.stOnBRfrsh=function Owa$UIControls$VLV$stOnBRfrsh(a){this.onBRfrsh=a};Owa.UIControls.VLV.prototype.stOnERfrsh=function Owa$UIControls$VLV$stOnERfrsh(a){this.onERfrsh=a};Owa.UIControls.VLV.prototype.stOnSelChg=function Owa$UIControls$VLV$stOnSelChg(a){this.onSelChg=a};Owa.UIControls.VLV.prototype.stOnRowNotification=function Owa$UIControls$VLV$stOnRowNotification(a){this.onRowNotification=a};Owa.UIControls.VLV.prototype.stOnRmvRws=function Owa$UIControls$VLV$stOnRmvRws(a){this.onRmvRws=a};Owa.UIControls.VLV.prototype.stReadingPaneOn=function Owa$UIControls$VLV$stReadingPaneOn(a){this.isReadingPaneOn=a};Owa.UIControls.VLV.prototype.stOnFetchRP=function Owa$UIControls$VLV$stOnFetchRP(a){this.onFetchRP=a};Owa.UIControls.VLV.prototype.isCnvVw=function Owa$UIControls$MsgVLV$isCnvVw(){return false};Owa.UIControls.VLV.prototype._get_IsShown=function Owa$UIControls$VLV$_get_IsShown(){return this.get_SubPage().get_IsShown()};Owa.UIControls.VLV.prototype.onShowHide=function Owa$UIControls$VLV$onShowHide(a){if(a){if(this._fnOnShow){this._fnOnShow();this._fnOnShow=null}if(this.fPndUpd){this.clearRowCache();this.updVwprt()}if(this._fRestartPrefetchOnshow){this._fRestartPrefetchOnshow=false;this._restartPrefetch(true)}}};Owa.UIControls.VLV.prototype.stCM=function Owa$UIControls$VLV$stCM(c,b,a){this._oCMDiv=Owa.Dom.Node.wrapDomNode(c);this._fnCMOnSelect=b;this._fnCMOnPreShow=a};Owa.UIControls.VLV.prototype.get_ContextMenu=function Owa$UIControls$VLV$get_ContextMenu(){if(!this._oCM&&this._oCMDiv)this._oCM=this.addResource(Owa.UIControls.ContextMenu.create(this._oCMDiv,null,this.get_SubPage()));return this._oCM};Owa.UIControls.VLV.prototype.stABM=function Owa$UIControls$VLV$stABM(a){this._oABMDiv=lb.wrapDomNode(a)};Owa.UIControls.VLV.prototype._get_ABM=function Owa$UIControls$VLV$_get_ABM(){if(!this._oABM&&this._oABMDiv){var a=this,b=function(b){a.onClkABM(b)};this._oABM=this.addResource(Owa.UIControls.ContextMenu.create(this._oABMDiv,null,this.get_SubPage()));this._oABM.get_OnSelect().add(b)}return this._oABM};Owa.UIControls.VLV.prototype.stGtSF=function Owa$UIControls$VLV$stGtSF(a){this.fnGtSF=a};Owa.UIControls.VLV.prototype.get_SearchControl=function Owa$UIControls$VLV$get_SearchControl(){return this.get_SubPage().get_SearchControl()};Owa.UIControls.VLV.prototype.get_FolderId=function Owa$UIControls$VLV$get_FolderId(){return this.get_SubPage().get_FolderId()};Owa.UIControls.VLV.prototype.get_ItemIdInReadingPane=function Owa$UIControls$VLV$get_ItemIdInReadingPane(){return this.get_SubPage().get_ItemIdInReadingPane()};Owa.UIControls.VLV.prototype.get_IsSearch=function Owa$UIControls$VLV$get_IsSearch(){return this.get_SubPage().getSubPageVariable("a_fSrch")};Owa.UIControls.VLV.prototype.find=function Owa$UIControls$VLV$find(){ClientAction.add(ClientAction.Name.Search);this.fSrch=1;this._fRestartSearchRefreshTimer=true;this.clrSel(1);var a=this,b=function(){var b=a.gtRws();b.get_Length()>0&&a.selSngl(b.get_Item(0))};this.ldFrsh(0,v,1,b)};Owa.UIControls.VLV.prototype.clrFind=function Owa$UIControls$VLV$clrFind(c,a){ClientAction.add(ClientAction.Name.ClearSearch);this.fSrch=0;this._clearSearchRefreshTimer();if(!c)if(!a&&this.gtSelCnt()>0)this.ldSk(this.gtSel()[0],true,this.cbClrFind,null,true);else{this.clrSel(1);var b=this,d=function(){b.cbFLP(0)};this.ldFrsh(0,m,1,d,0,0,0,null,false,true)}};Owa.UIControls.VLV.prototype.cbClrFind=function Owa$UIControls$VLV$cbClrFind(a){if(!a.gtRwById(a.gtSel()[0])){var b=a.gtRws();if(b.length>0)a.selSngl(b[0]);else a.clrSel(1)}};Owa.UIControls.VLV.prototype.processSearchNotification=function Owa$UIControls$VLV$processSearchNotification(){if(!this.isFltrd())return;this._clearSearchRefreshTimer();this.rfrsh(1)};Owa.UIControls.VLV.prototype._clearSearchRefreshTimer=function Owa$UIControls$VLV$_clearSearchRefreshTimer(){this._fRestartSearchRefreshTimer=false;if(this._oSearchRefreshTimer){this._clearTimeout(this._oSearchRefreshTimer);this._oSearchRefreshTimer=null}};Owa.UIControls.VLV.prototype._reStartSearchRefreshTimer=function Owa$UIControls$VLV$_reStartSearchRefreshTimer(){this._clearSearchRefreshTimer();this._oSearchRefreshTimer=this.stTmout("processSearchNotification",4e3)};Owa.UIControls.VLV.prototype.getViewportPosition=function Owa$UIControls$VLV$getViewportPosition(){var c=this.fIgnScr;this.fIgnScr=1;var d=this._getDescendant(a),b=d.get_ScrollTop();if(!c)this.fIgnScr=0;return b};Owa.UIControls.VLV.prototype._storeViewportPosition=function Owa$UIControls$VLV$_storeViewportPosition(){if(this._iStoredViewportPosition<0)this._iStoredViewportPosition=this.getViewportPosition();else throw new Error("Trying to store viewport position before it has been reset");};Owa.UIControls.VLV.prototype._resetViewportPosition=function Owa$UIControls$VLV$_resetViewportPosition(b){if(!isDf(typeof b))b=0;var c=this.fIgnScr;this.fIgnScr=1;var d=this._getDescendant(a);d.set_ScrollTop(this._iStoredViewportPosition+b);this._iStoredViewportPosition=-1;if(!c)this.fIgnScr=0};Owa.UIControls.VLV.prototype._isPushNotificationSupported=function Owa$UIControls$VLV$_isPushNotificationSupported(){return false};Owa.UIControls.VLV.prototype.gtRwPrp=function Owa$UIControls$VLV$gtRwPrp(c,e,b){var d=this.gtRwById(c);if(d){var a=this.gtPrpV(d,e);return a!==null?a:b}else{var a=this.oSel[c];return a?a[e]:b}};Owa.UIControls.VLV.prototype.stRwPrp=function Owa$UIControls$VLV$stRwPrp(a,d,c){if(this.oSel[a])this.oSel[a][d]=c;var b=this.gtRwById(a);b&&this.getData(b).setAttribute(d,String(c))};Owa.UIControls.VLV.prototype.stML=function Owa$UIControls$VLV$stML(a){if(this.fML==a)return;this.fML=a;this.ldFrsh(this.oCurRowPosition.iRow,m,0,0,0,"SetML")};Owa.UIControls.VLV.prototype.isFltrd=function Owa$UIControls$VLV$isFltrd(){return this.fSrch};Owa.UIControls.VLV.prototype.gtTC=function Owa$UIControls$VLV$gtTC(){return this.iTC};Owa.UIControls.VLV.prototype.gtTIC=function Owa$UIControls$VLV$gtTIC(){return this.iTIC};Owa.UIControls.VLV.prototype.isEmpty=function Owa$UIControls$VLV$gtTC(){return this.iTC==0};Owa.UIControls.VLV.prototype.isTskVw=function Owa$UIControls$VLV$isTskVw(){return this.iT==LVT_TSK};Owa.UIControls.VLV.prototype.isDumpsterVw=function Owa$UIControls$VLV$isDumpsterVw(){return this.iT==LVT_DMP};Owa.UIControls.VLV.prototype.isML=function Owa$UIControls$VLV$isML(){return this.fML};Owa.UIControls.VLV.prototype.isFldr=function Owa$UIControls$VLV$isFldr(){return 0};Owa.UIControls.VLV.prototype.gtFltr=function Owa$UIControls$VLV$gtFltr(){return this.iFltr};Owa.UIControls.VLV.prototype.stFltr=function Owa$UIControls$VLV$stFltr(a){this.iFltr=a};Owa.UIControls.VLV.prototype.get_ContextFolderId=function Owa$UIControls$VLV$get_ContextFolderId(){return this.sSid};Owa.UIControls.VLV.prototype.get_DataFolderId=function Owa$UIControls$VLV$get_DataFolderId(){return this.sDataFolderId?this.sDataFolderId:this.sSid};Owa.UIControls.VLV.prototype.isAsyncSrchEnabled=function Owa$UIControls$VLV$isAsyncSrchEnabled(){var b=0,a=Owa.Utility.getRootOwaWindow(),c=Owa.Dom.Window.get_Current().get_TopWindow();if(this.isFldr()&&c.equals(a)&&a.getGlobalVariable("a_fStPg")&&a.getGlobalVariable("a_fPushNotif"))b=1;return b};Owa.UIControls.VLV.prototype.isPushNotificationEnabled=function Owa$UIControls$VLV$isPushNotificationEnabled(){var b=0,a=Owa.Utility.getRootOwaWindow(),c=Owa.Dom.Window.get_Current().get_TopWindow();if(this._isPushNotificationSupported()&&c.equals(a)&&a.getGlobalVariable("a_fStPg")&&a.getGlobalVariable("a_fPushNotif"))b=1;return b};Owa.UIControls.VLV.prototype.gtSel=function Owa$UIControls$VLV$gtSel(){var b=[];for(var a in this.oSel)this.oSel[a].fSel&&b.push(a);return b};Owa.UIControls.VLV.prototype.gtSelCnt=function Owa$UIControls$VLV$gtSelCnt(){var a=0;for(var b in this.oSel)if(this.oSel[b].fSel)a++;return a};Owa.UIControls.VLV.prototype.isSelectedRow=function Owa$UIControls$VLV$isSelectedRow(a){return isDf(typeof this.oSel[a])&&this.oSel[a]!=null};Owa.UIControls.VLV.prototype.rfrsh=function Owa$UIControls$VLV$rfrsh(a,d,c,b){this.ldFrsh(this.oCurRowPosition.iRow,a?I:m,0,0,0,0,a,d,c,b)};Owa.UIControls.VLV.prototype.rmvRws=function Owa$UIControls$VLV$rmvRws(b,h,c){this.feRmvRws();var a=Array();if(this.isCnvVw&&this.isCnvVw()&&(this.iSC==d.ConversationMVFrom||this.iSC==d.ConversationMVTo||this.iSC==d.ConversationMessageClasses))for(var j=0;j<b.get_Length();j++){var f=b[j].split(".");if(f&&(f[0]==O||f[0]==K))for(var i=0;i<this._rgRowInfos.get_Length();i++){var e=this._rgRowInfos[i].sRowId.split(".");if(e&&(e[0]==O||e[0]==K))f[1]==e[1]&&a.add(this._rgRowInfos[i].sRowId)}else a.add(b[j])}else a=b;var g;if(c!=-1){if(!h)c=this.iNsDir;g=this.gtSelAftrRmv(c,a,b)}for(var l=this.oSel[a.get_Item(0)],k=0;k<a.get_Length();++k)this.rmvRw(a.get_Item(k),true);if(!this.gtSelCnt()&&g){this.selSngl(g);this.scrToVwprt(g)}else l&&this.feSelChg(a.get_Item(0));if(h)c!=jb&&this.feNav(h);if(!this.isFltrd()){this.updScr();this.updVwprt()}return h&&c==jb};Owa.UIControls.VLV.prototype.updCnts=function Owa$UIControls$VLV$updCnts(){};Owa.UIControls.VLV.prototype.crtDC=function Owa$UIControls$VLV$crtDC(){var a=this.gtSel();return this.crtItmsDC(a)};Owa.UIControls.VLV.prototype.crtItmsDC=function Owa$UIControls$VLV$crtItmsDC(a){if(a.length<1)return;var f=Owa.Components.Storage.StorableObject.create(this.isCnvVw&&this.isCnvVw()&&!this.isSelExp()?Owa.Components.DraggableObjects.Type.Conversations:Owa.Components.DraggableObjects.Type.Items),c=f.get_RootElement(),e=false;c.set_FolderId(this.get_DataFolderId());for(var b=0;b<a.length;b++){var d=c.createOne_Item();d.set_ItemId(a[b]);chkMime()&&d.set_UrlEncItemId(urlEnc(a[b]));d.set_ItemType(this.gtRwPrp(a[b],"t"));c.append_Item(d);e=e||this.isXF&&this.isXF(this.gtRwById(a[b]))}e&&c.set_IsCrossFolder(true);return f};Owa.UIControls.VLV.prototype.selRwById=function Owa$UIControls$VLV$selRwById(b){var a=this.gtRwById(b);a&&this.selSngl(a)};Owa.UIControls.VLV.prototype.selNPRw=function Owa$UIControls$VLV$selNPRw(c,a,b,f){var d=this.gtNPRw(c,b);if(!d){if(this.selectAtDataSetLimit(b))return;if(f)a&&this.feNav(a,1);else{var e=this,g=function(){e.selNPRw(c,a,b,1)};this.ldSk(c,b,g)}return}this.selSngl(d,false,true);this.scrToVwprt(d);a&&this.feNav(a)};Owa.UIControls.VLV.prototype.gtNPRw=function Owa$UIControls$VLV$gtNPRw(c,b){var a=this.getAdjacentRowInfo(c,b);return a?a.oRow:null};Owa.UIControls.VLV.prototype.getAdjacentInstanceKey=function Owa$UIControls$VLV$getAdjacentInstanceKey(c,b){var a=this.getAdjacentRowInfo(c,b);return a?a.sInstanceKey:""};Owa.UIControls.VLV.prototype.getAdjacentRowInfo=function Owa$UIControls$VLV$getAdjacentRowInfo(g,f){var b=this._getOIdToRow()[g];if(b==null)return;var c=f?1:-1,a=b.iCacheIndex+c,e=this.getRowInfos();while(a>=0&&a<e.length){var d=e[a];if(d.sId!=j)return d;a+=c}};Owa.UIControls.VLV.prototype.selectAtDataSetLimit=function Owa$UIControls$VLV$selectAtDataSetLimit(c,e){var b=this._getOIdToRow()[this.sLstSel];if(b){var a=b.oRowPosition;if(!this.iTC||!c&&a.iRow==0||c&&a.iRow==this.iTC-1){if(!e){var d=this.gtRw(a.iRow,a.iSubRow);d&&this.selSngl(d,false,true)}return true}}return false};Owa.UIControls.VLV.prototype.seekRw=function Owa$UIControls$VLV$seekRw(a,c){var b=this.gtRwById(a);if(b)this.scrToVwprt(b);else if(!c){var d=function(b){b.seekRw(a,1)};this.ldSk(a,1,d)}};Owa.UIControls.VLV.prototype.fP=function Owa$UIControls$VLV$fP(a){ClientAction.add(ClientAction.Name.ScrollFirstPage);var b=this,c=function(){b.cbFLP(0,a)};this.ldFrsh(0,0,1,c)};Owa.UIControls.VLV.prototype.lP=function Owa$UIControls$VLV$lP(a){ClientAction.add(ClientAction.Name.ScrollLastPage);var b=this,c=function(){b.cbFLP(1,a)};this.ldFrsh(this.iTC-1,0,1,c)};Owa.UIControls.VLV.prototype.cbFLP=function Owa$UIControls$VLV$cbFLP(b,d){var a=this.gtRws();if(a.get_Length()){var c=b?a.get_Item(a.get_Length()-1):a.get_Item(0);if(d)this.selRng(c);else this.selSngl(c)}if(b&&this.iTC-1==this.ER()){this.posVwprt(new RowPosition(this.iTC-1,0));this.updScr()}};Owa.UIControls.VLV.prototype.pP=function Owa$UIControls$VLV$pP(h,g){if(!this.iTC)return;ClientAction.add(ClientAction.Name.ScrollPageUp);var i=this._getDescendant(a),c=this.getViewportPosition(),d=this.gtVPH(),b=new RowPosition;if(c==0)b=new RowPosition(0,0);else if(c>d){var f=c-d+this.gtRw(this.oCurRowPosition.iRow,this.oCurRowPosition.iSubRow).get_OffsetHeight();b=this.getFirstRowAfterHeight(f)}else if(this.SR()!=0){this.prld();this.fPndLd&&this.enqOp(pb,arguments);return}this.posVwprt(b);this.updScr();if(!g){var e=this.gtRw(b.iRow);if(h)this.selRng(e);else this.selSngl(e,false,true)}this.prld()};Owa.UIControls.VLV.prototype.nP=function Owa$UIControls$VLV$nP(h,g){if(!this.iTC)return;ClientAction.add(ClientAction.Name.ScrollPageDown);var k=this._getDescendant(a),i=this.gtVPH(),j=this.gtDtaHt(),f=this.getViewportPosition()+i,d=new RowPosition;if(j>f)d=this.getLastVisibleRow();else if(this.ER()==this.iTC-1)d=new RowPosition(this.iTC-1,0);else{this.prld();this.fPndLd&&this.enqOp(ob,arguments);return}this.posVwprt(d);this.updScr();if(!g){var b=this.getLastVisibleRow(),c=this.gtRw(b.iRow);if(b.iRow<this.iTC-1&&b.iRow>this.oCurRowPosition.iRow&&b.iSubRow==0){var e=c.get_NextSibling();if(e&&!this.isRowHeading(e))c=this.gtRw(b.iRow-1)}if(h)this.selRng(c);else this.selSngl(c,false,true)}this.prld()};Owa.UIControls.VLV.prototype.feBRfrsh=function Owa$UIControls$VLV$feBRfrsh(a){if(this.onBRfrsh)this.onBRfrsh(a)};Owa.UIControls.VLV.prototype.feERfrsh=function Owa$UIControls$VLV$feERfrsh(a){if(this.onERfrsh)this.onERfrsh(a)};Owa.UIControls.VLV.prototype.feSelChg=function Owa$UIControls$VLV$feSelChg(a,c){this._clearPreviewUpdateTimer();if(this.onSelChg){var b={};if(a){b.sMid=a;if(this.oSel[a])b.fSel=this.oSel[a].fSel}if(c)b.fForceRpUd=c;this.onSelChg(b)}};Owa.UIControls.VLV.prototype.feNav=function Owa$UIControls$VLV$feNav(b,c){if(this.onNav){var a={};if(b)a.oCtx=b;if(c)a.fCl=c;this.onNav(a)}};Owa.UIControls.VLV.prototype.feRmvRws=function Owa$UIControls$VLV$feRmvRws(){this.onRmvRws&&this.onRmvRws()};Owa.UIControls.VLV.prototype.onClkHdr=function Owa$UIControls$VLV$onClkHdr(c){var b=c.get_Target(),a=b.getAncestorById("col",p);if(a&&a.getAttribute("sO")){this.srt(a.getIntAttribute("cId"),a.getIntAttribute("sO"));this.fTD=getInt(a.getAttribute("tD"))}a=b.getAncestorById("tdSO",p);a&&a.getAttribute("sO")&&this.srt(this.iSC,a.getIntAttribute("sO"));b.getAncestorById("tdAB",p)&&this._get_ABM()&&this._get_ABM().showAtEvent(c)};Owa.UIControls.VLV.prototype.onClkABM=function Owa$UIControls$VLV$onClkABM(b){if(!b.oMenuItem)return;var a=b.oMenuItem;this.srt(a.getIntAttribute("_cid"),a.getIntAttribute("_so"));this.fTD=getInt(a.getAttribute("_tD"))};Owa.UIControls.VLV.prototype.onScr=function Owa$UIControls$VLV$onScr(){if(this.fIgnScr)return;var a=this.gtRwFrmScr();if(this.iScrollTimer&&Math.abs(this.oScrollRowPosition.iRow-a.iRow)>Cb){this._clearTimeout(this.iScrollTimer);this.iScrollTimer=0}if(!this.iScrollTimer){this.iScrollTimer=this._setTimeout(this.calculateScrollingWrapper,Gb);this.oScrollRowPosition=a}};Owa.UIControls.VLV.prototype.calculateScrollingWrapper=function Owa$UIControls$VLV$calculateScrollingWrapper(){this.calculateScrolling()};Owa.UIControls.VLV.prototype.calculateScrolling=function Owa$UIControls$VLV$calculateScrolling(){if(this.iScrollTimer){this._clearTimeout(this.iScrollTimer);this.iScrollTimer=0}var e=this._getDescendant(s),a=e.get_ScrollTop()-this.iScrTp,d=e.get_OffsetHeight(),b=a/d;if(Math.abs(b)<=.01)return;if(c.isIE()&&Math.abs(b)>.11&&Math.abs(b)<.13||c.isSafari()&&Math.abs(a)==ab||c.isFirefox()&&c.isMac()&&Math.abs(a)==Y||c.isFirefox()&&c.isMac()&&Math.abs(a)==W||c.isFirefox()&&c.isWin()&&Math.abs(a)==Z||c.isFirefox()&&c.isWin()&&Math.abs(a)==X){this.scrollSingleRow(b>0);return}if(c.isIE()&&Math.abs(b)>.86&&Math.abs(b)<.88||c.isSafari()&&Math.abs(a)==d-ab||c.isFirefox()&&c.isMac()&&Math.abs(a)==d-Y||c.isFirefox()&&c.isMac()&&Math.abs(a)==d-W||c.isFirefox()&&c.isWin()&&Math.abs(a)==d-Z||c.isFirefox()&&c.isWin()&&Math.abs(a)==d-X){if(b<0)this.pP(0,1);else this.nP(0,1);return}var f=this.gtRwFrmScr();if(f.iRow==0&&f.iSubRow==0&&b>0){this.scrollSingleRow(b>0);return}ClientAction.add(ClientAction.Name.ScrollOther);this.iScrTp=e.get_ScrollTop();this.updVwprt()};Owa.UIControls.VLV.prototype.onMWhl=function Owa$UIControls$VLV$onMWhl(a){var b=a.get_WheelDirection();this.scrollSingleRow(b>0);a.preventDefault();a.cancelBubble()};Owa.UIControls.VLV.prototype.onTouchDown=function Owa$UIControls$VLV$onTouchDown(a){if(a._oEvent.pointerType!==a._oEvent.MSPOINTER_TYPE_TOUCH)return;this._fFromTouchEvent=true;this._fScrolledFromTouch=false;this._iTouchStartLocation=a.get_ClientY()};Owa.UIControls.VLV.prototype.onTouchMove=function Owa$UIControls$VLV$onTouchMove(a){if(a._oEvent.pointerType!==a._oEvent.MSPOINTER_TYPE_TOUCH)return;var b=a.get_ClientY()-this._iTouchStartLocation,c=Math.abs(b);if(c<wb)return;this._iTouchStartLocation=a.get_ClientY();this._fScrolledFromTouch=true;if(b>0)this.scrollSingleRow(false);else this.scrollSingleRow(true)};Owa.UIControls.VLV.prototype.onTouchUp=function Owa$UIControls$VLV$onTouchUp(a){if(a._oEvent.pointerType!==a._oEvent.MSPOINTER_TYPE_TOUCH)return;if(!this._fScrolledFromTouch)this.onMD(a)};Owa.UIControls.VLV.prototype.onClkVP=function Owa$UIControls$VLV$onClkVP(a){a.preventDefault();a.cancelBubble()};Owa.UIControls.VLV.prototype.onDblClkVP=function Owa$UIControls$VLV$onDblClkVP(a){var b=this.fndRw(a.get_Target());if(!b)return;this.feNav()};Owa.UIControls.VLV.prototype.onMD=function Owa$UIControls$VLV$onMD(d){if(this._fFromTouchEvent){this._fFromTouchEvent=false;return}ClientAction.add(ClientAction.Name.ClickRow);this.oMU=this._iLastMDX=this._iLastMDY=0;this._fTriggerDragDrop=true;var a=this.fndRw(d.get_Target());if(a&&a.get_Id()!=b)this.isSelExp&&this.isSelExp()&&this.clrSel(1);if(d.get_Target().get_Id()==G){if(this.isSel(a))this.unsel(a);else this.sel(a);return}if(!a)return;if(this.isSel(a)&&!d.isShiftKeyDown()){this.oMU={};this.oMU.fCtrl=d.isCtrlKeyDown();this.oMU.oR=a}else if(d.isShiftKeyDown()){var e=this.gtRwById(this.get_SelectionAnchorId());if(e&&e.get_Id()==b&&a&&a.get_Id()!=b){this.set_SelectionAnchorId(this.sExpId);this.expRw(0)}this.selRng(a,d.isCtrlKeyDown())}else if(d.isCtrlKeyDown()){this.sel(a);this.set_SelectionAnchorId(this.getData(a).sId)}else this.selSngl(a,false,true,1);if(c.isSafari()&&c.isWin()&&d.isRightButtonDown())this.onCMVP(d);this._iLastMDX=d.get_ClientX();this._iLastMDY=d.get_ClientY()};Owa.UIControls.VLV.prototype.onMU=function Owa$UIControls$VLV$onMU(a){if(!this.oMU)return;if(!this.oMU.oR.get_ParentElement()){this.oMU=0;return}if(this.oMU.fCtrl)this.unsel(this.oMU.oR);else!a.isRightButtonDown()&&this.selSngl(this.oMU.oR);this.oMU=0};Owa.UIControls.VLV.prototype.onMouseMove=function Owa$UIControls$VLV$onMouseMove(b){if(this._fTriggerDragDrop&&b.isLeftButtonDown()&&this._getDescendant(a)._get_DomNode().dragDrop&&c.isIE()){if(this._iLastMDX&&this._iLastMDY&&this._fTriggerDragDrop){var d=b.get_ClientX(),e=b.get_ClientY();if(Math.abs(this._iLastMDX-d)>=5||Math.abs(this._iLastMDY-e)>=5){this._getDescendant(a)._get_DomNode().dragDrop();this._fTriggerDragDrop=false}}}else this._fTriggerDragDrop=false};Owa.UIControls.VLV.prototype.onMouseOver=function Owa$UIControls$VLV$onMouseOver(a){var b=this.fndRw(a.get_Target());if(b)if(this._shouldProcessRowHoverEvent(a))if(a.get_Type()=="mouseout"){if(this._oRowHoverTimer){this._clearTimeout(this._oRowHoverTimer);this._oRowHoverTimer=null}b.removeCssClass(fb)}else if(a.get_Type()=="mouseover")this._oRowHoverTimer=this._setTimeout(this._onRowHoverCallback,175,b)};Owa.UIControls.VLV.prototype._shouldProcessRowHoverEvent=function Owa$UIControls$VLV$prototype$_shouldProcessRowHoverEvent(c){var b;if(c.get_Type()=="mouseout")b=c.get_ToElementForMouseOut();else if(c.get_Type()=="mouseover")b=c.get_FromElementForMouseOver();if(!b)return true;var a=this.findEntireRow(c.get_Target());if(!a||a.get_Length()==0)return false;for(var e=false,d=0;d<a.get_Length()&&!e;d++)if(a[d])e=a[d].equals(b)||a[d].contains(b);return!e};Owa.UIControls.VLV.prototype._onRowHoverCallback=function Owa$UIControls$VLV$_onRowHoverCallback(a){a.addCssClass(fb)};Owa.UIControls.VLV.prototype.onCMVP=function Owa$UIControls$VLV$onCMVP(a){if(a.isCtrlKeyDown()){a.preventDefault();a.cancelBubble();return}var b=this.fndRw(a.get_Target());if(b&&this.get_ContextMenu()){this._prepareContextMenu();this.get_ContextMenu().showAtEvent(a);a.preventDefault();a.cancelBubble()}};Owa.UIControls.VLV.prototype.showContextMenu=function Owa$UIControls$VLV$showContextMenu(a,b){this._prepareContextMenu();this.get_ContextMenu().show(a,b)};Owa.UIControls.VLV.prototype._prepareContextMenu=function Owa$UIControls$VLV$_prepareContextMenu(){var a=this.get_ContextMenu();a._clearEventCollections();a.changeShowerSubPage(this.get_SubPage());a.get_OnSelect().add(this._createCallback(this._onSelectCM));a.get_OnPreShow().add(this._createCallback(this._fnCMOnPreShow));a.get_OnClose().add(a._createCallback(a._clearEventCollections))};Owa.UIControls.VLV.prototype._onSelectCM=function Owa$UIControls$VLV$_onSelectCM(a){this._fnCMOnSelect(a.sCommand,a.oMenuItem)};Owa.UIControls.VLV.prototype.onCMHdr=function Owa$UIControls$VLV$onCMHdr(a){if(this._get_ABM()){this._get_ABM().showAtEvent(a);a.preventDefault();a.cancelBubble()}};Owa.UIControls.VLV.prototype.onDS=function Owa$UIControls$VLV$onDS(b){if(Owa.Utility.isIE()&&Owa.Utility.isGreaterThanIE9UsingTrident()){var d=this._getDescendant(a);this._iScrollTopTmp=d.get_ScrollTop();d.set_IsShown(false)}var c=this.crtDC(),f=new Owa.Components.Storage.DragDrop(b);if(c){c.save(f);if(Owa.Utility.isSafari()){var e=new Image;e.src=getRsrcF("clear1x1.gif");b._oEvent.dataTransfer.setDragImage(e,1,1)}}else{b.preventDefault();b.cancelBubble()}};Owa.UIControls.VLV.prototype.onDrag=function Owa$UIControls$VLV$onDrag(){if(Owa.Utility.isIE()&&Owa.Utility.isGreaterThanIE9UsingTrident()&&this._iScrollTopTmp>=0){var b=this._getDescendant(a);b.set_IsShown(true);b.set_ScrollTop(this._iScrollTopTmp);this._iScrollTopTmp=-1}};Owa.UIControls.VLV.prototype.onKD=function Owa$UIControls$VLV$onKD(a){if(Owa.Dom.Input.isInstance(a.get_Target())&&!a.get_Target().hasCssClass("offscreen"))return;var e=a.get_KeyCodeForKeyUpDown(),b=false,c=false;switch(e){case Owa.KeyCodes.ENTER:!this.isDumpsterVw()&&this.feNav();break;case Owa.KeyCodes.UP:case Owa.KeyCodes.DOWN:var d=e==Ib;if(a.isShiftKeyDown())this.extndRng(d);else this.sLstSel&&this.selNPRw(this.sLstSel,0,d);b=true;break;case Owa.KeyCodes.PAGE_UP:c=b=true;this.pP(a.isShiftKeyDown());break;case Owa.KeyCodes.PAGE_DOWN:c=b=true;this.nP(a.isShiftKeyDown());break;case Owa.KeyCodes.END:c=b=true;this.lP(a.isShiftKeyDown());break;case Owa.KeyCodes.HOME:c=b=true;this.fP(a.isShiftKeyDown());break;case Owa.KeyCodes.F9:c=b=true;this.rfrsh()}c&&this.makeFocused();if(b){a.preventDefault();a.cancelBubble()}};Owa.UIControls.VLV.prototype.onKP=function Owa$UIControls$VLV$onKP(a){if(Owa.Dom.Input.isInstance(a.get_Target())&&!a.get_Target().hasCssClass("offscreen"))return;var b=a.get_CharCodeForKeyPress();if(!this.fTD||b==13||b==27||c.isFirefox()&&b==0||c.isSafari()&&b>63000||a.isCtrlKeyDown())return;this.iTDTmr&&this._clearTimeout(this.iTDTmr);this.sTD+=String.fromCharCode(a.get_CharCodeForKeyPress());this.iTDTmr=this._setTimeout(this.tdSrch,Hb)};Owa.UIControls.VLV.prototype.onRsz=function Owa$UIControls$VLV$onRsz(){var a=this._get_Element().get_ClientHeight();if(a!=this.iH){this.updScr();a>this.iH&&this.updVwprt();this.iH=a;this.iVPH=0}this._fixScrollbarWidth()};Owa.UIControls.VLV.prototype.makeFocused=function Owa$UIControls$VLV$makeFocused(){this._getDescendant("linkVLV")._get_DomNode().focus()};Owa.UIControls.VLV.prototype.updVwprt=function Owa$UIControls$VLV$updVwprt(){if(!this._get_IsShown()){this.fPndUpd=1;return}this.fPndUpd=0;if(this.iScrollTimer)return;var a=this.gtRwFrmScr();switch(this.gtLdTyp(a.iRow)){case A:this.posVwprt(a);break;case hb:this.ldAdj(1);break;case ib:this.ldAdj(0);break;case z:this.ldFrsh(a.iRow)}this.prld()};Owa.UIControls.VLV.prototype.posVwprt=function Owa$UIControls$VLV$posVwprt(b){var d=0;if(!b)b=new RowPosition(0,0);var e=this.gtRw(b.iRow,b.iSubRow);if((b.iRow>0||b.iSubRow>0)&&e)d=this.getRowPosition(e);var c=this._getDescendant(a);c.set_ScrollTop(d);if(d>c.get_ScrollHeight()-c.get_ClientHeight())this._resetCurrentRowPosition();else this.oCurRowPosition=new RowPosition(b.iRow,b.iSubRow)};Owa.UIControls.VLV.prototype._resetCurrentRowPosition=function Owa$UIControls$VLV$_resetCurrentRowPosition(){var a=this.getFirstVisibleRow();this.oCurRowPosition=new RowPosition(a.iRow,a.iSubRow)};Owa.UIControls.VLV.prototype.prld=function Owa$UIControls$VLV$prld(){if(this._iPreloadTimer){this._clearTimeout(this._iPreloadTimer);this._iPreloadTimer=0}if(this.iTC==0||this.isViewportEmpty())return;if(!this._get_IsShown()){this.fPndUpd=1;return}if(this.fPndLd)return;if(this.iScrollTimer)return;var h=this._getDescendant(a),b=h.get_FirstChild(),g=this.gtVPH(),i=this.gtDtaHt(),c=this.getViewportPosition(),e=Math.max(this.gtChHt(b)/2,g);if(c<e&&b.getIntAttribute("iSR")>0){this.ldAdj(0);return}if(b.get_NextSibling()){var f=this.gtChHt(b)+this.gtChHt(b.get_NextSibling())/2;if(c>f&&c-this.gtChHt(b)>e){var j=c-this.gtChHt(b);i-=this.gtChHt(b);b.remove(true);h.set_ScrollTop(j);this.updScr()}}var d=h.get_LastChild();c=i-this.getViewportPosition()-g;e=Math.max(this.gtChHt(d)/2,g);if(c<e&&d.getIntAttribute("iER")<this.iTC-1){this.ldAdj(1);return}if(d.get_PreviousSibling()){f=this.gtChHt(d)+this.gtChHt(d.get_PreviousSibling())/2;if(c>f&&c-this.gtChHt(d)>e){this._storeViewportPosition();d.remove(true);this._resetViewportPosition();this.updScr()}}};Owa.UIControls.VLV.prototype.updScr=function Owa$UIControls$VLV$updScr(){if(!this._get_IsShown()){this.fPndUpd=1;return}var a=1,d=this.getEstimatedViewHeight();if(this.iTC>0){a=d;a=Math.max(a,this.getTotalChunkHeight());a=Math.min(a,tb)}this.fIgnScr=1;var c=this._getDescendant(s),g=this._getDescendant(yb);g.set_Height(a);a=c.get_ScrollHeight();var e=a-c.get_OffsetHeight();if(e<=0)return;var b=0;if(this.iTC>0)b=this.getCurrentViewTop();if(d>a){var f=e/(d-c.get_OffsetHeight());b=Math.floor(b*f)}if(c.get_ScrollTop()!=b){c.set_ScrollTop(b);this.iScrTp=b}c.get_OffsetHeight();this.fIgnScr=0};Owa.UIControls.VLV.prototype.ldFrsh=function Owa$UIControls$VLV$ldFrsh(d,i,q,t,s,j,w,b,p,o){this.shouldClearPendingRequests(p,b)&&this.clearPendingRequests();if(!this.strtLd(db,arguments))return;isDf(typeof this._clearRowNotifications)&&this._clearRowNotifications();cancelPendingThrottledRefresh(this.get_SubPage());if(this._oPreviewUpdateTimer){this.feSelChg(this._oPreviewUpdateTimer.sId);this._clearPreviewUpdateTimer()}this.feBRfrsh(i==I);var c=0;if(this.iTC>0){var n=this.getNumberOfItemsInTheViewport(),r=Math.floor((l-n)/2),k=d;if(d==this.iTC-1)k=Math.max(0,d-n);c=Math.max(0,k-Math.max(0,r))}var a={};a.iSR=c;a.iER=c+l-1;a.iR=d;a.fChkScr=!q;a.fnCb=t;a.fnBfCb=s;a.fPerformPrefetch=o?true:false;a.fInstantaneous=!(isDf(typeof b)&&b=="manualrefresh");for(var h=this.gtSel(),g={},f=0;f<h.get_Length();f++)g[h.get_Item(f)]=this.gtRwPrp(h.get_Item(f),"read");if(this.sExpId)g[this.sExpId]=this.gtRwPrp(this.sExpId,"read");a.oSelectedRowsState=g;if(!j)j="LoadFresh";var e=new oeReq(this.sEvtNS,j,a,this._createCallback(this.cbLdSafe),POST,0,0,w,0,b);this.addLVSt(e);e.add("SR",c);e.add("RC",l);e.send();if(i!=I)this.iPrgT=this._setTimeout(this.shwPrgrs,u,i==v?v:m)};Owa.UIControls.VLV.prototype.cbLdSafe=function Owa$UIControls$VLV$cbLdSafe(b){if(this.hasPendingOperations()){var c=this;this._fnOnAsyncOperationsComplete=function(){c.updVwprt()};this.endLd();this.cnclPrgrs();return}if(!this._get_IsShown()){var c=this;this._fnOnShow=function(){c.cbLdSafe(b)};return}var a=b.oCtx;try{if(a&&a.fIsLoadAdjacent)this.cbLdAdj(b);else this.cbLdFrsh(b)}finally{this.endLd();!b.sErr&&this.updVwprt()}this.isPrefetchEnabled()&&a&&a.fPerformPrefetch&&!this.isFltrd()&&!this.fFltrdVw&&this._restartPrefetch(a.fInstantaneous)};Owa.UIControls.VLV.prototype.cbLdFrsh=function Owa$UIControls$VLV$cbLdFrsh(j){if(this._oPreviewUpdateTimer){this.feSelChg(this._oPreviewUpdateTimer.sId);this._clearPreviewUpdateTimer()}this.cnclPrgrs();if(!cbOeh(j))return;var l=0,d=new RowPosition(0,0),b=j.oCtx?j.oCtx:{};if(!b.fChkScr)l=1;else if(this.iTC>0){d=this.gtRwFrmScr();var o,n,r=this.getNumberOfItemsInTheViewport();if(d.iRow==this.iTC-1){n=d.iRow;o=Math.max(0,n-r)}else{o=d.iRow;n=Math.min(this.iTC-1,o+r)}l=o>=b.iSR&&n<=b.iER}else l=1;if(l){b.fnBfCb&&b.fnBfCb(this,j);var m=!this.iTC,p=h.get_Current().createElement("DIV");p.set_InnerHtml(j.sBody);var k=this._getDescendant(a),w=k.get_ParentElement();w.removeChild(k);k.set_InnerHtml("");var t=p.getChildById(i);k.appendChild(t);w.appendChild(k);this.initChnk(t);var x=this.isCnvVw&&this.isCnvVw();this.prcsDta(p);if(this.fSrchInProg&&this.gtTC()==0){this.iPrgT=this.stTmout("shwPrgrs",u,v);this._fRestartSearchRefreshTimer&&this._reStartSearchRefreshTimer();this.fSrchInProg=0}var q=0;if(x&&!this.isCnvVw()&&this.gtSelCnt()>1)q=1;if(!b.fChkScr||d.iRow<this.SR()||d.iRow>this.ER())d.iRow=this.SR();this.posVwprt(d);this.updScr();var c=this.gtSel();if(b.oSelectedRowsState){for(var e,g=0;g<c.get_Length();g++){var s=c.get_Item(g),f=this.gtRwById(s);e=b.oSelectedRowsState[s];if(f&&isDf(typeof e))e==String(MSG_MARKED_UNREAD)&&!this.isRd(f)&&this.getData(f).setAttribute("read",e)}if(this.sExpId){var f=this.gtRwById(this.sExpId);e=b.oSelectedRowsState[this.sExpId];if(f&&isDf(typeof e))e==String(MSG_MARKED_UNREAD)&&!this.isRd(f)&&this.getData(f).setAttribute("read",e)}}if(c.get_Length()>0){if(this.SR()==0&&this.ER()==this.iTC-1){for(var g=0;g<c.get_Length();g++){var f=this.gtRwById(c[g]);if(!f)delete this.oSel[c[g]]}c=this.gtSel()}if(this.iTC==0)this.clrSel(1);else if(c.get_Length()==0)m=true;else{this.feSelChg(c.get_Item(0),q,1);m=false}}else m=true;m&&this.iTC&&this.selSngl(this.gtRw(d.iRow))}b.fnCb&&b.fnCb(this,j);this.set_SelectionAnchorId(this.get_SelectionAnchorId())};Owa.UIControls.VLV.prototype.ldAdj=function Owa$UIControls$VLV$ldAdj(c){if(!this.strtLd(E,arguments))return;var b=this.gtRws();if(b.get_Length()==0){this.endLd();!this.isEmpty()&&this.rfrsh();return}var e=this.getData(c?b.get_Item(b.get_Length()-1):b.get_Item(0)).sId,d={};d.fIsLoadAdjacent=true;d.fNxt=c;var f=c?"LoadNext":"LoadPrevious",a=new oeReq(this.sEvtNS,f,d,this._createCallback(this.cbLdSafe),POST);this.addLVSt(a);a.add("AId",e);a.add("RC",l);a.send()};Owa.UIControls.VLV.prototype.cbLdAdj=function Owa$UIControls$VLV$cbLdAdj(g){if(!cbOeh(g))return;var n=g.oCtx.fNxt,e=h.get_Current().createElement("DIV");e.set_InnerHtml(g.sBody);if(getInt(e.getChildById(r).getAttribute("fR"))||this.isViewportEmpty()&&this.iTC>0||e.getChildById(i).getBoolAttribute(t)){this.rfrsh();return}var l=this.gtRwFrmScr(),b=e.getChildById(i);this.initChnk(b);var d=0,f=this._getDescendant(a);if(n)if(getInt(b.getAttribute("fNull"))){var m=e.getChildById(r),p=m.getIntAttribute(o);d=p-1-this.ER()}else{this._storeViewportPosition();f.appendChild(b);this._resetViewportPosition();d=b.getIntAttribute("iSR")-b.get_PreviousSibling().getIntAttribute("iER")-1}else if(getInt(b.getAttribute("fNull")))d=-this.SR();else{var j=0,k=c.isFirefox()&&c.isWin();if(k)j=this.getViewportPosition()+this.gtChHt(b);f.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,b);k&&f.set_ScrollTop(j);d=b.getIntAttribute("iER")-b.get_NextSibling().getIntAttribute("iSR")+1}if(d!=0){f.forEachChild(function(a){if(a!=b){a.setIntAttribute("iSR",a.getIntAttribute("iSR")+d);a.setIntAttribute("iER",a.getIntAttribute("iER")+d)}});l.iRow+=d}this.posVwprt(l);this.updScr();this.prcsDta(e);this.set_SelectionAnchorId(this.get_SelectionAnchorId())};Owa.UIControls.VLV.prototype.gtLdTyp=function Owa$UIControls$VLV$gtLdTyp(b){var e=this._getDescendant(a);if(!e.hasChildNodes())return z;if(getInt(e.get_FirstChild().getAttribute(t)))return A;var d=this.SR(),c=this.ER();if(b>c)return z;if(b<d)return d-b<l?ib:z;var f=this.gtRw(b);return this.gtDtaHt()-this.getRowPosition(f)<this.gtVPH()&&c<this.iTC-1?hb:A};Owa.UIControls.VLV.prototype.getRowPosition=function Owa$UIControls$VLV$getRowPosition(b){var a=this.getRowPositionInChunk(b),c=this.fndChnk(b);a+=c.get_PositionalTop();return a};Owa.UIControls.VLV.prototype.getRowPositionInChunk=function Owa$UIControls$VLV$getRowPositionInChunk(c){var b=0,a=c;do{b+=a.get_PositionalTop();a=a.get_PositionalParent();if(a.get_TagName()=="HTML")throw new Error("Can't find "+i+" in getRowPositionInChunk");}while(a.get_Id()!=i);return b};Owa.UIControls.VLV.prototype.gtRwFrmScr=function Owa$UIControls$VLV$gtRwFrmScr(){var c=this._getDescendant(s),f=c.get_ScrollHeight()-c.get_OffsetHeight();if(f==0||this.iTC==0)return new RowPosition(0,0);var a=c.get_ScrollTop(),e=this.getEstimatedViewHeight()-c.get_OffsetHeight(),g=f/e;if(g<1)a=Math.ceil(a/g);var d=this.getTypicalRowHeight()*this.SR(),h=d+this.getTotalChunkHeight(),b=null;if(a<d)b=new RowPosition(Math.ceil(a/this.getTypicalRowHeight()),0);else if(a>=Math.ceil(e))b=new RowPosition(this.iTC-1,0);else if(a<h)b=this.getFirstRowAfterHeight(a-d);else b=new RowPosition(this.ER()+Math.ceil((a-h)/this.getTypicalRowHeight()),0);return b};Owa.UIControls.VLV.prototype.prcsDta=function Owa$UIControls$VLV$prcsDta(c){var b=c.getChildById(r);this.iTC=b.getIntAttribute(o);this.iTIC=b.getIntAttribute(D);this.sDataFolderId=b.getAttribute(V);if(b.getIntAttribute("fSrchInProg")==1)this.fSrchInProg=1;var f=c.getChildById(p);f&&this._getDescendant(p).get_FirstChild().replace(f.get_FirstChild());var d=c.getChildById("nwSel");if(d){var g=this.gtRwById(d.getAttribute("sId"));g&&this.selSngl(g)}else if(this.isCnvVw&&!this.isCnvVw()){var e=this.gtSel();if(e.get_Length()&&Ews.BaseId.IsOwaCnvId(e.get_Item(0))){var i=this.gtRws();i.get_Length()>0&&this.selSngl(i.get_Item(0))}}var a=this._getDescendant(T);if(this.isFltrd()&&!a){a=h.get_Current().createElement("DIV");this._getDescendant(Jb).appendChild(a);a.set_Id(T);a.addCssClass("fltrBg")}!this.isFltrd()&&a&&a.remove(true);this.feERfrsh(c.getChildById("spnSR"))};Owa.UIControls.VLV.prototype.srt=function Owa$UIControls$VLV$srt(d,e,c){if(!this.strtLd(nb,arguments))return;ClientAction.add(ClientAction.Name.Sort);this.iSC=d;this.iSO=e;this.feBRfrsh(0);var b={};b.fPerformPrefetch=c?true:false;var a=new oeReq(this.sEvtNS,"Sort",b,this._createCallback(this.cbLdSafe),POST);this.addLVSt(a);a.add("RC",l);this.get_SelectionAnchorId()&&a.add("SId",this.get_SelectionAnchorId());a.send();this.iPrgT=this._setTimeout(this.shwPrgrs,u,m)};Owa.UIControls.VLV.prototype.tdSrch=function Owa$UIControls$VLV$tdSrch(){if(!this.strtLd(gb,arguments))return;ClientAction.add(ClientAction.Name.TypeDownSearch);this.feBRfrsh(0);var c={},b=this;c.fnCb=function(){var a=b.gtRws();a.get_Length()&&b.selSngl(a.get_Item(0))};var a=new oeReq(this.sEvtNS,"TypeDown",c,this._createCallback(this.cbLdSafe),POST);this.addLVSt(a);a.add("td",this.sTD);a.add("RC",l);a.send();this.sTD="";this.iPrgT=this._setTimeout(this.shwPrgrs,u,m)};Owa.UIControls.VLV.prototype._getArrangeByColumnId=function Owa$UIControls$VLV$_getArrangeByColumnId(a){return this._oABMDiv.getChildById(a).getIntAttribute("_cid")};Owa.UIControls.VLV.prototype.set_SelectionAnchorId=function Owa$UIControls$VLV$prototype$set_SelectionAnchorId(e){this.sSelA=e;if(this.sSelA){for(var d=null,c=-1,b=this.getRowInfos(),a=0;a<b.length;++a)if(b[a].sRowId==this.sSelA){c=a;continue}else if(b[a].sId==g){d=b[a].sRowId;if(c>=0)break}if(c>=0)this.sNextSelA=d;else if(this.sNextSelA==this.sSelA)this.sNextSelA=0}else this.sNextSelA=0};Owa.UIControls.VLV.prototype.get_SelectionAnchorId=function Owa$UIControls$VLV$prototype$get_SelectionAnchorId(){return this.sSelA};Owa.UIControls.VLV.prototype.removeSelectionAnchoredRow=function Owa$UIControls$VLV$prototype$removeSelectionAnchoredRow(){var b=this.get_SelectionAnchorId();if(this.gtSelCnt()==1&&this.sNextSelA){var a=this.gtRwById(this.sNextSelA);a&&this.selSngl(a)}this.rmvRws([b])};Owa.UIControls.VLV.prototype.sel=function Owa$UIControls$VLV$sel(c,m,p,o){m|=this.isSel(c)&&this.getData(c).sId==this.get_ItemIdInReadingPane();var a,h=false;if(c.get_Id()==g){a=c;if(this.isSelExp&&this.isSelExp()){this.clrSel(1);if(this.sExpId){var n=this.gtRwById(this.sExpId);n&&this.sel(n)}}h=this.sExpId?this.sExpId==this.getData(c).sId:false}else if(c.get_Id()==b){h=true;if(this.isSelExp&&this.isSelExp())a=null;else a=this.gtExpCnv(c);if(a&&this.gtSelCnt()>0){!this.isSel(a)&&this.sel(a);return}}var l=this.isCnvVw&&this.isCnvVw();this._storeViewportPosition();while(a){if(l)if(h)a.addCssClass(q);else a.addCssClass(J);else a.addCssClass(J);a=a.get_NextSibling();if(!a||a.get_Id()!=j)break}if(c.get_Id()==b){c.removeCssClass(q);c.addCssClass(w)}this._resetViewportPosition();var k=c.getDescendantById(G);k&&Owa.Components.CssSprites.updateImage(k,"lv-chk.png");var i=this.getData(c).sId,f={};this.oSel[i]=f;f.fSel=1;var d=this.rgPbPrps;if(d)for(var e=0;e<d.get_Length();e++)f[d.get_Item(e)]=this.gtPrpV(c,d.get_Item(e));if(c.get_Id()==b){a=this.gtExpCnv(c);if(a){var r=this.getData(a).sId;f.sCnvId=r}}if(!m)if(p)this._resetPreviewUpdateTimer(i,o);else this.feSelChg(i);l&&this.udPp()};Owa.UIControls.VLV.prototype._resetPreviewUpdateTimer=function Owa$UIControls$VLV$_resetPreviewUpdateTimer(b,a){this._oPreviewUpdateTimer&&this._clearPreviewUpdateTimer();this._oPreviewUpdateTimer={};this._oPreviewUpdateTimer.sId=b;var c=a?a:300;this._oPreviewUpdateTimer.oTimer=this._setTimeout(this._cbPreviewUpdate,c,b)};Owa.UIControls.VLV.prototype._cbPreviewUpdate=function Owa$UIControls$VLV$_cbPreviewUpdate(a){addPerfMarker("SwitchReadingPane.Start");this.feSelChg(a)};Owa.UIControls.VLV.prototype._clearPreviewUpdateTimer=function Owa$UIControls$VLV$_clearPreviewUpdateTimer(){if(this._oPreviewUpdateTimer){this._clearTimeout(this._oPreviewUpdateTimer.oTimer);this._oPreviewUpdateTimer=null}};Owa.UIControls.VLV.prototype.unsel=function Owa$UIControls$VLV$unsel(c,f){this._storeViewportPosition();var a;if(c.get_Id()==g)a=c;else if(c.get_Id()==b){c.addCssClass(q);c.removeCssClass(w);if(this.gtSelCnt()>1)a=null;else a=this.gtExpCnv(c)}while(a){a.removeCssClass(q);a.removeCssClass(w);a.removeCssClass(J);a=a.get_NextSibling();if(!a||a.get_Id()!=j)break}this._resetViewportPosition();var e=c.getDescendantById(G);e&&Owa.Components.CssSprites.updateImage(e,"lv-unchk.png");var d=this.getData(c).sId;if(this.oSel[d]){this.oSel[d].fSel=false;!f&&this.feSelChg(d);delete this.oSel[d]}this.isCnvVw&&this.isCnvVw()&&this.udPp();this._setTimeout(this.updateExpansion,10)};Owa.UIControls.VLV.prototype.updateExpansion=function Owa$UIControls$VLV$updateExpansion(){if(this.sExpId){var a=false;for(var b in this.oSel)if(b==this.sExpId){a=true;break}else if(this.sExpId==this.oSel[b].sCnvId){a=true;break}!a&&this.expRw(0)}};Owa.UIControls.VLV.prototype.selSngl=function Owa$UIControls$VLV$selSngl(a,d,c,b){var e=this.getData(a).sId;this.unSelRemaining(new Array(e),1);this.sel(a,d,c,b);this.sLstSel=this.getData(a).sId;this.set_SelectionAnchorId(this.sLstSel)};Owa.UIControls.VLV.prototype.selRng=function Owa$UIControls$VLV$selRng(a,l){var d=this.getData(a).sId;!this.get_SelectionAnchorId()&&this.set_SelectionAnchorId(d);this.sLstSel=d;!l&&this.unSelRemaining(new Array(d),this.isSelExp&&this.isSelExp());var c=this.gtRwById(this.get_SelectionAnchorId());if(!c){this.selSngl(a);alrt(this._get_Element().getAttribute("L_BigSel"));return}if(c.get_Id()!=a.get_Id()){if(a.get_Id()==b){var e=this.gtExpCnv(a);if(c.equals(e))c=e.get_NextSibling().get_NextSibling();else a=e}else{var e=this.gtExpCnv(c);if(a.equals(e))a=e.get_NextSibling().get_NextSibling();else c=e}d=this.getData(a).sId;this.set_SelectionAnchorId(this.getData(c).sId)}var g,h;if(this.getRowPosition(c)<this.getRowPosition(a)){g=this.get_SelectionAnchorId();h=d}else{g=d;h=this.get_SelectionAnchorId()}for(var k=0,i=this.gtRws(a.get_Id()==b?1:0),f=0;f<i.get_Length();f++){var j=this.getData(i.get_Item(f)).sId;if(j==g)k=1;k&&this.sel(i.get_Item(f),1);if(j==h)break}this.feSelChg(d)};Owa.UIControls.VLV.prototype.extndRng=function Owa$UIControls$VLV$extndRng(a,d){if(!this.sLstSel)return;var b=this.gtNPRw(this.sLstSel,a);if(!b){if(this.selectAtDataSetLimit(a,true))return;if(!d){var c=this,e=function(){c.extndRng(a,1)};this.ldSk(this.sLstSel,a,e)}return}this.selRng(b);this.scrToVwprt(b)};Owa.UIControls.VLV.prototype.unSelRemaining=function Owa$UIControls$VLV$unSelRemaining(d,g){for(var b=this.gtSel(),a=0;a<b.get_Length();a++){if(d){for(var f=false,e=0;e<d.get_Length();e++)if(d[e]==b[a]){f=true;break}if(f)continue}var c=b.get_Item(a),h=this.gtRwById(c);if(h)this.unsel(h,!g||a<b.get_Length()-1);else{this.oSel[c].fSel=false;g&&a==b.get_Length()-1&&this.feSelChg(c);delete this.oSel[c]}}};Owa.UIControls.VLV.prototype.clrSel=function Owa$UIControls$VLV$clrSel(a){this.unSelRemaining(null,a)};Owa.UIControls.VLV.prototype.isSel=function Owa$UIControls$VLV$isSel(a){return a!=null&&this.oSel[this.getData(a).sId]&&this.oSel[this.getData(a).sId].fSel};Owa.UIControls.VLV.prototype.gtSelAftrRmv=function Owa$UIControls$VLV$gtSelAftrRmv(m,i,c){for(var d=0,k=0,f=0,h={},a=0;a<i.get_Length();a++)h[i[a]]=true;if(!c)c=i;for(var l={},a=0;a<c.get_Length();a++)l[c[a]]=true;for(var b=this.gtRws(this.isSelExp&&this.isSelExp()),a=0;a<b.get_Length();a++){var j=this.getData(b[a]).sId;if(l[j])d++;if(!d&&!h[j])k=b.get_Item(a);if(d==c.get_Length()&&!f&&!h[j]){f=b.get_Item(a);break}}var g;if(d==c.get_Length())g=m&&f||!k?f:k;if(!g&&this.iTC>0){var e=this.oCurRowPosition.iRow-this.SR();while(e<b.get_Length()){if(!this.isSel(b.get_Item(e))){g=b.get_Item(e);break}e++}}return g};Owa.UIControls.VLV.prototype.ldSk=function Owa$UIControls$VLV$ldSk(g,f,d,e,c){if(!this.strtLd(mb,arguments))return;this.feBRfrsh(0);var b={};b.fnCb=d;b.oCtx=e;b.fPerformPrefetch=c?true:false;var h=f?"SeekNext":"SeekPrevious",a=new oeReq(this.sEvtNS,h,b,this._createCallback(this.cbLdSafe),POST);this.addLVSt(a);a.add("SId",g);a.add("RC",l);c&&a.add("nwSel",1);a.send();this.iPrgT=this._setTimeout(this.shwPrgrs,u,m)};Owa.UIControls.VLV.prototype.scrToVwprt=function Owa$UIControls$VLV$scrToVwprt(g){var m=this._getDescendant(a),d=this.getViewportPosition(),j=this.gtVPH(),e=this.getRowPosition(g),l=this.gtRwHt(g),k=e+l,i=d+j,f=k-i,b=this.oCurRowPosition;if(f>0){var h=d+f,c=this.getFirstRowAfterHeight(h);if(b==null||b.iRow<c.iRow||b.iRow==c.iRow&&b.iSubRow<c.iSubRow)b=c}else if(e<d)b=this.getFirstRowAfterHeight(e-5);if(b.iRow!=this.oCurRowPosition.iRow||b.iSubRow!=this.oCurRowPosition.iSubRow){this.posVwprt(b);this.updScr();this.prld()}};Owa.UIControls.VLV.prototype.SR=function Owa$UIControls$VLV$SR(){var b=this._getDescendant(a).get_FirstChild();return!b||getInt(b.getAttribute(t))?0:b.getIntAttribute("iSR")};Owa.UIControls.VLV.prototype.ER=function Owa$UIControls$VLV$ER(){if(!this.iTC||this.isViewportEmpty())return 0;var b=this._getDescendant(a).get_LastChild();return b.getIntAttribute("iER")};Owa.UIControls.VLV.prototype.isViewportEmpty=function Owa$UIControls$VLV$isViewportEmpty(){var b=this._getDescendant(a);return!b||b.getChildById(i)==null?true:false};Owa.UIControls.VLV.prototype.gtDtaHt=function Owa$UIControls$VLV$gtDtaHt(){var b=0,d=this._getDescendant(a),c=this;d.forEachChild(function(a){b+=c.gtChHt(a)});return b};Owa.UIControls.VLV.prototype.gtChHt=function Owa$UIControls$VLV$gtChHt(a){var b=a.get_OffsetHeight();if(!b&&a.get_ParentElement().get_OffsetHeight()!=0)throw new Error("VLV chunk height is 0.");return b};Owa.UIControls.VLV.prototype._getChunkCount=function Owa$UIControls$VLV$_getChunkCount(a){return a.getIntAttribute("iER")-a.getIntAttribute("iSR")};Owa.UIControls.VLV.prototype._updateItemCounts=function Owa$UIControls$VLV$_updateItemCounts(a,e,c,d){this.iTC+=a.iTCDelta;this.iTIC+=a.iTICDelta;if(this.isCnvVw()||!this.isCnvVw()&&(!d||d=="0"))this.iUC+=a.iUCDelta;var b=c.get_NextSibling();while(b){b.setIntAttribute("iSR",b.getIntAttribute("iSR")+a.iTCDelta);b.setIntAttribute("iER",b.getIntAttribute("iER")+a.iTCDelta);b=b.get_NextSibling()}var g=c.getIntAttribute("iSR"),f=c.getIntAttribute("iER");e&&c.setIntAttribute("iSR",g+a.iTCDelta);c.setIntAttribute("iER",f+a.iTCDelta)};Owa.UIControls.VLV.prototype.gtRwById=function Owa$UIControls$VLV$gtRwById(b){var a=this._getDescendant("b"+b);if(a)return this.fndRw(a)};Owa.UIControls.VLV.prototype.gtRw=function Owa$UIControls$VLV$gtRw(c,a){if(!a||a<0)a=0;var b=this.getRowInfoFromPosition(new RowPosition(c,a));return b!=null?b.oRow:null};Owa.UIControls.VLV.prototype.gtRws=function Owa$UIControls$VLV$gtRws(c){if(c)return this._getDescendant(a).getAllDescendantsById(b);this.validateRowCache();if(this._rgHeaderRows==null)this._rgHeaderRows=this._getDescendant(a).getAllDescendantsById(g);return this._rgHeaderRows};Owa.UIControls.VLV.prototype._getIdFromInstanceKey=function Owa$UIControls$VLV$_getIdFromInstanceKey(b){var a=this._getOInstanceKeyToRow()[b];return a?a.sRowId:null};Owa.UIControls.VLV.prototype.getRowInfoFromPosition=function Owa$UIControls$VLV$prototype$getRowInfoFromPosition(c){var a=this.getRowInfos();if(a.length==0)return null;if(c.iRow<a[0].oRowPosition.iRow)return a[0];else if(a[a.length-1].oRowPosition.iRow>=c.iRow){for(var b=0;b<a.length;++b)if(a[b].oRowPosition.equals(c))return a[b];else if(b>0&&a[b].iRow>c.iRow&&a[b-1].iRow==c.iRow)return a[b-1]}else for(var b=a.length-1;b>=0;--b)if(a[b].sId!=j)return a[b];return null};Owa.UIControls.VLV.prototype.getRowInfos=function Owa$UIControls$VLV$prototype$getRowInfos(){this.validateRowCache();if(this._rgRowInfos==null){for(var j=[],h=this.gtRws(),c=0,b=0,m=this.SR(),e=true,f="",i=0,d=0;d<h.length;++d){var a=h[d],k=0;if(e){f=this._getRowHeaderText(a);c=this.getRowPositionInChunk(a);b=c+this.fndChnk(a).get_PositionalTop();if(b<0)b=0;e=false}do{if(this.isRow(a)){var l=this.getData(a);j.add(new RowInfo(a,new RowPosition(m+d,k),b,c,f,l.sId,l.sInstanceKey,i));var g=a.get_OffsetHeight();c+=g;b+=g;k++;i++}a=a.get_NextSibling()}while(a!=null&&!this.isRowHeading(a));if(a==null)e=true}this._rgRowInfos=j}return this._rgRowInfos};Owa.UIControls.VLV.prototype._getOIdToRow=function Owa$UIControls$VLV$prototype$_getOIdToRow(){this.validateRowCache();this._oIdToRow==null&&this._updateRowInfoHashTables();return this._oIdToRow};Owa.UIControls.VLV.prototype.getRowInfoById=function Owa$UIControls$VLV$prototype$getRowInfoById(b){var a=this._getOIdToRow()[b];return a?a:null};Owa.UIControls.VLV.prototype._getOInstanceKeyToRow=function Owa$UIControls$VLV$prototype$_getOInstanceKeyToRow(){this.validateRowCache();this._oInstanceKeyToRow==null&&this._updateRowInfoHashTables();return this._oInstanceKeyToRow};Owa.UIControls.VLV.prototype._updateRowInfoHashTables=function Owa$UIControls$VLV$prototype$_updateRowInfoHashTables(){for(var f=this.getRowInfos(),e={},d={},c=0;c<f.length;++c){var a=f[c];if(a.oRow.get_Id()==g||a.oRow.get_Id()==b){e[a.sRowId]=a;d[a.sInstanceKey]=a}}this._oIdToRow=e;this._oInstanceKeyToRow=d};Owa.UIControls.VLV.prototype._getRowInfoByInstanceKey=function Owa$UIControls$VLV$_getRowInfoByInstanceKey(a){return this._getOInstanceKeyToRow()[a]};Owa.UIControls.VLV.prototype._getPreviousRowInstanceKey=function Owa$UIControls$VLV$_getPreviousRowInstanceKey(d){var b=this._getOInstanceKeyToRow()[d];if(!b)return null;else if(b.iCacheIndex==0)return"";for(var c=this.getRowInfos(),e=b.iCacheIndex-1,a=e;a>=0;a--)if(c[a].sId==g)return c[a].sInstanceKey;return null};Owa.UIControls.VLV.prototype._getRowByInstanceKey=function Owa$UIControls$VLV$_getRowByInstanceKey(b){var a=this._getRowInfoByInstanceKey(b);return a?a.oRow:null};Owa.UIControls.VLV.prototype._insertRowInRowCache=function Owa$UIControls$VLV$prototype$_insertRowInRowCache(l,e,d,g){var m=g;this._updateRowInfoHashTables();var c=this.getRowInfos(),j=this.getData(l),o=!d&&this._isLastRow(e),a=e,f=[],h=d?e.iCacheIndex:e.iCacheIndex+2,n=h/2;if(this.isCnvVw()&&!d&&this._isExpandedConversation(e.sRowId)&&c.get_Length()>2){var b=e.iCacheIndex,k=c[b+2];while(k&&!this.isRowHeading(k.oRow)){b++;k=c[b+2]}a=c[b];g=c[b].oRow.get_OffsetHeight()+c[b+1].oRow.get_OffsetHeight();h=a.iCacheIndex+2}for(var b=0;b<2;b++){f.push(new RowInfo(l,new RowPosition(d?a.oRowPosition.iRow:a.oRowPosition.iRow+1,b),d?a.iViewPortOffset:a.iViewPortOffset+g,d?a.iChunkOffset:a.iChunkOffset+g,a.sSectionHeaderText,j.sId,j.sInstanceKey,d?a.iCacheIndex:a.iCacheIndex+2));a=c[a.iCacheIndex+1];var l=l.get_NextSibling()}c.splice(h,0,f[0],f[1]);this._rgHeaderRows.splice(n,0,f[0].oRow);for(var b=h+2;b<c.get_Length();b++){var i=c[b];i.oRowPosition.iRow++;i.iViewPortOffset+=m;i.iChunkOffset+=m;i.iCacheIndex+=2}this._oIdToRow[j.sId]=f[0];this._oInstanceKeyToRow[j.sInstanceKey]=f[0]};Owa.UIControls.VLV.prototype._isLastRow=function Owa$UIControls$VLV$prototype$_isLastRow(a){return this._rgHeaderRows[this._rgHeaderRows.get_Length()-1].get_Id()==a.sRowId};Owa.UIControls.VLV.prototype.getRowCacheSignature=function Owa$UIControls$VLV$prototype$getRowCacheSignature(){var b={rgChunks:[]},c=this._getDescendant(a);c.forEachChild(function(a){a.get_Id()==i&&b.rgChunks.add(a)});return b};Owa.UIControls.VLV.prototype.validateRowCache=function Owa$UIControls$VLV$prototype$validateRowCache(){var a=this.getRowCacheSignature();if(this._oRowCacheSignature!=null){if(this._oRowCacheSignature.rgChunks.length!=a.rgChunks.length){this.clearRowCache(a);return}for(var b=0;b<a.rgChunks.length;++b)if(!a.rgChunks[b].equals(this._oRowCacheSignature.rgChunks[b])){this.clearRowCache(a);return}}else this.clearRowCache(a)};Owa.UIControls.VLV.prototype.clearRowCache=function Owa$UIControls$VLV$prototype$clearRowCache(a){this._rgRowInfos=null;this._oIdToRow=null;this._oInstanceKeyToRow=null;this._rgHeaderRows=null;this._oRowCacheSignature=a};Owa.UIControls.VLV.prototype.scrollSingleRow=function Owa$UIControls$VLV$prototype$scrollSingleRow(c){if(this.iTC==0)return;ClientAction.add(ClientAction.Name.ScrollSingleRow);var b=this.getRowPosition(this.gtRw(this.oCurRowPosition.iRow,this.oCurRowPosition.iSubRow)),a=!c?this.getLastRowBeforeHeight(b):this.getFirstRowAfterHeight(b+5);this.gtLdTyp(a.iRow)==A&&this.posVwprt(a);this.updScr();this.prld()};Owa.UIControls.VLV.prototype.getFirstVisibleRow=function Owa$UIControls$VLV$getFirstVisibleRow(){var c=this._getDescendant(a),b=c.get_ScrollTop();return this.getFirstRowAfterHeight(b)};Owa.UIControls.VLV.prototype.getLastVisibleRow=function Owa$UIControls$VLV$getLastVisibleRow(){var c=this._getDescendant(a),b=c.get_ScrollTop()+this.gtVPH();return this.getLastRowBeforeHeight(b)};Owa.UIControls.VLV.prototype.getFirstRowAfterHeight=function Owa$UIControls$VLV$prototype$getFirstRowAfterHeight(a){return this.getRowAroundHeight(a,true)};Owa.UIControls.VLV.prototype.getLastRowBeforeHeight=function Owa$UIControls$VLV$prototype$getLastRowBeforeHeight(a){return this.getRowAroundHeight(a,false)};var y={VISIBLE:0,ABOVE_VIEWPORT:1,BELOW_VIEWPORT:2};Owa.UIControls.VLV.prototype._getRowPosition=function Owa$UIControls$VLV$prototype$_getRowPosition(e){var c=this.getRowPosition(e),d=this._getDescendant(a),b=d.get_ScrollTop();return b>c?y.ABOVE_VIEWPORT:c<b+this.gtVPH()?y.VISIBLE:y.BELOW_VIEWPORT};Owa.UIControls.VLV.prototype.getRowAroundHeight=function Owa$UIControls$VLV$prototype$getRowAroundHeight(e,f){for(var d=null,b=this.getRowInfos(),c=0,a=0;a<b.length;++a)if(b[a].sId!=j){if(b[a].iViewPortOffset>=e)return f?b[a].oRowPosition:b[c].oRowPosition;c=a}d=new RowPosition(this.ER(),0);return d};Owa.UIControls.VLV.prototype.isRowHeading=function Owa$UIControls$VLV$prototype$isRowHeading(a){return a.get_Id()==g};Owa.UIControls.VLV.prototype.isRow=function Owa$UIControls$VLV$prototype$isRow(c){var a=c.get_Id();return(a==g||a==j||a==b)&&c.get_IsShown()};Owa.UIControls.VLV.prototype.gtVPH=function Owa$UIControls$VLV$gtVPH(){if(!this.iVPH){var b=this._getDescendant(a);this.iVPH=b.get_ClientHeight()}return this.iVPH};Owa.UIControls.VLV.prototype.gtRwHt=function Owa$UIControls$VLV$gtRwHt(a){var c=a.get_OffsetHeight();if(a.get_Id()==g){a=a.get_NextSibling();while(a&&(a.get_Id()==j||a.get_Id()==b)){if(this.isRow(a))c+=a.get_OffsetHeight();a=a.get_NextSibling()}}return c};Owa.UIControls.VLV.prototype.getTypicalRowHeight=function Owa$UIControls$VLV$getTypicalRowHeight(){if(this._iTypicalRowHeight<=0)this._iTypicalRowHeight=this.getTotalChunkHeight()/(this.ER()-this.SR()+1);return this._iTypicalRowHeight};Owa.UIControls.VLV.prototype.getEstimatedViewHeight=function Owa$UIControls$VLV$prototype$getEstimatedViewHeight(){return this.getTypicalRowHeight()*(this.iTC-(this.ER()-this.SR()+1))+this.getTotalChunkHeight()};Owa.UIControls.VLV.prototype.getNumberOfItemsInTheViewport=function Owa$UIControls$VLV$getNumberOfItemsInTheViewport(){return Math.ceil(this.gtVPH()/this.getTypicalRowHeight())};Owa.UIControls.VLV.prototype.getCurrentViewTop=function Owa$UIControls$VLV$prototype$getCurrentViewTop(){if(this.oCurRowPosition.iRow==0&&this.oCurRowPosition.iSubRow==0)return 0;for(var b=this.getRowInfos(),a=0;a<b.length;++a)if(b[a].oRowPosition.equals(this.oCurRowPosition))return Math.floor(b[a].iViewPortOffset+this.SR()*this.getTypicalRowHeight());return Math.floor(this.gtVPH()+this.getTypicalRowHeight()*this.SR())};Owa.UIControls.VLV.prototype.getTotalChunkHeight=function Owa$UIControls$VLV$getTotalChunkHeight(){var b=this.getRowInfos(),a=b[b.length-1];return a?a.iViewPortOffset+a.oRow.get_OffsetHeight():0};Owa.UIControls.VLV.prototype.initChnk=function Owa$UIControls$VLV$initChnk(c){if(getInt(c.getAttribute(t))||getInt(c.getAttribute("fNull")))return;for(var b=c.getAllDescendantsById(g),a=0;a<b.get_Length();a++)this.oSel[this.getData(b.get_Item(a)).sId]&&this.oSel[this.getData(b.get_Item(a)).sId].fSel&&this.sel(b.get_Item(a),1)};Owa.UIControls.VLV.prototype.getData=function Owa$UIControls$VLV$getData(b){if(!b)return;var a=b;if(!b.hasCssClass("cData"))a=b.get_FirstChild();if(a.get_NodeType()==Owa.NodeType.Element){a.sId=a.get_Id().substring(1);var c=a.getAttribute("ik");a.sInstanceKey=c?c:0}return a};Owa.UIControls.VLV.prototype.fndRw=function Owa$UIControls$VLV$fndRw(c){var a;if(!a)a=c.getAncestorById(g,i);if(!a){a=c.getAncestorById(j,i);if(a)while(a&&a.get_Id()!=g)a=a.get_PreviousSibling()}if(!a)a=c.getAncestorById(b,i);return a};Owa.UIControls.VLV.prototype.findEntireRow=function Owa$UIControls$VLV$findEntireRow(d){var c=[],a=d.getAncestorById(g,i);if(a){c[0]=a;a=a.get_NextSibling();if(a&&a.get_Id()==j)c[1]=a}else{a=d.getAncestorById(j,i);if(a){c[1]=a;while(a&&a.get_Id()!=g)a=a.get_PreviousSibling();c[0]=a}else{a=d.getAncestorById(b,i);if(a)c[0]=a}}return c};Owa.UIControls.VLV.prototype.gtPrpV=function Owa$UIControls$VLV$gtPrpV(d,f){var h=this.getData(d),e=h.getAttribute(f);if(e)return e;var c=d.getDescendantById(f);while(!c&&d.get_NextSibling()&&d.get_NextSibling().get_Id()==j){d=d.get_NextSibling();c=d.getDescendantById(f)}if(!c)return null;e=c.getAttribute("v");if(e)return e;var g=1;if(c._oDomNode){var a=c._oDomNode;if(a.tagName=="SELECT"){g=a.selectedIndex+1;a=a[a.selectedIndex]}if(f=="ea"){var b={};b._em=a.getAttribute("em");b._uri=a.getAttribute("uri");b._dn=a.getAttribute("dn");b._ao=a.getAttribute("aO");b._rf=a.getAttribute("rf");b._rt=a.getAttribute("rt");b._lgDn=a.getAttribute("lgDn");b._ei=a.getAttribute("aO")==AO_S&&a.getAttribute("rt")!=RT_PDL?g:0;b._mo=a.getAttribute("mo");if(!b._uri&&isMSNPrv())b._uri=b._em;return b}}return c.get_TextContent()};Owa.UIControls.VLV.prototype.rmvRw=function Owa$UIControls$VLV$rmvRw(d,n){if(this.oSel[d]){this.oSel[d].fSel=false;!n&&this.feSelChg(d,0,1);delete this.oSel[d]}this.get_SelectionAnchorId()==d&&this.set_SelectionAnchorId(0);if(this.sLstSel==d)this.sLstSel=0;var a=this.gtRwById(d);if(!a)return;this.clearRowCache();if(a.get_Id()!=g){a.remove(true);return}var f=this.fndChnk(a),m=this.fndGH(a),h=a.get_NextSibling();while(h&&h.get_Id()==j){h.remove(true);h=a.get_NextSibling()}this.iTC--;if(this.isCnvVw&&this.isCnvVw()&&this.isRowHeading(a)){var l=[d];this.iTIC-=this.gtCnvTC(l);this.iUC-=this.gtCnvUC(l,1)}else this.iTIC--;if(a.get_Id()==b){var i=this.gtPrpV(a,"pId"),k=false,c=a.get_PreviousSibling();while(c&&c.get_Id()==b){if(this.gtPrpV(c,"pId")==d){c.setAttribute("pId",i);k=true}c=c.get_PreviousSibling()}if(!k){var c=a.get_NextSibling();while(c&&c.get_Id()==b){this.gtPrpV(c,"pId")==d&&c.setAttribute("pId",i);c=c.get_NextSibling()}}}a.remove(true);m&&this.rmvG(m);var e=f.get_NextSibling();while(e){e.setIntAttribute("iSR",e.getIntAttribute("iSR")-1);e.setIntAttribute("iER",e.getIntAttribute("iER")-1);e=e.get_NextSibling()}f.setIntAttribute("iER",f.getIntAttribute("iER")-1);f.getIntAttribute("iER")<f.getIntAttribute("iSR")&&f.remove(true)};Owa.UIControls.VLV.prototype.fndGH=function Owa$UIControls$VLV$fndGH(b){b=b.getAncestorById("gc",a);if(b)return b.get_PreviousSibling()};Owa.UIControls.VLV.prototype._getGroupHeaderHeight=function Owa$UIControls$VLV$_getGroupHeaderHeight(a){if(!a)a=this.getRowInfoFromPosition(new RowPosition(0,0)).oRow;if(!this._iGHHeight){var b=this.fndGH(a);this._iGHHeight=b?b.get_OffsetHeight():0}return this._iGHHeight};Owa.UIControls.VLV.prototype._getRowHeaderText=function Owa$UIControls$VLV$prototype$_getRowHeaderText(b){var a=this.fndGH(b);return!a?"":a.get_TextContent()};Owa.UIControls.VLV.prototype.rmvG=function Owa$UIControls$VLV$rmvG(b){var a=b.get_NextSibling(),c=a.getChildById(Kb);if(c.hasChildNodes())return;a.remove(true);b.remove(true)};Owa.UIControls.VLV.prototype.fndChnk=function Owa$UIControls$VLV$fndChnk(b){return b.getAncestorById(i,a)};Owa.UIControls.VLV.prototype.gtRwChld=function Owa$UIControls$VLV$gtRwChld(a,c){var b=a.getDescendantById(c);if(!b){a=a.get_NextSibling();while(!b&&a&&a.get_Id()==j){b=a.getDescendantById(c);a=a.get_NextSibling()}}return b};Owa.UIControls.VLV.prototype.addLVSt=function Owa$UIControls$VLV$addLVSt(){};Owa.UIControls.VLV.prototype.shwPrgrs=function Owa$UIControls$VLV$shwPrgrs(e){var b=this._get_Element();this.iPrgT=0;var a=this._getDescendant(R);a.set_Height(b.get_ClientHeight());a.set_Width(b.get_ClientWidth());a.moveToTop();a.set_IsShown(true);var a=this._getDescendant(S),c;switch(e){case m:c="L_Ldng";break;case v:c="L_Srchng";break;case H:c="L_Fltrng"}a.getChildById("spnTxt").set_TextContent(b.getAttribute(c));a.set_Top(-1e4);a.set_Left(-1e4);a.set_IsShown(true);var d=0;a.forEachChild(function(a){d+=a.get_OffsetWidth()});a.set_Width(d+a._get_EffectivePaddingBorderWidth());a.set_Top((b.get_ClientHeight()-a.get_ClientHeight())/2);a.set_Left((b.get_ClientWidth()-a.get_ClientWidth())/2);a.moveToTop()};Owa.UIControls.VLV.prototype.cnclPrgrs=function Owa$UIControls$VLV$cnclPrgrs(){if(this.iPrgT){this._clearTimeout(this.iPrgT);this.iPrgT=0}this._getDescendant(R).set_IsShown(false);this._getDescendant(S).set_IsShown(false)};Owa.UIControls.VLV.prototype.strtLd=function Owa$UIControls$VLV$strtLd(b,a){if(this.isLoadBlocked()||this.rgPndLd.get_Length()&&!this._fQLd){this.enqOp(b,a);return 0}else{this.fPndLd=1;this._iLastLoadActionTime=(new Date).valueOf();return 1}};Owa.UIControls.VLV.prototype.shouldClearPendingRequests=function(b,a){return this.fPndLd&&(b||isDf(typeof a)&&a=="manualrefresh"&&(this._iLastLoadActionTime>0&&(new Date).valueOf()>this._iLastLoadActionTime+60*1e3))};Owa.UIControls.VLV.prototype.clearPendingRequests=function Owa$UIControls$VLV$clearPendingRequests(){Owa.Components.OehRequest.abortOehRequests(Owa.Dom.AjaxRequest.AbortCriterion.NameSpaceAndCommand,this.sEvtNS,{LoadFresh:1,LoadNext:1,LoadPrevious:1,SeekNext:1,SeekPrevious:1,Sort:1,TypeDown:1});this.cnclPrgrs();this.rgPndLd=[];this.fPndLd=0};Owa.UIControls.VLV.prototype.enqOp=function Owa$UIControls$VLV$enqOp(b,d){if(k[b]>0){var a=0;while(a<this.rgPndLd.get_Length())if(this.rgPndLd[a]&&(k[this.rgPndLd[a].sFn]<=1||k[this.rgPndLd[a].sFn]==k[b]))this.rgPndLd.splice(a,1);else a++}var c={};c.sFn=b;c.rgArgs=d;this.rgPndLd.push(c)};Owa.UIControls.VLV.prototype.endLd=function Owa$UIControls$VLV$endLd(){if(this.fPndLd){this.fPndLd=0;this._setTimeout(this.dequeueLoadOperations,1)}};Owa.UIControls.VLV.prototype.dequeueLoadOperations=function Owa$UIControls$VLV$dequeueLoadOperations(){while(this.rgPndLd.get_Length()>0&&!this.isLoadBlocked()){var a=this.rgPndLd.shift();this._fQLd=1;this[a.sFn].apply(this,a.rgArgs);this._fQLd=0}};Owa.UIControls.VLV.prototype.isLoadBlocked=function Owa$UIControls$VLV$isLoadBlocked(){return this.fPndLd||this.hasPendingOperations()};Owa.UIControls.VLV.prototype.isPrefetchEnabled=function Owa$UIControls$VLV$isPrefetchEnabled(){return false};Owa.UIControls.VLV.prototype.shouldUseCachedMessage=function Owa$UIControls$VLV$shouldUseCachedMessage(){return false};Owa.UIControls.VLV.prototype.hasPendingOperations=function Owa$UIControls$VLV$prototype$hasPendingOperations(){return this._fPendingOperations};Owa.UIControls.VLV.prototype.cbAsyncOperationsStarted=function Owa$UIControls$VLV$prototype$cbAsyncOperationsStarted(a){if(a!=this.get_ContextFolderId())return;this._fPendingOperations=true};Owa.UIControls.VLV.prototype.cbAsyncOperationsComplete=function Owa$UIControls$VLV$prototype$cbAsyncOperationsComplete(a){if(a!=this.get_ContextFolderId())return;try{this._fPendingOperations=false;if(this._fnOnAsyncOperationsComplete){this._fnOnAsyncOperationsComplete();this._fnOnAsyncOperationsComplete==null}}finally{this._fPendingOperations=false;this.dequeueLoadOperations()}};Owa.UIControls.VLV.prototype.cbEmptyFolder=function Owa$UIControls$VLV$cbEmptyFolder(a){if(this.get_IsDisposed())return;if(a!=this.get_DataFolderId())return;this.emptyView()};Owa.UIControls.VLV.prototype.emptyView=function Owa$UIControls$VLV$emptyView(){var d=this._getDescendant(a),g=d.get_ParentElement();g.removeChild(d);d.set_InnerHtml("");var c=h.get_Current().createElement("DIV");c.set_Id(i);c.set_CssClasses([zb]);c.setIntAttribute(t,1);var e=h.get_Current().createElement("DIV");e.set_Id(Eb);e.set_TextContent(L_NoItems);c.appendChild(e);d.appendChild(c);g.appendChild(d);this.initChnk(c);var b=h.get_Current().createElement("DIV");b.set_Id(r);b.setIntAttribute(o,0);b.setIntAttribute(D,0);b.setIntAttribute(n,0);b.setAttribute(V,this.get_DataFolderId());b.setIntAttribute(F,this.fCV);b.setIntAttribute(C,this.fFUR);var f=h.get_Current().createElement("DIV");f.appendChild(b);this.prcsDta(f)};Owa.UIControls.VLV.prototype._fixScrollbarWidth=function Owa$UIControls$VLV$_fixScrollbarWidth(){if(c.isFirefox()){var b=this._getDescendant(s);b.set_Width(100);var d=b.get_OffsetWidth()-b.get_ClientWidth()+1;b.set_Width(d);if(g_fRtl)this._getDescendant(a).set_Left(d);else this._getDescendant(a).set_Right(d)}};Owa.UIControls.FldrVLV=function Owa$UIControls$FldrVLV(a,b){Owa.UIControls.FldrVLV.constructBase(this,[a,b]);this.fFltrdVw=0};Owa.UIControls.FldrVLV.createClass("Owa.UIControls.FldrVLV",Owa.UIControls.VLV);var Mb=B.FldrVLV.prototype;Owa.UIControls.FldrVLV.prototype.initialize=function Owa$UIControls$FldrVLV$initialize(){Owa.UIControls.FldrVLV.callBase(this,"initialize")};Owa.UIControls.FldrVLV.prototype.isFldr=function Owa$UIControls$FldrVLV$isFldr(){return 1};Owa.UIControls.FldrVLV.prototype.onMouseOver=function Owa$UIControls$FldrVLV$onMouseOver(b){var c=b.get_Target(),a=this.fndFlg(c);if(!a)a=this.fndCat(c);if(a)if(b.get_Type()=="mouseout")a.removeCssClass(kb);else a.addCssClass(kb);Owa.UIControls.FldrVLV.callBase(this,"onMouseOver",[b])};Owa.UIControls.FldrVLV.prototype.fltrVw=function Owa$UIControls$FldrVLV$fltrVw(a,b){this._oPrevFilterCriteria=null;this._oFilterCriteria=a;this._cbFilterCallback=b;if(this._oFilterCriteria.get_isValid()){this.clrSel(1);this.ldFrsh(0,H,1,this.cbFltrVw,this.cbEnblFltrVw)}else this.dsblFltrVw()};Owa.UIControls.FldrVLV.prototype.get_FilterViewCriteria=function Owa$UIControls$FldrVLV$get_FilterViewCriteria(){return this._oFilterCriteria};Owa.UIControls.FldrVLV.prototype.enblFltrVw=function Owa$UIControls$FldrVLV$enblFltrVw(){if(this.isInFltrdVw())return;ClientAction.add(ClientAction.Name.Filter);this._oFilterCriteria=this._oPrevFilterCriteria;var a=this._oFilterCriteria.get_isValid();if(!a){this.dsblFltrVw();return}this.clrSel(1);this.ldFrsh(0,H,1,this.cbFltrVw,this.cbEnblFltrVw)};Owa.UIControls.FldrVLV.prototype.dsblFltrVw=function Owa$UIControls$FldrVLV$dsblFltrVw(){if(!this._oFilterCriteria||!this.isInFltrdVw())return;ClientAction.add(ClientAction.Name.ClearFilter);this.clrSel(1);this._oPrevFilterCriteria=this._oFilterCriteria;this._oFilterCriteria=null;this.ldFrsh(0,m,1,this.cbFltrVw,this.cbDsblFltrVw)};Owa.UIControls.FldrVLV.prototype.cbEnblFltrVw=function Owa$UIControls$FldrVLV$cbEnblFltrVw(a){a.fFltrdVw=1};Owa.UIControls.FldrVLV.prototype.cbDsblFltrVw=function Owa$UIControls$FldrVLV$cbDsblFltrVw(a){a.fFltrdVw=0};Owa.UIControls.FldrVLV.prototype.cbFltrVw=function Owa$UIControls$FldrVLV$cbFltrVw(a,c){var b=a.gtRws();b.get_Length()>0&&a.selSngl(b.get_Item(0));isDf(typeof a._cbFilterCallback)&&a._cbFilterCallback(a,c)};Owa.UIControls.FldrVLV.prototype.isInFltrdVw=function Owa$UIControls$FldrVLV$isInFltrdVw(){return this.fFltrdVw};Owa.UIControls.FldrVLV.prototype.prcsDta=function Owa$UIControls$FldrVLV$prcsDta(a){Owa.UIControls.FldrVLV.callBase(this,"prcsDta",[a])};Owa.UIControls.FldrVLV.prototype.addFltrVwSt=function Owa$UIControls$FldrVLV$addFltrVwSt(a){if(!this._oFilterCriteria)return;this._oFilterCriteria.addStatement(a,this.sSid)};Owa.UIControls.FldrVLV.prototype.addLVSt=function Owa$UIControls$FldrVLV$addLVSt(b){var a=new oeSt(b,"FVLVS");a.add("sId",this.sSid);a.add("mL",this.fML);a.add("sC",this.iSC);a.add("sO",this.iSO);b.addSt("St",a);this.addFltrVwSt(b);this.fSrch&&this.fnGtSF(b);this.iFltr&&b.add("fltr",this.iFltr)};Owa.UIControls.FldrVLV.prototype.onMD=function Owa$UIControls$FldrVLV$onMD(a){var d=a.get_Target(),c=this.fndRw(d),b=this.getData(c);if(this.fndFlg(d)&&a.isLeftButtonDown()){var e=FA_MrkCmpl,h;if(!this.isSel(c))h=b.sId;this.oMU=0;var g=b.getAttribute("sFS"),f=b.getAttribute("sFA");if(g&&getInt(g)||!Owa.UIControls.FlagContextMenu.isFlagAction(isDf(typeof f)?getInt(f):0))e=FA_Dflt;this.flgItms(e,0,h)}else if(this.fndCat(d)){!this.isSel(c)&&this.selSngl(c,false,true);this.shwCatMnu(a.get_ClientX(),a.get_ClientY())}else if(b&&this.sExpId&&this.sExpId==b.sId)return;else Owa.UIControls.FldrVLV.callBase(this,"onMD",[a])};Owa.UIControls.FldrVLV.prototype.onCMVP=function Owa$UIControls$FldrVLV$onCMVP(a){if(a.isCtrlKeyDown()){a.preventDefault();a.cancelBubble();return}var b=a.get_Target();if(this.fndFlg(b))this.shwFlgMnu(a.get_ClientX(),a.get_ClientY());else if(this.fndCat(b))return;else Owa.UIControls.FldrVLV.callBase(this,"onCMVP",[a])};Owa.UIControls.FldrVLV.prototype.emptyFolder=function Owa$UIControls$FldrVLV$emptyFolder(){g_oFldrMgr.emptyFld(this,this.sSid)};Owa.UIControls.FldrVLV.prototype.shwFlgMnu=function Owa$UIControls$FldrVLV$shwFlgMnu(l,m,g){var a=Owa.UIControls.FlagContextMenu.get_Instance(true),j=this;a.get_OnSelectFlag().add(function(a){j.flgItms(a.sCommand,a.dtDate)});var d=this.gtSelCnt();a.set_SelectCount(d);if(d==1){var k=this.gtSel(),n=this.gtRwById(k.get_Item(0)),b=this.getData(n),e=b.getAttribute("sFA"),i=e?getInt(e):0;a.set_FlagAction(i);a.set_IsOnConversationHeader(b.getAttribute("t")=="IPM.Conversation");var c=b.getAttribute("sFlgDt"),f=c?new Date(c):0;f&&a.set_DueDate(f);var h=isOfClss(b.getAttribute("t"),"IPM.Task");a.set_IsSelectedItemTask(h)}a.set_FlagButton(g);a.show(l,m)};Owa.UIControls.FldrVLV.prototype.flgItms=function Owa$UIControls$FldrVLV$flgItms(g,f,d){addPerfMarker("FldrVLV.FlgItms.Start");var a=[d];if(!d)a=this.gtSel();var e=getInt(g);if(e==FA_DtRem){var h=this,i=function(b,e,c,d,a){h.onClsFD(b,e,c,d,a)};Owa.UIControls.FlagDialog.loadInstanceAndShow(i,a.get_Item(0));return}if(a.length==0)return;var b={};b.rgItms=a;b.iFA=e;b.fSI=!!d;var c=new oeReq(this.sEvtNS,"flgItms",b,this._createCallback(this.cbFlgItms));c.addRg("Itms",a);c.add("flga",g);f&&c.add("ddt",f);c.send()};Owa.UIControls.FldrVLV.prototype.cbFlgItms=function Owa$UIControls$FldrVLV$cbFlgItms(d){if(!cbOeh(d))return;eval(d.sBody);for(var c=d.oCtx,f=c.rgItms,h=c.fSI,i=c.iFA,g=false,b=0;b<f.get_Length();++b){var a=f.get_Item(b),k=this.gtRwById(a);if(!k)continue;h&&this.selRwById(a);if(sCR.charAt(b)!="1")continue;dtDD&&this.stRwPrp(a,"sFlgDt",dtDD);var j=this.gtRwPrp(a,"t");if(i==FA_ClrFlg&&(isOfClss(j,IT_TSK)||this.get_SubPage().get_IsFlaggedMailAndTasks()))this.rmvRws([a]);else this.flgItm(i,a);if(this.oSel[a])g=true}var e=window.parent;e&&e.stDrty&&isDf(typeof a_sTsks)&&a_sTsks&&e.stDrty(a_sTsks,0);!h&&g&&this._setTimeout(this.feSelChg,100);addPerfMarker("FldrVLV.CbFlgItms.End")};Owa.UIControls.FldrVLV.prototype.flgItm=function Owa$UIControls$FldrVLV$flgItm(c,e){var b="icon-flag.gif";if(c==FA_MrkCmpl)b="flg-compl.gif";else if(c==FA_ClrFlg)b="flg-empty.gif";var a=this.getData(this.gtRwById(e));if(a!=null){a.setIntAttribute("sFA",c);a.setIntAttribute("sFS",0);var d=a.get_ParentElement().getDescendantById("imgFlg");d&&Owa.Components.CssSprites.updateImage(d,b)}};Owa.UIControls.FldrVLV.prototype.onClsFD=function Owa$UIControls$FldrVLV$onClsFD(c,b,d,e,a){this.flgItm(c,b);a&&this.stRwPrp(b,"sFlgDt",a);this.feSelChg()};Owa.UIControls.FldrVLV.prototype.fndFlg=function Owa$UIControls$FldrVLV$fndFlg(b){return b.getAncestorById(Db,a)};Owa.UIControls.FldrVLV.prototype.shwCatMnu=function Owa$UIControls$FldrVLV$shwCatMnu(k,l,g){var a=Owa.UIControls.CategoryMenu.get_Instance(true),f=this,i=function(a){f.onSelCat(a.rgAdd,a.rgRem)},h=function(){f.onClrCat()};a.set_ItemType(this.getSubPageVariable("a_iT"));a.set_FolderId(this.sSid);a.get_OnChangeCategory().add(i);a.get_OnClearCategory().add(h);this.rgCatSelItms=this.gtSel();for(var d=[],c=0;c<this.rgCatSelItms.get_Length();c++){var e=[],j=this.gtRwChld(this.gtRwById(this.rgCatSelItms.get_Item(c)),U),b=j.getAttribute("title");if(b&&b.length)e=b.split(";");d.add(e)}a.updateStates(d,g);a.show(k,l)};Owa.UIControls.FldrVLV.prototype.onSelCat=function Owa$UIControls$FldrVLV$onSelCat(b,c){var a=new oeReq(this.sEvtNS,"catItms",this.rgCatSelItms,this._createCallback(this.cbSelCat));a.addRg("Itms",this.rgCatSelItms);a.addRg("catAdd",b);a.addRg("catRem",c);a.add("fId",this.sSid);a.send()};Owa.UIControls.FldrVLV.prototype.cbSelCat=function Owa$UIControls$FldrVLV$cbSelCat(b){if(!cbOeh(b))return;this.feSelChg(this.gtSel()[0],true);eval("var ci;");ci=function(a,b){return{sSwtch:a,sTtl:b}};eval(b.sBody);for(var c=b.oCtx,a=0;a<c.get_Length();++a)if(sCR.charAt(a)=="1"){var d=rgItmCats.get_Item(a);this.stItmCats(c.get_Item(a),d.sTtl,d.sSwtch)}addPerfMarker("FldrVLV.CbSelCat.End")};Owa.UIControls.FldrVLV.prototype.onClrCat=function Owa$UIControls$FldrVLV$onClrCat(){var a=new oeReq(this.sEvtNS,"catClr",this.rgCatSelItms,this._createCallback(this.cbClrCat));a.addRg("Itms",this.rgCatSelItms);a.send()};Owa.UIControls.FldrVLV.prototype.cbClrCat=function Owa$UIControls$FldrVLV$cbClrCat(b){if(!cbOeh(b))return;var c=b.oCtx;eval(b.sBody);for(var a=0;a<c.get_Length();++a)sCR.charAt(a)=="1"&&this.stItmCats(c.get_Item(a),"",sECS);this.feSelChg()};Owa.UIControls.FldrVLV.prototype.stItmCats=function Owa$UIControls$FldrVLV$stItmCats(e,d,c){var b=this.gtRwById(e);if(!b)return;var a=this.gtRwChld(b,U);a.setAttribute("title",d);a.set_InnerHtml(c)};Owa.UIControls.FldrVLV.prototype.fndCat=function Owa$UIControls$FldrVLV$fndCat(b){return b.getAncestorById(vb,a)};Owa.UIControls.MsgVLV=function Owa$UIControls$MsgVLV(c,b){Owa.UIControls.MsgVLV.constructBase(this,[c,b]);var a=b;this.iUC=a.getIntAttribute(n);this.fCV=getInt(a.getAttribute(F));this.fFUR=getInt(a.getAttribute(C));this.fOutlookFUR=getInt(a.getAttribute("fOutlookFUR"));this.fJnk=!!getInt(a.getAttribute("fJnk"));this.fPndExp=0;this._oPipe=null;this._MapMsToCs=null;this._MapCsToMs=null;this.initSortMappings()};Owa.UIControls.MsgVLV.createClass("Owa.UIControls.MsgVLV",Owa.UIControls.FldrVLV);var Nb=B.MsgVLV.prototype;Owa.UIControls.MsgVLV.prototype.initialize=function Owa$UIControls$MsgVLV$initialize(){Owa.UIControls.MsgVLV.callBase(this,"initialize");this._showFilteredByUnreadPont()};Owa.UIControls.MsgVLV.prototype.dispose=function Owa$UIControls$MsgVLV$dispose(){this.onCnvVwChg=null;this.onRfExp=null;Owa.UIControls.MsgVLV.callBase(this,"dispose")};Owa.UIControls.MsgVLV.prototype.stOnCnvVwChg=function Owa$UIControls$MsgVLV$stOnCnvVwChg(a){this.onCnvVwChg=a};Owa.UIControls.MsgVLV.prototype.stOnRfExp=function Owa$UIControls$MsgVLV$stOnRfExp(a){this.onRfExp=a};Owa.UIControls.MsgVLV.prototype.onDblClkVP=function Owa$UIControls$MsgVLV$onDblClkVP(a){if(this._shouldExpandConvo(a))this.expCnv(a);else Owa.UIControls.MsgVLV.callBase(this,"onDblClkVP",[a])};Owa.UIControls.MsgVLV.prototype.onKD=function Owa$UIControls$MsgVLV$onKD(a){if(Owa.Dom.Input.isInstance(a.get_Target())&&!a.get_Target().hasCssClass("offscreen"))return;if(a.get_KeyCodeForKeyUpDown()==Owa.KeyCodes.ENTER&&this._shouldExpandConvo(a))this.expCnv(a);else Owa.UIControls.MsgVLV.callBase(this,"onKD",[a])};Owa.UIControls.MsgVLV.prototype.onMD=function Owa$UIControls$MsgVLV$onMD(a){var b=a.get_Target();if(this.fndExp(b)&&a.isLeftButtonDown()&&this._shouldExpandConvo(a))this.expCnv(a);else Owa.UIControls.MsgVLV.callBase(this,"onMD",[a])};Owa.UIControls.MsgVLV.prototype.onClkHdr=function Owa$UIControls$MsgVLV$onClkHdr(a){this._computeABMCtxMnu(a);Owa.UIControls.MsgVLV.callBase(this,"onClkHdr",[a])};Owa.UIControls.MsgVLV.prototype.onCMHdr=function Owa$UIControls$MsgVLV$onCMHdr(a){this._computeABMCtxMnu(a);Owa.UIControls.MsgVLV.callBase(this,"onCMHdr",[a])};Owa.UIControls.MsgVLV.prototype._computeABMCtxMnu=function Owa$UIControls$MsgVLV$_computeABMCtxMnu(i){var j=i.get_Target(),c=this.isCnvVw&&this.isCnvVw();if(j.getAncestorById("tdAB",p)&&this._get_ABM())for(var g=this._get_ABM().getAllMenuItems(),e=0;e<g.length;e++){var a=g[e],b=a.getAttribute("_cid");if(b==f.FlagDueDate||b==f.FlagStartDate)a.set_IsShown(c?false:true);else if(b==d.ConversationFlagStaus)a.set_IsShown(c?true:false);else a.get_Id()=="gbyCnv"&&this._get_ABM().replaceMenuItemIcon(a.get_Id(),c?"chk-chkd.gif":"chk-unchk.gif");if(this.doesMIMatchSC(c,b)){var h=a.getDescendantById("imgI");Owa.Components.CssSprites.updateImage(h,"flg-compl.gif")}else if(b){var h=a.getDescendantById("imgI");Owa.Components.CssSprites.updateImage(h,"clear.gif")}}};Owa.UIControls.MsgVLV.prototype.doesMIMatchSC=function Owa$UIControls$MsgVLV$doesMIMatchSC(b,a){if(b){if(a==d.ConversationFlagStaus&&a==this.iSC)return true;else if(a==this._MapCsToMs[this.iSC])return true}else if(a==this.iSC)return true;return a==f.SentDate&&(this.iSC==f.Date||this.iSC==d.ConversationLastDeliveryTime)?true:false};Owa.UIControls.MsgVLV.prototype.onClkABM=function Owa$UIControls$MsgVLV$onClkABM(a){if(!a.oMenuItem)return;var b=a.oMenuItem,c=a.oMenu;if(b.get_Id()=="gbyCnv")this.toggleConversationMode();else Owa.UIControls.MsgVLV.callBase(this,"onClkABM",[a])};Owa.UIControls.MsgVLV.prototype.toggleConversationMode=function Owa$UIControls$MsgVLV$toggleConversationMode(){var a=this._get_ABM().getMenuItem("gbyCnv"),b=a.getIntAttribute("isCnv"),c=!b&&a.getDescendantById("imgI").hasCssClass("sprites-chk-unchk-gif")||b&&a.getDescendantById("imgI").hasCssClass("sprites-chk-chkd-gif");this._get_ABM().replaceMenuItemIcon(a.get_Id(),b?"chk-unchk.gif":"chk-chkd.gif");a.setIntAttribute("isCnv",b?0:1);this.srt(this.iSC,this.iSO,c)};Owa.UIControls.MsgVLV.prototype.initSortMappings=function Owa$UIControls$MsgVLV$initSortMappings(){if(this._MapMsToCs==null){var a={};a[f.Type]=d.ConversationMessageClasses;a[f.From]=d.ConversationMVFrom;a[f.To]=d.ConversationMVTo;a[f.Subject]=d.ConversationTopic;a[f.HasAttachment]=d.ConversationHasAttach;a[f.Importance]=d.ConversationImportance;a[f.Date]=d.ConversationLastDeliveryTime;a[f.SentDate]=d.ConversationLastDeliveryTime;a[f.Size]=d.ConversationSize;a[f.FlagDueDate]=d.ConversationFlagStaus;a[f.FlagStartDate]=d.ConversationFlagStaus;this._MapMsToCs=a}if(this._MapCsToMs==null){var b={};b[d.ConversationMessageClasses]=f.Type;b[d.ConversationMVFrom]=f.From;b[d.ConversationMVTo]=f.To;b[d.ConversationTopic]=f.Subject;b[d.ConversationHasAttach]=f.HasAttachment;b[d.ConversationImportance]=f.Importance;b[d.ConversationLastDeliveryTime]=f.Date;b[d.ConversationSize]=f.Size;b[d.ConversationFlagStaus]=f.FlagDueDate;this._MapCsToMs=b}};Owa.UIControls.MsgVLV.prototype.srt=function Owa$UIControls$MsgVLV$srt(d,f,e){var a;if(this._get_ABM())a=this._get_ABM().getMenuItem("gbyCnv");var c=a&&a.getIntAttribute("isCnv"),b=c?this._MapMsToCs[d]:this._MapCsToMs[d];if(b==undefined)b=d;if(this.sExpId&&this.sExpId!=""&&!c){var g=this.gtRwById(this.sExpId);this.expRw(0);this.selSngl(g,false,false)}c&&this.clrSel(1);Owa.UIControls.MsgVLV.callBase(this,"srt",[b,f,e])};Owa.UIControls.MsgVLV.prototype._shouldExpandConvo=function Owa$UIControls$MsgVLV$_shouldExpandConvo(c){var b=this._findRowFromEventTarget(c);if(!b)return;var a=this.getData(b),d=this.gtCnvGC([a.sId]);return Ews.BaseId.IsOwaCnvId(a.sId)&&d>1};Owa.UIControls.MsgVLV.prototype._findRowFromEventTarget=function Owa$UIControls$MsgVLV$_findRowFromEventTarget(c){var d=c.get_Type(),e=d.contains("mouse")||d.contains("click"),a;if(e)a=this.fndRw(c.get_Target());else if(this.sLstSel){var b=this._getOIdToRow()[this.sLstSel];if(b)a=b.oRow}return a};Owa.UIControls.MsgVLV.prototype.expCnv=function Owa$UIControls$MsgVLV$expCnv(c){var b=this._findRowFromEventTarget(c),a=this.getData(b);if(this.gtCnvGC([a.sId])<=1)return;if(this.sExpId&&this.sExpId==a.sId){this.expRw(0);this.selSngl(b);this.feSelChg(a.sId,0,1);return}addPerfMarker("MsgVLV.expand");this.selSngl(b);this.expRw(0);this.exp(a.sId)};Owa.UIControls.MsgVLV.prototype.gtUC=function Owa$UIControls$MsgVLV$gtUC(){return this.iUC};Owa.UIControls.MsgVLV.prototype.isCnvVw=function Owa$UIControls$MsgVLV$isCnvVw(){return this.fCV};Owa.UIControls.MsgVLV.prototype.isFilteredByUnread=function Owa$UIControls$MsgVLV$isFilteredByUnread(){return this.fOutlookFUR||this.fFUR};Owa.UIControls.MsgVLV.prototype._isExpandedConversation=function Owa$UIControls$MsgVLV$_isExpandedConversation(a){return this.sExpId?this.sExpId==a:false};Owa.UIControls.MsgVLV.prototype.feSelChg=function Owa$UIControls$MsgVLV$feSelChg(a,c,d){if(!this.isCnvVw()){Owa.UIControls.MsgVLV.callBase(this,"feSelChg",[a,c]);return}this._clearPreviewUpdateTimer();if(this.onSelChg){var b={};if(a&&this.oSel[a]){if(this.oSel[a].sCnvId){b.sMid=this.oSel[a].sCnvId;b.sIid=a;b.fExp=1}else b.sMid=a;b.fSel=this.oSel[a].fSel;b.fDontUdRP=d}this.onSelChg(b)}};Owa.UIControls.MsgVLV.prototype.feCnvVwChg=function Owa$UIControls$MsgVLV$feCnvVwChg(a){this._emptyPrefetchList();if(this.onCnvVwChg)this.onCnvVwChg(a)};Owa.UIControls.MsgVLV.prototype.feRfExp=function Owa$UIControls$MsgVLV$feRfExp(){this.onRfExp&&this.onRfExp()};Owa.UIControls.MsgVLV.prototype.setSel=function Owa$UIControls$MsgVLV$setSel(b){var g=this.get_ItemIdInReadingPane();if(g&&!(this.sExpId&&this.sExpId==g))return;var a=this.gtRwById(this.sExpId),e=this.gtSelCnt();if(this.isSel(a)&&e>1){this.sel(a,1);return}else if(!(this.isSel(a)&&e==1||this.isSelExp()||e==0))return;this.unSelRemaining(b,1);if(b){for(var d,f=0;f<b.get_Length();f++){var c=this.gtRwById(b.get_Item(f));if(c&&!this.isSel(c)){d=c;this.sel(c,1)}}d&&this.feSelChg(this.getData(d).sId)}this.gtSelCnt()==0&&this.isSel(a)&&this.selSngl(a)};Owa.UIControls.MsgVLV.prototype.mkRd=function Owa$UIControls$MsgVLV$mkRd(b,a){this.stRS(b,1,a)};Owa.UIControls.MsgVLV.prototype.mkRdIP=function Owa$UIControls$MsgVLV$mkRdIP(e,c,a){var b=this.gtRwById(a);if(b&&this.sExpId&&a==this.sExpId)this.stRS(e,1);else if(c==this.sSid){if(b){var d=getInt(this.gtRwPrp(a,n))-1;this.stCnvCts(a,b,d,-1,-1)}this.iUC--;this.feERfrsh()}};Owa.UIControls.MsgVLV.prototype.mkUnrd=function Owa$UIControls$MsgVLV$mkUnrd(c,a,b){if(a===null||a===undefined)a=-1;this.stRS(c,a,b)};Owa.UIControls.MsgVLV.prototype.mkAllRd=function Owa$UIControls$MsgVLV$mkAllRd(){var b=this._getDescendant(a).getAllDescendantsById(g);if(!b)return;if(!("length"in b))b=[b];for(var c=0;c<b.get_Length();c++)this.mkRd(this.getData(b.get_Item(c)).sId);this.iUC=0;this.feERfrsh()};Owa.UIControls.MsgVLV.prototype.cnvDel=function Owa$UIControls$MsgVLV$cnvDel(b,f,i,c,h,e,d){e&&this.isSelExp()&&this.selSngl(this.gtRwById(b[0]));var j=this.gtRwById(b.get_Item(0));if(!j){g_fDeleteInProgress=0;return}if(j.get_Id()==g){var l=this.getData(j),k=this.gtCnvTC(new Array(l.sId));if(!e&&cb&a_iEnblPnt&&k>1){var a={};a.rg=b;a.oMM=f;a.fRf=c;a.fP=i;a.cb=h;a.rgUIRemove=d;var m=this,n=function(a,b){m.cbDelCnvPont(a,b)};shwPont(cb,L_DelCnv,L_WrnDlFlTtl,[L_OK,L_Cncl],0,n,a)}else h(i,b,f,0,c,0,e,0,d)}else{c|=this.cnvDelCpMv(b,-1,0,1,c,d);h(i,b,f,0,c,1,e,0,d)}};Owa.UIControls.MsgVLV.prototype.cbDelCnvPont=function Owa$UIControls$MsgVLV$cbDelCnvPont(c,a){var b=c==-1||c==1;if(!b)a.fRf|=this.cnvDelCpMv(a.rg,-1,0,0,a.fRf,a.rgUIRemove);a.cb(a.fP,a.rg,a.oMM,0,a.fRf,1,0,b,a.rgUIRemove)};Owa.UIControls.MsgVLV.prototype.cnvCpMv=function Owa$UIControls$MsgVLV$cnvCpMv(c,a,e){if(c.get_Length()<=0)return;var g=this.gtRwById(c.get_Item(0));if(!g)return;var d=g_oFldrMgr.isDelFId(a)&&g_oFldrMgr.gtFL(this.get_FolderId())==g_oFldrMgr.gtFL(a);if(e&&d)return;var f=1;if(!e)f=d?-1:0;this.cnvDelCpMv(c,f,a&&a==this.get_FolderId(),g.get_Id()==b?1:0)};Owa.UIControls.MsgVLV.prototype.cbCnvCpMv=function Owa$UIControls$MsgVLV$cbCnvCpMv(b){if(b.sBody){var a=h.get_Current().createElement("DIV");a.set_InnerHtml(b.sBody);this.initExp(a)}};Owa.UIControls.MsgVLV.prototype.cnvDelCpMv=function Owa$UIControls$MsgVLV$cnvDelCpMv(a,f,e,u,g,n){if(n)a=n;if(a.get_Length()==0)return false;if(u){if(!g&&f<0){for(var d=0;d<a.get_Length();d++){var c=this.gtRwById(a.get_Item(d));if(c){if(this.gtRwPrp(a.get_Item(d),"fLR")){g=1;break}}else delete this.oSel[a.get_Item(d)]}if(this.isFltrd())g=1}this.cnvUdCts(a,f,e);if(f>0||f==0&&e)return 0;var p=0,i=0,c=this.gtRwById(a.get_Item(0)),h=this.gtExpCnv(c),c=h.get_NextSibling().get_NextSibling(),j=null;while(c&&c.get_Id()==b){if(!this.isSel(c)){i++;if(i==1)j=this.getData(c).sId;if(!this.isXF(c)){p=1;if(i>1)break}}c=c.get_NextSibling()}if(!this.isNonLclSrch()&&!p){this.selSngl(h);this.rmvRws([this.getData(h).sId])}else if(i<=1&&f<0){this.cnvMkSngl(h);var t=this.get_SubPage().gtCnvRP();t&&j&&t.setSel([j])}else if(g){var o=this.gtSelAftrRmv(false,a);if(o)this.selSngl(o);else this.selSngl(h)}return g}else if(f==0&&!e){this.rmvRws(a);this.feERfrsh()}else if(f>0){for(var s=this.iUC,r=this.iTIC,d=0;d<a.get_Length();d++){var k=[a.get_Item(d)],q=this.gtCnvUC(k),m=this.gtCnvTC(k),l=this.gtCnvGC(k),c=this.gtRwById(a.get_Item(d));if(!c)continue;if(e){s+=q;r+=m}l==1&&this.cnvMkMult(c);l+=m;this.stCnvCts(a.get_Item(d),c,e?q*2:-1,e?m*2:-1,l)}if(e){this.iUC=s;this.iTIC=r;this.feERfrsh()}}};Owa.UIControls.MsgVLV.prototype.cnvUdCts=function Owa$UIControls$MsgVLV$cnvUdCts(l,o,h){for(var g=this.gtRwById(l.get_Item(0)),n=this.gtExpCnv(g),e=[this.getData(n).sId],b=this.iUC,a=this.iTIC,d=this.gtCnvUC(e),c=this.gtCnvTC(e),i=this.gtCnvGC(e),m=0;m<l.get_Length();m++){var g=this.gtRwById(l.get_Item(m));if(!g)continue;var f=this.isRd(g),j=!this.isXF(g);switch(o){case-1:if(j){if(!f){d--;b--}c--;a--}i--;break;case 0:if(!j&&h){if(!f){d++;b++}c++;a++}else if(j&&!h){if(!f){d--;b--}c--;a--}break;case 1:if(h){if(!f){d++;b++}c++;a++}i++}}var k=0;if(this.iUC!=b){this.iUC=b;k=1}if(this.iTIC!=a){this.iTIC=a;k=1}k&&this.feERfrsh();this.stCnvCts(e.get_Item(0),n,d,c,i)};Owa.UIControls.MsgVLV.prototype.cnvMkSngl=function Owa$UIControls$MsgVLV$cnvMkSngl(b){this.expRw(0);this.selSngl(b);var a=b.getDescendantById("divExp");a&&a.get_FirstChild().remove(true)};Owa.UIControls.MsgVLV.prototype.cnvMkMult=function Owa$UIControls$MsgVLV$cnvMkMult(c){var b=c.getDescendantById("divExp"),a=h.get_Current().createElement("IMG");if(!a||!b)return;Owa.Components.CssSprites.updateImage(a,g_fRtl?Owa.Strings.Icons.CollapsedRtl:Owa.Strings.Icons.Collapsed);b.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,a)};Owa.UIControls.MsgVLV.prototype.stRS=function Owa$UIControls$MsgVLV$stRS(d,c,h){this.stRwPrp(d,"read",c);var a=this.gtRwById(d);if(!a)return;if(this.isCnvVw()&&a.get_Id()==g){this.stCnvRS(d,c);return}var e=c==1,f=!a.hasCssClass("ur");if(f!=e){if(e){a.removeCssClass("ur");if(!this.isXF(a)){this.iUC--;if(this.iUC<0)this.iUC=0}}else{a.addCssClass("ur");if(!this.isXF(a))this.iUC++}if(this.isCnvVw()&&a.get_Id()==b){a.set_IsShown(false);a.set_IsShown(true);!this.isXF(a)&&this.udCnvUC(a,!e);c==-1&&this.stRwPrp(this.sExpId,"read",c)}}h&&this.feERfrsh()};Owa.UIControls.MsgVLV.prototype.gtCnvRS=function Owa$UIControls$MsgVLV$gtCnvRS(d){if(this.sExpId&&this.sExpId==d){var c=this.gtRwById(d);if(!c)return;var a=c.get_NextSibling().get_NextSibling();if(!a)return;var e=this.isRd(a)?1:-1;a=a.get_NextSibling();while(a&&a.get_Id()==b){if(!this.isSntItm(a)||this.isSntItm(c))if(this.isRd(a)){if(e<0)return 0}else if(e>0)return 0;a=a.get_NextSibling()}return e}else{var g=[d],f=this.gtCnvUC(g);if(f==0)return 1;var h=this.gtCnvTC(g);return f==h?-1:0}};Owa.UIControls.MsgVLV.prototype.stCnvRS=function Owa$UIControls$MsgVLV$stCnvRS(a,f){var d=this.gtRwById(a);if(!d)return;if(this.sExpId&&this.sExpId==a){var c=d.get_NextSibling().get_NextSibling();while(c&&c.get_Id()==b){!this.isSntItm(c)&&this.stRS(this.getData(c).sId,f);c=c.get_NextSibling()}}else{var g=[a],h=this.gtCnvTC(g),i=this.gtCnvUC(g);if(f>0){this.stCnvCts(a,d,0,-1,-1);this.iUC-=i}else{this.stCnvCts(a,d,h,-1,-1);this.iUC+=h-i}if(this.iUC<=0)this.iUC=0;this.oSel[a]&&this.feERfrsh()}var e=d.getDescendantById("divSubject");if(!e)return;if(f>0)e.removeCssClass("ur");else e.addCssClass("ur")};Owa.UIControls.MsgVLV.prototype.udCnvUC=function Owa$UIControls$MsgVLV$udCnvUC(f,d){var c=this.gtExpCnv(f),e=this.getData(c).sId,b=[e],a=this.gtCnvUC(b);a=d?a+1:a-1;if(a<0)a=0;this.stCnvCts(b,c,a,-1,-1)};Owa.UIControls.MsgVLV.prototype.prcsDta=function Owa$UIControls$MsgVLV$prcsDta(c){var a=c.getChildById(r);this.iUC=a.getIntAttribute(n);var b=getInt(a.getAttribute(F));this.fCV!=b&&this.feCnvVwChg(b);this.fCV=b;this.isCnvVw()&&this.initExp(c);var d=this.isFilteredByUnread();this.fFUR=getInt(a.getAttribute(C));!d&&this.fFUR&&this._showFilteredByUnreadPont();Owa.UIControls.MsgVLV.callBase(this,"prcsDta",[c])};Owa.UIControls.MsgVLV.prototype.addLVSt=function Owa$UIControls$MsgVLV$addLVSt(a){Owa.UIControls.MsgVLV.callBase(this,"addLVSt",[a]);this.addExpId(a)};Owa.UIControls.MsgVLV.prototype.addExpId=function Owa$UIControls$MsgVLV$addExpId(a){this.isCnvVw()&&this.sExpId&&a.add("expId",this.sExpId)};Owa.UIControls.MsgVLV.prototype.rmvRw=function Owa$UIControls$MsgVLV$rmvRw(a,d){if(this.isCnvVw()){var c=this.gtRwById(a);if(!c)return;if(c.get_Id()==g&&(this.sExpId&&a==this.sExpId))this.expRw(0);else if(c.get_Id()==b)c.hasCssClass("eclr")&&c.get_PreviousSibling().addCssClass("eclr")}else this.get_SubPage().get_MarkAsReadBehaviour()==MR_SELCHANGE&&this.mkRd(a);Owa.UIControls.MsgVLV.callBase(this,"rmvRw",[a,d]);this._findAndRemoveMessageFromPrefetchList(a);Owa.MessageCache.removeMessage(a)};Owa.UIControls.MsgVLV.prototype.rmvExp=function Owa$UIControls$MsgVLV$rmvExp(k,e){this._storeViewportPosition();this.clrPp();var f=0,h=this.getViewportPosition(),g=true,c,a=k.get_NextSibling().get_NextSibling();while(a&&a.get_Id()==b){if(g)if(this.getRowPosition(a)<h){var i=a.get_OffsetHeight();f-=i;h-=i}else g=false;var j=this.getData(a),d=j.sId;if(this.oSel[d]){if(c)delete this.oSel[c];this.oSel[d].fSel=false;c=d}if(e&&j.getAttribute("read")==String(MSG_MARKED_UNREAD))e[d]=String(MSG_MARKED_UNREAD);a.remove(true);a=k.get_NextSibling().get_NextSibling()}if(c){this.feSelChg(c,0,1);delete this.oSel[c]}this.clearRowCache();this._resetViewportPosition(f);this._resetCurrentRowPosition()};Owa.UIControls.MsgVLV.prototype.fndExp=function Owa$UIControls$MsgVLV$fndExp(b){return b.getAncestorById("divExp",a)};Owa.UIControls.MsgVLV.prototype.exp=function Owa$UIControls$MsgVLV$exp(e,a){if(this.fPndExp)return;this.fPndExp=1;var h=this.gtRwById(e),d=h.getDescendantById("divExp");if(d){d.get_FirstChild().set_IsShown(false);var b=d.getDescendantById("imgPrg");b.set_IsShown(true);if(!c.isIE()){b.set_Margin(Owa.Style.Side.Bottom,4);b.set_Margin(Owa.Style.Side.Top,0)}}var f={};if(!a)a={};f.rgsSubRowsMarkedAsUnread=a;var g=new oeReq(this.sEvtNS,"ExpandConversation",f,this._createCallback(this.cbExp),POST);this.sExpId=e;this.addLVSt(g);g.send()};Owa.UIControls.MsgVLV.prototype.cbExp=function Owa$UIControls$MsgVLV$cbExp(b){this.fPndExp=0;var c=this.gtRwById(this.sExpId);if(c){var a=c.getDescendantById("divExp");if(a){a.getDescendantById("imgPrg").set_IsShown(false);a.get_FirstChild().set_IsShown(true)}}if(!cbOeh(b)){this.sExpId="";return}var d=h.get_Current().createElement("DIV");d.set_InnerHtml(b.sBody);this.initExp(d,b.oCtx.rgsSubRowsMarkedAsUnread)};Owa.UIControls.MsgVLV.prototype.isSameConversation=function Owa$UIControls$MsgVLV$isSameConversation(d,c){if(Ews.BaseId.IsOwaCnvId(d)&&Ews.BaseId.IsOwaCnvId(c))if(d!=c){var b=d.split("."),a=c.split(".");if(b&&a)return b[0]==a[0]&&b[1]==a[1]&&b[b.length-1]==a[a.length-1]}else return true;return false};Owa.UIControls.MsgVLV.prototype.initExp=function Owa$UIControls$MsgVLV$initExp(s,h){var d=s.getChildById("tblExp");if(!d)return;var c=d.getAttribute("expId");if(!c||!this.sExpId)return;if(c!=this.sExpId)if(this.isSameConversation(c,this.sExpId))this.sExpId=c;else return;var g=this.gtRwById(c);if(!g)return;var e=g.get_NextSibling();if(!e||e.get_Id()!=j)return;var a=this.oCurRowPosition;this.rmvExp(g,h);var r=e;this._storeViewportPosition();for(var f=d._get_DomNode().childNodes,o=f.length,m=0;m<o;m++)r.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,lb.wrapDomNode(f[f.length-1]));this._resetViewportPosition();d.remove(true);this.expRw(1,h);if(a.iSubRow!=0){var n=this.gtRw(a.iRow,a.iSubRow);if(!n)a=new RowPosition(Math.min(this.ER(),a.iRow+1),0);this.posVwprt(a);this.updScr()}var k=this.gtSel();this.get_SelectionAnchorId()==this.sExpId&&k.length==1&&this.set_SelectionAnchorId(k[0]);var l=this.get_SubPage().gtCnvRP();if(l){var p=d.getAttribute("iGC"),q=l.get_GlobalMessageCount();p!=q&&this.get_SubPage().refreshConversationRP(true)}if(this.gtSelCnt()==0){var i=e.get_NextSibling();i.get_Id()==b&&this.selSngl(i)}};Owa.UIControls.MsgVLV.prototype.expRw=function Owa$UIControls$MsgVLV$expRw(e,d){if(!this.sExpId)return;this.clearRowCache();var c=this.gtRwById(this.sExpId);if(!c){this.sExpId="";return}var i=!e?g_fRtl?Owa.Strings.Icons.CollapsedRtl:Owa.Strings.Icons.Collapsed:g_fRtl?Owa.Strings.Icons.ExpandedRtl:Owa.Strings.Icons.Expanded,h=c.getDescendantById("divExp");h&&Owa.Components.CssSprites.updateImage(h.get_FirstChild(),i);this._storeViewportPosition();var f=c.get_NextSibling();f.set_IsShown(!e);this._resetViewportPosition();if(e){this._storeViewportPosition();c.addCssClass("eclr");var a=f.get_NextSibling();while(a&&a.get_Id()==b){if(this.isSel(a)){a.addCssClass(w);this.shwPp()}else a.addCssClass(q);var g=this.getData(a),j=g.sId;d&&isDf(typeof d[j])&&!this.isRd(a)&&g.setAttribute("read",String(MSG_MARKED_UNREAD));a=a.get_NextSibling()}this._resetViewportPosition();this.feRfExp()}else{c.removeCssClass("eclr");f.removeCssClass(q);c.removeCssClass(q);this.rmvExp(c,d);this.sExpId=""}this.updScr()};Owa.UIControls.MsgVLV.prototype.gtExpCnv=function Owa$UIControls$MsgVLV$gtExpCnv(c){if(c.get_Id()!=b)return;var a=c.get_PreviousSibling();while(a){if(a&&a.get_Id()==g)break;a=a.get_PreviousSibling()}return a};Owa.UIControls.MsgVLV.prototype.gtExpCnvId=function Owa$UIControls$MsgVLV$gtExpCnvId(){return this.sExpId};Owa.UIControls.MsgVLV.prototype.isSelExp=function Owa$UIControls$MsgVLV$isSelExp(){var a=this.gtSel();if(a&&a.get_Length()>0){var c=this.gtRwById(a.get_Item(0));if(c&&c.get_Id()==b)return 1}return 0};Owa.UIControls.MsgVLV.prototype.gtCnvUC=function Owa$UIControls$MsgVLV$gtCnvUC(a){return this.gtCnvCt(a,n)};Owa.UIControls.MsgVLV.prototype.gtCnvTC=function Owa$UIControls$MsgVLV$gtCnvTC(a){return this.gtCnvCt(a,o)};Owa.UIControls.MsgVLV.prototype.gtCnvGC=function Owa$UIControls$MsgVLV$gtCnvGC(a){return this.gtCnvCt(a,"iGC")};Owa.UIControls.MsgVLV.prototype.gtCnvCt=function Owa$UIControls$MsgVLV$gtCnvCt(b,e){for(var d=0,a=0;a<b.get_Length();a++){var c=getInt(this.gtRwPrp(b[a],e));if(!isNaN(c))d+=c}return d};Owa.UIControls.MsgVLV.prototype.stCnvCts=function Owa$UIControls$MsgVLV$stCnvCts(d,f,a,b,c){if(a<0&&b<0&&c<0)return;var e=[d];if(a<0)a=this.gtCnvUC(e);if(b<0)b=this.gtCnvTC(e);if(c<0)c=this.gtCnvGC(e);if(isNaN(a))a=0;if(isNaN(b))b=0;if(isNaN(c))c=0;f.getChildById("divUC").set_TextContent(a>1&&b>1?"("+getStr(a)+")":"");f.getChildById("divSubject").set_FontWeight(a>0?Owa.Style.FontWeight.Bold:Owa.Style.FontWeight.Normal);this.stRwPrp(d,n,a);this.stRwPrp(d,o,b);this.stRwPrp(d,"iGC",c)};Owa.UIControls.MsgVLV.prototype.isXF=function Owa$UIControls$MsgVLV$isXF(a){return a&&a.get_Id()==b&&a.hasCssClass("df")};Owa.UIControls.MsgVLV.prototype.isSntItm=function Owa$UIControls$MsgVLV$isSntItm(a){if(a&&a.get_Id()==b)return this.gtRwPrp(this.getData(a).sId,"fId").indexOf(a_sSntId)!=-1};Owa.UIControls.MsgVLV.prototype.isRd=function Owa$UIControls$MsgVLV$isRd(b){var a=this.gtRwPrp(this.getData(b).sId,"read");return a&&a<=0?0:1};Owa.UIControls.MsgVLV.prototype.get_LastModifiedTime=function Owa$UIControls$MsgVLV$get_LastModifiedTime(b){var a;if(b&&b.get_Id()==g)a=this.gtRwPrp(this.getData(b).sId,sb);return a?a:0};Owa.UIControls.MsgVLV.prototype.udPp=function Owa$UIControls$MsgVLV$udPp(){var a=this.gtSelCnt()==1&&this.isSelExp();if(!this._isPipeVisible()&&!a)return;this._storeViewportPosition();if(a)this.shwPp();else this.clrPp();this._resetViewportPosition()};var x=function(b,a){this._oR=b;this._oVlv=a};x.prototype.get_ParentItemPart=function PipeItemPartInfo$prototype$get_ParentItemPart(){var a=this._oVlv.gtParItm(this._oR);return a?new x(a,this._oVlv):null};x.prototype.get_PipeConnectorTop=function PipeItemPartInfo$prototype$get_PipeConnectorTop(){var a=this._oVlv.getData(this._oR).sId;return this._oVlv._oIdToRow[a].iChunkOffset+Fb};Owa.UIControls.MsgVLV.prototype.shwPp=function Owa$UIControls$MsgVLV$shwPp(){var a=this.gtRwById(this.gtSel().get_Item(0));if(this._oPipe)return;var b=this.fndChnk(a);this._oPipe=new Owa.Components.Pipes(b);this._getOIdToRow();this._oPipe.drawPipes(new x(a,this))};Owa.UIControls.MsgVLV.prototype.clrPp=function Owa$UIControls$MsgVLV$clrPp(){if(this._oPipe){this._oPipe.clearPipes();this._oPipe.dispose();this._oPipe=null}};Owa.UIControls.MsgVLV.prototype._isPipeVisible=function Owa$UIControls$MsgVLV$_isPipeVisible(){return this._oPipe!=null};Owa.UIControls.MsgVLV.prototype.gtParItm=function Owa$UIControls$MsgVLV$gtParItm(b){var a=this.gtPrpV(b,"pId");return a?this._oIdToRow[a]?this._oIdToRow[a].oRow:null:null};Owa.UIControls.MsgVLV.prototype.isNonLclSrch=function Owa$UIControls$MsgVLV$isNonLclSrch(){var a=this.get_SearchControl();return this.get_IsSearch()||this.fSrch&&a.iScope&&a.iScope!=SearchScope.SS_FLD};var e={TYPE:0,ITEM_INSTANCE_KEY:1,PREVIOUS_ITEM_INSTANCE_KEY:2,ROW1_HTML:3,ROW2_HTML:4,ISREAD:5,HEADER:6,TITLE:7};Owa.UIControls.MsgVLV.prototype.processRowNotification=function Owa$UIControls$MsgVLV$processRowNotification(a){if(this._shouldIgnoreNotification())return;if(this.gtTC()==0){this.rfrsh(true);return}var b=a[e.TYPE];switch(b){case eb:this._processRowAddedNotification(a);break;case Bb:this._processRowDeletedNotification(a);break;case bb:this._processRowModifiedNotification(a);break;default:throw new Error("Invalid row notification type: "+b);}this._setTimeout(this._deqRowNotification,10)};Owa.UIControls.MsgVLV.prototype._processRowAddedNotification=function Owa$UIControls$MsgVLV$_processRowAddedNotification(a,p){var k=false;if(this._getRowByInstanceKey(a[e.ITEM_INSTANCE_KEY])!=null)return;var g=a[e.PREVIOUS_ITEM_INSTANCE_KEY];if(g==""&&this.SR()!=0){var l=this.getRowInfoFromPosition(new RowPosition(0,0));if(!this.isCnvVw())this._updateItemCounts({iTCDelta:1,iTICDelta:1,iUCDelta:1},true,this.fndChnk(l.oRow),a[e.ISREAD]);else{var m=h.get_Current().createElement("DIV");m.set_InnerHtml(a[e.ROW1_HTML]);var b=this.getData(m.get_FirstChild().get_FirstChild());this._updateItemCounts({iTCDelta:1,iTICDelta:b.getIntAttribute(o),iUCDelta:b.getIntAttribute(n)},true,this.fndChnk(l.oRow),a[e.ISREAD])}return}var j=this._getNextPrevRow(g,a[e.HEADER],a),d=j.oRowInfo;if(!d)return;var k=j.fInsertBefore,i=this.fndChnk(d.oRow);if(j.fRefresh||this._getChunkCount(i)>=Ab){this.rfrsh(true);a.fRefreshedWhileAdding=true}this._storeViewportPosition();var q=this._getRowPosition(d.oRow),c=this._insertRow(d,a[e.ROW1_HTML],a[e.ROW2_HTML],k),f=0;f+=c.get_OffsetHeight();f+=c.get_NextSibling().get_OffsetHeight();this._resetViewportPosition(q==y.ABOVE_VIEWPORT?f:0);b=this.getData(c);if(!this.isCnvVw())this._updateItemCounts({iTCDelta:1,iTICDelta:1,iUCDelta:1},false,i,a[e.ISREAD]);else this._updateItemCounts({iTCDelta:1,iTICDelta:b.getIntAttribute(o),iUCDelta:b.getIntAttribute(n)},false,i,a[e.ISREAD]);this._insertRowInRowCache(c,d,k,f);this._resetCurrentRowPosition();this.updScr();if(this.sExpId&&!p){this.clrPp();this.udPp()}this._updatePendingDeleteCache(c,g);this.isPrefetchEnabled()&&this._addMessageToPrefetchList(new PrefetchContext(b.sId,b.getAttribute("t"),false,this.get_LastModifiedTime(c)),true,true)};Owa.UIControls.MsgVLV.prototype._processRowDeletedNotification=function Owa$UIControls$MsgVLV$_processRowDeletedNotification(h){var d=h[e.ITEM_INSTANCE_KEY],a=this._getIdFromInstanceKey(d);if(a&&this.gtRwPrp(a,"deleting")!="1"){var i=this._isExpandedConversation(a);if(i){var j=this.gtRwById(a);this.expRw(0);this.selSngl(j,false,false)}var f=this.getAdjacentInstanceKey(a,false),g=this.getAdjacentInstanceKey(a,true);ClientAction.add(ClientAction.Name.DeleteRowByNotification);this.rmvRws([a]);if(!Owa.PendingOperationsManager.clearContext(this.get_DataFolderId(),d)){var b=Owa.PendingOperationsManager.getContextByPreviousInstanceKey(this.get_DataFolderId(),d),c=Owa.PendingOperationsManager.getContextByNextInstanceKey(this.get_DataFolderId(),d);if(b&&c){b.sPreviousIK=c.oRowInfo.sInstanceKey;c.sNextIK=b.oRowInfo.sInstanceKey}else if(b)b.sPreviousIK=f;else if(c)c.sNextIK=g}}};Owa.UIControls.MsgVLV.prototype._processRowModifiedNotification=function Owa$UIControls$MsgVLV$_processRowModifiedNotification(b){var d=b[e.ITEM_INSTANCE_KEY];this._discardDuplicateNotification(bb,d);var c=this._getRowByInstanceKey(d);if(!c)return;var B=this.getData(c),a=B.sId,a=this.getData(c).sId,z=this.isSel(c),m=false,r=this.gtRwPrp(a,"read"),C=this.gtRwPrp(a,"t"),n={},A=this.gtCnvTC([a]),D=this.gtCnvUC([a]),l=0,t=0,p=b[e.PREVIOUS_ITEM_INSTANCE_KEY],o=this._getPreviousRowInstanceKey(d),s=this._getRowInfoByInstanceKey(d),i=p==o;if(!i){var h=p,v=this.get_DataFolderId(),k=Owa.PendingOperationsManager.getContext(v,h);while(k){h=k.sPreviousIK;k=Owa.PendingOperationsManager.getContext(v,h)}i=h==o}if(i&&(s&&htmlDec(b[e.HEADER])==s.sSectionHeaderText)){var f=[a];if(this.isCnvVw()){this.iTIC-=this.gtCnvTC(f);this.iUC-=this.gtCnvUC(f)}this._replaceRowHTML(c,b[e.ROW1_HTML],b[e.ROW2_HTML]);this.isCnvVw()&&this._isExpandedConversation(a)&&this.exp(a);if(this.isCnvVw()){l=this.gtCnvTC(f);t=this.gtCnvUC(f);this.iTIC+=l;this.iUC+=t}}else{var q=this._isExpandedConversation(a);this.isCnvVw()&&q&&this.expRw(0,n);var u=this.gtRwById(a),x=u._get_DomNode().className,y=u.get_NextSibling()._get_DomNode().className;this.rmvRws([a],null,-1);b[e.ROW1_HTML]='<div id="'+g+'" class="'+x+'">'+b[e.ROW1_HTML]+"</div>";b[e.ROW2_HTML]='<div id="'+j+'" class="'+y+'">'+b[e.ROW2_HTML]+"</div>";b[e.TYPE]=eb;this._processRowAddedNotification(b,true);if(isDf(typeof b.fRefreshedWhileAdding)&&b.fRefreshedWhileAdding)return;c=this._getRowByInstanceKey(d);if(!c)return;if(this.isCnvVw())if(q){this.sel(c,true);m=true;this.exp(a,n)}else{this.clrPp();this.udPp()}}if(!this.isCnvVw()){var w=b[e.ISREAD];this.stRS(this._getIdFromInstanceKey(d),w,false);c.set_Title(b[e.TITLE])}r==String(MSG_MARKED_UNREAD)&&!this.isRd(c)&&this.stRwPrp(a,"read",r);z&&!m&&this.sel(c,true);!this.isCnvVw()&&Owa.MessageCache.removeMessage(a);if(this.isCnvVw()&&this.isReadingPaneOn()&&a==this.get_ItemIdInReadingPane())this.onRowNotification(a);else this.isCnvVw()&&this.isPrefetchEnabled()&&this._addMessageToPrefetchList(new PrefetchContext(a,C,false,this.get_LastModifiedTime(c)),true,l>=A?true:false)};Owa.UIControls.MsgVLV.prototype._getNextPrevRow=function Owa$UIControls$MsgVLV$_getNextPrevRow(c,b,h){var a,f=false,e=false;if(c==""){a=this.getRowInfoFromPosition(new RowPosition(0,0));f=true}else{a=this._getRowInfoByInstanceKey(c);if(!a){var i=Owa.PendingOperationsManager.getContext(this.get_DataFolderId(),c);if(i)return this._getNextPrevRow(i.sPreviousIK,b,h);this._enqRowNotification(h);return{fRefresh:false,oRowInfo:null,fInsertBefore:false}}}if(a&&b&&b!=""){var d=a.sSectionHeaderText;b=htmlDec(b);if(d!=""&&d!=b)if(c!=""){var g=this.getRowInfoFromPosition(new RowPosition(a.oRowPosition.iRow+1,0));if(g){d=g.sSectionHeaderText;if(d==b){a=g;f=true}else e=true}else e=true}else e=true}return{fRefresh:e,oRowInfo:a,fInsertBefore:f}};Owa.UIControls.MsgVLV.prototype._insertRow=function Owa$UIControls$MsgVLV$_insertRow(d,f,e,h){var b,c=d.oRow;if(!h){var a=c.get_NextSibling();if(this.isCnvVw()&&this._isExpandedConversation(d.sRowId)){var g;while(a&&!this.isRowHeading(a)){g=a;a=a.get_NextSibling()}a=g}this._insertARow(a,e,false);b=this._insertARow(a,f,false)}else{b=this._insertARow(c,f,true);this._insertARow(c,e,true)}return b};Owa.UIControls.MsgVLV.prototype._replaceRowHTML=function Owa$UIControls$MsgVLV$_replaceRowHTML(a,c,b){var d=a.get_NextSibling();a.set_InnerHtml(c);d.set_InnerHtml(b)};Owa.UIControls.MsgVLV.prototype._insertARow=function Owa$UIControls$MsgVLV$_insertARow(c,e,d){var b=h.get_Current().createElement("DIV");b.set_InnerHtml(e);var a=b.get_FirstChild();if(!d)c.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,a);else c.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,a);return a};var N=3,qb=5,L=2e3;Owa.UIControls.MsgVLV.prototype._enqRowNotification=function Owa$UIControls$MsgVLV$_enqRowNotification(a){if(isDf(typeof a.iCount)&&a.iCount>=N||this._rgRowNotification.get_Length()>=qb){this._clearRowNotifications();return}else if(a.iCount&&a.iCount<N)a.iCount++;else a.iCount=1;if(!isDf(typeof a.iTime))a.iTime=(new Date).valueOf()+L-10;this._rgRowNotification.push(a)};Owa.UIControls.MsgVLV.prototype._deqRowNotification=function Owa$UIControls$MsgVLV$_deqRowNotification(){for(var a=null,c=false,b=0;b<this._rgRowNotification.get_Length();b++){a=this._rgRowNotification[b];var d=(new Date).valueOf();if(a.iTime>d)continue;else{this._rgRowNotification.splice(b,1);c=true;break}}if(c&&a)this.processRowNotification(a);else if(this._rgRowNotification.get_Length()>0&&!this._oRowNotificationQueueTimer)this._oRowNotificationQueueTimer=this._setTimeout(this._rowNotificationQueueTimerCallback,L)};Owa.UIControls.MsgVLV.prototype._rowNotificationQueueTimerCallback=function Owa$UIControls$MsgVLV$_rowNotificationQueueTimerCallback(){this._oRowNotificationQueueTimer=null;this._deqRowNotification()};Owa.UIControls.MsgVLV.prototype._clearRowNotifications=function Owa$UIControls$MsgVLV$_clearRowNotifications(){this._rgRowNotification=[]};Owa.UIControls.MsgVLV.prototype._discardDuplicateNotification=function Owa$UIControls$MsgVLV$_discardDuplicateNotification(d,c){var b,a=0;while(a<this._rgRowNotification.get_Length()){b=this._rgRowNotification[a];if(b[e.TYPE]==d&&b[e.ITEM_INSTANCE_KEY]==c)this._rgRowNotification.splice(a,1);else a++}};Owa.UIControls.MsgVLV.prototype._shouldIgnoreNotification=function Owa$UIControls$MsgVLV$_shouldIgnoreNotification(){return this.isFltrd()};Owa.UIControls.MsgVLV.prototype._isPushNotificationSupported=function Owa$UIControls$MsgVLV$_isPushNotificationSupported(){return true};Owa.UIControls.MsgVLV.prototype._updatePendingDeleteCache=function Owa$UIControls$MsgVLV$_updatePendingDeleteCache(d,a){var f=this.getData(d);if(!f)return;var e=this.getData(d).sInstanceKey,c=Owa.PendingOperationsManager.getContextByPreviousInstanceKey(this.get_DataFolderId(),a);if(c)c.sPreviousIK=e;var b=Owa.PendingOperationsManager.getContext(this.get_DataFolderId(),a);if(b)b.sNextIK=e};Owa.UIControls.MsgVLV.prototype._showFilteredByUnreadPont=function Owa$UIControls$MsgVLV$_showFilteredByUnreadPont(){var a=this.get_SubPage().getSubPageVariable("a_iMR");this.isFilteredByUnread()&&P&a_iEnblPnt&&(isDf(typeof a)&&a!=MR_NEVER)&&shwPont(P,L_AutoMarkAsReadDisabled,L_MarkAsRead,[L_OK],Owa.BUTTON_DIALOG_ICON.INFORMATION,0,0)};var rb=1,Q=1e3;Owa.UIControls.MsgVLV.prototype.isPrefetchEnabled=function Owa$UIControls$MsgVLV$isPrefetchEnabled(){return isDf(typeof a_fIsMessagePrefetchEnabled)&&a_fIsMessagePrefetchEnabled&&this.get_SubPage().getSubPageVariable("a_fIsMessagePrefetchEnabledInThisView")=="1"&&this.isReadingPaneOn()&&this._get_IsShown()};Owa.UIControls.MsgVLV.prototype.shouldUseCachedMessage=function Owa$UIControls$MsgVLV$shouldUseCachedMessage(a,b){return this.isPrefetchEnabled()&&this._shouldPrefetchItem(a,b)&&!(this.isCnvVw&&this.isCnvVw()&&this.isFltrd())};Owa.UIControls.MsgVLV.prototype.startPrefetch=function Owa$UIControls$MsgVLV$startPrefetch(){!this._fPerformedFirstTimeMessagePrefetch&&this._startPrefetchTimer()};Owa.UIControls.MsgVLV.prototype._restartPrefetch=function Owa$UIControls$MsgVLV$_restartPrefetch(a){this._fPerformedFirstTimeMessagePrefetch=false;this._startPrefetchTimer(a)};Owa.UIControls.MsgVLV.prototype._continuePrefetch=function Owa$UIControls$MsgVLV$_continuePrefetch(){this._internalStartPrefetch(true)};Owa.UIControls.MsgVLV.prototype._internalStartPrefetch=function Owa$UIControls$MsgVLV$_internalStartPrefetch(d){if(this.iTC==0||!this._get_IsShown()){this._clearPrefetchTimer();if(!this._get_IsShown())this._fRestartPrefetchOnshow=true;return}this._cleanupPrefetchList();if(!d){this._getFirstTimePrefetchItems();this._rgsMessagePrefetchList.get_Length()>3&&this._sendPrereadRequest()}var b=null,c=this._rgsMessagePrefetchList.get_Length();if(c==0){this._clearPrefetchTimer();return}this._iMessagePrefetchBatchSize=Math.min(c,rb);this._iMessagePrefetchCompleteCount=0;for(var a=0;a<this._iMessagePrefetchBatchSize;a++){b=this._rgsMessagePrefetchHash[this._rgsMessagePrefetchList[a]];b.iIndex=a;this.sendPrefetchRequest(b)}};Owa.UIControls.MsgVLV.prototype._startPrefetchTimer=function Owa$UIControls$MsgVLV$_startPrefetchTimer(a){if(this._get_IsShown()&&(!this._oMessagePrefetchTimer||this._oMessagePrefetchTimer.iTime+5*Q<=Date.timeInMs())){this._oMessagePrefetchTimer={};this._oMessagePrefetchTimer.iHandle=this._setTimeout(this._createCallback(this._internalStartPrefetch),a?100:Q);this._oMessagePrefetchTimer.iTime=Date.timeInMs()}};Owa.UIControls.MsgVLV.prototype._clearPrefetchTimer=function Owa$UIControls$MsgVLV$_clearPrefetchTimer(){this._oMessagePrefetchTimer=null};Owa.UIControls.MsgVLV.prototype._getFirstTimePrefetchItems=function Owa$UIControls$MsgVLV$_getFirstTimePrefetchItems(){if(this._fPerformedFirstTimeMessagePrefetch)return;var a=a_iPrefetchCount,c=this.getNumberOfItemsInTheViewport(),h=Math.ceil(c*1.5);if(isDf(typeof a)&&a>0)h=a;for(var i=this.getRowInfos(),b=0,k,e=0;e<i.get_Length();e++){oR=i[e];if(oR.sId==g){b++;var f=this.get_LastModifiedTime(oR.oRow),d=this.gtRwPrp(oR.sRowId,"t"),j=this._getPrefetchUrl(d,oR.sRowId);if(!Owa.MessageCache.isMessageValid(oR.sRowId,f)&&this._shouldPrefetchItem(d,j)&&oR.sRowId!=this.get_ItemIdInReadingPane())(a!=0||a_fPrefetchOnlyUnreadMessages&&!this.isRd(oR.oRow)||(!a_fPrefetchOnlyUnreadMessages&&b<=c||b>c&&!this.isRd(oR.oRow)))&&this._addMessageToPrefetchList(new PrefetchContext(oR.sRowId,d,false,f));if(b>h)break}}this._fPerformedFirstTimeMessagePrefetch=true};Owa.UIControls.MsgVLV.prototype._cleanupPrefetchList=function Owa$UIControls$MsgVLV$_cleanupPrefetchList(){for(var c=[],a=null,b=0;b<this._rgsMessagePrefetchList.get_Length();b++){a=this._rgsMessagePrefetchList[b];a&&this._rgsMessagePrefetchHash[a]&&c.push(a)}this._rgsMessagePrefetchList=c};Owa.UIControls.MsgVLV.prototype._addMessageToPrefetchList=function Owa$UIControls$MsgVLV$_addMessageToPrefetchList(a,c,b){if(!isDf(typeof this._rgsMessagePrefetchHash[a.sId])){this._rgsMessagePrefetchHash[a.sId]=a;if(c)this._rgsMessagePrefetchList.splice(0,0,a.sId);else this._rgsMessagePrefetchList.push(a.sId)}else this._rgsMessagePrefetchHash[a.sId].iLastModifiedTime=a.iLastModifiedTime;this._startPrefetchTimer(b)};Owa.UIControls.MsgVLV.prototype._findAndRemoveMessageFromPrefetchList=function Owa$UIControls$MsgVLV$_findAndRemoveMessageFromPrefetchList(c){for(var b=null,a=0;a<this._rgsMessagePrefetchList.get_Length();a++){b=this._rgsMessagePrefetchList[a];b&&c==b&&this._removeMessageFromPrefetchList(c,a)}};Owa.UIControls.MsgVLV.prototype._emptyPrefetchList=function Owa$UIControls$MsgVLV$_emptyPrefetchList(){this._rgsMessagePrefetchList=[];this._rgsMessagePrefetchHash={}};Owa.UIControls.MsgVLV.prototype._removeMessageFromPrefetchList=function Owa$UIControls$MsgVLV$_removeMessageFromPrefetchList(a,b){var c=this._rgsMessagePrefetchHash[a];if(c){this._rgsMessagePrefetchList[b]=null;delete this._rgsMessagePrefetchHash[a]}};Owa.UIControls.MsgVLV.prototype.sendPrefetchRequest=function Owa$UIControls$MsgVLV$sendPrefetchRequest(a){a.sFId=this.get_DataFolderId();if(!a.sUrl)a.sUrl=this._getPrefetchUrl(a.sType,a.sId);var b=a.sUrl;if(isSMime(a.sType))b+=gtMmPar();if(!a.fIsNotPrefetched)b+="&pf=1";else b+=ClientAction.getList();var c=new oeReq("","",a,this._createCallback(this._cbPrefetch),GET,null,null,a.fIsNotPrefetched?false:true,null,null,null,Owa.Components.SubPageControllerFactory.isOwaSubPageRequest(b));c.sUrl=b;a.fIsNotPrefetched&&this._abortUnsentPreviewRequests();c.send()};Owa.UIControls.MsgVLV.prototype._cbPrefetch=function Owa$UIControls$MsgVLV$_cbPrefetch(b){this._iMessagePrefetchCompleteCount++;var a=b.oCtx,d=b.sBody;if(cbOeh(b,null,null,!a.fIsNotPrefetched)){var e=this.gtRwById(a.sId);if(a.fIsNotPrefetched){a.sHtml=d;this._shouldCacheMessage(b)&&Owa.MessageCache.addMessage(a.sId,new Owa.UIControls.MessageDataProvider(d),a.fIsNotPrefetched,a.iLastModifiedTime);if(this.isSelectedRow(a.sId))this.onFetchRP(a);return}var c=e?this.get_LastModifiedTime(e):0;if(e)if(a.iLastModifiedTime==c){this._shouldCacheMessage(b)&&Owa.MessageCache.addMessage(a.sId,new Owa.UIControls.MessageDataProvider(d),a.fIsNotPrefetched,a.iLastModifiedTime);this._removeMessageFromPrefetchList(a.sId,a.iIndex)}else if(a.iLastModifiedTime>c){Owa.MessageCache.removeMessage(a.sId);this._removeMessageFromPrefetchList(a.sId,a.iIndex)}else{Owa.MessageCache.removeMessage(a.sId);if(this._rgsMessagePrefetchHash[a.sId])this._rgsMessagePrefetchHash[a.sId].iLastModifiedTime=c}else{Owa.MessageCache.removeMessage(a.sId);this._removeMessageFromPrefetchList(a.sId,a.iIndex)}}else this._removeMessageFromPrefetchList(a.sId,a.iIndex);if(this._iMessagePrefetchCompleteCount>=this._iMessagePrefetchBatchSize){this._cleanupPrefetchList();if(this._rgsMessagePrefetchList.get_Length()==0)this._clearPrefetchTimer();else this._continuePrefetch()}};Owa.UIControls.MsgVLV.prototype._shouldPrefetchItem=function Owa$UIControls$MsgVLV$_shouldPrefetchItem(a,b){return isSMime(a)||!Owa.Components.SubPageControllerFactory.isOwaSubPageRequest(b)?false:true};Owa.UIControls.MsgVLV.prototype._shouldCacheMessage=function Owa$UIControls$MsgVLV$_shouldCacheMessage(a){var b=a.oCtx;return this._shouldPrefetchItem(b.sType,b.sUrl)&&!this.isFltrd()&&!this._containsDoNotCacheHeader(a)};Owa.UIControls.MsgVLV.prototype._containsDoNotCacheHeader=function Owa$UIControls$MsgVLV$_containsDoNotCacheHeader(b){var a=b.getResponseHeader("X-OWA-DoNotCache");return a&&a=="1"};Owa.UIControls.MsgVLV.prototype._getPrefetchUrl=function Owa$UIControls$MsgVLV$_getPrefetchUrl(a,b){return M+a+"&id="+urlEnc(b)};Owa.UIControls.MsgVLV.prototype._sendPrereadRequest=function Owa$UIControls$MsgVLV$startPrefetch(){var a=new oeReq(this.sEvtNS,"Preread",null,null,POST);this.addLVSt(a);a.add("fId",this.get_DataFolderId());a.addRg("Itms",this._rgsMessagePrefetchList);a.send()};Owa.UIControls.MsgVLV.prototype._abortUnsentPreviewRequests=function Owa$UIControls$MsgVLV$_abortUnsentPreviewRequests(){Owa.Components.OehRequest.abortOehRequests(Owa.Dom.AjaxRequest.AbortCriterion.UnsentAndUrlMatch,null,null,M)};Owa.UIControls.TskVLV=function Owa$UIControls$TskVLV(a,b){Owa.UIControls.TskVLV.constructBase(this,[a,b]);this.iPndCnt=0;this.fRfrsh=0};Owa.UIControls.TskVLV.createClass("Owa.UIControls.TskVLV",Owa.UIControls.FldrVLV);var Ob=B.TskVLV.prototype;Owa.UIControls.TskVLV.prototype.get_IsFlaggedMailAndTasks=function Owa$UIControls$get_IsFlaggedMailAndTasks$mkSelCmp(){return this.get_SubPage().get_IsFlaggedMailAndTasks()};Owa.UIControls.TskVLV.prototype.mkSelCmp=function Owa$UIControls$TskVLV$mkSelCmp(){var a=this.gtSel(),c=this.gtNATsks(L_EdAT,L_MltEdAT);a=c.rg;c.sErr&&alrt(c.sErr);if(!a.get_Length())return;for(var d=0,b=0;b<a.get_Length();b++)d|=this.gtRwPrp(a.get_Item(b),"fRT");this.mkCmp(a,d);if(!this.get_SubPage().isPF()&&!this.get_SubPage().isOMF())for(var b=0;b<a.get_Length();b++)this.updTskCmp(a.get_Item(b))};Owa.UIControls.TskVLV.prototype.onMD=function Owa$UIControls$TskVLV$onMD(a){var c=a.get_Target(),b=this.fndRw(c);if((this.fndChk(c)||this.fndFlg(c))&&a.isLeftButtonDown())this.clkMkCmp(b);else if(this.fndImp(c)&&a.isLeftButtonDown())this.clkTgImp(b);else if(this.fndDD(c)&&a.isLeftButtonDown()&&this.isSel(b)){var d=this,e=function(a){d.setDD(a)};this.shwTskDP(b.getChildById("dd"),new Date(this.getData(b).getAttribute("dtDD")),e)}else Owa.UIControls.TskVLV.callBase(this,"onMD",[a])};Owa.UIControls.TskVLV.prototype.incPndCnt=function Owa$UIControls$TskVLV$incPndCnt(a){this.iPndCnt++;this.fRfrsh|=a};Owa.UIControls.TskVLV.prototype.decPndCnt=function Owa$UIControls$TskVLV$decPndCnt(a){this.iPndCnt--;this.fRfrsh|=a;if(!this.iPndCnt&&this.fRfrsh){this.rfrsh(1);this.fRfrsh=0}};Owa.UIControls.TskVLV.prototype.isSrtCmp=function Owa$UIControls$TskVLV$isSrtCmp(){var a=this.iSC,b=this._getArrangeByColumnId("divCmp"),c=this._getArrangeByColumnId("divFlg");return a==b||a==c};Owa.UIControls.TskVLV.prototype.delTsks=function Owa$UIControls$TskVLV$delTsks(i){var f=this.gtNATsks(L_DelAT,L_MltDelAT),a={};a.rg=f.rg;a.sErr=f.sErr;a.fP=i;var b=0;if(this.get_IsFlaggedMailAndTasks())if(a.rg.get_Length()==1){var e=this.gtRwPrp(a.rg.get_Item(0),"t");if(isOfClss(e,IT_CNT))b=PONT_CNT;else if(!isOfClss(e,IT_TSK))b=PONT_MSG}else for(var d=0;d<a.rg.get_Length();d++)if(!isOfClss(this.gtRwPrp(a.rg.get_Item(d),"t"),IT_TSK)){b=PONT_MLT;break}if(b&a_iEnblPnt){var c;if(b==PONT_MSG)c=L_PntMsg;else if(b==PONT_CNT)c=L_PntCnt;else c=L_PntMlt;c=c+"<br>"+L_Cntnu;var g=this,h=function(a,b){g.cbDelPont(a,b)};shwPont(b,c,L_Wrn,[L_Yes,L_No],Owa.BUTTON_DIALOG_ICON.WARNING,h,a);return}this.cbDelPont(0,a)};Owa.UIControls.TskVLV.prototype.cbDelPont=function Owa$UIControls$TskVLV$cbDelPont(b,a){if(b==-1||b==1)return;a.iIdx=0;a.rgDl=[];a.rgDlO=[];a.fRf=0;this.prRcTsks(a)};Owa.UIControls.TskVLV.prototype.prRcTsks=function Owa$UIControls$TskVLV$prRcTsks(a){while(a.iIdx<a.rg.get_Length()){var b=a.rg.get_Item(a.iIdx);if(this.gtRwPrp(b,"fRT"))if(!this.gtRwPrp(b,"fRgT")){var c=this.gtRwById(b).getChildById("sb").get_TextContent(),d=this,e=function(b,a,c){d.cbDelRcrTskDlg(b,a,c)};shwDelRcrTskDlg(e,c,a);return}a.rgDl.push(b);a.iIdx++}a.sErr&&alrt(a.sErr);this.get_SubPage().del(a.fP,a.rgDl,false,a.fRf);this.get_SubPage().del(a.fP,a.rgDlO,true,true)};Owa.UIControls.TskVLV.prototype.cbDelRcrTskDlg=function Owa$UIControls$TskVLV$cbDelRcrTskDlg(b,c,a){if(b==-1||b==1)return;if(c)a.rgDlO.push(a.rg.get_Item(a.iIdx));else a.rgDl.push(a.rg.get_Item(a.iIdx));a.iIdx++;this.prRcTsks(a)};Owa.UIControls.TskVLV.prototype.fndChk=function Owa$UIControls$TskVLV$fndChk(b){return b.getAncestorById("chkMkCmp",a)};Owa.UIControls.TskVLV.prototype.clkMkCmp=function Owa$UIControls$TskVLV$clkMkCmp(c){var a=this.getData(c);if(a.getBoolAttribute("fAT"))return;var b=c.getDescendantById("chkMkCmp").get_IsChecked();this.mkCmp([a.sId],a.getAttribute("fRT"),b);this.updTskCmp(a.sId,b);updCmp(window)};Owa.UIControls.TskVLV.prototype.mkCmp=function Owa$UIControls$TskVLV$mkCmp(c,h,b){this.incPndCnt(this.isSrtCmp()||h&&!b);var a={};a.oItms=c;a.f=0;a.fUdRP=1;var d=this.iFltr,f=this.gtSelAftrRmv(this.iNsDir,c),g=!b&&(d==TF_ACT||d==TF_OVD)||b&&d==TF_CMP;if(g&&this.isSel(this.gtRwById(c[0]))&&f)a.fUdRP=0;var e=new oeReq(this.sEvtNS,"MarkComplete",a,this._createCallback(this.cbMkCmp));e.addRg("Itms",c);if(b){e.add("mkIncmp",1);a.f=1}e.send()};Owa.UIControls.TskVLV.prototype.cbMkCmp=function Owa$UIControls$TskVLV$cbMkCmp(a){this.decPndCnt(!!a.sErr);if(!cbOeh(a))return;if(this.get_SubPage().isPF()||this.get_SubPage().isOMF())for(var b=0;b<a.oCtx.oItms.get_Length();b++)this.updTskCmp(a.oCtx.oItms.get_Item(b),a.oCtx.f);a.oCtx.fUdRP&&this.feSelChg()};Owa.UIControls.TskVLV.prototype.flgItm=function Owa$UIControls$TskVLV$flgItm(a,b){if(a==FA_ClrFlg||a==FA_MrkCmpl)this.updTskCmp(b,0);else this.rfrsh(1)};Owa.UIControls.TskVLV.prototype.updTskCmp=function Owa$UIControls$TskVLV$updTskCmp(b,c){var e=this.iFltr;if(!c&&(e==TF_ACT||e==TF_OVD)||c&&e==TF_CMP){if(this.gtRwPrp(b,"fRT"))return;var d=this.gtSelAftrRmv(this.iNsDir,[b]);this.rmvRw(b);if(!this.gtSelCnt()&&d){this.selSngl(d);this.scrToVwprt(d)}this._resetCurrentRowPosition()}else{var a=this.gtRwById(b);if(!a)return;a.getDescendantById("chkMkCmp").set_IsChecked(!c);this.updTskStls(a);var f=this.getData(a);f.setIntAttribute("sFA",c?FA_Dflt:FA_MrkCmpl)}};Owa.UIControls.TskVLV.prototype.fndImp=function Owa$UIControls$TskVLV$fndImp(b){return b.getAncestorById("divImp",a)};Owa.UIControls.TskVLV.prototype.clkTgImp=function Owa$UIControls$TskVLV$clkTgImp(e){var a=this.getData(e);if(a.getBoolAttribute("fAT"))return;this.incPndCnt(this._getArrangeByColumnId("divIm")==this.iSC);if(a.getIntAttribute("iTO")){this._clearTimeout(a.getIntAttribute("iTO"));a.setIntAttribute("iTO",0);this.decPndCnt()}var c=e.getChildById("divImp"),b;if(a.getIntAttribute("iI")==I_N){b="ih.gif";a.setIntAttribute("iI",I_HI)}else if(a.getIntAttribute("iI")==I_HI){b="il.gif";a.setIntAttribute("iI",I_LO)}else a.setIntAttribute("iI",I_N);c.removeAllChildNodes();if(b){var d=Owa.Components.CssSprites.getImageElement(b);d.addCssClass("imp");c.appendChild(d)}var f=this,g=function(){f.tgI(a)};a.setIntAttribute("iTO",this._setTimeout(g,750))};Owa.UIControls.TskVLV.prototype.tgI=function Owa$UIControls$TskVLV$tgI(a){var b=new oeReq(this.sEvtNS,"SetImportance",0,this._createCallback(this.cbTgI));b.add("id",a.sId);b.add("imp",a.getIntAttribute("iI"));b.send();a.setIntAttribute("iTO",0)};Owa.UIControls.TskVLV.prototype.cbTgI=function Owa$UIControls$TskVLV$cbTgI(a){this.decPndCnt(!!a.sErr);if(!cbOeh(a))return;this.feSelChg()};Owa.UIControls.TskVLV.prototype.fndDD=function Owa$UIControls$TskVLV$fndDD(b){return b.getAncestorById("dd",a)};Owa.UIControls.TskVLV.prototype.setDD=function Owa$UIControls$TskVLV$setDD(b){this.incPndCnt(1);var a=new oeReq(this.sEvtNS,"SetDueDate",b,this._createCallback(this.cbSetDD));a.add("id",this.getData(this.fndRw(b)).sId);var c=this.oDatePickerDropDown.get_SelectedValue();c&&a.add("ddt",c);a.send()};Owa.UIControls.TskVLV.prototype.cbSetDD=function Owa$UIControls$TskVLV$cbSetDD(b){this.decPndCnt(!!b.sErr);if(!cbOeh(b))return;var d=b.oCtx,a=h.get_Current().createElement("DIV");a.set_InnerHtml(b.sBody);a=a.getChildById(r);d.set_InnerHtml(a.get_InnerHtml());var e=this.fndRw(d),c=this.getData(e);c.setAttribute("dtDD",a.getAttribute("dtDD"));c.setAttribute("fOD",a.getAttribute("fOD"));this.updTskStls(e);this.feSelChg()};Owa.UIControls.TskVLV.prototype.shwTskDP=function Owa$UIControls$TskVLV$shwTskDP(c,e,d){var a=this.oDatePickerDropDown;if(this.fDPLd&&!a)return;if(a){a.selectValue(e);a.showUnder(c,3,true);a.oE=c;a.cb=d}else{this.fDPLd=1;var b={};b.oE=c;b.dt=e;b.cb=d;var f=new oeReq(this.sEvtNS,"GetDatePicker",b,this._createCallback(this.cbShwTskDP));f.send()}};Owa.UIControls.TskVLV.prototype.cbShwTskDP=function Owa$UIControls$TskVLV$cbShwTskDP(a){if(!cbOeh(a))return;var b=h.get_Current().createElement("div");b.set_InnerHtml(a.sBody);var c=b.getDescendantById("divDueDateDropDown"),d=this._getDescendant("divDueDate");h.get_Current().get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,b.get_FirstChild());b.remove(true);this.oDatePickerDropDown=this.addResource(new Owa.UIControls.DatePickerDropDown(c,d));this.oDatePickerDropDown.set_SubPage(this.get_SubPage());this.oDatePickerDropDown.initialize();var e=this,f=function(){e.onDPSelDt()};this.oDatePickerDropDown.get_OnChange().add(f);this.fDPLd=0;this.shwTskDP(a.oCtx.oE,a.oCtx.dt,a.oCtx.cb)};Owa.UIControls.TskVLV.prototype.onDPSelDt=function Owa$UIControls$TskVLV$onDPSelDt(){this.oDatePickerDropDown.close();this.oDatePickerDropDown.cb(this.oDatePickerDropDown.oE)};Owa.UIControls.TskVLV.prototype.gtNATsks=function Owa$UIControls$TskVLV$gtNATsks(e,d){var b={};b.rg=[];for(var a=this.gtSel(),c=0;c<a.get_Length();c++)!this.gtRwPrp(a.get_Item(c),"fAT")&&b.rg.push(a.get_Item(c));if(a.get_Length()-b.rg.get_Length())b.sErr=a.get_Length()==1?e:d;return b};Owa.UIControls.TskVLV.prototype.updTskStls=function Owa$UIControls$TskVLV$updTskStls(a){var d=this.getData(a),c="tskOvd",b="tskCmp";if(a.getDescendantById("chkMkCmp").get_IsChecked()){a.removeCssClass(c);a.addCssClass(b);Owa.Components.CssSprites.updateImage(a.getDescendantById("imgFlg"),"flg-compl.gif")}else{a.removeCssClass(b);d.getAttribute("fOD")&&a.addCssClass(c);Owa.Components.CssSprites.updateImage(a.getDescendantById("imgFlg"),"icon-flag.gif")}};Owa.UIControls.AddressBookVLV=function Owa$UIControls$AddressBookVLV(c,b){Owa.UIControls.AddressBookVLV.constructBase(this,[c,b]);var a=b;this.fPaaPicker=!!getInt(a.getAttribute("fPaa"));this.fMobilePicker=!!getInt(a.getAttribute("fMbl"));this.sCookie=a.getAttribute("sCki");this.iCookieLcid=a.getIntAttribute("iLcid");this.sPreferredDC=a.getAttribute("sPfdDC");this.iCookieIndex=0;this.fAD=1};Owa.UIControls.AddressBookVLV.createClass("Owa.UIControls.AddressBookVLV",Owa.UIControls.VLV);Owa.UIControls.AddressBookVLV.prototype.find=function Owa$UIControls$AddressBookVLV$find(){this.clearCookieInformation();Owa.UIControls.AddressBookVLV.callBase(this,"find")};Owa.UIControls.AddressBookVLV.prototype.clrFind=function Owa$UIControls$AddressBookVLV$clrFind(a){this.clearCookieInformation();Owa.UIControls.AddressBookVLV.callBase(this,"clrFind",[a,true])};Owa.UIControls.AddressBookVLV.prototype.clearCookieInformation=function Owa$UIControls$AddressBookVLV$clearCookieInformation(){this.sCookie="";this.iCookieLcid=0;this.sPreferredDC="";this.iCookieIndex=0};Owa.UIControls.AddressBookVLV.prototype.tdSrch=function Owa$UIControls$AddressBookVLV$tdSrch(){if(this.fSrch)return;Owa.UIControls.AddressBookVLV.callBase(this,"tdSrch")};Owa.UIControls.AddressBookVLV.prototype.addLVSt=function Owa$UIControls$AddressBookVLV$addLVSt(b){var a=new oeSt(b,"ADVLVS");a.add("sId",this.sSid);a.add("mL",this.fML);a.add("sC",this.iSC);a.add("sO",this.iSO);a.add("cki",this.sCookie);a.add("ckii",this.iCookieIndex);a.add("clcid",this.iCookieLcid);a.add("cPfdDC",this.sPreferredDC);b.addSt("St",a);this.fSrch&&this.fnGtSF(b);this.fPaaPicker&&b.add("paa",this.fPaaPicker?1:0);this.fMobilePicker&&b.add("mbl",new String(this.fMobilePicker))};Owa.UIControls.AddressBookVLV.prototype.initChnk=function Owa$UIControls$AddressBookVLV$initChnk(a){if(getInt(a.getAttribute(t))||getInt(a.getAttribute("fNull")))this.iCookieIndex=0;else this.iCookieIndex=a.getIntAttribute("iER");Owa.UIControls.AddressBookVLV.callBase(this,"initChnk",[a])};Owa.UIControls.AddressBookVLV.prototype.prcsDta=function Owa$UIControls$AddressBookVLV$prcsDta(b){Owa.UIControls.AddressBookVLV.callBase(this,"prcsDta",[b]);var a=b.getChildById(r);this.sCookie=a.getAttribute("sCki");this.iCookieLcid=a.getIntAttribute("iLcid");this.sPreferredDC=a.getAttribute("sPfdDC")};Owa.UIControls.AddressBookVLV.prototype.ldAdj=function Owa$UIControls$AddressBookVLV$ldAdj(e){if(!this.strtLd(E,arguments))return;var b=e?this.ER()+1:this.SR()-l,a=l;if(b<0){b=0;a=this.SR()}else if(b+a>this.iTC-1)a=this.iTC-1-this.ER();if(a>0){var d={};d.fIsLoadAdjacent=true;d.fNxt=e;var c=new oeReq(this.sEvtNS,"LoadFresh",d,this._createCallback(this.cbLdSafe),POST);this.addLVSt(c);c.add("SR",b);c.add("RC",a);c.send()}else this.endLd()};Owa.UIControls.AddressBookVLV.prototype.ldSk=function Owa$UIControls$AddressBookVLV$ldSk(d,c,a){a&&a(this)};Owa.UIControls.AddressBookVLV.prototype.selNPRw=function Owa$UIControls$AddressBookVLV$selNPRw(c,a,b,d){if(!d){Owa.UIControls.AddressBookVLV.callBase(this,"selNPRw",[c,a,b]);return}this.selectFirstLastVisibleRow(b);a&&this.feNav(a)};Owa.UIControls.AddressBookVLV.prototype.seekRw=function Owa$UIControls$AddressBookVLV$seekRw(b,a){if(!a){Owa.UIControls.AddressBookVLV.callBase(this,"seekRw",[b]);return}this.selectFirstLastVisibleRow(true)};Owa.UIControls.AddressBookVLV.prototype.extndRng=function Owa$UIControls$AddressBookVLV$extndRng(a,b){if(!b){Owa.UIControls.AddressBookVLV.callBase(this,"extndRng",[a]);return}this.selectFirstLastVisibleRow(a,true)};Owa.UIControls.AddressBookVLV.prototype.selectFirstLastVisibleRow=function Owa$UIControls$AddressBookVLV$selectFirstLastVisibleRow(c){var a=c?this.getFirstVisibleRow():this.getLastVisibleRow(),b=this.gtRw(a.iRow,a.iSubRow);b&&this.selSngl(b,false,true)};Owa.UIControls.AddressBookVLV.prototype.onClkHdr=function Owa$UIControls$AddressBookVLV$onClkHdr(a){a.preventDefault();a.cancelBubble()};Owa.UIControls.ContactsVLV=function Owa$UIControls$ContactsVLV(c,b){Owa.UIControls.ContactsVLV.constructBase(this,[c,b]);var a=b;this.fPaaPicker=!!getInt(a.getAttribute("fPaa"));this.fMobilePicker=!!getInt(a.getAttribute("fMbl"))};Owa.UIControls.ContactsVLV.createClass("Owa.UIControls.ContactsVLV",Owa.UIControls.FldrVLV);Owa.UIControls.ContactsVLV.prototype.addLVSt=function Owa$UIControls$ContactsVLV$addLVSt(a){Owa.UIControls.ContactsVLV.callBase(this,"addLVSt",[a]);this.fPaaPicker&&a.add("paa",this.fPaaPicker?1:0);this.fMobilePicker&&a.add("mbl",new String(this.fMobilePicker))};Owa.UIControls.DumpsterVLV=function Owa$UIControls$DumpsterVLV(b,a){Owa.UIControls.DumpsterVLV.constructBase(this,[b,a])};Owa.UIControls.DumpsterVLV.createClass("Owa.UIControls.DumpsterVLV",Owa.UIControls.FldrVLV);Owa.UIControls.DumpsterVLV.prototype.addLVSt=function Owa$UIControls$DumpsterVLV$addLVSt(b){var a=new oeSt(b,"FVLVS");a.add("sId",this.sSid);a.add("mL",this.fML);a.add("sC",this.iSC);a.add("sO",this.iSO);b.addSt("St",a);this.fSrch&&this.fnGtSF(b)};Owa.UIControls.DumpsterVLV.prototype.onDblClkVP=function Owa$UIControls$DumpsterVLV$onDblClkVP(a){alrt(L_RcvWrng);a.preventDefault();a.cancelBubble()};Owa.UIControls.DumpsterVLV.prototype.onDS=function Owa$UIControls$DumpsterVLV$onDS(a){a.preventDefault();a.cancelBubble()};Owa.UIControls.DumpsterVLV.prototype.updCnts=function Owa$UIControls$DumpsterVLV$updCnts(){var a=this.get_SubPage().get_ParentSubPage();a&&a.get_Breadcrumbs().set_Count(this.gtTIC())};Owa.UIControls.DumpsterVLV.prototype.purgeItems=function Owa$UIControls$DumpsterVLV$purgeItems(){var b=this.gtSel(1),d=b.length;if(!d)return;if(d>MAX_REQ_ITMS){alrt(L_ErrMaxItms);return}if(!confirm(L_ConfirmPD))return;var a={};a.isPD=true;a.rgId=b;var c=new oeReq(this.sEvtNS,"PermanentDelete",a,this._createCallback(this.cbPurgeItems));c.addRg("Itms",b);c.add("fId",this.sSid);c.send()};Owa.UIControls.DumpsterVLV.prototype.cbPurgeItems=function Owa$UIControls$DumpsterVLV$cbPurgeItems(c){if(!cbOeh(c))return;var b,a=h.get_Current().createElement("div");a.set_InnerHtml(c.sBody);if(a.getDescendantById("eib"))b=a.getDescendantById("eib").get_InnerHtml();a.remove(true);var d=h.get_Current().get_Body();b&&alrt(b);this.rmvRws(c.oCtx.rgId);this.updCnts()}})();stJS("vlv.js")eF      YDeYDe>+Y   >    :https://mail.logica.com/owa/14.3.319.2/scripts/premium/vlv.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAVPMIIFSzCCBDOgAwIBAgIQC9oUlvTJTE7TC0j08zttrDANBgkqhkiG9w0BAQsFADBwMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNzdXJhbmNlIFNlcnZlciBDQTAeFw0xNzA4MTgwMDAwMDBaFw0xODEwMDExMjAwMDBaMF4xCzAJBgNVBAYTAkdCMRAwDgYDVQQHEwdSZWFkaW5nMRcwFQYDVQQKEw5Mb2dpY2EgTGltaXRlZDENMAsGA1UECxMERUlJUzEVMBMGA1UEAwwMKi5sb2dpY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzuYMsuU3piAX99KZg+15ZU9OKmiMfNCWme5/Iz8Agp2MxYMF4mLUcfss1x5fB0mMY+KvwAyfSyor56jR7dy3NKMreZRH1Q/YeFQW5MMs7paDof2KI5PtBspIXbQag6WYYtW10v/lkd+as+VD6jyhfU6+osD9HrbIK5dxToF6mfJqk/ky8nwphaA2FHoRKTdAMiQh9RS5IYKDzeaoPxLy+M+qvME3urniOQqd9Od7sqG4ml+wqS7+xB7UAl+ochD4A/rwewdhccwt91RNkn1E4j1RaZ6FYcuszvBcYih+m1wcQn/ACTrAAWV+ziST2h7LfUmEtMPVQ4swHYI8diuPfQIDAQABo4IB8TCCAe0wHwYDVR0jBBgwFoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKinxbIi/V/Ey/fqtiPTDEcBOGc5MCMGA1UdEQQcMBqCDCoubG9naWNhLmNvbYIKbG9naWNhLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwTAYDVR0gBEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwgYMGCCsGAQUFBwEBBHcwdTAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEySGlnaEFzc3VyYW5jZVNlcnZlckNBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQBQjp60tISk4788ERXDdQQKXRiEr75a1DYfG2ouVr/8OYlwgS5AwIEapDT7vqli2n3LbeeVgzUz2cZm9Bc/WjyYmSRlZtFYoSn6muFvYOjr0v5aiJXyFdz03emn93quN95xu4MnDmqoBsxEvyOHgO7TXhnpmO/aF9jA01L7SLfZI5TvVaOGQ2vAU6h5cOdXp18nuJGk+o1274scCkBK60dJwRaUtz7zMp2vr3FpOfvLqpkzBkUC8Iv0sXVfPgZFINyMTDW14QAbzWSsbr3EQEJ7ioAqjEBsScJjGFk5V+GDpyz3z9nLjoM/fWKl7sS5Z9VaztyzpEvomyQsd6sZPdubAC8AAwAAAAABAQAA request-method GET response-head HTTP/1.1 200 OK
Content-Length: 140614
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "046e4d3392ecf1:0"
Accept-Ranges: bytes
Cache-Control: public,max-age=2592000
Last-Modified: Thu, 20 Feb 2014 12:46:52 GMT
X-Powered-By: ASP.NET
 original-response-headers Connection: Keep-Alive
Content-Length: 140614
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "046e4d3392ecf1:0"
Accept-Ranges: bytes
Set-Cookie: CAS_LB_Service=R3418549887; path=/
Cache-Control: public,max-age=2592000
Last-Modified: Thu, 20 Feb 2014 12:46:52 GMT
X-Powered-By: ASP.NET
 uncompressed-len 0  %F