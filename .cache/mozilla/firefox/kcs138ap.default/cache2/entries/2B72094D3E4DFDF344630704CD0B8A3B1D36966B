var g_fModuleLoaded={},RP_NONE=-1,RP_OFF=0,RP_RIGHT=1,RP_BOTTOM=2,LVT_MSG=0,LVT_CTM=1,LVT_CTL=2,LVT_CTP=3,LVT_TSK=4,LVT_DRL=5,LVT_DRP=6,LVT_RML=7,LVT_RMP=8,LVT_DOC=9,LVT_DMP=10,JES_NJNK=0,JES_JNK=1,JES_UNK=2,MSG_MARKED_UNREAD=-1,MSG_UNREAD=0,MSG_READ=1,PONT_IGNCNV=128,PONT_CANIGNCNV=256;!g_fModuleLoaded[".\\uicontrols/notificationdialog.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var a={},b=0;Owa.UIControls.NotificationDialog=function Owa$UIControls$NotificationDialog(b,a,e,c){Owa.UIControls.NotificationDialog.constructBase(this,[b.get_Id(),0,1,0,0,1,1]);this._isOpened=0;this._sSelectionClass="divNotificationsItemSelected";this._sDisabledClass="aNotificationsButtonDisabled";this._oContent=$(a+"Data");this._oBody=$(a+"DlgBdy");this._oTopBorderLeft=$(a+"DlgTopBorderLeft");this._oTopBorderRight=$(a+"DlgTopBorderRight");this._fAllowMultiSelect=0;this._fSelectFirstItemOnShow=1;this._fSetFocus=0;this._sTitlebarButtonId=c;this._rgButtons=e;this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"dblclick",this._onDoubleClick);this._attachEvent(this._get_Element(),"contextmenu",new Function("return (0)"));var d=new Owa.Components.ClientActionTable(Owa.Utility.createDelegate(this,this._onAction));this._oHotKeyManager=new Owa.Components.HotKeyManagerPage(d,Owa.Components.Application.get_RootSubPage());this._oHotKeyManager.addHotKey(L_HkSel,"selectall").addHotKey("esc","hide").addHotKey("tab","tab").addHotKey("shift+tab","shifttab").addHotKey("enter","enter").addHotKey("down","down").addHotKey("up","up").addHotKey("end","end").addHotKey("home","home");this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnShow().add(this._createCallback(this._onShow))};Owa.UIControls.NotificationDialog.getDialog=function Owa$UIControls$NotificationDialog$getDialog(b){return!a?null:a[b]};Owa.UIControls.NotificationDialog.addDialog=function Owa$UIControls$NotificationDialog$addDialog(c,d){if(a[c]==null){a[c]=d;b++}return a[c]};Owa.UIControls.NotificationDialog.hideAllDialogs=function Owa$UIControls$NotificationDialog$hideAllDialogs(){var b=Owa.Utility.getRootOwaWindow(),c=Owa.Dom.Window.get_Current();if(!c.equals(b))b._domWindow.Owa&&b._domWindow.Owa.UIControls&&b._domWindow.Owa.UIControls.NotificationDialog&&b._domWindow.Owa.UIControls.NotificationDialog.hideAllDialogs();else for(var d in a)a[d].hide()};Owa.UIControls.NotificationDialog.anyDialogsOpen=function Owa$UIControls$NotificationDialog$anyDialogsOpen(){for(var b in a)if(a[b].isOpened())return true;return false};Owa.UIControls.NotificationDialog.disposeAll=function Owa$UIControls$NotificationDialog$disposeAll(){for(var b in a)a[b].dispose()};Owa.UIControls.NotificationDialog.prototype.dispose=function Owa$UIControls$NotificationDialog$dispose(){if(!this._disped){this._get_Element().detachAllEvents();this._detachEvent(this._get_Element().get_OwnerDocument(),"keydown",this._onKeyDown);this._rgButtons=null;this._disped=1;removeDialogFromList(this.get_Id());this._oHotKeyManager.dispose();Owa.UIControls.NotificationDialog.callBase(this,"dispose")}};Owa.UIControls.NotificationDialog.prototype.isOpened=function Owa$UIControls$NotificationDialog$isOpened(){return this._isOpened};Owa.UIControls.NotificationDialog.prototype.selectFirstItem=function Owa$UIControls$NotificationDialog$selectFirstItem(b){var a=this.getItems();if(!a.length)return;this.unselectAllItems();this.selectItem(a[0],1,b)};Owa.UIControls.NotificationDialog.prototype.getItemById=function Owa$UIControls$NotificationDialog$getItemById(b){var a=null;this._oContent.forEachChild(function(c){if(c.getAttribute("_lnk")=="1"&&c.get_IsShown()&&b==c.get_Id())a=c});return a};Owa.UIControls.NotificationDialog.prototype.getItems=function Owa$UIControls$NotificationDialog$getItems(b){var a=[];this._oContent.forEachChild(function(c){c.getAttribute("_lnk")=="1"&&(b||c.get_IsShown())&&a.push(c)});return a};Owa.UIControls.NotificationDialog.prototype.getSelectedItem=function Owa$UIControls$NotificationDialog$getSelectedItem(){for(var b=this.getItems(),c=[],a=0;a<b.length;a++)b[a].getExpando("_sel")&&c.push(b[a]);return c};Owa.UIControls.NotificationDialog.prototype.unselectAllItems=function Owa$UIControls$NotificationDialog$unselectAllItems(){for(var b=this.getItems(),a=0;a<b.length;a++)this.selectItem(b[a],0)};Owa.UIControls.NotificationDialog.prototype.selectItem=function Owa$UIControls$NotificationDialog$selectItem(a,b,d){if(b)a.addCssClass(this._sSelectionClass);else a.removeCssClass(this._sSelectionClass);a.setExpando("_sel",b);var c=this.getSelectedItem();this._enableButtons(c.length);b&&d&&a.focus();return c};Owa.UIControls.NotificationDialog.prototype.removeItems=function Owa$UIControls$NotificationDialog$removeItems(b){for(var c=b.length,a=0;a<c;++a)b[a].remove(true);this.updateTitlebarButton()};Owa.UIControls.NotificationDialog.prototype.hide=function Owa$UIControls$NotificationDialog$hide(){if(this.isOpened()){this._oHotKeyManager.set_Enabled(false);Owa.UIControls.NotificationDialog.callBase(this,"hide")}};Owa.UIControls.NotificationDialog.prototype.show=function Owa$UIControls$NotificationDialog$show(b){if(!this.getItems().length||this.isOpened())return;Owa.UIControls.NotificationDialog.hideAllDialogs();this._prepareToShowDialog(b);!this._get_Element().get_IsShown()&&this._get_Element().set_IsShown(true);var a=this._getTitlebarButton(),c=getPopupXPositionForShowUnder(a,this._get_Element()),d=a.get_DocumentTop()+a.get_OffsetHeight()+1;adjustTopBordersAroundButton(this,a,this._oTopBorderLeft,this._oTopBorderRight);this._oHotKeyManager.set_Enabled(true);Owa.UIControls.NotificationDialog.callBase(this,"show",[c,d])};Owa.UIControls.NotificationDialog.prototype.toggleDialog=function Owa$UIControls$NotificationDialog$toggleDialog(){if(this.isOpened())this.hide();else{this._fSetFocus=1;this.show()}};Owa.UIControls.NotificationDialog.prototype.setItemsHtml=function Owa$UIControls$NotificationDialog$setItemsHtml(a){this._oContent.set_InnerHtml(a)};Owa.UIControls.NotificationDialog.prototype.updateTitlebarButton=function Owa$UIControls$NotificationDialog$updateTitlebarButton(d){var b=this._getTitlebarButton();if(!b)return;var a=this.getItems().length,c=b.get_IsShown();b.getDescendantById("spnRmT").set_TextContent(a.toString());if(!a&&c||d)showNotificationButton(this._sTitlebarButtonId,false);else if(a){c&&showNotificationButton(this._sTitlebarButtonId,false);showNotificationButton(this._sTitlebarButtonId,true)}};Owa.UIControls.NotificationDialog.prototype._onMouseDown=function Owa$UIControls$NotificationDialog$_onMouseDown(b){var a=this._findItem(b.get_Target());if(!a)return;if(b.isCtrlKeyDown()&&this._fAllowMultiSelect)if(a.getExpando("_sel"))this.selectItem(a,0);else this.selectItem(a,1);else{this.unselectAllItems();this.selectItem(a,1,1)}};Owa.UIControls.NotificationDialog.prototype._onClick=function Owa$UIControls$NotificationDialog$_onClick(a){var b=a.get_Target();if(b.getExpando("_disabled"))return;var d=b.get_Id(),c=this.getSelectedItem();this._handleButtonPress(d,c);a.preventDefault();a.cancelBubble()};Owa.UIControls.NotificationDialog.prototype._onDoubleClick=function Owa$UIControls$NotificationDialog$_onDoubleClick(){};Owa.UIControls.NotificationDialog.prototype._onAction=function Owa$UIControls$NotificationDialog$_onAction(k,j){var a=this.getItems(),b=-1,e=false;if(!this.isOpened())return;for(var c=0;c<a.length&&b<0;c++)if(a[c].getExpando("_sel"))b=c;var d=b!=-1,h=j;switch(k){case"selectall":this._selectAll();break;case"hide":this.hide();break;case"shifttab":e=true;case"tab":if(!this._rgButtons||this._rgButtons.length==0)return;for(var f=0,i=false,c=0;c<this._rgButtons.length;c++)if(h.get_Id()==this._rgButtons[c].get_Id()){f=c;i=true;break}if(i)if(f==this._rgButtons.length-1&&!e||f==0&&e)if(d)a[b].focus();else this.selectItem(a[0],1,1);else{var g=f+(e?-1:1);g>=0&&g<this._rgButtons.length&&this._rgButtons[g].focus()}break;case"enter":if(h.get_TagName().toLowerCase()=="button")return;if(this._onEnterPressed(h))return;break;case"down":if(b==a.length-1)break;if(d){this.selectItem(a[b],0);this.selectItem(a[b+1],1,1)}else this.selectItem(a[0],1);break;case"up":if(d&&b!=0){this.selectItem(a[b],0);this.selectItem(a[b-1],1,1)}break;case"end":if(b==a.length-1)break;d&&this.selectItem(a[b],0);this.selectItem(a[a.length-1],1,1);break;case"home":if(b<=0)break;d&&this.selectItem(a[b],0);this.selectItem(a[0],1,1)}};Owa.UIControls.NotificationDialog.prototype._selectAll=function Owa$UIControls$NotificationDialog$_selectAll(){if(this._fAllowMultiSelect){this.unselectAllItems();for(var b=this.getItems(),a=0;a<b.length;a++)this.selectItem(b[a],1)}};Owa.UIControls.NotificationDialog.prototype._findItem=function Owa$UIControls$NotificationDialog$_findItem(a){if(!this._oContent.contains(a))return 0;while(a&&a instanceof Owa.Dom.Element){if(a.getAttribute("_lnk")=="1")return a;a=a.get_ParentElement()}return 0};Owa.UIControls.NotificationDialog.prototype._enableButtons=function Owa$UIControls$NotificationDialog$_enableButtons(c){for(var b=0;b<this._rgButtons.length;b++){var a=this._rgButtons[b];if(a.getAttribute("preventDisable")&&a.getIntAttribute("preventDisable"))continue;if(c>0){a.removeCssClass(this._sDisabledClass);a.setExpando("_disabled",false)}else{a.addCssClass(this._sDisabledClass);a.setExpando("_disabled",true)}}};Owa.UIControls.NotificationDialog.prototype._handleButtonPress=function Owa$UIControls$NotificationDialog$_handleButtonPress(){};Owa.UIControls.NotificationDialog.prototype._prepareToShowDialog=function Owa$UIControls$NotificationDialog$_prepareToShowDialog(){var b=getViewSubPageControllerByFolderId(a_sLstFID);if(!b)return;var d=b.getVariable("Owa"),c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b),a=c?c.get_FilterContextMenu():null;if(!a)return;if(a.get_FromMenu()&&a.get_FromMenu().fIsOpen){a.get_FromMenu()._suppressClose();this._fRestoreFocusToFilterMenu=true}else if(a.fIsOpen){a._suppressClose();this._fRestoreFocusToFilterMenu=true}};Owa.UIControls.NotificationDialog.prototype._onEnterPressed=function Owa$UIControls$NotificationDialog$_onEnterPressed(){};Owa.UIControls.NotificationDialog.prototype._getTitlebarButton=function Owa$UIControls$NotificationDialog$_getTitlebarButton(){return $(this._sTitlebarButtonId)};Owa.UIControls.NotificationDialog.prototype._onClose=function Owa$UIControls$NotificationDialog$_onClose(){this._isOpened=0;applyNotificationButtonStyle(0,this._sTitlebarButtonId);if(this._fRestoreFocusToFilterMenu){var b=getViewSubPageControllerByFolderId(a_sLstFID);if(!b)return;var c=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(b),a=c?c.get_FilterContextMenu():null;if(a.get_FromMenu()&&a.get_FromMenu().fIsOpen)a.get_FromMenu()._enableClose();else a.fIsOpen&&a._enableClose();this._fRestoreFocusToFilterMenu=false}};Owa.UIControls.NotificationDialog.prototype._onShow=function Owa$UIControls$NotificationDialog$_onShow(){applyNotificationButtonStyle(1,this._sTitlebarButtonId);this._fSelectFirstItemOnShow&&this.selectFirstItem(0);if(this._fSetFocus){var a=this.getSelectedItem();a.length>0&&a[0].focus()}this._isOpened=1;this._fSetFocus=0};function removeDialogFromList(c){if(a[c]!=null){a[c]=null;b--}if(b==0)a={}}Owa.UIControls.NotificationDialog.createClass("Owa.UIControls.NotificationDialog",Owa.UIControls.Dialog)})();g_fModuleLoaded[".\\uicontrols/notificationdialog.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/remindersnoozetimecombobox.js".toLowerCase()]&&(function(){Owa.UIControls.ReminderSnoozeTimeComboBox=function Owa$UIControls$ReminderSnoozeTimeComboBox(a,b){Owa.UIControls.ReminderSnoozeTimeComboBox.constructBase(this,[a,b])};Owa.UIControls.ReminderSnoozeTimeComboBox.prototype.updateSnoozeTime=function Owa$UIControls$ReminderSnoozeTimeComboBox$prototype$updateSnoozeTime(a){var b=null;if(a>=0)b=a>5?"-5":"0";for(var d=0;d<this._oDropDownList.getItemCount();d++){var c=getInt(this._oDropDownList.getValueByIndex(d)),e=this._oDropDownList.getDomItemByIndex(d);if(c<=0)e.set_IsShown(a+c>0||a==0&&c==0);else if(b==null)b=c.toString()}this._selectValue(b)};Owa.UIControls.ReminderSnoozeTimeComboBox.createClass("Owa.UIControls.ReminderSnoozeTimeComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/remindersnoozetimecombobox.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/ReminderDialog.js".toLowerCase()]&&(function(){var a="divRmdDlg",b=6e4,h=0,f=1,g=2,i=3,e="reminderNow",d="reminderPastdue",c="reminderOverdue";Owa.UIControls.ReminderDialog=function Owa$UIControls$ReminderDialog(a){Owa.UIControls.ReminderDialog.constructBase(this,[a,"divRmd",[$("divBtnDismissall"),$("divBtnDismiss"),$("divBtnOpenReminder"),$("divBtnSnooze")],Owa.Strings.Ids.ReminderNotificationButtonId]);this._oRmdSnzDD=new Owa.UIControls.ReminderSnoozeTimeComboBox($("divRmdSnzDD"),null);this._oRmdSnzDD.set_SubPage(this.get_SubPage());this._oRmdSnzDD.initialize();this.dtLastReminderTime=0;this.iTimeDifference=0;this.fSoundEnabled=getInt(this._getAttribute("fSoundEnabled"));this.iTimeOffset=this._getAttribute("iTimeOffset");this._dtNextReminderTime=0;this._oNextReminderItem=0;this._dtLastRefreshTime=0;this._rgTimeUnits=this._getAttribute("rgTU").split(",");this._iReminderTimer=0;this._iReminderDueInTimer=0;this._sNow=this._getAttribute("sNow");this._fAllowMultiSelect=1;this._sOverdueString=this._getAttribute("sOverdue");this.get_OnShow().add(this._createCallback(this._adjustWidth))};Owa.UIControls.ReminderDialog.getDialog=function Owa$UIControls$ReminderDialog$getDialog(){var b=Owa.UIControls.NotificationDialog.getDialog(a);if(b==null){var c=$(a);if(!c)return null;b=Owa.UIControls.NotificationDialog.addDialog(a,new Owa.UIControls.ReminderDialog(c))}return b};Owa.UIControls.ReminderDialog.prototype.dispose=function Owa$UIControls$ReminderDialog$dispose(){Owa.UIControls.ReminderDialog.callBase(this,"dispose");if(!this._disped||this._disped<=1){this._clearTimer();this._clearDueInTimer();this._oRmdSnzDD.dispose();this._disped++}};Owa.UIControls.ReminderDialog.prototype.setItemsHtml=function Owa$UIControls$ReminderDialog$setItemsHtml(b){Owa.UIControls.ReminderDialog.callBase(this,"setItemsHtml",[b]);var a=this;this._oContent.forEachChild(function(b){a._updateReminderItemDueIn(b)})};Owa.UIControls.ReminderDialog.prototype.get_Key=function Owa$UIControls$ReminderDialog$get_Key(){for(var d=this.getItems(true),b=[],c=0;c<d.length;c++){var a=d[c];if(a.get_IsShown()){b.push(a.get_Id());b.push(a.getAttribute("subj"));b.push(a.getAttribute("loc"));b.push(a.getAttribute("due"))}}return b};Owa.UIControls.ReminderDialog.prototype.get_LastKey=function Owa$UIControls$ReminderDialog$get_LastKey(){return this._rgKeys};Owa.UIControls.ReminderDialog.prototype.show=function Owa$UIControls$ReminderDialog$show(){this._rgKeys=this.get_Key();Owa.UIControls.ReminderDialog.callBase(this,"show",arguments)};Owa.UIControls.ReminderDialog.prototype.removeItems=function Owa$UIControls$ReminderDialog$removeItems(c,f,e){if(!f)f=OP_DIS;for(var h=c.length-1,a=0;a<c.length;++a){if(a==h){var b=this.getItems();this.nxtSelId=null;if(b.length>1)for(var d=0;d<b.length;d++)if(b[d].get_Id()==c[a].get_Id())this.nxtSelId=d==b.length-1?b[d-1].get_Id():b[d+1].get_Id()}var g=e&&e[a].fD;this._removeReminderItem(c[a],f,g);if(e&&!g){c[a].setAttribute("ck",e[a].ck);c[a].setAttribute("r",e[a].r)}}this.setReminderTimer();this.updateTitlebarButton()};Owa.UIControls.ReminderDialog.prototype.selectItem=function Owa$UIControls$ReminderDialog$selectItem(d,c,b){var a=Owa.UIControls.ReminderDialog.callBase(this,"selectItem",[d,c,b]);this._oRmdSnzDD.updateSnoozeTime(this.getMaxSnoozeTime());this._oRmdSnzDD.set_IsEnabled(a.length>0)};Owa.UIControls.ReminderDialog.prototype.showError=function Owa$UIControls$ReminderDialog$showError(a){this._getDescendant("divRmdErrTxt").set_TextContent(a);this._getDescendant("divRmdErr").set_IsShown(!!a)};Owa.UIControls.ReminderDialog.prototype.setReminderTimer=function Owa$UIControls$ReminderDialog$setReminderTimer(){this._clearTimer();this._updateReminderItemsRNT()};Owa.UIControls.ReminderDialog.prototype.getUTCDifference=function Owa$UIControls$ReminderDialog$getUTCDifference(){return getUTCDifference(this.iTimeOffset,this.iTimeDifference)};Owa.UIControls.ReminderDialog.prototype.getMaxSnoozeTime=function Owa$UIControls$ReminderDialog$getMaxSnoozeTime(){var c=this.getSelectedItem(),e=this.getUTCDifference(),a=0,d=0;if(c.length==1){var f=c[0];a=new Date(f.getAttribute("t"));if(a>e&&isCal(f.getAttribute("c")))d=1}return d?Math.round((a-e)/b):-1};Owa.UIControls.ReminderDialog.prototype.refresh=function Owa$UIControls$ReminderDialog$refresh(e){var a=this.getItems();if(!a.length)return;var c=this.getUTCDifference(),d=c-this._dtLastRefreshTime;if(d>=2e4||e){for(var b=0;b<a.length;b++)this._updateReminderItemDueIn(a[b]);this._dtLastRefreshTime=c}};Owa.UIControls.ReminderDialog.prototype._onDoubleClick=function Owa$UIControls$ReminderDialog$_onDoubleClick(b){var a=this._findItem(b.get_Target());if(!a)return;this._openReminderItems(new Array(a))};Owa.UIControls.ReminderDialog.prototype._adjustWidth=function Owa$UIControls$ReminderDialog$_adjustWidth(){var a=this._getDescendant("divBtnDismissall").get_ClientWidth()+this._getDescendant("divBtnDismiss").get_ClientWidth()+this._getDescendant("divBtnOpenReminder").get_ClientWidth(),c=86;a+=c;if(a>this._get_Element().get_Width()){this._get_Element().set_Width(a);var b=this._getTitlebarButton(),d=getPopupXPositionForShowUnder(b,this._get_Element()),e=b.get_DocumentTop()+b.get_OffsetHeight()+1;this._get_Element().set_Left(d);this._get_Element().set_Top(e)}};Owa.UIControls.ReminderDialog.prototype._handleButtonPress=function Owa$UIControls$ReminderDialog$_handleButtonPress(b,a){switch(b){case"divBtnSnooze":procRm(OP_SNZ,"Snooze",a,this.dtLastReminderTime,this._oRmdSnzDD.get_SelectedValue());break;case"divBtnDismiss":procRm(OP_DIS,"Dismiss",a,this.dtLastReminderTime);break;case"divBtnDismissall":procRm(OP_DIS,"Dismiss",this.getItems());break;case"divBtnOpenReminder":this._openReminderItems(a)}};Owa.UIControls.ReminderDialog.prototype._prepareToShowDialog=function Owa$UIControls$ReminderDialog$_prepareToShowDialog(a){this.refresh(a);this._setDueInReminderTimer();Owa.UIControls.ReminderDialog.callBase(this,"_prepareToShowDialog")};Owa.UIControls.ReminderDialog.prototype._onEnterPressed=function Owa$UIControls$ReminderDialog$_onEnterPressed(b){if(b.getAncestorById("divRmdSnzDD",a))return true;this._openReminderItems(this.getSelectedItem())};Owa.UIControls.ReminderDialog.prototype._removeReminderItem=function Owa$UIControls$ReminderDialog$_removeReminderItem(a,b,c){this._oNextReminderItem==a&&this._clearTimer();if(b==OP_DIS||c)a.remove(true);else{a.set_IsShown(false);this.selectItem(a,0)}};Owa.UIControls.ReminderDialog.prototype._clearDueInTimer=function Owa$UIControls$ReminderDialog$_clearDueInTimer(){if(this._iReminderDueInTimer){this._clearInterval(this._iReminderDueInTimer);this._iReminderDueInTimer=0}};Owa.UIControls.ReminderDialog.prototype._clearTimer=function Owa$UIControls$ReminderDialog$_clearTimer(){if(this._iReminderTimer){this._clearTimeout(this._iReminderTimer);this._iReminderTimer=0}};Owa.UIControls.ReminderDialog.prototype._setDueInReminderTimer=function Owa$UIControls$ReminderDialog$_setDueInReminderTimer(){this._clearDueInTimer();this._iReminderDueInTimer=this._setInterval(this._updateReminderItemsDueIn,3e4)};Owa.UIControls.ReminderDialog.prototype._updateReminderItemsDueIn=function Owa$UIControls$ReminderDialog$_updateReminderItemsDueIn(){this.isOpened()&&this.refresh()};Owa.UIControls.ReminderDialog.prototype._updateReminderItemsRNT=function Owa$UIControls$ReminderDialog$_updateReminderItemsRNT(){for(var f=this.getItems(true),c=this.getUTCDifference(),h=4501,b=0,d=0;d<f.length;d++){var a=f[d],e=new Date(a.getAttribute("r")),g=new Date(a.getAttribute("t"));if(e.getYear()==h)continue;if(c<e){b=a;a.setExpando("_sel",0);a.set_IsShown(false)}else if(!a.get_IsShown())if(c<g&&!a.getExpando("fired"))this._showActiveReminder(a);else a.set_IsShown(true)}if(b){this._dtNextReminderTime=new Date(b.getAttribute("r"));this._iReminderTimer=this._setTimeout(this._fireReminders,this._dtNextReminderTime-c)}this.updateTitlebarButton();this._oNextReminderItem=b};Owa.UIControls.ReminderDialog.prototype._fireReminders=function Owa$UIControls$ReminderDialog$_fireReminders(){this._iReminderTimer=0;this._showActiveReminder(this._oNextReminderItem);this.setReminderTimer()};Owa.UIControls.ReminderDialog.prototype._showActiveReminder=function Owa$UIControls$ReminderDialog$_showActiveReminder(a){this.selectItem(a,1,1);this._updateReminderItemDueIn(a);a.set_IsShown(true);this.updateTitlebarButton();!this.isOpened()&&this.show(1);this.fSoundEnabled&&plySnd();a.setExpando("fired")};Owa.UIControls.ReminderDialog.prototype._updateReminderItemDueIn=function Owa$UIControls$ReminderDialog$_updateReminderItemDueIn(a){var b=this._getReminderItemDueIn(a),q=b[0],p=b[1],k=b[2],j=b[3],l=b[4],n=a.getChildById("c2").getChildById("c2Time"),m=a.getChildById("c2").getChildById("c2Text"),i=a.getChildById("c3").getChildById("c3Time"),o=a.getChildById("c3").getChildById("c3Text");a.removeCssClass(d);a.removeCssClass(c);i.removeCssClass(e);switch(l){case h:i.addCssClass(e);k=this._sNow;break;case f:a.addCssClass(c);j+="<br>"+this._sOverdueString;break;case g:a.addCssClass(d);j+="<br>"+this._sOverdueString}n.set_InnerHtml(q);m.set_InnerHtml(p);i.set_InnerHtml(k);o.set_InnerHtml(j)};Owa.UIControls.ReminderDialog.prototype._getReminderItemDueIn=function Owa$UIControls$ReminderDialog$_getReminderItemDueIn(n){var r=this.getUTCDifference(),q=new Date(n.getAttribute("t")),p=n.getAttribute("d"),j=i,c=(q-r)/b;if(0<c)c=Math.floor(c);else{c=-c;if(c<=p)j=f;else j=g;c=Math.ceil(c)}if(c==0)return["","","","",h];else{var a=new Array(4);a[3]=a[2]=a[1]=0;a[0]=Math.floor(c/(7*24*60));if(2>a[0]){a[1]=Math.floor(c/(24*60))%7;if(2>a[1]&&0==a[0]){a[2]=Math.floor(c/60)%24;if(8>=a[2]&&0==a[1])a[3]=Math.floor(c)%60}}for(var m="",l="",e="",k="",s="",o=0,d=0;d<4;d++,o+=3)if(0!=a[d]){var u=new RegExp(this._getAttribute("re1"),"gi"),v=new RegExp(this._getAttribute("re2"),"gi"),t=u.test(a[d])?0:v.test(a[d])?1:2,s=this._rgTimeUnits[o+t];if(e!=""){m=e;l=k}e=""+a[d];k=s}}return[m,l,e,k,j]};Owa.UIControls.ReminderDialog.prototype._openReminderItems=function Owa$UIControls$ReminderDialog$_openReminderItems(b){for(var a=0;a<b.length;a++){var d="Item",f=b[a].getAttribute("c");if(isCal(f))d="PreFormAction";var c="?ae="+d;c+="&a=Open";c+="&t="+urlEnc(f);var e=getReminderItemId(b[a]);if(b[a].getAttribute("oid"))e=b[a].getAttribute("oid");c+="&id="+urlEnc(e);openItm(c,null,null,null,null,this.get_SubPage())}};Owa.UIControls.ReminderDialog.prototype._onClose=function Owa$UIControls$ReminderDialog$_onClose(){Owa.UIControls.ReminderDialog.callBase(this,"_onClose");this._clearDueInTimer();this._oRmdSnzDD.hideDropDown()};Owa.UIControls.ReminderDialog.createClass("Owa.UIControls.ReminderDialog",Owa.UIControls.NotificationDialog)})();g_fModuleLoaded[".\\uicontrols/ReminderDialog.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");!g_fModuleLoaded[".\\components/FilterCriteria.js".toLowerCase()]&&(function(){Owa.Components.FilterCriteria=function Owa$Components$FilterCriteria(){this._isSendToMe=false;this._isCcToMe=false;this._isUnread=false;this._isFlagged=false;this._isHighImportant=false;this._hasAttachments=false;this._recipient="";this._recipientName="";this._recipientWellInnerHtml="";this._categories=[]};Owa.Components.FilterCriteria.prototype.clone=function Owa$Components$FilterCriteria$clone(){var a=new Owa.Components.FilterCriteria;a._isSendToMe=this._isSendToMe;a._isCcToMe=this._isCcToMe;a._isUnread=this._isUnread;a._isFlagged=this._isFlagged;a._isHighImportant=this._isHighImportant;a._hasAttachments=this._hasAttachments;a._recipient=this._recipient;a._recipientName=this._recipientName;a._recipientWellInnerHtml=this._recipientWellInnerHtml;a._categories=[];for(var b=0;b<this._categories.length;b++)a._categories.push(this._categories[b]);return a};Owa.Components.FilterCriteria.prototype.get_isValid=function Owa$Components$FilterCriteria$get_isValid(){return this._isSendToMe||this._isCcToMe||this._isUnread||this._isFlagged||this._isHighImportant||this._hasAttachments||this._recipient||this._categories.length};Owa.Components.FilterCriteria.prototype.get_IsSendToMe=function Owa$Components$FilterCriteria$get_IsSendToMe(){return this._isSendToMe};Owa.Components.FilterCriteria.prototype.set_IsSendToMe=function Owa$Components$FilterCriteria$set_IsSendToMe(a){this._isSendToMe=a};Owa.Components.FilterCriteria.prototype.get_IsCcToMe=function Owa$Components$FilterCriteria$get_IsCcToMe(){return this._isCcToMe};Owa.Components.FilterCriteria.prototype.set_IsCcToMe=function Owa$Components$FilterCriteria$set_IsCcToMe(a){this._isCcToMe=a};Owa.Components.FilterCriteria.prototype.get_IsUnread=function Owa$Components$FilterCriteria$get_IsUnread(){return this._isUnread};Owa.Components.FilterCriteria.prototype.set_IsUnread=function Owa$Components$FilterCriteria$set_IsUnread(a){this._isUnread=a};Owa.Components.FilterCriteria.prototype.get_IsFlagged=function Owa$Components$FilterCriteria$get_IsFlagged(){return this._isFlagged};Owa.Components.FilterCriteria.prototype.set_IsFlagged=function Owa$Components$FilterCriteria$set_IsFlagged(a){this._isFlagged=a};Owa.Components.FilterCriteria.prototype.get_IsHighImportant=function Owa$Components$FilterCriteria$get_IsHighImportant(){return this._isHighImportant};Owa.Components.FilterCriteria.prototype.set_IsHighImportant=function Owa$Components$FilterCriteria$set_IsHighImportant(a){this._isHighImportant=a};Owa.Components.FilterCriteria.prototype.get_HasAttachments=function Owa$Components$FilterCriteria$get_HasAttachments(){return this._hasAttachments};Owa.Components.FilterCriteria.prototype.set_HasAttachments=function Owa$Components$FilterCriteria$set_HasAttachments(a){this._hasAttachments=a};Owa.Components.FilterCriteria.prototype.get_Recipient=function Owa$Components$FilterCriteria$get_Recipient(){return this._recipient};Owa.Components.FilterCriteria.prototype.set_Recipient=function Owa$Components$FilterCriteria$set_Recipient(a){this._recipient=a};Owa.Components.FilterCriteria.prototype.get_RecipientName=function Owa$Components$FilterCriteria$get_RecipientName(){return this._recipientName};Owa.Components.FilterCriteria.prototype.set_RecipientName=function Owa$Components$FilterCriteria$set_RecipientName(a){this._recipientName=a};Owa.Components.FilterCriteria.prototype.get_RecipientWellInnerHtml=function Owa$Components$FilterCriteria$get_RecipientWellInnerHtml(){return this._recipientWellInnerHtml};Owa.Components.FilterCriteria.prototype.set_RecipientWellInnerHtml=function Owa$Components$FilterCriteria$set_RecipientWellInnerHtml(a){this._recipientWellInnerHtml=a};Owa.Components.FilterCriteria.prototype.add_Category=function Owa$Components$FilterCriteria$add_Category(c,b){var a={};a.name=c;a.html=b;this._categories.push(a)};Owa.Components.FilterCriteria.prototype.remove_Category=function Owa$Components$FilterCriteria$remove_Category(b){for(var a=0;a<this._categories.length;a++)if(this._categories[a].name==b){a<this._categories.length&&this._categories.splice(a,1);return true}return false};Owa.Components.FilterCriteria.prototype.clear_Categories=function Owa$Components$FilterCriteria$clear_Categories(){this._categories=[]};Owa.Components.FilterCriteria.prototype.get_Category=function Owa$Components$FilterCriteria$get_Category(a){return this._categories[a]};Owa.Components.FilterCriteria.prototype.get_CategoryCount=function Owa$Components$FilterCriteria$get_CategoryCount(){return this._categories.length};Owa.Components.FilterCriteria.prototype.get_CategoryNames=function Owa$Components$FilterCriteria$get_CategoryNames(){for(var b=[],a=0;a<this._categories.length;a++)b.push(this._categories[a].name);return b};Owa.Components.FilterCriteria.prototype.get_HasCategories=function Owa$Components$FilterCriteria$get_HasCategories(){return!!this._categories.length};Owa.Components.FilterCriteria.prototype.addStatement=function Owa$Components$FilterCriteria$addStatement(b,c){if(!this.get_isValid())return;var a=new oeSt(b,"FVLVF");a.add("fId",c);this.addOneStatement(a,"fStm",this.get_IsSendToMe()?1:0);this.addOneStatement(a,"fCtm",this.get_IsCcToMe()?1:0);this.addOneStatement(a,"fUR",this.get_IsUnread()?1:0);this.addOneStatement(a,"fFlg",this.get_IsFlagged()?1:0);this.addOneStatement(a,"fHI",this.get_IsHighImportant()?1:0);this.addOneStatement(a,"fAttch",this.get_HasAttachments()?1:0);this.get_HasCategories()&&this.addOneStatement(a,"sCat",this.get_CategoryNames().join(","));this.addOneStatement(a,this.get_RecipientName(),this.get_Recipient());b.addSt("fldrfltr",a)};Owa.Components.FilterCriteria.prototype.addOneStatement=function Owa$Components$FilterCriteria$addOneStatement(b,c,a){a&&b.add(c,a)};Owa.Components.FilterCriteria.createClass("Owa.Components.FilterCriteria")})();g_fModuleLoaded[".\\components/FilterCriteria.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/FilterRecipientContextMenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var c="divFltrRw",b="divTo",d=200;Owa.UIControls.FilterRecipientContextMenu=function Owa$UIControls$FilterRecipientContextMenu(){Owa.UIControls.FilterRecipientContextMenu.constructBase(this,arguments);this.get_OnPreShow().add(this._createCallback(this._onPreShow));this.get_OnClose().add(this._createCallback(this._onClose))};Owa.UIControls.FilterRecipientContextMenu.create=function Owa$UIControls$FilterRecipientContextMenu$create(b,d,c){var a=new Owa.UIControls.FilterRecipientContextMenu(b,d,c);a.initialize();return a};var a=Owa.UIControls.FilterRecipientContextMenu.prototype;a._get_DivRecipientWell=function Owa$UIControls$FilterRecipientContextMenu$_get_DivRecipientWell(){return this._getDescendant(c)};a._get_RecipientWell=function Owa$UIControls$FilterRecipientContextMenu$_get_RecipientWell(){return Owa.Components.RecipientWellManager.get_Instance().get_RecipientWell(this.sConsumerId,this._get_DivRecipientWell())};a._onClose=function Owa$UIControls$FilterRecipientContextMenu$_onClose(){Owa.UIControls.RecipientAnrContextMenu.get_Instance().close()};a.initialize=function Owa$UIControls$FilterRecipientContextMenu$initialize(){Owa.UIControls.FilterRecipientContextMenu.callBase(this,"initialize");this._get_Element().set_Width(d);var b=this._get_DivRecipientWell(),a=this.addResource(new Owa.UIControls.SingleEditRecipientWell.create(b));a.set_SubPage(this.get_SubPage());a.set_AutoCompleteContainer(this._get_Element());a.set_OnAutoResolveCallback(this._createCallback(this._resolveRecipientWell));a.set_OnUpdateFromCacheCallback(this._createCallback(this._onUpdateFromCache));a.set_IsADRecipientOnly(true);a.set_IsRecipientMenuEnabled(false);a.addHandler("blur",this._createCallback(this._recipientWellBlur));a.addHandler("keydown",this._createCallback(this._recipientWellKeyDown));a.addHandler("contextmenu",this._createCallback(this._recipientWellContextMenu));a.addHandler("mousedown",this._createCallback(this._recipientWellClick));a.addHandler("click",this._createCallback(this._recipientWellClick));a.initialize();this.oAnrOptions=getAnrOptions(false,false,RBT_PDL);this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([a],this.oAnrOptions);this._attachEvent(this._getDescendant("imgAddrBook"),"click",this._buttonOpenAddressBookClick)};a._tShow=function Owa$UIControls$FilterRecipientContextMenu$_tShow(){Owa.UIControls.FilterRecipientContextMenu.callBase(this,"_tShow",arguments);if(!this._fOffsetTopCalced){this._fOffsetTopCalced=true;var a=this._getDescendant("divFrmTtl");this._OffsetTop=this._get_Element().get_Top()-a.get_OffsetHeight()-10}this._get_Element().set_Top(this._OffsetTop);this._get_RecipientWell().setFocus(1)};a._onUpdateFromCache=function Owa$UIControls$FilterRecipientContextMenu$_onUpdateFromCache(a){this._oFilterMenu._updateRecipient(a.oRecipient);this._oFilterMenu._toggleApplyButton()};a._onPreShow=function Owa$UIControls$FilterRecipientContextMenu$_onPreShow(){this._fStick=false};a._recipientWellContextMenu=function Owa$UIControls$FilterRecipientContextMenu$_recipientWellContextMenu(a){this._fSuppressClose=false;this._oFilterMenu._fSuppressClose=false;!a.get_Target().equals(this._get_DivRecipientWell())&&this._get_RecipientWell().setFocus(0);a.cancelBubble();a.preventDefault()};a._recipientWellKeyDown=function Owa$UIControls$FilterRecipientContextMenu$_recipientWellKeyDown(){this._oFilterMenu._updateRecipient(null);this._oFilterMenu._toggleApplyButton()};a._recipientWellClick=function Owa$UIControls$FilterRecipientContextMenu$_recipientWellClick(a){this._fSuppressClose=false;this._oFilterMenu._fSuppressClose=false;!a.get_Target().equals(this._get_DivRecipientWell())&&this._get_RecipientWell().setFocus(0)};a._resolveRecipientWell=function Owa$UIControls$FilterRecipientContextMenu$_resolveRecipientWell(){this._fStick=true;Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveNames))};a._onCompleteResolveNames=function Owa$UIControls$FilterRecipientContextMenu$_onCompleteResolveNames(){var a=this._get_RecipientWell().get_Recipient();this._oFilterMenu._updateRecipient(a);this._oFilterMenu._toggleApplyButton();this._get_RecipientWell().setFocus(0);this._fStick=false};a._enableClose=function Owa$UIControls$FilterRecipientContextMenu$_enableClose(){this._fSuppressClose=0;this._fAutomaticEnableClose=1;this._oFilterMenu._fSuppressClose=0;this._oFilterMenu._fAutomaticEnableClose=1;this._oFilterMenu._removeTextBoxEventHandlers();this._get_RecipientWell().setFocus()};a._removeTextBoxEventHandlers=function Owa$UIControls$FilterRecipientContextMenu$_removeTextBoxEventHandlers(){this._fRemovedEventHandler=true};a._addTextBoxEventHandlers=function Owa$UIControls$FilterRecipientContextMenu$_addTextBoxEventHandlers(){this._fRemovedEventHandler=false};a._recipientWellBlur=function Owa$UIControls$FilterRecipientContextMenu$_recipientWellBlur(){if(!this.fIsOpen)return;else if(this._fStick||this._fRemovedEventHandler||this._fSuppressClose)return;var a=this._get_RecipientWell().get_Recipient();this._oFilterMenu._updateRecipient(a);this._oFilterMenu._toggleApplyButton();this._oFilterMenu._addTextBoxEventHandlers();this._oFilterMenu._closeOnBlur()};a._buttonOpenAddressBookClick=function Owa$UIControls$FilterRecipientContextMenu$_buttonOpenAddressBookClick(){var c={};c.sTgt=b;c.sTo=this._get_RecipientWell().get_Html();this._enableClose();this._fStick=true;var a=this,d=function(){a._get_RecipientWell().set_Html(c.sTo);var b=a._get_RecipientWell().get_Recipient();a._oFilterMenu._updateRecipient(b);a._oFilterMenu._toggleApplyButton();a._get_RecipientWell().setFocus(1);a._fStick=false};shwABDlg(a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,c,"&a=PickFilter",d)};a.set_FilterMenu=function Owa$UIControls$FilterRecipientContextMenu$set_FilterMenu(a){this._oFilterMenu=a};Owa.UIControls.FilterRecipientContextMenu.createClass("Owa.UIControls.FilterRecipientContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/FilterRecipientContextMenu.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/FilterInfobar.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.FilterInfobar=function Owa$UIControls$FilterInfobar(a){Owa.UIControls.FilterInfobar.constructBase(this);this.set_SubPage(a)};Owa.UIControls.FilterInfobar.prototype.get_VirtualListView=function Owa$UIControls$FilterInfobar$get_VirtualListView(){return this.get_SubPage().get_VirtualListView()};Owa.UIControls.FilterInfobar.prototype.get_SearchControl=function Owa$UIControls$FilterInfobar$get_SearchControl(){return this.get_SubPage().get_SearchControl()};Owa.UIControls.FilterInfobar.prototype.get_FolderId=function Owa$UIControls$FilterInfobar$get_FolderId(){return this.get_SubPage().get_FolderId()};Owa.UIControls.FilterInfobar.prototype.get_FilterInFavorites=function Owa$UIControls$FilterInfobar$get_FilterInFavorites(){return this.get_SubPage().getSubPageVariable("a_fNFvrFltr")};Owa.UIControls.FilterInfobar.prototype._createElement=function Owa$UIControls$FilterInfobar$_createElement(){var a=Owa.Dom.Document.get_Current().createElement("DIV");a.set_Id("divFltrIB");var b,h=!this.get_FilterInFavorites(),j=getRsrcF("clear1x1.gif");b='<div class="fltrIBM"><div id="fltrDesc"><span></span></div><div id="divFltrIBImg">';if(h)b+='<img class="vaM" src="'+j+'" id="saveFltr">';b+='<img class="vaM" src="'+j+'" id="cnclFltr"></div>';b+='<div class="fltrCvr"></div></div><div class="fltrIBS"></div>';a.set_InnerHtml(b);this.get_SubPage()._get_Element().appendChild(a);this.get_SubPage().get_SizeChanged(this._createCallback(this._windowResize));var k=a.get_FirstChild(),d=k.get_FirstChild(),i=d.get_NextSibling(),c=a.getDescendantById("cnclFltr");Owa.Components.CssSprites.updateImage(c,"fltr-clr.gif");c.set_Title(L_CnclFltrTltps);this._attachEvent(c,"click",this._buttonCancelClick);if(h){var e=a.getDescendantById("saveFltr");Owa.Components.CssSprites.updateImage(e,"fltr-addfav.png");e.set_Title(L_SvFltrTltps);this._attachEvent(e,"click",this._buttonSaveClick)}else{var f=26,g=22;if(a.get_OwnerDocument().get_IsRtl()){d.set_Left(f);i.set_Width(g)}else{d.set_Right(f);i.set_Width(g)}}this._initializeDomElement(a)};Owa.UIControls.FilterInfobar.prototype.get_FilterDescription=function Owa$UIControls$FilterInfobar$get_FilterDescription(){return this._filterDescription?this._filterDescription:""};Owa.UIControls.FilterInfobar.prototype.set_FilterDescription=function Owa$UIControls$FilterInfobar$set_FilterDescription(a){this._filterDescription=a};Owa.UIControls.FilterInfobar.prototype._buttonCancelClick=function Owa$UIControls$FilterInfobar$_buttonCancelClick(){this.get_SearchControl()&&this.get_SearchControl().clearSearch(1);this.get_VirtualListView().dsblFltrVw()};Owa.UIControls.FilterInfobar.prototype._buttonSaveClick=function Owa$UIControls$FilterInfobar$_buttonSaveClick(){if(this.get_FilterInFavorites())return;this._showSaveDialog()};Owa.UIControls.FilterInfobar.prototype._showSaveDialog=function Owa$UIControls$FilterInfobar$_showSaveDialog(){var a=new Owa.UIControls.ButtonDialog("svFltDlg",L_SvFltrDlgPmt+'<br><br><span id="spnFltrNm">'+L_SvAs+"&nbsp;</span><input id=fltrNm maxLength=256></input>",L_SvFltrDlgTtl,[L_OK,L_Cncl],null,null,this._createCallback(this._closeSaveDialog)),c=Owa.PageHierarchy.getElementByIdFromTop("fltrNm");c.set_Value(this.get_FilterDescription().substring(0,255));a.show();var e=a._get_Element().get_ClientWidth(),d,b=Owa.PageHierarchy.getElementByIdFromTop("spnFltrNm");if(a._get_Element().get_OwnerDocument().get_IsRtl())d=a._get_Element().get_OffsetWidth()-b.get_RelativeLeft(a._get_Element());else d=b.get_RelativeLeft(a._get_Element())+b.get_OffsetWidth();c.set_Width(e-d-40);c.focus(1)};Owa.UIControls.FilterInfobar.prototype._closeSaveDialog=function Owa$UIControls$FilterInfobar$_closeSaveDialog(a){if(a==0){var b=Owa.PageHierarchy.getElementByIdFromTop("fltrNm");g_oEd.attachEvent("AddFilterToFavorites",this,"_callbackAddFilterToFavorites");g_oNvNdMgr.addFltrToFav(null,this.get_FolderId(),b.get_Value(),this.get_VirtualListView())}};Owa.UIControls.FilterInfobar.prototype._callbackAddFilterToFavorites=function Owa$UIControls$FilterInfobar$_callbackAddFilterToFavorites(a,d,c,b){cbOeh(a,this._createCallback(this._addFilterError),b);g_oEd.detachEvent("AddFilterToFavorites",this,"_callbackAddFilterToFavorites")};Owa.UIControls.FilterInfobar.prototype._addFilterError=function Owa$UIControls$FilterInfobar$_addFilterError(a,b){a.iErr==27&&this._showSaveDialog(b)};Owa.UIControls.FilterInfobar.prototype.get_IsEnabled=function Owa$UIControls$FilterInfobar$get_IsEnabled(){return this._isEnabled};Owa.UIControls.FilterInfobar.prototype._set_IsEnabled=function Owa$UIControls$FilterInfobar$_set_IsEnabled(a){this._isEnabled=a};Owa.UIControls.FilterInfobar.prototype.show=function Owa$UIControls$FilterInfobar$show(){!this._get_Element()&&this._createElement();var c=this._get_Element().get_FirstChild(),a=c.get_FirstChild(),b=this.get_SubPage()._getDescendant("divSearchBox"),d=this.get_SubPage()._getDescendant("divLV");Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("fltrc").set_IsPushed(true,true);Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("fltrc")._get_Element().set_Title(this.get_FilterDescription());a.get_FirstChild().set_TextContent(this.get_FilterDescription());if(this.get_SearchControl()){this.get_SearchControl()._setSearchScopeIconStyle();this.get_SearchControl()._updateScopeText()}this._originalSearchBoxMarginTop=b._getEffectiveMargin(Owa.Style.Side.Top);this._iMarginTop=0;this._set_IsEnabled(true);this._get_Element().set_IsShown(true);this._reposition();this.resize()};Owa.UIControls.FilterInfobar.prototype.hide=function Owa$UIControls$FilterInfobar$hide(){if(!this._get_Element())return;var b=this._get_Element(),a=this.get_SubPage()._getDescendant("divSearchBox"),c=this.get_SubPage()._getDescendant("divLV");if(this.get_SearchControl()){this.get_SearchControl()._setSearchScopeIconStyle();this.get_SearchControl()._updateScopeText()}b.set_IsShown(false);Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("fltrc").set_IsPushed(false);a.set_Margin(Owa.Style.Side.Top,this._originalSearchBoxMarginTop);c.set_Top(a._get_OffsetTop()+a.get_OffsetHeight());this._set_IsEnabled(false)};Owa.UIControls.FilterInfobar.prototype._windowResize=function Owa$UIControls$FilterInfobar$_windowResize(){this._reposition()};Owa.UIControls.FilterInfobar.prototype._reposition=function Owa$UIControls$FilterInfobar$_reposition(){if(!this._get_Element()||!this.get_IsEnabled())return;var a=this._get_Element();a.set_IsShown(false);var d=this.get_SubPage()._getDescendant("txtS"),e=this.get_SubPage()._getDescendant("fltrc").get_ParentElement(),c=this._get_Element().get_ParentElement(),b=d.get_DocumentLeft()-c.get_DocumentLeft(),f=e.get_DocumentTop()+e.get_OffsetHeight()-c.get_DocumentTop()-1;if(this._get_Element().get_OwnerDocument().get_IsRtl()){b+=d.get_OffsetWidth();b=c.get_OffsetWidth()-b;a.set_Right(b)}else a.set_Left(b);a.set_Top(f);a.set_IsShown(true)};Owa.UIControls.FilterInfobar.prototype.resize=function Owa$UIControls$FilterInfobar$resize(){if(!this._get_Element()||!this.get_IsEnabled())return;var a=this._get_Element(),c=this.get_SubPage()._getDescendant("fltrc").get_ParentElement(),m=this.get_SubPage()._getDescendant("fltrcd").get_ParentElement(),b=this.get_SubPage()._getDescendant("divSearchBox"),f=this.get_SubPage()._getDescendant("txtS"),l=a.get_FirstChild(),i=l.get_FirstChild(),g=i.get_NextSibling().get_NextSibling(),h=this._iMarginTop?this._iMarginTop:a.get_OffsetHeight()+a.get_RelativeTop(b)+2+this._originalSearchBoxMarginTop,j=c.get_OffsetWidth()-2,e=b.get_OffsetWidth()-4,k=this.get_SubPage()._getDescendant("divLV");if(a.get_OwnerDocument().get_IsRtl())e-=b.get_DocumentLeft()+b.get_OffsetWidth()-f.get_DocumentLeft()-f.get_OffsetWidth();else e-=f.get_RelativeLeft(b);a.set_Width(e);if(a.get_OwnerDocument().get_IsRtl()){var d=c.get_RelativeLeft(a)+c.get_OffsetWidth();d=a.get_OffsetWidth()-d;g.set_Right(d)}else{var d=c.get_RelativeLeft(a);g.set_Left(d)}g.set_Width(j);b.set_Margin(Owa.Style.Side.Top,h);this._iMarginTop=h;k.set_Top(b._get_OffsetTop()+b.get_OffsetHeight())};Owa.UIControls.FilterInfobar.createClass("Owa.UIControls.FilterInfobar",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/FilterInfobar.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/FilterContextMenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");var b="chkmrk.png",a="clear.gif",d="divFltrRw",c=30;Owa.UIControls.FilterContextMenu=function Owa$UIControls$FilterContextMenu(a){Owa.UIControls.FilterContextMenu.constructBase(this);this.set_SubPage(a);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow));this._oFilterCriteria=new Owa.Components.FilterCriteria};Owa.UIControls.FilterContextMenu.prototype._onSelectMenuItem=function Owa$UIControls$FilterContextMenu$_onSelectMenuItem(j){var e=j.sCommand,d=j.oMenuItem,c={};c.tome="_IsSendToMe";c.ccme="_IsCcToMe";c.unread="_IsUnread";c.flagged="_IsFlagged";c.highimp="_IsHighImportant";c.attachments="_HasAttachments";switch(e){case"tome":case"ccme":case"unread":case"flagged":case"highimp":case"attachments":var g=c[e];this._oFilterCriteria["set"+g](!this._oFilterCriteria["get"+g]());this.replaceMenuItemIcon(d.get_Id(),this._oFilterCriteria["get"+g]()?b:a);break;default:if(e.startsW("fltrrcp")){var k=crtRecipObjectFromDomObject(d),l=this._get_RecipientWell();l.set_Recipients([k]);Owa.UIControls.AutoCompleteCache.hide();this._updateRecipient(k)}else if(e.startsW("cat:")){var f=!d.getExpando("_chkd");d.setExpando("_chkd",f);this.replaceMenuItemIcon(d.get_Id(),f?"chk-chkd.gif":"chk-unchk.gif");if(f){var i=e.substring(4),h=d.getDescendantById("spnT");if(h.get_FirstChild().get_Title())this._oFilterCriteria.add_Category(i,h.get_FirstChild().get_FirstChild().get_OuterHtml());else this._oFilterCriteria.add_Category(i,h.get_FirstChild().get_OuterHtml())}else{var i=e.substring(4);this._oFilterCriteria.remove_Category(i)}this._updateCategoryMenuItem()}}this._toggleApplyButton();return 1};Owa.UIControls.FilterContextMenu.prototype._get_RecipientWell=function Owa$UIControls$FilterContextMenu$_get_RecipientWell(){return this.get_FromMenu()._getDescendant(d).getExpando("_oControl")};Owa.UIControls.FilterContextMenu.prototype._updateRecipient=function Owa$UIControls$FilterContextMenu$_updateRecipient(a){var b=a?a._ao==AO_D?a._dn:a._em:"";if(b){this._oFilterCriteria.set_Recipient(b);this._oFilterCriteria.set_RecipientWellInnerHtml(this._get_RecipientWell().get_Html())}else{this._oFilterCriteria.set_Recipient("");this._oFilterCriteria.set_RecipientWellInnerHtml(" ")}this._updateRecipientMenuItem(false)};Owa.UIControls.FilterContextMenu.prototype._updateMenu=function Owa$UIControls$FilterContextMenu$_updateMenu(){this.replaceMenuItemIcon("_divToMe",this._oFilterCriteria.get_IsSendToMe()?b:a);this.replaceMenuItemIcon("_divCCMe",this._oFilterCriteria.get_IsCcToMe()?b:a);this.replaceMenuItemIcon("_divUnread",this._oFilterCriteria.get_IsUnread()?b:a);this.replaceMenuItemIcon("_divFlg",this._oFilterCriteria.get_IsFlagged()?b:a);this.replaceMenuItemIcon("_divHI",this._oFilterCriteria.get_IsHighImportant()?b:a);this.replaceMenuItemIcon("_divAtt",this._oFilterCriteria.get_HasAttachments()?b:a);this._updateRecipientMenuItem(true);this._updateCategoryMenuItem();this._updateCategorySubMenu();this._resizeContainer()};Owa.UIControls.FilterContextMenu.prototype._updateRecipientMenuItem=function Owa$UIControls$FilterContextMenu$_updateRecipientMenuItem(f){var e=this._oFilterCriteria.get_Recipient(),d=this._getDescendant("_divRp"),c=d.getDescendantById("spnT");this.replaceMenuItemIcon(d.get_Id(),e?b:a);c.addCssClass("fltrRpMI");var h=this.get_SubPage().get_FilterRecipientName()=="sTo",i=h?L_ToColonWithParam:L_FromColonWithParam;c.set_TextContent(i.format(e));c.get_OffsetWidth()>this._get_Element().get_ClientWidth()-54&&c.set_Width(this._get_Element().get_ClientWidth()-54);this._adjustSpacerWidth(d);if(f){var g=this._get_RecipientWell();g.set_Html(this._oFilterCriteria.get_RecipientWellInnerHtml())}};Owa.UIControls.FilterContextMenu.prototype._updateCategoryMenuItem=function Owa$UIControls$FilterContextMenu$_updateCategoryMenuItem(){var f=this._get_Element(),d=f.getDescendantById("_divCat"),e=d.getDescendantById("spnT");e.set_TextContent(L_CatWith);e.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,"&nbsp;");for(var c=0;c<this._oFilterCriteria.get_CategoryCount()&&c<3;c++)e.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,this._oFilterCriteria.get_Category(c).html);this._adjustSpacerWidth(d);this.replaceMenuItemIcon(d.get_Id(),this._oFilterCriteria.get_HasCategories()?b:a)};Owa.UIControls.FilterContextMenu.prototype._updateCategorySubMenu=function Owa$UIControls$FilterContextMenu$_updateCategorySubMenu(){var c=this._oFilterCriteria.get_CategoryNames(),d=this.get_CategoryMenu(),a=this;this._oFilterCriteria.clear_Categories();d._get_Element().forEachChild(function(b){var d=b.getAttribute("cmd");if(!d)return;if(b.getAttribute("_lnk")&&d&&d.startsW("cat:")){var g=d.substring(4),e=c.indexOf(g);if(e>=0){var f=b.getDescendantById("spnT");if(f.get_FirstChild().get_Title())a._oFilterCriteria.add_Category(g,f.get_FirstChild().get_FirstChild().get_OuterHtml());else a._oFilterCriteria.add_Category(g,f.get_FirstChild().get_OuterHtml())}b.setExpando("_chkd",e>=0);a.replaceMenuItemIcon(b.get_Id(),e>=0?"chk-chkd.gif":"chk-unchk.gif")}});var b=this.get_OtherCategoryMenu();b&&b._get_Element().forEachChild(function(b){var d=b.getAttribute("cmd");if(!d)return;if(b.getAttribute("_lnk")&&d&&d.startsW("cat:")){var g=d.substring(4),e=c.indexOf(g);if(e>=0){var f=b.getDescendantById("spnT");if(f.get_FirstChild().get_Title())a._oFilterCriteria.add_Category(g,f.get_FirstChild().get_FirstChild().get_OuterHtml());else a._oFilterCriteria.add_Category(g,f.get_FirstChild().get_OuterHtml())}b.setExpando("_chkd",e>=0);a.replaceMenuItemIcon(b.get_Id(),e>=0?"chk-chkd.gif":"chk-unchk.gif")}})};Owa.UIControls.FilterContextMenu.prototype.set_FilterButton=function Owa$UIControls$FilterContextMenu$set_FilterButton(a){this._oFilterButton=a};Owa.UIControls.FilterContextMenu.prototype.set_FilterCriteria=function Owa$UIControls$FilterContextMenu$set_FilterCriteria(a){this._oFilterCriteria=a.clone()};Owa.UIControls.FilterContextMenu.prototype.get_FilterCriteria=function Owa$UIControls$FilterContextMenu$get_FilterCriteria(){return this._oFilterCriteria.clone()};Owa.UIControls.FilterContextMenu.prototype.get_FromMenu=function Owa$UIControls$FilterContextMenu$get_FromMenu(){return this._oSubmenus.divFltrFrmMnu};Owa.UIControls.FilterContextMenu.prototype.get_CategoryMenu=function Owa$UIControls$FilterContextMenu$get_CategoryMenu(){return this._oSubmenus.divFltrCat};Owa.UIControls.FilterContextMenu.prototype.close=function Owa$UIControls$FilterContextMenu$close(){this._get_Element()&&Owa.UIControls.FilterContextMenu.callBase(this,"close",arguments)};Owa.UIControls.FilterContextMenu.prototype.get_OtherCategoryMenu=function Owa$UIControls$FilterContextMenu$get_OtherCategoryMenu(){return this._oSubmenus.divFltrCat._oSubmenus.divFltrCatO};Owa.UIControls.FilterContextMenu.prototype._onClose=function Owa$UIControls$FilterContextMenu$_onClose(){if(this._oFilterButton)if(!this.get_SubPage()._oFilterInfobar.get_IsEnabled())this._oFilterButton.set_IsPushed(false);else{this._oFilterButton.set_IsPushed(false);this._oFilterButton.set_IsPushed(true,true)}this.dispose()};Owa.UIControls.FilterContextMenu.prototype._enableClose=function Owa$UIControls$FilterContextMenu$_enableClose(){if(this.get_FromMenu().fIsOpen)this.get_FromMenu()._enableClose();else Owa.UIControls.FilterContextMenu.callBase(this,"_enableClose",arguments)};Owa.UIControls.FilterContextMenu.prototype.get_VirtualListView=function Owa$UIControls$FilterContextMenu$get_VirtualListView(){return this.get_SubPage().get_VirtualListView()};Owa.UIControls.FilterContextMenu.prototype.get_SearchControl=function Owa$UIControls$FilterContextMenu$get_SearchControl(){return this.get_SubPage().get_SearchControl()};Owa.UIControls.FilterContextMenu.prototype._hideSubmenu=function Owa$UIControls$FilterContextMenu$_hideSubmenu(){var a=this._oCurrentSubmenu==this.get_FromMenu();if(a)this.get_FromMenu()._fStick=true;Owa.UIControls.FilterContextMenu.callBase(this,"_hideSubmenu",arguments);this._toggleApplyButton();if(a){this._addTextBoxEventHandlers();this._enableClose();this.get_FromMenu()._fStick=false}};Owa.UIControls.FilterContextMenu.prototype._initializeDomElement=function Owa$UIControls$FilterContextMenu$_initializeDomElement(){Owa.UIControls.FilterContextMenu.callBase(this,"_initializeDomElement",arguments);var b=this._getDescendant("_divCat"),a=this._getDescendant("_divRp");this._get_Element().set_IsShown(true);this._get_Element().set_Width(this._get_Element().get_ClientWidth());this._get_Element().set_IsShown(false);this._attachEvent(a,"click",this._menuItemRecipientClick);this._attachEvent(b,"click",this._menuItemCategoryClick);this._attachEvent(this._getDescendant("btnFltrApp"),"click",this._buttonApplyClick);this._attachEvent(this._getDescendant("btnFltrCcl"),"click",this._buttonCancelClick)};Owa.UIControls.FilterContextMenu.prototype._toggleApplyButton=function Owa$UIControls$FilterContextMenu$_toggleApplyButton(){var b=!this._oFilterCriteria.get_isValid(),a=this._getDescendant("btnFltrApp");a.set_IsDisabled(b);if(!b)!Owa.Utility.isIE()&&a.removeCssClass("dsbl");else{a.removeCssClass("btnHvr");!Owa.Utility.isIE()&&a.addCssClass("dsbl")}};Owa.UIControls.FilterContextMenu.prototype._onPreShow=function Owa$UIControls$FilterContextMenu$_onPreShow(){var a=this._getDescendant("_divCat");this._updateMenu();this._toggleApplyButton();this._oFilterButton&&this._oFilterButton.set_IsPushed(true)};Owa.UIControls.FilterContextMenu.prototype._menuItemRecipientClick=function Owa$UIControls$FilterContextMenu$_menuItemRecipientClick(){if(this._oFilterCriteria.get_Recipient()){this._oFilterCriteria.set_Recipient("");this._oFilterCriteria.set_RecipientWellInnerHtml(" ");this._updateRecipientMenuItem(true);this._toggleApplyButton()}this._enableClose()};Owa.UIControls.FilterContextMenu.prototype._resizeContainer=function Owa$UIControls$FilterContextMenu$_resizeContainer(){var a=this._get_Element().get_Width(),d=this._getDescendant("btnFltrApp").get_OffsetWidth(),e=this._getDescendant("btnFltrCcl").get_OffsetWidth(),b=Math.max(d,e);if(a-c-2*b<0){a=c+2*b;this._get_Element().set_Width(a)}};Owa.UIControls.FilterContextMenu.prototype._menuItemCategoryClick=function Owa$UIControls$FilterContextMenu$_menuItemCategoryClick(){this._oFilterCriteria.clear_Categories();this._updateCategorySubMenu();this._updateCategoryMenuItem();this._toggleApplyButton()};Owa.UIControls.FilterContextMenu.prototype._buttonCancelClick=function Owa$UIControls$FilterContextMenu$_buttonCancelClick(){this.close()};Owa.UIControls.FilterContextMenu.prototype._buttonApplyClick=function Owa$UIControls$FilterContextMenu$_buttonApplyClick(){if(this.get_SearchControl()){this._suppressClose(true);this.get_SearchControl().clearSearch(1)}this.get_VirtualListView().fltrVw(this.get_FilterCriteria(),_callbackFilterView);this.close()};function _callbackFilterView(a,c){if(a.isInFltrdVw()){if(c){a.get_SearchControl()&&a.get_SearchControl().clearSearch(1);var d=Owa.Dom.Document.get_Current().createElement("DIV");d.set_InnerHtml(c.sBody);var b=d.getDescendantById("fltrDesc");if(b){var e=b.get_TextContent();a.get_SubPage()._oFilterInfobar.set_FilterDescription(e)}}a.get_SubPage()._oFilterInfobar.hide();a.get_SubPage()._oFilterInfobar.show()}else a.get_SubPage()._oFilterInfobar.hide()}Owa.UIControls.FilterContextMenu.prototype._createLoadHtmlContentRequest=function Owa$UIControls$FilterContextMenu$_createLoadHtmlContentRequest(a){return new oeReq("MsgVLV2","GetFilterMenu",0,a)};Owa.UIControls.FilterContextMenu.prototype._createSubmenu=function Owa$UIControls$FilterContextMenu$_createSubmenu(a){if(a.get_Id()=="divFltrFrmMnu"){var b=Owa.UIControls.FilterRecipientContextMenu.create(a,this,this.get_SubPage());b.set_FilterMenu(this);return b}else return Owa.UIControls.FilterContextMenu.callBase(this,"_createSubmenu",arguments)};Owa.UIControls.FilterContextMenu.createClass("Owa.UIControls.FilterContextMenu",Owa.UIControls.LazyLoadContextMenu)})();g_fModuleLoaded[".\\uicontrols/FilterContextMenu.js".toLowerCase()]=1;var SearchScope={SS_FLD:0,SS_FLDSUB:1,SS_FLDMOD:2,SS_FLDALL:3};!g_fModuleLoaded[".\\uicontrols/searchcontrol.js".toLowerCase()]&&(function(){var a={SI_IA:0,SI_A:1,SI_H:2,SI_D:3},b=["iactv","actv","hvr","iactv dsbl"];Owa.UIControls.SearchControl=function Owa$UIControls$SearchControl(a,b){Owa.UIControls.SearchControl.constructBase(this,[b]);this.set_SubPage(a);this._oSearchControl=this._getDescendant("divSearch");this._clearControls(false);this.iDftSS;this.iScope;this.sSearchText;this.iResultsIn;this.iRecipientField;this.sRecipient;this.sCategory;this.fReExecuteSearch=true;this._fFirstShowAdvancedSearch=true;this.fAsyncSearchEnabled=a.get_VirtualListView().isAsyncSrchEnabled()};Owa.UIControls.SearchControl.prototype.initialize=function Owa$UIControls$SearchControl$initialize(){if(this._oSearchControl){this._oSearchInputBox=this._getDescendant("divSearch");this._oSearchTextBox=this._getDescendant("txtS");this._attachEvent(this._oSearchTextBox,"keyup",this._onKeyUpHandler);this._attachEvent(this._oSearchTextBox,"click",this._onClickHandler);this._attachEvent(this._oSearchTextBox,"focus",this._onClickHandler);this._attachEvent(this._oSearchTextBox,"blur",this._onFocusOutHandler);this._oSearchIcon=this._getDescendant("divSIcon");this._attachEvent(this._oSearchIcon,"click",this._onClickSearchIcon);this._attachEvent(this._oSearchIcon,"mouseover",this._onMouseOverSearchIcon);this._attachEvent(this._oSearchIcon,"mouseout",this._onMouseOutSearchIcon);this._oSearchDropDown=this._getDescendant("divSScp");if(this._oSearchDropDown){this._attachEvent(this._oSearchDropDown,"click",this._showSearchScopeMenu);this._attachEvent(this._oSearchDropDown,"mouseover",this._onMouseOverScope);this._attachEvent(this._oSearchDropDown,"mouseout",this._onMouseOutScopeMenu)}if(this._isAdvancedSearchPresent()){this._oAdvancedSearch=this._getDescendant("divASChevron");this._oShowAdvancedSearch=this._getDescendant("imgSAS");this._oHideAdvancedSearch=this._getDescendant("imgHAS");this._attachEvent(this._oAdvancedSearch,"click",this._onClickAdvancedSearch);this._oAdvancedSearch.setExpando("fE",0)}this.fixSearchControlStyles()}};Owa.UIControls.SearchControl.prototype.dispose=function Owa$UIControls$SearchControl$dispose(){this._clearControls(true);Owa.UIControls.SearchControl.callBase(this,"dispose")};Owa.UIControls.SearchControl.prototype.get_VirtualListView=function Owa$UIControls$SearchControl$get_VirtualListView(){return this.get_SubPage().get_VirtualListView()};Owa.UIControls.SearchControl.prototype._clearMemberElement=function Owa$UIControls$SearchControl$_clearMemberElement(a){this[a]&&this[a].dispose();this[a]=null};Owa.UIControls.SearchControl.prototype._clearControls=function Owa$UIControls$SearchControl$_clearControls(a){this._clearMemberElement("_oSearchTextBox");this._clearMemberElement("_oSearchIcon");this._clearMemberElement("_oSearchDropDown");this._oContentIndexingDisabled=null;this._oShowAdvancedSearch=null;this._oHideAdvancedSearch=null;a&&this._oSearchScopeMenu&&this._oSearchScopeMenu.dispose();this._oSearchScopeMenu=null;this._clearMemberElement("_oAdvancedSearch");this._oAdvancedSearchDiv=null;this._oResultsInCheckBox=null;a&&this._oResultsInComboBox&&this._oResultsInComboBox.dispose();this._oResultsInComboBox=null;this._oRecipientCheckBox=null;a&&this._oRecipientComboBox&&this._oRecipientComboBox.dispose();this._oRecipientComboBox=null;this._oRecipientTextBox=null;this._oSubjectCheckBox=null;this._oSubjectTextBox=null;this._oCategoryCheckBox=null;a&&this._oCategoryComboBox&&this._oCategoryComboBox.dispose();this._oCategoryComboBox=null;this._oAdvancedSearchButton=null};Owa.UIControls.SearchControl.prototype._isAdvancedSearchPresent=function Owa$UIControls$SearchControl$_isAdvancedSearchPresent(){if(!this._oAdvancedSearch)this._oAdvancedSearch=this._getDescendant("divASChevron");return this._oAdvancedSearch!=null};Owa.UIControls.SearchControl.prototype._isAdvancedSearchPresentAndExpanded=function Owa$UIControls$SearchControl$_isAdvancedSearchPresentAndExpanded(){if(!this._oAdvancedSearch)this._oAdvancedSearch=this._getDescendant("divASChevron");if(!this.oCategoryCheckBox)this.oCategoryCheckBox=this._getDescendant("chkCat");return this._oAdvancedSearch&&this._oAdvancedSearch.getExpando("fE")&&this.oCategoryCheckBox};Owa.UIControls.SearchControl.prototype._onKeyUpHandler=function Owa$UIControls$SearchControl$_onKeyUpHandler(b){var a=b.get_KeyCodeForKeyUpDown();if(a==13)this._search();else this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onClickHandler=function Owa$UIControls$SearchControl$_onClickHandler(){if(this._oSearchTextBox.getAttribute("fScp")=="1"){this._oSearchTextBox.setAttribute("fScp","0");this._oSearchTextBox.set_Value("");this._oSearchTextBox.set_CssClasses([""])}this._oSearchTextBox.focus()};Owa.UIControls.SearchControl.prototype._onFocusOutHandler=function Owa$UIControls$SearchControl$_onFocusOutHandler(){var a=this._oSearchTextBox.get_Value();(!a||!a.trim().length)&&this._updateScopeText();this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._updateScopeText=function Owa$UIControls$SearchControl$_updateScopeText(){if(!this._oSearchControl.getAttribute("L_Fld")){this._oSearchTextBox.set_Value("");return}var a,b=this._oSearchControl.getAttribute("sFldNm");if(this.get_SubPage().IsFilterInFavorites())a=this._oSearchControl.getAttribute("L_Fld").format(b);else switch(this._oSearchControl.getIntAttribute("iScp")){case SearchScope.SS_FLD:a=this._oSearchControl.getAttribute("L_Fld").format(b);break;case SearchScope.SS_FLDSUB:a=this._oSearchControl.getAttribute("L_FldSub").format(b);break;case SearchScope.SS_FLDMOD:a=this._oSearchControl.getAttribute("L_Mod");break;case SearchScope.SS_FLDALL:a=this._oSearchControl.getAttribute("L_FldAll")}this._oSearchTextBox.set_Value(a);this._oSearchTextBox.setAttribute("fScp","1");this._oSearchTextBox.set_CssClasses(["inactv"])};Owa.UIControls.SearchControl.prototype._onMouseOverScope=function Owa$UIControls$SearchControl$_onMouseOverScope(){if(this.get_SubPage().IsFilterInFavorites())return;this._setSearchScopeIconState(a.SI_H)};Owa.UIControls.SearchControl.prototype._onMouseOutScopeMenu=function Owa$UIControls$SearchControl$_onMouseOutScopeMenu(){if(this.get_SubPage().IsFilterInFavorites())return;if(this._oSearchScopeMenu&&this._oSearchScopeMenu.get_IsShown())return;this._setSearchScopeIconState(this._isSearchCriterionSet()||this.get_VirtualListView().isFltrd()?a.SI_A:a.SI_IA)};Owa.UIControls.SearchControl.prototype._onMouseOverSearchIcon=function Owa$UIControls$SearchControl$_onMouseOverSearchIcon(){this._isSearchCriterionSet()&&this._setSearchIconState(a.SI_H)};Owa.UIControls.SearchControl.prototype._onMouseOutSearchIcon=function Owa$UIControls$SearchControl$_onMouseOutSearchIcon(){this._isSearchCriterionSet()&&this._setSearchIconState(a.SI_A)};Owa.UIControls.SearchControl.prototype._setSearchIconState=function Owa$UIControls$SearchControl$_setSearchIconState(a){var c=this._oSearchIcon.get_CssClasses()[0]+" "+b[a];this._oSearchIcon.set_CssClasses([c]);if(this._oAdvancedSearchButton)if(a==0){btnOnMsOutBtn(this._oAdvancedSearchButton._get_DomNode());this._oAdvancedSearchButton.set_IsDisabled(true);this._oAdvancedSearchButton.set_CssClasses(["dsbl"])}else{this._oAdvancedSearchButton.set_IsDisabled(false);this._oAdvancedSearchButton.set_CssClasses([""])}};Owa.UIControls.SearchControl.prototype._setSearchScopeIconState=function Owa$UIControls$SearchControl$_setSearchScopeIconState(a){if(!this._oSearchDropDown)this._oSearchDropDown=this._getDescendant("divSScp");this._oSearchDropDown.set_CssClasses(["scp "+b[a]])};Owa.UIControls.SearchControl.prototype._setSearchScopeIconStyle=function Owa$UIControls$SearchControl$_setSearchScopeIconStyle(){this._setSearchActions(!this.get_VirtualListView().isFltrd()||this._isSearchCriterionSet()&&this._isSearchCriterionDifferent());var b=this._isSearchCriterionSet()||this.get_VirtualListView().isFltrd()?a.SI_A:a.SI_IA;this._setSearchIconState(b);if(this._oSearchDropDown)if(this.get_SubPage().IsFilterInFavorites())this._setSearchScopeIconState(a.SI_D);else this._setSearchScopeIconState(b);if(!this._oContentIndexingDisabled)this._oContentIndexingDisabled=this._getDescendant("divDsblCI");this._oContentIndexingDisabled&&this._oContentIndexingDisabled.set_IsShown(b==a.SI_IA)};Owa.UIControls.SearchControl.prototype._showSearchScopeMenu=function Owa$UIControls$SearchControl$_showSearchScopeMenu(){if(this.get_SubPage().IsFilterInFavorites())return;if(!this._oSearchScopeMenu){var b=new oeReq(this.get_VirtualListView().sEvtNS,"GetSearchScopeMenu",null,Owa.Utility.createDelegate(this,this._cbGetSearchScopeMenu),GET);b.add("fId",this.get_VirtualListView().sSid);b.send()}else{var a=this._oSearchScopeMenu.get_Width();this._oSearchScopeMenu.show(this._oSearchDropDown.get_DocumentLeft()+(g_fRtl?a:this._oSearchDropDown.get_OffsetWidth()-a),this._oSearchDropDown.get_DocumentTop()+this._oSearchDropDown.get_ClientHeight()+2);this._oSearchScopeMenu.selectMenuItemByAttribute("cmd",this._oSearchControl.getAttribute("iScp"))}};Owa.UIControls.SearchControl.prototype._cbGetSearchScopeMenu=function Owa$UIControls$SearchControl$_cbGetSearchScopeMenu(a){if(!cbOeh(a))return;if(!this._oSearchScopeMenu){eval(a.sBody);this._oSearchScopeMenu=Owa.UIControls.ContextMenu.createFromHtml(sSM,true,this.get_SubPage());this._oSearchScopeMenu.get_OnSelect().add(Owa.Utility.createDelegate(this,this._onSelectSearchScopeMenu));this.iDftSS=g_iDftSS}this._showSearchScopeMenu()};Owa.UIControls.SearchControl.prototype._onSelectSearchScopeMenu=function Owa$UIControls$SearchControl$_onSelectSearchScopeMenu(b){b=b.sCommand;var a=b;if(b.startsW("d")){a=getInt(b.substring(1));if(a==this.iDftSS)return;this._saveDefaultSearchScope(a);var c=this._oSearchScopeMenu._oSubmenus.divDftScpMnu._getDescendant("divFS"+this.iDftSS).getDescendantById("imgI"),d=this._oSearchScopeMenu._oSubmenus.divDftScpMnu._getDescendant("divFS"+a).getDescendantById("imgI");d.swap(c);this.iDftSS=a}this._oSearchControl.setIntAttribute("iScp",parseInt(a));this._oSearchTextBox.getAttribute("fScp")=="1"&&this._updateScopeText();this.get_VirtualListView().isFltrd()&&this._search()};Owa.UIControls.SearchControl.prototype._onHideSearchScopeMenu=function Owa$UIControls$SearchControl$_onHideSearchScopeMenu(){this._onMouseOutScopeMenu()};Owa.UIControls.SearchControl.prototype._saveDefaultSearchScope=function Owa$UIControls$SearchControl$_saveDefaultSearchScope(b){var a=new oeReq(this.get_VirtualListView().sEvtNS,"PSS",0,cbOeh);a.add("scp",b);a.add("fId",this.get_VirtualListView().sSid);a.send()};Owa.UIControls.SearchControl.prototype._onClickSearchIcon=function Owa$UIControls$SearchControl$_onClickSearchIcon(){if(this.get_VirtualListView().isFltrd()&&this._oSearchIcon.getExpando("fClr"))this.clearSearch();else this._search()};Owa.UIControls.SearchControl.prototype._search=function Owa$UIControls$SearchControl$_search(){if(!this._isSearchCriterionSet())return;addPerfMarker("SearchControl.Search.Start");this.fReExecuteSearch=true;this.iScope=this.sSearchText=this.iResultsIn=this.iRecipientField=this.sRecipient=this.sCategory=null;var c=this._oSearchTextBox.get_Value(),d=this._oSearchTextBox.getAttribute("fScp");if(c&&c.trim().length&&(d=="0"||!d))this.sSearchText=c;if(this.get_VirtualListView().isFldr()){this.iScope=this._oSearchControl.getIntAttribute("iScp");if(this._isAdvancedSearchPresentAndExpanded()){if(this._oCategoryCheckBox.get_IsChecked())this.sCategory=this._oCategoryComboBox.get_SelectedValue();if(this.get_VirtualListView().iT==LVT_MSG){if(this._oResultsInCheckBox&&this._oResultsInCheckBox.get_IsChecked())this.iResultsIn=this._oResultsInComboBox.get_SelectedValue();var c=this._oRecipientTextBox.get_Value();if(this._oRecipientCheckBox.get_IsChecked()&&this._oRecipientTextBox&&c&&c.trim().length){this.iRecipientField=this._oRecipientComboBox.get_SelectedValue();this.sRecipient=c}}if(this._oSubjectCheckBox&&this._oSubjectCheckBox.get_IsChecked()){var c=this._oSubjectTextBox?this._oSubjectTextBox.get_Value():null;if(c&&c.trim().length){this.sSearchText=this._oSubjectTextBox.get_Value();this._oSearchTextBox.set_Value(this.sSearchText);this._oSearchTextBox.setAttribute("fScp","0");this.iResultsIn="1"}}}}this.get_VirtualListView().find();this._get_Element().set_CssClasses([b[a.SI_A]]);this._setSearchActions(0);if(!this._oContentIndexingDisabled)this._oContentIndexingDisabled=this._getDescendant("divDsblCI");this._oContentIndexingDisabled&&this._oContentIndexingDisabled.set_IsShown(true)};Owa.UIControls.SearchControl.prototype.clearSearch=function Owa$UIControls$SearchControl$clearSearch(c){if(!this.get_VirtualListView().isFltrd())return;addPerfMarker("SearchControl.ClearSearch.Start");this.get_VirtualListView().clrFind(c);if(!this._oContentIndexingDisabled)this._oContentIndexingDisabled=this._getDescendant("divDsblCI");this._oContentIndexingDisabled&&this._oContentIndexingDisabled.set_IsShown(false);this._get_Element().set_CssClasses([b[a.SI_IA]]);if(this._isAdvancedSearchPresentAndExpanded()){this._oCategoryCheckBox.set_IsChecked(false);if(this.get_VirtualListView().iT==LVT_MSG){this._oResultsInCheckBox&&this._oResultsInCheckBox.set_IsChecked(false);this._oRecipientCheckBox.set_IsChecked(false);this._oRecipientTextBox.set_Value("")}if(this._oSubjectCheckBox){this._oSubjectCheckBox.set_IsChecked(false);this._oSubjectTextBox.set_Value("")}}this._updateScopeText();this._setSearchScopeIconStyle();this.get_VirtualListView().makeFocused()};Owa.UIControls.SearchControl.prototype._setSearchActions=function Owa$UIControls$SearchControl$_setSearchActions(a){this._oSearchIcon.setExpando("fClr",!a);var b=this._getDescendant("imgS");if(a)Owa.Components.CssSprites.updateImage(b,"search.png");else Owa.Components.CssSprites.updateImage(b,"cnclsrch.gif");if(this._oAdvancedSearchButton){var d=this._getDescendant("spnAFClr"),c=this._getDescendant("spnAFSch");d.set_IsShown(!a);c.set_IsShown(a)}};Owa.UIControls.SearchControl.prototype.fixSearchControlStyles=function Owa$UIControls$SearchControl$fixSearchControlStyles(){this._setSearchBoxHeight();for(var e=10,d=[this._oSearchTextBox,this._oRecipientTextBox,this._oSubjectTextBox],a,c=0;c<d.length;c++){a=d[c];var b;if(a){b=a.get_ParentElement().get_OffsetWidth();b>e&&a.set_Width(b-e)}}};Owa.UIControls.SearchControl.prototype._setSearchBoxHeight=function Owa$UIControls$SearchControl$_setSearchBoxHeight(){this._get_Element().set_Height(this._oSearchControl.get_OffsetHeight()+8+(this._isAdvancedSearchPresentAndExpanded()?this._getAdvancedSearchHeight():0))};Owa.UIControls.SearchControl.prototype._isSearchCriterionSet=function Owa$UIControls$SearchControl$_isSearchCriterionSet(){var b=0,a=this._oSearchTextBox.get_Value(),c=this._oSearchTextBox.getAttribute("fScp");b|=a&&a.trim().length&&(!c||c=="0");if(this._isAdvancedSearchPresentAndExpanded()){b|=this._oCategoryCheckBox.get_IsChecked();if(this.get_VirtualListView().iT==LVT_MSG&&!b){a=this._oRecipientTextBox.get_Value();b|=this._oRecipientCheckBox.get_IsChecked()&&a&&a.trim().length}if(this._oSubjectTextBox){a=this._oSubjectTextBox.get_Value();b|=this._oSubjectCheckBox.get_IsChecked()&&a&&a.trim().length}}return b};Owa.UIControls.SearchControl.prototype._isSearchCriterionDifferent=function Owa$UIControls$SearchControl$_isSearchCriterionDifferent(){var a=0;a|=this._oSearchTextBox.getAttribute("fScp")=="1"!=(this.sSearchText==null);if(this._oSearchTextBox.getAttribute("fScp")=="0")a|=this._oSearchTextBox.get_Value()!=this.sSearchText;if(this.get_VirtualListView().isFldr()&&this._isAdvancedSearchPresentAndExpanded()){a|=this._oCategoryCheckBox.get_IsChecked()!=(this.sCategory!=null);if(this._oCategoryCheckBox.get_IsChecked())a|=this.sCategory!=this._oCategoryComboBox.get_SelectedValue();if(this.get_VirtualListView().iT==LVT_MSG){if(this._oResultsInCheckBox){a|=this._oResultsInCheckBox.get_IsChecked()!=(this.iResultsIn!=null);if(this._oResultsInCheckBox.get_IsChecked())a|=this.iResultsIn!=this._oResultsInComboBox.get_SelectedValue()}a|=this._oRecipientCheckBox.get_IsChecked()!=(this.iRecipientField!=null);if(this._oRecipientCheckBox.get_IsChecked()){a|=this.iRecipientField!=this._oRecipientComboBox.get_SelectedValue();a|=this.sRecipient!=this._oRecipientTextBox.get_Value()}}if(this._oSubjectCheckBox){a|=this._oSubjectCheckBox.get_IsChecked()!=(this.iResultsIn=="1");if(this._oSubjectCheckBox.get_IsChecked())a|=this.sSearchText!=this._oSubjectTextBox.get_Value()}}return a};Owa.UIControls.SearchControl.prototype.togglePublicFolderAdvancedSearch=function Owa$UIControls$SearchControl$togglePublicFolderAdvancedSearch(){var a=this.get_SubPage()._getDescendant("divLV");if(getInt(this._oAdvancedSearch.getExpando("fE"))){this.clearSearch();this._oAdvancedSearch.setExpando("fE",0);a.set_Top(a.get_Top()-this._getAdvancedSearchHeight());this._oAdvancedSearchDiv.set_IsShown(false);this._setSearchButtonStyle("expnd.gif")}else if(!getInt(this._oAdvancedSearch.getExpando("fLd"))){this._oAdvancedSearch.setExpando("fLd",1);var b=new oeReq(this.get_VirtualListView().sEvtNS,"gtSIPF",0,Owa.Utility.createDelegate(this,this._cbGetAdvancedSearchPublicFolder),GET);b.send();this.fixSearchControlStyles()}else{this._oAdvancedSearchButton=this._getDescendant("btnAF");if(!this._oAdvancedSearchDiv.get_FirstChild()){this._oAdvancedSearch.setExpando("fLD",0);return}this._oAdvancedSearchDiv.set_IsShown(true);this._adjustAdvancedSearch();a.set_Top(a.get_Top()+this._getAdvancedSearchHeight());this._setSearchButtonStyle("cllps.gif");this._oAdvancedSearch.setExpando("fE",1);this.fixSearchControlStyles()}this._setSearchBoxHeight()};Owa.UIControls.SearchControl.prototype._adjustAdvancedSearch=function Owa$UIControls$SearchControl$_adjustAdvancedSearch(){if(!this._fFirstShowAdvancedSearch)return;this._fFirstShowAdvancedSearch=false;for(var e=this._oAdvancedSearchDiv.getAllDescendantsById("divASCol2"),b=0,a=0;a<e.length;a++){var d=e[a]._get_OffsetLeft();if(g_fRtl)d=this._oAdvancedSearchDiv.get_OffsetWidth()-d;else d+=e[a].get_OffsetWidth();b=Math.max(d,b)}b+=3;var c=this._oAdvancedSearchDiv.getAllDescendantsById("divASCol3");if(g_fRtl){var f=c[0].get_Right();if(b>f)for(var a=0;a<c.length;a++)c[a].set_Right(b)}else{var g=c[0].get_Left();if(b>g)for(var a=0;a<c.length;a++)c[a].set_Left(b)}};Owa.UIControls.SearchControl.prototype._getAdvancedSearchHeight=function Owa$UIControls$SearchControl$_getAdvancedSearchHeight(){var a=10;this._oAdvancedSearchDiv.get_FirstChild().forEachChild(function(b){a+=b.get_OffsetHeight()});return a};Owa.UIControls.SearchControl.prototype._setSearchButtonStyle=function Owa$UIControls$SearchControl$_setSearchButtonStyle(c){var a=Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("searchpf"),b=a._get_Element().getDescendantsByTagName("img")[0];Owa.Components.CssSprites.updateImage(b,c)};Owa.UIControls.SearchControl.prototype._cbGetAdvancedSearchPublicFolder=function Owa$UIControls$SearchControl$_cbGetAdvancedSearchPublicFolder(a){if(!cbOeh(a)){this._oAdvancedSearch.setExpando("fLd",0);return}this._initAdvancedSearchControls(a.sBody,true);this.togglePublicFolderAdvancedSearch()};Owa.UIControls.SearchControl.prototype._onClickAdvancedSearch=function Owa$UIControls$SearchControl$_onClickAdvancedSearch(){var a=this.get_SubPage()._getDescendant("divLV");if(this._oAdvancedSearch.getExpando("fE")){this._oAdvancedSearch.setExpando("fE",0);a.set_Top(a.get_Top()-this._getAdvancedSearchHeight());this._oAdvancedSearchDiv.set_IsShown(false);this._oShowAdvancedSearch.set_IsShown(true);this._oHideAdvancedSearch.set_IsShown(false)}else if(!this._oAdvancedSearch.getExpando("fLD")){this._oAdvancedSearch.setExpando("fLD",1);var b=new oeReq(this.get_VirtualListView().sEvtNS,"gtAF",0,Owa.Utility.createDelegate(this,this._cbGetAdvancedSearch),GET);b.add("fId",this.get_VirtualListView().sSid);b.send()}else{if(!this._oAdvancedSearchDiv)this._oAdvancedSearchDiv=this._getDescendant("divAS");if(!this._oAdvancedSearchDiv.get_FirstChild()){this._oAdvancedSearch.setExpando("fLD",0);return}this._oAdvancedSearchDiv.set_IsShown(true);this._adjustAdvancedSearch();this._oShowAdvancedSearch.set_IsShown(false);this._oHideAdvancedSearch.set_IsShown(true);a.set_Top(a.get_Top()+this._getAdvancedSearchHeight());this._oAdvancedSearch.setExpando("fE",1);this.fixSearchControlStyles()}this._setSearchBoxHeight()};Owa.UIControls.SearchControl.prototype._cbGetAdvancedSearch=function Owa$UIControls$SearchControl$_cbGetAdvancedSearch(a){if(!cbOeh(a)){if(!this._oAdvancedSearch)this._oAdvancedSearch=this._getDescendant("divASChevron");this._oAdvancedSearch&&this._oAdvancedSearch.setExpando("fLD",0);return}this._initAdvancedSearchControls(a.sBody,false);this._onClickAdvancedSearch()};Owa.UIControls.SearchControl.prototype._initAdvancedSearchControls=function Owa$UIControls$SearchControl$_initAdvancedSearchControls(c,a){this._oAdvancedSearchDiv=this._getDescendant("divAS");this._oAdvancedSearchDiv.set_InnerHtml(c);var b=this._getDescendant("divBasicSearch");b.get_IsShown()&&this._oAdvancedSearchDiv.getDescendantById("divASExpanded").set_Top(b.get_OffsetHeight()+3);this._oCategoryComboBox=new Owa.UIControls.ComboBox(this._getDescendant("divCDd"),null);this._oCategoryComboBox.set_SubPage(this.get_SubPage());this._oCategoryComboBox.initialize();this._oCategoryComboBox.get_OnChange().add(Owa.Utility.createDelegate(this,this._onSelectCategory));this._oCategoryCheckBox=this._getDescendant("chkCat");this._attachEvent(this._oCategoryCheckBox,"click",this._setSearchScopeIconStyle);if(this._oCategoryComboBox.get_DropDownList().getItemCount()==0){this._oCategoryComboBox.set_IsEnabled(false);this._oCategoryCheckBox.set_IsDisabled(true)}if(this.get_VirtualListView().iT==LVT_MSG){if(!a){this._oResultsInComboBox=new Owa.UIControls.ComboBox(this._getDescendant("divRI"),null);this._oResultsInComboBox.set_SubPage(this.get_SubPage());this._oResultsInComboBox.initialize();this._oResultsInComboBox.get_OnChange().add(Owa.Utility.createDelegate(this,this._onSelectResultsIn));this._oResultsInCheckBox=this._getDescendant("chkRI");this._attachEvent(this._oResultsInCheckBox,"click",this._setSearchScopeIconStyle)}this._oRecipientTextBox=this._getDescendant("txtRcp");this._attachEvent(this._oRecipientTextBox,"click",this._onClickRecipientTextBox);this._attachEvent(this._oRecipientTextBox,"keyup",this._onKeyUpRecipient);this._attachEvent(this._oRecipientTextBox,"blur",this._onFocusOutRecipient);this._oRecipientComboBox=new Owa.UIControls.ComboBox(this._getDescendant("divRcp"),null);this._oRecipientComboBox.set_SubPage(this.get_SubPage());this._oRecipientComboBox.initialize();this._oRecipientComboBox.get_OnChange().add(Owa.Utility.createDelegate(this,this._setSearchScopeIconStyle));this._oRecipientCheckBox=this._getDescendant("chkRcp");this._attachEvent(this._oRecipientCheckBox,"click",this._setSearchScopeIconStyle)}if(a){if(!this._oSubjectTextBox)this._oSubjectTextBox=this._getDescendant("txtSS");if(this._oSubjectTextBox){this._attachEvent(this._oSubjectTextBox,"click",this._onClickSubjectTextBox);this._attachEvent(this._oSubjectTextBox,"keyup",this._onKeyUpSubject);this._attachEvent(this._oSubjectTextBox,"blur",this._onFocusOutSubject);this._oSubjectCheckBox=this._getDescendant("chkSS");this._attachEvent(this._oSubjectCheckBox,"click",this._onClickSubjectCheckBox)}this._attachEvent(this._oAdvancedSearchDiv.getDescendantById("btnAF"),"click",this._onClickSearchIcon)}};Owa.UIControls.SearchControl.prototype._onSelectCategory=function Owa$UIControls$SearchControl$_onSelectCategory(){this._oCategoryCheckBox.set_IsChecked(true);this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onClickSubjectCheckBox=function Owa$UIControls$SearchControl$_onClickSubjectCheckBox(){if(!this._oSubjectCheckBox.get_IsChecked()){this._oSearchTextBox.set_Value("");this._oSearchTextBox.setAttribute("fScp","1")}else{this._oSearchTextBox.set_Value(this._oSubjectTextBox.get_Value());this._oSearchTextBox.setAttribute("fScp","0")}this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onClickSubjectTextBox=function Owa$UIControls$SearchControl$_onClickSubjectTextBox(){this._oSubjectTextBox.focus()};Owa.UIControls.SearchControl.prototype._onKeyUpSubject=function Owa$UIControls$SearchControl$_onKeyUpSubject(b){var a=this._oSubjectTextBox.get_Value();this._oSearchTextBox.set_Value(a);if(a&&a.length){this._oSubjectCheckBox.set_IsChecked(true);b.get_KeyCodeForKeyUpDown()==13&&this._search()}else this._oSubjectCheckBox.set_IsChecked(false);this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onClickRecipientTextBox=function Owa$UIControls$SearchControl$_onClickRecipientTextBox(){this._oRecipientTextBox.focus()};Owa.UIControls.SearchControl.prototype._onKeyUpRecipient=function Owa$UIControls$SearchControl$_onKeyUpRecipient(a){if(this._oRecipientTextBox.get_Value().length){this._oRecipientCheckBox.set_IsChecked(true);a.get_KeyCodeForKeyUpDown()==13&&this._search()}else this._oRecipientCheckBox.set_IsChecked(false);this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onFocusOutSubject=function Owa$UIControls$SearchControl$_onFocusOutSubject(){if(this._oSubjectTextBox){var a=this._oSubjectTextBox.get_Value();this._oSubjectCheckBox.set_IsChecked(a&&a.length)}this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onFocusOutRecipient=function Owa$UIControls$SearchControl$_onFocusOutRecipient(){var a=this._oRecipientTextBox.get_Value();this._oRecipientCheckBox.set_IsChecked(a&&a.length);this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.prototype._onSelectResultsIn=function Owa$UIControls$SearchControl$_onSelectResultsIn(){this._oResultsInCheckBox.set_IsChecked(true);this._setSearchScopeIconStyle()};Owa.UIControls.SearchControl.createClass("Owa.UIControls.SearchControl",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/searchcontrol.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/resizer.js".toLowerCase()]&&(function(){Owa.UIControls.Resizer=function Owa$UIControls$Resizer(b,a){Owa.UIControls.Resizer.constructBase(this,[a]);this.set_SubPage(b);this._fResizing=false};Owa.UIControls.Resizer.DIRECTION={VERTICAL:1,HORIZONTAL:2};var a=Owa.UIControls.Resizer.prototype;a.set_Direction=function Owa$UIControls$Resizer$set_Direction(a){this._iDirection=a};a.get_Direction=function Owa$UIControls$Resizer$get_Direction(){return this._iDirection};a.set_MinMarginBefore=function Owa$UIControls$Resizer$set_MinMarginBefore(a){this._iMinMarginBefore=a};a.get_MinMarginBefore=function Owa$UIControls$Resizer$get_MinMarginBefore(){return this._iMinMarginBefore};a.set_MinMarginAfter=function Owa$UIControls$Resizer$set_MinMarginAfter(a){this._iMinMarginAfter=a};a.get_MinMarginAfter=function Owa$UIControls$Resizer$get_MinMarginAfter(){return this._iMinMarginAfter};a.initialize=function Owa$UIControls$Resizer$initialize(){this._attachEvent(this._get_Element(),"mousedown",this._resizeStart);this._cancelEvent(this._get_Element(),"dragstart")};a.dispose=function Owa$UIControls$Resizer$dispose(){this._fResizing&&this._resizeEnd();Owa.UIControls.Resizer.callBase(this,"dispose")};a._isHorizontal=function Owa$UIControls$Resizer$_isHorizontal(){return this.get_Direction()==Owa.UIControls.Resizer.DIRECTION.HORIZONTAL};a._isVertical=function Owa$UIControls$Resizer$_isVertical(){return this.get_Direction()==Owa.UIControls.Resizer.DIRECTION.VERTICAL};a._getDragElement=function Owa$UIControl$Resizer$_getDragElement(){return this._isVertical()?this._get_Element().getDescendantById("imgVwDragHor"):this._get_Element().getDescendantById("imgVwDrag")};a._resizeStart=function Owa$UIControls$Resizer$_resizeStart(b){if(!b.isLeftButtonDown())return;var a=this._get_Element(),c=this._getDragElement();if(this._isHorizontal()){c.removeCssClass("dividerImgNotDragging");c.addCssClass("dividerImgDragging")}else if(this._isVertical()){c.removeCssClass("dividerImgNotDraggingHorizontal");c.addCssClass("dividerImgDraggingHorizontal")}a.moveToTop();a.set_OverflowX(Owa.Style.Overflow.Visible);a.set_OverflowY(Owa.Style.Overflow.Visible);this._oMask=new Owa.UIControls.TransparentMask(UniqueIdGenerator.get_Instance().get_Next(),"",Owa.Dom.Document.get_Current());this._oMask.set_SubPage(this.get_SubPage());this._oMask._get_Element().moveToTop();this._oMask.setHandler("mouseup",this._createCallback(this._onResizeUp));this._oMask.setHandler("mousemove",this._createCallback(this._onResizeMove));this._oMask.setHandler("mouseout",this._createCallback(this._onResizeOut));if(this._isHorizontal()){this._iClient=b.get_ClientX();this._oMask._get_Element()._get_DomNode().style.cursor="col-resize";if(g_fRtl){this._iOriginalNear=a.get_Right();this._iNearMin=this.get_MinMarginBefore()-a.get_Right();this._iNearMax=a._get_OffsetParent().get_OffsetWidth()-this.get_MinMarginAfter()-a.get_OffsetWidth()-a.get_Right()}else{this._iOriginalNear=a.get_Left();this._iNearMin=this.get_MinMarginBefore()-a.get_Left();this._iNearMax=a._get_OffsetParent().get_OffsetWidth()-this.get_MinMarginAfter()-a.get_OffsetWidth()-a.get_Left()}}else if(this._isVertical()){this._iClient=b.get_ClientY();this._oMask._get_Element()._get_DomNode().style.cursor="row-resize";this._iOriginalNear=a.get_Top();this._iNearMin=this.get_MinMarginBefore()-a.get_Top();this._iNearMax=a._get_OffsetParent().get_OffsetHeight()-this.get_MinMarginAfter()-a.get_OffsetHeight()-a.get_Top()}b.preventDefault();b.cancelBubble();this._fResizing=true};a._onResizeOut=function Owa$UIControls$Resizer$_onResizeOut(b){var a=b.get_ToElementForMouseOut();(!a||!a.equals(this._oMask._get_Element()))&&this._onResizeUp(b)};a._onResizeUp=function Owa$UIControls$Resizer$_onResizeUp(){this._fResizing=false;var a;if(this._isHorizontal())if(g_fRtl)a=this._get_Element().get_Right()+this._getDragElement().get_Right();else a=this._get_Element().get_Left()+this._getDragElement().get_Left();else if(this._isVertical())a=this._get_Element().get_Top()+this._getDragElement().get_Top();this._dispatchEvent(b,a);this._resizeEnd()};a._onResizeMove=function Owa$UIControls$Resizer$_onResizeMove(a){if(!a.isLeftButtonDown()){this._onResizeUp(a);return}if(this._isHorizontal())if(g_fRtl)this._getDragElement().set_Right(Math.min(Math.max(this._iClient-a.get_ClientX(),this._iNearMin),this._iNearMax));else this._getDragElement().set_Left(Math.min(Math.max(a.get_ClientX()-this._iClient,this._iNearMin),this._iNearMax));else this._isVertical()&&this._getDragElement().set_Top(Math.min(Math.max(a.get_ClientY()-this._iClient,this._iNearMin),this._iNearMax))};a._resizeEnd=function Owa$UIControls$_resizeEnd(){this._oMask.dispose();this._oMask=null;var b=this._get_Element(),a=this._getDragElement();if(this._isHorizontal()){if(g_fRtl)a.set_Right(0);else a.set_Left(0);a.removeCssClass("dividerImgDragging");a.addCssClass("dividerImgNotDragging")}else if(this._isVertical()){a.set_Top(0);a.removeCssClass("dividerImgDraggingHorizontal");a.addCssClass("dividerImgNotDraggingHorizontal")}b._get_DomNode().style.zIndex="";b.set_OverflowX(Owa.Style.Overflow.Hidden);b.set_OverflowY(Owa.Style.Overflow.Hidden)};var b="ResizeEnd";a.get_ResizeEnd=function Owa$UIControls$Resizer$get_ResizeEnd(){return this._getEventHandlerCollection(b)};Owa.UIControls.Resizer.createClass("Owa.UIControls.Resizer",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/resizer.js".toLowerCase()]=1;!g_fModuleLoaded[".\\uicontrols/viewmenu.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.ViewMenu=function Owa$UIControls$ViewMenu(d,e,c){Owa.UIControls.ViewMenu.constructBase(this,[d,e]);for(var b=this._get_Element().getAllDescendantsById("divMnuItm"),a=0;a<b.length;a++)if(b[a].getBoolAttribute("fSel")&&b[a].getBoolAttribute("fRdo"))this._oSelected=b[a];this._attachEvent(this._get_Element(),"click",this._onClick);this._fnOnUserAction=c};var a=Owa.UIControls.ViewMenu.prototype;a.dispose=function Owa$UIControls$ViewMenu$dispose(){this._oSelected=null;this._fnOnUserAction=null;Owa.UIControls.ViewMenu.callBase(this,"dispose")};a.set_UseConversations=function Owa$UIControls$ViewMenu$set_UseConversations(b){var a=this._getDescendant("useConversations");a&&this._setCheckboxState(a,b)};a.set_IsConversationOptionShown=function Owa$UIControls$ViewMenu$set_IsConversationOptionShown(b){var a=this._getDescendant("conversationOptions");a&&a.set_IsShown(b)};a.set_ReadingPanePosition=function Owa$UIControls$ViewMenu$set_ReadingPanePosition(c){var a;switch(c){case RP_OFF:case RP_NONE:a="rpo";break;case RP_RIGHT:a="rpr";break;case RP_BOTTOM:a="rpb"}var b=this._getDescendant(a).getAncestorById("divMnuItm");this._selectRadioButton(b)};a._onClick=function Owa$UIControls$ViewMenu$_onClick(b){var a=b.get_Target().getAncestorById("divMnuItm","divRPddm");if(a){if(a.getBoolAttribute("fRdo"))this._selectRadioButton(a);else a.getBoolAttribute("fChk")&&this._setCheckboxState(a,!a.getBoolAttribute("fSel"));this._fnOnUserAction(a.getAttribute("cmd"))}b.cancelBubble();b.preventDefault();Owa.UIControls.MenuButton.hideAnyPopupMenu()};a._selectRadioButton=function Owa$UIControls$ViewMenu$_selectRadioButton(a){if(a==this._oSelected)return;this._oSelected.getDescendantById("imgChk").set_IsShown(false);a.getDescendantById("imgChk").set_IsShown(true);this._oSelected=a};a._setCheckboxState=function Owa$UIControls$ViewMenu$_setCheckboxState(a,b){a.getDescendantById("imgChk").set_IsShown(b);a.setBoolAttribute("fSel",b)};Owa.UIControls.ViewMenu.createClass("Owa.UIControls.ViewMenu",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/viewmenu.js".toLowerCase()]=1;var g_iUdRpDl=500,g_fDeleteInProgress=0,FOLDER_COUNT_SYNC_DURATION=15*1e3;(function(){Type.createNamespace("Owa.Pages");Owa.Pages.ListViewSubPage=function Owa$Pages$ListViewSubPage(a){Owa.Pages.ListViewSubPage.constructBase(this,[a]);this._oFilterInfobar=null;this._oFolderCountTimer=null;this._dtLastUpdateRP=new Date;this._fFolderSizeFlag=0;this._iTempReadingPaneItemId=null;this._iTempConversationItemPartId=null;this.enblFwd_dsbld=0;this.udRP_toID=null;this.enblRpl_dsbld=0;this.setItmRead_toID=null;this.oLastUnSelectionState=null;this.fErrorOnViewLoad=0};var a=Owa.Pages.ListViewSubPage.prototype;a.fIsFolderListViewSubPage=true;a.initialize=function Owa$Pages$ListViewSubPage$initialize(){Owa.Pages.ListViewSubPage.callBase(this,"initialize");this.addResource(Owa.Components.ToolbarCollection.create(this.get_SubPage()));this.initVw();this.updateBreadcrumbs();addPerfMarker("ListView.Init.End")};a.dispose=function Owa$Pages$ListViewSubPage$dispose(){this.dispVw();Owa.Pages.ListViewSubPage.callBase(this,"dispose")};a.onIsVisibleChanged=function Owa$Pages$ListViewSubPage$onIsVisibleChanged(a){var b=this.get_VirtualListView();if(b&&b.onShowHide){if(a&&this.fErrorOnViewLoad){this._initializeVLV();this._tryUpdateConversationActionUI&&this._tryUpdateConversationActionUI();this.fErrorOnViewLoad=0}b.onShowHide(a)}a&&this.activate()};a.onFirstShow=function Owa$Pages$ListViewSubPage$onFirstShow(){var a=this.get_ReadingPanePosition();if(a==RP_RIGHT)Owa.Utility.isDefined(typeof this.get_VlvMinWidth())&&this.setVW(this.get_ViewWidth(),1,1);else if(a==RP_BOTTOM)Owa.Utility.isDefined(typeof this.get_VlvMinHeight())&&this.setVH(this.get_ViewHeight(),1,1);this.activate()};a.onResize=function Owa$Pages$ListViewSubPage$onResize(b){var a=this.get_VirtualListView();try{this.hideDialogs()}catch(c){}this.adjustLvRpContainerTop();this.adjustRPWidth();if(a&&(Owa.Utility.isFirefox()||Owa.Utility.isSafari()))a.onRsz(b);this._oFilterInfobar&&this._oFilterInfobar.resize()};a.onLoadReadingPane=function Owa$Pages$ListViewSubPage$onLoadReadingPane(){var a=this.get_VirtualListView();a&&a.isTskVw()&&this.udTskTB();a.isPrefetchEnabled()&&a&&isDf(typeof a.startPrefetch)&&a.startPrefetch()};a._onUserAction=function Owa$Pages$ListViewSubPage$_onUserAction(f,e){var a=this.get_VirtualListView();switch(f){case"newmsg":case"newmsgc":addPerfMarker("ListView.New.Start");newMail(this.isOMF(),this);return;case"newappt":newItm("IPM.Appointment",null,null,null,null,this.get_SubPage());return;case"newmtng":newItm("IPM.Appointment",null,"&mr=1",null,null,this.get_SubPage());return;case"newc":case"newcc":newCnt(null,this.get_SubPage());return;case"newcdl":newPdl(null,this.get_SubPage());return;case"newtsk":case"newtc":newItm("IPM.Task",null,null,null,this.get_SubPage());return;case"newpst":if(!this.hasEROnFld(ER_CC))return;newItm(IT_PST,this.get_FolderId(),null,null,null,this.get_SubPage());return;case BID_CM:this.ref(1);a.makeFocused();break;case BID_PDLT:case BID_DL:case BID_DLDD:case BID_DLIGNDD:var p=f==BID_PDLT;if(a.isTskVw())a.delTsks(p||this.getSubPageVariable("a_fInDelItms")||this.isPF());else if(a.isDumpsterVw())a.purgeItems();else{var g=null,c=this.gtCnvRP();if(c&&c.get_IsContextActionProcessing())g=c.gtSel();this.del(p||this.getSubPageVariable("a_fInDelItms")||this.isPF(),g,false,this.isPF());a.makeFocused()}break;case BID_IGNCNV:var j;if(a.isSelExp()){j=[];j.push(a.gtExpCnvId())}else j=a.gtSel();this.del(0,j,0,0,1);a.makeFocused();break;case BID_MV:var h=this.get_SubPage();shwCMMnu(h,Owa.Utility.createDelegate(this,this.vwCpMv));break;case"fltrc":if(a._oPrevFilterCriteria||a.isInFltrdVw()){this.get_SearchControl()&&this.get_SearchControl().clearSearch(1);if(a.isInFltrdVw())a.dsblFltrVw();else a.enblFltrVw()}else this.showFilterMenu();break;case"fltrcd":this.showFilterMenu();break;case"recover":if(a.gtSel().length>0){var b=Owa.UIControls.FolderPickerDialog.get_Default();b.set_IsShowPublicFolder(true);b.set_ButtonCaptions([L_Recover]);b.set_Title(L_RecoverToFld);b.set_IsShowArchiveFolder(a.iT==LVT_MSG);b.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;b.onButtonClick=cbCopyMoveItem;cbCopyMoveItem.fnCallback=Owa.Utility.createDelegate(this,this.vwCpMv);b.show()}break;case"MvToF":var b=Owa.UIControls.FolderPickerDialog.get_Default();b.set_IsShowPublicFolder(true);b.set_ButtonCaptions([L_Mv]);b.set_Title(L_MvToFld);b.set_IsShowArchiveFolder(a.iT==LVT_MSG);b.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;b.onButtonClick=cbCopyMoveItem;cbCopyMoveItem.fnCallback=Owa.Utility.createDelegate(this,this.vwCpMv);b.show();break;case"CpToF":var b=Owa.UIControls.FolderPickerDialog.get_Default();b.set_IsShowPublicFolder(true);b.set_ButtonCaptions([L_Cp]);b.set_Title(L_CpToFld);b.set_IsShowArchiveFolder(a.iT==LVT_MSG);b.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;b.onButtonClick=cbCopyMoveItem;cbCopyMoveItem.fnCallback=Owa.Utility.createDelegate(this,this.vwCpMv);b.show();break;case"rpo":this.tglRP(RP_OFF);break;case"rpr":this.tglRP(RP_RIGHT);break;case"rpb":this.tglRP(RP_BOTTOM);break;case"sl":a.stML(0);a.makeFocused();break;case"ml":a.stML(1);a.makeFocused();break;case"newestOnTop":this.updateReadingPaneSortOrder(0);break;case"oldestOnTop":this.updateReadingPaneSortOrder(1);break;case"showTree":this.updateListViewExpansion(1);break;case"showFlatList":this.updateListViewExpansion(0);break;case"nmsgct":var h=this.get_SubPage();newMsgToCt(h,a.gtSel(),ITTP_MSG);break;case"nmrgct":var h=this.get_SubPage();newMsgToCt(h,a.gtSel(),ITTP_MTG);break;case"markread":ClientAction.add(ClientAction.Name.MarkAsRead);this.cnclMkRd();var g=a.gtSel(),c=this.gtCnvRP();if(c&&c.get_IsContextActionProcessing())g=c.gtSel();this.setRdSt(g,MSG_READ);break;case"markunread":this.cnclMkRd();var g=a.gtSel(),r,c=this.gtCnvRP();if(c&&c.get_IsContextActionProcessing()){g=c.gtSel();r=c.get_Id()}this.setRdSt(g,MSG_UNREAD,r);break;case BID_RA:this.repFwItmNwWnd("ReplyAll");break;case BID_RE:case BID_RED:case BID_RECMB:this.repFwItmNwWnd("Reply");break;case BID_FWCMB:if(this.gtSelItms().length>1)this.fwIA();else this.repFwItmNwWnd("Forward");break;case BID_FW:case BID_FWD:this.repFwItmNwWnd("Forward");break;case BID_RES:case BID_SNDSMS:if(a.iT==LVT_MSG||a.iT==LVT_TSK)this.repFwItmNwWnd("Reply",0,IT_SMS);else this.isCntVw()&&newSmsToCt(this.get_SubPage(),a.gtSel());break;case BID_REP:break;case BID_REC:case BID_CHT:if(a.iT==LVT_MSG||a.iT==LVT_TSK)this.nwChtFrmMsg();else this.isCntVw()&&nwChtFrmRcp(this.getRecipientObject(a.gtSel()[0]));break;case BID_ABLST:var h=this.get_SubPage();addBdyLstReq(h,this.getRecipientObject(a.gtSel()[0]));break;case BID_RMBLST:var h=this.get_SubPage();rmBdyLstReq(h,this.getRecipientObject(a.gtSel()[0]));break;case BID_PR:if(!this.hasEROnFld(ER_CC)||!this.selsAreAllPsts())return;this.repFwItmNwWnd("PostReply",this.get_FolderId()?"&fId="+urlEnc(this.get_FolderId()):"");break;case"up":opnDocFldr(a_sParUri,0);break;case"opndlinnew":opnDocLstItm(1);break;case"opndc":opnDocLstItm();break;case"opnwp":opnAWP();break;case"senddc":sndDocLibsReq("SendByEmail",cbSndDoc,getSelDocLibs());break;case"copyuri":window.clipboardData.setData("Text",getDocItmUri());break;case"copyuribcb":window.clipboardData.setData("Text",wda("divDbcbm").docLib.uri);break;case"addfav":sndDocLibsReq("AddFav",cbAddFavDocFldr,getSelDocLibs());break;case"addFvTb":var l={};l.sU=a_sCurUri;sndDocLibsReq("AddFav",cbAddFavDocFldr,new Array(l));break;case"addfavbcb":var l={};l.sU=wda("divDbcbm").docLib.uri;sndDocLibsReq("AddFav",cbAddFavDocFldr,new Array(l));break;case"infomb":clkInfAbt(wda("divIMB"));break;case"infocot":clkInfAbt(wda("divICOT"));break;case"help":opnHlp(e.getAttribute("href"));break;case"open":case BID_EDT:this.openItms();break;case"addconts":this.addABCts();break;case"searchpf":this.get_SearchControl().togglePublicFolderAdvancedSearch();break;case"sndbsl":this.gtSndSmtp(ACTN_ADDBSL,e.get_TextContent(),this.gtSelItms()[0]);break;case"sndssl":addSndToJnkLst(this.get_SubPage(),SSL,this.gtSelItms()[0],0,e.get_TextContent());this.refreshConversationRP();break;case"snddmssl":addSndToJnkLst(this.get_SubPage(),SSL,this.gtSelItms()[0],1,e.get_TextContent());this.refreshConversationRP();break;case"ntjnk":this.gtSelItms().length==1&&this.gtSndSmtp(ACTN_NTJNK,null,this.gtSelItms()[0]);break;case"markcomplete":a.isTskVw()&&a.mkSelCmp();break;case"crrul":var d;if(this.get_ReadingPanePosition()==RP_OFF)d=a.gtSel()[0];else d=this.gtSelItms()[0];if(Ews.BaseId.IsOwaCnvId(d)){var s=a.gtRwById(d);if(s){var t=a.getData(s),q=t.getAttribute("sMID");if(q)d=q}}opnEcpNewRul(this.get_SubPage(),"id="+urlEnc(d));break;case"opdlvrp":this.gtDlvRp();break;case"opmsgnote":var d=this.gtSelItms()[0];if(!Ews.BaseId.IsOwaCnvId(d)){var n=Owa.UIControls.MessageAnnotationDialog.get_Default();n.set_Item(d);n.show()}break;case"nwCstm":newCstm(e,this.get_FolderId(),this.get_SubPage());break;case"cstmCM":var i=e.getAttribute("_sUrl"),m=a.gtSel();i+="&fId="+urlEnc(this.get_FolderId());i+="&n="+m.length;for(var k=0;k<m.length;k++)i+="&id"+k+"="+urlEnc(m[k]);sfWinOpn(i);break;case"copy":var o=a.crtDC();if(o)o.save(new Owa.Components.Storage.Clipboard);else canEvt();break;case BID_FWA:case BID_FWAD:this.fwIA();break;case"newsms":newSms(this.get_SubPage());break;case BID_SHCAL:case BID_SHTSK:case BID_SHCNT:break;case BID_OPNCNT:case BID_OPNTSK:opnShrDlgInVw(this.get_SubPage(),f);break;case BID_CHP:break;case"emptyfolder":this.emptyFolder();break;default:if(f.startsW("mir"))this.rspMI(f.substring(3,4),f.substring(4,5));else Owa.Pages.ListViewSubPage.callBase(this,"_onUserAction",[f,e])}};a._onShowViewMenu=function Owa$Pages$ListViewSubPage$_onShowViewMenu(){this._oViewMenu.set_UseConversations(this.get_VirtualListView().isCnvVw())};a.get_VirtualListView=function Owa$Pages$ListViewSubPage$get_VirtualListView(){return this._oVirtualListView};a.get_SearchControl=function Owa$Pages$ListViewSubPage$get_SearchControl(){return this._oSearchControl};a.get_FolderId=function Owa$Pages$ListViewSubPage$get_FolderId(){return this.getSubPageVariable("a_sFId")};a.get_VlvMinWidth=function Owa$Pages$ListViewSubPage$get_VlvMinWidth(){return this.getSubPageVariable("a_iVlvMinWidth")};a.set_VlvMinWidth=function Owa$Pages$ListViewSubPage$set_VlvMinWidth(a){if(a<this._iStrictVlvMinWidth)a=this._iStrictVlvMinWidth;this.setSubPageVariable("a_iVlvMinWidth",a);this._getDescendant("divLVContainer").set_MinWidth(a)};a.get_VlvMinHeight=function Owa$Pages$ListViewSubPage$get_VlvMinHeight(){return this.getSubPageVariable("a_iVlvMinHeight")};a.set_VlvMinHeight=function Owa$Pages$ListViewSubPage$set_VlvMinHeight(a){this.setSubPageVariable("a_iVlvMinHeight",a)};a.get_ViewWidth=function Owa$Pages$ListViewSubPage$get_ViewWidth(){return this.getSubPageVariable("a_iVW")};a.set_ViewWidth=function Owa$Pages$ListViewSubPage$set_ViewWidth(a){this.setSubPageVariable("a_iVW",a)};a.get_ViewHeight=function Owa$Pages$ListViewSubPage$get_ViewHeight(){return this.getSubPageVariable("a_iVH")};a.set_ViewHeight=function Owa$Pages$ListViewSubPage$set_ViewHeight(a){this.setSubPageVariable("a_iVH",a)};a._get_ReadingPaneMinWidth=function Owa$Pages$ListViewSubPage$_get_ReadingPaneMinWidth(){return this._iReadingPaneMinWidth};a._set_ReadingPaneMinWidth=function Owa$Pages$ListViewSubPage$_set_ReadingPaneMinWidth(a){this._iReadingPaneMinWidth=a};a._get_ReadingPaneMinHeight=function Owa$Pages$ListViewSubPage$_get_ReadingPaneMinHeight(){return this._iReadingPaneMinHeight};a._set_ReadingPaneMinHeight=function Owa$Pages$ListViewSubPage$_set_ReadingPaneMinHeight(a){this._iReadingPaneMinHeight=a};a.get_ItemIdInReadingPane=function Owa$Pages$ListViewSubPage$get_ItemIdInReadingPane(){return this._sItemIdInReadingPane};a.set_ItemIdInReadingPane=function Owa$Pages$ListViewSubPage$set_ItemIdInReadingPane(a){this._sItemIdInReadingPane=a};a.get_ItemIdInConversation=function Owa$Pages$ListViewSubPage$get_ItemIdInConversation(){return this._iItemIdInConversation};a.set_ItemIdInConversation=function Owa$Pages$ListViewSubPage$set_ItemIdInConversation(a){this._iItemIdInConversation=a};a.get_ReadingPanePosition=function Owa$Pages$ListViewSubPage$get_ReadingPanePosition(){return this.getSubPageVariable("a_iRP")};a.set_ReadingPanePosition=function Owa$Pages$ListViewSubPage$set_ReadingPanePosition(a){this.setSubPageVariable("a_iRP",a)};a.get_FilterContextMenu=function Owa$Pages$ListViewSubPage$get_FilterContextMenu(){return this._oFilterContextMenu};a.set_FilterContextMenu=function Owa$Pages$ListViewSubPage$set_FilterContextMenu(a){this._oFilterContextMenu=a};a.get_NewestOnTop=function Owa$Pages$ListViewSubPage$get_NewestOnTop(){return this.getSubPageVariable("a_fNwOnTop")};a.set_NewestOnTop=function Owa$Pages$ListViewSubPage$set_NewestOnTop(a){this.setSubPageVariable("a_fNwOnTop",a)};a.get_EffectiveRights=function Owa$Pages$ListViewSubPage$get_EffectiveRights(){return this.getSubPageVariable("a_iER")};a.get_ELCFolderWithQuota=function Owa$Pages$ListViewSubPage$get_ELCFolderWithQuota(){return this.getSubPageVariable("a_fELCFldWtQt")};a.get_ELCFolderQuota=function Owa$Pages$ListViewSubPage$get_ELCFolderQuota(){return this.getSubPageVariable("a_iELCFldQt")};a.get_ELCFolderId=function Owa$Pages$ListViewSubPage$get_ELCFolderId(){return this.getSubPageVariable("a_sELCId")};a.get_FilterRecipientName=function Owa$Pages$ListViewSubPage$get_FilterRecipientName(){return this.getSubPageVariable("a_sFltrRpNm")};a.get_IsFilterInFavorite=function Owa$Pages$ListViewSubPage$get_IsFilterInFavorite(){return this.getSubPageVariable("a_fFltrInFav")};a.get_OOF=function Owa$Pages$ListViewSubPage$get_OOF(){return this.getSubPageVariable("a_fOof")};a.crtLV=function Owa$Pages$ListViewSubPage$crtLV(){var a=this._getDescendant("divVLV");switch(a.getIntAttribute("iT")){case LVT_MSG:return new Owa.UIControls.MsgVLV(this,a);case LVT_TSK:return new Owa.UIControls.TskVLV(this,a);case LVT_CTL:case LVT_CTM:case LVT_CTP:return new Owa.UIControls.ContactsVLV(this,a);case LVT_DRL:case LVT_DRP:case LVT_RML:case LVT_RMP:return new Owa.UIControls.AddressBookVLV(this,a);case LVT_DMP:return new Owa.UIControls.DumpsterVLV(this,a)}};a.adjustLvRpContainerTop=function Owa$Pages$ListViewSubPage$adjustLvRpContainerTop(){var c=this.get_VirtualListView();if(!c||c.iT!=LVT_MSG||isSWP())return;var b=a_iViewHeaderHeight,a=this._oInfobar.getOffsetHeight();if(a)b+=a+1;var d=this._getDescendant("divLVRPContainer");d.set_Top(b)};a.initCnvVw=function Owa$Pages$ListViewSubPage$initCnvVw(b){var a=this.get_VirtualListView();if(b)a.stOnRfExp(this._createCallback(this.udCnvLV));else a.stOnRfExp(0)};a.isCntVw=function Owa$Pages$ListViewSubPage$isCntVw(){var b=this.get_VirtualListView(),a=b.iT;return a==LVT_CTM||a==LVT_CTL||a==LVT_CTP||a==LVT_DRL||a==LVT_DRP||a==LVT_RML||a==LVT_RMP};a.onNavigatePkr=function Owa$Pages$ListViewSubPage$onNavigatePkr(){var a=wt();a!=window&&a.onNavigatePkr&&a.onNavigatePkr()};a._initializeVLV=function Owa$Pages$ListViewSubPage$_initializeVLV(){var a=this.get_VirtualListView();this.oDivViewMenu=this._getDescendant("divVwm");this.oDivViewMenu&&a.stCM(this.oDivViewMenu._get_DomNode(),this.get_ActionHandler(),this._createCallback(this.cmPreShw));this.oDivAbm=this._getDescendant("divAbm");this.oDivAbm&&a.stABM(this.oDivAbm._get_DomNode());a.initialize()};a.initVw=function Owa$Pages$ListViewSubPage$initVw(){var a=this.get_VirtualListView();this._iReadingPaneMinWidth=g_iMinRPW;this._iReadingPaneMinHeight=g_iMinRPH;this._attachEvent(this._get_Element(),"selectstart",cancelSelectStart);var i=this._getDescendant("lnkHdELC"),f=this._getDescendant("lnkRmvOofIB"),h=this._getDescendant("lnkChgPwd"),g=this._getDescendant("lnkRmvPwdIB");this._oDivRPddm=this._getDescendant("divRPddm");i&&this._attachEvent(i,"click",this._onClickHideELCComment);f&&this._attachEvent(f,"click",this.removeIb);h&&this._attachEvent(h,"click",this.onNavigateChgPwd);g&&this._attachEvent(g,"click",this.removeIb);g_iLgn=2;this._iStrictVlvMinWidth=this.get_VlvMinWidth();if(!this._oFilterInfobar)this._oFilterInfobar=new Owa.UIControls.FilterInfobar(this);this.adjustVLVToolbars();if(!this._oViewWidthResizer){var e=this._getDescendant("divLVDivider");if(e){this._oViewWidthResizer=this.addResource(new Owa.UIControls.Resizer(this.get_SubPage(),e));this._oViewWidthResizer.set_Direction(Owa.UIControls.Resizer.DIRECTION.HORIZONTAL);this._oViewWidthResizer.set_MinMarginBefore(this.get_VlvMinWidth());this._oViewWidthResizer.set_MinMarginAfter(this._get_ReadingPaneMinWidth());this._oViewWidthResizer.initialize();this._oViewWidthResizer.get_ResizeEnd().add(this._createCallback(this._setViewWidthAfterResize))}}if(!this._oViewHeightResizer){var d=this._getDescendant("divLVDividerHorizontal");if(d){this._oViewHeightResizer=this.addResource(new Owa.UIControls.Resizer(this.get_SubPage(),d));this._oViewHeightResizer.set_Direction(Owa.UIControls.Resizer.DIRECTION.VERTICAL);this._oViewHeightResizer.set_MinMarginBefore(this.get_VlvMinHeight());this._oViewHeightResizer.set_MinMarginAfter(this._get_ReadingPaneMinHeight());this._oViewHeightResizer.initialize();this._oViewHeightResizer.get_ResizeEnd().add(this._createCallback(this._setViewHeightAfterResize))}}this._oInfobar=this.addResource(new Owa.UIControls.Infobar(this._getDescendant("divInfobar")));this._oInfobar.set_SubPage(this.get_SubPage());this.initRmTb();if(this._oDivRPddm){this._oViewMenu=new Owa.UIControls.ViewMenu(this._oDivRPddm,null,this.get_ActionHandler());this._oViewMenu.set_IsConversationOptionShown(this.get_SubPage().get_ParentSubPage()!=null);this.addResource(this._oViewMenu);var k=this._createCallback(this._onShowViewMenu);Owa.Components.ToolbarCollection.get(this).getButton("rps").get_OnBeforePopup().add(k)}if(!this.get_VirtualListView()){a=this.addResource(this.crtLV());this._oVirtualListView=a}a.stOnErr(this._createCallback(this.onErrorVw));a.stOnNav(this._createCallback(this.isPkrVw()?this.onNavigatePkr:this.onNavigateVw));a.stOnBRfrsh(this._createCallback(this.onBRfrshVw));a.stOnERfrsh(this._createCallback(this.onERfrshVw));a.stOnSelChg(this._createCallback(this.onSelChngVw));a.stOnRmvRws(this._createCallback(this.onRmvItmsVw));a.stReadingPaneOn(this._createCallback(this.isReadingPaneOn));a.stOnFetchRP(this._createCallback(this.cbFetchRP));a.stGtSF(this._createCallback(this.lvGtSF));if(this.get_IsShown(true))this._initializeVLV();else this.fErrorOnViewLoad=1;this.isCntVw()&&0>=a.gtTC()&&this.udCntFnc();if(!this.get_SearchControl()&&$("divSearchBox")){var c=new Owa.UIControls.SearchControl(this,this._getDescendant("divSearchBox"));this.addResource(c);c.initialize();this._oSearchControl=c}this.isPkrVw()&&Owa.Dom.Window.get_Current().get_ParentWindow()._domWindow.chgAbLvSt(1);this.get_IsShown()&&a.makeFocused();this.get_HotKeyManager().addHotKey(L_HkCpy,"copy",true);var j=this._getDescendant("ifRP");if(j){var b=Owa.Components.SubPageControllerFactory.getControllerByElement(j);this.get_SubPageController().addChildController(b);Owa.UIControls.DivSubPageController.isInstance(b)&&b.initialize()}};a.getVwOfSt=function Owa$Pages$ListViewSubPage$getVwOfSt(){var a=this._getDescendant("tblRPB"),b=a.getDescendantById("tdLV");return b.get_OffsetTop()+this._getDescendant("tdC").get_OffsetTop()};a._setViewWidthAfterResize=function Owa$Pages$ListViewSubPage$_setViewWidthAfterResize(a){this.setVW(a,1)};a._setViewHeightAfterResize=function Owa$Pages$ListViewSubPage$_setViewHeightAfterResize(a){this.setVH(a,1)};a.fireUpdCnt=function Owa$Pages$ListViewSubPage$fireUpdCnt(){var b=this.get_VirtualListView(),a=b;a.iT==LVT_MSG&&(!a.isFltrd()&&!(a.isInFltrdVw&&a.isInFltrdVw()))&&g_oEd.fire("UpdateCount",a.sSid,a.iTIC,a.iUC)};a.isPF=function Owa$Pages$ListViewSubPage$isPF(){return Owa.Utility.isDefined(typeof this.getSubPageVariable("a_fPF"))?this.getSubPageVariable("a_fPF"):0};a.isOMF=function Owa$Pages$ListViewSubPage$isOMF(){return Owa.Utility.isDefined(typeof this.getSubPageVariable("a_fOMF"))?this.getSubPageVariable("a_fOMF"):0};a.chkDlgtPrms=function Owa$Pages$ListViewSubPage$chkDlgtPrms(a){if(!this.hasEROnFld(a)){alrt(L_ErrNoPsm,0,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng);return 0}return 1};a.hasMultipleItemsSelected=function Owa$Pages$ListViewSubPage$hasMultipleItemsSelected(){return this.gtSelItms().length>1};a.dispVw=function Owa$Pages$ListViewSubPage$dispVw(){var c=this.get_VirtualListView();Owa.Components.ToolbarCollection.get(this).dispose();c.dispose();var b=this._getDescendant("ifRP");if(b){var a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);a&&a.dispose()}if(this._oDivRPddm){this._oDivRPddm.dispose();this._oDivRPddm.remove(true);this._oDivRPddm=null}this._oVirtualListView=null;this._oSearchControl=null;this._oFilterInfobar=null;this._oFilterContextMenu=null;this._oViewWidthResizer=null;this._oViewHeightResizer=null};a.getItemToolbarId=function Owa$Pages$ListViewSubPage$getItemToolbarId(){return"divTBL"};a.getViewToolbarId=function Owa$Pages$ListViewSubPage$getViewToolbarId(){return null};a.adjustVLVToolbars=function Owa$Pages$ListViewSubPage$adjustVLVToolbars(){if(!this._get_Element().get_IsShown()||isSWP())return;var b=Owa.Components.ToolbarCollection.get(this).adjustToolbarWidths(this.getItemToolbarId(),this.getViewToolbarId(),"divReplyForwardToolbar","divActionsButtonToolbar");this.set_VlvMinWidth(b);var a=this._getDescendant("divLVContainer").get_ClientWidth();a<this.get_VlvMinWidth()&&this.setVW(this.get_VlvMinWidth(),0);this.get_ReadingPanePosition()==RP_RIGHT&&this.adjustRPWidth();if(this._oViewWidthResizer){this._oViewWidthResizer.set_MinMarginBefore(this.get_VlvMinWidth());this._oViewWidthResizer.set_MinMarginAfter(this._get_ReadingPaneMinWidth())}Owa.Components.ToolbarCollection.fixToolbars()};a.adjustRPWidth=function Owa$Pages$ListViewSubPage$adjustRPWidth(){var a=this._getDescendant("divRPContainer");if(a&&this.get_ReadingPanePosition()==RP_RIGHT){a.set_Width(null);var b=a.get_ClientWidth();b<this._get_ReadingPaneMinWidth()&&a.set_Width(this._get_ReadingPaneMinWidth())}};a.isPkrVw=function Owa$Pages$ListViewSubPage$isPkrVw(){var b=this.get_VirtualListView(),a=b.iT;return a==LVT_CTP||a==LVT_DRP||a==LVT_RMP};a.initRmTb=function Owa$Pages$ListViewSubPage$initRmTb(){Owa.Components.ToolbarCollection.get(this).addToolbars(["divMsgItemTB","divMsgViewTB","divTBL","divTBR","divActionsButtonToolbar"],this.get_ActionTable());this.initTbED()};a.initTbED=function Owa$Pages$ListViewSubPage$initTbED(){if(!Owa.Utility.isDefined(typeof this.get_EffectiveRights()))return;var b=this.get_EffectiveRights(),c=this.isOMF();if(this.isOMF())return;var a=this.get_SubPage().get_ActionTable();if(!hasER(b,ER_CC)){a.getAction(BID_NP).disable();a.getAction(BID_PR).disable();a.getAction(BID_NT).disable();a.getAction("newcc").disable();a.getAction("newccd").disable()}!hasER(b,ER_RD)&&a.getAction(BID_CM).enable()};a.shPRoRA=function Owa$Pages$ListViewSubPage$shPRoRA(){var b=this.selsAreAllPsts(),a=!b;Owa.Components.ToolbarCollection.get(this).set_IsButtonShown(BID_PR,!a);Owa.Components.ToolbarCollection.get(this).set_IsButtonShown(BID_RA,a)};a.selsAreAllPsts=function Owa$Pages$ListViewSubPage$selsAreAllPsts(){var c=this.get_VirtualListView(),a=c.gtSel();if(!a.length)return 0;for(var b=0;b<a.length;b++)if(!this.isItmOfType(a[b],IT_PST))return 0;return 1};a.cmPreShw=function Owa$Pages$ListViewSubPage$cmPreShw(a){var b=a._get_Element().getAttribute("_rgCnvOnlyItems");b&&a.showMenuItems(b.split(","),false);var d=this.get_VirtualListView(),c=getInt(d.iT);switch(c){case LVT_MSG:this.cmPreShwMsg(a);break;case LVT_DOC:cmPreShwDoc();break;case LVT_CTM:case LVT_CTL:case LVT_CTP:case LVT_DRL:case LVT_DRP:case LVT_RML:case LVT_RMP:this.cmPreShwCnt(a,c);break;case LVT_TSK:this.cmPreShwTsk(a)}};a.cmPreShwMsg=function Owa$Pages$ListViewSubPage$cmPreShwMsg(a){var b=this.get_VirtualListView(),c=b.gtSel()[0],u=b.isCnvVw&&b.isCnvVw();if(!c)return;if(this.isReadingPaneOn()&&u&&(null==this._iTempReadingPaneItemId||this._iTempReadingPaneItemId!=this.get_ItemIdInReadingPane()))return;if(b.gtSelCnt()==0)return;if(u){a.showMenuItem("divIgnCnv",this._fIgnoreConversationMenuItem);a.showMenuItem("divCanIgnCnv",this._fCanIgnoreConversationMenuItem)}var g=true,l=true;if(b.gtSelCnt()>1){var n=["divR","divRA","divPR","divF","divMIA","divMIT","divMID","divS1","divS2"];a._getDescendant("divCR")&&n.push("divCR");a._getDescendant("divCht")&&n.push("divCht");a._getDescendant("divSndSms")&&n.push("divSndSms");a.showMenuItems(["divMR","divMU"],1);a.showMenuItems(n,0);isJnkEnbl()&&a.showMenuItems(["divJnk","divS5"],0);g=false;l=false}else{var M=b.gtRwPrp(c,"read"),L=!M||M==MSG_READ,t=this.isPhsh(c),p=this.isItmOfType(c,IT_PST),H=canItmRpl(b.gtRwPrp(c,"t"));a.showMenuItem("divMU",L);a.showMenuItem("divMR",!L);if(p||!this.itemSupportsDeliveryReport(c,b))g=false;var R=this.get_SubPage(),E=b.gtRwPrp(c,"fJnk")=="1",B=isJnkFld(R);if(B||t||E){a.showMenuItems(["divR","divRA","divF","divPR","divMIA","divMIT","divMID","divS2"],0);a._getDescendant("divCht")&&a.showMenuItem("divCht",0);a._getDescendant("divSndSms")&&a.showMenuItem("divSndSms",0)}else{if(H){a.showMenuItem("divR",1);if(a._getDescendant("divCht")){a.showMenuItem("divCht",1);if(!g_fIsIMEnab||!gtMstr()||!gtMstr().g_fSignedIn||isMSNPrv()&&(!this.isReadingPaneOn()||this._iTempReadingPaneItemId!=c||!(oRdPn=this.gtCnvRP())||!(oSpn=oRdPn._getDescendant("spnFrom"))||!isBuddy(oSpn.getAttribute("_uri"))))a.enableMenuItem("divCht",0);else a.enableMenuItem("divCht",1)}a._getDescendant("divSndSms")&&a.showMenuItem("divSndSms",1);a.showMenuItem("divRA",!p);a.showMenuItem("divPR",p)}else{a.showMenuItems(["divR","divRA","divPR"],0);a._getDescendant("divCht")&&a.showMenuItem("divCht",0);a._getDescendant("divSndSms")&&a.showMenuItem("divSndSms",0)}var S=b.gtRwPrp(c,"fInDelItms")=="1",T=b.gtRwPrp(c,"fMR")=="1"&&b.gtRwPrp(c,"fRR")=="1"&&b.gtRwPrp(c,"fDoR")!="1"&&!this.isPF()&&!t&&!S,I=["divMIA","divMIT","divMID","divS2"];a.showMenuItems(I,T);a.enableMenuItems(I,true);a.showMenuItems(["divF","divS1"],1)}if(a._getDescendant("divCR")){a.showMenuItem("divCR",H);a.enableMenuItem("divCR",!isWP()&&!this.isPF()&&!p&&!this.isOMF())}if(isJnkEnbl()){a.showMenuItems(["divJnk","divS5"],!this.isPF()&&!this.isOMF());if(B||E)a.showMenuItems(["divNtJnk","divS11"],!t);else a.showMenuItems(["divNtJnk","divS11"],0)}}a.enableMenuItems(["divMIA","divMIT","divMID"],g_oFldrMgr.gtFL(this.get_FolderId())!=FL_AMB);if(a._getDescendant("divDelPtg"))if(g_oFldrMgr.isMyFId(this.get_FolderId())||g_oFldrMgr.gtFL(this.get_FolderId())==FL_AMB){a.showMenuItem("divDelPtg",1);var K=b.gtSel(),G=Owa.UIControls.DeletePolicyContextMenu.get_Instance(this.get_SubPage());G.set_SelectedIds(K);G.set_LocalFolderId(this.get_FolderId())}else a.showMenuItem("divDelPtg",0);if(a._getDescendant("divMvPtg"))if(isJnkFld(this.get_SubPage())||!g_oFldrMgr.isMyFId(this.get_FolderId()))a.showMenuItem("divMvPtg",0);else{a.showMenuItem("divMvPtg",1);var K=b.gtSel(),J=Owa.UIControls.MovePolicyContextMenu.get_Instance(this.get_SubPage());J.set_SelectedIds(K);J.set_LocalFolderId(this.get_FolderId())}a.enableMenuItem("divPR",this.hasEROnFld(ER_CC));isSWP()&&a.showMenuItems(["divS6","divMvToF","divCpToF"],0);for(var q=0,f=b.gtSel(),d=0;d<f.length&&!q;d++)q|=isApprovalRequest(this.getItemType(f[d],b));a.showMenuItems(["divFIA","divS3"],!q);q&&a.showMenuItems(["divF"],0);var Q=this.isRightRestricted(b,"fReplyRestricted","fRplR"),P=this.isRightRestricted(b,"fReplyAllRestricted","fRAR"),v=this.isRightRestricted(b,"fForwardRestricted","fFR"),x=isFtEnab(FT_CAL)&&this.isSharingItemSelected(b);a.enableMenuItem("divF",!x&&!v);a.enableMenuItem("divFIA",!x&&!v);a.enableMenuItem("divR",!Q);a.enableMenuItem("divRA",!P);if(u&&!b.isSelExp()){for(var k=b.gtCnvRS(f[0]),d=1;d<f.length&&k!=0;d++)if(b.gtCnvRS(f[d])!=k){k=0;break}a.showMenuItem("divMR",k<=0);a.showMenuItem("divMU",k>=0);l=false}if(this.isCnvSelected()){a._getDescendant("divJnk")&&a.showMenuItems(["divJnk","divS5"],0);a._getDescendant("divCht")&&a.showMenuItem("divCht",0);a._getDescendant("divSndSms")&&a.showMenuItem("divSndSms",0);var o=b.getData(b.gtRwById(f[0]));a._getDescendant("divCR")&&o&&!o.getAttribute("sMID")&&a.showMenuItem("divCR",0);(!this.isReadingPaneOn()||f.length>1)&&a.showMenuItems(["divPR","divR","divRA","divF","divFIA","divS1","divS2","divS3"],0);if(!o||o.getAttribute("iGC")>1)g=false}if(this.isOMF())g=false;if(g_oFldrMgr.gtFL(this.get_FolderId())==FL_AMB)g=false;a._getDescendant("divOpDlvRp")&&a.enableMenuItems(["divSODL","divOpDlvRp"],g);var s=b.gtRwPrp(c,"t");if(s==null||s!="IPM.Note"&&s!="IPM.Conversation")l=false;a._getDescendant("divOpMsgNote")&&a.showMenuItems(["divMsgNote","divOpMsgNote"],l);var F=a._getDescendant("divCustomSep");if(!F)return;for(var O=10,y=b.gtSel(),h=null,D=true,j=0;j<y.length;j++){var N=b.gtPrpV(b.gtRwById(y[j]),"t");if(h&&N!=h){D=false;break}else if(!h)h=N}for(var z=a.get_CustomMenuIds(),m=[],C=[],d=0;d<z.length;d++){var r=z[d],i=true,A=a.getMenuItemAttribute(r,"_sT");if(A){var w=A.split(";");if(D){i=false;for(var j=0;j<w.length;j++){var e=w[j].trim();if(e.length>2&&e.substr(e.length-2)==".*"){e=e.substr(0,e.length-2);if(isOfClss(h,e))i=true}else if(e==h)i=true;if(i)break}}else i=false}if(i&&m.length<O)m.push(r);else C.push(r)}a.showMenuItems(m,true);a.showMenuItems(C,false);F.set_IsShown(m.length>0)};a.cmPreShwCnt=function Owa$Pages$ListViewSubPage$cmPreShwCnt(a,d){var b=this.get_VirtualListView(),g=canEml(b),f=["divNM","divS1"];a._getDescendant("divNMR")&&f.push("divNMR");a.showMenuItems(f,g);a._getDescendant("divSndSms")&&a.showMenuItem("divSndSms",canSms(b));if(g_fIsIMEnab){var e=this.canIM(b),j=this.oDivViewMenu.getDescendantById("divCht"),k=this.oDivViewMenu.getDescendantById("divS4"),h=this.oDivViewMenu.getDescendantById("divAdBdyLst"),i=this.oDivViewMenu.getDescendantById("divRmBdyLst");a.showMenuItem("divCht",e);a.enableMenuItem("divCht",!(gtMstr()&&gtMstr().g_iIM_SI));if(e){var c=0;if(gtIMMgr())c=gtIMMgr().bdyLst.IsBdy(b.gtRwPrp(b.gtSel()[0],"uri"));a.showMenuItem("divAdBdyLst",!c);a.showMenuItem("divRmBdyLst",c);isMSNPrv()&&a.enableMenuItem("divCht",c)}else a.showMenuItems(["divS4","divAdBdyLst","divRmBdyLst"],0)}d!=LVT_CTM&&d!=LVT_CTL&&d!=LVT_CTP&&a._getDescendant("divS2")&&a.showMenuItems(["divS2","divACT"],1)};a.refresh=function Owa$Pages$ListViewSubPage$refresh(c,b){var a=this.get_VirtualListView();a&&a.rfrsh(1,null,b)};a.unselect=function Owa$Pages$ListViewSubPage$unselect(){var f=this.setItmRead_toID==null,b=this.get_VirtualListView();this.cnclMkRd();var e=this.get_MarkAsReadBehaviour();(e==MR_SELCHANGE||e==MR_DELAYED&&f)&&this.get_ItemIdInReadingPane()!=null&&this.isUnrd(this.get_ItemIdInReadingPane(),1)&&this.setItmRead();if(b&&b.iT==LVT_MSG){var c=0,a=this._oInfobar.getMessageById("divOofIB");if(a){this._oInfobar.removeMessage(a);c=1}a=this._oInfobar.getMessageById("divPwdIB");if(a){this._oInfobar.removeMessage(a);c=1}c&&this.adjustLvRpContainerTop()}b&&b.isTskVw()&&this.clearQuickTask();var d=Owa.UIControls.MediaPlayer.get_Instance();d&&d.get_Controller()==b&&d.set_Controller(null)};a.select=function Owa$Pages$ListViewSubPage$select(b){var a=this.get_VirtualListView(),c=this.get_SearchControl();if(!a)return;a.makeFocused();var f=b.fR||a.isFltrd();if(f){a.isFltrd()&&c&&c.clearSearch(1);b.sFltr&&a.stFltr(b.sFltr);var d=b.mId;if(d)a.seekRw(d);else this.ref()}else this.udRP();!f&&this.gtFldSz();if(a.isCnvVw&&a.isCnvVw()){var e=this.gtCnvRP();e&&!e.get_IsRefreshing()&&this.refreshConversationRP(true)}this.adjustLvRpContainerTop();this.adjustVLVToolbars();this.updateBreadcrumbs()};a.updateBreadcrumbs=function Owa$Pages$ListViewSubPage$updateBreadcrumbs(){var c=this.get_ParentSubPage();if(!c)return;var a=c.get_Breadcrumbs();if(!a)return;a.set_FolderName(this.getSubPageVariable("a_sFldNm"));a.set_Count(this.get_VirtualListView().gtTIC());a.set_Metadata(this.getSubPageVariable("a_sFldDtaStr"));var b=this._oInfobar.getMessageById("divElcIB");if(b&&!b.get_IsShown())a.showElcLink();else a.hideElcLink()};a.hideDialogs=function Owa$Pages$ListViewSubPage$hideDialogs(){this.get_ParentSubPage().layoutAlertBar();Owa.UIControls.NotificationDialog.hideAllDialogs();hideOpenMailboxDialog()};a.onErrorVw=function Owa$Pages$ListViewSubPage$onErrorVw(a){if(a.iEC==440)rplLgn();else alrt(a.sMsg)};a.onNavigateVw=function Owa$Pages$ListViewSubPage$onNavigateVw(a){var c=this.get_VirtualListView(),d=a.oCtx,b=a.fCl;if(c.iT!=LVT_DOC)this.openItms(null,d,b);else opnDocLstItm()};a.del=function Owa$Pages$ListViewSubPage$del(g,a,k,f,e,o){var b=this.get_VirtualListView();if(!a)a=b.gtSel(1);if(!g&&b.isCnvVw&&b.isCnvVw()&&!Ews.BaseId.IsOwaCnvId(a[0])&&!e){for(var c=this.gtCnvRP(),h=[],m=[],i,d=0;d<a.length;d++){i=a[d];if(this.isDeletedItem(b,c,i))h.push(i);else m.push(i)}if(m.get_Length()>0&&h.get_Length()>0){this.del(true,h,k,f,e,[]);this.del(false,m,k,f,e,a);return}else if(h.get_Length()>0)g=true}var q=a.length;if(!q)return;if(q>MAX_REQ_ITMS){alrt(L_ErrMaxItms);return}if(b.fROLv)return;if(g){if(!confirm(L_PrDelPrp))return}else if(this.checkCnvHasPermanentDeleteItems(a))if(!confirm(L_PrParDelPrp))return;ClientAction.add(ClientAction.Name.DeleteRow);addPerfMarker("ListView.Delete.Start");f|=b.isFltrd();this.cnclMkRd();var l=Owa.Utility.createDelegate(this,this.sndDel);if(e&&PONT_IGNCNV&a_iEnblPnt)l=Owa.Utility.createDelegate(this,this.showIgnorePont);var n={};if(!Ews.BaseId.IsOwaCnvId(a[0]))for(var c=this.gtCnvRP(),d=0;d<a.length;d++){var j=b.gtRwPrp(a[d],"t");if(!j){var p=c.oItemParts[a[d]];if(p)j=p.get_ItemType()}if(isOfClss(j,IT_MTR)||isOfClss(j,IT_MTC))n[a[d]]=true}if(b.isCnvVw&&b.isCnvVw()&&(!c||!c.get_IsContextActionProcessing()))b.cnvDel(a,n,g,f,l,e,o);else l(g,a,n,k,f||c&&c.get_IsContextActionProcessing(),c&&c.get_IsContextActionProcessing(),e,o)};a.showIgnorePont=function Owa$Pages$ListViewSubPage$showIgnorePont(h,e,g,b,f,d,c){var a={};a.fP=h;a.rgId=e;a.oMM=g;a.fRecurrence=b;a.fRf=f;a.fCnv=d;a.rgUIRemove=c;shwPont(PONT_IGNCNV,L_IgnCnvWrn,L_IgnCnv,[L_OK,L_Cncl],0,Owa.Utility.createDelegate(this,this.cbShowIgnorePont),a)};a.cbShowIgnorePont=function Owa$Pages$ListViewSubPage$cbShowIgnorePont(b,a){var c=b==-1||b==1;this.sndDel(a.fP,a.rgId,a.oMM,a.fRecurrence,a.fRf,a.fCnv,1,c,a.rgUIRemove)};a.checkCnvHasPermanentDeleteItems=function Owa$Pages$ListViewSubPage$checkCnvHasPermanentDeleteItems(b){var c=this.get_VirtualListView();if(c.isCnvVw)for(var d=this.gtCnvRP(),a=0;a<b.length;++a)if(this.isDeletedItem(c,d,b[a]))return true;return false};a.isDeletedItem=function Owa$Pages$ListViewSubPage$isDeletedItem(d,c,a){if(!Ews.BaseId.IsOwaCnvId(a)){var b=d.gtRwPrp(a,"fInDelItms");if(b){if(b=="1")return true}else if(c&&c.isDeletedItem(a))return true}return false};a.sndDelOeh=function Owa$Pages$ListViewSubPage$sndDelOeh(g,a,q,n,p,o,i,m,j){if(m){g_fDeleteInProgress=0;return}if(g_fDeleteInProgress)return;g_fDeleteInProgress=1;var d=this.get_VirtualListView(),l=d.get_DataFolderId();Owa.PendingOperationsManager.increment(l);d.rmvRws(j?j:a);var b={};b.rgId=a;b.fRf=p;b.fP=g;b.fCnv=o;b.fIgnoreConversations=i;b.sFId=l;var h;if(i)h="IgnoreConversations";else h=g?"PermanentDelete":"Delete";var c=new oeReq(d.sEvtNS,h,b,this._createCallback(this.cbDelOeh)),e,k=[];if(Ews.BaseId.IsOwaCnvId(a[0]))c.addRg("Cnvs",a);else if(n)c.addRg("RTOcc",a);else{for(var f=0;f<a.length;f++){e=new oeSt(c,"ItmInf");e.add("ID",a[f]);q[a[f]]&&e.add("MM",1);k.push(e)}c.addRgSt("Itms",k)}c.add("fId",d.get_DataFolderId());g&&this.adJnkSt(c);c.send()};a.sndDel=function Owa$Pages$ListViewSubPage$sndDel(d,a,m,h,j,i,e,g,f){if(e){this.sndDelOeh(d,a,m,h,j,i,e,g);return}if(g)return;var c=this.get_VirtualListView();if(!d&&(Owa.Utility.isIdType(a[0],Owa.Utility.OwaPrefixes.OtherUserMailboxObjectPrefix)||this.isOMF())){if(Owa.PageHierarchy.isWebPart())this.sndDelOeh(d,a,m,h,j,i,e,g);else g_oFldrMgr.cpMvItms(wt(),this.get_SubPage(),c.get_DataFolderId(),a,g_oFldrMgr.getPrimaryDeletedItemsFolderId(),0);return}var b={};b.fRefresh=j;b.fPermanent=d;b.fIgnoreConversations=e;var l=c.get_DataFolderId(),o=c.get_DataFolderId();b.sFolderId=l;b.sDataFolderId=o;var q;b.rgIKs=Owa.Pages.ListViewSubPage.getInstanceKeysAndAddToOperationsManager(a,c);Owa.PendingOperationsManager.increment(l);if(i){var n=this.gtCnvRP();n&&n.rmvIPs(a)}if(a[0]&&Ews.BaseId.IsOwaCnvId(a[0])){var k=Owa.Pages.ListViewSubPage.getConversationActionInfos(a,c);c.rmvRws(f?f:a);EwsService.ApplyConversationAction(this._createCallback(this.cbDel),b,Ews.ConversationActionTypeStrings.Delete,k.oContainerId,k.rgCnvIdAndLastModifiedTime,d?Ews.DeleteTypes.SoftDelete:Ews.DeleteTypes.MoveToDeletedItems,null)}else{var p=EwsService.ConvertToEwsIds(a);c.rmvRws(f?f:a);EwsService.DeleteItems(this._createCallback(this.cbDel),b,p,d?Ews.DeleteTypes.SoftDelete:Ews.DeleteTypes.MoveToDeletedItems,Ews.SendMeetingCancellations.SendOnlyToAll,h?Ews.AffectedTaskOccurrences.SpecifiedOccurrenceOnly:Ews.AffectedTaskOccurrences.AllOccurrences)}addPerfMarker("ListView.sndDel.End")};Owa.Pages.ListViewSubPage.getInstanceKeysAndAddToOperationsManager=function Owa$Page$ListViewSubPage$getInstanceKeysAndAddToOperationsManager(d,c){for(var g=[],a=0;a<d.get_Length();a++){oRowInfo=c.getRowInfoById(d[a]);if(!oRowInfo)continue;var b={},e=c.getAdjacentInstanceKey(d[a],false),f=c.getAdjacentInstanceKey(d[a],true);b.sPreviousIK=e?e:"";b.sNextIK=f?f:"";b.oRowInfo=oRowInfo;Owa.PendingOperationsManager.setContext(c.get_DataFolderId(),oRowInfo.sInstanceKey,b);g.push(oRowInfo.sInstanceKey)}return g};Owa.Pages.ListViewSubPage.getConversationActionInfos=function Owa$Pages$ListViewSubPage$getConversationActionInfos(g,f){for(var c=[],a=null,b=0;b<g.get_Length();b++){var h=g[b],l=f.gtRwById(h),d=f.get_LastModifiedTime(l),e=EwsService.ConvertOwaIdToBaseId(h);if(!a)a=e.get_EwsContainerId();var k=e.get_EwsId(),j=d!=0?Date.fromTicks(d):null,i={Id:k,LastUpdateTime:j};c.push(i)}return{oContainerId:a,rgCnvIdAndLastModifiedTime:c}};a.adJnkSt=function Owa$Pages$ListViewSubPage$adJnkSt(a){a.add("JS",this.gtJnkSt())};a.gtJnkSt=function Owa$Pages$ListViewSubPage$gtJnkSt(){var a=this.get_VirtualListView();return a.fJnk?a.isFltrd()?JES_UNK:JES_JNK:JES_NJNK};a.cbDelOeh=function Owa$Pages$ListViewSubPage$cbDelOeh(a){try{if(!cbOeh(a))return;var d=0;if(this.isPF()||this.isOMF())d=shwRspWrn(a,"errDel");var c=this.get_VirtualListView();if(a.oCtx.fRf||d){if(this.get_SearchControl())this.get_SearchControl().fReExecuteSearch=true;c.rfrsh()}if(a.oCtx.fP&&!this.isPF()&&!this.isOMF())if(c.iT==LVT_MSG){var b=this.get_ParentSubPage();b&&b.invokeSubPageFunction("getMailboxUsage")}}finally{g_fDeleteInProgress=0;addPerfMarker("ListView.CbDel.End");Owa.PendingOperationsManager.decrement(a.oCtx.sFId)}};a.cbDel=function Owa$Pages$ListViewSubPage$cbDel(b){try{var e=b.CheckErrors(),d=this.get_VirtualListView(),a=b.get_Context();if(a.fRefresh||e){if(this.get_SearchControl())this.get_SearchControl().fReExecuteSearch=true;d.rfrsh()}if(a.fPermanent&&!this.isPF()&&!this.isOMF())if(d.iT==LVT_MSG){var c=this.get_ParentSubPage();c&&c.invokeSubPageFunction("getMailboxUsage")}}finally{var a=b.get_Context();Owa.PendingOperationsManager.decrement(a.sFolderId);Owa.PendingOperationsManager.removeInstanceKeys(a.sDataFolderId,a.rgIKs)}};a.tglRP=function Owa$Pages$ListViewSubPage$tglRP(a){var e=this.get_VirtualListView(),c=this._getDescendant("divLVContainer"),i=this._getDescendant("divLVDivider"),h=this._getDescendant("divLVDividerHorizontal"),b=this._getDescendant("divRPContainer");if(a==this.get_ReadingPanePosition())return;a==RP_OFF&&this.cnclMkRd();i.set_IsShown(a==RP_RIGHT);h.set_IsShown(a==RP_BOTTOM);b.set_IsShown(a!=RP_OFF);if(a==RP_OFF){c.set_Width(100,Owa.Style.Unit.Percent);c.set_Height(100,Owa.Style.Unit.Percent)}else if(a==RP_RIGHT){c.set_Height(100,Owa.Style.Unit.Percent);c.set_Width(this.get_ViewWidth(),Owa.Style.Unit.Pixels);b.set_Top(0,Owa.Style.Unit.Pixels);if(Owa.Dom.Document.get_Current().get_IsRtl()){b.set_Right(this.get_ViewWidth()+13,Owa.Style.Unit.Pixels);b.set_Left(0,Owa.Style.Unit.Pixels)}else{b.set_Left(this.get_ViewWidth()+13,Owa.Style.Unit.Pixels);b.set_Right(0,Owa.Style.Unit.Pixels)}}else if(a==RP_BOTTOM){c.set_Width(100,Owa.Style.Unit.Percent);c.set_Height(this.get_ViewHeight(),Owa.Style.Unit.Pixels);b.set_Left(0,Owa.Style.Unit.Pixels);b.set_Right(0,Owa.Style.Unit.Pixels);b.set_Top(this.get_ViewHeight()+4,Owa.Style.Unit.Pixels)}var d=this._getDescendant("divLVContainer");d.removeCssClass("rpOff");d.removeCssClass("rpBtm");if(a==RP_OFF)d.addCssClass("rpOff");else a==RP_BOTTOM&&d.addCssClass("rpBtm");var f=e.iT;if(!this.isPkrVw()){var g=new oeReq(e.sEvtNS,"PersistReadingPane",null,this._createCallback(this.cbTglRP));g.add("s",a);f!=LVT_CTL&&f!=LVT_DRL&&f!=LVT_RML&&g.add("fId",e.sSid);g.send()}this.set_ReadingPanePosition(a);this.isReadingPaneOn()&&this.udRP();if(f==LVT_MSG){this.udMsgTB();this.updateConversationCM()}this.adjustVLVToolbars();this.get_SearchControl()&&this.get_SearchControl().fixSearchControlStyles();this._oFilterInfobar.resize();e.makeFocused()};a.cbTglRP=function Owa$Pages$ListViewSubPage$cbTglRP(a){a.fST&&rplLgn()};a.updateReadingPaneSortOrder=function Owa$Pages$ListViewSubPage$updateReadingPaneSortOrder(a){var c=this.get_VirtualListView(),b=new oeReq(c.sEvtNS,"PersistReadingPaneSortOrder",0,this._createCallback(this.updateReadingPaneSortOrderCallback),POST);b.add("isNewestOnTop",a?1:0);b.send();this.set_NewestOnTop(a);Owa.MessageCache.emptyCache()};a.updateReadingPaneSortOrderCallback=function Owa$Pages$ListViewSubPage$updateReadingPaneSortOrderCallback(d){var a=this.get_VirtualListView();if(!cbOeh(d))return;var b=this.gtCnvRP();if(b){b.rfrsh(0,1);if(a.gtRws(1).length>0){var c=a.sExpId;a.exp(c)}}};a.updateListViewExpansion=function Owa$Pages$ListViewSubPage$updateListViewExpansion(b){var c=this.get_VirtualListView(),a=new oeReq(c.sEvtNS,"PersistShowTreeInListView",0,this._createCallback(this.updateListViewExpansionCallback),POST);a.add("showTreeInListView",b?1:0);a.send()};a.updateListViewExpansionCallback=function Owa$Pages$ListViewSubPage$updateListViewExpansionCallback(c){var a=this.get_VirtualListView();if(!cbOeh(c))return;if(a.gtRws(1).length>0){var b=a.sExpId;a.exp(b)}};a.vwCpMv=function Owa$Pages$ListViewSubPage$vwCpMv(f,i,g,h){var b=this.get_VirtualListView(),a=b.crtDC();if(!a)return;var d=a.get_RootElement();if(!isValidDropFolder(a,g)){alrt(L_MvUnmtchTyp);return}var e=b;if(checkLimit(a,e))return;var c=[];d.foreach_Item(function(a){c.push(a.get_ItemId())});g_oFldrMgr.cpMvItms(wt(),this.get_SubPage(),b.get_DataFolderId(),c,f,h);this.refreshConversationRP()};a.onBRfrshVw=function Owa$Pages$ListViewSubPage$onBRfrshVw(a){!a&&this.cnclMkRd();this.clearDirtyFlagOnView()};a.clearDirtyFlagOnView=function Owa$Pages$ListViewSubPage$clearDirtyFlagOnView(){var b=this.get_VirtualListView(),a=this.get_ParentSubPage();a&&a.invokeSubPageFunction("stDrty",[b.sSid,1])};a.renameFolderName=function Owa$Pages$ListViewSubPage$renameFolderName(a){this.setSubPageVariable("a_sFldNm",a);this.get_IsShown()&&this.get_ParentSubPage().get_Breadcrumbs().set_FolderName(a)};a.onERfrshVw=function Owa$Pages$ListViewSubPage$onERfrshVw(d){var a=this.get_VirtualListView();this.updateFolderItemCounts(d);a.isDumpsterVw()&&a.updCnts();var b=this.get_ParentSubPage();if(b){this.fireUpdCnt();var c=b.getNewMessageId();c&&a.selRwById(c)}a.iT==LVT_MSG&&this.gtFldSz()};a.updateFolderItemCounts=function Owa$Pages$ListViewSubPage$updateFolderItemCounts(g,b){var a=this.get_VirtualListView(),f=this.get_ParentSubPage(),c=f?f.get_Breadcrumbs():null;if(c)if(a.isFltrd())g&&c.set_Metadata(g.get_TextContent());else{var d,e;if(!b){d=a.gtTIC();if(a.iT==LVT_MSG)e=a.gtUC()}else{d=b.iTotalCount;e=b.iUnreadCount}c.set_Count(d);c.set_Metadata(this.getSubPageVariable("a_sFldDtaStr"))}if(a.iT==LVT_MSG&&!a.isFltrd()&&b){this._oFolderCountTimer&&clearTimeout(this._oFolderCountTimer);this._oFolderCountTimer=this._setTimeout(this.synchronizeFolderCounts,FOLDER_COUNT_SYNC_DURATION,b)}};a.synchronizeFolderCounts=function Owa$Pages$ListViewSubPage$synchronizeFolderCounts(b){var a=this.get_VirtualListView();a&&(a.gtTIC()!=b.iTotalCount||a.gtUC()!=b.iUnreadCount)&&a.rfrsh(1);this._oFolderCountTimer=null};a.refreshConversationRP=function Owa$Pages$ListViewSubPage$refreshConversationRP(e,d){var b=this.get_VirtualListView(),c=this.gtCnvRP();if(c){var a=new Array(c.get_Id());c.rfrsh(d,e,b.gtCnvGC(a),b.gtCnvTC(a),b.gtCnvUC(a))}};a.onRmvItmsVw=function Owa$Pages$ListViewSubPage$onRmvItmsVw(){if(this.get_SearchControl())this.get_SearchControl().fReExecuteSearch=true};a.updMlddm=function Owa$Pages$ListViewSubPage$updMlddm(){var b=this.get_VirtualListView();if(b.isCnvVw&&b.isCnvVw()){var a=this._getDescendant("divLVddm");a&&a.set_IsShown(false)}else{var a=this._getDescendant("divLVddm");a&&a.set_IsShown(true);var c=b.isML()?"ml":"sl";updRd(this._getDescendant("divLVddm"),c)}};a.gtFldSz=function Owa$Pages$ListViewSubPage$gtFldSz(){var b=this.get_VirtualListView();if(this._fFolderSizeFlag==0&&this.get_ELCFolderWithQuota()&&this.get_ELCFolderQuota()>0&&!this.isPF()&&!this.isOMF()){this._fFolderSizeFlag=1;var a=new oeReq(b.sEvtNS,"GetELCFolderSize",0,this._createCallback(this.cbGtFldSz));a.add("fId",this.get_ELCFolderId()!=""?this.get_ELCFolderId():this.get_FolderId());a.send()}};a.cbGtFldSz=function Owa$Pages$ListViewSubPage$cbGtFldSz(d){if(d.sErr){d.fST&&popLgn();shwErrDlg(d)}else{var f=Owa.DomUtility.getTextFromHtml(d.sBody,"fldSz");if(f){var i=parseInt(f),a=0;a=Math.round(i/this.get_ELCFolderQuota()*100);var b=this._getDescendant("divElcQuota");if(!b)return;var h=b.getDescendantById("spnFldPrcntUsd");h.set_TextContent(""+a);var g=b.getDescendantById("divFldUsg"),e=b.getDescendantById("divFldExcd");if(a>=100){g.set_IsShown(0);e.set_IsShown(1)}else{g.set_IsShown(1);e.set_IsShown(0)}var j=b.getDescendantById("elcQuotaBar"),c;if(a>=100)c=QT_EXCD;else if(a>=75)c=QT_AW;else c=QT_NRM;updQB(j,a,c)}}this._fFolderSizeFlag=0};a._onClickHideELCComment=function Owa$Pages$ListViewSubPage$_onClickHideELCComment(){this.shwELCCmnt(false)};a.shwELCCmnt=function Owa$Pages$ListViewSubPage$shwELCCmnt(b){var d=this.get_VirtualListView(),a=this._oInfobar.getMessageById("divElcIB");if(a!=null){if(b){a.set_IsShown(1);this._oInfobar.set_IsShown(1)}else this._oInfobar.hideMessage(a);a.setBoolAttribute("isVisible",b);!b&&this.get_ParentSubPage().get_Breadcrumbs().showElcLink();this.adjustLvRpContainerTop();var c=new oeReq(d.sEvtNS,"PersistELCCommentState");c.add("fId",d.sSid);c.add("fShwELC",b?1:0);c.send()}};a.openItms=function Owa$Pages$ListViewSubPage$openItms(e,j,k,m){var b=this.get_VirtualListView(),a=b.gtSel(),d=b.gtRwPrp(a[0],"sMT");if(a.length==1&&Ews.BaseId.IsOwaCnvId(a[0])&&d){var l=b.gtRwById(a[0]),h=b.getData(l),f="Open",i=getApplicationElementForItem("Item",f,d,false,false),e="?ae="+i+"&a="+f+"&t="+urlEnc(d)+"&id="+urlEnc(h.getAttribute("sMID")),g=h.getAttribute("sMS");if(g)e+="&s="+urlEnc(g);openItm(e,null,null,null,null,this.get_SubPage());return}for(var c=a.length-1;c>=0;--c)Ews.BaseId.IsOwaCnvId(a[c])&&a.removeAt(c);a.length>0&&this.openItmIds(a,e,j,k,m)};a.openItmIds=function Owa$Pages$ListViewSubPage$openItmIds(k,a,j,n,l){var f=this.get_VirtualListView();this.cnclMkRd();for(var g=0;g<k.length;++g){var b=k[g],h=this.isPhsh(b),c=l?l:this.gtItmType(b),m=this.get_SubPage();if(f.iT==LVT_MSG&&(isJnkFld(m)||h))if(!(isOfClss(c,IT_PST)&&a&&a.lc().indexOf("&a=postreply")!=-1))c="";var e=0,d=0,i=0;if(!(a&&a.lc().indexOf("&a=forward")>=0)&&(isOfClss(c,IT_CNT)||isOfClss(c,"AD.RecipientType"))){e=RF_W;d=RF_H}else if(isOfClss(c,IT_SMS))if(f.gtRwPrp(b,"s")=="Draft"||a&&a.lc().indexOf("&a=reply")>=0||a&&a.lc().indexOf("&a=replyall")>=0||a&&a.lc().indexOf("&a=forward")>=0){e=SMS_W;d=SMS_H}if(isOfClss(c,IT_CNT)||isOfClss(c,IT_PDL)||this.isCntVw())i=1;if(a){if(a.lc().indexOf("&a=reply")>=0&&h)continue;openItm(a+"&t="+urlEnc(c)+"&id="+urlEnc(b)+(i?"&s=Draft":""),0,0,e,d,this.get_SubPage())}else if(j!=null)openItm(this.getIUrl(b,"Open"),j,n,e,d,this.get_SubPage());else openItm(this.getIUrl(b,"Open"),0,0,e,d,this.get_SubPage());this.isUnrd(b)&&f.mkRd(b)}};a.getLastUnselectedItemIdForMarkRead=function Owa$Pages$ListViewSubPage$getLastUnselectedItemIdForMarkRead(){var b=null,a=this.oLastUnSelectionState;this.set_ItemIdInReadingPane(this._iTempReadingPaneItemId);this.set_ItemIdInConversation(this._iTempConversationItemPartId);this.oLastUnSelectionState=null;if(this.isReadingPaneOn()&&a!=null&&a.iCnvItmSts==MSG_MARKED_UNREAD){var c=this.get_VirtualListView();c.stRwPrp(a.sMessageId,"read",MSG_UNREAD);c.stRwPrp(a.sRPItemId,"read",MSG_MARKED_UNREAD);return b}var d=this.get_MarkAsReadBehaviour();if(this.isReadingPaneOn()&&a!=null&&(d==MR_SELCHANGE||d==MR_DELAYED&&a.fTimerExpired))if(a.sRPItemId!=null&&a.sRPItemId!=this._iTempConversationItemPartId){if(a.fRPItemUnRead){b={};b.sRPItemId=a.sRPItemId;b.sMessageId=a.sMessageId;b.sRPItemFId=a.sRPItemFId}}else if(a.sMessageId!=null&&a.sMessageId!=this._iTempReadingPaneItemId&&a.fMessageUnRead){b={};b.sMessageId=a.sMessageId}return b};a.onSelChngVw=function Owa$Pages$ListViewSubPage$onSelChngVw(a){hdPrgrsInd();var b=this.get_VirtualListView();if(!a.sMid&&b.gtSelCnt()>=1){if(b.isCnvVw&&b.isCnvVw())this.refreshConversationRP();else this.udRP(1);return}if(this.isPkrVw()){var d=this.get_ParentSubPage();d&&d.invokeSubPageFunction("updPkrBtns")}this.isCntVw(b.iT)&&this.udCntFnc();b.isTskVw()&&this.udTskTB();if(!a.fSel&&a.sMid==this.get_ItemIdInReadingPane()&&a.sIid==this.get_ItemIdInConversation()||b.gtSelCnt()<1){this.oLastUnSelectionState={};this.oLastUnSelectionState.fRPItemUnRead=this.isUnrd(this.get_ItemIdInConversation(),1);this.oLastUnSelectionState.fMessageUnRead=this.isUnrd(this.get_ItemIdInReadingPane(),1);this.oLastUnSelectionState.sMessageId=this.get_ItemIdInReadingPane();this.oLastUnSelectionState.sRPItemId=this.get_ItemIdInConversation();this.oLastUnSelectionState.sRPItemFId=b.gtRwPrp(this.get_ItemIdInConversation(),"fId");this.oLastUnSelectionState.fExp=a.fExp;this.oLastUnSelectionState.fTimerExpired=this.setItmRead_toID==null;this.oLastUnSelectionState.iCnvItmSts=b.gtRwPrp(this.get_ItemIdInReadingPane(),"read")}if(b.gtSelCnt()<1){this._setTimeout(this._onSelChngVwClrCallback,10);return}var c=a.sMid,h=a.sIid,e=a.fSel;if(a.fExp){if(!a.fDontUdRP){if(a.fSel&&b.gtSelCnt()==1){this._iTempConversationItemPartId=a.sIid;this.cnclMkRd();if(this.isReadingPaneOn()&&this.isUnrd(a.sIid,true)&&this.get_MarkAsReadBehaviour()==MR_DELAYED)this.setItmRead_toID=this._setTimeout(this.setItmRead,a_iMRDelay*1e3,true)}this.setLastSelectionRead();this.udCnvRP();addPerfMarker("ConversationRow.Updated")}else{this.udMsgTB();this.updateConversationCM()}this.isReadingPaneOn()&&this.shRP(1);return}if(!e)if(this.get_ItemIdInReadingPane()==c){var i=b.gtSel();c=i[0]}else{this.oLastUnSelectionState=null;return}else if(e&&b.gtSelCnt(1)>1&&!a.fForceRpUd)return;this.isReadingPaneOn()&&this.shRP(1);this._iTempReadingPaneItemId=c;this._iTempConversationItemPartId=h;if(this.isReadingPaneOn()&&!a.fDontUdRP){this.cnclURP();var g=new Date,f=g-this._dtLastUpdateRP;this._dtLastUpdateRP=g;if(f<g_iUdRpDl)this.udRP_toID=this._setTimeout(this.udRP,g_iUdRpDl-f);else this.udRP(a.fForceRpUd)}};a._onSelChngVwClrCallback=function Owa$Pages$ListViewSubPage$_onSelChngVwClrCallback(){var a=this.get_VirtualListView();if(a.gtSelCnt()<1){this.cnclMkRd();this.isReadingPaneOn()&&this.shRP(0);this.setLastSelectionRead()}};a.udMsgTB=function Owa$Pages$ListViewSubPage$udMsgTB(c){if(isSWP())return;var a=this.get_SubPage().get_ActionTable();a.getAction(BID_DL).enable();a.getAction(BID_MV).enable();var b=this.get_VirtualListView().gtSel().length==0;Owa.Components.ToolbarCollection.get(this).getButton("actions").set_IsDisabled(b);this.udMsgRplFwdTB(c)};a.setReplyByChatAvailability=function Owa$Pages$ListViewSubPage$setReplyByChatAvailability(g){var a=g.get_SubPage(),h=a.gtSelItms()[0],b=g_fIsIMEnab&&gtMstr()&&gtMstr().g_fSignedIn&&!isJnkFld(a)&&!a.isPhsh(h),c=Owa.Components.ToolbarCollection.get(a).getButton(BID_REC);if(!c)return;if(b&&isMSNPrv())try{var e=c.get_SubPage()._getDescendant("ifRP"),d=Owa.Components.SubPageControllerFactory.getControllerByElement(e).get_SubPage(),f=d._getDescendant("spnFrom").getAttribute("_uri");b=isBuddy(f)}catch(i){b=0}c.set_IsDisabled(!b)};a.updateConversationCM=function Owa$Pages$ListViewSubPage$updateConversationCM(){var a=this.get_VirtualListView();if(a){var b=a.get_ContextMenu();b&&this.cmPreShwMsg(b)}};a.udMsgRplFwdTB=function Owa$Pages$ListViewSubPage$udMsgRplFwdTB(c){var l=this.get_VirtualListView(),b=this.get_SubPage(),e=this.gtSelItms(),h=e.length;if(this.isCnvSelected()||h==0){if(!isJnkFld(b)){this.enblRpl(1,c);this.enblRplAll(1,c);this.enblFwd(1,c)}this.get_SubPage().get_ActionTable().getAction("ntjnk").disable();return}var n=h==1,g=0,j=0,i=0;if(n){g=this.isPhsh(e[0]);j=this.isRightRestricted(l,"fReplyRestricted","fRplR");i=this.isRightRestricted(l,"fReplyAllRestricted","fRAR")}var d=this.getRP();if(d&&d.get_ActionButtons){var f=d.get_ActionButtons();if(f)for(a=0;a<f.length;a++)f[a]&&f[a].setMultipleSelection&&f[a].setMultipleSelection(h>1)}if(!isJnkFld(b)&&h>0){var k=g||h>1;if(!k)k=this.isJunkItemSelected()||!canItmRpl(this.gtItmType(e[0]));j=j||k;i=i||k;this.enblRpl(j,c);this.enblRplAll(i,c);var p=Owa.Components.ToolbarCollection.get(b);(oButton=p.getButton(BID_RECMB))&&oButton._oComboDropDownTwisty&&p.getButton(BID_REC)&&oButton._oComboDropDownTwisty.get_OnBeforePopup().add(this.setReplyByChatAvailability)}!isJnkFld(b)&&this.shPRoRA();var d=this.gtCnvRP();if(isJnkEnbl()&&isJnkFld(b)){if(!n)this.get_SubPage().get_ActionTable().getAction("ntjnk").disable();else if(g)this.get_SubPage().get_ActionTable().getAction("ntjnk").disable();else if(d!=null)if(d.isJunkItem(e[0]))this.get_SubPage().get_ActionTable().getAction("ntjnk").enable();else this.get_SubPage().get_ActionTable().getAction("ntjnk").disable();else this.get_SubPage().get_ActionTable().getAction("ntjnk").enable();if(n&&g){this.get_SubPage().get_ActionTable().getAction(BID_RE).disable();this.get_SubPage().get_ActionTable().getAction(BID_RA).disable()}}if(!isJnkFld(b)){for(var m=0,a=0;a<e.length&&!m;a++){var o=this.getItemType(e[a],l,d);m|=isApprovalRequest(o)||isFtEnab(FT_CAL)&&this.isSharingMessage(o)}this.enblFwd(m||this.isRightRestricted(l,"fForwardRestricted","fFR")||g,c)}};a.isJunkItemSelected=function Owa$Pages$ListViewSubPage$isJunkItemSelected(){var d=this.get_VirtualListView(),c=this.gtSelItms()[0],a;if(this.isReadingPaneOn()){var b=this.gtCnvRP();if(b!=null)if(b.isJunkItem(c))a=true}else a=d.gtRwPrp(c,"fJnk")=="1";return a};a.isCnvRowSelected=function Owa$Pages$ListViewSubPage$isCnvRowSelected(){var a=this.get_VirtualListView();return a.isCnvVw&&a.isCnvVw()&&!a.isSelExp()};a.udTskTB=function Owa$Pages$ListViewSubPage$udTskTB(){var a=this.get_VirtualListView(),b=a.gtSel(),d=b.length==1,i=0,g=0,e=0;if(d){e=!canItmRpl(a.gtRwPrp(b[0],"t"));i=this.isRightRestricted(a,"fReplyRestricted","fRplR");g=this.isRightRestricted(a,"fReplyAllRestricted","fRAR")}this.enblRpl(!d||e||i);this.enblRplAll(!d||e||g);for(var c=1,f=0;f<b.length;f++)c&=canItmRpl(a.gtRwPrp(b[f],"t"));Owa.Components.ToolbarCollection.get(this).set_IsButtonShown(BID_FWCMB,c);Owa.Components.ToolbarCollection.get(this).set_IsButtonShown(BID_FWA,!c);var h=this.isRightRestricted(a,"fForwardRestricted","fFR");Owa.Components.ToolbarCollection.get(this).set_IsButtonDisabled(BID_FWCMB,h);Owa.Components.ToolbarCollection.get(this).set_IsButtonDisabled(BID_FWA,h)};a.get_IsFlaggedMailAndTasks=function Owa$Pages$ListViewSubPage$get_IsFlaggedMailAndTasks(){return this.getSubPageVariable("a_fFMT")};a.isRightRestricted=function Owa$Pages$ListViewSubPage$isRightRestricted(b,f,g){try{if(b.isCnvVw&&b.isCnvVw()){var d=this.gtCnvRP();if(d){for(var c=d.gtSel(),a=0;a<c.length;a++){var e=d.oItemParts[c[a]];if(e&&e[f])return 1}return 0}}for(var c=b.gtSel(),a=0;a<c.length;a++)if(getInt(b.gtRwPrp(c[a],g,0))==1)return 1}catch(h){}return 0};a.isPhsh=function Owa$Pages$ListViewSubPage$isPhsh(d){var c=this.get_VirtualListView(),b=0;if(this.isCnvRowSelected()){var a=this.gtCnvRP();if(a&&a.oSel&&a.gtSel()&&a.oSel[a.gtSel()])b=getInt(c.gtRwPrp(d,"fPhsh",0))||a.oSel[a.gtSel()].fPhishing}else b=getInt(c.gtRwPrp(d,"fPhsh",0));var e=getInt(c.gtRwPrp(d,"fPhshIgn",0));return b&&!e};a.isIgnPhsh=function Owa$Pages$ListViewSubPage$isIgnPhsh(d){var c=this.get_VirtualListView(),b=0;if(this.isCnvRowSelected()){var a=this.gtCnvRP();if(a&&a.oSel&&a.gtSel()&&a.oSel[a.gtSel()])b=getInt(c.gtRwPrp(d,"fPhsh",0))||a.oSel[a.gtSel()].fPhishing}else b=getInt(c.gtRwPrp(d,"fPhsh",0));var e=getInt(c.gtRwPrp(d,"fPhshIgn",0));return b&&e};a.isItmOfType=function Owa$Pages$ListViewSubPage$isItmOfType(g,c){var f=this.get_VirtualListView(),a=0;if(this.isCnvRowSelected()){var b=this.gtCnvRP();a=f.gtRwPrp(g,"sMT")==c;if(!a&&b&&b.gtSel())for(var h=b.gtSel(),d=0;d<h.length;d++){var e=b.oItemParts[h[d]];a=e&&e.get_ItemType()==c;if(!a)break}}else a=isOfClss(f.gtRwPrp(g,"t"),c);return a};a.stPhshIgn=function Owa$Pages$ListViewSubPage$stPhshIgn(b){var a=this.get_VirtualListView();if(a.iT!=LVT_MSG)return;a.stRwPrp(b,"fPhshIgn","1");this.udMsgTB();this.updateConversationCM()};a.rfVwPhsh=function Owa$Pages$ListViewSubPage$rfVwPhsh(a){var b=this.get_VirtualListView(),d=a.sId,c=a.fUdRP;if(b){if(this.isPF())this.stPhshIgn(d);else b.rfrsh(0);c&&this.udRP(1)}};a.rfVwRemoveIrm=function Owa$Pages$ListViewSubPage$rfVwRemoveIrm(b){var a=this.get_VirtualListView(),c=b.fUdRP;a&&a.rfrsh(0);c&&this.udRP(1)};a.rfVwRemoveWB=function Owa$Pages$ListViewSubPage$rfVwRemoveWB(a){this.rfVwRemoveIrm(a)};a.shRP=function Owa$Pages$ListViewSubPage$shRP(a){showReadingPane("ifRP",a,this.get_SubPage())};a.udRP=function Owa$Pages$ListViewSubPage$udRP(o){var b=this.get_VirtualListView();if(null==this._iTempReadingPaneItemId||!this.isReadingPaneOn())return;var h=o||this._iTempReadingPaneItemId!=this.get_ItemIdInReadingPane(),g=null,s=this.setItmRead_toID==null,a=null;if(h){a=this.getLastUnselectedItemIdForMarkRead();if(a)g=a.sRPItemId?a.sRPItemId:a.sMessageId}this.cnclURP();this.cnclMkRd();if(this.isUnrd(this._iTempReadingPaneItemId,false)&&this.get_MarkAsReadBehaviour()==MR_DELAYED)this.setItmRead_toID=this._setTimeout(this.setItmRead,a_iMRDelay*1e3);var j=false;if(h){var q=g?"&mrd="+urlEnc(g)+"&js="+this.gtJnkSt():null,e=this.get_ItemIdInReadingPane(),c=this.getIUrl(e,"Preview",q);if(!c)return;var b=this.get_VirtualListView(),i=b.gtRwPrp(e,"t");if(isSMime(i))c+=gtMmPar();var r=this._getDescendant("ifRP"),d=Owa.Components.SubPageControllerFactory.getControllerByElement(r);if(!d)return;var l=null;try{l=d.get_LocationURL()}catch(t){}if(o||c!=l){var n=d._get_Element().get_ParentElement();if(b&&b.isFltrd()&&b.isCnvVw&&b.isCnvVw()){var f=this.get_SearchControl();if(f&&f.sSearchText!=null&&f.sSearchText.trim().length)c=c+"&sw="+urlEnc(f.sSearchText)}d.remove();if(b.shouldUseCachedMessage(i,c)){d=Owa.Components.SubPageControllerFactory.createControllerByUrl(n,c,"ifRP",false,true);this.get_SubPageController().addChildController(d);var k=b.get_LastModifiedTime(b.gtRwById(e)),m=Owa.MessageCache.getMessageAndUpdateCounter(e,k);if(m){addPerfMarker("MessageCache.Hitted");d.navigateWithContents({sHtml:m,fIsNotFromCache:false,sUrl:c},true);j=true}else{addPerfMarker("MessageCache.NoCache");b.sendPrefetchRequest(new PrefetchContext(e,i,true,k,null,c))}}else{addPerfMarker("MessageCache.NoCache");d=Owa.Components.SubPageControllerFactory.createControllerByUrl(n,c,"ifRP",false);this.get_SubPageController().addChildController(d)}}this._clearRefreshConversationRPDelayTimerAndFlags&&this._clearRefreshConversationRPDelayTimerAndFlags();b.gtRwPrp(this.get_ItemIdInReadingPane(),"read")==MSG_MARKED_UNREAD&&b.mkUnrd(this.get_ItemIdInReadingPane(),MSG_UNREAD)}if(h&&this.get_MarkAsReadBehaviour()==MR_SELCHANGE)if(a)if(j)this.setRdSt(new Array(a.sRPItemId?a.sRPItemId:a.sMessageId),MSG_READ);else if(a.sRPItemId)b.mkRdIP(a.sRPItemId,a.sRPItemFId,a.sMessageId);else{var p=this.isPF();b.mkRd(a.sMessageId,p)}updCmp(window)};a.cbFetchRP=function Owa$Pages$ListViewSubPage$cbFetchRP(c){var b=this._getDescendant("ifRP"),a=Owa.Components.SubPageControllerFactory.getControllerByElement(b);a.navigateWithContents(c,true)};a.cnclURP=function Owa$Pages$ListViewSubPage$cnclURP(){this.udRP_toID&&this._clearTimeout(this.udRP_toID);this.udRP_toID=null};a.getRPmid=function Owa$Pages$ListViewSubPage$getRPmid(){return this.get_ItemIdInReadingPane()};a.getIUrl=function Owa$Pages$ListViewSubPage$getIUrl(c,e,j){var d=this.get_VirtualListView(),g="Item",a=d.gtRwPrp(c,"t");if(!a)return;var h=this.isPhsh(c),k=this.get_SubPage(),i=d.iT==LVT_MSG&&isJnkFld(k);if(e&&e=="Open"&&!h)if(!i&&isCal(a)||(this.isPF()||this.isOMF())&&(isOfClss(a,IT_CNT)||isOfClss(a,IT_PDL))||(this.isPF()||this.isOMF())&&isOfClss(a,IT_TSK)&&!d.gtRwPrp(c,"fAT"))g="PreFormAction";g=getApplicationElementForItem(g,e,a,i,h);var b="?ae="+g;if(Owa.Utility.isSafari())b=getOwaVdir()+b;if(e)b+="&a="+e;if(!(i||h)||a=="IPM.Conversation"){b+="&t="+urlEnc(a);var f=0;if(isOfClss(a,IT_CNT)||isOfClss(a,IT_PDL))f="Draft";else if(isOfClss(a,IT_TSK)&&d.gtRwPrp(c,"fAT"))f="Assigned";else if(!this.isPF())f=d.gtRwPrp(c,"s");if(f)b+="&s="+f}b+="&id="+urlEnc(c);if(this.isIgnPhsh(c))b+="&ph=0";if(j)b+=j;return b};a.getItemType=function Owa$Pages$ListViewSubPage$getItemType(d,e,b){var a=e.gtRwPrp(d,"t");if(!a&&b){var c=b.oItemParts[d];if(c!=null)a=c.get_ItemType()}return a};a.isSharingMessage=function Owa$Pages$ListViewSubPage$isSharingMessage(a){return a==IT_SHR};a.isSharingItemSelected=function Owa$Pages$ListViewSubPage$isSharingItemSelected(a){var d=a.gtSel(),c=0;if(a.isCnvVw&&a.isCnvVw()&&!a.isSelExp())for(var b=0;b<d.length&&!c;b++){var f=a.gtRwById(d[b]),e=a.getData(f);if(e)c|=this.isSharingMessage(e.getAttribute("sMT"))}else for(var b=0;b<d.length&&!c;b++)c|=this.isSharingMessage(a.gtRwPrp(d[b],"t"));return c};a.enblRpl=function Owa$Pages$ListViewSubPage$enblRpl(a,d){a=a?1:0;if(this.enblRpl_dsbld==a&&!d)return;var b=this.get_SubPage().get_ActionTable();if(a){var c=this.get_SubPage();if(!isJnkFld(c)){b.getAction(BID_RE).disable();b.getAction(BID_RECMB).disable()}}else{var c=this.get_SubPage();if(!isJnkFld(c)){b.getAction(BID_RE).enable();b.getAction(BID_RECMB).enable()}}this.enblRpl_dsbld=a};a.enblRplAll=function Owa$Pages$ListViewSubPage$enblRplAll(a,d){a=a?1:0;if(this.enblRplAll_dsbld==a&&!d)return;var c=this.get_SubPage(),b=this.get_SubPage().get_ActionTable();if(a)!isJnkFld(c)&&b.getAction(BID_RA).disable();else!isJnkFld(c)&&b.getAction(BID_RA).enable();this.enblRplAll_dsbld=a};a.enblFwd=function Owa$Pages$ListViewSubPage$enblFwd(a,c){a=a?1:0;if(this.enblFwd_dsbld==a&&!c)return;var b=this.get_SubPage().get_ActionTable();b.getAction(BID_FWCMB).set_Enabled(!a);b.getAction(BID_FW).set_Enabled(!a);this.enblFwd_dsbld=a};a.initCnvRP=function Owa$Pages$ListViewSubPage$initCnvRP(){var c=this.get_VirtualListView(),a=this.gtCnvRP();if(!a)return;a.onContextAction=this.get_ActionHandler();a.onPreContextMenuShow=this._createCallback(this.cmPreShw);a.set_ContextMenuEnabled(true);a.get_OnSelectionChanged().add(this._createCallback(this.udCnvLV));var b=this;a.get_OnMarkAsRead().add(function OnMarkAsReadCallBack(a){b.onMkRdItmPrt(a.sId,a.sFId,a.sCnvId)});a.get_OnConversationOutOfScope().add(function OnConversationOutOfScope(a){(a==c.get_SelectionAnchorId()||a==c.sExpId)&&c.removeSelectionAnchoredRow()});a.get_OnConversationRefreshed().add(function OnConversationRefreshed(){b.updateConversationSortButton();b.udMsgTB(true);b.updateConversationCM()});this.udCnvRP();this.udCnvLV()};a.gtCnvRP=function Owa$Pages$ListViewSubPage$gtCnvRP(){return this.getRP(true)};a.getRP=function Owa$Pages$ListViewSubPage$getRP(d){var a=null;if(this.isReadingPaneOn()){var c=this._getDescendant("ifRP");if(c){var b=Owa.Components.SubPageControllerFactory.getControllerByElement(c);if(b){a=b.getExpando("oRdCnv");if(!a&&!d)a=b.get_SubPage()}}}return a};a.isReadingPaneOn=function Owa$Pages$ListViewSubPage$isReadingPaneOn(){return this.get_ReadingPanePosition()!=RP_OFF&&this.get_ReadingPanePosition()!=RP_NONE};a.udCnvRP=function Owa$Pages$ListViewSubPage$udCnvRP(){var a=this.get_VirtualListView(),c=this.gtCnvRP();if(a&&c&&a.isCnvVw&&a.isCnvVw()){var b=a.gtSel(),d=Ews.BaseId.IsOwaCnvId(b[0]);if(!d){c.setSel(b);this.udMsgTB();this.updateConversationCM()}}};a.onMkRdItmPrt=function Owa$Pages$ListViewSubPage$onMkRdItmPrt(d,c,a){var b=this.get_VirtualListView();b.mkRdIP(d,c,a)};a.udCnvLV=function Owa$Pages$ListViewSubPage$udCnvLV(){var a=this.get_VirtualListView();if(!(a&&a.isCnvVw&&a.isCnvVw()))return;var c,b=this.gtCnvRP();if(b)c=b.gtSel();a.setSel(c);this.udMsgTB();this.updateConversationCM();if(this.isReadingPaneOn()&&this.isUnrd(this.get_ItemIdInReadingPane(),true)&&this.get_MarkAsReadBehaviour()==MR_DELAYED)if(!this.setItmRead_toID)this.setItmRead_toID=this._setTimeout(this.setItmRead,a_iMRDelay*1e3)};a.updateConversationSortButton=function Owa$Pages$ListViewSubPage$updateConversationSortButton(){var b=this.gtCnvRP(),a=b.get_IsNewestOnTop();if(a!=this.get_NewestOnTop()){this.set_NewestOnTop(a);Owa.Components.ToolbarCollection.get(this).getButton("newestOnTop").set_IsShown(a);Owa.Components.ToolbarCollection.get(this).getButton("oldestOnTop").set_IsShown(!a)}};a.gtSelItms=function Owa$Pages$ListViewSubPage$gtSelItms(){var a=this.get_VirtualListView();if(a.isCnvVw&&a.isCnvVw()){var e=this.gtCnvRP(),c=[];if(e)c=e.gtSel();else if(a.isSelExp())for(var d=a.gtSel(),b=0;b<d.length;++b)!Ews.BaseId.IsOwaCnvId(d[b])&&c.push(d[b]);return c}else return a.gtSel()};a.isCnvSelected=function Owa$Pages$ListViewSubPage$isCnvSelected(){var a=this.get_VirtualListView();if(a.isCnvVw&&a.isCnvVw()){var b=a.gtSel();if(b.length==1)return this.gtSelItms().length==0;else if(a.isSelExp()){for(var c=0;c<b.length;++c)if(Ews.BaseId.IsOwaCnvId(b[c]))return 1;return 0}else return b.length!=0}else return 0};a.gtItmType=function Owa$Pages$ListViewSubPage$gtItmType(b){var c=this.get_VirtualListView(),a=this.gtCnvRP();return a&&a.oItemParts[b]?a.oItemParts[b].get_ItemType():c.gtRwPrp(b,"t")};a.isUnrd=function Owa$Pages$ListViewSubPage$isUnrd(c,d){var b=this.get_VirtualListView(),a=b.gtRwPrp(c,"read");return a==MSG_UNREAD||!d&&a==MSG_MARKED_UNREAD};a.setLastSelectionRead=function Owa$Pages$ListViewSubPage$setLastSelectionRead(){var a=this.getLastUnselectedItemIdForMarkRead();if(a)if(a.sRPItemId)this.setRdSt(new Array(a.sRPItemId),MSG_READ);else a.sMessageId&&this.setRdSt(new Array(a.sMessageId),MSG_READ)};a.setItmRead=function Owa$Pages$ListViewSubPage$setItmRead(a){this.cnclMkRd();if(a)this.setRdSt(new Array(this.get_ItemIdInConversation()),MSG_READ);else this.setRdSt(new Array(this.get_ItemIdInReadingPane()),MSG_READ)};a.cnclMkRd=function Owa$Pages$ListViewSubPage$cnclMkRd(){this.setItmRead_toID&&this._clearTimeout(this.setItmRead_toID);this.setItmRead_toID=null};a.setRdSt=function Owa$Pages$ListViewSubPage$setRdSt(a,c,i){addPerfMarker("ListView.SetRdSt.Start");var b=this.get_VirtualListView(),m=Ews.BaseId.IsOwaCnvId(a[0]),f=this.gtCnvRP(),k;k=a.length;if(k>MAX_REQ_ITMS){alrt(L_ErrMaxItms);return}var e={},h=b.get_ContextFolderId(),n=c?"MarkAsRead":"MarkAsUnread";e.sFolderId=h;Owa.PendingOperationsManager.increment(h);if(b.get_SubPage().get_IsShown()){for(var j=c?MSG_READ:MSG_MARKED_UNREAD,d=0;d<a.length;++d){var l=this.isPF();b.mkUnrd(a[d],j,l)}i&&!b.isSelExp()&&b.mkUnrd(i,j);if(f)if(m)for(var d=0;d<a.length;++d)this.get_ItemIdInReadingPane()==a[d]&&this.get_FolderId()&&f.stRSAll(c,a_sSntId);else f.stRS(a,c)}if(a[0]&&Ews.BaseId.IsOwaCnvId(a[0])){var g=Owa.Pages.ListViewSubPage.getConversationActionInfos(a,b);EwsService.ApplyConversationAction(cbSetRdSt,e,Ews.ConversationActionTypeStrings.SetReadState,g.oContainerId,g.rgCnvIdAndLastModifiedTime,null,c)}else EwsService.MarkAsRead(cbSetRdSt,e,c,EwsService.ConvertToEwsIds(a));addPerfMarker("ListView.SetRdSt.End")};function cbSetRdSt(a){Owa.PendingOperationsManager.decrement(a.get_Context().sFolderId)}a.get_MarkAsReadBehaviour=function Owa$Pages$ListViewSubPage$get_MarkAsReadBehaviour(){if(!Owa.Utility.isDefined(typeof a_iMR))return MR_NEVER;var a=this.get_VirtualListView();return a.isFilteredByUnread&&a.isFilteredByUnread()?MR_NEVER:a_iMR};a.setVH=function Owa$Pages$ListViewSubPage$setVH(a,d,c){var b=Math.max(0,this._get_Element().get_OffsetHeight()-this._get_ReadingPaneMinHeight());if(a>b){a=b;c&&this.udRP(1)}if(a<this.get_VlvMinHeight())a=this.get_VlvMinHeight();if(d&&this.get_ViewHeight()!=a){this.set_ViewHeight(a);this.svRpWH("PersistHeight","h",this.get_ViewHeight());this._getDescendant("divLVContainer").set_Height(a);this._getDescendant("divLVDividerHorizontal").set_Top(a);this._getDescendant("divRPContainer").set_Top(a+4)}};a.setVW=function Owa$Pages$ListViewSubPage$setVW(a,h,g){var f=Math.max(0,this._get_Element().get_OffsetWidth()-this._get_ReadingPaneMinWidth());if(a>f){a=f;g&&this.udRP(1)}if(a<this.get_VlvMinWidth())a=this.get_VlvMinWidth();if(h&&this.get_ViewWidth()!=a){this.set_ViewWidth(a);this.svRpWH("PersistWidth","w",this.get_ViewWidth());this._getDescendant("divLVContainer").set_Width(a);var c=this._getDescendant("divRPContainer");if(g_fRtl){this._getDescendant("divLVDivider").set_Right(a+1);c.set_Right(a+13)}else{this._getDescendant("divLVDivider").set_Left(a+1);c.set_Left(a+13)}c.set_Width(null);var e=this._getDescendant("ifRP");if(e){var b=Owa.Components.SubPageControllerFactory.getControllerByElement(e),d=b&&b.get_SubPage();d&&Owa.UIControls.DivSubPageController.isInstance(b)&&d.fireSizeChanged()}this.get_SearchControl()&&this.get_SearchControl().fixSearchControlStyles()}this._oFilterInfobar&&this._oFilterInfobar.resize()};a.svRpWH=function Owa$Pages$ListViewSubPage$svRpWH(e,f,d){var a=this.get_VirtualListView(),c=a.iT;if(c!=LVT_MSG&&c!=LVT_CTM&&c!=LVT_TSK)return;var b=new oeReq(a.sEvtNS,e,null,this._createCallback(this.cbSvRpWH));b.add(f,d);b.add("fId",a.sSid);b.send()};a.cbSvRpWH=function Owa$Pages$ListViewSubPage$cbSvRpWH(a){a.fST&&rplLgn()};a.emptyFolder=function Owa$Pages$ListViewSubPage$emptyFolder(){var a=this.getSubPageVariable("a_fJnkFld");(new BtnDlg("divDlt",htmlEnc(a?L_WrnEmptJnk:L_WrnEmpt),a?L_EmptJnk:L_EmptFdrTtl,[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this.cbEmptyFolder))).show()};a.cbEmptyFolder=function Owa$Pages$ListViewSubPage$cbEmptyFolder(b){var a=this.get_VirtualListView();b==0&&a.emptyFolder()};a.rspMI=function Owa$Pages$ListViewSubPage$rspMI(f,e){var c=this.get_VirtualListView(),b;switch(e){case"e":b="ER";break;case"s":b="SR";break;case"d":b="DR"}var a={};a.sC=b;a.sId=this.gtSelItms()[0];if(!a.sId)a.sId=c.gtRwPrp(c.gtSel()[0],"sMID");var d=new oeReq(c.sEvtNS,b,a,this._createCallback(this.cbRspMI));d.add("id",a.sId);d.add("Rsp",f);d.send()};a.cbRspMI=function Owa$Pages$ListViewSubPage$cbRspMI(a){var b=this.get_VirtualListView();if(!cbOeh(a))return;var c=a.oCtx.sC;if(c=="ER")opnWin(a.sBody,null,null,null,null,null,null,this.get_SubPage());else b.rmvRws(new Array(a.oCtx.sId))};a.addABCts=function Owa$Pages$ListViewSubPage$addABCts(){var a=this.get_VirtualListView();this.addSelectedIdsToContacts(a.gtSel())};a.addSelectedIdsToContacts=function Owa$Pages$ListViewSubPage$addSelectedIdsToContacts(a){if(a.length&&a.length>50){alrt(L_TooManyContacts.format(a.length),null,Owa.BUTTON_DIALOG_ICON.WARNING);return}if(a.length){var b={};b.oCallerSubPage=this.get_SubPage();var c=new oeReq("ABDA","AddToContacts",b,cbaddToCt);c.addRg("id",a);c.send()}};a.repFwItmNwWnd=function Owa$Pages$ListViewSubPage$repFwItmNwWnd(b,a,c){this.openItmIds(this.gtSelItms(),"?ae=PreFormAction&a="+b+(a?a:""),0,0,c,this.get_SubPage())};a.nwChtFrmMsg=function Owa$Pages$ListViewSubPage$nwChtFrmMsg(){var c=this.get_VirtualListView(),a=this.gtSelItms();if(!a||!a.length||a.length<=0)return;var b=this.gtMsgInfo(this.get_FolderId(),a[0]);try{gtIMMgr().NwChtSsnMw(b.sSub,b.oRcp,this.get_FolderId(),a[0],c.isCnvVw()?1:0)}catch(d){}};a.gtMsgInfo=function Owa$Pages$ListViewSubPage$gtMsgInfo(i,e){var h=this.get_VirtualListView(),b={};b.sSub=0;b.oRcp=0;var f,j,a;try{var d,c;c=Owa.Components.SubPageControllerFactory.getControllerByElement(this._getDescendant("ifRP")).get_SubPage();if(h.isCnvVw()){d=this.gtCnvRP();if(d&&d.oItemParts[e]){var g=d.oItemParts[e];if(!g.get_IsExpanded())return b;f=c._getDescendant("txtSubj").get_TextContent();a=g.getSender()}}else if(c.get_FolderId()==i&&c.getSubPageVariable("a_sId")==e){f=c._getDescendant("divSubj").get_TextContent();a=c._getDescendant("spnFrom")}b.sSub=f;b.oRcp=new Recip(a.get_TextContent(),a.getAttribute("_em"),a.getAttribute("_sa"),a.getAttribute("_al"),a.getAttribute("_rt"),a.getAttribute("_ao"),a.getAttribute("_id"),a.getAttribute("_rf"),a.getAttribute("_ei"),a.getAttribute("_uri"),a.getAttribute("_mo"))}catch(k){b.sSub=0;b.oRcp=0}return b};a.seekNPItm=function Owa$Pages$ListViewSubPage$seekNPItm(b,d,c){var a=this.get_VirtualListView();a.selNPRw(b,d,c)};a.ref=function Owa$Pages$ListViewSubPage$ref(c){var b=this.get_VirtualListView();if(!b)return;var a=this.get_ParentSubPage();a&&b.sSid==a.getSubPageVariable("a_sInbx")&&a.invokeSubPageFunction("clearNwMB");c&&ClientAction.add(ClientAction.Name.ManualRefresh);b.rfrsh(0,c?"manualrefresh":null,false,true);this.refreshConversationRP()};a.udCntFnc=function Owa$Pages$ListViewSubPage$udCntFnc(){var b=this.get_VirtualListView(),f=!canEml(b),g=!canSms(b);Owa.Components.ToolbarCollection.get(this).set_IsButtonDisabled("nmsgct",f);Owa.Components.ToolbarCollection.get(this).set_IsButtonDisabled("sendsms",g);Owa.Components.ToolbarCollection.get(this).set_IsButtonDisabled("nmrgct",f);if(g_fIsIMEnab||Owa.Components.ToolbarCollection.get(this).getButton(BID_CHT)!=null){var c=this.canIM(b),e=0;if(c&&gtIMMgr()){var d=this.getRecipientObject(b.gtSel()[0]);if(d){var a=d._uri;if(!a||a==""||a=="&nbsp;"||isSlfUri(a))c=0;else e=isBuddy(a)}}enbIMBtns(this.get_SubPage(),c,e)}};a.canIM=function Owa$Pages$ListViewSubPage$canIM(a){var b=this.get_VirtualListView();if(!gtIMMgr())return 0;if(gtMstr()&&!gtMstr().g_fSignedIn)return false;if(!a)a=b;var c=a.gtSel();if(c.length!=1)return false;var f=a.gtRwPrp(c[0],"t");if(f&&isOfClss(f,IT_PDL))return false;if(isOCSPrv()&&(b.iT==LVT_DRL||b.iT==LVT_DRP||b.iT==LVT_RMP||b.iT==LVT_RML)){var d=a.gtRwPrp(c[0],"sipUri");if(d&&!isSlfUri(d))return true}else{var e=a.gtRwPrp(c[0],"uri");if(e&&!isSlfUri(e))return true}return false};a.onNavigateChgPwd=function Owa$Pages$ListViewSubPage$onNavigateChgPwd(){var a=wt();a.document.location.href=getEcpVdir()+"?p=PersonalSettings/Password.aspx"};a.gtSndSmtp=function Owa$Pages$ListViewSubPage$gtSndSmtp(d,e,b){if(!b||b=="")throw new Error("Tried to get sender's SMTP address without supplying an item ID");var a={};a.iActn=d;a.sTtl=e;a.sId=b;var c=new oeReq("MsgVLV2","GetSenderSmtp",a,this._createCallback(this.cbGtSndSmtp));c.add("id",b);c.send()};a.getRecipientObject=function Owa$Pages$ListViewSubPage$getRecipientObject(a){if(!a||a=="")throw new Error("Tried to get sender's recipient object without supplying an item ID");var d=this.get_VirtualListView(),b=d.gtRwPrp(a,"ea");if(b){if(!b._id)b._id=a;return b}var e=d.gtRwPrp(a,"uri"),c=Owa.IM.IMUtils.NrmSipUri(e);return new Recip(c,c,0,0,0,AO_O,0,0,0,e)};a.cbGtSndSmtp=function Owa$Pages$ListViewSubPage$cbGtSndSmtp(a){if(a.sErr){a.fST&&popLgn();shwErrDlg(a)}else{var b=Owa.DomUtility.getTextFromHtml(a.sBody,"sSSA");if(a.oCtx.iActn==ACTN_NTJNK)shwNtJnkDlg(this.get_SubPage(),a.oCtx.sId,1,b!=null?b:null);else if(a.oCtx.iActn==ACTN_ADDBSL)if(a_sJnkId==this.get_FolderId())addSndToJnkLst(this.get_SubPage(),BSL,a.oCtx.sId,0,a.oCtx.sTtl);else addToJnkLst(this.get_SubPage(),BSL,b,0,a.oCtx.sTtl,0,a.oCtx.sId,ACTN_ADDBSL);this.refreshConversationRP()}};a.itemSupportsDeliveryReport=function Owa$Pages$ListViewSubPage$itemSupportsDeliveryReport(c,a){if(a.gtRwPrp(c,"s")=="Draft"||a.gtRwPrp(c,"sMS")=="Draft")return false;if(a.isCnvVw&&a.isCnvVw()){var d=this.gtCnvRP();if(d){var b=d.oItemParts[this.gtSelItms()[0]];return b&&!b.fDraft&&b._sT&&canItemBeTracked(b._sT)}var e=a.gtRwPrp(c,"sMT");if(e)return canItemBeTracked(e)}return canItemBeTracked(a.gtRwPrp(c,"t"))};a.gtDlvRp=function Owa$Pages$ListViewSubPage$gtDlvRp(){var a,b=this.gtSelItms();if(!b||!b.length||b.length<=0){var c=this.get_VirtualListView();a=c.gtRwPrp(c.gtSel()[0],"sMID")}else a=b[0];if(!a||a=="")throw new Error("Tried to get delivery report without supplying an item ID");var d=new oeReq("MsgVLV2","GetDeliveryReportUrlParameters",null,this._createCallback(this.cbGtDlvRp));d.add("id",a);d.send()};a.cbGtDlvRp=function Owa$Pages$ListViewSubPage$cbGtDlvRp(b){if(!cbOeh(b))return;var a=getEcpVdir()+"PersonalSettings/DeliveryReport.aspx?exsvurl=1&IsOWA=Y";a+="&Mbx="+urlEnc(Owa.DomUtility.getTextFromHtml(b.sBody,"sMBX"));a+="&MsgID="+urlEnc(Owa.DomUtility.getTextFromHtml(b.sBody,"sEID"));opnWin(a,580,660,1,0,0,1)};a.lvGtSF=function Owa$Pages$ListViewSubPage$lvGtSF(b){var c=this.get_VirtualListView();if(c.fAD)b.add("fltr",this.get_SearchControl().sSearchText);else{var a=new oeSt(b,"FVLVSF");if(this.IsFilterInFavorites()||c.isDumpsterVw())a.add("scp",SearchScope.SS_FLD);else a.add("scp",this.get_SearchControl().iScope);this.get_SearchControl().sSearchText&&a.add("srch",this.get_SearchControl().sSearchText);this.get_SearchControl().sCategory&&a.add("cat",this.get_SearchControl().sCategory);this.get_SearchControl().iResultsIn!=null&&a.add("ri",this.get_SearchControl().iResultsIn);if(this.get_SearchControl().iRecipientField!=null){a.add("rcp",this.get_SearchControl().iRecipientField);a.add("rcps",this.get_SearchControl().sRecipient)}a.add("res",this.get_SearchControl().fReExecuteSearch?"1":"0");this.get_SearchControl().fReExecuteSearch=false;a.add("asrchsup",this.get_SearchControl().fAsyncSearchEnabled?"1":"0");b.addSt("srchf",a)}};a.hasEROnFld=function Owa$Pages$ListViewSubPage$hasEROnFld(a){return!Owa.Utility.isDefined(typeof this.get_EffectiveRights())?1:hasER(this.get_EffectiveRights(),a)};a.fwIA=function Owa$Pages$ListViewSubPage$fwIA(){var b=this.get_VirtualListView(),a;if(!Owa.Utility.isDefined(typeof b.crtItmsDC))a=b.crtDC();else a=b.crtItmsDC(this.gtSelItms());if(a)sndIAReq(this.get_SubPage(),a,a_IT_MSG,cbFwIA);else alrt(L_ErrFwIA)};a.showFilterMenu=function Owa$Pages$ListViewSubPage$showFilterMenu(){var e=this.get_VirtualListView(),c=Owa.Components.ToolbarCollection.get(this).getButton("fltrc"),d=c.get_MenuReferencePosition(g_fRtl),b=null,a;this.set_FilterContextMenu(new Owa.UIControls.FilterContextMenu(this));b=this.get_FilterContextMenu();if(e.isInFltrdVw())a=e.get_FilterViewCriteria();else{a=new Owa.Components.FilterCriteria;a.set_RecipientName(this.get_FilterRecipientName())}b.set_FilterCriteria(a);b.set_FilterButton(c);b.show(d.iX,d.iY)};a.IsFilterInFavorites=function Owa$Pages$ListViewSubPage$IsFilterInFavorites(){var a=this.get_VirtualListView();return this.get_IsFilterInFavorite()?1:a.isInFltrdVw&&a.isInFltrdVw()};a.removeIb=function Owa$Pages$ListViewSubPage$removeIb(a){var b=a.get_Target().getAttribute("_sRmvId");this._oInfobar.checkRemoveMessageAndRefresh(b);this.adjustLvRpContainerTop()};a.throttledRefresh=throttledRefresh;Owa.Pages.ListViewSubPage.createClass("Owa.Pages.ListViewSubPage",Owa.UIControls.SubPage)})();(function(){Type.createNamespace("Owa.Pages");Owa.Pages.DirectoryView=function Owa$Pages$DirectoryView(a){Owa.Pages.DirectoryView.constructBase(this,[a])};Owa.Pages.DirectoryView.createClass("Owa.Pages.DirectoryView",Owa.Pages.ListViewSubPage)})();(function(){Type.createNamespace("Owa.Pages");Owa.Pages.FolderListViewSubPage=function Owa$Pages$FolderListViewSubPage(a){Owa.Pages.FolderListViewSubPage.constructBase(this,[a])};var a=Owa.Pages.FolderListViewSubPage.prototype;a._initializeHotkeys=function Owa$Pages$FolderListViewSubPage$_initializeHotkeys(){Owa.Pages.FolderListViewSubPage.callBase(this,"_initializeHotkeys");this._oHotKeyManager.addHotKey(L_HkDlt,BID_DL);this._oHotKeyManager.addHotKey(Owa.KeyCodes.DELETE.toString(),BID_DL,true);this._oHotKeyManager.addHotKey("SHIFT+"+Owa.KeyCodes.DELETE,BID_PDLT,true);if(Owa.Utility.isMac()){this._oHotKeyManager.addHotKey(Owa.KeyCodes.BACK_SPACE.toString(),BID_DL,true);this._oHotKeyManager.addHotKey("SHIFT+"+Owa.KeyCodes.BACK_SPACE,BID_PDLT,true)}};Owa.Pages.FolderListViewSubPage.createClass("Owa.Pages.FolderListViewSubPage",Owa.Pages.ListViewSubPage)})();!g_fModuleLoaded["uview.js".toLowerCase()]&&(function(){Type.createNamespace("Owa.Pages");Owa.Pages.MessageViewSubPage=function Owa$Pages$MessageViewSubPage(a){Owa.Pages.MessageViewSubPage.constructBase(this,[a]);this._sLastConversationActionId=null;this._fLastConversationActionValue=null;this._clearRefreshConversationRPDelayTimerAndFlags();this.updateArchiveFolderId(a)};var a=Owa.Pages.MessageViewSubPage.prototype;a._fSupportHostedInSubPage=true;a.initialize=function Owa$Pages$MessageViewSubPage$initialize(){Owa.Pages.MessageViewSubPage.callBase(this,"initialize");var b=this.get_VirtualListView();g_oEd.attachEvent("CopyItems",null,"cbCpMvItms");g_oEd.attachEvent("MoveItems",null,"cbCpMvItms");b.stOnCnvVwChg(this._createCallback(this.initCnvVw));b.stOnRowNotification(this._createCallback(this.onRowNotificationVw));this.initCnvVw(b.isCnvVw());this.fireUpdCnt();this.get_OOF()&&wrnOof();if(this.IsFilterInFavorites()){this.get_SearchControl()._setSearchScopeIconStyle();this.get_SearchControl()._updateScopeText()}if(!isSWP()){var a=this._oInfobar.getMessageById("divSMimeIB");if(a)if(isSSL()&&isFlgSt(gtMmSt(),MM_MstUpd)){a.set_IsShown(1);this._oInfobar.set_IsShown(1,1)}else this._oInfobar.removeMessage(a,1)}this.adjustLvRpContainerTop();this.udMsgTB();this.updateConversationCM();addPerfMarker("MessageView.Init.End")};a.dispose=function Owa$Pages$MessageViewSubPage$dispose(){g_oEd.detachEvent("CopyItems",null,"cbCpMvItms");g_oEd.detachEvent("MoveItems",null,"cbCpMvItms");Owa.Pages.MessageViewSubPage.callBase(this,"dispose")};a._initializeHotkeys=function Owa$Pages$MessageViewSubPage$_initializeHotkeys(){Owa.Pages.MessageViewSubPage.callBase(this,"_initializeHotkeys");if(Owa.Utility.isMac())this.addHk(L_HkMkRdMac,"markread");else this.addHk(L_HkMkRd,"markread");this.addHk(L_HkMkUnrd,"markunread");if(!isJnkFld(this)){this.addHk(L_HkRpl,BID_RE);this.addHk(L_HkRplAll,BID_RA);this.addHk(L_HkCht,BID_CHT);this.addHk(L_HkFwd,BID_FW)}};a._onUserAction=function Owa$Pages$MessageViewSubPage$_onUserAction(b,d){switch(b){case BID_CANIGNCNV:case BID_CANIGNCNVDD:this._cancelIgnoreConversation();break;case BID_EXPALL:this._expandAll();break;case BID_CLPSALL:this._expandAll(true);break;case BID_ACT:var c=Owa.Components.ToolbarCollection.get(this.get_SubPage()).getButton("actions"),a=c.get_MenuReferencePosition(g_fRtl);this.get_VirtualListView().showContextMenu(a.iX,a.iY);break;case BID_USECNV:this.get_VirtualListView().toggleConversationMode();break;case BIG_CNVOPTS:navOpts("Mail");break;default:Owa.Pages.MessageViewSubPage.callBase(this,"_onUserAction",[b,d])}};a._onNewItem=function Owa$Pages$MessageViewSubPage$_onNewItem(){var a=this.isPF()?"newpst":"newmsg";this.get_ActionTable().getAction(a).triggerAction()};a.repFwItmNwWnd=function Owa$Pages$MessageViewSubPage$repFwItmNwWnd(a,b,c){this.setRPRefreshDelayFlag();Owa.Pages.MessageViewSubPage.callBase(this,"repFwItmNwWnd",[a,b,c])};a.onLoadReadingPane=function Owa$Pages$MessageViewSubPage$onLoadReadingPane(){Owa.Pages.MessageViewSubPage.callBase(this,"onLoadReadingPane");this.initCnvRP();var c=this.get_ItemIdInReadingPane(),a=false,e=this.get_VirtualListView();if(e.isCnvVw()){var f=this.gtCnvRP();a=f.get_IsConversationIgnored()}else{var d=this._getDescendant("ifRP"),b=Owa.Components.SubPageControllerFactory.getControllerByElement(d);a=b.getVariable("a_fInIgnCnv");this.udMsgTB(true);this.updateConversationCM()}this._sLastConversationActionId=c;this._fLastConversationActionValue=a;this._tryUpdateConversationActionUI()};a.onSelChngVw=function Owa$Pages$MessageViewSubPage$onSelChngVw(a){this.udMsgTB();this.updateConversationCM();this._tryUpdateConversationActionUI();Owa.Pages.MessageViewSubPage.callBase(this,"onSelChngVw",[a])};var b=5*1e3;a.cbDelOeh=function Owa$Pages$MessageViewSubPage$cbDelOeh(a){if(this.getSubPageVariable("a_fInDelItms")&&a.oCtx.fIgnoreConversations){this._updateConversationActionUI(true,true);return}Owa.Pages.MessageViewSubPage.callBase(this,"cbDelOeh",[a])};a.onRowNotificationVw=function Owa$Pages$MessageViewSubPage$onRowNotificationVw(a){var c=this.get_VirtualListView();if(a==this.get_ItemIdInReadingPane())if(this._fRPRefreshDelayFlag&&a==this._sRPRefreshDelayID){if(this._oRPRefreshDelayTimer==null)this._oRPRefreshDelayTimer=this._setTimeout(this._refreshConversationRPDelayed,b,{fForceRefresh:true,sId:a})}else{this._clearRefreshConversationRPDelayTimerAndFlags();this.refreshConversationRP(true)}};a.setRPRefreshDelayFlag=function Owa$Pages$MessageViewSubPage$setRPRefreshDelayFlag(){this._sRPRefreshDelayID=this.get_ItemIdInReadingPane();this._fRPRefreshDelayFlag=true};a._refreshConversationRPDelayed=function Owa$Pages$MessageViewSubPage$_refreshConversationRPDelayed(a){var b=a.fForceRefresh,c=a.sId;this._clearRefreshConversationRPDelayTimerAndFlags();c==this.get_ItemIdInReadingPane()&&this.refreshConversationRP(b)};a._clearRefreshConversationRPDelayTimerAndFlags=function Owa$Pages$MessageViewSubPage$_clearRefreshConversationRPDelayTimerAndFlags(){this._oRPRefreshDelayTimer&&this._clearTimeout(this._oRPRefreshDelayTimer);this._oRPRefreshDelayTimer=null;this._sRPRefreshDelayID=null;this._fRPRefreshDelayFlag=false};a._cancelIgnoreConversation=function Owa$Pages$MessageViewSubPage$_cancelIgnoreConversation(){if(PONT_CANIGNCNV&a_iEnblPnt)shwPont(PONT_CANIGNCNV,L_CanIgnCnv,L_CanIgnCnvTtl,[L_OK,L_Cncl],0,this._createCallback(this._cbCancelIgnoreConversationPont));else this._cbCancelIgnoreConversationPont()};a._cbCancelIgnoreConversationPont=function Owa$Pages$MessageViewSubPage$_cbCancelIgnoreConversationPont(c){if(c==-1||c==1)return;var b,a=this.get_VirtualListView();if(a.isSelExp())b=a.gtExpCnvId();else b=a.gtSel()[0];var d=new oeReq(a.sEvtNS,"CancelIgnoreConversation",0,this._createCallback(this._cbCancelIgnoreConversation));d.add("id",b);d.send();this._updateConversationActionUI(true,false);a.makeFocused()};a._cbCancelIgnoreConversation=function Owa$Pages$MessageViewSubPage$_cbCancelIgnoreConversation(a){if(!cbOeh(a))return void 0};a._tryUpdateConversationActionUI=function Owa$Pages$MessageViewSubPage$_tryUpdateConversationActionUI(){var a=this.get_VirtualListView();if(!a.isCnvVw())for(var e=a.gtSel(),c=0;c<e.length;c++)if(a.gtRwPrp(e[c],"fExclCnv")=="1"){this._updateConversationActionUI(false);return}var b=null;if(a.isCnvVw()&&a.isSelExp())b=a.gtExpCnvId();else if(a.gtSelCnt()==1)b=a.gtSel()[0];var d=false;if(b)if(b==this._sLastConversationActionId)d=this._fLastConversationActionValue;else!this.isReadingPaneOn()&&this._getConversationActionData(b);this._updateConversationActionUI(true,d)};a._getConversationActionData=function Owa$Pages$MessageViewSubPage$_getConversationActionData(a){var c=this.get_VirtualListView(),b=new oeReq(c.sEvtNS,"GetConversationAction",a,this._createCallback(this._cbGetConversationActionData));b.add("id",a);b.send()};a._cbGetConversationActionData=function Owa$Pages$MessageViewSubPage$_cbGetConversationActionData(a){if(!cbOeh(a))return;var b=parseInt(a.sBody,10);this._sLastConversationActionId=a.oCtx;this._fLastConversationActionValue=b;this._tryUpdateConversationActionUI()};a._updateConversationActionUI=function Owa$Pages$MessageViewSubPage$_updateConversationActionUI(a,b){var c=Owa.Components.ToolbarCollection.get(this);c.set_IsButtonShown(BID_DL,!b||!a);c.set_IsButtonShown(BID_CANIGNCNV,b&&a);c.set_IsButtonPushed(BID_CANIGNCNV,b&&a);var d=c.getButton(BID_DL);Owa.UIControls.ComboButton.isInstance(d)&&d.set_ComboEnabled(a);this._fIgnoreConversationMenuItem=!b&&a;this._fCanIgnoreConversationMenuItem=b&&a};a._expandAll=function Owa$Pages$MessageViewSubPage$_expandAll(b){var a=this.gtCnvRP();if(a)if(b)a.collapseAll();else a.expandAll()};a.getItemToolbarId=function Owa$Pages$MessageViewSubPage$getItemToolbarId(){return"divItemToolbar"};a.getViewToolbarId=function Owa$Pages$MessageViewSubPage$getViewToolbarId(){return"divViewToolbar"};a.updateArchiveFolderId=function Owa$Pages$MessageViewSubPage$updateArchiveFolderId(d){var b=this.get_SubPageController().get_ParentController(),e=null;if(b)e=b.getVariable("g_oMMFrst");if(!e)return;var a=d.getDescendantById("divReplaceFolderId");if(a){var g=a.getAttribute("oldfolderid"),f=a.getAttribute("newfolderid"),c=g_oMMFrst.gtTr("archive").gtNdById(g);c&&g_oMMFrst.gtTr("archive").replaceDummyId(c,f,d)}};Owa.Pages.MessageViewSubPage.createClass("Owa.Pages.MessageViewSubPage",Owa.Pages.FolderListViewSubPage)})();g_fModuleLoaded["uview.js".toLowerCase()]=1;function canSms(d){for(var a=d.gtSel(),e=a.length>0,b=0;b<a.length;++b){var c=d.gtRwPrp(a[b],"ea");e&=isDf(typeof c)&&c!=null&&(c._rt=="MOBILE"&&c._em!="0"||!String.isNullOrEmpty(c._mo))||d.gtRwPrp(a[b],"_rt")=="MOBILE"&&d.gtRwPrp(a[b],"_em")!="0"||!String.isNullOrEmpty(d.gtRwPrp(a[b],"_mo"))}return e}function canEml(d){for(var a=d.gtSel(),e=a.length>0,b=0;b<a.length;++b){var c=d.gtRwPrp(a[b],"ea");e&=isDf(typeof c)&&c!=null&&c._em!="0"&&c._rt!="MOBILE"||d.gtRwPrp(a[b],"_em")!="0"&&d.gtRwPrp(a[b],"_rt")!="MOBILE"}return e}stJS("uview.js")"\      YDeYDe>+Y   @    :https://mail.logica.com/owa/14.3.319.2/scripts/premium/uview.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAVPMIIFSzCCBDOgAwIBAgIQC9oUlvTJTE7TC0j08zttrDANBgkqhkiG9w0BAQsFADBwMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNzdXJhbmNlIFNlcnZlciBDQTAeFw0xNzA4MTgwMDAwMDBaFw0xODEwMDExMjAwMDBaMF4xCzAJBgNVBAYTAkdCMRAwDgYDVQQHEwdSZWFkaW5nMRcwFQYDVQQKEw5Mb2dpY2EgTGltaXRlZDENMAsGA1UECxMERUlJUzEVMBMGA1UEAwwMKi5sb2dpY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzuYMsuU3piAX99KZg+15ZU9OKmiMfNCWme5/Iz8Agp2MxYMF4mLUcfss1x5fB0mMY+KvwAyfSyor56jR7dy3NKMreZRH1Q/YeFQW5MMs7paDof2KI5PtBspIXbQag6WYYtW10v/lkd+as+VD6jyhfU6+osD9HrbIK5dxToF6mfJqk/ky8nwphaA2FHoRKTdAMiQh9RS5IYKDzeaoPxLy+M+qvME3urniOQqd9Od7sqG4ml+wqS7+xB7UAl+ochD4A/rwewdhccwt91RNkn1E4j1RaZ6FYcuszvBcYih+m1wcQn/ACTrAAWV+ziST2h7LfUmEtMPVQ4swHYI8diuPfQIDAQABo4IB8TCCAe0wHwYDVR0jBBgwFoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKinxbIi/V/Ey/fqtiPTDEcBOGc5MCMGA1UdEQQcMBqCDCoubG9naWNhLmNvbYIKbG9naWNhLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWhhLXNlcnZlci1nMS5jcmwwTAYDVR0gBEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAIBgZngQwBAgIwgYMGCCsGAQUFBwEBBHcwdTAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEySGlnaEFzc3VyYW5jZVNlcnZlckNBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQBQjp60tISk4788ERXDdQQKXRiEr75a1DYfG2ouVr/8OYlwgS5AwIEapDT7vqli2n3LbeeVgzUz2cZm9Bc/WjyYmSRlZtFYoSn6muFvYOjr0v5aiJXyFdz03emn93quN95xu4MnDmqoBsxEvyOHgO7TXhnpmO/aF9jA01L7SLfZI5TvVaOGQ2vAU6h5cOdXp18nuJGk+o1274scCkBK60dJwRaUtz7zMp2vr3FpOfvLqpkzBkUC8Iv0sXVfPgZFINyMTDW14QAbzWSsbr3EQEJ7ioAqjEBsScJjGFk5V+GDpyz3z9nLjoM/fWKl7sS5Z9VaztyzpEvomyQsd6sZPdubAC8AAwAAAAABAQAA request-method GET response-head HTTP/1.1 200 OK
Content-Length: 178233
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "086c49b59d21:0"
Accept-Ranges: bytes
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:44 GMT
X-Powered-By: ASP.NET
 original-response-headers Connection: Keep-Alive
Content-Length: 178233
Date: Thu, 07 Sep 2017 11:14:39 GMT
Content-Type: application/x-javascript
Etag: "086c49b59d21:0"
Accept-Ranges: bytes
Set-Cookie: CAS_LB_Service=R3418549887; path=/
Cache-Control: public,max-age=2592000
Last-Modified: Wed, 07 Sep 2016 12:44:44 GMT
X-Powered-By: ASP.NET
 uncompressed-len 0  9